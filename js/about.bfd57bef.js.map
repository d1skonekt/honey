{"version":3,"file":"js/about.bfd57bef.js","mappings":"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AAe,KACf,IAAe,KACf,IAAe,KACf,MAAe,MAInBC,GAAiB,CACpB,KACA,QACA,aACA,WACA,YACA,iBACA,eACA,WACA,SACA,WACA,cACA,kBACA,gBACA,YACA,UACA,YACA,eACA,UACA,YAGD,SAASC,GAAOrU,GAA6D,OAAOA,EAAItnB,KAAI,SAASrC,GAAK,MAAO,CAAEA,GAAG,GAAI,IAAKA,GAAG,EAAG,IAAM,IAAFA,EAAQ,GAAI,CAIrJ,IAAIi+B,GAAwBD,GAAO,CAElC,EACA,SACA,SACA,MACA,IACA,SACA,SACA,MAGA,EACA,SACA,SACA,MACA,IACA,SACA,SACA,MAEA,QACA,MACA,IACA,QACA,QACA,MACA,SACA,QACA,SACA,SACA,SACA,SACA,QACA,SACA,MACA,SAEA,IACA,SACA,SACA,MACA,QACA,QACA,MACA,IACA,MACA,SACA,SACA,SACA,SACA,SACA,SACA,SAEA,QACA,QACA,SACA,SACA,SACA,SACA,QACA,QACA,MACA,QACA,MACA,QACA,SACA,SACA,QACA,QAGA,SACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,EACA,IAEG7C,GAAsBpR,GAAIkU,IAG1BtH,GAAO,CACH,EAAa,SACb,EAAa,UACb,GAAa,UACb,GAAa,QACb,GAAa,SACb,GAAa,QACb,GAAa,OACb,GAAa,gBACb,IAAa,SAGjBuH,GAAQ,CACX,SAAiB,EACjB,UAAiB,EACjB,UAAiB,GACjB,QAAiB,GACjB,SAAiB,GACjB,QAAiB,GACjB,OAAiB,GACjB,gBAAiB,GACjB,QAAiB,KAOdC,GAAgC,CAEnC,6EAA8E,YAC9E,uDAAwD,YACxD,0DAA2D,YAC3D,uDAAwD,YACxD,gFAAiF,YAGjF,4EAA6E,SAC7E,qCAAsC,SACtC,sCAAuC,OAGvC,6EAA8E,SAC9E,sCAAuC,SAGvC,0CAA2C,SAC3C,sCAAuC,SACvC,0CAA2C,OAC3C,sCAAuC,OAGvC,8EAA+E,UAC/E,uCAAwC,UAGxC,gFAAiF,OACjF,yCAA0C,OAG1C,yEAA0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Ae,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,cAAenB,EAAEy/C,GACpC,IAAe,CAAEt+C,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MACnB,IAAe,CAAEA,EAAE,MAC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IAAK,oBACL,IAAK,kBACL,IAAK,iBACL,IAAK,UACL,IAAK,YACL,IAAK,YACL,IAAK,aACL,IAAK,cACL,IAAK,UACL,IAAK,SACL,IAAK,cACL,IAAK,UACL,IAAK,oBACL,IAAK,kBACL,IAAK,QACL,IAAK,aACL,IAAK,YACL,IAAK,cACL,IAAK,mBACL,IAAK,oBACL,IAAK,cACL,IAAK,cACL,IAAK,mBACL,IAAK,eACL,IAAK,aACL,IAAK,eACL,IAAK,gBACL,IAAK,aACL,IAAK,cACL,IAAK,cACL,IAAK,iBACL,IAAK,YACL,IAAK,cACL,IAAK,eACL,IAAK,aACL,IAAK,aACL,IAAK,gBACL,IAAK,eACL,IAAK,kBACL,IAAK,gBACL,IAAK,qBACL,IAAK,WACL,IAAK,OACL,IAAK,gBACL,IAAK,kBACL,IAAK,aACL,IAAK,aACL,IAAK,eACL,IAAK,iBACL,IAAK,cACL,IAAK,iBACL,IAAK,qBACL,IAAK,YACL,IAAK,oBACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,WACL,IAAK,eACL,IAAK,gBACL,IAAK,gBACL,IAAK,mBACL,IAAK,iBACL,IAAK,eACL,IAAK,cACL,IAAK,YACL,IAAK,kBACL,IAAK,oBACL,IAAK,iBACL,IAAK,YACL,IAAK,aACL,IAAK,oBACL,IAAK,aACL,IAAK,eACL,IAAK,iBACL,IAAK,kBACL,IAAK,eACL,IAAK,gBACL,IAAK,gBACL,IAAK,qBACL,IAAK,mBACL,IAAK,qBACL,IAAK,yBACL,IAAK,cACL,IAAK,aACL,IAAK,mBACL,IAAK,sBACL,IAAK,eACL,IAAK,eACL,IAAK,gBACL,IAAK,cACL,IAAK,kBACL,IAAK,cACL,IAAK,gBACL,IAAK,kBACL,IAAK,2BACL,IAAK,eACL,IAAK,iBACL,IAAK,aACL,IAAK,iBACL,IAAK,YACL,IAAK,mBACL,IAAK,cACL,IAAK,wBACL,IAAK,kBACL,IAAK,qBACL,IAAK,kBACL,IAAK,kBACL,IAAK,kBACL,IAAK,qBACL,IAAK,aACL,IAAK,iBACL,IAAK,eACL,IAAK,mBACL,IAAK,aACL,IAAK,eACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,kBACL,IAAK,kBACL,IAAK,gBACL,IAAK,iBACL,IAAK,uBACL,IAAK,0BACL,IAAK,iBACL,IAAK,eACL,IAAK,YACL,IAAK,cACL,IAAK,aACL,IAAK,iBACL,IAAK,kBACL,IAAK,kBACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,qBACL,IAAK,cACL,IAAK,mBACL,IAAK,uBACL,IAAK,mBACL,IAAK,kBACL,IAAK,mBACL,IAAK,cACL,IAAK,iBACL,IAAK,kBACL,IAAK,eACL,IAAK,eACL,IAAK,oBACL,IAAK,sBACL,IAAK,sBACL,IAAK,mBACL,IAAK,qBACL,IAAK,qBACL,IAAK,gBACL,IAAK,aACL,IAAK,YACL,IAAK,cACL,IAAK,mBACL,IAAK,gBACL,IAAK,wBACL,IAAK,qBACL,IAAK,SACL,IAAK,kBACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,gBACL,IAAK,mBACL,IAAK,mBACL,IAAK,oBACL,IAAK,eACL,IAAK,oBACL,IAAK,uBACL,IAAK,cACL,IAAK,WACL,IAAK,WACL,IAAK,aACL,IAAK,aACL,IAAK,eACL,IAAK,eACL,IAAK,cACL,IAAK,qBACL,IAAK,yBACL,IAAK,mBACL,IAAK,WACL,IAAK,iBACL,IAAK,iBACL,IAAK,eACL,IAAK,YACL,IAAK,mBACL,IAAK,mBACL,IAAK,iBACL,IAAK,kBACL,IAAK,oBACL,IAAK,mBACL,IAAK,cACL,IAAK,gBACL,IAAK,WACL,IAAK,YACL,IAAK,cACL,IAAK,cACL,IAAK,mBACL,IAAK,oBACL,IAAK,iBACL,IAAK,YACL,IAAK,SACL,IAAK,SACL,IAAK,gBACL,IAAK,mBACL,IAAK,iBACL,IAAK,WACL,IAAK,gBACL,IAAK,gBACL,IAAK,cACL,IAAK,iBACL,IAAK,iBACL,IAAK,oBACL,IAAK,sBACL,IAAK,aACL,IAAK,cACL,IAAK,cACL,IAAK,oBACL,IAAK,eACL,IAAK,gBACL,IAAK,qBAEHL,GAAO,CACT,EAAG,QACH,EAAG,KACH,EAAG,OACH,EAAG,UACH,EAAG,MACH,EAAG,UACH,EAAG,MACH,EAAG,MACH,EAAG,MACH,EAAG,SACH,GAAI,KACJ,GAAI,MACJ,GAAI,QACJ,GAAI,SACJ,GAAI,QACJ,GAAI,MACJ,GAAI,MACJ,GAAI,MACJ,GAAI,OACJ,GAAI,KACJ,GAAI,OACJ,GAAI,MACJ,GAAI,KACJ,GAAI,QACJ,GAAI,MACJ,GAAI,MACJ,GAAI,OACJ,GAAI,QACJ,GAAI,SACJ,GAAI,QACJ,GAAI,OACJ,GAAI,MACJ,GAAI,MACJ,GAAI,QACJ,GAAI,OACJ,GAAI,QACJ,GAAI,MACJ,GAAI,KACJ,GAAI,MACJ,GAAI,MACJ,GAAI,SACJ,GAAI,OACJ,GAAI,WACJ,GAAI,OACJ,GAAI,OACJ,GAAI,SACJ,GAAI,MACJ,GAAI,OACJ,GAAI,OACJ,GAAI,SACJ,GAAI,QACJ,GAAI,SACJ,GAAI,SACJ,GAAI,OACJ,GAAI,OACJ,GAAI,SACJ,GAAI,KACJ,GAAI,KACJ,GAAI,OACJ,GAAI,MACJ,GAAI,OACJ,GAAI,OACJ,GAAI,MACJ,GAAI,OACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,GAAI,MACJ,GAAI,QACJ,GAAI,OACJ,GAAI,UACJ,GAAI,OACJ,GAAI,SACJ,GAAI,SACJ,GAAI,MACJ,GAAI,QACJ,GAAI,OACJ,GAAI,UACJ,GAAI,SACJ,GAAI,SACJ,GAAI,SACJ,GAAI,WACJ,GAAI,SACJ,GAAI,YACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,GAAI,OACJ,GAAI,WACJ,GAAI,SACJ,GAAI,QACJ,GAAI,UACJ,GAAI,SACJ,GAAI,YACJ,GAAI,cACJ,GAAI,YACJ,GAAI,SACJ,GAAI,QACJ,GAAI,OACJ,GAAI,OACJ,IAAK,SACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,cACL,IAAK,WACL,IAAK,YACL,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,UACL,IAAK,aACL,IAAK,OACL,IAAK,QACL,IAAK,YACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,IACL,IAAK,IACL,IAAK,QACL,IAAK,SACL,IAAK,QACL,IAAK,UACL,IAAK,QACL,IAAK,WACL,IAAK,SACL,IAAK,OACL,IAAK,YACL,IAAK,YACL,IAAK,MACL,IAAK,MACL,IAAK,MACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,WACL,IAAK,OACL,IAAK,UACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,gBACL,IAAK,iBACL,IAAK,WACL,IAAK,cACL,IAAK,iBACL,IAAK,iBACL,IAAK,aACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,SACL,IAAK,aACL,IAAK,MACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,WACL,IAAK,UACL,IAAK,OACL,IAAK,UACL,IAAK,YACL,IAAK,UACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,OACL,IAAK,WACL,IAAK,gBACL,IAAK,aACL,IAAK,eACL,IAAK,WACL,IAAK,YACL,IAAK,WACL,IAAK,OACL,IAAK,SACL,IAAK,OACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,YACL,IAAK,UACL,IAAK,aACL,IAAK,aACL,IAAK,WACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,YACL,IAAK,MACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,MACL,IAAK,OACL,IAAK,UACL,IAAK,SACL,IAAK,WACL,IAAK,SACL,IAAK,aACL,IAAK,OACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,gBACL,IAAK,WACL,IAAK,aACL,IAAK,cACL,IAAK,gBACL,IAAK,kBACL,IAAK,gBACL,IAAK,WACL,IAAK,OACL,IAAK,QACL,IAAK,aACL,IAAK,KACL,IAAK,QACL,IAAK,SACL,IAAK,YACL,IAAK,cACL,IAAK,iBACL,IAAK,OACL,IAAK,gBACL,IAAK,WACL,IAAK,cACL,IAAK,WACL,IAAK,iBACL,IAAK,aACL,IAAK,YACL,IAAK,eACL,IAAK,eACL,IAAK,cACL,IAAK,aACL,IAAK,cACL,IAAK,eACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,UACL,IAAK,YACL,IAAK,UACL,IAAK,SACL,IAAK,SACL,IAAK,aACL,IAAK,YACL,IAAK,OACL,IAAK,YACL,IAAK,QACL,IAAK,OACL,IAAK,SACL,IAAK,YACL,IAAK,QACL,IAAK,YACL,IAAK,WACL,IAAK,UACL,IAAK,cACL,IAAK,cACL,IAAK,SACL,IAAK,eACL,IAAK,WACL,IAAK,YACL,IAAK,UACL,IAAK,WACL,IAAK,cACL,IAAK,MACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,SACL,IAAK,QACL,IAAK,WACL,IAAK,QACL,IAAK,YACL,IAAK,UACL,IAAK,MACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,OACL,IAAK,QACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,OACL,IAAK,OACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,WACL,IAAK,aACL,IAAK,cACL,IAAK,OACL,IAAK,WACL,IAAK,OACL,IAAK,gBACL,IAAK,YACL,IAAK,cACL,IAAK,QACL,IAAK,iBACL,IAAK,kBACL,IAAK,kBACL,IAAK,iBACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,QACL,IAAK,UACL,IAAK,aACL,IAAK,eACL,IAAK,oBACL,IAAK,QACL,IAAK,UACL,IAAK,aACL,IAAK,eACL,IAAK,QACL,IAAK,cACL,IAAK,cACL,IAAK,WACL,IAAK,eACL,IAAK,YACL,IAAK,WACL,IAAK,WACL,IAAK,OACL,IAAK,OACL,IAAK,UACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,WACL,IAAK,gBACL,IAAK,YACL,IAAK,kBACL,IAAK,eACL,IAAK,gBACL,IAAK,mBACL,IAAK,cACL,IAAK,gBACL,IAAK,cACL,IAAK,WACL,IAAK,MACL,IAAK,YACL,IAAK,aACL,IAAK,qBACL,IAAK,mBACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,UACL,IAAK,QACL,IAAK,SACL,IAAK,OACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,QACL,IAAK,QACL,IAAK,aACL,IAAK,cACL,IAAK,YACL,IAAK,SACL,IAAK,UACL,IAAK,QACL,IAAK,YACL,IAAK,YACL,IAAK,aACL,IAAK,SACL,IAAK,WACL,IAAK,QACL,IAAK,SACL,IAAK,SACL,IAAK,QACL,IAAK,SACL,IAAK,MACL,IAAK,OACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,OACL,IAAK,OACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,WACL,IAAK,OACL,IAAK,YACL,IAAK,YACL,IAAK,UACL,IAAK,aACL,IAAK,aACL,IAAK,QACL,IAAK,QACL,IAAK,WACL,IAAK,WACL,IAAK,UACL,IAAK,SACL,IAAK,WACL,IAAK,UACL,IAAK,QACL,IAAK,UACL,IAAK,WACL,IAAK,YACL,IAAK,WACL,IAAK,aACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,YACL,IAAK,cACL,IAAK,UACL,IAAK,YACL,IAAK,WACL,IAAK,UACL,IAAK,UACL,IAAK,UACL,IAAK,WACL,IAAK,UACL,IAAK,cACL,IAAK,MACL,IAAK,cACL,IAAK,MACL,IAAK,aACL,IAAK,gBACL,IAAK,UACL,IAAK,eACL,IAAK,UACL,IAAK,WACL,IAAK,SACL,IAAK,YACL,IAAK,cAEHD,GAAW,CACb,EAAG,EACH,EAAG,EACH,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IAAK,EACL,IA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","sources":["webpack://honey/./src/views/ManualView.vue","webpack://honey/./src/components/AppFileReader.vue","webpack://honey/./node_modules/xlsx/xlsx.mjs","webpack://honey/src/components/AppFileReader.vue","webpack://honey/./src/components/AppFileReader.vue?bc7b","webpack://honey/./src/components/AppFileReader.vue?f3af","webpack://honey/./src/components/FinalBlock/FinalBlock.vue","webpack://honey/./src/components/FinalBlock/ResultDataElem.vue","webpack://honey/src/components/FinalBlock/ResultDataElem.vue","webpack://honey/./src/components/FinalBlock/ResultDataElem.vue?85f4","webpack://honey/./src/components/FinalBlock/ResultDataElem.vue?3c16","webpack://honey/src/components/FinalBlock/FinalBlock.vue","webpack://honey/./src/components/FinalBlock/FinalBlock.vue?b752","webpack://honey/./src/components/FinalBlock/FinalBlock.vue?c669","webpack://honey/./src/components/Switchers/Switchers.vue","webpack://honey/src/components/Switchers/Switchers.vue","webpack://honey/./src/components/Switchers/Switchers.vue?ba7f","webpack://honey/./src/components/Switchers/Switchers.vue?e0c2","webpack://honey/./src/components/Calculation/CalculationBlock.vue","webpack://honey/./src/components/Calculation/CalculationCard.vue","webpack://honey/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://honey/../src/helpers/helpers.core.ts","webpack://honey/../src/helpers/helpers.math.ts","webpack://honey/../src/helpers/helpers.collection.ts","webpack://honey/../src/helpers/helpers.extras.ts","webpack://honey/../src/helpers/helpers.easing.ts","webpack://honey/../node_modules/.pnpm/@kurkle+color@0.2.1/node_modules/@kurkle/color/dist/color.esm.js","webpack://honey/../src/helpers/helpers.color.ts","webpack://honey/../src/core/core.animations.defaults.js","webpack://honey/../src/core/core.layouts.defaults.js","webpack://honey/../src/helpers/helpers.intl.ts","webpack://honey/../src/core/core.ticks.js","webpack://honey/../src/core/core.scale.defaults.js","webpack://honey/../src/core/core.defaults.js","webpack://honey/../src/helpers/helpers.canvas.js","webpack://honey/../src/helpers/helpers.options.ts","webpack://honey/../src/helpers/helpers.config.js","webpack://honey/../src/helpers/helpers.curve.ts","webpack://honey/../src/helpers/helpers.dom.ts","webpack://honey/../src/helpers/helpers.interpolation.ts","webpack://honey/../src/helpers/helpers.rtl.ts","webpack://honey/../src/helpers/helpers.segment.js","webpack://honey/../src/core/core.animator.js","webpack://honey/../src/core/core.animation.js","webpack://honey/../src/core/core.animations.js","webpack://honey/../src/core/core.datasetController.js","webpack://honey/../src/controllers/controller.bar.js","webpack://honey/../src/controllers/controller.bubble.js","webpack://honey/../src/controllers/controller.doughnut.js","webpack://honey/../src/controllers/controller.line.js","webpack://honey/../src/controllers/controller.polarArea.js","webpack://honey/../src/controllers/controller.pie.js","webpack://honey/../src/controllers/controller.radar.js","webpack://honey/../src/controllers/controller.scatter.js","webpack://honey/../src/core/core.adapters.ts","webpack://honey/../src/core/core.interaction.js","webpack://honey/../src/core/core.layouts.js","webpack://honey/../src/platform/platform.base.js","webpack://honey/../src/platform/platform.basic.js","webpack://honey/../src/platform/platform.dom.js","webpack://honey/../src/platform/index.js","webpack://honey/../src/core/core.element.ts","webpack://honey/../src/core/core.scale.autoskip.js","webpack://honey/../src/core/core.scale.js","webpack://honey/../src/core/core.typedRegistry.js","webpack://honey/../src/core/core.registry.js","webpack://honey/../src/core/core.plugins.js","webpack://honey/../src/core/core.config.js","webpack://honey/../src/core/core.controller.js","webpack://honey/../src/elements/element.arc.ts","webpack://honey/../src/elements/element.line.js","webpack://honey/../src/elements/element.point.ts","webpack://honey/../src/elements/element.bar.js","webpack://honey/../src/plugins/plugin.colors.ts","webpack://honey/../src/plugins/plugin.decimation.js","webpack://honey/../src/plugins/plugin.filler/filler.segment.js","webpack://honey/../src/plugins/plugin.filler/filler.helper.js","webpack://honey/../src/plugins/plugin.filler/filler.options.js","webpack://honey/../src/plugins/plugin.filler/filler.target.stack.js","webpack://honey/../src/plugins/plugin.filler/simpleArc.js","webpack://honey/../src/plugins/plugin.filler/filler.target.js","webpack://honey/../src/plugins/plugin.filler/filler.drawing.js","webpack://honey/../src/plugins/plugin.filler/index.js","webpack://honey/../src/plugins/plugin.legend.js","webpack://honey/../src/plugins/plugin.title.js","webpack://honey/../src/plugins/plugin.subtitle.js","webpack://honey/../src/plugins/plugin.tooltip.js","webpack://honey/../src/scales/scale.category.js","webpack://honey/../src/scales/scale.linearbase.js","webpack://honey/../src/scales/scale.linear.js","webpack://honey/../src/scales/scale.logarithmic.js","webpack://honey/../src/scales/scale.radialLinear.js","webpack://honey/../src/scales/scale.time.js","webpack://honey/../src/scales/scale.timeseries.js","webpack://honey/../src/index.ts","webpack://honey/./node_modules/chart.js/auto/auto.js","webpack://honey/./src/constants/chart.js","webpack://honey/src/components/Calculation/CalculationCard.vue","webpack://honey/./src/components/Calculation/CalculationCard.vue?728a","webpack://honey/./src/components/Calculation/CalculationCard.vue?c55c","webpack://honey/src/components/Calculation/CalculationBlock.vue","webpack://honey/./src/components/Calculation/CalculationBlock.vue?91a6","webpack://honey/./src/components/Calculation/CalculationBlock.vue?f6ae","webpack://honey/./src/components/Commodities/CommoditySizeBlock.vue","webpack://honey/./src/components/Commodities/CommodityElement.vue","webpack://honey/src/components/Commodities/CommodityElement.vue","webpack://honey/./src/components/Commodities/CommodityElement.vue?6380","webpack://honey/./src/components/Commodities/CommodityElement.vue?6f71","webpack://honey/src/components/Commodities/CommoditySizeBlock.vue","webpack://honey/./src/components/Commodities/CommoditySizeBlock.vue?3ec2","webpack://honey/./src/components/Commodities/CommoditySizeBlock.vue?b232","webpack://honey/src/views/ManualView.vue","webpack://honey/./src/views/ManualView.vue?4ee9","webpack://honey/./src/views/ManualView.vue?a146","webpack://honey/./node_modules/core-js/internals/array-buffer-basic-detection.js","webpack://honey/./node_modules/core-js/internals/array-buffer-view-core.js","webpack://honey/./node_modules/core-js/internals/array-iteration-from-last.js","webpack://honey/./node_modules/core-js/internals/correct-prototype-getter.js","webpack://honey/./node_modules/core-js/internals/define-built-in-accessor.js","webpack://honey/./node_modules/core-js/internals/object-get-prototype-of.js","webpack://honey/./node_modules/core-js/modules/es.regexp.flags.js","webpack://honey/./node_modules/core-js/modules/es.typed-array.find-last-index.js","webpack://honey/./node_modules/core-js/modules/es.typed-array.find-last.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"manual\"},[_c('Switchers'),(_vm.getSheetData)?_c('div',{staticClass:\"manual-data\"},[_c('CommoditySizeBlock'),_c('CalculationBlock'),_c('FinalBlock')],1):_c('div',{staticClass:\"manual-load\"},[_c('h3',{staticClass:\"manual-load__title\"},[_vm._v(\"Please load data with correct field\")]),_c('AppFileReader')],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return (!_vm.getSheetData)?_c('div',{staticClass:\"file-reader\"},[_c('label',{staticClass:\"file\"},[_c('input',{ref:\"file\",attrs:{\"type\":\"file\",\"name\":\"file\",\"accept\":\".xls,.xlsx\",\"aria-label\":\"File browser example\"},on:{\"change\":_vm.fileOnChange}}),_c('span',{staticClass:\"file-custom\"})])]):_vm._e()\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported XLSX */\n/*global process:false, Buffer:false, ArrayBuffer:false, DataView:false, Deno:false */\nvar XLSX = {};\nXLSX.version = '0.18.5';\nvar current_codepage = 1200, current_ansi = 1252;\n\nvar VALID_ANSI = [ 874, 932, 936, 949, 950, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 10000 ];\n/* ECMA-376 Part I 18.4.1 charset to codepage mapping */\nvar CS2CP = ({\n\t/*::[*/0/*::]*/:    1252, /* ANSI */\n\t/*::[*/1/*::]*/:   65001, /* DEFAULT */\n\t/*::[*/2/*::]*/:   65001, /* SYMBOL */\n\t/*::[*/77/*::]*/:  10000, /* MAC */\n\t/*::[*/128/*::]*/:   932, /* SHIFTJIS */\n\t/*::[*/129/*::]*/:   949, /* HANGUL */\n\t/*::[*/130/*::]*/:  1361, /* JOHAB */\n\t/*::[*/134/*::]*/:   936, /* GB2312 */\n\t/*::[*/136/*::]*/:   950, /* CHINESEBIG5 */\n\t/*::[*/161/*::]*/:  1253, /* GREEK */\n\t/*::[*/162/*::]*/:  1254, /* TURKISH */\n\t/*::[*/163/*::]*/:  1258, /* VIETNAMESE */\n\t/*::[*/177/*::]*/:  1255, /* HEBREW */\n\t/*::[*/178/*::]*/:  1256, /* ARABIC */\n\t/*::[*/186/*::]*/:  1257, /* BALTIC */\n\t/*::[*/204/*::]*/:  1251, /* RUSSIAN */\n\t/*::[*/222/*::]*/:   874, /* THAI */\n\t/*::[*/238/*::]*/:  1250, /* EASTEUROPE */\n\t/*::[*/255/*::]*/:  1252, /* OEM */\n\t/*::[*/69/*::]*/:   6969  /* MISC */\n}/*:any*/);\n\nvar set_ansi = function(cp/*:number*/) { if(VALID_ANSI.indexOf(cp) == -1) return; current_ansi = CS2CP[0] = cp; };\nfunction reset_ansi() { set_ansi(1252); }\n\nvar set_cp = function(cp/*:number*/) { current_codepage = cp; set_ansi(cp); };\nfunction reset_cp() { set_cp(1200); reset_ansi(); }\n\nfunction char_codes(data/*:string*/)/*:Array<number>*/ { var o/*:Array<number>*/ = []; for(var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i); return o; }\n\nfunction utf16leread(data/*:string*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i) + (data.charCodeAt(2*i+1)<<8));\n\treturn o.join(\"\");\n}\nfunction utf16beread(data/*:string*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\tfor(var i = 0; i < (data.length>>1); ++i) o[i] = String.fromCharCode(data.charCodeAt(2*i+1) + (data.charCodeAt(2*i)<<8));\n\treturn o.join(\"\");\n}\n\nvar debom = function(data/*:string*/)/*:string*/ {\n\tvar c1 = data.charCodeAt(0), c2 = data.charCodeAt(1);\n\tif(c1 == 0xFF && c2 == 0xFE) return utf16leread(data.slice(2));\n\tif(c1 == 0xFE && c2 == 0xFF) return utf16beread(data.slice(2));\n\tif(c1 == 0xFEFF) return data.slice(1);\n\treturn data;\n};\n\nvar _getchar = function _gc1(x/*:number*/)/*:string*/ { return String.fromCharCode(x); };\nvar _getansi = function _ga1(x/*:number*/)/*:string*/ { return String.fromCharCode(x); };\n\nvar $cptable;\nfunction set_cptable(cptable) {\n\t$cptable = cptable;\n\tset_cp = function(cp/*:number*/) { current_codepage = cp; set_ansi(cp); };\n\tdebom = function(data/*:string*/) {\n\t\tif(data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) { return $cptable.utils.decode(1200, char_codes(data.slice(2))); }\n\t\treturn data;\n\t};\n\t_getchar = function _gc2(x/*:number*/)/*:string*/ {\n\t\tif(current_codepage === 1200) return String.fromCharCode(x);\n\t\treturn $cptable.utils.decode(current_codepage, [x&255,x>>8])[0];\n\t};\n\t_getansi = function _ga2(x/*:number*/)/*:string*/ {\n\t\treturn $cptable.utils.decode(current_ansi, [x])[0];\n\t};\n\tcpdoit();\n}\nexport { set_cptable };\nvar DENSE = null;\nvar DIF_XL = true;\nvar Base64_map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\nfunction Base64_encode(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  for (var i = 0; i < input.length; ) {\n    c1 = input.charCodeAt(i++);\n    e1 = c1 >> 2;\n    c2 = input.charCodeAt(i++);\n    e2 = (c1 & 3) << 4 | c2 >> 4;\n    c3 = input.charCodeAt(i++);\n    e3 = (c2 & 15) << 2 | c3 >> 6;\n    e4 = c3 & 63;\n    if (isNaN(c2)) {\n      e3 = e4 = 64;\n    } else if (isNaN(c3)) {\n      e4 = 64;\n    }\n    o += Base64_map.charAt(e1) + Base64_map.charAt(e2) + Base64_map.charAt(e3) + Base64_map.charAt(e4);\n  }\n  return o;\n}\nfunction Base64_decode(input) {\n  var o = \"\";\n  var c1 = 0, c2 = 0, c3 = 0, e1 = 0, e2 = 0, e3 = 0, e4 = 0;\n  input = input.replace(/[^\\w\\+\\/\\=]/g, \"\");\n  for (var i = 0; i < input.length; ) {\n    e1 = Base64_map.indexOf(input.charAt(i++));\n    e2 = Base64_map.indexOf(input.charAt(i++));\n    c1 = e1 << 2 | e2 >> 4;\n    o += String.fromCharCode(c1);\n    e3 = Base64_map.indexOf(input.charAt(i++));\n    c2 = (e2 & 15) << 4 | e3 >> 2;\n    if (e3 !== 64) {\n      o += String.fromCharCode(c2);\n    }\n    e4 = Base64_map.indexOf(input.charAt(i++));\n    c3 = (e3 & 3) << 6 | e4;\n    if (e4 !== 64) {\n      o += String.fromCharCode(c3);\n    }\n  }\n  return o;\n}\nvar has_buf = /*#__PURE__*/(function() { return typeof Buffer !== 'undefined' && typeof process !== 'undefined' && typeof process.versions !== 'undefined' && !!process.versions.node; })();\n\nvar Buffer_from = /*#__PURE__*/(function() {\n\tif(typeof Buffer !== 'undefined') {\n\t\tvar nbfs = !Buffer.from;\n\t\tif(!nbfs) try { Buffer.from(\"foo\", \"utf8\"); } catch(e) { nbfs = true; }\n\t\treturn nbfs ? function(buf, enc) { return (enc) ? new Buffer(buf, enc) : new Buffer(buf); } : Buffer.from.bind(Buffer);\n\t}\n\treturn function() {};\n})();\n\n\nfunction new_raw_buf(len/*:number*/) {\n\t/* jshint -W056 */\n\tif(has_buf) return Buffer.alloc ? Buffer.alloc(len) : new Buffer(len);\n\treturn typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n\t/* jshint +W056 */\n}\n\nfunction new_unsafe_buf(len/*:number*/) {\n\t/* jshint -W056 */\n\tif(has_buf) return Buffer.allocUnsafe ? Buffer.allocUnsafe(len) : new Buffer(len);\n\treturn typeof Uint8Array != \"undefined\" ? new Uint8Array(len) : new Array(len);\n\t/* jshint +W056 */\n}\n\nvar s2a = function s2a(s/*:string*/)/*:any*/ {\n\tif(has_buf) return Buffer_from(s, \"binary\");\n\treturn s.split(\"\").map(function(x/*:string*/)/*:number*/{ return x.charCodeAt(0) & 0xff; });\n};\n\nfunction s2ab(s/*:string*/)/*:any*/ {\n\tif(typeof ArrayBuffer === 'undefined') return s2a(s);\n\tvar buf = new ArrayBuffer(s.length), view = new Uint8Array(buf);\n\tfor (var i=0; i!=s.length; ++i) view[i] = s.charCodeAt(i) & 0xFF;\n\treturn buf;\n}\n\nfunction a2s(data/*:any*/)/*:string*/ {\n\tif(Array.isArray(data)) return data.map(function(c) { return String.fromCharCode(c); }).join(\"\");\n\tvar o/*:Array<string>*/ = []; for(var i = 0; i < data.length; ++i) o[i] = String.fromCharCode(data[i]); return o.join(\"\");\n}\n\nfunction a2u(data/*:Array<number>*/)/*:Uint8Array*/ {\n\tif(typeof Uint8Array === 'undefined') throw new Error(\"Unsupported\");\n\treturn new Uint8Array(data);\n}\n\nfunction ab2a(data/*:ArrayBuffer|Uint8Array*/)/*:Array<number>*/ {\n\tif(typeof ArrayBuffer == 'undefined') throw new Error(\"Unsupported\");\n\tif(data instanceof ArrayBuffer) return ab2a(new Uint8Array(data));\n\t/*:: if(data instanceof ArrayBuffer) throw new Error(\"unreachable\"); */\n\tvar o = new Array(data.length);\n\tfor(var i = 0; i < data.length; ++i) o[i] = data[i];\n\treturn o;\n}\n\nvar bconcat = has_buf ? function(bufs) { return Buffer.concat(bufs.map(function(buf) { return Buffer.isBuffer(buf) ? buf : Buffer_from(buf); })); } : function(bufs) {\n\tif(typeof Uint8Array !== \"undefined\") {\n\t\tvar i = 0, maxlen = 0;\n\t\tfor(i = 0; i < bufs.length; ++i) maxlen += bufs[i].length;\n\t\tvar o = new Uint8Array(maxlen);\n\t\tvar len = 0;\n\t\tfor(i = 0, maxlen = 0; i < bufs.length; maxlen += len, ++i) {\n\t\t\tlen = bufs[i].length;\n\t\t\tif(bufs[i] instanceof Uint8Array) o.set(bufs[i], maxlen);\n\t\t\telse if(typeof bufs[i] == \"string\") { throw \"wtf\"; }\n\t\t\telse o.set(new Uint8Array(bufs[i]), maxlen);\n\t\t}\n\t\treturn o;\n\t}\n\treturn [].concat.apply([], bufs.map(function(buf) { return Array.isArray(buf) ? buf : [].slice.call(buf); }));\n};\n\nfunction utf8decode(content/*:string*/) {\n\tvar out = [], widx = 0, L = content.length + 250;\n\tvar o = new_raw_buf(content.length + 255);\n\tfor(var ridx = 0; ridx < content.length; ++ridx) {\n\t\tvar c = content.charCodeAt(ridx);\n\t\tif(c < 0x80) o[widx++] = c;\n\t\telse if(c < 0x800) {\n\t\t\to[widx++] = (192|((c>>6)&31));\n\t\t\to[widx++] = (128|(c&63));\n\t\t} else if(c >= 0xD800 && c < 0xE000) {\n\t\t\tc = (c&1023)+64;\n\t\t\tvar d = content.charCodeAt(++ridx)&1023;\n\t\t\to[widx++] = (240|((c>>8)&7));\n\t\t\to[widx++] = (128|((c>>2)&63));\n\t\t\to[widx++] = (128|((d>>6)&15)|((c&3)<<4));\n\t\t\to[widx++] = (128|(d&63));\n\t\t} else {\n\t\t\to[widx++] = (224|((c>>12)&15));\n\t\t\to[widx++] = (128|((c>>6)&63));\n\t\t\to[widx++] = (128|(c&63));\n\t\t}\n\t\tif(widx > L) {\n\t\t\tout.push(o.slice(0, widx));\n\t\t\twidx = 0;\n\t\t\to = new_raw_buf(65535);\n\t\t\tL = 65530;\n\t\t}\n\t}\n\tout.push(o.slice(0, widx));\n\treturn bconcat(out);\n}\n\nvar chr0 = /\\u0000/g, chr1 = /[\\u0001-\\u0006]/g;\n/*::\ndeclare type Block = any;\ndeclare type BufArray = {\n\tnewblk(sz:number):Block;\n\tnext(sz:number):Block;\n\tend():any;\n\tpush(buf:Block):void;\n};\n\ntype RecordHopperCB = {(d:any, Rn:string, RT:number):?boolean;};\n\ntype EvertType = {[string]:string};\ntype EvertNumType = {[string]:number};\ntype EvertArrType = {[string]:Array<string>};\n\ntype StringConv = {(string):string};\n\n*/\n/* ssf.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/*jshint -W041 */\nfunction _strrev(x/*:string*/)/*:string*/ { var o = \"\", i = x.length-1; while(i>=0) o += x.charAt(i--); return o; }\nfunction pad0(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad_(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+v;return t.length>=d?t:fill(' ',d-t.length)+t;}\nfunction rpad_(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+v; return t.length>=d?t:t+fill(' ',d-t.length);}\nfunction pad0r1(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+Math.round(v); return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad0r2(v/*:any*/,d/*:number*/)/*:string*/{var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nvar p2_32 = /*#__PURE__*/Math.pow(2,32);\nfunction pad0r(v/*:any*/,d/*:number*/)/*:string*/{if(v>p2_32||v<-p2_32) return pad0r1(v,d); var i = Math.round(v); return pad0r2(i,d); }\n/* yes, in 2022 this is still faster than string compare */\nfunction SSF_isgeneral(s/*:string*/, i/*:?number*/)/*:boolean*/ { i = i || 0; return s.length >= 7 + i && (s.charCodeAt(i)|32) === 103 && (s.charCodeAt(i+1)|32) === 101 && (s.charCodeAt(i+2)|32) === 110 && (s.charCodeAt(i+3)|32) === 101 && (s.charCodeAt(i+4)|32) === 114 && (s.charCodeAt(i+5)|32) === 97 && (s.charCodeAt(i+6)|32) === 108; }\nvar days/*:Array<Array<string> >*/ = [\n\t['Sun', 'Sunday'],\n\t['Mon', 'Monday'],\n\t['Tue', 'Tuesday'],\n\t['Wed', 'Wednesday'],\n\t['Thu', 'Thursday'],\n\t['Fri', 'Friday'],\n\t['Sat', 'Saturday']\n];\nvar months/*:Array<Array<string> >*/ = [\n\t['J', 'Jan', 'January'],\n\t['F', 'Feb', 'February'],\n\t['M', 'Mar', 'March'],\n\t['A', 'Apr', 'April'],\n\t['M', 'May', 'May'],\n\t['J', 'Jun', 'June'],\n\t['J', 'Jul', 'July'],\n\t['A', 'Aug', 'August'],\n\t['S', 'Sep', 'September'],\n\t['O', 'Oct', 'October'],\n\t['N', 'Nov', 'November'],\n\t['D', 'Dec', 'December']\n];\nfunction SSF_init_table(t/*:any*/) {\n\tif(!t) t = {};\n\tt[0]=  'General';\n\tt[1]=  '0';\n\tt[2]=  '0.00';\n\tt[3]=  '#,##0';\n\tt[4]=  '#,##0.00';\n\tt[9]=  '0%';\n\tt[10]= '0.00%';\n\tt[11]= '0.00E+00';\n\tt[12]= '# ?/?';\n\tt[13]= '# ??/??';\n\tt[14]= 'm/d/yy';\n\tt[15]= 'd-mmm-yy';\n\tt[16]= 'd-mmm';\n\tt[17]= 'mmm-yy';\n\tt[18]= 'h:mm AM/PM';\n\tt[19]= 'h:mm:ss AM/PM';\n\tt[20]= 'h:mm';\n\tt[21]= 'h:mm:ss';\n\tt[22]= 'm/d/yy h:mm';\n\tt[37]= '#,##0 ;(#,##0)';\n\tt[38]= '#,##0 ;[Red](#,##0)';\n\tt[39]= '#,##0.00;(#,##0.00)';\n\tt[40]= '#,##0.00;[Red](#,##0.00)';\n\tt[45]= 'mm:ss';\n\tt[46]= '[h]:mm:ss';\n\tt[47]= 'mmss.0';\n\tt[48]= '##0.0E+0';\n\tt[49]= '@';\n\tt[56]= '\"/ \"hh\"\"mm\"\"ss\" \"';\n\treturn t;\n}\n/* repeated to satiate webpack */\nvar table_fmt = {\n\t0:  'General',\n\t1:  '0',\n\t2:  '0.00',\n\t3:  '#,##0',\n\t4:  '#,##0.00',\n\t9:  '0%',\n\t10: '0.00%',\n\t11: '0.00E+00',\n\t12: '# ?/?',\n\t13: '# ??/??',\n\t14: 'm/d/yy',\n\t15: 'd-mmm-yy',\n\t16: 'd-mmm',\n\t17: 'mmm-yy',\n\t18: 'h:mm AM/PM',\n\t19: 'h:mm:ss AM/PM',\n\t20: 'h:mm',\n\t21: 'h:mm:ss',\n\t22: 'm/d/yy h:mm',\n\t37: '#,##0 ;(#,##0)',\n\t38: '#,##0 ;[Red](#,##0)',\n\t39: '#,##0.00;(#,##0.00)',\n\t40: '#,##0.00;[Red](#,##0.00)',\n\t45: 'mm:ss',\n\t46: '[h]:mm:ss',\n\t47: 'mmss.0',\n\t48: '##0.0E+0',\n\t49: '@',\n\t56: '\"/ \"hh\"\"mm\"\"ss\" \"'\n};\n\n/* Defaults determined by systematically testing in Excel 2019 */\n\n/* These formats appear to default to other formats in the table */\nvar SSF_default_map = {\n\t5:  37, 6:  38, 7:  39, 8:  40,         //  5 -> 37 ...  8 -> 40\n\n\t23:  0, 24:  0, 25:  0, 26:  0,         // 23 ->  0 ... 26 ->  0\n\n\t27: 14, 28: 14, 29: 14, 30: 14, 31: 14, // 27 -> 14 ... 31 -> 14\n\n\t50: 14, 51: 14, 52: 14, 53: 14, 54: 14, // 50 -> 14 ... 58 -> 14\n\t55: 14, 56: 14, 57: 14, 58: 14,\n\t59:  1, 60:  2, 61:  3, 62:  4,         // 59 ->  1 ... 62 ->  4\n\n\t67:  9, 68: 10,                         // 67 ->  9 ... 68 -> 10\n\t69: 12, 70: 13, 71: 14,                 // 69 -> 12 ... 71 -> 14\n\t72: 14, 73: 15, 74: 16, 75: 17,         // 72 -> 14 ... 75 -> 17\n\t76: 20, 77: 21, 78: 22,                 // 76 -> 20 ... 78 -> 22\n\t79: 45, 80: 46, 81: 47,                 // 79 -> 45 ... 81 -> 47\n\t82: 0                                   // 82 ->  0 ... 65536 -> 0 (omitted)\n};\n\n\n/* These formats technically refer to Accounting formats with no equivalent */\nvar SSF_default_str = {\n\t//  5 -- Currency,   0 decimal, black negative\n\t5:  '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t63: '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\n\t//  6 -- Currency,   0 decimal, red   negative\n\t6:  '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t64: '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\n\t//  7 -- Currency,   2 decimal, black negative\n\t7:  '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t65: '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\n\t//  8 -- Currency,   2 decimal, red   negative\n\t8:  '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t66: '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\n\t// 41 -- Accounting, 0 decimal, No Symbol\n\t41: '_(* #,##0_);_(* \\\\(#,##0\\\\);_(* \"-\"_);_(@_)',\n\n\t// 42 -- Accounting, 0 decimal, $  Symbol\n\t42: '_(\"$\"* #,##0_);_(\"$\"* \\\\(#,##0\\\\);_(\"$\"* \"-\"_);_(@_)',\n\n\t// 43 -- Accounting, 2 decimal, No Symbol\n\t43: '_(* #,##0.00_);_(* \\\\(#,##0.00\\\\);_(* \"-\"??_);_(@_)',\n\n\t// 44 -- Accounting, 2 decimal, $  Symbol\n\t44: '_(\"$\"* #,##0.00_);_(\"$\"* \\\\(#,##0.00\\\\);_(\"$\"* \"-\"??_);_(@_)'\n};\n\nfunction SSF_frac(x/*:number*/, D/*:number*/, mixed/*:?boolean*/)/*:Array<number>*/ {\n\tvar sgn = x < 0 ? -1 : 1;\n\tvar B = x * sgn;\n\tvar P_2 = 0, P_1 = 1, P = 0;\n\tvar Q_2 = 1, Q_1 = 0, Q = 0;\n\tvar A = Math.floor(B);\n\twhile(Q_1 < D) {\n\t\tA = Math.floor(B);\n\t\tP = A * P_1 + P_2;\n\t\tQ = A * Q_1 + Q_2;\n\t\tif((B - A) < 0.00000005) break;\n\t\tB = 1 / (B - A);\n\t\tP_2 = P_1; P_1 = P;\n\t\tQ_2 = Q_1; Q_1 = Q;\n\t}\n\tif(Q > D) { if(Q_1 > D) { Q = Q_2; P = P_2; } else { Q = Q_1; P = P_1; } }\n\tif(!mixed) return [0, sgn * P, Q];\n\tvar q = Math.floor(sgn * P/Q);\n\treturn [q, sgn*P - q*Q, Q];\n}\nfunction SSF_parse_date_code(v/*:number*/,opts/*:?any*/,b2/*:?boolean*/) {\n\tif(v > 2958465 || v < 0) return null;\n\tvar date = (v|0), time = Math.floor(86400 * (v - date)), dow=0;\n\tvar dout=[];\n\tvar out={D:date, T:time, u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};\n\tif(Math.abs(out.u) < 1e-6) out.u = 0;\n\tif(opts && opts.date1904) date += 1462;\n\tif(out.u > 0.9999) {\n\t\tout.u = 0;\n\t\tif(++time == 86400) { out.T = time = 0; ++date; ++out.D; }\n\t}\n\tif(date === 60) {dout = b2 ? [1317,10,29] : [1900,2,29]; dow=3;}\n\telse if(date === 0) {dout = b2 ? [1317,8,29] : [1900,1,0]; dow=6;}\n\telse {\n\t\tif(date > 60) --date;\n\t\t/* 1 = Jan 1 1900 in Gregorian */\n\t\tvar d = new Date(1900, 0, 1);\n\t\td.setDate(d.getDate() + date - 1);\n\t\tdout = [d.getFullYear(), d.getMonth()+1,d.getDate()];\n\t\tdow = d.getDay();\n\t\tif(date < 60) dow = (dow + 6) % 7;\n\t\tif(b2) dow = SSF_fix_hijri(d, dout);\n\t}\n\tout.y = dout[0]; out.m = dout[1]; out.d = dout[2];\n\tout.S = time % 60; time = Math.floor(time / 60);\n\tout.M = time % 60; time = Math.floor(time / 60);\n\tout.H = time;\n\tout.q = dow;\n\treturn out;\n}\nvar SSFbasedate = /*#__PURE__*/new Date(1899, 11, 31, 0, 0, 0);\nvar SSFdnthresh = /*#__PURE__*/SSFbasedate.getTime();\nvar SSFbase1904 = /*#__PURE__*/new Date(1900, 2, 1, 0, 0, 0);\nfunction datenum_local(v/*:Date*/, date1904/*:?boolean*/)/*:number*/ {\n\tvar epoch = /*#__PURE__*/v.getTime();\n\tif(date1904) epoch -= 1461*24*60*60*1000;\n\telse if(v >= SSFbase1904) epoch += 24*60*60*1000;\n\treturn (epoch - (SSFdnthresh + (/*#__PURE__*/v.getTimezoneOffset() - /*#__PURE__*/SSFbasedate.getTimezoneOffset()) * 60000)) / (24 * 60 * 60 * 1000);\n}\n/* ECMA-376 18.8.30 numFmt*/\n/* Note: `toPrecision` uses standard form when prec > E and E >= -6 */\n/* exponent >= -9 and <= 9 */\nfunction SSF_strip_decimal(o/*:string*/)/*:string*/ {\n\treturn (o.indexOf(\".\") == -1) ? o : o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)$/, \"$1\");\n}\n\n/* General Exponential always shows 2 digits exp and trims the mantissa */\nfunction SSF_normalize_exp(o/*:string*/)/*:string*/ {\n\tif(o.indexOf(\"E\") == -1) return o;\n\treturn o.replace(/(?:\\.0*|(\\.\\d*[1-9])0+)[Ee]/,\"$1E\").replace(/(E[+-])(\\d)$/,\"$10$2\");\n}\n\n/* exponent >= -9 and <= 9 */\nfunction SSF_small_exp(v/*:number*/)/*:string*/ {\n\tvar w = (v<0?12:11);\n\tvar o = SSF_strip_decimal(v.toFixed(12)); if(o.length <= w) return o;\n\to = v.toPrecision(10); if(o.length <= w) return o;\n\treturn v.toExponential(5);\n}\n\n/* exponent >= 11 or <= -10 likely exponential */\nfunction SSF_large_exp(v/*:number*/)/*:string*/ {\n\tvar o = SSF_strip_decimal(v.toFixed(11));\n\treturn (o.length > (v<0?12:11) || o === \"0\" || o === \"-0\") ? v.toPrecision(6) : o;\n}\n\nfunction SSF_general_num(v/*:number*/)/*:string*/ {\n\tvar V = Math.floor(Math.log(Math.abs(v))*Math.LOG10E), o;\n\n\tif(V >= -4 && V <= -1) o = v.toPrecision(10+V);\n\telse if(Math.abs(V) <= 9) o = SSF_small_exp(v);\n\telse if(V === 10) o = v.toFixed(10).substr(0,12);\n\telse o = SSF_large_exp(v);\n\n\treturn SSF_strip_decimal(SSF_normalize_exp(o.toUpperCase()));\n}\n\n\n/*\n\t\"General\" rules:\n\t- text is passed through (\"@\")\n\t- booleans are rendered as TRUE/FALSE\n\t- \"up to 11 characters\" displayed for numbers\n\t- Default date format (code 14) used for Dates\n\n\tThe longest 32-bit integer text is \"-2147483648\", exactly 11 chars\n\tTODO: technically the display depends on the width of the cell\n*/\nfunction SSF_general(v/*:any*/, opts/*:any*/) {\n\tswitch(typeof v) {\n\t\tcase 'string': return v;\n\t\tcase 'boolean': return v ? \"TRUE\" : \"FALSE\";\n\t\tcase 'number': return (v|0) === v ? v.toString(10) : SSF_general_num(v);\n\t\tcase 'undefined': return \"\";\n\t\tcase 'object':\n\t\t\tif(v == null) return \"\";\n\t\t\tif(v instanceof Date) return SSF_format(14, datenum_local(v, opts && opts.date1904), opts);\n\t}\n\tthrow new Error(\"unsupported value in General format: \" + v);\n}\n\nfunction SSF_fix_hijri(date/*:Date*/, o/*:[number, number, number]*/) {\n  /* TODO: properly adjust y/m/d and  */\n  o[0] -= 581;\n  var dow = date.getDay();\n  if(date < 60) dow = (dow + 6) % 7;\n  return dow;\n}\n//var THAI_DIGITS = \"\\u0E50\\u0E51\\u0E52\\u0E53\\u0E54\\u0E55\\u0E56\\u0E57\\u0E58\\u0E59\".split(\"\");\nfunction SSF_write_date(type/*:number*/, fmt/*:string*/, val, ss0/*:?number*/)/*:string*/ {\n\tvar o=\"\", ss=0, tt=0, y = val.y, out, outl = 0;\n\tswitch(type) {\n\t\tcase 98: /* 'b' buddhist year */\n\t\t\ty = val.y + 543;\n\t\t\t/* falls through */\n\t\tcase 121: /* 'y' year */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = y % 100; outl = 2; break;\n\t\t\tdefault: out = y % 10000; outl = 4; break;\n\t\t} break;\n\t\tcase 109: /* 'm' month */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.m; outl = fmt.length; break;\n\t\t\tcase 3: return months[val.m-1][1];\n\t\t\tcase 5: return months[val.m-1][0];\n\t\t\tdefault: return months[val.m-1][2];\n\t\t} break;\n\t\tcase 100: /* 'd' day */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.d; outl = fmt.length; break;\n\t\t\tcase 3: return days[val.q][0];\n\t\t\tdefault: return days[val.q][1];\n\t\t} break;\n\t\tcase 104: /* 'h' 12-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = 1+(val.H+11)%12; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 72: /* 'H' 24-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.H; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 77: /* 'M' minutes */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.M; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad minute format: ' + fmt;\n\t\t} break;\n\t\tcase 115: /* 's' seconds */\n\t\t\tif(fmt != 's' && fmt != 'ss' && fmt != '.0' && fmt != '.00' && fmt != '.000') throw 'bad second format: ' + fmt;\n\t\t\tif(val.u === 0 && (fmt == \"s\" || fmt == \"ss\")) return pad0(val.S, fmt.length);\n\t\t\t/*::if(!ss0) ss0 = 0; */\n\t\t\tif(ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;\n\t\t\telse tt = ss0 === 1 ? 10 : 1;\n\t\t\tss = Math.round((tt)*(val.S + val.u));\n\t\t\tif(ss >= 60*tt) ss = 0;\n\t\t\tif(fmt === 's') return ss === 0 ? \"0\" : \"\"+ss/tt;\n\t\t\to = pad0(ss,2 + ss0);\n\t\t\tif(fmt === 'ss') return o.substr(0,2);\n\t\t\treturn \".\" + o.substr(2,fmt.length-1);\n\t\tcase 90: /* 'Z' absolute time */\n\t\tswitch(fmt) {\n\t\t\tcase '[h]': case '[hh]': out = val.D*24+val.H; break;\n\t\t\tcase '[m]': case '[mm]': out = (val.D*24+val.H)*60+val.M; break;\n\t\t\tcase '[s]': case '[ss]': out = ((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u); break;\n\t\t\tdefault: throw 'bad abstime format: ' + fmt;\n\t\t} outl = fmt.length === 3 ? 1 : 2; break;\n\t\tcase 101: /* 'e' era */\n\t\t\tout = y; outl = 1; break;\n\t}\n\tvar outstr = outl > 0 ? pad0(out, outl) : \"\";\n\treturn outstr;\n}\n\n\n/*jshint -W086 */\n/*jshint +W086 */\nfunction commaify(s/*:string*/)/*:string*/ {\n\tvar w = 3;\n\tif(s.length <= w) return s;\n\tvar j = (s.length % w), o = s.substr(0,j);\n\tfor(; j!=s.length; j+=w) o+=(o.length > 0 ? \",\" : \"\") + s.substr(j,w);\n\treturn o;\n}\nvar pct1 = /%/g;\nfunction write_num_pct(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\n\nfunction write_num_cm(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\n\nfunction write_num_exp(fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar o/*:string*/;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tif(val == 0) return \"0.0E+0\";\n\t\telse if(val < 0) return \"-\" + write_num_exp(fmt, -val);\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(o.indexOf(\"e\") === -1) {\n\t\t\tvar fakee = Math.floor(Math.log(val)*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\twhile(o.substr(0,2) === \"0.\") {\n\t\t\t\to = o.charAt(0) + o.substr(2,period) + \".\" + o.substr(2+period);\n\t\t\t\to = o.replace(/^0+([1-9])/,\"$1\").replace(/^0+\\./,\"0.\");\n\t\t\t}\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nvar frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\nfunction write_num_f1(r/*:Array<string>*/, aval/*:number*/, sign/*:string*/)/*:string*/ {\n\tvar den = parseInt(r[4],10), rr = Math.round(aval * den), base = Math.floor(rr/den);\n\tvar myn = (rr - base*den), myd = den;\n\treturn sign + (base === 0 ? \"\" : \"\"+base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn,r[1].length) + r[2] + \"/\" + r[3] + pad0(myd,r[4].length));\n}\nfunction write_num_f2(r/*:Array<string>*/, aval/*:number*/, sign/*:string*/)/*:string*/ {\n\treturn sign + (aval === 0 ? \"\" : \"\"+aval) + fill(\" \", r[1].length + 2 + r[4].length);\n}\nvar dec1 = /^#*0*\\.([0#]+)/;\nvar closeparen = /\\).*[0#]/;\nvar phone = /\\(###\\) ###\\\\?-####/;\nfunction hashq(str/*:string*/)/*:string*/ {\n\tvar o = \"\", cc;\n\tfor(var i = 0; i != str.length; ++i) switch((cc=str.charCodeAt(i))) {\n\t\tcase 35: break;\n\t\tcase 63: o+= \" \"; break;\n\t\tcase 48: o+= \"0\"; break;\n\t\tdefault: o+= String.fromCharCode(cc);\n\t}\n\treturn o;\n}\nfunction rnd(val/*:number*/, d/*:number*/)/*:string*/ { var dd = Math.pow(10,d); return \"\"+(Math.round(val * dd)/dd); }\nfunction dec(val/*:number*/, d/*:number*/)/*:number*/ {\n\tvar _frac = val - Math.floor(val), dd = Math.pow(10,d);\n\tif (d < ('' + Math.round(_frac * dd)).length) return 0;\n\treturn Math.round(_frac * dd);\n}\nfunction carry(val/*:number*/, d/*:number*/)/*:number*/ {\n\tif (d < ('' + Math.round((val-Math.floor(val))*Math.pow(10,d))).length) {\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nfunction flr(val/*:number*/)/*:string*/ {\n\tif(val < 2147483647 && val > -2147483648) return \"\"+(val >= 0 ? (val|0) : (val-1|0));\n\treturn \"\"+Math.floor(val);\n}\nfunction write_num_flt(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/ {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_flt('n', ffmt, val);\n\t\treturn '(' + write_num_flt('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_flt(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\n\tvar o;\n\tvar r/*:?Array<string>*/, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0r(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = pad0r(val,0); if(o === \"0\") o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1))) return write_num_f1(r, aval, sign);\n\tif(fmt.match(/^#+0+$/)) return sign + pad0r(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1))) {\n\t\to = rnd(val, r[1].length).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1])).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", hashq(/*::(*/r/*::||[\"\"])*/[1]).length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify(pad0r(aval,0));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\"+(Math.floor(val) + carry(val, r[1].length))) + \".\" + pad0(dec(val, r[1].length),r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/))) return write_num_flt(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone)) {\n\t\to = write_num_flt(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(/*::String(*/r[4]/*::)*/.length,7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", /*::String(*/r[1]/*::)*/, ff[1]);\n\t\tif(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + /*::String(*/r[2]/*::)*/ + \"/\" + /*::String(*/r[3]/*::)*/;\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/))) {\n\t\to = pad0r(val, 0);\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0?]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\tri = dec(val, r[1].length);\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(ri,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"###,##0.00\": return write_num_flt(type, \"#,##0.00\", val);\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": var x = commaify(pad0r(aval,0)); return x !== \"0\" ? sign + x : \"\";\n\t\tcase \"###,###.00\": return write_num_flt(type, \"###,##0.00\",val).replace(/^0\\./,\".\");\n\t\tcase \"#,###.00\": return write_num_flt(type, \"#,##0.00\",val).replace(/^0\\./,\".\");\n\t\tdefault:\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num_cm2(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\nfunction write_num_pct2(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\nfunction write_num_exp2(fmt/*:string*/, val/*:number*/)/*:string*/{\n\tvar o/*:string*/;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tif(val == 0) return \"0.0E+0\";\n\t\telse if(val < 0) return \"-\" + write_num_exp2(fmt, -val);\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(val)*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(!o.match(/[Ee]/)) {\n\t\t\tvar fakee = Math.floor(Math.log(val)*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o.charAt(0) + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o.charAt(o.length-1);\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nfunction write_num_int(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/ {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_int('n', ffmt, val);\n\t\treturn '(' + write_num_int('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_int(type,fmt.substr(fmt.charAt(1)==' '?2:1),val);\n\tvar o;\n\tvar r/*:?Array<string>*/, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = (\"\"+val); if(val === 0) o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1))) return write_num_f2(r, aval, sign);\n\tif(fmt.match(/^#+0+$/)) return sign + pad0(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1))) {\n\t\t/*:: if(!Array.isArray(r)) throw new Error(\"unreachable\"); */\n\t\to = (\"\"+val).replace(/^([^\\.]+)$/,\"$1.\"+hashq(r[1])).replace(/\\.$/,\".\"+hashq(r[1]));\n\t\to = o.replace(/\\.(\\d*)$/,function($$, $1) {\n\t\t/*:: if(!Array.isArray(r)) throw new Error(\"unreachable\"); */\n\t\t\treturn \".\" + $1 + fill(\"0\", hashq(r[1]).length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/))) {\n\t\treturn sign + (\"\"+aval).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#{1,3},##0(\\.?)$/))) return sign + commaify((\"\"+aval));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify((\"\"+val)) + \".\" + fill('0',r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/))) return write_num_int(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/))) {\n\t\to = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o.charAt(ri++):x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone)) {\n\t\to = write_num_int(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(/*::String(*/r[4]/*::)*/.length,7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", /*::String(*/r[1]/*::)*/, ff[1]);\n\t\tif(oa.charAt(oa.length-1) == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + /*::String(*/r[2]/*::)*/ + \"/\" + /*::String(*/r[3]/*::)*/;\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/))) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = SSF_frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/))) {\n\t\to = \"\" + val;\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0]+)\\.([#0]+)$/))) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/))) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\"+val).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(0,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"###,###\":\n\t\tcase \"##,###\":\n\t\tcase \"#,###\": var x = commaify(\"\"+aval); return x !== \"0\" ? sign + x : \"\";\n\t\tdefault:\n\t\t\tif(fmt.match(/\\.[0#?]*$/)) return write_num_int(type, fmt.slice(0,fmt.lastIndexOf(\".\")), val) + hashq(fmt.slice(fmt.lastIndexOf(\".\")));\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num(type/*:string*/, fmt/*:string*/, val/*:number*/)/*:string*/ {\n\treturn (val|0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n}\nfunction SSF_split_fmt(fmt/*:string*/)/*:Array<string>*/ {\n\tvar out/*:Array<string>*/ = [];\n\tvar in_str = false/*, cc*/;\n\tfor(var i = 0, j = 0; i < fmt.length; ++i) switch((/*cc=*/fmt.charCodeAt(i))) {\n\t\tcase 34: /* '\"' */\n\t\t\tin_str = !in_str; break;\n\t\tcase 95: case 42: case 92: /* '_' '*' '\\\\' */\n\t\t\t++i; break;\n\t\tcase 59: /* ';' */\n\t\t\tout[out.length] = fmt.substr(j,i-j);\n\t\t\tj = i+1;\n\t}\n\tout[out.length] = fmt.substr(j);\n\tif(in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n\treturn out;\n}\n\nvar SSF_abstime = /\\[[HhMmSs\\u0E0A\\u0E19\\u0E17]*\\]/;\nfunction fmt_is_date(fmt/*:string*/)/*:boolean*/ {\n\tvar i = 0, /*cc = 0,*/ c = \"\", o = \"\";\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt.charAt(i))) {\n\t\t\tcase 'G': if(SSF_isgeneral(fmt, i)) i+= 6; i++; break;\n\t\t\tcase '\"': for(;(/*cc=*/fmt.charCodeAt(++i)) !== 34 && i < fmt.length;){/*empty*/} ++i; break;\n\t\t\tcase '\\\\': i+=2; break;\n\t\t\tcase '_': i+=2; break;\n\t\t\tcase '@': ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") return true;\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g': return true;\n\t\t\tcase 'A': case 'a': case '':\n\t\t\t\tif(fmt.substr(i, 3).toUpperCase() === \"A/P\") return true;\n\t\t\t\tif(fmt.substr(i, 5).toUpperCase() === \"AM/PM\") return true;\n\t\t\t\tif(fmt.substr(i, 5).toUpperCase() === \"/\") return true;\n\t\t\t\t++i; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif(o.match(SSF_abstime)) return true;\n\t\t\t\tbreak;\n\t\t\tcase '.':\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\twhile(i < fmt.length && (\"0#?.,E+-%\".indexOf(c=fmt.charAt(++i)) > -1 || (c=='\\\\' && fmt.charAt(i+1) == \"-\" && \"0#\".indexOf(fmt.charAt(i+2))>-1))){/* empty */}\n\t\t\t\tbreak;\n\t\t\tcase '?': while(fmt.charAt(++i) === c){/* empty */} break;\n\t\t\tcase '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break;\n\t\t\tcase '(': case ')': ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\twhile(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1){/* empty */} break;\n\t\t\tcase ' ': ++i; break;\n\t\t\tdefault: ++i; break;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction eval_fmt(fmt/*:string*/, v/*:any*/, opts/*:any*/, flen/*:number*/) {\n\tvar out = [], o = \"\", i = 0, c = \"\", lst='t', dt, j, cc;\n\tvar hr='H';\n\t/* Tokenize */\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt.charAt(i))) {\n\t\t\tcase 'G': /* General */\n\t\t\t\tif(!SSF_isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' +fmt);\n\t\t\t\tout[out.length] = {t:'G', v:'General'}; i+=7; break;\n\t\t\tcase '\"': /* Literal text */\n\t\t\t\tfor(o=\"\";(cc=fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n\t\t\t\tout[out.length] = {t:'t', v:o}; ++i; break;\n\t\t\tcase '\\\\': var w = fmt.charAt(++i), t = (w === \"(\" || w === \")\") ? w : 't';\n\t\t\t\tout[out.length] = {t:t, v:w}; ++i; break;\n\t\t\tcase '_': out[out.length] = {t:'t', v:\" \"}; i+=2; break;\n\t\t\tcase '@': /* Text Placeholder */\n\t\t\t\tout[out.length] = {t:'T', v:v}; ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt.charAt(i+1) === \"1\" || fmt.charAt(i+1) === \"2\") {\n\t\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts, fmt.charAt(i+1) === \"2\"); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'X', v:fmt.substr(i,2)}; lst = c; i+=2; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\tc = c.toLowerCase();\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g':\n\t\t\t\tif(v < 0) return \"\";\n\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\to = c; while(++i < fmt.length && fmt.charAt(i).toLowerCase() === c) o+=c;\n\t\t\t\tif(c === 'm' && lst.toLowerCase() === 'h') c = 'M';\n\t\t\t\tif(c === 'h') c = hr;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase 'A': case 'a': case '':\n\t\t\t\tvar q={t:c, v:c};\n\t\t\t\tif(dt==null) dt=SSF_parse_date_code(v, opts);\n\t\t\t\tif(fmt.substr(i, 3).toUpperCase() === \"A/P\") { if(dt!=null) q.v = dt.H >= 12 ? \"P\" : \"A\"; q.t = 'T'; hr='h';i+=3;}\n\t\t\t\telse if(fmt.substr(i,5).toUpperCase() === \"AM/PM\") { if(dt!=null) q.v = dt.H >= 12 ? \"PM\" : \"AM\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse if(fmt.substr(i,5).toUpperCase() === \"/\") { if(dt!=null) q.v = dt.H >= 12 ? \"\" : \"\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse { q.t = \"t\"; ++i; }\n\t\t\t\tif(dt==null && q.t === 'T') return \"\";\n\t\t\t\tout[out.length] = q; lst = c; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt.charAt(i++) !== ']' && i < fmt.length) o += fmt.charAt(i);\n\t\t\t\tif(o.slice(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\t\t\t\tif(o.match(SSF_abstime)) {\n\t\t\t\t\tif(dt==null) { dt=SSF_parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'Z', v:o.toLowerCase()};\n\t\t\t\t\tlst = o.charAt(1);\n\t\t\t\t} else if(o.indexOf(\"$\") > -1) {\n\t\t\t\t\to = (o.match(/\\$([^-\\[\\]]*)/)||[])[1]||\"$\";\n\t\t\t\t\tif(!fmt_is_date(fmt)) out[out.length] = {t:'t',v:o};\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t/* Numbers */\n\t\t\tcase '.':\n\t\t\t\tif(dt != null) {\n\t\t\t\t\to = c; while(++i < fmt.length && (c=fmt.charAt(i)) === \"0\") o += c;\n\t\t\t\t\tout[out.length] = {t:'s', v:o}; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\to = c; while(++i < fmt.length && \"0#?.,E+-%\".indexOf(c=fmt.charAt(i)) > -1) o += c;\n\t\t\t\tout[out.length] = {t:'n', v:o}; break;\n\t\t\tcase '?':\n\t\t\t\to = c; while(fmt.charAt(++i) === c) o+=c;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase '*': ++i; if(fmt.charAt(i) == ' ' || fmt.charAt(i) == '*') ++i; break; // **\n\t\t\tcase '(': case ')': out[out.length] = {t:(flen===1?'t':c), v:c}; ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\to = c; while(i < fmt.length && \"0123456789\".indexOf(fmt.charAt(++i)) > -1) o+=fmt.charAt(i);\n\t\t\t\tout[out.length] = {t:'D', v:o}; break;\n\t\t\tcase ' ': out[out.length] = {t:c, v:c}; ++i; break;\n\t\t\tcase '$': out[out.length] = {t:'t', v:'$'}; ++i; break;\n\t\t\tdefault:\n\t\t\t\tif(\",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n\t\t\t\tout[out.length] = {t:'t', v:c}; ++i; break;\n\t\t}\n\t}\n\n\t/* Scan for date/time parts */\n\tvar bt = 0, ss0 = 0, ssm;\n\tfor(i=out.length-1, lst='t'; i >= 0; --i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 'h': case 'H': out[i].t = hr; lst='h'; if(bt < 1) bt = 1; break;\n\t\t\tcase 's':\n\t\t\t\tif((ssm=out[i].v.match(/\\.0+$/))) ss0=Math.max(ss0,ssm[0].length-1);\n\t\t\t\tif(bt < 3) bt = 3;\n\t\t\t/* falls through */\n\t\t\tcase 'd': case 'y': case 'M': case 'e': lst=out[i].t; break;\n\t\t\tcase 'm': if(lst === 's') { out[i].t = 'M'; if(bt < 2) bt = 2; } break;\n\t\t\tcase 'X': /*if(out[i].v === \"B2\");*/\n\t\t\t\tbreak;\n\t\t\tcase 'Z':\n\t\t\t\tif(bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n\t\t\t\tif(bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n\t\t\t\tif(bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n\t\t}\n\t}\n\t/* time rounding depends on presence of minute / second / usec fields */\n\tswitch(bt) {\n\t\tcase 0: break;\n\t\tcase 1:\n\t\t\t/*::if(!dt) break;*/\n\t\t\tif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tif(dt.M >=  60) { dt.M = 0; ++dt.H; }\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\t/*::if(!dt) break;*/\n\t\t\tif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tbreak;\n\t}\n\n\t/* replace fields */\n\tvar nstr = \"\", jj;\n\tfor(i=0; i < out.length; ++i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 't': case 'T': case ' ': case 'D': break;\n\t\t\tcase 'X': out[i].v = \"\"; out[i].t = \";\"; break;\n\t\t\tcase 'd': case 'm': case 'y': case 'h': case 'H': case 'M': case 's': case 'e': case 'b': case 'Z':\n\t\t\t\t/*::if(!dt) throw \"unreachable\"; */\n\t\t\t\tout[i].v = SSF_write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n\t\t\t\tout[i].t = 't'; break;\n\t\t\tcase 'n': case '?':\n\t\t\t\tjj = i+1;\n\t\t\t\twhile(out[jj] != null && (\n\t\t\t\t\t(c=out[jj].t) === \"?\" || c === \"D\" ||\n\t\t\t\t\t((c === \" \" || c === \"t\") && out[jj+1] != null && (out[jj+1].t === '?' || out[jj+1].t === \"t\" && out[jj+1].v === '/')) ||\n\t\t\t\t\t(out[i].t === '(' && (c === ' ' || c === 'n' || c === ')')) ||\n\t\t\t\t\t(c === 't' && (out[jj].v === '/' || out[jj].v === ' ' && out[jj+1] != null && out[jj+1].t == '?'))\n\t\t\t\t)) {\n\t\t\t\t\tout[i].v += out[jj].v;\n\t\t\t\t\tout[jj] = {v:\"\", t:\";\"}; ++jj;\n\t\t\t\t}\n\t\t\t\tnstr += out[i].v;\n\t\t\t\ti = jj-1; break;\n\t\t\tcase 'G': out[i].t = 't'; out[i].v = SSF_general(v,opts); break;\n\t\t}\n\t}\n\tvar vv = \"\", myv, ostr;\n\tif(nstr.length > 0) {\n\t\tif(nstr.charCodeAt(0) == 40) /* '(' */ {\n\t\t\tmyv = (v<0&&nstr.charCodeAt(0) === 45 ? -v : v);\n\t\t\tostr = write_num('n', nstr, myv);\n\t\t} else {\n\t\t\tmyv = (v<0 && flen > 1 ? -v : v);\n\t\t\tostr = write_num('n', nstr, myv);\n\t\t\tif(myv < 0 && out[0] && out[0].t == 't') {\n\t\t\t\tostr = ostr.substr(1);\n\t\t\t\tout[0].v = \"-\" + out[0].v;\n\t\t\t}\n\t\t}\n\t\tjj=ostr.length-1;\n\t\tvar decpt = out.length;\n\t\tfor(i=0; i < out.length; ++i) if(out[i] != null && out[i].t != 't' && out[i].v.indexOf(\".\") > -1) { decpt = i; break; }\n\t\tvar lasti=out.length;\n\t\tif(decpt === out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tfor(i=out.length-1; i>= 0;--i) {\n\t\t\t\tif(out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\t\t\t\tif(jj>=out[i].v.length-1) { jj -= out[i].v.length; out[i].v = ostr.substr(jj+1, out[i].v.length); }\n\t\t\t\telse if(jj < 0) out[i].v = \"\";\n\t\t\t\telse { out[i].v = ostr.substr(0, jj+1); jj = -1; }\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t}\n\t\telse if(decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tjj = ostr.indexOf(\".\")-1;\n\t\t\tfor(i=decpt; i>= 0; --i) {\n\t\t\t\tif(out[i] == null || 'n?'.indexOf(out[i].t) === -1) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")-1:out[i].v.length-1;\n\t\t\t\tvv = out[i].v.substr(j+1);\n\t\t\t\tfor(; j>=0; --j) {\n\t\t\t\t\tif(jj>=0 && (out[i].v.charAt(j) === \"0\" || out[i].v.charAt(j) === \"#\")) vv = ostr.charAt(jj--) + vv;\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t\tjj = ostr.indexOf(\".\")+1;\n\t\t\tfor(i=decpt; i<out.length; ++i) {\n\t\t\t\tif(out[i] == null || ('n?('.indexOf(out[i].t) === -1 && i !== decpt)) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")+1:0;\n\t\t\t\tvv = out[i].v.substr(0,j);\n\t\t\t\tfor(; j<out[i].v.length; ++j) {\n\t\t\t\t\tif(jj<ostr.length) vv += ostr.charAt(jj++);\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t}\n\t}\n\tfor(i=0; i<out.length; ++i) if(out[i] != null && 'n?'.indexOf(out[i].t)>-1) {\n\t\tmyv = (flen >1 && v < 0 && i>0 && out[i-1].v === \"-\" ? -v:v);\n\t\tout[i].v = write_num(out[i].t, out[i].v, myv);\n\t\tout[i].t = 't';\n\t}\n\tvar retval = \"\";\n\tfor(i=0; i !== out.length; ++i) if(out[i] != null) retval += out[i].v;\n\treturn retval;\n}\n\nvar cfregex2 = /\\[(=|>[=]?|<[>=]?)(-?\\d+(?:\\.\\d*)?)\\]/;\nfunction chkcond(v, rr) {\n\tif(rr == null) return false;\n\tvar thresh = parseFloat(rr[2]);\n\tswitch(rr[1]) {\n\t\tcase \"=\":  if(v == thresh) return true; break;\n\t\tcase \">\":  if(v >  thresh) return true; break;\n\t\tcase \"<\":  if(v <  thresh) return true; break;\n\t\tcase \"<>\": if(v != thresh) return true; break;\n\t\tcase \">=\": if(v >= thresh) return true; break;\n\t\tcase \"<=\": if(v <= thresh) return true; break;\n\t}\n\treturn false;\n}\nfunction choose_fmt(f/*:string*/, v/*:any*/) {\n\tvar fmt = SSF_split_fmt(f);\n\tvar l = fmt.length, lat = fmt[l-1].indexOf(\"@\");\n\tif(l<4 && lat>-1) --l;\n\tif(fmt.length > 4) throw new Error(\"cannot find right format for |\" + fmt.join(\"|\") + \"|\");\n\tif(typeof v !== \"number\") return [4, fmt.length === 4 || lat>-1?fmt[fmt.length-1]:\"@\"];\n\tswitch(fmt.length) {\n\t\tcase 1: fmt = lat>-1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"]; break;\n\t\tcase 2: fmt = lat>-1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"]; break;\n\t\tcase 3: fmt = lat>-1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"]; break;\n\t\tcase 4: break;\n\t}\n\tvar ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n\tif(fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\tif(fmt[0].match(/\\[[=<>]/) != null || fmt[1].match(/\\[[=<>]/) != null) {\n\t\tvar m1 = fmt[0].match(cfregex2);\n\t\tvar m2 = fmt[1].match(cfregex2);\n\t\treturn chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n\t}\n\treturn [l, ff];\n}\nfunction SSF_format(fmt/*:string|number*/,v/*:any*/,o/*:?any*/) {\n\tif(o == null) o = {};\n\tvar sfmt = \"\";\n\tswitch(typeof fmt) {\n\t\tcase \"string\":\n\t\t\tif(fmt == \"m/d/yy\" && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = fmt;\n\t\t\tbreak;\n\t\tcase \"number\":\n\t\t\tif(fmt == 14 && o.dateNF) sfmt = o.dateNF;\n\t\t\telse sfmt = (o.table != null ? (o.table/*:any*/) : table_fmt)[fmt];\n\t\t\tif(sfmt == null) sfmt = (o.table && o.table[SSF_default_map[fmt]]) || table_fmt[SSF_default_map[fmt]];\n\t\t\tif(sfmt == null) sfmt = SSF_default_str[fmt] || \"General\";\n\t\t\tbreak;\n\t}\n\tif(SSF_isgeneral(sfmt,0)) return SSF_general(v, o);\n\tif(v instanceof Date) v = datenum_local(v, o.date1904);\n\tvar f = choose_fmt(sfmt, v);\n\tif(SSF_isgeneral(f[1])) return SSF_general(v, o);\n\tif(v === true) v = \"TRUE\"; else if(v === false) v = \"FALSE\";\n\telse if(v === \"\" || v == null) return \"\";\n\treturn eval_fmt(f[1], v, o, f[0]);\n}\nfunction SSF_load(fmt/*:string*/, idx/*:?number*/)/*:number*/ {\n\tif(typeof idx != 'number') {\n\t\tidx = +idx || -1;\n/*::if(typeof idx != 'number') return 0x188; */\n\t\tfor(var i = 0; i < 0x0188; ++i) {\n/*::if(typeof idx != 'number') return 0x188; */\n\t\t\tif(table_fmt[i] == undefined) { if(idx < 0) idx = i; continue; }\n\t\t\tif(table_fmt[i] == fmt) { idx = i; break; }\n\t\t}\n/*::if(typeof idx != 'number') return 0x188; */\n\t\tif(idx < 0) idx = 0x187;\n\t}\n/*::if(typeof idx != 'number') return 0x188; */\n\ttable_fmt[idx] = fmt;\n\treturn idx;\n}\nfunction SSF_load_table(tbl/*:SSFTable*/)/*:void*/ {\n\tfor(var i=0; i!=0x0188; ++i)\n\t\tif(tbl[i] !== undefined) SSF_load(tbl[i], i);\n}\n\nfunction make_ssf() {\n\ttable_fmt = SSF_init_table();\n}\n\nvar SSF = {\n\tformat: SSF_format,\n\tload: SSF_load,\n\t_table: table_fmt,\n\tload_table: SSF_load_table,\n\tparse_date_code: SSF_parse_date_code,\n\tis_date: fmt_is_date,\n\tget_table: function get_table() { return SSF._table = table_fmt; }\n};\n\nvar SSFImplicit/*{[number]:string}*/ = ({\n\t\"5\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t\"6\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t\"7\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t\"8\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"23\": 'General', \"24\": 'General', \"25\": 'General', \"26\": 'General',\n\t\"27\": 'm/d/yy', \"28\": 'm/d/yy', \"29\": 'm/d/yy', \"30\": 'm/d/yy', \"31\": 'm/d/yy',\n\t\"32\": 'h:mm:ss', \"33\": 'h:mm:ss', \"34\": 'h:mm:ss', \"35\": 'h:mm:ss',\n\t\"36\": 'm/d/yy',\n\t\"41\": '_(* #,##0_);_(* \\(#,##0\\);_(* \"-\"_);_(@_)',\n\t\"42\": '_(\"$\"* #,##0_);_(\"$\"* \\(#,##0\\);_(\"$\"* \"-\"_);_(@_)',\n\t\"43\": '_(* #,##0.00_);_(* \\(#,##0.00\\);_(* \"-\"??_);_(@_)',\n\t\"44\": '_(\"$\"* #,##0.00_);_(\"$\"* \\(#,##0.00\\);_(\"$\"* \"-\"??_);_(@_)',\n\t\"50\": 'm/d/yy', \"51\": 'm/d/yy', \"52\": 'm/d/yy', \"53\": 'm/d/yy', \"54\": 'm/d/yy',\n\t\"55\": 'm/d/yy', \"56\": 'm/d/yy', \"57\": 'm/d/yy', \"58\": 'm/d/yy',\n\t\"59\": '0',\n\t\"60\": '0.00',\n\t\"61\": '#,##0',\n\t\"62\": '#,##0.00',\n\t\"63\": '\"$\"#,##0_);\\\\(\"$\"#,##0\\\\)',\n\t\"64\": '\"$\"#,##0_);[Red]\\\\(\"$\"#,##0\\\\)',\n\t\"65\": '\"$\"#,##0.00_);\\\\(\"$\"#,##0.00\\\\)',\n\t\"66\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"67\": '0%',\n\t\"68\": '0.00%',\n\t\"69\": '# ?/?',\n\t\"70\": '# ??/??',\n\t\"71\": 'm/d/yy',\n\t\"72\": 'm/d/yy',\n\t\"73\": 'd-mmm-yy',\n\t\"74\": 'd-mmm',\n\t\"75\": 'mmm-yy',\n\t\"76\": 'h:mm',\n\t\"77\": 'h:mm:ss',\n\t\"78\": 'm/d/yy h:mm',\n\t\"79\": 'mm:ss',\n\t\"80\": '[h]:mm:ss',\n\t\"81\": 'mmss.0'\n}/*:any*/);\n\n/* dateNF parse TODO: move to SSF */\nvar dateNFregex = /[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;\nfunction dateNF_regex(dateNF/*:string|number*/)/*:RegExp*/ {\n\tvar fmt = typeof dateNF == \"number\" ? table_fmt[dateNF] : dateNF;\n\tfmt = fmt.replace(dateNFregex, \"(\\\\d+)\");\n\treturn new RegExp(\"^\" + fmt + \"$\");\n}\nfunction dateNF_fix(str/*:string*/, dateNF/*:string*/, match/*:Array<string>*/)/*:string*/ {\n\tvar Y = -1, m = -1, d = -1, H = -1, M = -1, S = -1;\n\t(dateNF.match(dateNFregex)||[]).forEach(function(n, i) {\n\t\tvar v = parseInt(match[i+1], 10);\n\t\tswitch(n.toLowerCase().charAt(0)) {\n\t\t\tcase 'y': Y = v; break; case 'd': d = v; break;\n\t\t\tcase 'h': H = v; break; case 's': S = v; break;\n\t\t\tcase 'm': if(H >= 0) M = v; else m = v; break;\n\t\t}\n\t});\n\tif(S >= 0 && M == -1 && m >= 0) { M = m; m = -1; }\n\tvar datestr = ((\"\" + (Y>=0?Y: new Date().getFullYear())).slice(-4) + \"-\" + (\"00\" + (m>=1?m:1)).slice(-2) + \"-\" + (\"00\" + (d>=1?d:1)).slice(-2));\n\tif(datestr.length == 7) datestr = \"0\" + datestr;\n\tif(datestr.length == 8) datestr = \"20\" + datestr;\n\tvar timestr = ((\"00\" + (H>=0?H:0)).slice(-2) + \":\" + (\"00\" + (M>=0?M:0)).slice(-2) + \":\" + (\"00\" + (S>=0?S:0)).slice(-2));\n\tif(H == -1 && M == -1 && S == -1) return datestr;\n\tif(Y == -1 && m == -1 && d == -1) return timestr;\n\treturn datestr + \"T\" + timestr;\n}\n\n/*::\ndeclare var ReadShift:any;\ndeclare var CheckField:any;\ndeclare var prep_blob:any;\ndeclare var __readUInt32LE:any;\ndeclare var __readInt32LE:any;\ndeclare var __toBuffer:any;\ndeclare var __utf16le:any;\ndeclare var bconcat:any;\ndeclare var s2a:any;\ndeclare var chr0:any;\ndeclare var chr1:any;\ndeclare var has_buf:boolean;\ndeclare var new_buf:any;\ndeclare var new_raw_buf:any;\ndeclare var new_unsafe_buf:any;\ndeclare var Buffer_from:any;\n*/\n/* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint eqnull:true */\n/*exported CFB */\n/*global Uint8Array:false, Uint16Array:false */\n\n/*::\ntype SectorEntry = {\n\tname?:string;\n\tnodes?:Array<number>;\n\tdata:RawBytes;\n};\ntype SectorList = {\n\t[k:string|number]:SectorEntry;\n\tname:?string;\n\tfat_addrs:Array<number>;\n\tssz:number;\n}\ntype CFBFiles = {[n:string]:CFBEntry};\n*/\n/* crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*exported CRC32 */\nvar CRC32 = /*#__PURE__*/(function() {\nvar CRC32 = {};\nCRC32.version = '1.2.0';\n/* see perf/crc32table.js */\n/*global Int32Array */\nfunction signed_crc_table()/*:any*/ {\n\tvar c = 0, table/*:Array<number>*/ = new Array(256);\n\n\tfor(var n =0; n != 256; ++n){\n\t\tc = n;\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\tc = ((c&1) ? (-306674912 ^ (c >>> 1)) : (c >>> 1));\n\t\ttable[n] = c;\n\t}\n\n\treturn typeof Int32Array !== 'undefined' ? new Int32Array(table) : table;\n}\n\nvar T0 = signed_crc_table();\nfunction slice_by_16_tables(T) {\n\tvar c = 0, v = 0, n = 0, table/*:Array<number>*/ = typeof Int32Array !== 'undefined' ? new Int32Array(4096) : new Array(4096) ;\n\n\tfor(n = 0; n != 256; ++n) table[n] = T[n];\n\tfor(n = 0; n != 256; ++n) {\n\t\tv = T[n];\n\t\tfor(c = 256 + n; c < 4096; c += 256) v = table[c] = (v >>> 8) ^ T[v & 0xFF];\n\t}\n\tvar out = [];\n\tfor(n = 1; n != 16; ++n) out[n - 1] = typeof Int32Array !== 'undefined' ? table.subarray(n * 256, n * 256 + 256) : table.slice(n * 256, n * 256 + 256);\n\treturn out;\n}\nvar TT = slice_by_16_tables(T0);\nvar T1 = TT[0],  T2 = TT[1],  T3 = TT[2],  T4 = TT[3],  T5 = TT[4];\nvar T6 = TT[5],  T7 = TT[6],  T8 = TT[7],  T9 = TT[8],  Ta = TT[9];\nvar Tb = TT[10], Tc = TT[11], Td = TT[12], Te = TT[13], Tf = TT[14];\nfunction crc32_bstr(bstr/*:string*/, seed/*:number*/)/*:number*/ {\n\tvar C = seed/*:: ? 0 : 0 */ ^ -1;\n\tfor(var i = 0, L = bstr.length; i < L;) C = (C>>>8) ^ T0[(C^bstr.charCodeAt(i++))&0xFF];\n\treturn ~C;\n}\n\nfunction crc32_buf(B/*:Uint8Array|Array<number>*/, seed/*:number*/)/*:number*/ {\n\tvar C = seed/*:: ? 0 : 0 */ ^ -1, L = B.length - 15, i = 0;\n\tfor(; i < L;) C =\n\t\tTf[B[i++] ^ (C & 255)] ^\n\t\tTe[B[i++] ^ ((C >> 8) & 255)] ^\n\t\tTd[B[i++] ^ ((C >> 16) & 255)] ^\n\t\tTc[B[i++] ^ (C >>> 24)] ^\n\t\tTb[B[i++]] ^ Ta[B[i++]] ^ T9[B[i++]] ^ T8[B[i++]] ^\n\t\tT7[B[i++]] ^ T6[B[i++]] ^ T5[B[i++]] ^ T4[B[i++]] ^\n\t\tT3[B[i++]] ^ T2[B[i++]] ^ T1[B[i++]] ^ T0[B[i++]];\n\tL += 15;\n\twhile(i < L) C = (C>>>8) ^ T0[(C^B[i++])&0xFF];\n\treturn ~C;\n}\n\nfunction crc32_str(str/*:string*/, seed/*:number*/)/*:number*/ {\n\tvar C = seed ^ -1;\n\tfor(var i = 0, L = str.length, c = 0, d = 0; i < L;) {\n\t\tc = str.charCodeAt(i++);\n\t\tif(c < 0x80) {\n\t\t\tC = (C>>>8) ^ T0[(C^c)&0xFF];\n\t\t} else if(c < 0x800) {\n\t\t\tC = (C>>>8) ^ T0[(C ^ (192|((c>>6)&31)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(c&63)))&0xFF];\n\t\t} else if(c >= 0xD800 && c < 0xE000) {\n\t\t\tc = (c&1023)+64; d = str.charCodeAt(i++)&1023;\n\t\t\tC = (C>>>8) ^ T0[(C ^ (240|((c>>8)&7)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((c>>2)&63)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((d>>6)&15)|((c&3)<<4)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(d&63)))&0xFF];\n\t\t} else {\n\t\t\tC = (C>>>8) ^ T0[(C ^ (224|((c>>12)&15)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|((c>>6)&63)))&0xFF];\n\t\t\tC = (C>>>8) ^ T0[(C ^ (128|(c&63)))&0xFF];\n\t\t}\n\t}\n\treturn ~C;\n}\nCRC32.table = T0;\nCRC32.bstr = crc32_bstr;\nCRC32.buf = crc32_buf;\nCRC32.str = crc32_str;\nreturn CRC32;\n})();\n/* [MS-CFB] v20171201 */\nvar CFB = /*#__PURE__*/(function _CFB(){\nvar exports = {};\nexports.version = '1.2.1';\n/* [MS-CFB] 2.6.4 */\nfunction namecmp(l/*:string*/, r/*:string*/)/*:number*/ {\n\tvar L = l.split(\"/\"), R = r.split(\"/\");\n\tfor(var i = 0, c = 0, Z = Math.min(L.length, R.length); i < Z; ++i) {\n\t\tif((c = L[i].length - R[i].length)) return c;\n\t\tif(L[i] != R[i]) return L[i] < R[i] ? -1 : 1;\n\t}\n\treturn L.length - R.length;\n}\nfunction dirname(p/*:string*/)/*:string*/ {\n\tif(p.charAt(p.length - 1) == \"/\") return (p.slice(0,-1).indexOf(\"/\") === -1) ? p : dirname(p.slice(0, -1));\n\tvar c = p.lastIndexOf(\"/\");\n\treturn (c === -1) ? p : p.slice(0, c+1);\n}\n\nfunction filename(p/*:string*/)/*:string*/ {\n\tif(p.charAt(p.length - 1) == \"/\") return filename(p.slice(0, -1));\n\tvar c = p.lastIndexOf(\"/\");\n\treturn (c === -1) ? p : p.slice(c+1);\n}\n/* -------------------------------------------------------------------------- */\n/* DOS Date format:\n   high|YYYYYYYm.mmmddddd.HHHHHMMM.MMMSSSSS|low\n   add 1980 to stored year\n   stored second should be doubled\n*/\n\n/* write JS date to buf as a DOS date */\nfunction write_dos_date(buf/*:CFBlob*/, date/*:Date|string*/) {\n\tif(typeof date === \"string\") date = new Date(date);\n\tvar hms/*:number*/ = date.getHours();\n\thms = hms << 6 | date.getMinutes();\n\thms = hms << 5 | (date.getSeconds()>>>1);\n\tbuf.write_shift(2, hms);\n\tvar ymd/*:number*/ = (date.getFullYear() - 1980);\n\tymd = ymd << 4 | (date.getMonth()+1);\n\tymd = ymd << 5 | date.getDate();\n\tbuf.write_shift(2, ymd);\n}\n\n/* read four bytes from buf and interpret as a DOS date */\nfunction parse_dos_date(buf/*:CFBlob*/)/*:Date*/ {\n\tvar hms = buf.read_shift(2) & 0xFFFF;\n\tvar ymd = buf.read_shift(2) & 0xFFFF;\n\tvar val = new Date();\n\tvar d = ymd & 0x1F; ymd >>>= 5;\n\tvar m = ymd & 0x0F; ymd >>>= 4;\n\tval.setMilliseconds(0);\n\tval.setFullYear(ymd + 1980);\n\tval.setMonth(m-1);\n\tval.setDate(d);\n\tvar S = hms & 0x1F; hms >>>= 5;\n\tvar M = hms & 0x3F; hms >>>= 6;\n\tval.setHours(hms);\n\tval.setMinutes(M);\n\tval.setSeconds(S<<1);\n\treturn val;\n}\nfunction parse_extra_field(blob/*:CFBlob*/)/*:any*/ {\n\tprep_blob(blob, 0);\n\tvar o = /*::(*/{}/*:: :any)*/;\n\tvar flags = 0;\n\twhile(blob.l <= blob.length - 4) {\n\t\tvar type = blob.read_shift(2);\n\t\tvar sz = blob.read_shift(2), tgt = blob.l + sz;\n\t\tvar p = {};\n\t\tswitch(type) {\n\t\t\t/* UNIX-style Timestamps */\n\t\t\tcase 0x5455: {\n\t\t\t\tflags = blob.read_shift(1);\n\t\t\t\tif(flags & 1) p.mtime = blob.read_shift(4);\n\t\t\t\t/* for some reason, CD flag corresponds to LFH */\n\t\t\t\tif(sz > 5) {\n\t\t\t\t\tif(flags & 2) p.atime = blob.read_shift(4);\n\t\t\t\t\tif(flags & 4) p.ctime = blob.read_shift(4);\n\t\t\t\t}\n\t\t\t\tif(p.mtime) p.mt = new Date(p.mtime*1000);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tblob.l = tgt;\n\t\to[type] = p;\n\t}\n\treturn o;\n}\nvar fs/*:: = require('fs'); */;\nfunction get_fs() { return fs || (fs = {}); }\nfunction parse(file/*:RawBytes*/, options/*:CFBReadOpts*/)/*:CFBContainer*/ {\nif(file[0] == 0x50 && file[1] == 0x4b) return parse_zip(file, options);\nif((file[0] | 0x20) == 0x6d && (file[1]|0x20) == 0x69) return parse_mad(file, options);\nif(file.length < 512) throw new Error(\"CFB file size \" + file.length + \" < 512\");\nvar mver = 3;\nvar ssz = 512;\nvar nmfs = 0; // number of mini FAT sectors\nvar difat_sec_cnt = 0;\nvar dir_start = 0;\nvar minifat_start = 0;\nvar difat_start = 0;\n\nvar fat_addrs/*:Array<number>*/ = []; // locations of FAT sectors\n\n/* [MS-CFB] 2.2 Compound File Header */\nvar blob/*:CFBlob*/ = /*::(*/file.slice(0,512)/*:: :any)*/;\nprep_blob(blob, 0);\n\n/* major version */\nvar mv = check_get_mver(blob);\nmver = mv[0];\nswitch(mver) {\n\tcase 3: ssz = 512; break; case 4: ssz = 4096; break;\n\tcase 0: if(mv[1] == 0) return parse_zip(file, options);\n\t/* falls through */\n\tdefault: throw new Error(\"Major Version: Expected 3 or 4 saw \" + mver);\n}\n\n/* reprocess header */\nif(ssz !== 512) { blob = /*::(*/file.slice(0,ssz)/*:: :any)*/; prep_blob(blob, 28 /* blob.l */); }\n/* Save header for final object */\nvar header/*:RawBytes*/ = file.slice(0,ssz);\n\ncheck_shifts(blob, mver);\n\n// Number of Directory Sectors\nvar dir_cnt/*:number*/ = blob.read_shift(4, 'i');\nif(mver === 3 && dir_cnt !== 0) throw new Error('# Directory Sectors: Expected 0 saw ' + dir_cnt);\n\n// Number of FAT Sectors\nblob.l += 4;\n\n// First Directory Sector Location\ndir_start = blob.read_shift(4, 'i');\n\n// Transaction Signature\nblob.l += 4;\n\n// Mini Stream Cutoff Size\nblob.chk('00100000', 'Mini Stream Cutoff Size: ');\n\n// First Mini FAT Sector Location\nminifat_start = blob.read_shift(4, 'i');\n\n// Number of Mini FAT Sectors\nnmfs = blob.read_shift(4, 'i');\n\n// First DIFAT sector location\ndifat_start = blob.read_shift(4, 'i');\n\n// Number of DIFAT Sectors\ndifat_sec_cnt = blob.read_shift(4, 'i');\n\n// Grab FAT Sector Locations\nfor(var q = -1, j = 0; j < 109; ++j) { /* 109 = (512 - blob.l)>>>2; */\n\tq = blob.read_shift(4, 'i');\n\tif(q<0) break;\n\tfat_addrs[j] = q;\n}\n\n/** Break the file up into sectors */\nvar sectors/*:Array<RawBytes>*/ = sectorify(file, ssz);\n\nsleuth_fat(difat_start, difat_sec_cnt, sectors, ssz, fat_addrs);\n\n/** Chains */\nvar sector_list/*:SectorList*/ = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n\nsector_list[dir_start].name = \"!Directory\";\nif(nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\nsector_list[fat_addrs[0]].name = \"!FAT\";\nsector_list.fat_addrs = fat_addrs;\nsector_list.ssz = ssz;\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nvar files/*:CFBFiles*/ = {}, Paths/*:Array<string>*/ = [], FileIndex/*:CFBFileIndex*/ = [], FullPaths/*:Array<string>*/ = [];\nread_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex, minifat_start);\n\nbuild_full_paths(FileIndex, FullPaths, Paths);\nPaths.shift();\n\nvar o = {\n\tFileIndex: FileIndex,\n\tFullPaths: FullPaths\n};\n\n// $FlowIgnore\nif(options && options.raw) o.raw = {header: header, sectors: sectors};\nreturn o;\n} // parse\n\n/* [MS-CFB] 2.2 Compound File Header -- read up to major version */\nfunction check_get_mver(blob/*:CFBlob*/)/*:[number, number]*/ {\n\tif(blob[blob.l] == 0x50 && blob[blob.l + 1] == 0x4b) return [0, 0];\n\t// header signature 8\n\tblob.chk(HEADER_SIGNATURE, 'Header Signature: ');\n\n\t// clsid 16\n\t//blob.chk(HEADER_CLSID, 'CLSID: ');\n\tblob.l += 16;\n\n\t// minor version 2\n\tvar mver/*:number*/ = blob.read_shift(2, 'u');\n\n\treturn [blob.read_shift(2,'u'), mver];\n}\nfunction check_shifts(blob/*:CFBlob*/, mver/*:number*/)/*:void*/ {\n\tvar shift = 0x09;\n\n\t// Byte Order\n\t//blob.chk('feff', 'Byte Order: '); // note: some writers put 0xffff\n\tblob.l += 2;\n\n\t// Sector Shift\n\tswitch((shift = blob.read_shift(2))) {\n\t\tcase 0x09: if(mver != 3) throw new Error('Sector Shift: Expected 9 saw ' + shift); break;\n\t\tcase 0x0c: if(mver != 4) throw new Error('Sector Shift: Expected 12 saw ' + shift); break;\n\t\tdefault: throw new Error('Sector Shift: Expected 9 or 12 saw ' + shift);\n\t}\n\n\t// Mini Sector Shift\n\tblob.chk('0600', 'Mini Sector Shift: ');\n\n\t// Reserved\n\tblob.chk('000000000000', 'Reserved: ');\n}\n\n/** Break the file up into sectors */\nfunction sectorify(file/*:RawBytes*/, ssz/*:number*/)/*:Array<RawBytes>*/ {\n\tvar nsectors = Math.ceil(file.length/ssz)-1;\n\tvar sectors/*:Array<RawBytes>*/ = [];\n\tfor(var i=1; i < nsectors; ++i) sectors[i-1] = file.slice(i*ssz,(i+1)*ssz);\n\tsectors[nsectors-1] = file.slice(nsectors*ssz);\n\treturn sectors;\n}\n\n/* [MS-CFB] 2.6.4 Red-Black Tree */\nfunction build_full_paths(FI/*:CFBFileIndex*/, FP/*:Array<string>*/, Paths/*:Array<string>*/)/*:void*/ {\n\tvar i = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;\n\tvar dad/*:Array<number>*/ = [], q/*:Array<number>*/ = [];\n\n\tfor(; i < pl; ++i) { dad[i]=q[i]=i; FP[i]=Paths[i]; }\n\n\tfor(; j < q.length; ++j) {\n\t\ti = q[j];\n\t\tL = FI[i].L; R = FI[i].R; C = FI[i].C;\n\t\tif(dad[i] === i) {\n\t\t\tif(L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\n\t\t\tif(R !== -1 && dad[R] !== R) dad[i] = dad[R];\n\t\t}\n\t\tif(C !== -1 /*NOSTREAM*/) dad[C] = i;\n\t\tif(L !== -1 && i != dad[i]) { dad[L] = dad[i]; if(q.lastIndexOf(L) < j) q.push(L); }\n\t\tif(R !== -1 && i != dad[i]) { dad[R] = dad[i]; if(q.lastIndexOf(R) < j) q.push(R); }\n\t}\n\tfor(i=1; i < pl; ++i) if(dad[i] === i) {\n\t\tif(R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];\n\t\telse if(L !== -1 && dad[L] !== L) dad[i] = dad[L];\n\t}\n\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type === 0 /* unknown */) continue;\n\t\tj = i;\n\t\tif(j != dad[j]) do {\n\t\t\tj = dad[j];\n\t\t\tFP[i] = FP[j] + \"/\" + FP[i];\n\t\t} while (j !== 0 && -1 !== dad[j] && j != dad[j]);\n\t\tdad[i] = -1;\n\t}\n\n\tFP[0] += \"/\";\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type !== 2 /* stream */) FP[i] += \"/\";\n\t}\n}\n\nfunction get_mfat_entry(entry/*:CFBEntry*/, payload/*:RawBytes*/, mini/*:?RawBytes*/)/*:CFBlob*/ {\n\tvar start = entry.start, size = entry.size;\n\t//return (payload.slice(start*MSSZ, start*MSSZ + size)/*:any*/);\n\tvar o = [];\n\tvar idx = start;\n\twhile(mini && size > 0 && idx >= 0) {\n\t\to.push(payload.slice(idx * MSSZ, idx * MSSZ + MSSZ));\n\t\tsize -= MSSZ;\n\t\tidx = __readInt32LE(mini, idx * 4);\n\t}\n\tif(o.length === 0) return (new_buf(0)/*:any*/);\n\treturn (bconcat(o).slice(0, entry.size)/*:any*/);\n}\n\n/** Chase down the rest of the DIFAT chain to build a comprehensive list\n    DIFAT chains by storing the next sector number as the last 32 bits */\nfunction sleuth_fat(idx/*:number*/, cnt/*:number*/, sectors/*:Array<RawBytes>*/, ssz/*:number*/, fat_addrs)/*:void*/ {\n\tvar q/*:number*/ = ENDOFCHAIN;\n\tif(idx === ENDOFCHAIN) {\n\t\tif(cnt !== 0) throw new Error(\"DIFAT chain shorter than expected\");\n\t} else if(idx !== -1 /*FREESECT*/) {\n\t\tvar sector = sectors[idx], m = (ssz>>>2)-1;\n\t\tif(!sector) return;\n\t\tfor(var i = 0; i < m; ++i) {\n\t\t\tif((q = __readInt32LE(sector,i*4)) === ENDOFCHAIN) break;\n\t\t\tfat_addrs.push(q);\n\t\t}\n\t\tsleuth_fat(__readInt32LE(sector,ssz-4),cnt - 1, sectors, ssz, fat_addrs);\n\t}\n}\n\n/** Follow the linked list of sectors for a given starting point */\nfunction get_sector_list(sectors/*:Array<RawBytes>*/, start/*:number*/, fat_addrs/*:Array<number>*/, ssz/*:number*/, chkd/*:?Array<boolean>*/)/*:SectorEntry*/ {\n\tvar buf/*:Array<number>*/ = [], buf_chain/*:Array<any>*/ = [];\n\tif(!chkd) chkd = [];\n\tvar modulus = ssz - 1, j = 0, jj = 0;\n\tfor(j=start; j>=0;) {\n\t\tchkd[j] = true;\n\t\tbuf[buf.length] = j;\n\t\tbuf_chain.push(sectors[j]);\n\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\tjj = ((j*4) & modulus);\n\t\tif(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\n\t\tif(!sectors[addr]) break;\n\t\tj = __readInt32LE(sectors[addr], jj);\n\t}\n\treturn {nodes: buf, data:__toBuffer([buf_chain])};\n}\n\n/** Chase down the sector linked lists */\nfunction make_sector_list(sectors/*:Array<RawBytes>*/, dir_start/*:number*/, fat_addrs/*:Array<number>*/, ssz/*:number*/)/*:SectorList*/ {\n\tvar sl = sectors.length, sector_list/*:SectorList*/ = ([]/*:any*/);\n\tvar chkd/*:Array<boolean>*/ = [], buf/*:Array<number>*/ = [], buf_chain/*:Array<RawBytes>*/ = [];\n\tvar modulus = ssz - 1, i=0, j=0, k=0, jj=0;\n\tfor(i=0; i < sl; ++i) {\n\t\tbuf = ([]/*:Array<number>*/);\n\t\tk = (i + dir_start); if(k >= sl) k-=sl;\n\t\tif(chkd[k]) continue;\n\t\tbuf_chain = [];\n\t\tvar seen = [];\n\t\tfor(j=k; j>=0;) {\n\t\t\tseen[j] = true;\n\t\t\tchkd[j] = true;\n\t\t\tbuf[buf.length] = j;\n\t\t\tbuf_chain.push(sectors[j]);\n\t\t\tvar addr/*:number*/ = fat_addrs[Math.floor(j*4/ssz)];\n\t\t\tjj = ((j*4) & modulus);\n\t\t\tif(ssz < 4 + jj) throw new Error(\"FAT boundary crossed: \" + j + \" 4 \"+ssz);\n\t\t\tif(!sectors[addr]) break;\n\t\t\tj = __readInt32LE(sectors[addr], jj);\n\t\t\tif(seen[j]) break;\n\t\t}\n\t\tsector_list[k] = ({nodes: buf, data:__toBuffer([buf_chain])}/*:SectorEntry*/);\n\t}\n\treturn sector_list;\n}\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nfunction read_directory(dir_start/*:number*/, sector_list/*:SectorList*/, sectors/*:Array<RawBytes>*/, Paths/*:Array<string>*/, nmfs, files, FileIndex, mini) {\n\tvar minifat_store = 0, pl = (Paths.length?2:0);\n\tvar sector = sector_list[dir_start].data;\n\tvar i = 0, namelen = 0, name;\n\tfor(; i < sector.length; i+= 128) {\n\t\tvar blob/*:CFBlob*/ = /*::(*/sector.slice(i, i+128)/*:: :any)*/;\n\t\tprep_blob(blob, 64);\n\t\tnamelen = blob.read_shift(2);\n\t\tname = __utf16le(blob,0,namelen-pl);\n\t\tPaths.push(name);\n\t\tvar o/*:CFBEntry*/ = ({\n\t\t\tname:  name,\n\t\t\ttype:  blob.read_shift(1),\n\t\t\tcolor: blob.read_shift(1),\n\t\t\tL:     blob.read_shift(4, 'i'),\n\t\t\tR:     blob.read_shift(4, 'i'),\n\t\t\tC:     blob.read_shift(4, 'i'),\n\t\t\tclsid: blob.read_shift(16),\n\t\t\tstate: blob.read_shift(4, 'i'),\n\t\t\tstart: 0,\n\t\t\tsize: 0\n\t\t});\n\t\tvar ctime/*:number*/ = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(ctime !== 0) o.ct = read_date(blob, blob.l-8);\n\t\tvar mtime/*:number*/ = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(mtime !== 0) o.mt = read_date(blob, blob.l-8);\n\t\to.start = blob.read_shift(4, 'i');\n\t\to.size = blob.read_shift(4, 'i');\n\t\tif(o.size < 0 && o.start < 0) { o.size = o.type = 0; o.start = ENDOFCHAIN; o.name = \"\"; }\n\t\tif(o.type === 5) { /* root */\n\t\t\tminifat_store = o.start;\n\t\t\tif(nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n\t\t\t/*minifat_size = o.size;*/\n\t\t} else if(o.size >= 4096 /* MSCSZ */) {\n\t\t\to.storage = 'fat';\n\t\t\tif(sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n\t\t\tsector_list[o.start].name = o.name;\n\t\t\to.content = (sector_list[o.start].data.slice(0,o.size)/*:any*/);\n\t\t} else {\n\t\t\to.storage = 'minifat';\n\t\t\tif(o.size < 0) o.size = 0;\n\t\t\telse if(minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN && sector_list[minifat_store]) {\n\t\t\t\to.content = get_mfat_entry(o, sector_list[minifat_store].data, (sector_list[mini]||{}).data);\n\t\t\t}\n\t\t}\n\t\tif(o.content) prep_blob(o.content, 0);\n\t\tfiles[name] = o;\n\t\tFileIndex.push(o);\n\t}\n}\n\nfunction read_date(blob/*:RawBytes|CFBlob*/, offset/*:number*/)/*:Date*/ {\n\treturn new Date(( ( (__readUInt32LE(blob,offset+4)/1e7)*Math.pow(2,32)+__readUInt32LE(blob,offset)/1e7 ) - 11644473600)*1000);\n}\n\nfunction read_file(filename/*:string*/, options/*:CFBReadOpts*/) {\n\tget_fs();\n\treturn parse(fs.readFileSync(filename), options);\n}\n\nfunction read(blob/*:RawBytes|string*/, options/*:CFBReadOpts*/) {\n\tvar type = options && options.type;\n\tif(!type) {\n\t\tif(has_buf && Buffer.isBuffer(blob)) type = \"buffer\";\n\t}\n\tswitch(type || \"base64\") {\n\t\tcase \"file\": /*:: if(typeof blob !== 'string') throw \"Must pass a filename when type='file'\"; */return read_file(blob, options);\n\t\tcase \"base64\": /*:: if(typeof blob !== 'string') throw \"Must pass a base64-encoded binary string when type='file'\"; */return parse(s2a(Base64_decode(blob)), options);\n\t\tcase \"binary\": /*:: if(typeof blob !== 'string') throw \"Must pass a binary string when type='file'\"; */return parse(s2a(blob), options);\n\t}\n\treturn parse(/*::typeof blob == 'string' ? new Buffer(blob, 'utf-8') : */blob, options);\n}\n\nfunction init_cfb(cfb/*:CFBContainer*/, opts/*:?any*/)/*:void*/ {\n\tvar o = opts || {}, root = o.root || \"Root Entry\";\n\tif(!cfb.FullPaths) cfb.FullPaths = [];\n\tif(!cfb.FileIndex) cfb.FileIndex = [];\n\tif(cfb.FullPaths.length !== cfb.FileIndex.length) throw new Error(\"inconsistent CFB structure\");\n\tif(cfb.FullPaths.length === 0) {\n\t\tcfb.FullPaths[0] = root + \"/\";\n\t\tcfb.FileIndex[0] = ({ name: root, type: 5 }/*:any*/);\n\t}\n\tif(o.CLSID) cfb.FileIndex[0].clsid = o.CLSID;\n\tseed_cfb(cfb);\n}\nfunction seed_cfb(cfb/*:CFBContainer*/)/*:void*/ {\n\tvar nm = \"\\u0001Sh33tJ5\";\n\tif(CFB.find(cfb, \"/\" + nm)) return;\n\tvar p = new_buf(4); p[0] = 55; p[1] = p[3] = 50; p[2] = 54;\n\tcfb.FileIndex.push(({ name: nm, type: 2, content:p, size:4, L:69, R:69, C:69 }/*:any*/));\n\tcfb.FullPaths.push(cfb.FullPaths[0] + nm);\n\trebuild_cfb(cfb);\n}\nfunction rebuild_cfb(cfb/*:CFBContainer*/, f/*:?boolean*/)/*:void*/ {\n\tinit_cfb(cfb);\n\tvar gc = false, s = false;\n\tfor(var i = cfb.FullPaths.length - 1; i >= 0; --i) {\n\t\tvar _file = cfb.FileIndex[i];\n\t\tswitch(_file.type) {\n\t\t\tcase 0:\n\t\t\t\tif(s) gc = true;\n\t\t\t\telse { cfb.FileIndex.pop(); cfb.FullPaths.pop(); }\n\t\t\t\tbreak;\n\t\t\tcase 1: case 2: case 5:\n\t\t\t\ts = true;\n\t\t\t\tif(isNaN(_file.R * _file.L * _file.C)) gc = true;\n\t\t\t\tif(_file.R > -1 && _file.L > -1 && _file.R == _file.L) gc = true;\n\t\t\t\tbreak;\n\t\t\tdefault: gc = true; break;\n\t\t}\n\t}\n\tif(!gc && !f) return;\n\n\tvar now = new Date(1987, 1, 19), j = 0;\n\t// Track which names exist\n\tvar fullPaths = Object.create ? Object.create(null) : {};\n\tvar data/*:Array<[string, CFBEntry]>*/ = [];\n\tfor(i = 0; i < cfb.FullPaths.length; ++i) {\n\t\tfullPaths[cfb.FullPaths[i]] = true;\n\t\tif(cfb.FileIndex[i].type === 0) continue;\n\t\tdata.push([cfb.FullPaths[i], cfb.FileIndex[i]]);\n\t}\n\tfor(i = 0; i < data.length; ++i) {\n\t\tvar dad = dirname(data[i][0]);\n\t\ts = fullPaths[dad];\n\t\tif(!s) {\n\t\t\tdata.push([dad, ({\n\t\t\t\tname: filename(dad).replace(\"/\",\"\"),\n\t\t\t\ttype: 1,\n\t\t\t\tclsid: HEADER_CLSID,\n\t\t\t\tct: now, mt: now,\n\t\t\t\tcontent: null\n\t\t\t}/*:any*/)]);\n\t\t\t// Add name to set\n\t\t\tfullPaths[dad] = true;\n\t\t}\n\t}\n\n\tdata.sort(function(x,y) { return namecmp(x[0], y[0]); });\n\tcfb.FullPaths = []; cfb.FileIndex = [];\n\tfor(i = 0; i < data.length; ++i) { cfb.FullPaths[i] = data[i][0]; cfb.FileIndex[i] = data[i][1]; }\n\tfor(i = 0; i < data.length; ++i) {\n\t\tvar elt = cfb.FileIndex[i];\n\t\tvar nm = cfb.FullPaths[i];\n\n\t\telt.name =  filename(nm).replace(\"/\",\"\");\n\t\telt.L = elt.R = elt.C = -(elt.color = 1);\n\t\telt.size = elt.content ? elt.content.length : 0;\n\t\telt.start = 0;\n\t\telt.clsid = (elt.clsid || HEADER_CLSID);\n\t\tif(i === 0) {\n\t\t\telt.C = data.length > 1 ? 1 : -1;\n\t\t\telt.size = 0;\n\t\t\telt.type = 5;\n\t\t} else if(nm.slice(-1) == \"/\") {\n\t\t\tfor(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==nm) break;\n\t\t\telt.C = j >= data.length ? -1 : j;\n\t\t\tfor(j=i+1;j < data.length; ++j) if(dirname(cfb.FullPaths[j])==dirname(nm)) break;\n\t\t\telt.R = j >= data.length ? -1 : j;\n\t\t\telt.type = 1;\n\t\t} else {\n\t\t\tif(dirname(cfb.FullPaths[i+1]||\"\") == dirname(nm)) elt.R = i + 1;\n\t\t\telt.type = 2;\n\t\t}\n\t}\n\n}\n\nfunction _write(cfb/*:CFBContainer*/, options/*:CFBWriteOpts*/)/*:RawBytes|string*/ {\n\tvar _opts = options || {};\n\t/* MAD is order-sensitive, skip rebuild and sort */\n\tif(_opts.fileType == 'mad') return write_mad(cfb, _opts);\n\trebuild_cfb(cfb);\n\tswitch(_opts.fileType) {\n\t\tcase 'zip': return write_zip(cfb, _opts);\n\t\t//case 'mad': return write_mad(cfb, _opts);\n\t}\n\tvar L = (function(cfb/*:CFBContainer*/)/*:Array<number>*/{\n\t\tvar mini_size = 0, fat_size = 0;\n\t\tfor(var i = 0; i < cfb.FileIndex.length; ++i) {\n\t\t\tvar file = cfb.FileIndex[i];\n\t\t\tif(!file.content) continue;\n\t\t\t/*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\t\t\tvar flen = file.content.length;\n\t\t\tif(flen > 0){\n\t\t\t\tif(flen < 0x1000) mini_size += (flen + 0x3F) >> 6;\n\t\t\t\telse fat_size += (flen + 0x01FF) >> 9;\n\t\t\t}\n\t\t}\n\t\tvar dir_cnt = (cfb.FullPaths.length +3) >> 2;\n\t\tvar mini_cnt = (mini_size + 7) >> 3;\n\t\tvar mfat_cnt = (mini_size + 0x7F) >> 7;\n\t\tvar fat_base = mini_cnt + fat_size + dir_cnt + mfat_cnt;\n\t\tvar fat_cnt = (fat_base + 0x7F) >> 7;\n\t\tvar difat_cnt = fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\n\t\twhile(((fat_base + fat_cnt + difat_cnt + 0x7F) >> 7) > fat_cnt) difat_cnt = ++fat_cnt <= 109 ? 0 : Math.ceil((fat_cnt-109)/0x7F);\n\t\tvar L =  [1, difat_cnt, fat_cnt, mfat_cnt, dir_cnt, fat_size, mini_size, 0];\n\t\tcfb.FileIndex[0].size = mini_size << 6;\n\t\tL[7] = (cfb.FileIndex[0].start=L[0]+L[1]+L[2]+L[3]+L[4]+L[5])+((L[6]+7) >> 3);\n\t\treturn L;\n\t})(cfb);\n\tvar o = new_buf(L[7] << 9);\n\tvar i = 0, T = 0;\n\t{\n\t\tfor(i = 0; i < 8; ++i) o.write_shift(1, HEADER_SIG[i]);\n\t\tfor(i = 0; i < 8; ++i) o.write_shift(2, 0);\n\t\to.write_shift(2, 0x003E);\n\t\to.write_shift(2, 0x0003);\n\t\to.write_shift(2, 0xFFFE);\n\t\to.write_shift(2, 0x0009);\n\t\to.write_shift(2, 0x0006);\n\t\tfor(i = 0; i < 3; ++i) o.write_shift(2, 0);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, L[2]);\n\t\to.write_shift(4, L[0] + L[1] + L[2] + L[3] - 1);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, 1<<12);\n\t\to.write_shift(4, L[3] ? L[0] + L[1] + L[2] - 1: ENDOFCHAIN);\n\t\to.write_shift(4, L[3]);\n\t\to.write_shift(-4, L[1] ? L[0] - 1: ENDOFCHAIN);\n\t\to.write_shift(4, L[1]);\n\t\tfor(i = 0; i < 109; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n\t}\n\tif(L[1]) {\n\t\tfor(T = 0; T < L[1]; ++T) {\n\t\t\tfor(; i < 236 + T * 127; ++i) o.write_shift(-4, i < L[2] ? L[1] + i : -1);\n\t\t\to.write_shift(-4, T === L[1] - 1 ? ENDOFCHAIN : T + 1);\n\t\t}\n\t}\n\tvar chainit = function(w/*:number*/)/*:void*/ {\n\t\tfor(T += w; i<T-1; ++i) o.write_shift(-4, i+1);\n\t\tif(w) { ++i; o.write_shift(-4, ENDOFCHAIN); }\n\t};\n\tT = i = 0;\n\tfor(T+=L[1]; i<T; ++i) o.write_shift(-4, consts.DIFSECT);\n\tfor(T+=L[2]; i<T; ++i) o.write_shift(-4, consts.FATSECT);\n\tchainit(L[3]);\n\tchainit(L[4]);\n\tvar j/*:number*/ = 0, flen/*:number*/ = 0;\n\tvar file/*:CFBEntry*/ = cfb.FileIndex[0];\n\tfor(; j < cfb.FileIndex.length; ++j) {\n\t\tfile = cfb.FileIndex[j];\n\t\tif(!file.content) continue;\n\t\t/*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\t\tflen = file.content.length;\n\t\tif(flen < 0x1000) continue;\n\t\tfile.start = T;\n\t\tchainit((flen + 0x01FF) >> 9);\n\t}\n\tchainit((L[6] + 7) >> 3);\n\twhile(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\tT = i = 0;\n\tfor(j = 0; j < cfb.FileIndex.length; ++j) {\n\t\tfile = cfb.FileIndex[j];\n\t\tif(!file.content) continue;\n\t\t/*:: if(file.content == null) throw new Error(\"unreachable\"); */\n\t\tflen = file.content.length;\n\t\tif(!flen || flen >= 0x1000) continue;\n\t\tfile.start = T;\n\t\tchainit((flen + 0x3F) >> 6);\n\t}\n\twhile(o.l & 0x1FF) o.write_shift(-4, consts.ENDOFCHAIN);\n\tfor(i = 0; i < L[4]<<2; ++i) {\n\t\tvar nm = cfb.FullPaths[i];\n\t\tif(!nm || nm.length === 0) {\n\t\t\tfor(j = 0; j < 17; ++j) o.write_shift(4, 0);\n\t\t\tfor(j = 0; j < 3; ++j) o.write_shift(4, -1);\n\t\t\tfor(j = 0; j < 12; ++j) o.write_shift(4, 0);\n\t\t\tcontinue;\n\t\t}\n\t\tfile = cfb.FileIndex[i];\n\t\tif(i === 0) file.start = file.size ? file.start - 1 : ENDOFCHAIN;\n\t\tvar _nm/*:string*/ = (i === 0 && _opts.root) || file.name;\n\t\tflen = 2*(_nm.length+1);\n\t\to.write_shift(64, _nm, \"utf16le\");\n\t\to.write_shift(2, flen);\n\t\to.write_shift(1, file.type);\n\t\to.write_shift(1, file.color);\n\t\to.write_shift(-4, file.L);\n\t\to.write_shift(-4, file.R);\n\t\to.write_shift(-4, file.C);\n\t\tif(!file.clsid) for(j = 0; j < 4; ++j) o.write_shift(4, 0);\n\t\telse o.write_shift(16, file.clsid, \"hex\");\n\t\to.write_shift(4, file.state || 0);\n\t\to.write_shift(4, 0); o.write_shift(4, 0);\n\t\to.write_shift(4, 0); o.write_shift(4, 0);\n\t\to.write_shift(4, file.start);\n\t\to.write_shift(4, file.size); o.write_shift(4, 0);\n\t}\n\tfor(i = 1; i < cfb.FileIndex.length; ++i) {\n\t\tfile = cfb.FileIndex[i];\n\t\t/*:: if(!file.content) throw new Error(\"unreachable\"); */\n\t\tif(file.size >= 0x1000) {\n\t\t\to.l = (file.start+1) << 9;\n\t\t\tif (has_buf && Buffer.isBuffer(file.content)) {\n\t\t\t\tfile.content.copy(o, o.l, 0, file.size);\n\t\t\t\t// o is a 0-filled Buffer so just set next offset\n\t\t\t\to.l += (file.size + 511) & -512;\n\t\t\t} else {\n\t\t\t\tfor(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\t\t\t\tfor(; j & 0x1FF; ++j) o.write_shift(1, 0);\n\t\t\t}\n\t\t}\n\t}\n\tfor(i = 1; i < cfb.FileIndex.length; ++i) {\n\t\tfile = cfb.FileIndex[i];\n\t\t/*:: if(!file.content) throw new Error(\"unreachable\"); */\n\t\tif(file.size > 0 && file.size < 0x1000) {\n\t\t\tif (has_buf && Buffer.isBuffer(file.content)) {\n\t\t\t\tfile.content.copy(o, o.l, 0, file.size);\n\t\t\t\t// o is a 0-filled Buffer so just set next offset\n\t\t\t\to.l += (file.size + 63) & -64;\n\t\t\t} else {\n\t\t\t\tfor(j = 0; j < file.size; ++j) o.write_shift(1, file.content[j]);\n\t\t\t\tfor(; j & 0x3F; ++j) o.write_shift(1, 0);\n\t\t\t}\n\t\t}\n\t}\n\tif (has_buf) {\n\t\to.l = o.length;\n\t} else {\n\t\t// When using Buffer, already 0-filled\n\t\twhile(o.l < o.length) o.write_shift(1, 0);\n\t}\n\treturn o;\n}\n/* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\nfunction find(cfb/*:CFBContainer*/, path/*:string*/)/*:?CFBEntry*/ {\n\tvar UCFullPaths/*:Array<string>*/ = cfb.FullPaths.map(function(x) { return x.toUpperCase(); });\n\tvar UCPaths/*:Array<string>*/ = UCFullPaths.map(function(x) { var y = x.split(\"/\"); return y[y.length - (x.slice(-1) == \"/\" ? 2 : 1)]; });\n\tvar k/*:boolean*/ = false;\n\tif(path.charCodeAt(0) === 47 /* \"/\" */) { k = true; path = UCFullPaths[0].slice(0, -1) + path; }\n\telse k = path.indexOf(\"/\") !== -1;\n\tvar UCPath/*:string*/ = path.toUpperCase();\n\tvar w/*:number*/ = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n\tif(w !== -1) return cfb.FileIndex[w];\n\n\tvar m = !UCPath.match(chr1);\n\tUCPath = UCPath.replace(chr0,'');\n\tif(m) UCPath = UCPath.replace(chr1,'!');\n\tfor(w = 0; w < UCFullPaths.length; ++w) {\n\t\tif((m ? UCFullPaths[w].replace(chr1,'!') : UCFullPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\n\t\tif((m ? UCPaths[w].replace(chr1,'!') : UCPaths[w]).replace(chr0,'') == UCPath) return cfb.FileIndex[w];\n\t}\n\treturn null;\n}\n/** CFB Constants */\nvar MSSZ = 64; /* Mini Sector Size = 1<<6 */\n//var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n/* 2.1 Compound File Sector Numbers and Types */\nvar ENDOFCHAIN = -2;\n/* 2.2 Compound File Header */\nvar HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\nvar HEADER_SIG = [0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1];\nvar HEADER_CLSID = '00000000000000000000000000000000';\nvar consts = {\n\t/* 2.1 Compund File Sector Numbers and Types */\n\tMAXREGSECT: -6,\n\tDIFSECT: -4,\n\tFATSECT: -3,\n\tENDOFCHAIN: ENDOFCHAIN,\n\tFREESECT: -1,\n\t/* 2.2 Compound File Header */\n\tHEADER_SIGNATURE: HEADER_SIGNATURE,\n\tHEADER_MINOR_VERSION: '3e00',\n\tMAXREGSID: -6,\n\tNOSTREAM: -1,\n\tHEADER_CLSID: HEADER_CLSID,\n\t/* 2.6.1 Compound File Directory Entry */\n\tEntryTypes: ['unknown','storage','stream','lockbytes','property','root']\n};\n\nfunction write_file(cfb/*:CFBContainer*/, filename/*:string*/, options/*:CFBWriteOpts*/)/*:void*/ {\n\tget_fs();\n\tvar o = _write(cfb, options);\n\t/*:: if(typeof Buffer == 'undefined' || !Buffer.isBuffer(o) || !(o instanceof Buffer)) throw new Error(\"unreachable\"); */\n\tfs.writeFileSync(filename, o);\n}\n\nfunction a2s(o/*:RawBytes*/)/*:string*/ {\n\tvar out = new Array(o.length);\n\tfor(var i = 0; i < o.length; ++i) out[i] = String.fromCharCode(o[i]);\n\treturn out.join(\"\");\n}\n\nfunction write(cfb/*:CFBContainer*/, options/*:CFBWriteOpts*/)/*:RawBytes|string*/ {\n\tvar o = _write(cfb, options);\n\tswitch(options && options.type || \"buffer\") {\n\t\tcase \"file\": get_fs(); fs.writeFileSync(options.filename, (o/*:any*/)); return o;\n\t\tcase \"binary\": return typeof o == \"string\" ? o : a2s(o);\n\t\tcase \"base64\": return Base64_encode(typeof o == \"string\" ? o : a2s(o));\n\t\tcase \"buffer\": if(has_buf) return Buffer.isBuffer(o) ? o : Buffer_from(o);\n\t\t\t/* falls through */\n\t\tcase \"array\": return typeof o == \"string\" ? s2a(o) : o;\n\t}\n\treturn o;\n}\n/* node < 8.1 zlib does not expose bytesRead, so default to pure JS */\nvar _zlib;\nfunction use_zlib(zlib) { try {\n\tvar InflateRaw = zlib.InflateRaw;\n\tvar InflRaw = new InflateRaw();\n\tInflRaw._processChunk(new Uint8Array([3, 0]), InflRaw._finishFlushFlag);\n\tif(InflRaw.bytesRead) _zlib = zlib;\n\telse throw new Error(\"zlib does not expose bytesRead\");\n} catch(e) {console.error(\"cannot use native zlib: \" + (e.message || e)); } }\n\nfunction _inflateRawSync(payload, usz) {\n\tif(!_zlib) return _inflate(payload, usz);\n\tvar InflateRaw = _zlib.InflateRaw;\n\tvar InflRaw = new InflateRaw();\n\tvar out = InflRaw._processChunk(payload.slice(payload.l), InflRaw._finishFlushFlag);\n\tpayload.l += InflRaw.bytesRead;\n\treturn out;\n}\n\nfunction _deflateRawSync(payload) {\n\treturn _zlib ? _zlib.deflateRawSync(payload) : _deflate(payload);\n}\nvar CLEN_ORDER = [ 16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15 ];\n\n/*  LEN_ID = [ 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285 ]; */\nvar LEN_LN = [   3,   4,   5,   6,   7,   8,   9,  10,  11,  13 , 15,  17,  19,  23,  27,  31,  35,  43,  51,  59,  67,  83,  99, 115, 131, 163, 195, 227, 258 ];\n\n/*  DST_ID = [  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13,  14,  15,  16,  17,  18,  19,   20,   21,   22,   23,   24,   25,   26,    27,    28,    29 ]; */\nvar DST_LN = [  1,  2,  3,  4,  5,  7,  9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577 ];\n\nfunction bit_swap_8(n) { var t = (((((n<<1)|(n<<11)) & 0x22110) | (((n<<5)|(n<<15)) & 0x88440))); return ((t>>16) | (t>>8) |t)&0xFF; }\n\nvar use_typed_arrays = typeof Uint8Array !== 'undefined';\n\nvar bitswap8 = use_typed_arrays ? new Uint8Array(1<<8) : [];\nfor(var q = 0; q < (1<<8); ++q) bitswap8[q] = bit_swap_8(q);\n\nfunction bit_swap_n(n, b) {\n\tvar rev = bitswap8[n & 0xFF];\n\tif(b <= 8) return rev >>> (8-b);\n\trev = (rev << 8) | bitswap8[(n>>8)&0xFF];\n\tif(b <= 16) return rev >>> (16-b);\n\trev = (rev << 8) | bitswap8[(n>>16)&0xFF];\n\treturn rev >>> (24-b);\n}\n\n/* helpers for unaligned bit reads */\nfunction read_bits_2(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 6 ? 0 : buf[h+1]<<8))>>>w)& 0x03; }\nfunction read_bits_3(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 5 ? 0 : buf[h+1]<<8))>>>w)& 0x07; }\nfunction read_bits_4(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 4 ? 0 : buf[h+1]<<8))>>>w)& 0x0F; }\nfunction read_bits_5(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 3 ? 0 : buf[h+1]<<8))>>>w)& 0x1F; }\nfunction read_bits_7(buf, bl) { var w = (bl&7), h = (bl>>>3); return ((buf[h]|(w <= 1 ? 0 : buf[h+1]<<8))>>>w)& 0x7F; }\n\n/* works up to n = 3 * 8 + 1 = 25 */\nfunction read_bits_n(buf, bl, n) {\n\tvar w = (bl&7), h = (bl>>>3), f = ((1<<n)-1);\n\tvar v = buf[h] >>> w;\n\tif(n < 8 - w) return v & f;\n\tv |= buf[h+1]<<(8-w);\n\tif(n < 16 - w) return v & f;\n\tv |= buf[h+2]<<(16-w);\n\tif(n < 24 - w) return v & f;\n\tv |= buf[h+3]<<(24-w);\n\treturn v & f;\n}\n\n/* helpers for unaligned bit writes */\nfunction write_bits_3(buf, bl, v) { var w = bl & 7, h = bl >>> 3;\n\tif(w <= 5) buf[h] |= (v & 7) << w;\n\telse {\n\t\tbuf[h] |= (v << w) & 0xFF;\n\t\tbuf[h+1] = (v&7) >> (8-w);\n\t}\n\treturn bl + 3;\n}\n\nfunction write_bits_1(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv = (v&1) << w;\n\tbuf[h] |= v;\n\treturn bl + 1;\n}\nfunction write_bits_8(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv <<= w;\n\tbuf[h] |=  v & 0xFF; v >>>= 8;\n\tbuf[h+1] = v;\n\treturn bl + 8;\n}\nfunction write_bits_16(buf, bl, v) {\n\tvar w = bl & 7, h = bl >>> 3;\n\tv <<= w;\n\tbuf[h] |=  v & 0xFF; v >>>= 8;\n\tbuf[h+1] = v & 0xFF;\n\tbuf[h+2] = v >>> 8;\n\treturn bl + 16;\n}\n\n/* until ArrayBuffer#realloc is a thing, fake a realloc */\nfunction realloc(b, sz/*:number*/) {\n\tvar L = b.length, M = 2*L > sz ? 2*L : sz + 5, i = 0;\n\tif(L >= sz) return b;\n\tif(has_buf) {\n\t\tvar o = new_unsafe_buf(M);\n\t\t// $FlowIgnore\n\t\tif(b.copy) b.copy(o);\n\t\telse for(; i < b.length; ++i) o[i] = b[i];\n\t\treturn o;\n\t} else if(use_typed_arrays) {\n\t\tvar a = new Uint8Array(M);\n\t\tif(a.set) a.set(b);\n\t\telse for(; i < L; ++i) a[i] = b[i];\n\t\treturn a;\n\t}\n\tb.length = M;\n\treturn b;\n}\n\n/* zero-filled arrays for older browsers */\nfunction zero_fill_array(n) {\n\tvar o = new Array(n);\n\tfor(var i = 0; i < n; ++i) o[i] = 0;\n\treturn o;\n}\n\n/* build tree (used for literals and lengths) */\nfunction build_tree(clens, cmap, MAX/*:number*/)/*:number*/ {\n\tvar maxlen = 1, w = 0, i = 0, j = 0, ccode = 0, L = clens.length;\n\n\tvar bl_count  = use_typed_arrays ? new Uint16Array(32) : zero_fill_array(32);\n\tfor(i = 0; i < 32; ++i) bl_count[i] = 0;\n\n\tfor(i = L; i < MAX; ++i) clens[i] = 0;\n\tL = clens.length;\n\n\tvar ctree = use_typed_arrays ? new Uint16Array(L) : zero_fill_array(L); // []\n\n\t/* build code tree */\n\tfor(i = 0; i < L; ++i) {\n\t\tbl_count[(w = clens[i])]++;\n\t\tif(maxlen < w) maxlen = w;\n\t\tctree[i] = 0;\n\t}\n\tbl_count[0] = 0;\n\tfor(i = 1; i <= maxlen; ++i) bl_count[i+16] = (ccode = (ccode + bl_count[i-1])<<1);\n\tfor(i = 0; i < L; ++i) {\n\t\tccode = clens[i];\n\t\tif(ccode != 0) ctree[i] = bl_count[ccode+16]++;\n\t}\n\n\t/* cmap[maxlen + 4 bits] = (off&15) + (lit<<4) reverse mapping */\n\tvar cleni = 0;\n\tfor(i = 0; i < L; ++i) {\n\t\tcleni = clens[i];\n\t\tif(cleni != 0) {\n\t\t\tccode = bit_swap_n(ctree[i], maxlen)>>(maxlen-cleni);\n\t\t\tfor(j = (1<<(maxlen + 4 - cleni)) - 1; j>=0; --j)\n\t\t\t\tcmap[ccode|(j<<cleni)] = (cleni&15) | (i<<4);\n\t\t}\n\t}\n\treturn maxlen;\n}\n\n/* Fixed Huffman */\nvar fix_lmap = use_typed_arrays ? new Uint16Array(512) : zero_fill_array(512);\nvar fix_dmap = use_typed_arrays ? new Uint16Array(32)  : zero_fill_array(32);\nif(!use_typed_arrays) {\n\tfor(var i = 0; i < 512; ++i) fix_lmap[i] = 0;\n\tfor(i = 0; i < 32; ++i) fix_dmap[i] = 0;\n}\n(function() {\n\tvar dlens/*:Array<number>*/ = [];\n\tvar i = 0;\n\tfor(;i<32; i++) dlens.push(5);\n\tbuild_tree(dlens, fix_dmap, 32);\n\n\tvar clens/*:Array<number>*/ = [];\n\ti = 0;\n\tfor(; i<=143; i++) clens.push(8);\n\tfor(; i<=255; i++) clens.push(9);\n\tfor(; i<=279; i++) clens.push(7);\n\tfor(; i<=287; i++) clens.push(8);\n\tbuild_tree(clens, fix_lmap, 288);\n})();var _deflateRaw = /*#__PURE__*/(function _deflateRawIIFE() {\n\tvar DST_LN_RE = use_typed_arrays ? new Uint8Array(0x8000) : [];\n\tvar j = 0, k = 0;\n\tfor(; j < DST_LN.length - 1; ++j) {\n\t\tfor(; k < DST_LN[j+1]; ++k) DST_LN_RE[k] = j;\n\t}\n\tfor(;k < 32768; ++k) DST_LN_RE[k] = 29;\n\n\tvar LEN_LN_RE = use_typed_arrays ? new Uint8Array(0x103) : [];\n\tfor(j = 0, k = 0; j < LEN_LN.length - 1; ++j) {\n\t\tfor(; k < LEN_LN[j+1]; ++k) LEN_LN_RE[k] = j;\n\t}\n\n\tfunction write_stored(data, out) {\n\t\tvar boff = 0;\n\t\twhile(boff < data.length) {\n\t\t\tvar L = Math.min(0xFFFF, data.length - boff);\n\t\t\tvar h = boff + L == data.length;\n\t\t\tout.write_shift(1, +h);\n\t\t\tout.write_shift(2, L);\n\t\t\tout.write_shift(2, (~L) & 0xFFFF);\n\t\t\twhile(L-- > 0) out[out.l++] = data[boff++];\n\t\t}\n\t\treturn out.l;\n\t}\n\n\t/* Fixed Huffman */\n\tfunction write_huff_fixed(data, out) {\n\t\tvar bl = 0;\n\t\tvar boff = 0;\n\t\tvar addrs = use_typed_arrays ? new Uint16Array(0x8000) : [];\n\t\twhile(boff < data.length) {\n\t\t\tvar L = /* data.length - boff; */ Math.min(0xFFFF, data.length - boff);\n\n\t\t\t/* write a stored block for short data */\n\t\t\tif(L < 10) {\n\t\t\t\tbl = write_bits_3(out, bl, +!!(boff + L == data.length)); // jshint ignore:line\n\t\t\t\tif(bl & 7) bl += 8 - (bl & 7);\n\t\t\t\tout.l = (bl / 8) | 0;\n\t\t\t\tout.write_shift(2, L);\n\t\t\t\tout.write_shift(2, (~L) & 0xFFFF);\n\t\t\t\twhile(L-- > 0) out[out.l++] = data[boff++];\n\t\t\t\tbl = out.l * 8;\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tbl = write_bits_3(out, bl, +!!(boff + L == data.length) + 2); // jshint ignore:line\n\t\t\tvar hash = 0;\n\t\t\twhile(L-- > 0) {\n\t\t\t\tvar d = data[boff];\n\t\t\t\thash = ((hash << 5) ^ d) & 0x7FFF;\n\n\t\t\t\tvar match = -1, mlen = 0;\n\n\t\t\t\tif((match = addrs[hash])) {\n\t\t\t\t\tmatch |= boff & ~0x7FFF;\n\t\t\t\t\tif(match > boff) match -= 0x8000;\n\t\t\t\t\tif(match < boff) while(data[match + mlen] == data[boff + mlen] && mlen < 250) ++mlen;\n\t\t\t\t}\n\n\t\t\t\tif(mlen > 2) {\n\t\t\t\t\t/* Copy Token  */\n\t\t\t\t\td = LEN_LN_RE[mlen];\n\t\t\t\t\tif(d <= 22) bl = write_bits_8(out, bl, bitswap8[d+1]>>1) - 1;\n\t\t\t\t\telse {\n\t\t\t\t\t\twrite_bits_8(out, bl, 3);\n\t\t\t\t\t\tbl += 5;\n\t\t\t\t\t\twrite_bits_8(out, bl, bitswap8[d-23]>>5);\n\t\t\t\t\t\tbl += 3;\n\t\t\t\t\t}\n\t\t\t\t\tvar len_eb = (d < 8) ? 0 : ((d - 4)>>2);\n\t\t\t\t\tif(len_eb > 0) {\n\t\t\t\t\t\twrite_bits_16(out, bl, mlen - LEN_LN[d]);\n\t\t\t\t\t\tbl += len_eb;\n\t\t\t\t\t}\n\n\t\t\t\t\td = DST_LN_RE[boff - match];\n\t\t\t\t\tbl = write_bits_8(out, bl, bitswap8[d]>>3);\n\t\t\t\t\tbl -= 3;\n\n\t\t\t\t\tvar dst_eb = d < 4 ? 0 : (d-2)>>1;\n\t\t\t\t\tif(dst_eb > 0) {\n\t\t\t\t\t\twrite_bits_16(out, bl, boff - match - DST_LN[d]);\n\t\t\t\t\t\tbl += dst_eb;\n\t\t\t\t\t}\n\t\t\t\t\tfor(var q = 0; q < mlen; ++q) {\n\t\t\t\t\t\taddrs[hash] = boff & 0x7FFF;\n\t\t\t\t\t\thash = ((hash << 5) ^ data[boff]) & 0x7FFF;\n\t\t\t\t\t\t++boff;\n\t\t\t\t\t}\n\t\t\t\t\tL-= mlen - 1;\n\t\t\t\t} else {\n\t\t\t\t\t/* Literal Token */\n\t\t\t\t\tif(d <= 143) d = d + 48;\n\t\t\t\t\telse bl = write_bits_1(out, bl, 1);\n\t\t\t\t\tbl = write_bits_8(out, bl, bitswap8[d]);\n\t\t\t\t\taddrs[hash] = boff & 0x7FFF;\n\t\t\t\t\t++boff;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbl = write_bits_8(out, bl, 0) - 1;\n\t\t}\n\t\tout.l = ((bl + 7)/8)|0;\n\t\treturn out.l;\n\t}\n\treturn function _deflateRaw(data, out) {\n\t\tif(data.length < 8) return write_stored(data, out);\n\t\treturn write_huff_fixed(data, out);\n\t};\n})();\n\nfunction _deflate(data) {\n\tvar buf = new_buf(50+Math.floor(data.length*1.1));\n\tvar off = _deflateRaw(data, buf);\n\treturn buf.slice(0, off);\n}\n/* modified inflate function also moves original read head */\n\nvar dyn_lmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\nvar dyn_dmap = use_typed_arrays ? new Uint16Array(32768) : zero_fill_array(32768);\nvar dyn_cmap = use_typed_arrays ? new Uint16Array(128)   : zero_fill_array(128);\nvar dyn_len_1 = 1, dyn_len_2 = 1;\n\n/* 5.5.3 Expanding Huffman Codes */\nfunction dyn(data, boff/*:number*/) {\n\t/* nomenclature from RFC1951 refers to bit values; these are offset by the implicit constant */\n\tvar _HLIT = read_bits_5(data, boff) + 257; boff += 5;\n\tvar _HDIST = read_bits_5(data, boff) + 1; boff += 5;\n\tvar _HCLEN = read_bits_4(data, boff) + 4; boff += 4;\n\tvar w = 0;\n\n\t/* grab and store code lengths */\n\tvar clens = use_typed_arrays ? new Uint8Array(19) : zero_fill_array(19);\n\tvar ctree = [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ];\n\tvar maxlen = 1;\n\tvar bl_count =  use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n\tvar next_code = use_typed_arrays ? new Uint8Array(8) : zero_fill_array(8);\n\tvar L = clens.length; /* 19 */\n\tfor(var i = 0; i < _HCLEN; ++i) {\n\t\tclens[CLEN_ORDER[i]] = w = read_bits_3(data, boff);\n\t\tif(maxlen < w) maxlen = w;\n\t\tbl_count[w]++;\n\t\tboff += 3;\n\t}\n\n\t/* build code tree */\n\tvar ccode = 0;\n\tbl_count[0] = 0;\n\tfor(i = 1; i <= maxlen; ++i) next_code[i] = ccode = (ccode + bl_count[i-1])<<1;\n\tfor(i = 0; i < L; ++i) if((ccode = clens[i]) != 0) ctree[i] = next_code[ccode]++;\n\t/* cmap[7 bits from stream] = (off&7) + (lit<<3) */\n\tvar cleni = 0;\n\tfor(i = 0; i < L; ++i) {\n\t\tcleni = clens[i];\n\t\tif(cleni != 0) {\n\t\t\tccode = bitswap8[ctree[i]]>>(8-cleni);\n\t\t\tfor(var j = (1<<(7-cleni))-1; j>=0; --j) dyn_cmap[ccode|(j<<cleni)] = (cleni&7) | (i<<3);\n\t\t}\n\t}\n\n\t/* read literal and dist codes at once */\n\tvar hcodes/*:Array<number>*/ = [];\n\tmaxlen = 1;\n\tfor(; hcodes.length < _HLIT + _HDIST;) {\n\t\tccode = dyn_cmap[read_bits_7(data, boff)];\n\t\tboff += ccode & 7;\n\t\tswitch((ccode >>>= 3)) {\n\t\t\tcase 16:\n\t\t\t\tw = 3 + read_bits_2(data, boff); boff += 2;\n\t\t\t\tccode = hcodes[hcodes.length - 1];\n\t\t\t\twhile(w-- > 0) hcodes.push(ccode);\n\t\t\t\tbreak;\n\t\t\tcase 17:\n\t\t\t\tw = 3 + read_bits_3(data, boff); boff += 3;\n\t\t\t\twhile(w-- > 0) hcodes.push(0);\n\t\t\t\tbreak;\n\t\t\tcase 18:\n\t\t\t\tw = 11 + read_bits_7(data, boff); boff += 7;\n\t\t\t\twhile(w -- > 0) hcodes.push(0);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\thcodes.push(ccode);\n\t\t\t\tif(maxlen < ccode) maxlen = ccode;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/* build literal / length trees */\n\tvar h1 = hcodes.slice(0, _HLIT), h2 = hcodes.slice(_HLIT);\n\tfor(i = _HLIT; i < 286; ++i) h1[i] = 0;\n\tfor(i = _HDIST; i < 30; ++i) h2[i] = 0;\n\tdyn_len_1 = build_tree(h1, dyn_lmap, 286);\n\tdyn_len_2 = build_tree(h2, dyn_dmap, 30);\n\treturn boff;\n}\n\n/* return [ data, bytesRead ] */\nfunction inflate(data, usz/*:number*/) {\n\t/* shortcircuit for empty buffer [0x03, 0x00] */\n\tif(data[0] == 3 && !(data[1] & 0x3)) { return [new_raw_buf(usz), 2]; }\n\n\t/* bit offset */\n\tvar boff = 0;\n\n\t/* header includes final bit and type bits */\n\tvar header = 0;\n\n\tvar outbuf = new_unsafe_buf(usz ? usz : (1<<18));\n\tvar woff = 0;\n\tvar OL = outbuf.length>>>0;\n\tvar max_len_1 = 0, max_len_2 = 0;\n\n\twhile((header&1) == 0) {\n\t\theader = read_bits_3(data, boff); boff += 3;\n\t\tif((header >>> 1) == 0) {\n\t\t\t/* Stored block */\n\t\t\tif(boff & 7) boff += 8 - (boff&7);\n\t\t\t/* 2 bytes sz, 2 bytes bit inverse */\n\t\t\tvar sz = data[boff>>>3] | data[(boff>>>3)+1]<<8;\n\t\t\tboff += 32;\n\t\t\t/* push sz bytes */\n\t\t\tif(sz > 0) {\n\t\t\t\tif(!usz && OL < woff + sz) { outbuf = realloc(outbuf, woff + sz); OL = outbuf.length; }\n\t\t\t\twhile(sz-- > 0) { outbuf[woff++] = data[boff>>>3]; boff += 8; }\n\t\t\t}\n\t\t\tcontinue;\n\t\t} else if((header >> 1) == 1) {\n\t\t\t/* Fixed Huffman */\n\t\t\tmax_len_1 = 9; max_len_2 = 5;\n\t\t} else {\n\t\t\t/* Dynamic Huffman */\n\t\t\tboff = dyn(data, boff);\n\t\t\tmax_len_1 = dyn_len_1; max_len_2 = dyn_len_2;\n\t\t}\n\t\tfor(;;) { // while(true) is apparently out of vogue in modern JS circles\n\t\t\tif(!usz && (OL < woff + 32767)) { outbuf = realloc(outbuf, woff + 32767); OL = outbuf.length; }\n\t\t\t/* ingest code and move read head */\n\t\t\tvar bits = read_bits_n(data, boff, max_len_1);\n\t\t\tvar code = (header>>>1) == 1 ? fix_lmap[bits] : dyn_lmap[bits];\n\t\t\tboff += code & 15; code >>>= 4;\n\t\t\t/* 0-255 are literals, 256 is end of block token, 257+ are copy tokens */\n\t\t\tif(((code>>>8)&0xFF) === 0) outbuf[woff++] = code;\n\t\t\telse if(code == 256) break;\n\t\t\telse {\n\t\t\t\tcode -= 257;\n\t\t\t\tvar len_eb = (code < 8) ? 0 : ((code-4)>>2); if(len_eb > 5) len_eb = 0;\n\t\t\t\tvar tgt = woff + LEN_LN[code];\n\t\t\t\t/* length extra bits */\n\t\t\t\tif(len_eb > 0) {\n\t\t\t\t\ttgt += read_bits_n(data, boff, len_eb);\n\t\t\t\t\tboff += len_eb;\n\t\t\t\t}\n\n\t\t\t\t/* dist code */\n\t\t\t\tbits = read_bits_n(data, boff, max_len_2);\n\t\t\t\tcode = (header>>>1) == 1 ? fix_dmap[bits] : dyn_dmap[bits];\n\t\t\t\tboff += code & 15; code >>>= 4;\n\t\t\t\tvar dst_eb = (code < 4 ? 0 : (code-2)>>1);\n\t\t\t\tvar dst = DST_LN[code];\n\t\t\t\t/* dist extra bits */\n\t\t\t\tif(dst_eb > 0) {\n\t\t\t\t\tdst += read_bits_n(data, boff, dst_eb);\n\t\t\t\t\tboff += dst_eb;\n\t\t\t\t}\n\n\t\t\t\t/* in the common case, manual byte copy is faster than TA set / Buffer copy */\n\t\t\t\tif(!usz && OL < tgt) { outbuf = realloc(outbuf, tgt + 100); OL = outbuf.length; }\n\t\t\t\twhile(woff < tgt) { outbuf[woff] = outbuf[woff - dst]; ++woff; }\n\t\t\t}\n\t\t}\n\t}\n\tif(usz) return [outbuf, (boff+7)>>>3];\n\treturn [outbuf.slice(0, woff), (boff+7)>>>3];\n}\n\nfunction _inflate(payload, usz) {\n\tvar data = payload.slice(payload.l||0);\n\tvar out = inflate(data, usz);\n\tpayload.l += out[1];\n\treturn out[0];\n}\n\nfunction warn_or_throw(wrn, msg) {\n\tif(wrn) { if(typeof console !== 'undefined') console.error(msg); }\n\telse throw new Error(msg);\n}\n\nfunction parse_zip(file/*:RawBytes*/, options/*:CFBReadOpts*/)/*:CFBContainer*/ {\n\tvar blob/*:CFBlob*/ = /*::(*/file/*:: :any)*/;\n\tprep_blob(blob, 0);\n\n\tvar FileIndex/*:CFBFileIndex*/ = [], FullPaths/*:Array<string>*/ = [];\n\tvar o = {\n\t\tFileIndex: FileIndex,\n\t\tFullPaths: FullPaths\n\t};\n\tinit_cfb(o, { root: options.root });\n\n\t/* find end of central directory, start just after signature */\n\tvar i = blob.length - 4;\n\twhile((blob[i] != 0x50 || blob[i+1] != 0x4b || blob[i+2] != 0x05 || blob[i+3] != 0x06) && i >= 0) --i;\n\tblob.l = i + 4;\n\n\t/* parse end of central directory */\n\tblob.l += 4;\n\tvar fcnt = blob.read_shift(2);\n\tblob.l += 6;\n\tvar start_cd = blob.read_shift(4);\n\n\t/* parse central directory */\n\tblob.l = start_cd;\n\n\tfor(i = 0; i < fcnt; ++i) {\n\t\t/* trust local file header instead of CD entry */\n\t\tblob.l += 20;\n\t\tvar csz = blob.read_shift(4);\n\t\tvar usz = blob.read_shift(4);\n\t\tvar namelen = blob.read_shift(2);\n\t\tvar efsz = blob.read_shift(2);\n\t\tvar fcsz = blob.read_shift(2);\n\t\tblob.l += 8;\n\t\tvar offset = blob.read_shift(4);\n\t\tvar EF = parse_extra_field(/*::(*/blob.slice(blob.l+namelen, blob.l+namelen+efsz)/*:: :any)*/);\n\t\tblob.l += namelen + efsz + fcsz;\n\n\t\tvar L = blob.l;\n\t\tblob.l = offset + 4;\n\t\tparse_local_file(blob, csz, usz, o, EF);\n\t\tblob.l = L;\n\t}\n\treturn o;\n}\n\n\n/* head starts just after local file header signature */\nfunction parse_local_file(blob/*:CFBlob*/, csz/*:number*/, usz/*:number*/, o/*:CFBContainer*/, EF) {\n\t/* [local file header] */\n\tblob.l += 2;\n\tvar flags = blob.read_shift(2);\n\tvar meth = blob.read_shift(2);\n\tvar date = parse_dos_date(blob);\n\n\tif(flags & 0x2041) throw new Error(\"Unsupported ZIP encryption\");\n\tvar crc32 = blob.read_shift(4);\n\tvar _csz = blob.read_shift(4);\n\tvar _usz = blob.read_shift(4);\n\n\tvar namelen = blob.read_shift(2);\n\tvar efsz = blob.read_shift(2);\n\n\t// TODO: flags & (1<<11) // UTF8\n\tvar name = \"\"; for(var i = 0; i < namelen; ++i) name += String.fromCharCode(blob[blob.l++]);\n\tif(efsz) {\n\t\tvar ef = parse_extra_field(/*::(*/blob.slice(blob.l, blob.l + efsz)/*:: :any)*/);\n\t\tif((ef[0x5455]||{}).mt) date = ef[0x5455].mt;\n\t\tif(((EF||{})[0x5455]||{}).mt) date = EF[0x5455].mt;\n\t}\n\tblob.l += efsz;\n\n\t/* [encryption header] */\n\n\t/* [file data] */\n\tvar data = blob.slice(blob.l, blob.l + _csz);\n\tswitch(meth) {\n\t\tcase 8: data = _inflateRawSync(blob, _usz); break;\n\t\tcase 0: break; // TODO: scan for magic number\n\t\tdefault: throw new Error(\"Unsupported ZIP Compression method \" + meth);\n\t}\n\n\t/* [data descriptor] */\n\tvar wrn = false;\n\tif(flags & 8) {\n\t\tcrc32 = blob.read_shift(4);\n\t\tif(crc32 == 0x08074b50) { crc32 = blob.read_shift(4); wrn = true; }\n\t\t_csz = blob.read_shift(4);\n\t\t_usz = blob.read_shift(4);\n\t}\n\n\tif(_csz != csz) warn_or_throw(wrn, \"Bad compressed size: \" + csz + \" != \" + _csz);\n\tif(_usz != usz) warn_or_throw(wrn, \"Bad uncompressed size: \" + usz + \" != \" + _usz);\n\t//var _crc32 = CRC32.buf(data, 0);\n\t//if((crc32>>0) != (_crc32>>0)) warn_or_throw(wrn, \"Bad CRC32 checksum: \" + crc32 + \" != \" + _crc32);\n\tcfb_add(o, name, data, {unsafe: true, mt: date});\n}\nfunction write_zip(cfb/*:CFBContainer*/, options/*:CFBWriteOpts*/)/*:RawBytes*/ {\n\tvar _opts = options || {};\n\tvar out = [], cdirs = [];\n\tvar o/*:CFBlob*/ = new_buf(1);\n\tvar method = (_opts.compression ? 8 : 0), flags = 0;\n\tvar desc = false;\n\tif(desc) flags |= 8;\n\tvar i = 0, j = 0;\n\n\tvar start_cd = 0, fcnt = 0;\n\tvar root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];\n\tvar crcs = [];\n\tvar sz_cd = 0;\n\n\tfor(i = 1; i < cfb.FullPaths.length; ++i) {\n\t\tfp = cfb.FullPaths[i].slice(root.length); fi = cfb.FileIndex[i];\n\t\tif(!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n\t\tvar start = start_cd;\n\n\t\t/* TODO: CP437 filename */\n\t\tvar namebuf = new_buf(fp.length);\n\t\tfor(j = 0; j < fp.length; ++j) namebuf.write_shift(1, fp.charCodeAt(j) & 0x7F);\n\t\tnamebuf = namebuf.slice(0, namebuf.l);\n\t\tcrcs[fcnt] = CRC32.buf(/*::((*/fi.content/*::||[]):any)*/, 0);\n\n\t\tvar outbuf = fi.content/*::||[]*/;\n\t\tif(method == 8) outbuf = _deflateRawSync(outbuf);\n\n\t\t/* local file header */\n\t\to = new_buf(30);\n\t\to.write_shift(4, 0x04034b50);\n\t\to.write_shift(2, 20);\n\t\to.write_shift(2, flags);\n\t\to.write_shift(2, method);\n\t\t/* TODO: last mod file time/date */\n\t\tif(fi.mt) write_dos_date(o, fi.mt);\n\t\telse o.write_shift(4, 0);\n\t\to.write_shift(-4, (flags & 8) ? 0 : crcs[fcnt]);\n\t\to.write_shift(4,  (flags & 8) ? 0 : outbuf.length);\n\t\to.write_shift(4,  (flags & 8) ? 0 : /*::(*/fi.content/*::||[])*/.length);\n\t\to.write_shift(2, namebuf.length);\n\t\to.write_shift(2, 0);\n\n\t\tstart_cd += o.length;\n\t\tout.push(o);\n\t\tstart_cd += namebuf.length;\n\t\tout.push(namebuf);\n\n\t\t/* TODO: extra fields? */\n\n\t\t/* TODO: encryption header ? */\n\n\t\tstart_cd += outbuf.length;\n\t\tout.push(outbuf);\n\n\t\t/* data descriptor */\n\t\tif(flags & 8) {\n\t\t\to = new_buf(12);\n\t\t\to.write_shift(-4, crcs[fcnt]);\n\t\t\to.write_shift(4, outbuf.length);\n\t\t\to.write_shift(4, /*::(*/fi.content/*::||[])*/.length);\n\t\t\tstart_cd += o.l;\n\t\t\tout.push(o);\n\t\t}\n\n\t\t/* central directory */\n\t\to = new_buf(46);\n\t\to.write_shift(4, 0x02014b50);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 20);\n\t\to.write_shift(2, flags);\n\t\to.write_shift(2, method);\n\t\to.write_shift(4, 0); /* TODO: last mod file time/date */\n\t\to.write_shift(-4, crcs[fcnt]);\n\n\t\to.write_shift(4, outbuf.length);\n\t\to.write_shift(4, /*::(*/fi.content/*::||[])*/.length);\n\t\to.write_shift(2, namebuf.length);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(4, 0);\n\t\to.write_shift(4, start);\n\n\t\tsz_cd += o.l;\n\t\tcdirs.push(o);\n\t\tsz_cd += namebuf.length;\n\t\tcdirs.push(namebuf);\n\t\t++fcnt;\n\t}\n\n\t/* end of central directory */\n\to = new_buf(22);\n\to.write_shift(4, 0x06054b50);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, fcnt);\n\to.write_shift(2, fcnt);\n\to.write_shift(4, sz_cd);\n\to.write_shift(4, start_cd);\n\to.write_shift(2, 0);\n\n\treturn bconcat(([bconcat((out/*:any*/)), bconcat(cdirs), o]/*:any*/));\n}\nvar ContentTypeMap = ({\n\t\"htm\": \"text/html\",\n\t\"xml\": \"text/xml\",\n\n\t\"gif\": \"image/gif\",\n\t\"jpg\": \"image/jpeg\",\n\t\"png\": \"image/png\",\n\n\t\"mso\": \"application/x-mso\",\n\t\"thmx\": \"application/vnd.ms-officetheme\",\n\t\"sh33tj5\": \"application/octet-stream\"\n}/*:any*/);\n\nfunction get_content_type(fi/*:CFBEntry*/, fp/*:string*/)/*:string*/ {\n\tif(fi.ctype) return fi.ctype;\n\n\tvar ext = fi.name || \"\", m = ext.match(/\\.([^\\.]+)$/);\n\tif(m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\n\tif(fp) {\n\t\tm = (ext = fp).match(/[\\.\\\\]([^\\.\\\\])+$/);\n\t\tif(m && ContentTypeMap[m[1]]) return ContentTypeMap[m[1]];\n\t}\n\n\treturn \"application/octet-stream\";\n}\n\n/* 76 character chunks TODO: intertwine encoding */\nfunction write_base64_76(bstr/*:string*/)/*:string*/ {\n\tvar data = Base64_encode(bstr);\n\tvar o = [];\n\tfor(var i = 0; i < data.length; i+= 76) o.push(data.slice(i, i+76));\n\treturn o.join(\"\\r\\n\") + \"\\r\\n\";\n}\n\n/*\nRules for QP:\n\t- escape =## applies for all non-display characters and literal \"=\"\n\t- space or tab at end of line must be encoded\n\t- \\r\\n newlines can be preserved, but bare \\r and \\n must be escaped\n\t- lines must not exceed 76 characters, use soft breaks =\\r\\n\n\nTODO: Some files from word appear to write line extensions with bare equals:\n\n```\n<table class=3DMsoTableGrid border=3D1 cellspacing=3D0 cellpadding=3D0 width=\n=\"70%\"\n```\n*/\nfunction write_quoted_printable(text/*:string*/)/*:string*/ {\n\tvar encoded = text.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF=]/g, function(c) {\n\t\tvar w = c.charCodeAt(0).toString(16).toUpperCase();\n\t\treturn \"=\" + (w.length == 1 ? \"0\" + w : w);\n\t});\n\n\tencoded = encoded.replace(/ $/mg, \"=20\").replace(/\\t$/mg, \"=09\");\n\n\tif(encoded.charAt(0) == \"\\n\") encoded = \"=0D\" + encoded.slice(1);\n\tencoded = encoded.replace(/\\r(?!\\n)/mg, \"=0D\").replace(/\\n\\n/mg, \"\\n=0A\").replace(/([^\\r\\n])\\n/mg, \"$1=0A\");\n\n\tvar o/*:Array<string>*/ = [], split = encoded.split(\"\\r\\n\");\n\tfor(var si = 0; si < split.length; ++si) {\n\t\tvar str = split[si];\n\t\tif(str.length == 0) { o.push(\"\"); continue; }\n\t\tfor(var i = 0; i < str.length;) {\n\t\t\tvar end = 76;\n\t\t\tvar tmp = str.slice(i, i + end);\n\t\t\tif(tmp.charAt(end - 1) == \"=\") end --;\n\t\t\telse if(tmp.charAt(end - 2) == \"=\") end -= 2;\n\t\t\telse if(tmp.charAt(end - 3) == \"=\") end -= 3;\n\t\t\ttmp = str.slice(i, i + end);\n\t\t\ti += end;\n\t\t\tif(i < str.length) tmp += \"=\";\n\t\t\to.push(tmp);\n\t\t}\n\t}\n\n\treturn o.join(\"\\r\\n\");\n}\nfunction parse_quoted_printable(data/*:Array<string>*/)/*:RawBytes*/ {\n\tvar o = [];\n\n\t/* unify long lines */\n\tfor(var di = 0; di < data.length; ++di) {\n\t\tvar line = data[di];\n\t\twhile(di <= data.length && line.charAt(line.length - 1) == \"=\") line = line.slice(0, line.length - 1) + data[++di];\n\t\to.push(line);\n\t}\n\n\t/* decode */\n\tfor(var oi = 0; oi < o.length; ++oi) o[oi] = o[oi].replace(/[=][0-9A-Fa-f]{2}/g, function($$) { return String.fromCharCode(parseInt($$.slice(1), 16)); });\n\treturn s2a(o.join(\"\\r\\n\"));\n}\n\n\nfunction parse_mime(cfb/*:CFBContainer*/, data/*:Array<string>*/, root/*:string*/)/*:void*/ {\n\tvar fname = \"\", cte = \"\", ctype = \"\", fdata;\n\tvar di = 0;\n\tfor(;di < 10; ++di) {\n\t\tvar line = data[di];\n\t\tif(!line || line.match(/^\\s*$/)) break;\n\t\tvar m = line.match(/^(.*?):\\s*([^\\s].*)$/);\n\t\tif(m) switch(m[1].toLowerCase()) {\n\t\t\tcase \"content-location\": fname = m[2].trim(); break;\n\t\t\tcase \"content-type\": ctype = m[2].trim(); break;\n\t\t\tcase \"content-transfer-encoding\": cte = m[2].trim(); break;\n\t\t}\n\t}\n\t++di;\n\tswitch(cte.toLowerCase()) {\n\t\tcase 'base64': fdata = s2a(Base64_decode(data.slice(di).join(\"\"))); break;\n\t\tcase 'quoted-printable': fdata = parse_quoted_printable(data.slice(di)); break;\n\t\tdefault: throw new Error(\"Unsupported Content-Transfer-Encoding \" + cte);\n\t}\n\tvar file = cfb_add(cfb, fname.slice(root.length), fdata, {unsafe: true});\n\tif(ctype) file.ctype = ctype;\n}\n\nfunction parse_mad(file/*:RawBytes*/, options/*:CFBReadOpts*/)/*:CFBContainer*/ {\n\tif(a2s(file.slice(0,13)).toLowerCase() != \"mime-version:\") throw new Error(\"Unsupported MAD header\");\n\tvar root = (options && options.root || \"\");\n\t// $FlowIgnore\n\tvar data = (has_buf && Buffer.isBuffer(file) ? file.toString(\"binary\") : a2s(file)).split(\"\\r\\n\");\n\tvar di = 0, row = \"\";\n\n\t/* if root is not specified, scan for the common prefix */\n\tfor(di = 0; di < data.length; ++di) {\n\t\trow = data[di];\n\t\tif(!/^Content-Location:/i.test(row)) continue;\n\t\trow = row.slice(row.indexOf(\"file\"));\n\t\tif(!root) root = row.slice(0, row.lastIndexOf(\"/\") + 1);\n\t\tif(row.slice(0, root.length) == root) continue;\n\t\twhile(root.length > 0) {\n\t\t\troot = root.slice(0, root.length - 1);\n\t\t\troot = root.slice(0, root.lastIndexOf(\"/\") + 1);\n\t\t\tif(row.slice(0,root.length) == root) break;\n\t\t}\n\t}\n\n\tvar mboundary = (data[1] || \"\").match(/boundary=\"(.*?)\"/);\n\tif(!mboundary) throw new Error(\"MAD cannot find boundary\");\n\tvar boundary = \"--\" + (mboundary[1] || \"\");\n\n\tvar FileIndex/*:CFBFileIndex*/ = [], FullPaths/*:Array<string>*/ = [];\n\tvar o = {\n\t\tFileIndex: FileIndex,\n\t\tFullPaths: FullPaths\n\t};\n\tinit_cfb(o);\n\tvar start_di, fcnt = 0;\n\tfor(di = 0; di < data.length; ++di) {\n\t\tvar line = data[di];\n\t\tif(line !== boundary && line !== boundary + \"--\") continue;\n\t\tif(fcnt++) parse_mime(o, data.slice(start_di, di), root);\n\t\tstart_di = di;\n\t}\n\treturn o;\n}\n\nfunction write_mad(cfb/*:CFBContainer*/, options/*:CFBWriteOpts*/)/*:string*/ {\n\tvar opts = options || {};\n\tvar boundary = opts.boundary || \"SheetJS\";\n\tboundary = '------=' + boundary;\n\n\tvar out = [\n\t\t'MIME-Version: 1.0',\n\t\t'Content-Type: multipart/related; boundary=\"' + boundary.slice(2) + '\"',\n\t\t'',\n\t\t'',\n\t\t''\n\t];\n\n\tvar root = cfb.FullPaths[0], fp = root, fi = cfb.FileIndex[0];\n\tfor(var i = 1; i < cfb.FullPaths.length; ++i) {\n\t\tfp = cfb.FullPaths[i].slice(root.length);\n\t\tfi = cfb.FileIndex[i];\n\t\tif(!fi.size || !fi.content || fp == \"\\u0001Sh33tJ5\") continue;\n\n\t\t/* Normalize filename */\n\t\tfp = fp.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7E-\\xFF]/g, function(c) {\n\t\t\treturn \"_x\" + c.charCodeAt(0).toString(16) + \"_\";\n\t\t}).replace(/[\\u0080-\\uFFFF]/g, function(u) {\n\t\t\treturn \"_u\" + u.charCodeAt(0).toString(16) + \"_\";\n\t\t});\n\n\t\t/* Extract content as binary string */\n\t\tvar ca = fi.content;\n\t\t// $FlowIgnore\n\t\tvar cstr = has_buf && Buffer.isBuffer(ca) ? ca.toString(\"binary\") : a2s(ca);\n\n\t\t/* 4/5 of first 1024 chars ascii -> quoted printable, else base64 */\n\t\tvar dispcnt = 0, L = Math.min(1024, cstr.length), cc = 0;\n\t\tfor(var csl = 0; csl <= L; ++csl) if((cc=cstr.charCodeAt(csl)) >= 0x20 && cc < 0x80) ++dispcnt;\n\t\tvar qp = dispcnt >= L * 4 / 5;\n\n\t\tout.push(boundary);\n\t\tout.push('Content-Location: ' + (opts.root || 'file:///C:/SheetJS/') + fp);\n\t\tout.push('Content-Transfer-Encoding: ' + (qp ? 'quoted-printable' : 'base64'));\n\t\tout.push('Content-Type: ' + get_content_type(fi, fp));\n\t\tout.push('');\n\n\t\tout.push(qp ? write_quoted_printable(cstr) : write_base64_76(cstr));\n\t}\n\tout.push(boundary + '--\\r\\n');\n\treturn out.join(\"\\r\\n\");\n}\nfunction cfb_new(opts/*:?any*/)/*:CFBContainer*/ {\n\tvar o/*:CFBContainer*/ = ({}/*:any*/);\n\tinit_cfb(o, opts);\n\treturn o;\n}\n\nfunction cfb_add(cfb/*:CFBContainer*/, name/*:string*/, content/*:?RawBytes*/, opts/*:?any*/)/*:CFBEntry*/ {\n\tvar unsafe = opts && opts.unsafe;\n\tif(!unsafe) init_cfb(cfb);\n\tvar file = !unsafe && CFB.find(cfb, name);\n\tif(!file) {\n\t\tvar fpath/*:string*/ = cfb.FullPaths[0];\n\t\tif(name.slice(0, fpath.length) == fpath) fpath = name;\n\t\telse {\n\t\t\tif(fpath.slice(-1) != \"/\") fpath += \"/\";\n\t\t\tfpath = (fpath + name).replace(\"//\",\"/\");\n\t\t}\n\t\tfile = ({name: filename(name), type: 2}/*:any*/);\n\t\tcfb.FileIndex.push(file);\n\t\tcfb.FullPaths.push(fpath);\n\t\tif(!unsafe) CFB.utils.cfb_gc(cfb);\n\t}\n\t/*:: if(!file) throw new Error(\"unreachable\"); */\n\tfile.content = (content/*:any*/);\n\tfile.size = content ? content.length : 0;\n\tif(opts) {\n\t\tif(opts.CLSID) file.clsid = opts.CLSID;\n\t\tif(opts.mt) file.mt = opts.mt;\n\t\tif(opts.ct) file.ct = opts.ct;\n\t}\n\treturn file;\n}\n\nfunction cfb_del(cfb/*:CFBContainer*/, name/*:string*/)/*:boolean*/ {\n\tinit_cfb(cfb);\n\tvar file = CFB.find(cfb, name);\n\tif(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\n\t\tcfb.FileIndex.splice(j, 1);\n\t\tcfb.FullPaths.splice(j, 1);\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction cfb_mov(cfb/*:CFBContainer*/, old_name/*:string*/, new_name/*:string*/)/*:boolean*/ {\n\tinit_cfb(cfb);\n\tvar file = CFB.find(cfb, old_name);\n\tif(file) for(var j = 0; j < cfb.FileIndex.length; ++j) if(cfb.FileIndex[j] == file) {\n\t\tcfb.FileIndex[j].name = filename(new_name);\n\t\tcfb.FullPaths[j] = new_name;\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction cfb_gc(cfb/*:CFBContainer*/)/*:void*/ { rebuild_cfb(cfb, true); }\n\nexports.find = find;\nexports.read = read;\nexports.parse = parse;\nexports.write = write;\nexports.writeFile = write_file;\nexports.utils = {\n\tcfb_new: cfb_new,\n\tcfb_add: cfb_add,\n\tcfb_del: cfb_del,\n\tcfb_mov: cfb_mov,\n\tcfb_gc: cfb_gc,\n\tReadShift: ReadShift,\n\tCheckField: CheckField,\n\tprep_blob: prep_blob,\n\tbconcat: bconcat,\n\tuse_zlib: use_zlib,\n\t_deflateRaw: _deflate,\n\t_inflateRaw: _inflate,\n\tconsts: consts\n};\n\nreturn exports;\n})();\n\nlet _fs = void 0;\nfunction set_fs(fs) { _fs = fs; }\nexport { set_fs };\n\n/* normalize data for blob ctor */\nfunction blobify(data) {\n\tif(typeof data === \"string\") return s2ab(data);\n\tif(Array.isArray(data)) return a2u(data);\n\treturn data;\n}\n/* write or download file */\nfunction write_dl(fname/*:string*/, payload/*:any*/, enc/*:?string*/) {\n\t/*global IE_SaveFile, Blob, navigator, saveAs, document, File, chrome */\n\tif(typeof _fs !== 'undefined' && _fs.writeFileSync) return enc ? _fs.writeFileSync(fname, payload, enc) : _fs.writeFileSync(fname, payload);\n\tif(typeof Deno !== 'undefined') {\n\t\t/* in this spot, it's safe to assume typed arrays and TextEncoder/TextDecoder exist */\n\t\tif(enc && typeof payload == \"string\") switch(enc) {\n\t\t\tcase \"utf8\": payload = new TextEncoder(enc).encode(payload); break;\n\t\t\tcase \"binary\": payload = s2ab(payload); break;\n\t\t\t/* TODO: binary equivalent */\n\t\t\tdefault: throw new Error(\"Unsupported encoding \" + enc);\n\t\t}\n\t\treturn Deno.writeFileSync(fname, payload);\n\t}\n\tvar data = (enc == \"utf8\") ? utf8write(payload) : payload;\n\t/*:: declare var IE_SaveFile: any; */\n\tif(typeof IE_SaveFile !== 'undefined') return IE_SaveFile(data, fname);\n\tif(typeof Blob !== 'undefined') {\n\t\tvar blob = new Blob([blobify(data)], {type:\"application/octet-stream\"});\n\t\t/*:: declare var navigator: any; */\n\t\tif(typeof navigator !== 'undefined' && navigator.msSaveBlob) return navigator.msSaveBlob(blob, fname);\n\t\t/*:: declare var saveAs: any; */\n\t\tif(typeof saveAs !== 'undefined') return saveAs(blob, fname);\n\t\tif(typeof URL !== 'undefined' && typeof document !== 'undefined' && document.createElement && URL.createObjectURL) {\n\t\t\tvar url = URL.createObjectURL(blob);\n\t\t\t/*:: declare var chrome: any; */\n\t\t\tif(typeof chrome === 'object' && typeof (chrome.downloads||{}).download == \"function\") {\n\t\t\t\tif(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\t\t\treturn chrome.downloads.download({ url: url, filename: fname, saveAs: true});\n\t\t\t}\n\t\t\tvar a = document.createElement(\"a\");\n\t\t\tif(a.download != null) {\n\t\t\t\t/*:: if(document.body == null) throw new Error(\"unreachable\"); */\n\t\t\t\ta.download = fname; a.href = url; document.body.appendChild(a); a.click();\n\t\t\t\t/*:: if(document.body == null) throw new Error(\"unreachable\"); */ document.body.removeChild(a);\n\t\t\t\tif(URL.revokeObjectURL && typeof setTimeout !== 'undefined') setTimeout(function() { URL.revokeObjectURL(url); }, 60000);\n\t\t\t\treturn url;\n\t\t\t}\n\t\t}\n\t}\n\t// $FlowIgnore\n\tif(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\n\t\t// $FlowIgnore\n\t\tvar out = File(fname); out.open(\"w\"); out.encoding = \"binary\";\n\t\tif(Array.isArray(payload)) payload = a2s(payload);\n\t\tout.write(payload); out.close(); return payload;\n\t} catch(e) { if(!e.message || !e.message.match(/onstruct/)) throw e; }\n\tthrow new Error(\"cannot save file \" + fname);\n}\n\n/* read binary data from file */\nfunction read_binary(path/*:string*/) {\n\tif(typeof _fs !== 'undefined') return _fs.readFileSync(path);\n\tif(typeof Deno !== 'undefined') return Deno.readFileSync(path);\n\t// $FlowIgnore\n\tif(typeof $ !== 'undefined' && typeof File !== 'undefined' && typeof Folder !== 'undefined') try { // extendscript\n\t\t// $FlowIgnore\n\t\tvar infile = File(path); infile.open(\"r\"); infile.encoding = \"binary\";\n\t\tvar data = infile.read(); infile.close();\n\t\treturn data;\n\t} catch(e) { if(!e.message || !e.message.match(/onstruct/)) throw e; }\n\tthrow new Error(\"Cannot access file \" + path);\n}\nfunction keys(o/*:any*/)/*:Array<any>*/ {\n\tvar ks = Object.keys(o), o2 = [];\n\tfor(var i = 0; i < ks.length; ++i) if(Object.prototype.hasOwnProperty.call(o, ks[i])) o2.push(ks[i]);\n\treturn o2;\n}\n\nfunction evert_key(obj/*:any*/, key/*:string*/)/*:EvertType*/ {\n\tvar o = ([]/*:any*/), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) if(o[obj[K[i]][key]] == null) o[obj[K[i]][key]] = K[i];\n\treturn o;\n}\n\nfunction evert(obj/*:any*/)/*:EvertType*/ {\n\tvar o = ([]/*:any*/), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = K[i];\n\treturn o;\n}\n\nfunction evert_num(obj/*:any*/)/*:EvertNumType*/ {\n\tvar o = ([]/*:any*/), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) o[obj[K[i]]] = parseInt(K[i],10);\n\treturn o;\n}\n\nfunction evert_arr(obj/*:any*/)/*:EvertArrType*/ {\n\tvar o/*:EvertArrType*/ = ([]/*:any*/), K = keys(obj);\n\tfor(var i = 0; i !== K.length; ++i) {\n\t\tif(o[obj[K[i]]] == null) o[obj[K[i]]] = [];\n\t\to[obj[K[i]]].push(K[i]);\n\t}\n\treturn o;\n}\n\nvar basedate = /*#__PURE__*/new Date(1899, 11, 30, 0, 0, 0); // 2209161600000\nfunction datenum(v/*:Date*/, date1904/*:?boolean*/)/*:number*/ {\n\tvar epoch = /*#__PURE__*/v.getTime();\n\tif(date1904) epoch -= 1462*24*60*60*1000;\n\tvar dnthresh = /*#__PURE__*/basedate.getTime() + (/*#__PURE__*/v.getTimezoneOffset() - /*#__PURE__*/basedate.getTimezoneOffset()) * 60000;\n\treturn (epoch - dnthresh) / (24 * 60 * 60 * 1000);\n}\nvar refdate = /*#__PURE__*/new Date();\nvar dnthresh = /*#__PURE__*/basedate.getTime() + (/*#__PURE__*/refdate.getTimezoneOffset() - /*#__PURE__*/basedate.getTimezoneOffset()) * 60000;\nvar refoffset = /*#__PURE__*/refdate.getTimezoneOffset();\nfunction numdate(v/*:number*/)/*:Date*/ {\n\tvar out = new Date();\n\tout.setTime(v * 24 * 60 * 60 * 1000 + dnthresh);\n\tif (out.getTimezoneOffset() !== refoffset) {\n\t\tout.setTime(out.getTime() + (out.getTimezoneOffset() - refoffset) * 60000);\n\t}\n\treturn out;\n}\n\n/* ISO 8601 Duration */\nfunction parse_isodur(s) {\n\tvar sec = 0, mt = 0, time = false;\n\tvar m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\n\tif(!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\n\tfor(var i = 1; i != m.length; ++i) {\n\t\tif(!m[i]) continue;\n\t\tmt = 1;\n\t\tif(i > 3) time = true;\n\t\tswitch(m[i].slice(m[i].length-1)) {\n\t\t\tcase 'Y':\n\t\t\t\tthrow new Error(\"Unsupported ISO Duration Field: \" + m[i].slice(m[i].length-1));\n\t\t\tcase 'D': mt *= 24;\n\t\t\t\t/* falls through */\n\t\t\tcase 'H': mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'M':\n\t\t\t\tif(!time) throw new Error(\"Unsupported ISO Duration Field: M\");\n\t\t\t\telse mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'S': break;\n\t\t}\n\t\tsec += mt * parseInt(m[i], 10);\n\t}\n\treturn sec;\n}\n\nvar good_pd_date_1 = /*#__PURE__*/new Date('2017-02-19T19:06:09.000Z');\nvar good_pd_date = /*#__PURE__*/isNaN(/*#__PURE__*/good_pd_date_1.getFullYear()) ? /*#__PURE__*/new Date('2/19/17') : good_pd_date_1;\nvar good_pd = /*#__PURE__*/good_pd_date.getFullYear() == 2017;\n/* parses a date as a local date */\nfunction parseDate(str/*:string|Date*/, fixdate/*:?number*/)/*:Date*/ {\n\tvar d = new Date(str);\n\tif(good_pd) {\n\t\t/*:: if(fixdate == null) fixdate = 0; */\n\t\tif(fixdate > 0) d.setTime(d.getTime() + d.getTimezoneOffset() * 60 * 1000);\n\t\telse if(fixdate < 0) d.setTime(d.getTime() - d.getTimezoneOffset() * 60 * 1000);\n\t\treturn d;\n\t}\n\tif(str instanceof Date) return str;\n\tif(good_pd_date.getFullYear() == 1917 && !isNaN(d.getFullYear())) {\n\t\tvar s = d.getFullYear();\n\t\tif(str.indexOf(\"\" + s) > -1) return d;\n\t\td.setFullYear(d.getFullYear() + 100); return d;\n\t}\n\tvar n = str.match(/\\d+/g)||[\"2017\",\"2\",\"19\",\"0\",\"0\",\"0\"];\n\tvar out = new Date(+n[0], +n[1] - 1, +n[2], (+n[3]||0), (+n[4]||0), (+n[5]||0));\n\tif(str.indexOf(\"Z\") > -1) out = new Date(out.getTime() - out.getTimezoneOffset() * 60 * 1000);\n\treturn out;\n}\n\nfunction cc2str(arr/*:Array<number>*/, debomit)/*:string*/ {\n\tif(has_buf && Buffer.isBuffer(arr)) {\n\t\tif(debomit) {\n\t\t\tif(arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(arr.slice(2).toString(\"utf16le\"));\n\t\t\tif(arr[1] == 0xFE && arr[2] == 0xFF) return utf8write(utf16beread(arr.slice(2).toString(\"binary\")));\n\t\t}\n\t\treturn arr.toString(\"binary\");\n\t}\n\n\tif(typeof TextDecoder !== \"undefined\") try {\n\t\tif(debomit) {\n\t\t\tif(arr[0] == 0xFF && arr[1] == 0xFE) return utf8write(new TextDecoder(\"utf-16le\").decode(arr.slice(2)));\n\t\t\tif(arr[0] == 0xFE && arr[1] == 0xFF) return utf8write(new TextDecoder(\"utf-16be\").decode(arr.slice(2)));\n\t\t}\n\t\tvar rev = {\n\t\t\t\"\\u20ac\": \"\\x80\", \"\\u201a\": \"\\x82\", \"\\u0192\": \"\\x83\", \"\\u201e\": \"\\x84\",\n\t\t\t\"\\u2026\": \"\\x85\", \"\\u2020\": \"\\x86\", \"\\u2021\": \"\\x87\", \"\\u02c6\": \"\\x88\",\n\t\t\t\"\\u2030\": \"\\x89\", \"\\u0160\": \"\\x8a\", \"\\u2039\": \"\\x8b\", \"\\u0152\": \"\\x8c\",\n\t\t\t\"\\u017d\": \"\\x8e\", \"\\u2018\": \"\\x91\", \"\\u2019\": \"\\x92\", \"\\u201c\": \"\\x93\",\n\t\t\t\"\\u201d\": \"\\x94\", \"\\u2022\": \"\\x95\", \"\\u2013\": \"\\x96\", \"\\u2014\": \"\\x97\",\n\t\t\t\"\\u02dc\": \"\\x98\", \"\\u2122\": \"\\x99\", \"\\u0161\": \"\\x9a\", \"\\u203a\": \"\\x9b\",\n\t\t\t\"\\u0153\": \"\\x9c\", \"\\u017e\": \"\\x9e\", \"\\u0178\": \"\\x9f\"\n\t\t};\n\t\tif(Array.isArray(arr)) arr = new Uint8Array(arr);\n\t\treturn new TextDecoder(\"latin1\").decode(arr).replace(/[]/g, function(c) { return rev[c] || c; });\n\t} catch(e) {}\n\n\tvar o = [];\n\tfor(var i = 0; i != arr.length; ++i) o.push(String.fromCharCode(arr[i]));\n\treturn o.join(\"\");\n}\n\nfunction dup(o/*:any*/)/*:any*/ {\n\tif(typeof JSON != 'undefined' && !Array.isArray(o)) return JSON.parse(JSON.stringify(o));\n\tif(typeof o != 'object' || o == null) return o;\n\tif(o instanceof Date) return new Date(o.getTime());\n\tvar out = {};\n\tfor(var k in o) if(Object.prototype.hasOwnProperty.call(o, k)) out[k] = dup(o[k]);\n\treturn out;\n}\n\nfunction fill(c/*:string*/,l/*:number*/)/*:string*/ { var o = \"\"; while(o.length < l) o+=c; return o; }\n\n/* TODO: stress test */\nfunction fuzzynum(s/*:string*/)/*:number*/ {\n\tvar v/*:number*/ = Number(s);\n\tif(!isNaN(v)) return isFinite(v) ? v : NaN;\n\tif(!/\\d/.test(s)) return v;\n\tvar wt = 1;\n\tvar ss = s.replace(/([\\d]),([\\d])/g,\"$1$2\").replace(/[$]/g,\"\").replace(/[%]/g, function() { wt *= 100; return \"\";});\n\tif(!isNaN(v = Number(ss))) return v / wt;\n\tss = ss.replace(/[(](.*)[)]/,function($$, $1) { wt = -wt; return $1;});\n\tif(!isNaN(v = Number(ss))) return v / wt;\n\treturn v;\n}\nvar lower_months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\nfunction fuzzydate(s/*:string*/)/*:Date*/ {\n\tvar o = new Date(s), n = new Date(NaN);\n\tvar y = o.getYear(), m = o.getMonth(), d = o.getDate();\n\tif(isNaN(d)) return n;\n\tvar lower = s.toLowerCase();\n\tif(lower.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)) {\n\t\tlower = lower.replace(/[^a-z]/g,\"\").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,\"\");\n\t\tif(lower.length > 3 && lower_months.indexOf(lower) == -1) return n;\n\t} else if(lower.match(/[a-z]/)) return n;\n\tif(y < 0 || y > 8099) return n;\n\tif((m > 0 || d > 1) && y != 101) return o;\n\tif(s.match(/[^-0-9:,\\/\\\\]/)) return n;\n\treturn o;\n}\n\nvar split_regex = /*#__PURE__*/(function() {\n\tvar safe_split_regex = \"abacaba\".split(/(:?b)/i).length == 5;\n\treturn function split_regex(str/*:string*/, re, def/*:string*/)/*:Array<string>*/ {\n\t\tif(safe_split_regex || typeof re == \"string\") return str.split(re);\n\t\tvar p = str.split(re), o = [p[0]];\n\t\tfor(var i = 1; i < p.length; ++i) { o.push(def); o.push(p[i]); }\n\t\treturn o;\n\t};\n})();\nfunction getdatastr(data)/*:?string*/ {\n\tif(!data) return null;\n\tif(data.content && data.type) return cc2str(data.content, true);\n\tif(data.data) return debom(data.data);\n\tif(data.asNodeBuffer && has_buf) return debom(data.asNodeBuffer().toString('binary'));\n\tif(data.asBinary) return debom(data.asBinary());\n\tif(data._data && data._data.getContent) return debom(cc2str(Array.prototype.slice.call(data._data.getContent(),0)));\n\treturn null;\n}\n\nfunction getdatabin(data) {\n\tif(!data) return null;\n\tif(data.data) return char_codes(data.data);\n\tif(data.asNodeBuffer && has_buf) return data.asNodeBuffer();\n\tif(data._data && data._data.getContent) {\n\t\tvar o = data._data.getContent();\n\t\tif(typeof o == \"string\") return char_codes(o);\n\t\treturn Array.prototype.slice.call(o);\n\t}\n\tif(data.content && data.type) return data.content;\n\treturn null;\n}\n\nfunction getdata(data) { return (data && data.name.slice(-4) === \".bin\") ? getdatabin(data) : getdatastr(data); }\n\n/* Part 2 Section 10.1.2 \"Mapping Content Types\" Names are case-insensitive */\n/* OASIS does not comment on filename case sensitivity */\nfunction safegetzipfile(zip, file/*:string*/) {\n\tvar k = zip.FullPaths || keys(zip.files);\n\tvar f = file.toLowerCase().replace(/[\\/]/g, '\\\\'), g = f.replace(/\\\\/g,'\\/');\n\tfor(var i=0; i<k.length; ++i) {\n\t\tvar n = k[i].replace(/^Root Entry[\\/]/,\"\").toLowerCase();\n\t\tif(f == n || g == n) return zip.files ? zip.files[k[i]] : zip.FileIndex[i];\n\t}\n\treturn null;\n}\n\nfunction getzipfile(zip, file/*:string*/) {\n\tvar o = safegetzipfile(zip, file);\n\tif(o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n\treturn o;\n}\n\nfunction getzipdata(zip, file/*:string*/, safe/*:?boolean*/)/*:any*/ {\n\tif(!safe) return getdata(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipdata(zip, file); } catch(e) { return null; }\n}\n\nfunction getzipstr(zip, file/*:string*/, safe/*:?boolean*/)/*:?string*/ {\n\tif(!safe) return getdatastr(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipstr(zip, file); } catch(e) { return null; }\n}\n\nfunction getzipbin(zip, file/*:string*/, safe/*:?boolean*/)/*:any*/ {\n\tif(!safe) return getdatabin(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipbin(zip, file); } catch(e) { return null; }\n}\n\nfunction zipentries(zip) {\n\tvar k = zip.FullPaths || keys(zip.files), o = [];\n\tfor(var i = 0; i < k.length; ++i) if(k[i].slice(-1) != '/') o.push(k[i].replace(/^Root Entry[\\/]/, \"\"));\n\treturn o.sort();\n}\n\nfunction zip_add_file(zip, path, content) {\n\tif(zip.FullPaths) {\n\t\tif(typeof content == \"string\") {\n\t\t\tvar res;\n\t\t\tif(has_buf) res = Buffer_from(content);\n\t\t\t/* TODO: investigate performance in Edge 13 */\n\t\t\t//else if(typeof TextEncoder !== \"undefined\") res = new TextEncoder().encode(content);\n\t\t\telse res = utf8decode(content);\n\t\t\treturn CFB.utils.cfb_add(zip, path, res);\n\t\t}\n\t\tCFB.utils.cfb_add(zip, path, content);\n\t}\n\telse zip.file(path, content);\n}\n\nfunction zip_new() { return CFB.utils.cfb_new(); }\n\nfunction zip_read(d, o) {\n\tswitch(o.type) {\n\t\tcase \"base64\": return CFB.read(d, { type: \"base64\" });\n\t\tcase \"binary\": return CFB.read(d, { type: \"binary\" });\n\t\tcase \"buffer\": case \"array\": return CFB.read(d, { type: \"buffer\" });\n\t}\n\tthrow new Error(\"Unrecognized type \" + o.type);\n}\n\nfunction resolve_path(path/*:string*/, base/*:string*/)/*:string*/ {\n\tif(path.charAt(0) == \"/\") return path.slice(1);\n\tvar result = base.split('/');\n\tif(base.slice(-1) != \"/\") result.pop(); // folder path\n\tvar target = path.split('/');\n\twhile (target.length !== 0) {\n\t\tvar step = target.shift();\n\t\tif (step === '..') result.pop();\n\t\telse if (step !== '.') result.push(step);\n\t}\n\treturn result.join('/');\n}\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\nvar attregexg=/([^\"\\s?>\\/]+)\\s*=\\s*((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:')|([^'\">\\s]+))/g;\nvar tagregex1=/<[\\/\\?]?[a-zA-Z0-9:_-]+(?:\\s+[^\"\\s?>\\/]+\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^'\">\\s=]+))*\\s*[\\/\\?]?>/mg, tagregex2 = /<[^>]*>/g;\nvar tagregex = /*#__PURE__*/XML_HEADER.match(tagregex1) ? tagregex1 : tagregex2;\nvar nsregex=/<\\w*:/, nsregex2 = /<(\\/?)\\w+:/;\nfunction parsexmltag(tag/*:string*/, skip_root/*:?boolean*/, skip_LC/*:?boolean*/)/*:any*/ {\n\tvar z = ({}/*:any*/);\n\tvar eq = 0, c = 0;\n\tfor(; eq !== tag.length; ++eq) if((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\tif(!skip_root) z[0] = tag.slice(0, eq);\n\tif(eq === tag.length) return z;\n\tvar m = tag.match(attregexg), j=0, v=\"\", i=0, q=\"\", cc=\"\", quot = 1;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\tcc = m[i];\n\t\tfor(c=0; c != cc.length; ++c) if(cc.charCodeAt(c) === 61) break;\n\t\tq = cc.slice(0,c).trim();\n\t\twhile(cc.charCodeAt(c+1) == 32) ++c;\n\t\tquot = ((eq=cc.charCodeAt(c+1)) == 34 || eq == 39) ? 1 : 0;\n\t\tv = cc.slice(c+1+quot, cc.length-quot);\n\t\tfor(j=0;j!=q.length;++j) if(q.charCodeAt(j) === 58) break;\n\t\tif(j===q.length) {\n\t\t\tif(q.indexOf(\"_\") > 0) q = q.slice(0, q.indexOf(\"_\")); // from ods\n\t\t\tz[q] = v;\n\t\t\tif(!skip_LC) z[q.toLowerCase()] = v;\n\t\t}\n\t\telse {\n\t\t\tvar k = (j===5 && q.slice(0,5)===\"xmlns\"?\"xmlns\":\"\")+q.slice(j+1);\n\t\t\tif(z[k] && q.slice(j-3,j) == \"ext\") continue; // from ods\n\t\t\tz[k] = v;\n\t\t\tif(!skip_LC) z[k.toLowerCase()] = v;\n\t\t}\n\t}\n\treturn z;\n}\nfunction strip_ns(x/*:string*/)/*:string*/ { return x.replace(nsregex2, \"<$1\"); }\n\nvar encodings = {\n\t'&quot;': '\"',\n\t'&apos;': \"'\",\n\t'&gt;': '>',\n\t'&lt;': '<',\n\t'&amp;': '&'\n};\nvar rencoding = /*#__PURE__*/evert(encodings);\n//var rencstr = \"&<>'\\\"\".split(\"\");\n\n// TODO: CP remap (need to read file version to determine OS)\nvar unescapexml/*:StringConv*/ = /*#__PURE__*/(function() {\n\t/* 22.4.2.4 bstr (Basic String) */\n\tvar encregex = /&(?:quot|apos|gt|lt|amp|#x?([\\da-fA-F]+));/ig, coderegex = /_x([\\da-fA-F]{4})_/ig;\n\treturn function unescapexml(text/*:string*/)/*:string*/ {\n\t\tvar s = text + '', i = s.indexOf(\"<![CDATA[\");\n\t\tif(i == -1) return s.replace(encregex, function($$, $1) { return encodings[$$]||String.fromCharCode(parseInt($1,$$.indexOf(\"x\")>-1?16:10))||$$; }).replace(coderegex,function(m,c) {return String.fromCharCode(parseInt(c,16));});\n\t\tvar j = s.indexOf(\"]]>\");\n\t\treturn unescapexml(s.slice(0, i)) + s.slice(i+9,j) + unescapexml(s.slice(j+3));\n\t};\n})();\n\nvar decregex=/[&<>'\"]/g, charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\nfunction escapexml(text/*:string*/)/*:string*/{\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(charegex,function(s) { return \"_x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \"_\";});\n}\nfunction escapexmltag(text/*:string*/)/*:string*/{ return escapexml(text).replace(/ /g,\"_x0020_\"); }\n\nvar htmlcharegex = /[\\u0000-\\u001f]/g;\nfunction escapehtml(text/*:string*/)/*:string*/{\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(/\\n/g, \"<br/>\").replace(htmlcharegex,function(s) { return \"&#x\" + (\"000\"+s.charCodeAt(0).toString(16)).slice(-4) + \";\"; });\n}\n\nfunction escapexlml(text/*:string*/)/*:string*/{\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(htmlcharegex,function(s) { return \"&#x\" + (s.charCodeAt(0).toString(16)).toUpperCase() + \";\"; });\n}\n\n/* TODO: handle codepages */\nvar xlml_fixstr/*:StringConv*/ = /*#__PURE__*/(function() {\n\tvar entregex = /&#(\\d+);/g;\n\tfunction entrepl($$/*:string*/,$1/*:string*/)/*:string*/ { return String.fromCharCode(parseInt($1,10)); }\n\treturn function xlml_fixstr(str/*:string*/)/*:string*/ { return str.replace(entregex,entrepl); };\n})();\nfunction xlml_unfixstr(str/*:string*/)/*:string*/ { return str.replace(/(\\r\\n|[\\r\\n])/g,\"\\&#10;\"); }\n\nfunction parsexmlbool(value/*:any*/)/*:boolean*/ {\n\tswitch(value) {\n\t\tcase 1: case true: case '1': case 'true': case 'TRUE': return true;\n\t\t/* case '0': case 'false': case 'FALSE':*/\n\t\tdefault: return false;\n\t}\n}\n\nfunction utf8reada(orig/*:string*/)/*:string*/ {\n\tvar out = \"\", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;\n\twhile (i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tif (c < 128) { out += String.fromCharCode(c); continue; }\n\t\td = orig.charCodeAt(i++);\n\t\tif (c>191 && c<224) { f = ((c & 31) << 6); f |= (d & 63); out += String.fromCharCode(f); continue; }\n\t\te = orig.charCodeAt(i++);\n\t\tif (c < 240) { out += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63)); continue; }\n\t\tf = orig.charCodeAt(i++);\n\t\tw = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63))-65536;\n\t\tout += String.fromCharCode(0xD800 + ((w>>>10)&1023));\n\t\tout += String.fromCharCode(0xDC00 + (w&1023));\n\t}\n\treturn out;\n}\n\nfunction utf8readb(data) {\n\tvar out = new_raw_buf(2*data.length), w, i, j = 1, k = 0, ww=0, c;\n\tfor(i = 0; i < data.length; i+=j) {\n\t\tj = 1;\n\t\tif((c=data.charCodeAt(i)) < 128) w = c;\n\t\telse if(c < 224) { w = (c&31)*64+(data.charCodeAt(i+1)&63); j=2; }\n\t\telse if(c < 240) { w=(c&15)*4096+(data.charCodeAt(i+1)&63)*64+(data.charCodeAt(i+2)&63); j=3; }\n\t\telse { j = 4;\n\t\t\tw = (c & 7)*262144+(data.charCodeAt(i+1)&63)*4096+(data.charCodeAt(i+2)&63)*64+(data.charCodeAt(i+3)&63);\n\t\t\tw -= 65536; ww = 0xD800 + ((w>>>10)&1023); w = 0xDC00 + (w&1023);\n\t\t}\n\t\tif(ww !== 0) { out[k++] = ww&255; out[k++] = ww>>>8; ww = 0; }\n\t\tout[k++] = w%256; out[k++] = w>>>8;\n\t}\n\treturn out.slice(0,k).toString('ucs2');\n}\n\nfunction utf8readc(data) { return Buffer_from(data, 'binary').toString('utf8'); }\n\nvar utf8corpus = \"foo bar baz\\u00e2\\u0098\\u0083\\u00f0\\u009f\\u008d\\u00a3\";\nvar utf8read = has_buf && (/*#__PURE__*/utf8readc(utf8corpus) == /*#__PURE__*/utf8reada(utf8corpus) && utf8readc || /*#__PURE__*/utf8readb(utf8corpus) == /*#__PURE__*/utf8reada(utf8corpus) && utf8readb) || utf8reada;\n\nvar utf8write/*:StringConv*/ = has_buf ? function(data) { return Buffer_from(data, 'utf8').toString(\"binary\"); } : function(orig/*:string*/)/*:string*/ {\n\tvar out/*:Array<string>*/ = [], i = 0, c = 0, d = 0;\n\twhile(i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tswitch(true) {\n\t\t\tcase c < 128: out.push(String.fromCharCode(c)); break;\n\t\t\tcase c < 2048:\n\t\t\t\tout.push(String.fromCharCode(192 + (c >> 6)));\n\t\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t\t\tbreak;\n\t\t\tcase c >= 55296 && c < 57344:\n\t\t\t\tc -= 55296; d = orig.charCodeAt(i++) - 56320 + (c<<10);\n\t\t\t\tout.push(String.fromCharCode(240 + ((d >>18) & 7)));\n\t\t\t\tout.push(String.fromCharCode(144 + ((d >>12) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + ((d >> 6) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + (d & 63)));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tout.push(String.fromCharCode(224 + (c >> 12)));\n\t\t\t\tout.push(String.fromCharCode(128 + ((c >> 6) & 63)));\n\t\t\t\tout.push(String.fromCharCode(128 + (c & 63)));\n\t\t}\n\t}\n\treturn out.join(\"\");\n};\n\n// matches <foo>...</foo> extracts content\nvar matchtag = /*#__PURE__*/(function() {\n\tvar mtcache/*:{[k:string]:RegExp}*/ = ({}/*:any*/);\n\treturn function matchtag(f/*:string*/,g/*:?string*/)/*:RegExp*/ {\n\t\tvar t = f+\"|\"+(g||\"\");\n\t\tif(mtcache[t]) return mtcache[t];\n\t\treturn (mtcache[t] = new RegExp('<(?:\\\\w+:)?'+f+'(?: xml:space=\"preserve\")?(?:[^>]*)>([\\\\s\\\\S]*?)</(?:\\\\w+:)?'+f+'>',((g||\"\")/*:any*/)));\n\t};\n})();\n\nvar htmldecode/*:{(s:string):string}*/ = /*#__PURE__*/(function() {\n\tvar entities/*:Array<[RegExp, string]>*/ = [\n\t\t['nbsp', ' '], ['middot', ''],\n\t\t['quot', '\"'], ['apos', \"'\"], ['gt',   '>'], ['lt',   '<'], ['amp',  '&']\n\t].map(function(x/*:[string, string]*/) { return [new RegExp('&' + x[0] + ';', \"ig\"), x[1]]; });\n\treturn function htmldecode(str/*:string*/)/*:string*/ {\n\t\tvar o = str\n\t\t\t\t// Remove new lines and spaces from start of content\n\t\t\t\t.replace(/^[\\t\\n\\r ]+/, \"\")\n\t\t\t\t// Remove new lines and spaces from end of content\n\t\t\t\t.replace(/[\\t\\n\\r ]+$/,\"\")\n\t\t\t\t// Added line which removes any white space characters after and before html tags\n\t\t\t\t.replace(/>\\s+/g,\">\").replace(/\\s+</g,\"<\")\n\t\t\t\t// Replace remaining new lines and spaces with space\n\t\t\t\t.replace(/[\\t\\n\\r ]+/g, \" \")\n\t\t\t\t// Replace <br> tags with new lines\n\t\t\t\t.replace(/<\\s*[bB][rR]\\s*\\/?>/g,\"\\n\")\n\t\t\t\t// Strip HTML elements\n\t\t\t\t.replace(/<[^>]*>/g,\"\");\n\t\tfor(var i = 0; i < entities.length; ++i) o = o.replace(entities[i][0], entities[i][1]);\n\t\treturn o;\n\t};\n})();\n\nvar vtregex = /*#__PURE__*/(function(){ var vt_cache = {};\n\treturn function vt_regex(bt) {\n\t\tif(vt_cache[bt] !== undefined) return vt_cache[bt];\n\t\treturn (vt_cache[bt] = new RegExp(\"<(?:vt:)?\" + bt + \">([\\\\s\\\\S]*?)</(?:vt:)?\" + bt + \">\", 'g') );\n};})();\nvar vtvregex = /<\\/?(?:vt:)?variant>/g, vtmregex = /<(?:vt:)([^>]*)>([\\s\\S]*)</;\nfunction parseVector(data/*:string*/, opts)/*:Array<{v:string,t:string}>*/ {\n\tvar h = parsexmltag(data);\n\n\tvar matches/*:Array<string>*/ = data.match(vtregex(h.baseType))||[];\n\tvar res/*:Array<any>*/ = [];\n\tif(matches.length != h.size) {\n\t\tif(opts.WTF) throw new Error(\"unexpected vector length \" + matches.length + \" != \" + h.size);\n\t\treturn res;\n\t}\n\tmatches.forEach(function(x/*:string*/) {\n\t\tvar v = x.replace(vtvregex,\"\").match(vtmregex);\n\t\tif(v) res.push({v:utf8read(v[2]), t:v[1]});\n\t});\n\treturn res;\n}\n\nvar wtregex = /(^\\s|\\s$|\\n)/;\nfunction writetag(f/*:string*/,g/*:string*/)/*:string*/ { return '<' + f + (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f + '>'; }\n\nfunction wxt_helper(h)/*:string*/ { return keys(h).map(function(k) { return \" \" + k + '=\"' + h[k] + '\"';}).join(\"\"); }\nfunction writextag(f/*:string*/,g/*:?string*/,h) { return '<' + f + ((h != null) ? wxt_helper(h) : \"\") + ((g != null) ? (g.match(wtregex)?' xml:space=\"preserve\"' : \"\") + '>' + g + '</' + f : \"/\") + '>';}\n\nfunction write_w3cdtf(d/*:Date*/, t/*:?boolean*/)/*:string*/ { try { return d.toISOString().replace(/\\.\\d*/,\"\"); } catch(e) { if(t) throw e; } return \"\"; }\n\nfunction write_vt(s, xlsx/*:?boolean*/)/*:string*/ {\n\tswitch(typeof s) {\n\t\tcase 'string':\n\t\t\tvar o = writextag('vt:lpwstr', escapexml(s));\n\t\t\tif(xlsx) o = o.replace(/&quot;/g, \"_x0022_\");\n\t\t\treturn o;\n\t\tcase 'number': return writextag((s|0)==s?'vt:i4':'vt:r8', escapexml(String(s)));\n\t\tcase 'boolean': return writextag('vt:bool',s?'true':'false');\n\t}\n\tif(s instanceof Date) return writextag('vt:filetime', write_w3cdtf(s));\n\tthrow new Error(\"Unable to serialize \" + s);\n}\n\nfunction xlml_normalize(d)/*:string*/ {\n\tif(has_buf &&/*::typeof Buffer !== \"undefined\" && d != null && d instanceof Buffer &&*/ Buffer.isBuffer(d)) return d.toString('utf8');\n\tif(typeof d === 'string') return d;\n\t/* duktape */\n\tif(typeof Uint8Array !== 'undefined' && d instanceof Uint8Array) return utf8read(a2s(ab2a(d)));\n\tthrow new Error(\"Bad input format: expected Buffer or string\");\n}\n/* UOS uses CJK in tags */\nvar xlmlregex = /<(\\/?)([^\\s?><!\\/:]*:|)([^\\s?<>:\\/]+)(?:[\\s?:\\/][^>]*)?>/mg;\n//var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\n\nvar XMLNS = ({\n\tCORE_PROPS: 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties',\n\tCUST_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties\",\n\tEXT_PROPS: \"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\",\n\tCT: 'http://schemas.openxmlformats.org/package/2006/content-types',\n\tRELS: 'http://schemas.openxmlformats.org/package/2006/relationships',\n\tTCMNT: 'http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments',\n\t'dc': 'http://purl.org/dc/elements/1.1/',\n\t'dcterms': 'http://purl.org/dc/terms/',\n\t'dcmitype': 'http://purl.org/dc/dcmitype/',\n\t'mx': 'http://schemas.microsoft.com/office/mac/excel/2008/main',\n\t'r': 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',\n\t'sjs': 'http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties',\n\t'vt': 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes',\n\t'xsi': 'http://www.w3.org/2001/XMLSchema-instance',\n\t'xsd': 'http://www.w3.org/2001/XMLSchema'\n}/*:any*/);\n\nvar XMLNS_main = [\n\t'http://schemas.openxmlformats.org/spreadsheetml/2006/main',\n\t'http://purl.oclc.org/ooxml/spreadsheetml/main',\n\t'http://schemas.microsoft.com/office/excel/2006/main',\n\t'http://schemas.microsoft.com/office/excel/2006/2'\n];\n\nvar XLMLNS = ({\n\t'o':    'urn:schemas-microsoft-com:office:office',\n\t'x':    'urn:schemas-microsoft-com:office:excel',\n\t'ss':   'urn:schemas-microsoft-com:office:spreadsheet',\n\t'dt':   'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882',\n\t'mv':   'http://macVmlSchemaUri',\n\t'v':    'urn:schemas-microsoft-com:vml',\n\t'html': 'http://www.w3.org/TR/REC-html40'\n}/*:any*/);\nfunction read_double_le(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ {\n\tvar s = 1 - 2 * (b[idx + 7] >>> 7);\n\tvar e = ((b[idx + 7] & 0x7f) << 4) + ((b[idx + 6] >>> 4) & 0x0f);\n\tvar m = (b[idx+6]&0x0f);\n\tfor(var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];\n\tif(e == 0x7ff) return m == 0 ? (s * Infinity) : NaN;\n\tif(e == 0) e = -1022;\n\telse { e -= 1023; m += Math.pow(2,52); }\n\treturn s * Math.pow(2, e - 52) * m;\n}\n\nfunction write_double_le(b/*:RawBytes|CFBlob*/, v/*:number*/, idx/*:number*/) {\n\tvar bs = ((((v < 0) || (1/v == -Infinity)) ? 1 : 0) << 7), e = 0, m = 0;\n\tvar av = bs ? (-v) : v;\n\tif(!isFinite(av)) { e = 0x7ff; m = isNaN(v) ? 0x6969 : 0; }\n\telse if(av == 0) e = m = 0;\n\telse {\n\t\te = Math.floor(Math.log(av) / Math.LN2);\n\t\tm = av * Math.pow(2, 52 - e);\n\t\tif((e <= -1023) && (!isFinite(m) || (m < Math.pow(2,52)))) { e = -1022; }\n\t\telse { m -= Math.pow(2,52); e+=1023; }\n\t}\n\tfor(var i = 0; i <= 5; ++i, m/=256) b[idx + i] = m & 0xff;\n\tb[idx + 6] = ((e & 0x0f) << 4) | (m & 0xf);\n\tb[idx + 7] = (e >> 4) | bs;\n}\n\nvar ___toBuffer = function(bufs/*:Array<Array<RawBytes> >*/)/*:RawBytes*/ { var x=[],w=10240; for(var i=0;i<bufs[0].length;++i) if(bufs[0][i]) for(var j=0,L=bufs[0][i].length;j<L;j+=w) x.push.apply(x, bufs[0][i].slice(j,j+w)); return x; };\nvar __toBuffer = has_buf ? function(bufs) { return (bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0])) ? Buffer.concat(bufs[0].map(function(x) { return Buffer.isBuffer(x) ? x : Buffer_from(x); })) : ___toBuffer(bufs);} : ___toBuffer;\n\nvar ___utf16le = function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/)/*:string*/ { var ss/*:Array<string>*/=[]; for(var i=s; i<e; i+=2) ss.push(String.fromCharCode(__readUInt16LE(b,i))); return ss.join(\"\").replace(chr0,''); };\nvar __utf16le = has_buf ? function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/)/*:string*/ { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/) return ___utf16le(b,s,e); return b.toString('utf16le',s,e).replace(chr0,'')/*.replace(chr1,'!')*/; } : ___utf16le;\n\nvar ___hexlify = function(b/*:RawBytes|CFBlob*/,s/*:number*/,l/*:number*/)/*:string*/ { var ss/*:Array<string>*/=[]; for(var i=s; i<s+l; ++i) ss.push((\"0\" + b[i].toString(16)).slice(-2)); return ss.join(\"\"); };\nvar __hexlify = has_buf ? function(b/*:RawBytes|CFBlob*/,s/*:number*/,l/*:number*/)/*:string*/ { return Buffer.isBuffer(b)/*:: && b instanceof Buffer*/ ? b.toString('hex',s,s+l) : ___hexlify(b,s,l); } : ___hexlify;\n\nvar ___utf8 = function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/) { var ss=[]; for(var i=s; i<e; i++) ss.push(String.fromCharCode(__readUInt8(b,i))); return ss.join(\"\"); };\nvar __utf8 = has_buf ? function utf8_b(b/*:RawBytes|CFBlob*/, s/*:number*/, e/*:number*/) { return (Buffer.isBuffer(b)/*:: && (b instanceof Buffer)*/) ? b.toString('utf8',s,e) : ___utf8(b,s,e); } : ___utf8;\n\nvar ___lpstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpstr = ___lpstr;\n\nvar ___cpstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __cpstr = ___cpstr;\n\nvar ___lpwstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = 2*__readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpwstr = ___lpwstr;\n\nvar ___lpp4 = function lpp4_(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? __utf16le(b, i+4,i+4+len) : \"\";};\nvar __lpp4 = ___lpp4;\n\nvar ___8lpp4 = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len) : \"\";};\nvar __8lpp4 = ___8lpp4;\n\nvar ___double = function(b/*:RawBytes|CFBlob*/, idx/*:number*/) { return read_double_le(b, idx);};\nvar __double = ___double;\n\nvar is_buf = function is_buf_a(a) { return Array.isArray(a) || (typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array); };\n\nif(has_buf/*:: && typeof Buffer !== 'undefined'*/) {\n\t__lpstr = function lpstr_b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/) return ___lpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__cpstr = function cpstr_b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/) return ___cpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__lpwstr = function lpwstr_b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/) return ___lpwstr(b, i); var len = 2*b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len-1);};\n\t__lpp4 = function lpp4_b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/) return ___lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len);};\n\t__8lpp4 = function lpp4_8b(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(!Buffer.isBuffer(b)/*:: || !(b instanceof Buffer)*/) return ___8lpp4(b, i); var len = b.readUInt32LE(i); return b.toString('utf8',i+4,i+4+len);};\n\t__double = function double_(b/*:RawBytes|CFBlob*/, i/*:number*/) { if(Buffer.isBuffer(b)/*::&& b instanceof Buffer*/) return b.readDoubleLE(i); return ___double(b,i); };\n\tis_buf = function is_buf_b(a) { return Buffer.isBuffer(a) || Array.isArray(a) || (typeof Uint8Array !== \"undefined\" && a instanceof Uint8Array); };\n}\n\n/* from js-xls */\nfunction cpdoit() {\n\t__utf16le = function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/) { return $cptable.utils.decode(1200, b.slice(s,e)).replace(chr0, ''); };\n\t__utf8 = function(b/*:RawBytes|CFBlob*/,s/*:number*/,e/*:number*/) { return $cptable.utils.decode(65001, b.slice(s,e)); };\n\t__lpstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(current_ansi, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__cpstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(current_codepage, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__lpwstr = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = 2*__readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(1200, b.slice(i+4,i+4+len-1)) : \"\";};\n\t__lpp4 = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(1200, b.slice(i+4,i+4+len)) : \"\";};\n\t__8lpp4 = function(b/*:RawBytes|CFBlob*/,i/*:number*/) { var len = __readUInt32LE(b,i); return len > 0 ? $cptable.utils.decode(65001, b.slice(i+4,i+4+len)) : \"\";};\n}\nif(typeof $cptable !== 'undefined') cpdoit();\n\nvar __readUInt8 = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return b[idx]; };\nvar __readUInt16LE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return (b[idx+1]*(1<<8))+b[idx]; };\nvar __readInt16LE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { var u = (b[idx+1]*(1<<8))+b[idx]; return (u < 0x8000) ? u : ((0xffff - u + 1) * -1); };\nvar __readUInt32LE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return b[idx+3]*(1<<24)+(b[idx+2]<<16)+(b[idx+1]<<8)+b[idx]; };\nvar __readInt32LE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return (b[idx+3]<<24)|(b[idx+2]<<16)|(b[idx+1]<<8)|b[idx]; };\nvar __readInt32BE = function(b/*:RawBytes|CFBlob*/, idx/*:number*/)/*:number*/ { return (b[idx]<<24)|(b[idx+1]<<16)|(b[idx+2]<<8)|b[idx+3]; };\n\nfunction ReadShift(size/*:number*/, t/*:?string*/)/*:number|string*/ {\n\tvar o=\"\", oI/*:: :number = 0*/, oR, oo=[], w, vv, i, loc;\n\tswitch(t) {\n\t\tcase 'dbcs':\n\t\t\tloc = this.l;\n\t\t\tif(has_buf && Buffer.isBuffer(this)) o = this.slice(this.l, this.l+2*size).toString(\"utf16le\");\n\t\t\telse for(i = 0; i < size; ++i) { o+=String.fromCharCode(__readUInt16LE(this, loc)); loc+=2; }\n\t\t\tsize *= 2;\n\t\t\tbreak;\n\n\t\tcase 'utf8': o = __utf8(this, this.l, this.l + size); break;\n\t\tcase 'utf16le': size *= 2; o = __utf16le(this, this.l, this.l + size); break;\n\n\t\tcase 'wstr':\n\t\t\tif(typeof $cptable !== 'undefined') o = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l+2*size));\n\t\t\telse return ReadShift.call(this, size, 'dbcs');\n\t\t\tsize = 2 * size; break;\n\n\t\t/* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\t\tcase 'lpstr-ansi': o = __lpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\n\t\tcase 'lpstr-cp': o = __cpstr(this, this.l); size = 4 + __readUInt32LE(this, this.l); break;\n\t\t/* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\t\tcase 'lpwstr': o = __lpwstr(this, this.l); size = 4 + 2 * __readUInt32LE(this, this.l); break;\n\t\t/* [MS-OFFCRYPTO] 2.1.2 Length-Prefixed Padded Unicode String (UNICODE-LP-P4) */\n\t\tcase 'lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __lpp4(this, this.l); if(size & 0x02) size += 2; break;\n\t\t/* [MS-OFFCRYPTO] 2.1.3 Length-Prefixed UTF-8 String (UTF-8-LP-P4) */\n\t\tcase '8lpp4': size = 4 +  __readUInt32LE(this, this.l); o = __8lpp4(this, this.l); if(size & 0x03) size += 4 - (size & 0x03); break;\n\n\t\tcase 'cstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt8(this, this.l + size++))!==0) oo.push(_getchar(w));\n\t\t\to = oo.join(\"\"); break;\n\t\tcase '_wstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt16LE(this,this.l +size))!==0){oo.push(_getchar(w));size+=2;}\n\t\t\tsize+=2; o = oo.join(\"\"); break;\n\n\t\t/* sbcs and dbcs support continue records in the SST way TODO codepages */\n\t\tcase 'dbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i < size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt16LE(this, loc)));\n\t\t\t\tloc+=2;\n\t\t\t} o = oo.join(\"\"); size *= 2; break;\n\n\t\tcase 'cpstr':\n\t\t\tif(typeof $cptable !== 'undefined') {\n\t\t\t\to = $cptable.utils.decode(current_codepage, this.slice(this.l, this.l + size));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t/* falls through */\n\t\tcase 'sbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i != size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt8(this, loc)));\n\t\t\t\tloc+=1;\n\t\t\t} o = oo.join(\"\"); break;\n\n\t\tdefault:\n\tswitch(size) {\n\t\tcase 1: oI = __readUInt8(this, this.l); this.l++; return oI;\n\t\tcase 2: oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l); this.l += 2; return oI;\n\t\tcase 4: case -4:\n\t\t\tif(t === 'i' || ((this[this.l+3] & 0x80)===0)) { oI = ((size > 0) ? __readInt32LE : __readInt32BE)(this, this.l); this.l += 4; return oI; }\n\t\t\telse { oR = __readUInt32LE(this, this.l); this.l += 4; } return oR;\n\t\tcase 8: case -8:\n\t\t\tif(t === 'f') {\n\t\t\t\tif(size == 8) oR = __double(this, this.l);\n\t\t\t\telse oR = __double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]], 0);\n\t\t\t\tthis.l += 8; return oR;\n\t\t\t} else size = 8;\n\t\t/* falls through */\n\t\tcase 16: o = __hexlify(this, this.l, size); break;\n\t}}\n\tthis.l+=size; return o;\n}\n\nvar __writeUInt32LE = function(b/*:RawBytes|CFBlob*/, val/*:number*/, idx/*:number*/)/*:void*/ { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); b[idx+2] = ((val >>> 16) & 0xFF); b[idx+3] = ((val >>> 24) & 0xFF); };\nvar __writeInt32LE  = function(b/*:RawBytes|CFBlob*/, val/*:number*/, idx/*:number*/)/*:void*/ { b[idx] = (val & 0xFF); b[idx+1] = ((val >> 8) & 0xFF); b[idx+2] = ((val >> 16) & 0xFF); b[idx+3] = ((val >> 24) & 0xFF); };\nvar __writeUInt16LE = function(b/*:RawBytes|CFBlob*/, val/*:number*/, idx/*:number*/)/*:void*/ { b[idx] = (val & 0xFF); b[idx+1] = ((val >>> 8) & 0xFF); };\n\nfunction WriteShift(t/*:number*/, val/*:string|number*/, f/*:?string*/)/*:any*/ {\n\tvar size = 0, i = 0;\n\tif(f === 'dbcs') {\n\t\t/*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n\t\tfor(i = 0; i != val.length; ++i) __writeUInt16LE(this, val.charCodeAt(i), this.l + 2 * i);\n\t\tsize = 2 * val.length;\n\t} else if(f === 'sbcs') {\n\t\tif(typeof $cptable !== 'undefined' && current_ansi == 874) {\n\t\t\t/* TODO: use tables directly, don't encode */\n\t\t\t/*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n\t\t\tfor(i = 0; i != val.length; ++i) {\n\t\t\t\tvar cppayload = $cptable.utils.encode(current_ansi, val.charAt(i));\n\t\t\t\tthis[this.l + i] = cppayload[0];\n\t\t\t}\n\t\t} else {\n\t\t\t/*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n\t\t\tval = val.replace(/[^\\x00-\\x7F]/g, \"_\");\n\t\t\t/*:: if(typeof val !== 'string') throw new Error(\"unreachable\"); */\n\t\t\tfor(i = 0; i != val.length; ++i) this[this.l + i] = (val.charCodeAt(i) & 0xFF);\n\t\t}\n\t\tsize = val.length;\n\t} else if(f === 'hex') {\n\t\tfor(; i < t; ++i) {\n\t\t\t/*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n\t\t\tthis[this.l++] = (parseInt(val.slice(2*i, 2*i+2), 16)||0);\n\t\t} return this;\n\t} else if(f === 'utf16le') {\n\t\t\t/*:: if(typeof val !== \"string\") throw new Error(\"unreachable\"); */\n\t\t\tvar end/*:number*/ = Math.min(this.l + t, this.length);\n\t\t\tfor(i = 0; i < Math.min(val.length, t); ++i) {\n\t\t\t\tvar cc = val.charCodeAt(i);\n\t\t\t\tthis[this.l++] = (cc & 0xff);\n\t\t\t\tthis[this.l++] = (cc >> 8);\n\t\t\t}\n\t\t\twhile(this.l < end) this[this.l++] = 0;\n\t\t\treturn this;\n\t} else /*:: if(typeof val === 'number') */ switch(t) {\n\t\tcase  1: size = 1; this[this.l] = val&0xFF; break;\n\t\tcase  2: size = 2; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; break;\n\t\tcase  3: size = 3; this[this.l] = val&0xFF; val >>>= 8; this[this.l+1] = val&0xFF; val >>>= 8; this[this.l+2] = val&0xFF; break;\n\t\tcase  4: size = 4; __writeUInt32LE(this, val, this.l); break;\n\t\tcase  8: size = 8; if(f === 'f') { write_double_le(this, val, this.l); break; }\n\t\t/* falls through */\n\t\tcase 16: break;\n\t\tcase -4: size = 4; __writeInt32LE(this, val, this.l); break;\n\t}\n\tthis.l += size; return this;\n}\n\nfunction CheckField(hexstr/*:string*/, fld/*:string*/)/*:void*/ {\n\tvar m = __hexlify(this,this.l,hexstr.length>>1);\n\tif(m !== hexstr) throw new Error(fld + 'Expected ' + hexstr + ' saw ' + m);\n\tthis.l += hexstr.length>>1;\n}\n\nfunction prep_blob(blob, pos/*:number*/)/*:void*/ {\n\tblob.l = pos;\n\tblob.read_shift = /*::(*/ReadShift/*:: :any)*/;\n\tblob.chk = CheckField;\n\tblob.write_shift = WriteShift;\n}\n\nfunction parsenoop(blob, length/*:: :number, opts?:any */) { blob.l += length; }\n\nfunction new_buf(sz/*:number*/)/*:Block*/ {\n\tvar o = new_raw_buf(sz);\n\tprep_blob(o, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.1.4 Record */\nfunction recordhopper(data, cb/*:RecordHopperCB*/, opts/*:?any*/) {\n\tif(!data) return;\n\tvar tmpbyte, cntbyte, length;\n\tprep_blob(data, data.l || 0);\n\tvar L = data.length, RT = 0, tgt = 0;\n\twhile(data.l < L) {\n\t\tRT = data.read_shift(1);\n\t\tif(RT & 0x80) RT = (RT & 0x7F) + ((data.read_shift(1) & 0x7F)<<7);\n\t\tvar R = XLSBRecordEnum[RT] || XLSBRecordEnum[0xFFFF];\n\t\ttmpbyte = data.read_shift(1);\n\t\tlength = tmpbyte & 0x7F;\n\t\tfor(cntbyte = 1; cntbyte <4 && (tmpbyte & 0x80); ++cntbyte) length += ((tmpbyte = data.read_shift(1)) & 0x7F)<<(7*cntbyte);\n\t\ttgt = data.l + length;\n\t\tvar d = R.f && R.f(data, length, opts);\n\t\tdata.l = tgt;\n\t\tif(cb(d, R, RT)) return;\n\t}\n}\n\n/* control buffer usage for fixed-length buffers */\nfunction buf_array()/*:BufArray*/ {\n\tvar bufs/*:Array<Block>*/ = [], blksz = has_buf ? 256 : 2048;\n\tvar newblk = function ba_newblk(sz/*:number*/)/*:Block*/ {\n\t\tvar o/*:Block*/ = (new_buf(sz)/*:any*/);\n\t\tprep_blob(o, 0);\n\t\treturn o;\n\t};\n\n\tvar curbuf/*:Block*/ = newblk(blksz);\n\n\tvar endbuf = function ba_endbuf() {\n\t\tif(!curbuf) return;\n\t\tif(curbuf.length > curbuf.l) { curbuf = curbuf.slice(0, curbuf.l); curbuf.l = curbuf.length; }\n\t\tif(curbuf.length > 0) bufs.push(curbuf);\n\t\tcurbuf = null;\n\t};\n\n\tvar next = function ba_next(sz/*:number*/)/*:Block*/ {\n\t\tif(curbuf && (sz < (curbuf.length - curbuf.l))) return curbuf;\n\t\tendbuf();\n\t\treturn (curbuf = newblk(Math.max(sz+1, blksz)));\n\t};\n\n\tvar end = function ba_end() {\n\t\tendbuf();\n\t\treturn bconcat(bufs);\n\t};\n\n\tvar push = function ba_push(buf) { endbuf(); curbuf = buf; if(curbuf.l == null) curbuf.l = curbuf.length; next(blksz); };\n\n\treturn ({ next:next, push:push, end:end, _bufs:bufs }/*:any*/);\n}\n\nfunction write_record(ba/*:BufArray*/, type/*:number*/, payload, length/*:?number*/) {\n\tvar t/*:number*/ = +type, l;\n\tif(isNaN(t)) return; // TODO: throw something here?\n\tif(!length) length = XLSBRecordEnum[t].p || (payload||[]).length || 0;\n\tl = 1 + (t >= 0x80 ? 1 : 0) + 1/* + length*/;\n\tif(length >= 0x80) ++l; if(length >= 0x4000) ++l; if(length >= 0x200000) ++l;\n\tvar o = ba.next(l);\n\tif(t <= 0x7F) o.write_shift(1, t);\n\telse {\n\t\to.write_shift(1, (t & 0x7F) + 0x80);\n\t\to.write_shift(1, (t >> 7));\n\t}\n\tfor(var i = 0; i != 4; ++i) {\n\t\tif(length >= 0x80) { o.write_shift(1, (length & 0x7F)+0x80); length >>= 7; }\n\t\telse { o.write_shift(1, length); break; }\n\t}\n\tif(/*:: length != null &&*/length > 0 && is_buf(payload)) ba.push(payload);\n}\n/* XLS ranges enforced */\nfunction shift_cell_xls(cell/*:CellAddress*/, tgt/*:any*/, opts/*:?any*/)/*:CellAddress*/ {\n\tvar out = dup(cell);\n\tif(tgt.s) {\n\t\tif(out.cRel) out.c += tgt.s.c;\n\t\tif(out.rRel) out.r += tgt.s.r;\n\t} else {\n\t\tif(out.cRel) out.c += tgt.c;\n\t\tif(out.rRel) out.r += tgt.r;\n\t}\n\tif(!opts || opts.biff < 12) {\n\t\twhile(out.c >= 0x100) out.c -= 0x100;\n\t\twhile(out.r >= 0x10000) out.r -= 0x10000;\n\t}\n\treturn out;\n}\n\nfunction shift_range_xls(cell, range, opts) {\n\tvar out = dup(cell);\n\tout.s = shift_cell_xls(out.s, range.s, opts);\n\tout.e = shift_cell_xls(out.e, range.s, opts);\n\treturn out;\n}\n\nfunction encode_cell_xls(c/*:CellAddress*/, biff/*:number*/)/*:string*/ {\n\tif(c.cRel && c.c < 0) { c = dup(c); while(c.c < 0) c.c += (biff > 8) ? 0x4000 : 0x100; }\n\tif(c.rRel && c.r < 0) { c = dup(c); while(c.r < 0) c.r += (biff > 8) ? 0x100000 : ((biff > 5) ? 0x10000 : 0x4000); }\n\tvar s = encode_cell(c);\n\tif(!c.cRel && c.cRel != null) s = fix_col(s);\n\tif(!c.rRel && c.rRel != null) s = fix_row(s);\n\treturn s;\n}\n\nfunction encode_range_xls(r, opts)/*:string*/ {\n\tif(r.s.r == 0 && !r.s.rRel) {\n\t\tif(r.e.r == (opts.biff >= 12 ? 0xFFFFF : (opts.biff >= 8 ? 0x10000 : 0x4000)) && !r.e.rRel) {\n\t\t\treturn (r.s.cRel ? \"\" : \"$\") + encode_col(r.s.c) + \":\" + (r.e.cRel ? \"\" : \"$\") + encode_col(r.e.c);\n\t\t}\n\t}\n\tif(r.s.c == 0 && !r.s.cRel) {\n\t\tif(r.e.c == (opts.biff >= 12 ? 0x3FFF : 0xFF) && !r.e.cRel) {\n\t\t\treturn (r.s.rRel ? \"\" : \"$\") + encode_row(r.s.r) + \":\" + (r.e.rRel ? \"\" : \"$\") + encode_row(r.e.r);\n\t\t}\n\t}\n\treturn encode_cell_xls(r.s, opts.biff) + \":\" + encode_cell_xls(r.e, opts.biff);\n}\nfunction decode_row(rowstr/*:string*/)/*:number*/ { return parseInt(unfix_row(rowstr),10) - 1; }\nfunction encode_row(row/*:number*/)/*:string*/ { return \"\" + (row + 1); }\nfunction fix_row(cstr/*:string*/)/*:string*/ { return cstr.replace(/([A-Z]|^)(\\d+)$/,\"$1$$$2\"); }\nfunction unfix_row(cstr/*:string*/)/*:string*/ { return cstr.replace(/\\$(\\d+)$/,\"$1\"); }\n\nfunction decode_col(colstr/*:string*/)/*:number*/ { var c = unfix_col(colstr), d = 0, i = 0; for(; i !== c.length; ++i) d = 26*d + c.charCodeAt(i) - 64; return d - 1; }\nfunction encode_col(col/*:number*/)/*:string*/ { if(col < 0) throw new Error(\"invalid column \" + col); var s=\"\"; for(++col; col; col=Math.floor((col-1)/26)) s = String.fromCharCode(((col-1)%26) + 65) + s; return s; }\nfunction fix_col(cstr/*:string*/)/*:string*/ { return cstr.replace(/^([A-Z])/,\"$$$1\"); }\nfunction unfix_col(cstr/*:string*/)/*:string*/ { return cstr.replace(/^\\$([A-Z])/,\"$1\"); }\n\nfunction split_cell(cstr/*:string*/)/*:Array<string>*/ { return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/,\"$1,$2\").split(\",\"); }\n//function decode_cell(cstr/*:string*/)/*:CellAddress*/ { var splt = split_cell(cstr); return { c:decode_col(splt[0]), r:decode_row(splt[1]) }; }\nfunction decode_cell(cstr/*:string*/)/*:CellAddress*/ {\n\tvar R = 0, C = 0;\n\tfor(var i = 0; i < cstr.length; ++i) {\n\t\tvar cc = cstr.charCodeAt(i);\n\t\tif(cc >= 48 && cc <= 57) R = 10 * R + (cc - 48);\n\t\telse if(cc >= 65 && cc <= 90) C = 26 * C + (cc - 64);\n\t}\n\treturn { c: C - 1, r:R - 1 };\n}\n//function encode_cell(cell/*:CellAddress*/)/*:string*/ { return encode_col(cell.c) + encode_row(cell.r); }\nfunction encode_cell(cell/*:CellAddress*/)/*:string*/ {\n\tvar col = cell.c + 1;\n\tvar s=\"\";\n\tfor(; col; col=((col-1)/26)|0) s = String.fromCharCode(((col-1)%26) + 65) + s;\n\treturn s + (cell.r + 1);\n}\nfunction decode_range(range/*:string*/)/*:Range*/ {\n\tvar idx = range.indexOf(\":\");\n\tif(idx == -1) return { s: decode_cell(range), e: decode_cell(range) };\n\treturn { s: decode_cell(range.slice(0, idx)), e: decode_cell(range.slice(idx + 1)) };\n}\n/*# if only one arg, it is assumed to be a Range.  If 2 args, both are cell addresses */\nfunction encode_range(cs/*:CellAddrSpec|Range*/,ce/*:?CellAddrSpec*/)/*:string*/ {\n\tif(typeof ce === 'undefined' || typeof ce === 'number') {\n/*:: if(!(cs instanceof Range)) throw \"unreachable\"; */\n\t\treturn encode_range(cs.s, cs.e);\n\t}\n/*:: if((cs instanceof Range)) throw \"unreachable\"; */\n\tif(typeof cs !== 'string') cs = encode_cell((cs/*:any*/));\n\tif(typeof ce !== 'string') ce = encode_cell((ce/*:any*/));\n/*:: if(typeof cs !== 'string') throw \"unreachable\"; */\n/*:: if(typeof ce !== 'string') throw \"unreachable\"; */\n\treturn cs == ce ? cs : cs + \":\" + ce;\n}\n\nfunction safe_decode_range(range/*:string*/)/*:Range*/ {\n\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\tvar idx = 0, i = 0, cc = 0;\n\tvar len = range.length;\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.s.c = --idx;\n\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.s.r = --idx;\n\n\tif(i === len || cc != 10) { o.e.c=o.s.c; o.e.r=o.s.r; return o; }\n\t++i;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.e.c = --idx;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.e.r = --idx;\n\treturn o;\n}\n\nfunction safe_format_cell(cell/*:Cell*/, v/*:any*/) {\n\tvar q = (cell.t == 'd' && v instanceof Date);\n\tif(cell.z != null) try { return (cell.w = SSF_format(cell.z, q ? datenum(v) : v)); } catch(e) { }\n\ttry { return (cell.w = SSF_format((cell.XF||{}).numFmtId||(q ? 14 : 0),  q ? datenum(v) : v)); } catch(e) { return ''+v; }\n}\n\nfunction format_cell(cell/*:Cell*/, v/*:any*/, o/*:any*/) {\n\tif(cell == null || cell.t == null || cell.t == 'z') return \"\";\n\tif(cell.w !== undefined) return cell.w;\n\tif(cell.t == 'd' && !cell.z && o && o.dateNF) cell.z = o.dateNF;\n\tif(cell.t == \"e\") return BErr[cell.v] || cell.v;\n\tif(v == undefined) return safe_format_cell(cell, cell.v);\n\treturn safe_format_cell(cell, v);\n}\n\nfunction sheet_to_workbook(sheet/*:Worksheet*/, opts)/*:Workbook*/ {\n\tvar n = opts && opts.sheet ? opts.sheet : \"Sheet1\";\n\tvar sheets = {}; sheets[n] = sheet;\n\treturn { SheetNames: [n], Sheets: sheets };\n}\n\nfunction sheet_add_aoa(_ws/*:?Worksheet*/, data/*:AOA*/, opts/*:?any*/)/*:Worksheet*/ {\n\tvar o = opts || {};\n\tvar dense = _ws ? Array.isArray(_ws) : o.dense;\n\tif(DENSE != null && dense == null) dense = DENSE;\n\tvar ws/*:Worksheet*/ = _ws || (dense ? ([]/*:any*/) : ({}/*:any*/));\n\tvar _R = 0, _C = 0;\n\tif(ws && o.origin != null) {\n\t\tif(typeof o.origin == 'number') _R = o.origin;\n\t\telse {\n\t\t\tvar _origin/*:CellAddress*/ = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r; _C = _origin.c;\n\t\t}\n\t\tif(!ws[\"!ref\"]) ws[\"!ref\"] = \"A1:A1\";\n\t}\n\tvar range/*:Range*/ = ({s: {c:10000000, r:10000000}, e: {c:0, r:0}}/*:any*/);\n\tif(ws['!ref']) {\n\t\tvar _range = safe_decode_range(ws['!ref']);\n\t\trange.s.c = _range.s.c;\n\t\trange.s.r = _range.s.r;\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif(_R == -1) range.e.r = _R = _range.e.r + 1;\n\t}\n\tfor(var R = 0; R != data.length; ++R) {\n\t\tif(!data[R]) continue;\n\t\tif(!Array.isArray(data[R])) throw new Error(\"aoa_to_sheet expects an array of arrays\");\n\t\tfor(var C = 0; C != data[R].length; ++C) {\n\t\t\tif(typeof data[R][C] === 'undefined') continue;\n\t\t\tvar cell/*:Cell*/ = ({v: data[R][C] }/*:any*/);\n\t\t\tvar __R = _R + R, __C = _C + C;\n\t\t\tif(range.s.r > __R) range.s.r = __R;\n\t\t\tif(range.s.c > __C) range.s.c = __C;\n\t\t\tif(range.e.r < __R) range.e.r = __R;\n\t\t\tif(range.e.c < __C) range.e.c = __C;\n\t\t\tif(data[R][C] && typeof data[R][C] === 'object' && !Array.isArray(data[R][C]) && !(data[R][C] instanceof Date)) cell = data[R][C];\n\t\t\telse {\n\t\t\t\tif(Array.isArray(cell.v)) { cell.f = data[R][C][1]; cell.v = cell.v[0]; }\n\t\t\t\tif(cell.v === null) {\n\t\t\t\t\tif(cell.f) cell.t = 'n';\n\t\t\t\t\telse if(o.nullError) { cell.t = 'e'; cell.v = 0; }\n\t\t\t\t\telse if(!o.sheetStubs) continue;\n\t\t\t\t\telse cell.t = 'z';\n\t\t\t\t}\n\t\t\t\telse if(typeof cell.v === 'number') cell.t = 'n';\n\t\t\t\telse if(typeof cell.v === 'boolean') cell.t = 'b';\n\t\t\t\telse if(cell.v instanceof Date) {\n\t\t\t\t\tcell.z = o.dateNF || table_fmt[14];\n\t\t\t\t\tif(o.cellDates) { cell.t = 'd'; cell.w = SSF_format(cell.z, datenum(cell.v)); }\n\t\t\t\t\telse { cell.t = 'n'; cell.v = datenum(cell.v); cell.w = SSF_format(cell.z, cell.v); }\n\t\t\t\t}\n\t\t\t\telse cell.t = 's';\n\t\t\t}\n\t\t\tif(dense) {\n\t\t\t\tif(!ws[__R]) ws[__R] = [];\n\t\t\t\tif(ws[__R][__C] && ws[__R][__C].z) cell.z = ws[__R][__C].z;\n\t\t\t\tws[__R][__C] = cell;\n\t\t\t} else {\n\t\t\t\tvar cell_ref = encode_cell(({c:__C,r:__R}/*:any*/));\n\t\t\t\tif(ws[cell_ref] && ws[cell_ref].z) cell.z = ws[cell_ref].z;\n\t\t\t\tws[cell_ref] = cell;\n\t\t\t}\n\t\t}\n\t}\n\tif(range.s.c < 10000000) ws['!ref'] = encode_range(range);\n\treturn ws;\n}\nfunction aoa_to_sheet(data/*:AOA*/, opts/*:?any*/)/*:Worksheet*/ { return sheet_add_aoa(null, data, opts); }\n\nfunction parse_Int32LE(data) {\n\treturn data.read_shift(4, 'i');\n}\nfunction write_UInt32LE(x/*:number*/, o) {\n\tif (!o) o = new_buf(4);\n\to.write_shift(4, x);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.168 */\nfunction parse_XLWideString(data/*::, length*/)/*:string*/ {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLWideString(data/*:string*/, o) {\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(4 + 2 * data.length); }\n\to.write_shift(4, data.length);\n\tif (data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.91 */\n//function parse_LPWideString(data/*::, length*/)/*:string*/ {\n//\tvar cchCharacters = data.read_shift(2);\n//\treturn cchCharacters === 0 ? \"\" : data.read_shift(cchCharacters, \"utf16le\");\n//}\n\n/* [MS-XLSB] 2.5.143 */\nfunction parse_StrRun(data) {\n\treturn { ich: data.read_shift(2), ifnt: data.read_shift(2) };\n}\nfunction write_StrRun(run, o) {\n\tif (!o) o = new_buf(4);\n\to.write_shift(2, run.ich || 0);\n\to.write_shift(2, run.ifnt || 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.121 */\nfunction parse_RichStr(data, length/*:number*/)/*:XLString*/ {\n\tvar start = data.l;\n\tvar flags = data.read_shift(1);\n\tvar str = parse_XLWideString(data);\n\tvar rgsStrRun = [];\n\tvar z = ({ t: str, h: str }/*:any*/);\n\tif ((flags & 1) !== 0) { /* fRichStr */\n\t\t/* TODO: formatted string */\n\t\tvar dwSizeStrRun = data.read_shift(4);\n\t\tfor (var i = 0; i != dwSizeStrRun; ++i) rgsStrRun.push(parse_StrRun(data));\n\t\tz.r = rgsStrRun;\n\t}\n\telse z.r = [{ ich: 0, ifnt: 0 }];\n\t//if((flags & 2) !== 0) { /* fExtStr */\n\t//\t/* TODO: phonetic string */\n\t//}\n\tdata.l = start + length;\n\treturn z;\n}\nfunction write_RichStr(str/*:XLString*/, o/*:?Block*/)/*:Block*/ {\n\t/* TODO: formatted string */\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(15 + 4 * str.t.length); }\n\to.write_shift(1, 0);\n\twrite_XLWideString(str.t, o);\n\treturn _null ? o.slice(0, o.l) : o;\n}\n/* [MS-XLSB] 2.4.328 BrtCommentText (RichStr w/1 run) */\nvar parse_BrtCommentText = parse_RichStr;\nfunction write_BrtCommentText(str/*:XLString*/, o/*:?Block*/)/*:Block*/ {\n\t/* TODO: formatted string */\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(23 + 4 * str.t.length); }\n\to.write_shift(1, 1);\n\twrite_XLWideString(str.t, o);\n\to.write_shift(4, 1);\n\twrite_StrRun({ ich: 0, ifnt: 0 }, o);\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.9 */\nfunction parse_XLSBCell(data)/*:any*/ {\n\tvar col = data.read_shift(4);\n\tvar iStyleRef = data.read_shift(2);\n\tiStyleRef += data.read_shift(1) << 16;\n\tdata.l++; //var fPhShow = data.read_shift(1);\n\treturn { c: col, iStyleRef: iStyleRef };\n}\nfunction write_XLSBCell(cell/*:any*/, o/*:?Block*/) {\n\tif (o == null) o = new_buf(8);\n\to.write_shift(-4, cell.c);\n\to.write_shift(3, cell.iStyleRef || cell.s);\n\to.write_shift(1, 0); /* fPhShow */\n\treturn o;\n}\n\n/* Short XLSB Cell does not include column */\nfunction parse_XLSBShortCell(data)/*:any*/ {\n\tvar iStyleRef = data.read_shift(2);\n\tiStyleRef += data.read_shift(1) <<16;\n\tdata.l++; //var fPhShow = data.read_shift(1);\n\treturn { c:-1, iStyleRef: iStyleRef };\n}\nfunction write_XLSBShortCell(cell/*:any*/, o/*:?Block*/) {\n\tif(o == null) o = new_buf(4);\n\to.write_shift(3, cell.iStyleRef || cell.s);\n\to.write_shift(1, 0); /* fPhShow */\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.21 */\nvar parse_XLSBCodeName = parse_XLWideString;\nvar write_XLSBCodeName = write_XLWideString;\n\n/* [MS-XLSB] 2.5.166 */\nfunction parse_XLNullableWideString(data/*::, length*/)/*:string*/ {\n\tvar cchCharacters = data.read_shift(4);\n\treturn cchCharacters === 0 || cchCharacters === 0xFFFFFFFF ? \"\" : data.read_shift(cchCharacters, 'dbcs');\n}\nfunction write_XLNullableWideString(data/*:string*/, o) {\n\tvar _null = false; if (o == null) { _null = true; o = new_buf(127); }\n\to.write_shift(4, data.length > 0 ? data.length : 0xFFFFFFFF);\n\tif (data.length > 0) o.write_shift(0, data, 'dbcs');\n\treturn _null ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.5.165 */\nvar parse_XLNameWideString = parse_XLWideString;\n//var write_XLNameWideString = write_XLWideString;\n\n/* [MS-XLSB] 2.5.114 */\nvar parse_RelID = parse_XLNullableWideString;\nvar write_RelID = write_XLNullableWideString;\n\n\n/* [MS-XLS] 2.5.217 ; [MS-XLSB] 2.5.122 */\nfunction parse_RkNumber(data)/*:number*/ {\n\tvar b = data.slice(data.l, data.l + 4);\n\tvar fX100 = (b[0] & 1), fInt = (b[0] & 2);\n\tdata.l += 4;\n\tvar RK = fInt === 0 ? __double([0, 0, 0, 0, (b[0] & 0xFC), b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n\treturn fX100 ? (RK / 100) : RK;\n}\nfunction write_RkNumber(data/*:number*/, o) {\n\tif (o == null) o = new_buf(4);\n\tvar fX100 = 0, fInt = 0, d100 = data * 100;\n\tif ((data == (data | 0)) && (data >= -(1 << 29)) && (data < (1 << 29))) { fInt = 1; }\n\telse if ((d100 == (d100 | 0)) && (d100 >= -(1 << 29)) && (d100 < (1 << 29))) { fInt = 1; fX100 = 1; }\n\tif (fInt) o.write_shift(-4, ((fX100 ? d100 : data) << 2) + (fX100 + 2));\n\telse throw new Error(\"unsupported RkNumber \" + data); // TODO\n}\n\n\n/* [MS-XLSB] 2.5.117 RfX */\nfunction parse_RfX(data /*::, length*/)/*:Range*/ {\n\tvar cell/*:Range*/ = ({ s: {}, e: {} }/*:any*/);\n\tcell.s.r = data.read_shift(4);\n\tcell.e.r = data.read_shift(4);\n\tcell.s.c = data.read_shift(4);\n\tcell.e.c = data.read_shift(4);\n\treturn cell;\n}\nfunction write_RfX(r/*:Range*/, o) {\n\tif (!o) o = new_buf(16);\n\to.write_shift(4, r.s.r);\n\to.write_shift(4, r.e.r);\n\to.write_shift(4, r.s.c);\n\to.write_shift(4, r.e.c);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.153 UncheckedRfX */\nvar parse_UncheckedRfX = parse_RfX;\nvar write_UncheckedRfX = write_RfX;\n\n/* [MS-XLSB] 2.5.155 UncheckedSqRfX */\n//function parse_UncheckedSqRfX(data) {\n//\tvar cnt = data.read_shift(4);\n//\tvar out = [];\n//\tfor(var i = 0; i < cnt; ++i) {\n//\t\tvar rng = parse_UncheckedRfX(data);\n//\t\tout.push(encode_range(rng));\n//\t}\n//\treturn out.join(\",\");\n//}\n//function write_UncheckedSqRfX(sqrfx/*:string*/) {\n//\tvar parts = sqrfx.split(/\\s*,\\s*/);\n//\tvar o = new_buf(4); o.write_shift(4, parts.length);\n//\tvar out = [o];\n//\tparts.forEach(function(rng) {\n//\t\tout.push(write_UncheckedRfX(safe_decode_range(rng)));\n//\t});\n//\treturn bconcat(out);\n//}\n\n/* [MS-XLS] 2.5.342 ; [MS-XLSB] 2.5.171 */\n/* TODO: error checking, NaN and Infinity values are not valid Xnum */\nfunction parse_Xnum(data/*::, length*/) {\n\tif(data.length - data.l < 8) throw \"XLS Xnum Buffer underflow\";\n\treturn data.read_shift(8, 'f');\n}\nfunction write_Xnum(data, o) { return (o || new_buf(8)).write_shift(8, data, 'f'); }\n\n/* [MS-XLSB] 2.4.324 BrtColor */\nfunction parse_BrtColor(data/*::, length*/) {\n\tvar out = {};\n\tvar d = data.read_shift(1);\n\n\t//var fValidRGB = d & 1;\n\tvar xColorType = d >>> 1;\n\n\tvar index = data.read_shift(1);\n\tvar nTS = data.read_shift(2, 'i');\n\tvar bR = data.read_shift(1);\n\tvar bG = data.read_shift(1);\n\tvar bB = data.read_shift(1);\n\tdata.l++; //var bAlpha = data.read_shift(1);\n\n\tswitch (xColorType) {\n\t\tcase 0: out.auto = 1; break;\n\t\tcase 1:\n\t\t\tout.index = index;\n\t\t\tvar icv = XLSIcv[index];\n\t\t\t/* automatic pseudo index 81 */\n\t\t\tif (icv) out.rgb = rgb2Hex(icv);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\t/* if(!fValidRGB) throw new Error(\"invalid\"); */\n\t\t\tout.rgb = rgb2Hex([bR, bG, bB]);\n\t\t\tbreak;\n\t\tcase 3: out.theme = index; break;\n\t}\n\tif (nTS != 0) out.tint = nTS > 0 ? nTS / 32767 : nTS / 32768;\n\n\treturn out;\n}\nfunction write_BrtColor(color, o) {\n\tif (!o) o = new_buf(8);\n\tif (!color || color.auto) { o.write_shift(4, 0); o.write_shift(4, 0); return o; }\n\tif (color.index != null) {\n\t\to.write_shift(1, 0x02);\n\t\to.write_shift(1, color.index);\n\t} else if (color.theme != null) {\n\t\to.write_shift(1, 0x06);\n\t\to.write_shift(1, color.theme);\n\t} else {\n\t\to.write_shift(1, 0x05);\n\t\to.write_shift(1, 0);\n\t}\n\tvar nTS = color.tint || 0;\n\tif (nTS > 0) nTS *= 32767;\n\telse if (nTS < 0) nTS *= 32768;\n\to.write_shift(2, nTS);\n\tif (!color.rgb || color.theme != null) {\n\t\to.write_shift(2, 0);\n\t\to.write_shift(1, 0);\n\t\to.write_shift(1, 0);\n\t} else {\n\t\tvar rgb = (color.rgb || 'FFFFFF');\n\t\tif (typeof rgb == 'number') rgb = (\"000000\" + rgb.toString(16)).slice(-6);\n\t\to.write_shift(1, parseInt(rgb.slice(0, 2), 16));\n\t\to.write_shift(1, parseInt(rgb.slice(2, 4), 16));\n\t\to.write_shift(1, parseInt(rgb.slice(4, 6), 16));\n\t\to.write_shift(1, 0xFF);\n\t}\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.52 */\nfunction parse_FontFlags(data/*::, length, opts*/) {\n\tvar d = data.read_shift(1);\n\tdata.l++;\n\tvar out = {\n\t\tfBold: d & 0x01,\n\t\tfItalic: d & 0x02,\n\t\tfUnderline: d & 0x04,\n\t\tfStrikeout: d & 0x08,\n\t\tfOutline: d & 0x10,\n\t\tfShadow: d & 0x20,\n\t\tfCondense: d & 0x40,\n\t\tfExtend: d & 0x80\n\t};\n\treturn out;\n}\nfunction write_FontFlags(font, o) {\n\tif (!o) o = new_buf(2);\n\tvar grbit =\n\t\t(font.italic ? 0x02 : 0) |\n\t\t(font.strike ? 0x08 : 0) |\n\t\t(font.outline ? 0x10 : 0) |\n\t\t(font.shadow ? 0x20 : 0) |\n\t\t(font.condense ? 0x40 : 0) |\n\t\t(font.extend ? 0x80 : 0);\n\to.write_shift(1, grbit);\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n/* [MS-OLEDS] 2.3.1 and 2.3.2 */\nfunction parse_ClipboardFormatOrString(o, w/*:number*/)/*:string*/ {\n\t// $FlowIgnore\n\tvar ClipFmt = { 2: \"BITMAP\", 3: \"METAFILEPICT\", 8: \"DIB\", 14: \"ENHMETAFILE\" };\n\tvar m/*:number*/ = o.read_shift(4);\n\tswitch (m) {\n\t\tcase 0x00000000: return \"\";\n\t\tcase 0xffffffff: case 0xfffffffe: return ClipFmt[o.read_shift(4)] || \"\";\n\t}\n\tif (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n\to.l -= 4;\n\treturn o.read_shift(0, w == 1 ? \"lpstr\" : \"lpwstr\");\n}\nfunction parse_ClipboardFormatOrAnsiString(o) { return parse_ClipboardFormatOrString(o, 1); }\nfunction parse_ClipboardFormatOrUnicodeString(o) { return parse_ClipboardFormatOrString(o, 2); }\n\n/* [MS-OLEPS] 2.2 PropertyType */\n// Note: some tree shakers cannot handle VT_VECTOR | $CONST, hence extra vars\n//var VT_EMPTY    = 0x0000;\n//var VT_NULL     = 0x0001;\nvar VT_I2       = 0x0002;\nvar VT_I4       = 0x0003;\n//var VT_R4       = 0x0004;\n//var VT_R8       = 0x0005;\n//var VT_CY       = 0x0006;\n//var VT_DATE     = 0x0007;\n//var VT_BSTR     = 0x0008;\n//var VT_ERROR    = 0x000A;\nvar VT_BOOL     = 0x000B;\nvar VT_VARIANT  = 0x000C;\n//var VT_DECIMAL  = 0x000E;\n//var VT_I1       = 0x0010;\n//var VT_UI1      = 0x0011;\n//var VT_UI2      = 0x0012;\nvar VT_UI4      = 0x0013;\n//var VT_I8       = 0x0014;\n//var VT_UI8      = 0x0015;\n//var VT_INT      = 0x0016;\n//var VT_UINT     = 0x0017;\nvar VT_LPSTR    = 0x001E;\n//var VT_LPWSTR   = 0x001F;\nvar VT_FILETIME = 0x0040;\nvar VT_BLOB     = 0x0041;\n//var VT_STREAM   = 0x0042;\n//var VT_STORAGE  = 0x0043;\n//var VT_STREAMED_Object  = 0x0044;\n//var VT_STORED_Object    = 0x0045;\n//var VT_BLOB_Object      = 0x0046;\nvar VT_CF       = 0x0047;\n//var VT_CLSID    = 0x0048;\n//var VT_VERSIONED_STREAM = 0x0049;\nvar VT_VECTOR   = 0x1000;\nvar VT_VECTOR_VARIANT = 0x100C;\nvar VT_VECTOR_LPSTR   = 0x101E;\n//var VT_ARRAY    = 0x2000;\n\nvar VT_STRING   = 0x0050; // 2.3.3.1.11 VtString\nvar VT_USTR     = 0x0051; // 2.3.3.1.12 VtUnalignedString\nvar VT_CUSTOM   = [VT_STRING, VT_USTR];\n\n/* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\nvar DocSummaryPIDDSI = {\n\t/*::[*/0x01/*::]*/: { n: 'CodePage', t: VT_I2 },\n\t/*::[*/0x02/*::]*/: { n: 'Category', t: VT_STRING },\n\t/*::[*/0x03/*::]*/: { n: 'PresentationFormat', t: VT_STRING },\n\t/*::[*/0x04/*::]*/: { n: 'ByteCount', t: VT_I4 },\n\t/*::[*/0x05/*::]*/: { n: 'LineCount', t: VT_I4 },\n\t/*::[*/0x06/*::]*/: { n: 'ParagraphCount', t: VT_I4 },\n\t/*::[*/0x07/*::]*/: { n: 'SlideCount', t: VT_I4 },\n\t/*::[*/0x08/*::]*/: { n: 'NoteCount', t: VT_I4 },\n\t/*::[*/0x09/*::]*/: { n: 'HiddenCount', t: VT_I4 },\n\t/*::[*/0x0a/*::]*/: { n: 'MultimediaClipCount', t: VT_I4 },\n\t/*::[*/0x0b/*::]*/: { n: 'ScaleCrop', t: VT_BOOL },\n\t/*::[*/0x0c/*::]*/: { n: 'HeadingPairs', t: VT_VECTOR_VARIANT /* VT_VECTOR | VT_VARIANT */ },\n\t/*::[*/0x0d/*::]*/: { n: 'TitlesOfParts', t: VT_VECTOR_LPSTR /* VT_VECTOR | VT_LPSTR */ },\n\t/*::[*/0x0e/*::]*/: { n: 'Manager', t: VT_STRING },\n\t/*::[*/0x0f/*::]*/: { n: 'Company', t: VT_STRING },\n\t/*::[*/0x10/*::]*/: { n: 'LinksUpToDate', t: VT_BOOL },\n\t/*::[*/0x11/*::]*/: { n: 'CharacterCount', t: VT_I4 },\n\t/*::[*/0x13/*::]*/: { n: 'SharedDoc', t: VT_BOOL },\n\t/*::[*/0x16/*::]*/: { n: 'HyperlinksChanged', t: VT_BOOL },\n\t/*::[*/0x17/*::]*/: { n: 'AppVersion', t: VT_I4, p: 'version' },\n\t/*::[*/0x18/*::]*/: { n: 'DigSig', t: VT_BLOB },\n\t/*::[*/0x1A/*::]*/: { n: 'ContentType', t: VT_STRING },\n\t/*::[*/0x1B/*::]*/: { n: 'ContentStatus', t: VT_STRING },\n\t/*::[*/0x1C/*::]*/: { n: 'Language', t: VT_STRING },\n\t/*::[*/0x1D/*::]*/: { n: 'Version', t: VT_STRING },\n\t/*::[*/0xFF/*::]*/: {},\n\t/* [MS-OLEPS] 2.18 */\n\t/*::[*/0x80000000/*::]*/: { n: 'Locale', t: VT_UI4 },\n\t/*::[*/0x80000003/*::]*/: { n: 'Behavior', t: VT_UI4 },\n\t/*::[*/0x72627262/*::]*/: {}\n};\n\n/* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\nvar SummaryPIDSI = {\n\t/*::[*/0x01/*::]*/: { n: 'CodePage', t: VT_I2 },\n\t/*::[*/0x02/*::]*/: { n: 'Title', t: VT_STRING },\n\t/*::[*/0x03/*::]*/: { n: 'Subject', t: VT_STRING },\n\t/*::[*/0x04/*::]*/: { n: 'Author', t: VT_STRING },\n\t/*::[*/0x05/*::]*/: { n: 'Keywords', t: VT_STRING },\n\t/*::[*/0x06/*::]*/: { n: 'Comments', t: VT_STRING },\n\t/*::[*/0x07/*::]*/: { n: 'Template', t: VT_STRING },\n\t/*::[*/0x08/*::]*/: { n: 'LastAuthor', t: VT_STRING },\n\t/*::[*/0x09/*::]*/: { n: 'RevNumber', t: VT_STRING },\n\t/*::[*/0x0A/*::]*/: { n: 'EditTime', t: VT_FILETIME },\n\t/*::[*/0x0B/*::]*/: { n: 'LastPrinted', t: VT_FILETIME },\n\t/*::[*/0x0C/*::]*/: { n: 'CreatedDate', t: VT_FILETIME },\n\t/*::[*/0x0D/*::]*/: { n: 'ModifiedDate', t: VT_FILETIME },\n\t/*::[*/0x0E/*::]*/: { n: 'PageCount', t: VT_I4 },\n\t/*::[*/0x0F/*::]*/: { n: 'WordCount', t: VT_I4 },\n\t/*::[*/0x10/*::]*/: { n: 'CharCount', t: VT_I4 },\n\t/*::[*/0x11/*::]*/: { n: 'Thumbnail', t: VT_CF },\n\t/*::[*/0x12/*::]*/: { n: 'Application', t: VT_STRING },\n\t/*::[*/0x13/*::]*/: { n: 'DocSecurity', t: VT_I4 },\n\t/*::[*/0xFF/*::]*/: {},\n\t/* [MS-OLEPS] 2.18 */\n\t/*::[*/0x80000000/*::]*/: { n: 'Locale', t: VT_UI4 },\n\t/*::[*/0x80000003/*::]*/: { n: 'Behavior', t: VT_UI4 },\n\t/*::[*/0x72627262/*::]*/: {}\n};\n\n/* [MS-XLS] 2.4.63 Country/Region codes */\nvar CountryEnum = {\n\t/*::[*/0x0001/*::]*/: \"US\", // United States\n\t/*::[*/0x0002/*::]*/: \"CA\", // Canada\n\t/*::[*/0x0003/*::]*/: \"\", // Latin America (except Brazil)\n\t/*::[*/0x0007/*::]*/: \"RU\", // Russia\n\t/*::[*/0x0014/*::]*/: \"EG\", // Egypt\n\t/*::[*/0x001E/*::]*/: \"GR\", // Greece\n\t/*::[*/0x001F/*::]*/: \"NL\", // Netherlands\n\t/*::[*/0x0020/*::]*/: \"BE\", // Belgium\n\t/*::[*/0x0021/*::]*/: \"FR\", // France\n\t/*::[*/0x0022/*::]*/: \"ES\", // Spain\n\t/*::[*/0x0024/*::]*/: \"HU\", // Hungary\n\t/*::[*/0x0027/*::]*/: \"IT\", // Italy\n\t/*::[*/0x0029/*::]*/: \"CH\", // Switzerland\n\t/*::[*/0x002B/*::]*/: \"AT\", // Austria\n\t/*::[*/0x002C/*::]*/: \"GB\", // United Kingdom\n\t/*::[*/0x002D/*::]*/: \"DK\", // Denmark\n\t/*::[*/0x002E/*::]*/: \"SE\", // Sweden\n\t/*::[*/0x002F/*::]*/: \"NO\", // Norway\n\t/*::[*/0x0030/*::]*/: \"PL\", // Poland\n\t/*::[*/0x0031/*::]*/: \"DE\", // Germany\n\t/*::[*/0x0034/*::]*/: \"MX\", // Mexico\n\t/*::[*/0x0037/*::]*/: \"BR\", // Brazil\n\t/*::[*/0x003d/*::]*/: \"AU\", // Australia\n\t/*::[*/0x0040/*::]*/: \"NZ\", // New Zealand\n\t/*::[*/0x0042/*::]*/: \"TH\", // Thailand\n\t/*::[*/0x0051/*::]*/: \"JP\", // Japan\n\t/*::[*/0x0052/*::]*/: \"KR\", // Korea\n\t/*::[*/0x0054/*::]*/: \"VN\", // Viet Nam\n\t/*::[*/0x0056/*::]*/: \"CN\", // China\n\t/*::[*/0x005A/*::]*/: \"TR\", // Turkey\n\t/*::[*/0x0069/*::]*/: \"JS\", // Ramastan\n\t/*::[*/0x00D5/*::]*/: \"DZ\", // Algeria\n\t/*::[*/0x00D8/*::]*/: \"MA\", // Morocco\n\t/*::[*/0x00DA/*::]*/: \"LY\", // Libya\n\t/*::[*/0x015F/*::]*/: \"PT\", // Portugal\n\t/*::[*/0x0162/*::]*/: \"IS\", // Iceland\n\t/*::[*/0x0166/*::]*/: \"FI\", // Finland\n\t/*::[*/0x01A4/*::]*/: \"CZ\", // Czech Republic\n\t/*::[*/0x0376/*::]*/: \"TW\", // Taiwan\n\t/*::[*/0x03C1/*::]*/: \"LB\", // Lebanon\n\t/*::[*/0x03C2/*::]*/: \"JO\", // Jordan\n\t/*::[*/0x03C3/*::]*/: \"SY\", // Syria\n\t/*::[*/0x03C4/*::]*/: \"IQ\", // Iraq\n\t/*::[*/0x03C5/*::]*/: \"KW\", // Kuwait\n\t/*::[*/0x03C6/*::]*/: \"SA\", // Saudi Arabia\n\t/*::[*/0x03CB/*::]*/: \"AE\", // United Arab Emirates\n\t/*::[*/0x03CC/*::]*/: \"IL\", // Israel\n\t/*::[*/0x03CE/*::]*/: \"QA\", // Qatar\n\t/*::[*/0x03D5/*::]*/: \"IR\", // Iran\n\t/*::[*/0xFFFF/*::]*/: \"US\"  // United States\n};\n\n/* [MS-XLS] 2.5.127 */\nvar XLSFillPattern = [\n\tnull,\n\t'solid',\n\t'mediumGray',\n\t'darkGray',\n\t'lightGray',\n\t'darkHorizontal',\n\t'darkVertical',\n\t'darkDown',\n\t'darkUp',\n\t'darkGrid',\n\t'darkTrellis',\n\t'lightHorizontal',\n\t'lightVertical',\n\t'lightDown',\n\t'lightUp',\n\t'lightGrid',\n\t'lightTrellis',\n\t'gray125',\n\t'gray0625'\n];\n\nfunction rgbify(arr/*:Array<number>*/)/*:Array<[number, number, number]>*/ { return arr.map(function(x) { return [(x>>16)&255,(x>>8)&255,x&255]; }); }\n\n/* [MS-XLS] 2.5.161 */\n/* [MS-XLSB] 2.5.75 Icv */\nvar _XLSIcv = /*#__PURE__*/ rgbify([\n\t/* Color Constants */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t/* Overridable Defaults */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t0x800000,\n\t0x008000,\n\t0x000080,\n\t0x808000,\n\t0x800080,\n\t0x008080,\n\t0xC0C0C0,\n\t0x808080,\n\t0x9999FF,\n\t0x993366,\n\t0xFFFFCC,\n\t0xCCFFFF,\n\t0x660066,\n\t0xFF8080,\n\t0x0066CC,\n\t0xCCCCFF,\n\n\t0x000080,\n\t0xFF00FF,\n\t0xFFFF00,\n\t0x00FFFF,\n\t0x800080,\n\t0x800000,\n\t0x008080,\n\t0x0000FF,\n\t0x00CCFF,\n\t0xCCFFFF,\n\t0xCCFFCC,\n\t0xFFFF99,\n\t0x99CCFF,\n\t0xFF99CC,\n\t0xCC99FF,\n\t0xFFCC99,\n\n\t0x3366FF,\n\t0x33CCCC,\n\t0x99CC00,\n\t0xFFCC00,\n\t0xFF9900,\n\t0xFF6600,\n\t0x666699,\n\t0x969696,\n\t0x003366,\n\t0x339966,\n\t0x003300,\n\t0x333300,\n\t0x993300,\n\t0x993366,\n\t0x333399,\n\t0x333333,\n\n\t/* Other entries to appease BIFF8/12 */\n\t0xFFFFFF, /* 0x40 icvForeground ?? */\n\t0x000000, /* 0x41 icvBackground ?? */\n\t0x000000, /* 0x42 icvFrame ?? */\n\t0x000000, /* 0x43 icv3D ?? */\n\t0x000000, /* 0x44 icv3DText ?? */\n\t0x000000, /* 0x45 icv3DHilite ?? */\n\t0x000000, /* 0x46 icv3DShadow ?? */\n\t0x000000, /* 0x47 icvHilite ?? */\n\t0x000000, /* 0x48 icvCtlText ?? */\n\t0x000000, /* 0x49 icvCtlScrl ?? */\n\t0x000000, /* 0x4A icvCtlInv ?? */\n\t0x000000, /* 0x4B icvCtlBody ?? */\n\t0x000000, /* 0x4C icvCtlFrame ?? */\n\t0x000000, /* 0x4D icvCtlFore ?? */\n\t0x000000, /* 0x4E icvCtlBack ?? */\n\t0x000000, /* 0x4F icvCtlNeutral */\n\t0x000000, /* 0x50 icvInfoBk ?? */\n\t0x000000 /* 0x51 icvInfoText ?? */\n]);\nvar XLSIcv = /*#__PURE__*/dup(_XLSIcv);\n\n/* [MS-XLSB] 2.5.97.2 */\nvar BErr = {\n\t/*::[*/0x00/*::]*/: \"#NULL!\",\n\t/*::[*/0x07/*::]*/: \"#DIV/0!\",\n\t/*::[*/0x0F/*::]*/: \"#VALUE!\",\n\t/*::[*/0x17/*::]*/: \"#REF!\",\n\t/*::[*/0x1D/*::]*/: \"#NAME?\",\n\t/*::[*/0x24/*::]*/: \"#NUM!\",\n\t/*::[*/0x2A/*::]*/: \"#N/A\",\n\t/*::[*/0x2B/*::]*/: \"#GETTING_DATA\",\n\t/*::[*/0xFF/*::]*/: \"#WTF?\"\n};\n//var RBErr = evert_num(BErr);\nvar RBErr = {\n\t\"#NULL!\":        0x00,\n\t\"#DIV/0!\":       0x07,\n\t\"#VALUE!\":       0x0F,\n\t\"#REF!\":         0x17,\n\t\"#NAME?\":        0x1D,\n\t\"#NUM!\":         0x24,\n\t\"#N/A\":          0x2A,\n\t\"#GETTING_DATA\": 0x2B,\n\t\"#WTF?\":         0xFF\n};\n\n/* Parts enumerated in OPC spec, MS-XLSB and MS-XLSX */\n/* 12.3 Part Summary <SpreadsheetML> */\n/* 14.2 Part Summary <DrawingML> */\n/* [MS-XLSX] 2.1 Part Enumerations ; [MS-XLSB] 2.1.7 Part Enumeration */\nvar ct2type/*{[string]:string}*/ = ({\n\t/* Workbook */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.ms-excel.sheet.binary.macroEnabled.main\": \"workbooks\",\n\t\"application/vnd.ms-excel.addin.macroEnabled.main+xml\": \"workbooks\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\": \"workbooks\",\n\n\t/* Worksheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\": \"sheets\",\n\t\"application/vnd.ms-excel.worksheet\": \"sheets\",\n\t\"application/vnd.ms-excel.binIndexWs\": \"TODO\", /* Binary Index */\n\n\t/* Chartsheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\": \"charts\",\n\t\"application/vnd.ms-excel.chartsheet\": \"charts\",\n\n\t/* Macrosheet */\n\t\"application/vnd.ms-excel.macrosheet+xml\": \"macros\",\n\t\"application/vnd.ms-excel.macrosheet\": \"macros\",\n\t\"application/vnd.ms-excel.intlmacrosheet\": \"TODO\",\n\t\"application/vnd.ms-excel.binIndexMs\": \"TODO\", /* Binary Index */\n\n\t/* Dialogsheet */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\": \"dialogs\",\n\t\"application/vnd.ms-excel.dialogsheet\": \"dialogs\",\n\n\t/* Shared Strings */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\": \"strs\",\n\t\"application/vnd.ms-excel.sharedStrings\": \"strs\",\n\n\t/* Styles */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\": \"styles\",\n\t\"application/vnd.ms-excel.styles\": \"styles\",\n\n\t/* File Properties */\n\t\"application/vnd.openxmlformats-package.core-properties+xml\": \"coreprops\",\n\t\"application/vnd.openxmlformats-officedocument.custom-properties+xml\": \"custprops\",\n\t\"application/vnd.openxmlformats-officedocument.extended-properties+xml\": \"extprops\",\n\n\t/* Custom Data Properties */\n\t\"application/vnd.openxmlformats-officedocument.customXmlProperties+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty\": \"TODO\",\n\n\t/* Comments */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\": \"comments\",\n\t\"application/vnd.ms-excel.comments\": \"comments\",\n\t\"application/vnd.ms-excel.threadedcomments+xml\": \"threadedcomments\",\n\t\"application/vnd.ms-excel.person+xml\": \"people\",\n\n\t/* Metadata (Stock/Geography and Dynamic Array) */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\": \"metadata\",\n\t\"application/vnd.ms-excel.sheetMetadata\": \"metadata\",\n\n\t/* PivotTable */\n\t\"application/vnd.ms-excel.pivotTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml\": \"TODO\",\n\n\t/* Chart Objects */\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\": \"TODO\",\n\n\t/* Chart Colors */\n\t\"application/vnd.ms-office.chartcolorstyle+xml\": \"TODO\",\n\n\t/* Chart Style */\n\t\"application/vnd.ms-office.chartstyle+xml\": \"TODO\",\n\n\t/* Chart Advanced */\n\t\"application/vnd.ms-office.chartex+xml\": \"TODO\",\n\n\t/* Calculation Chain */\n\t\"application/vnd.ms-excel.calcChain\": \"calcchains\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml\": \"calcchains\",\n\n\t/* Printer Settings */\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings\": \"TODO\",\n\n\t/* ActiveX */\n\t\"application/vnd.ms-office.activeX\": \"TODO\",\n\t\"application/vnd.ms-office.activeX+xml\": \"TODO\",\n\n\t/* Custom Toolbars */\n\t\"application/vnd.ms-excel.attachedToolbars\": \"TODO\",\n\n\t/* External Data Connections */\n\t\"application/vnd.ms-excel.connections\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml\": \"TODO\",\n\n\t/* External Links */\n\t\"application/vnd.ms-excel.externalLink\": \"links\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml\": \"links\",\n\n\t/* PivotCache */\n\t\"application/vnd.ms-excel.pivotCacheDefinition\": \"TODO\",\n\t\"application/vnd.ms-excel.pivotCacheRecords\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml\": \"TODO\",\n\n\t/* Query Table */\n\t\"application/vnd.ms-excel.queryTable\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml\": \"TODO\",\n\n\t/* Shared Workbook */\n\t\"application/vnd.ms-excel.userNames\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionHeaders\": \"TODO\",\n\t\"application/vnd.ms-excel.revisionLog\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml\": \"TODO\",\n\n\t/* Single Cell Table */\n\t\"application/vnd.ms-excel.tableSingleCells\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml\": \"TODO\",\n\n\t/* Slicer */\n\t\"application/vnd.ms-excel.slicer\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache\": \"TODO\",\n\t\"application/vnd.ms-excel.slicer+xml\": \"TODO\",\n\t\"application/vnd.ms-excel.slicerCache+xml\": \"TODO\",\n\n\t/* Sort Map */\n\t\"application/vnd.ms-excel.wsSortMap\": \"TODO\",\n\n\t/* Table */\n\t\"application/vnd.ms-excel.table\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\": \"TODO\",\n\n\t/* Themes */\n\t\"application/vnd.openxmlformats-officedocument.theme+xml\": \"themes\",\n\n\t/* Theme Override */\n\t\"application/vnd.openxmlformats-officedocument.themeOverride+xml\": \"TODO\",\n\n\t/* Timeline */\n\t\"application/vnd.ms-excel.Timeline+xml\": \"TODO\", /* verify */\n\t\"application/vnd.ms-excel.TimelineCache+xml\": \"TODO\", /* verify */\n\n\t/* VBA */\n\t\"application/vnd.ms-office.vbaProject\": \"vba\",\n\t\"application/vnd.ms-office.vbaProjectSignature\": \"TODO\",\n\n\t/* Volatile Dependencies */\n\t\"application/vnd.ms-office.volatileDependencies\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml\": \"TODO\",\n\n\t/* Control Properties */\n\t\"application/vnd.ms-excel.controlproperties+xml\": \"TODO\",\n\n\t/* Data Model */\n\t\"application/vnd.openxmlformats-officedocument.model+data\": \"TODO\",\n\n\t/* Survey */\n\t\"application/vnd.ms-excel.Survey+xml\": \"TODO\",\n\n\t/* Drawing */\n\t\"application/vnd.openxmlformats-officedocument.drawing+xml\": \"drawings\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml\": \"TODO\",\n\t\"application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml\": \"TODO\",\n\n\t/* VML */\n\t\"application/vnd.openxmlformats-officedocument.vmlDrawing\": \"TODO\",\n\n\t\"application/vnd.openxmlformats-package.relationships+xml\": \"rels\",\n\t\"application/vnd.openxmlformats-officedocument.oleObject\": \"TODO\",\n\n\t/* Image */\n\t\"image/png\": \"TODO\",\n\n\t\"sheet\": \"js\"\n}/*:any*/);\n\nvar CT_LIST = {\n\t\tworkbooks: {\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\",\n\t\t\txlsm: \"application/vnd.ms-excel.sheet.macroEnabled.main+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.sheet.binary.macroEnabled.main\",\n\t\t\txlam: \"application/vnd.ms-excel.addin.macroEnabled.main+xml\",\n\t\t\txltx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml\"\n\t\t},\n\t\tstrs: { /* Shared Strings */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.sharedStrings\"\n\t\t},\n\t\tcomments: { /* Comments */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.comments\"\n\t\t},\n\t\tsheets: { /* Worksheet */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.worksheet\"\n\t\t},\n\t\tcharts: { /* Chartsheet */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.chartsheet\"\n\t\t},\n\t\tdialogs: { /* Dialogsheet */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.dialogsheet\"\n\t\t},\n\t\tmacros: { /* Macrosheet (Excel 4.0 Macros) */\n\t\t\txlsx: \"application/vnd.ms-excel.macrosheet+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.macrosheet\"\n\t\t},\n\t\tmetadata: { /* Metadata (Stock/Geography and Dynamic Array) */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.sheetMetadata\"\n\t\t},\n\t\tstyles: { /* Styles */\n\t\t\txlsx: \"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\",\n\t\t\txlsb: \"application/vnd.ms-excel.styles\"\n\t\t}\n};\n\nfunction new_ct()/*:any*/ {\n\treturn ({\n\t\tworkbooks:[], sheets:[], charts:[], dialogs:[], macros:[],\n\t\trels:[], strs:[], comments:[], threadedcomments:[], links:[],\n\t\tcoreprops:[], extprops:[], custprops:[], themes:[], styles:[],\n\t\tcalcchains:[], vba: [], drawings: [], metadata: [], people:[],\n\t\tTODO:[], xmlns: \"\" }/*:any*/);\n}\n\nfunction parse_ct(data/*:?string*/) {\n\tvar ct = new_ct();\n\tif(!data || !data.match) return ct;\n\tvar ctext = {};\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0].replace(nsregex,\"<\")) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Types': ct.xmlns = y['xmlns' + (y[0].match(/<(\\w+):/)||[\"\",\"\"])[1] ]; break;\n\t\t\tcase '<Default': ctext[y.Extension] = y.ContentType; break;\n\t\t\tcase '<Override':\n\t\t\t\tif(ct[ct2type[y.ContentType]] !== undefined) ct[ct2type[y.ContentType]].push(y.PartName);\n\t\t\t\tbreak;\n\t\t}\n\t});\n\tif(ct.xmlns !== XMLNS.CT) throw new Error(\"Unknown Namespace: \" + ct.xmlns);\n\tct.calcchain = ct.calcchains.length > 0 ? ct.calcchains[0] : \"\";\n\tct.sst = ct.strs.length > 0 ? ct.strs[0] : \"\";\n\tct.style = ct.styles.length > 0 ? ct.styles[0] : \"\";\n\tct.defaults = ctext;\n\tdelete ct.calcchains;\n\treturn ct;\n}\n\nfunction write_ct(ct, opts)/*:string*/ {\n\tvar type2ct/*{[string]:Array<string>}*/ = evert_arr(ct2type);\n\n\tvar o/*:Array<string>*/ = [], v;\n\to[o.length] = (XML_HEADER);\n\to[o.length] = writextag('Types', null, {\n\t\t'xmlns': XMLNS.CT,\n\t\t'xmlns:xsd': XMLNS.xsd,\n\t\t'xmlns:xsi': XMLNS.xsi\n\t});\n\n\to = o.concat([\n\t\t['xml', 'application/xml'],\n\t\t['bin', 'application/vnd.ms-excel.sheet.binary.macroEnabled.main'],\n\t\t['vml', 'application/vnd.openxmlformats-officedocument.vmlDrawing'],\n\t\t['data', 'application/vnd.openxmlformats-officedocument.model+data'],\n\t\t/* from test files */\n\t\t['bmp', 'image/bmp'],\n\t\t['png', 'image/png'],\n\t\t['gif', 'image/gif'],\n\t\t['emf', 'image/x-emf'],\n\t\t['wmf', 'image/x-wmf'],\n\t\t['jpg', 'image/jpeg'], ['jpeg', 'image/jpeg'],\n\t\t['tif', 'image/tiff'], ['tiff', 'image/tiff'],\n\t\t['pdf', 'application/pdf'],\n\t\t['rels', 'application/vnd.openxmlformats-package.relationships+xml']\n\t].map(function(x) {\n\t\treturn writextag('Default', null, {'Extension':x[0], 'ContentType': x[1]});\n\t}));\n\n\t/* only write first instance */\n\tvar f1 = function(w) {\n\t\tif(ct[w] && ct[w].length > 0) {\n\t\t\tv = ct[w][0];\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n\t\t\t}));\n\t\t}\n\t};\n\n\t/* book type-specific */\n\tvar f2 = function(w) {\n\t\t(ct[w]||[]).forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': CT_LIST[w][opts.bookType] || CT_LIST[w]['xlsx']\n\t\t\t}));\n\t\t});\n\t};\n\n\t/* standard type */\n\tvar f3 = function(t) {\n\t\t(ct[t]||[]).forEach(function(v) {\n\t\t\to[o.length] = (writextag('Override', null, {\n\t\t\t\t'PartName': (v[0] == '/' ? \"\":\"/\") + v,\n\t\t\t\t'ContentType': type2ct[t][0]\n\t\t\t}));\n\t\t});\n\t};\n\n\tf1('workbooks');\n\tf2('sheets');\n\tf2('charts');\n\tf3('themes');\n\t['strs', 'styles'].forEach(f1);\n\t['coreprops', 'extprops', 'custprops'].forEach(f3);\n\tf3('vba');\n\tf3('comments');\n\tf3('threadedcomments');\n\tf3('drawings');\n\tf2('metadata');\n\tf3('people');\n\tif(o.length>2){ o[o.length] = ('</Types>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 9.3 Relationships */\nvar RELS = ({\n\tWB: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tSHEET: \"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument\",\n\tHLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\",\n\tVML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing\",\n\tXPATH: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath\",\n\tXMISS: \"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing\",\n\tXLINK: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink\",\n\tCXML: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml\",\n\tCXMLP: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps\",\n\tCMNT: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments\",\n\tCORE_PROPS: \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\",\n\tEXT_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\n\tCUST_PROPS: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties',\n\tSST: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\",\n\tSTY: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\",\n\tTHEME: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\",\n\tCHART: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\",\n\tCHARTEX: \"http://schemas.microsoft.com/office/2014/relationships/chartEx\",\n\tCS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet\",\n\tWS: [\n\t\t\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\",\n\t\t\"http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet\"\n\t],\n\tDS: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet\",\n\tMS: \"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet\",\n\tIMG: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\",\n\tDRAW: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing\",\n\tXLMETA: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata\",\n\tTCMNT: \"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment\",\n\tPEOPLE: \"http://schemas.microsoft.com/office/2017/10/relationships/person\",\n\tVBA: \"http://schemas.microsoft.com/office/2006/relationships/vbaProject\"\n}/*:any*/);\n\n\n/* 9.3.3 Representing Relationships */\nfunction get_rels_path(file/*:string*/)/*:string*/ {\n\tvar n = file.lastIndexOf(\"/\");\n\treturn file.slice(0,n+1) + '_rels/' + file.slice(n+1) + \".rels\";\n}\n\nfunction parse_rels(data/*:?string*/, currentFilePath/*:string*/) {\n\tvar rels = {\"!id\":{}};\n\tif (!data) return rels;\n\tif (currentFilePath.charAt(0) !== '/') {\n\t\tcurrentFilePath = '/'+currentFilePath;\n\t}\n\tvar hash = {};\n\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\t/* 9.3.2.2 OPC_Relationships */\n\t\tif (y[0] === '<Relationship') {\n\t\t\tvar rel = {}; rel.Type = y.Type; rel.Target = y.Target; rel.Id = y.Id; if(y.TargetMode) rel.TargetMode = y.TargetMode;\n\t\t\tvar canonictarget = y.TargetMode === 'External' ? y.Target : resolve_path(y.Target, currentFilePath);\n\t\t\trels[canonictarget] = rel;\n\t\t\thash[y.Id] = rel;\n\t\t}\n\t});\n\trels[\"!id\"] = hash;\n\treturn rels;\n}\n\n\n/* TODO */\nfunction write_rels(rels)/*:string*/ {\n\tvar o = [XML_HEADER, writextag('Relationships', null, {\n\t\t//'xmlns:ns0': XMLNS.RELS,\n\t\t'xmlns': XMLNS.RELS\n\t})];\n\tkeys(rels['!id']).forEach(function(rid) {\n\t\to[o.length] = (writextag('Relationship', null, rels['!id'][rid]));\n\t});\n\tif(o.length>2){ o[o.length] = ('</Relationships>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\nfunction add_rels(rels, rId/*:number*/, f, type, relobj, targetmode/*:?string*/)/*:number*/ {\n\tif(!relobj) relobj = {};\n\tif(!rels['!id']) rels['!id'] = {};\n\tif(!rels['!idx']) rels['!idx'] = 1;\n\tif(rId < 0) for(rId = rels['!idx']; rels['!id']['rId' + rId]; ++rId){/* empty */}\n\trels['!idx'] = rId + 1;\n\trelobj.Id = 'rId' + rId;\n\trelobj.Type = type;\n\trelobj.Target = f;\n\tif(targetmode) relobj.TargetMode = targetmode;\n\telse if([RELS.HLINK, RELS.XPATH, RELS.XMISS].indexOf(relobj.Type) > -1) relobj.TargetMode = \"External\";\n\tif(rels['!id'][relobj.Id]) throw new Error(\"Cannot rewrite rId \" + rId);\n\trels['!id'][relobj.Id] = relobj;\n\trels[('/' + relobj.Target).replace(\"//\",\"/\")] = relobj;\n\treturn rId;\n}\n/* Open Document Format for Office Applications (OpenDocument) Version 1.2 */\n/* Part 3 Section 4 Manifest File */\nvar CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\nfunction parse_manifest(d, opts) {\n\tvar str = xlml_normalize(d);\n\tvar Rn;\n\tvar FEtag;\n\twhile((Rn = xlmlregex.exec(str))) switch(Rn[3]) {\n\t\tcase 'manifest': break; // 4.2 <manifest:manifest>\n\t\tcase 'file-entry': // 4.3 <manifest:file-entry>\n\t\t\tFEtag = parsexmltag(Rn[0], false);\n\t\t\tif(FEtag.path == '/' && FEtag.type !== CT_ODS) throw new Error(\"This OpenDocument is not a spreadsheet\");\n\t\t\tbreak;\n\t\tcase 'encryption-data': // 4.4 <manifest:encryption-data>\n\t\tcase 'algorithm': // 4.5 <manifest:algorithm>\n\t\tcase 'start-key-generation': // 4.6 <manifest:start-key-generation>\n\t\tcase 'key-derivation': // 4.7 <manifest:key-derivation>\n\t\t\tthrow new Error(\"Unsupported ODS Encryption\");\n\t\tdefault: if(opts && opts.WTF) throw Rn;\n\t}\n}\n\nfunction write_manifest(manifest/*:Array<Array<string> >*/)/*:string*/ {\n\tvar o = [XML_HEADER];\n\to.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');\n\to.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');\n\tfor(var i = 0; i < manifest.length; ++i) o.push('  <manifest:file-entry manifest:full-path=\"' + manifest[i][0] + '\" manifest:media-type=\"' + manifest[i][1] + '\"/>\\n');\n\to.push('</manifest:manifest>');\n\treturn o.join(\"\");\n}\n\n/* Part 3 Section 6 Metadata Manifest File */\nfunction write_rdf_type(file/*:string*/, res/*:string*/, tag/*:?string*/) {\n\treturn [\n\t\t'  <rdf:Description rdf:about=\"' + file + '\">\\n',\n\t\t'    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || \"odf\") + '#' + res + '\"/>\\n',\n\t\t'  </rdf:Description>\\n'\n\t].join(\"\");\n}\nfunction write_rdf_has(base/*:string*/, file/*:string*/) {\n\treturn [\n\t\t'  <rdf:Description rdf:about=\"' + base + '\">\\n',\n\t\t'    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"' + file + '\"/>\\n',\n\t\t'  </rdf:Description>\\n'\n\t].join(\"\");\n}\nfunction write_rdf(rdf) {\n\tvar o = [XML_HEADER];\n\to.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');\n\tfor(var i = 0; i != rdf.length; ++i) {\n\t\to.push(write_rdf_type(rdf[i][0], rdf[i][1]));\n\t\to.push(write_rdf_has(\"\",rdf[i][0]));\n\t}\n\to.push(write_rdf_type(\"\",\"Document\", \"pkg\"));\n\to.push('</rdf:RDF>');\n\treturn o.join(\"\");\n}\n/* TODO: pull properties */\nfunction write_meta_ods(/*:: wb: Workbook, opts: any*/)/*:string*/ {\n\treturn '<office:document-meta xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" office:version=\"1.2\"><office:meta><meta:generator>Sheet' + 'JS ' + XLSX.version + '</meta:generator></office:meta></office:document-meta>';\n}\n\n/* ECMA-376 Part II 11.1 Core Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar CORE_PROPS/*:Array<Array<string> >*/ = [\n\t[\"cp:category\", \"Category\"],\n\t[\"cp:contentStatus\", \"ContentStatus\"],\n\t[\"cp:keywords\", \"Keywords\"],\n\t[\"cp:lastModifiedBy\", \"LastAuthor\"],\n\t[\"cp:lastPrinted\", \"LastPrinted\"],\n\t[\"cp:revision\", \"RevNumber\"],\n\t[\"cp:version\", \"Version\"],\n\t[\"dc:creator\", \"Author\"],\n\t[\"dc:description\", \"Comments\"],\n\t[\"dc:identifier\", \"Identifier\"],\n\t[\"dc:language\", \"Language\"],\n\t[\"dc:subject\", \"Subject\"],\n\t[\"dc:title\", \"Title\"],\n\t[\"dcterms:created\", \"CreatedDate\", 'date'],\n\t[\"dcterms:modified\", \"ModifiedDate\", 'date']\n];\n\nvar CORE_PROPS_REGEX/*:Array<RegExp>*/ = /*#__PURE__*/(function() {\n\tvar r = new Array(CORE_PROPS.length);\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i];\n\t\tvar g = \"(?:\"+ f[0].slice(0,f[0].indexOf(\":\")) +\":)\"+ f[0].slice(f[0].indexOf(\":\")+1);\n\t\tr[i] = new RegExp(\"<\" + g + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + g + \">\");\n\t}\n\treturn r;\n})();\n\nfunction parse_core_props(data) {\n\tvar p = {};\n\tdata = utf8read(data);\n\n\tfor(var i = 0; i < CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i], cur = data.match(CORE_PROPS_REGEX[i]);\n\t\tif(cur != null && cur.length > 0) p[f[1]] = unescapexml(cur[1]);\n\t\tif(f[2] === 'date' && p[f[1]]) p[f[1]] = parseDate(p[f[1]]);\n\t}\n\n\treturn p;\n}\n\nfunction cp_doit(f, g, h, o, p) {\n\tif(p[f] != null || g == null || g === \"\") return;\n\tp[f] = g;\n\tg = escapexml(g);\n\to[o.length] = (h ? writextag(f,g,h) : writetag(f,g));\n}\n\nfunction write_core_props(cp, _opts) {\n\tvar opts = _opts || {};\n\tvar o = [XML_HEADER, writextag('cp:coreProperties', null, {\n\t\t//'xmlns': XMLNS.CORE_PROPS,\n\t\t'xmlns:cp': XMLNS.CORE_PROPS,\n\t\t'xmlns:dc': XMLNS.dc,\n\t\t'xmlns:dcterms': XMLNS.dcterms,\n\t\t'xmlns:dcmitype': XMLNS.dcmitype,\n\t\t'xmlns:xsi': XMLNS.xsi\n\t})], p = {};\n\tif(!cp && !opts.Props) return o.join(\"\");\n\n\tif(cp) {\n\t\tif(cp.CreatedDate != null) cp_doit(\"dcterms:created\", typeof cp.CreatedDate === \"string\" ? cp.CreatedDate : write_w3cdtf(cp.CreatedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n\t\tif(cp.ModifiedDate != null) cp_doit(\"dcterms:modified\", typeof cp.ModifiedDate === \"string\" ? cp.ModifiedDate : write_w3cdtf(cp.ModifiedDate, opts.WTF), {\"xsi:type\":\"dcterms:W3CDTF\"}, o, p);\n\t}\n\n\tfor(var i = 0; i != CORE_PROPS.length; ++i) {\n\t\tvar f = CORE_PROPS[i];\n\t\tvar v = opts.Props && opts.Props[f[1]] != null ? opts.Props[f[1]] : cp ? cp[f[1]] : null;\n\t\tif(v === true) v = \"1\";\n\t\telse if(v === false) v = \"0\";\n\t\telse if(typeof v == \"number\") v = String(v);\n\t\tif(v != null) cp_doit(f[0], v, null, o, p);\n\t}\n\tif(o.length>2){ o[o.length] = ('</cp:coreProperties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 15.2.12.3 Extended File Properties Part */\n/* [MS-OSHARED] 2.3.3.2.[1-2].1 (PIDSI/PIDDSI) */\nvar EXT_PROPS/*:Array<Array<string> >*/ = [\n\t[\"Application\", \"Application\", \"string\"],\n\t[\"AppVersion\", \"AppVersion\", \"string\"],\n\t[\"Company\", \"Company\", \"string\"],\n\t[\"DocSecurity\", \"DocSecurity\", \"string\"],\n\t[\"Manager\", \"Manager\", \"string\"],\n\t[\"HyperlinksChanged\", \"HyperlinksChanged\", \"bool\"],\n\t[\"SharedDoc\", \"SharedDoc\", \"bool\"],\n\t[\"LinksUpToDate\", \"LinksUpToDate\", \"bool\"],\n\t[\"ScaleCrop\", \"ScaleCrop\", \"bool\"],\n\t[\"HeadingPairs\", \"HeadingPairs\", \"raw\"],\n\t[\"TitlesOfParts\", \"TitlesOfParts\", \"raw\"]\n];\n\nvar PseudoPropsPairs = [\n\t\"Worksheets\",  \"SheetNames\",\n\t\"NamedRanges\", \"DefinedNames\",\n\t\"Chartsheets\", \"ChartNames\"\n];\nfunction load_props_pairs(HP/*:string|Array<Array<any>>*/, TOP, props, opts) {\n\tvar v = [];\n\tif(typeof HP == \"string\") v = parseVector(HP, opts);\n\telse for(var j = 0; j < HP.length; ++j) v = v.concat(HP[j].map(function(hp) { return {v:hp}; }));\n\tvar parts = (typeof TOP == \"string\") ? parseVector(TOP, opts).map(function (x) { return x.v; }) : TOP;\n\tvar idx = 0, len = 0;\n\tif(parts.length > 0) for(var i = 0; i !== v.length; i += 2) {\n\t\tlen = +(v[i+1].v);\n\t\tswitch(v[i].v) {\n\t\t\tcase \"Worksheets\":\n\t\t\tcase \"\":\n\t\t\tcase \"\":\n\t\t\tcase \" \":\n\t\t\tcase \"\":\n\t\t\tcase \" \":\n\t\t\tcase \"Arbeitsbltter\":\n\t\t\tcase \"alma Sayfalar\":\n\t\t\tcase \"Feuilles de calcul\":\n\t\t\tcase \"Fogli di lavoro\":\n\t\t\tcase \"Folhas de clculo\":\n\t\t\tcase \"Planilhas\":\n\t\t\tcase \"Regneark\":\n\t\t\tcase \"Hojas de clculo\":\n\t\t\tcase \"Werkbladen\":\n\t\t\t\tprops.Worksheets = len;\n\t\t\t\tprops.SheetNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\n\t\t\tcase \"Named Ranges\":\n\t\t\tcase \"Rangos con nombre\":\n\t\t\tcase \"\":\n\t\t\tcase \"Benannte Bereiche\":\n\t\t\tcase \"Navngivne omrder\":\n\t\t\t\tprops.NamedRanges = len;\n\t\t\t\tprops.DefinedNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\n\t\t\tcase \"Charts\":\n\t\t\tcase \"Diagramme\":\n\t\t\t\tprops.Chartsheets = len;\n\t\t\t\tprops.ChartNames = parts.slice(idx, idx + len);\n\t\t\t\tbreak;\n\t\t}\n\t\tidx += len;\n\t}\n}\n\nfunction parse_ext_props(data, p, opts) {\n\tvar q = {}; if(!p) p = {};\n\tdata = utf8read(data);\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tvar xml = (data.match(matchtag(f[0]))||[])[1];\n\t\tswitch(f[2]) {\n\t\t\tcase \"string\": if(xml) p[f[1]] = unescapexml(xml); break;\n\t\t\tcase \"bool\": p[f[1]] = xml === \"true\"; break;\n\t\t\tcase \"raw\":\n\t\t\t\tvar cur = data.match(new RegExp(\"<\" + f[0] + \"[^>]*>([\\\\s\\\\S]*?)<\\/\" + f[0] + \">\"));\n\t\t\t\tif(cur && cur.length > 0) q[f[1]] = cur[1];\n\t\t\t\tbreak;\n\t\t}\n\t});\n\n\tif(q.HeadingPairs && q.TitlesOfParts) load_props_pairs(q.HeadingPairs, q.TitlesOfParts, p, opts);\n\n\treturn p;\n}\n\nfunction write_ext_props(cp/*::, opts*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [], W = writextag;\n\tif(!cp) cp = {};\n\tcp.Application = \"SheetJS\";\n\to[o.length] = (XML_HEADER);\n\to[o.length] = (writextag('Properties', null, {\n\t\t'xmlns': XMLNS.EXT_PROPS,\n\t\t'xmlns:vt': XMLNS.vt\n\t}));\n\n\tEXT_PROPS.forEach(function(f) {\n\t\tif(cp[f[1]] === undefined) return;\n\t\tvar v;\n\t\tswitch(f[2]) {\n\t\t\tcase 'string': v = escapexml(String(cp[f[1]])); break;\n\t\t\tcase 'bool': v = cp[f[1]] ? 'true' : 'false'; break;\n\t\t}\n\t\tif(v !== undefined) o[o.length] = (W(f[0], v));\n\t});\n\n\t/* TODO: HeadingPairs, TitlesOfParts */\n\to[o.length] = (W('HeadingPairs', W('vt:vector', W('vt:variant', '<vt:lpstr>Worksheets</vt:lpstr>')+W('vt:variant', W('vt:i4', String(cp.Worksheets))), {size:2, baseType:\"variant\"})));\n\to[o.length] = (W('TitlesOfParts', W('vt:vector', cp.SheetNames.map(function(s) { return \"<vt:lpstr>\" + escapexml(s) + \"</vt:lpstr>\"; }).join(\"\"), {size: cp.Worksheets, baseType:\"lpstr\"})));\n\tif(o.length>2){ o[o.length] = ('</Properties>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* 15.2.12.2 Custom File Properties Part */\nvar custregex = /<[^>]+>[^<]*/g;\nfunction parse_cust_props(data/*:string*/, opts) {\n\tvar p = {}, name = \"\";\n\tvar m = data.match(custregex);\n\tif(m) for(var i = 0; i != m.length; ++i) {\n\t\tvar x = m[i], y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<Properties': break;\n\t\t\tcase '<property': name = unescapexml(y.name); break;\n\t\t\tcase '</property>': name = null; break;\n\t\t\tdefault: if (x.indexOf('<vt:') === 0) {\n\t\t\t\tvar toks = x.split('>');\n\t\t\t\tvar type = toks[0].slice(4), text = toks[1];\n\t\t\t\t/* 22.4.2.32 (CT_Variant). Omit the binary types from 22.4 (Variant Types) */\n\t\t\t\tswitch(type) {\n\t\t\t\t\tcase 'lpstr': case 'bstr': case 'lpwstr':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'bool':\n\t\t\t\t\t\tp[name] = parsexmlbool(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'i1': case 'i2': case 'i4': case 'i8': case 'int': case 'uint':\n\t\t\t\t\t\tp[name] = parseInt(text, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'r4': case 'r8': case 'decimal':\n\t\t\t\t\t\tp[name] = parseFloat(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'filetime': case 'date':\n\t\t\t\t\t\tp[name] = parseDate(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cy': case 'error':\n\t\t\t\t\t\tp[name] = unescapexml(text);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(type.slice(-1) == '/') break;\n\t\t\t\t\t\tif(opts.WTF && typeof console !== 'undefined') console.warn('Unexpected', x, type, toks);\n\t\t\t\t}\n\t\t\t} else if(x.slice(0,2) === \"</\") {/* empty */\n\t\t\t} else if(opts.WTF) throw new Error(x);\n\t\t}\n\t}\n\treturn p;\n}\n\nfunction write_cust_props(cp/*::, opts*/)/*:string*/ {\n\tvar o = [XML_HEADER, writextag('Properties', null, {\n\t\t'xmlns': XMLNS.CUST_PROPS,\n\t\t'xmlns:vt': XMLNS.vt\n\t})];\n\tif(!cp) return o.join(\"\");\n\tvar pid = 1;\n\tkeys(cp).forEach(function custprop(k) { ++pid;\n\t\to[o.length] = (writextag('property', write_vt(cp[k], true), {\n\t\t\t'fmtid': '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}',\n\t\t\t'pid': pid,\n\t\t\t'name': escapexml(k)\n\t\t}));\n\t});\n\tif(o.length>2){ o[o.length] = '</Properties>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* Common Name -> XLML Name */\nvar XLMLDocPropsMap = {\n\tTitle: 'Title',\n\tSubject: 'Subject',\n\tAuthor: 'Author',\n\tKeywords: 'Keywords',\n\tComments: 'Description',\n\tLastAuthor: 'LastAuthor',\n\tRevNumber: 'Revision',\n\tApplication: 'AppName',\n\t/* TotalTime: 'TotalTime', */\n\tLastPrinted: 'LastPrinted',\n\tCreatedDate: 'Created',\n\tModifiedDate: 'LastSaved',\n\t/* Pages */\n\t/* Words */\n\t/* Characters */\n\tCategory: 'Category',\n\t/* PresentationFormat */\n\tManager: 'Manager',\n\tCompany: 'Company',\n\t/* Guid */\n\t/* HyperlinkBase */\n\t/* Bytes */\n\t/* Lines */\n\t/* Paragraphs */\n\t/* CharactersWithSpaces */\n\tAppVersion: 'Version',\n\n\tContentStatus: 'ContentStatus', /* NOTE: missing from schema */\n\tIdentifier: 'Identifier', /* NOTE: missing from schema */\n\tLanguage: 'Language' /* NOTE: missing from schema */\n};\nvar evert_XLMLDPM;\n\nfunction xlml_set_prop(Props, tag/*:string*/, val) {\n\tif(!evert_XLMLDPM) evert_XLMLDPM = evert(XLMLDocPropsMap);\n\ttag = evert_XLMLDPM[tag] || tag;\n\tProps[tag] = val;\n}\n\nfunction xlml_write_docprops(Props, opts) {\n\tvar o/*:Array<string>*/ = [];\n\tkeys(XLMLDocPropsMap).map(function(m) {\n\t\tfor(var i = 0; i < CORE_PROPS.length; ++i) if(CORE_PROPS[i][1] == m) return CORE_PROPS[i];\n\t\tfor(i = 0; i < EXT_PROPS.length; ++i) if(EXT_PROPS[i][1] == m) return EXT_PROPS[i];\n\t\tthrow m;\n\t}).forEach(function(p) {\n\t\tif(Props[p[1]] == null) return;\n\t\tvar m = opts && opts.Props && opts.Props[p[1]] != null ? opts.Props[p[1]] : Props[p[1]];\n\t\tswitch(p[2]) {\n\t\t\tcase 'date': m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"Z\"); break;\n\t\t}\n\t\tif(typeof m == 'number') m = String(m);\n\t\telse if(m === true || m === false) { m = m ? \"1\" : \"0\"; }\n\t\telse if(m instanceof Date) m = new Date(m).toISOString().replace(/\\.\\d*Z/,\"\");\n\t\to.push(writetag(XLMLDocPropsMap[p[1]] || p[1], m));\n\t});\n\treturn writextag('DocumentProperties', o.join(\"\"), {xmlns:XLMLNS.o });\n}\nfunction xlml_write_custprops(Props, Custprops/*::, opts*/) {\n\tvar BLACKLIST = [\"Worksheets\",\"SheetNames\"];\n\tvar T = 'CustomDocumentProperties';\n\tvar o/*:Array<string>*/ = [];\n\tif(Props) keys(Props).forEach(function(k) {\n\t\t/*:: if(!Props) return; */\n\t\tif(!Object.prototype.hasOwnProperty.call(Props, k)) return;\n\t\tfor(var i = 0; i < CORE_PROPS.length; ++i) if(k == CORE_PROPS[i][1]) return;\n\t\tfor(i = 0; i < EXT_PROPS.length; ++i) if(k == EXT_PROPS[i][1]) return;\n\t\tfor(i = 0; i < BLACKLIST.length; ++i) if(k == BLACKLIST[i]) return;\n\n\t\tvar m = Props[k];\n\t\tvar t = \"string\";\n\t\tif(typeof m == 'number') { t = \"float\"; m = String(m); }\n\t\telse if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\n\t\telse m = String(m);\n\t\to.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\n\t});\n\tif(Custprops) keys(Custprops).forEach(function(k) {\n\t\t/*:: if(!Custprops) return; */\n\t\tif(!Object.prototype.hasOwnProperty.call(Custprops, k)) return;\n\t\tif(Props && Object.prototype.hasOwnProperty.call(Props, k)) return;\n\t\tvar m = Custprops[k];\n\t\tvar t = \"string\";\n\t\tif(typeof m == 'number') { t = \"float\"; m = String(m); }\n\t\telse if(m === true || m === false) { t = \"boolean\"; m = m ? \"1\" : \"0\"; }\n\t\telse if(m instanceof Date) { t = \"dateTime.tz\"; m = m.toISOString(); }\n\t\telse m = String(m);\n\t\to.push(writextag(escapexmltag(k), m, {\"dt:dt\":t}));\n\t});\n\treturn '<' + T + ' xmlns=\"' + XLMLNS.o + '\">' + o.join(\"\") + '</' + T + '>';\n}\n/* [MS-DTYP] 2.3.3 FILETIME */\n/* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n/* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\nfunction parse_FILETIME(blob) {\n\tvar dwLowDateTime = blob.read_shift(4), dwHighDateTime = blob.read_shift(4);\n\treturn new Date(((dwHighDateTime/1e7*Math.pow(2,32) + dwLowDateTime/1e7) - 11644473600)*1000).toISOString().replace(/\\.000/,\"\");\n}\nfunction write_FILETIME(time/*:string|Date*/) {\n\tvar date = (typeof time == \"string\") ? new Date(Date.parse(time)) : time;\n\tvar t = date.getTime() / 1000 + 11644473600;\n\tvar l = t % Math.pow(2,32), h = (t - l) / Math.pow(2,32);\n\tl *= 1e7; h *= 1e7;\n\tvar w = (l / Math.pow(2,32)) | 0;\n\tif(w > 0) { l = l % Math.pow(2,32); h += w; }\n\tvar o = new_buf(8); o.write_shift(4, l); o.write_shift(4, h); return o;\n}\n\n/* [MS-OSHARED] 2.3.3.1.4 Lpstr */\nfunction parse_lpstr(blob, type, pad/*:?number*/) {\n\tvar start = blob.l;\n\tvar str = blob.read_shift(0, 'lpstr-cp');\n\tif(pad) while((blob.l - start) & 3) ++blob.l;\n\treturn str;\n}\n\n/* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\nfunction parse_lpwstr(blob, type, pad) {\n\tvar str = blob.read_shift(0, 'lpwstr');\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\n\treturn str;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.11 VtString */\n/* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\nfunction parse_VtStringBase(blob, stringType, pad) {\n\tif(stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\n\treturn parse_lpstr(blob, stringType, pad);\n}\n\nfunction parse_VtString(blob, t/*:number*/, pad/*:?boolean*/) { return parse_VtStringBase(blob, t, pad === false ? 0: 4); }\nfunction parse_VtUnalignedString(blob, t/*:number*/) { if(!t) throw new Error(\"VtUnalignedString must have positive length\"); return parse_VtStringBase(blob, t, 0); }\n\n/* [MS-OSHARED] 2.3.3.1.7 VtVecLpwstrValue */\nfunction parse_VtVecLpwstrValue(blob)/*:Array<string>*/ {\n\tvar length = blob.read_shift(4);\n\tvar ret/*:Array<string>*/ = [];\n\tfor(var i = 0; i != length; ++i) {\n\t\tvar start = blob.l;\n\t\tret[i] = blob.read_shift(0, 'lpwstr').replace(chr0,'');\n\t\tif((blob.l - start) & 0x02) blob.l += 2;\n\t}\n\treturn ret;\n}\n\n/* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\nfunction parse_VtVecUnalignedLpstrValue(blob)/*:Array<string>*/ {\n\tvar length = blob.read_shift(4);\n\tvar ret/*:Array<string>*/ = [];\n\tfor(var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr-cp').replace(chr0,'');\n\treturn ret;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\nfunction parse_VtHeadingPair(blob) {\n\tvar start = blob.l;\n\tvar headingString = parse_TypedPropertyValue(blob, VT_USTR);\n\tif(blob[blob.l] == 0x00 && blob[blob.l+1] == 0x00 && ((blob.l - start) & 0x02)) blob.l += 2;\n\tvar headerParts = parse_TypedPropertyValue(blob, VT_I4);\n\treturn [headingString, headerParts];\n}\n\n/* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\nfunction parse_VtVecHeadingPairValue(blob) {\n\tvar cElements = blob.read_shift(4);\n\tvar out = [];\n\tfor(var i = 0; i < cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n\treturn out;\n}\n\n/* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\nfunction parse_dictionary(blob,CodePage) {\n\tvar cnt = blob.read_shift(4);\n\tvar dict/*:{[number]:string}*/ = ({}/*:any*/);\n\tfor(var j = 0; j != cnt; ++j) {\n\t\tvar pid = blob.read_shift(4);\n\t\tvar len = blob.read_shift(4);\n\t\tdict[pid] = blob.read_shift(len, (CodePage === 0x4B0 ?'utf16le':'utf8')).replace(chr0,'').replace(chr1,'!');\n\t\tif(CodePage === 0x4B0 && (len % 2)) blob.l += 2;\n\t}\n\tif(blob.l & 3) blob.l = (blob.l>>2+1)<<2;\n\treturn dict;\n}\n\n/* [MS-OLEPS] 2.9 BLOB */\nfunction parse_BLOB(blob) {\n\tvar size = blob.read_shift(4);\n\tvar bytes = blob.slice(blob.l,blob.l+size);\n\tblob.l += size;\n\tif((size & 3) > 0) blob.l += (4 - (size & 3)) & 3;\n\treturn bytes;\n}\n\n/* [MS-OLEPS] 2.11 ClipboardData */\nfunction parse_ClipboardData(blob) {\n\t// TODO\n\tvar o = {};\n\to.Size = blob.read_shift(4);\n\t//o.Format = blob.read_shift(4);\n\tblob.l += o.Size + 3 - (o.Size - 1) % 4;\n\treturn o;\n}\n\n/* [MS-OLEPS] 2.15 TypedPropertyValue */\nfunction parse_TypedPropertyValue(blob, type/*:number*/, _opts)/*:any*/ {\n\tvar t = blob.read_shift(2), ret, opts = _opts||{};\n\tblob.l += 2;\n\tif(type !== VT_VARIANT)\n\tif(t !== type && VT_CUSTOM.indexOf(type)===-1 && !((type & 0xFFFE) == 0x101E && (t & 0xFFFE) == 0x101E)) throw new Error('Expected type ' + type + ' saw ' + t);\n\tswitch(type === VT_VARIANT ? t : type) {\n\t\tcase 0x02 /*VT_I2*/: ret = blob.read_shift(2, 'i'); if(!opts.raw) blob.l += 2; return ret;\n\t\tcase 0x03 /*VT_I4*/: ret = blob.read_shift(4, 'i'); return ret;\n\t\tcase 0x0B /*VT_BOOL*/: return blob.read_shift(4) !== 0x0;\n\t\tcase 0x13 /*VT_UI4*/: ret = blob.read_shift(4); return ret;\n\t\tcase 0x1E /*VT_LPSTR*/: return parse_lpstr(blob, t, 4).replace(chr0,'');\n\t\tcase 0x1F /*VT_LPWSTR*/: return parse_lpwstr(blob);\n\t\tcase 0x40 /*VT_FILETIME*/: return parse_FILETIME(blob);\n\t\tcase 0x41 /*VT_BLOB*/: return parse_BLOB(blob);\n\t\tcase 0x47 /*VT_CF*/: return parse_ClipboardData(blob);\n\t\tcase 0x50 /*VT_STRING*/: return parse_VtString(blob, t, !opts.raw).replace(chr0,'');\n\t\tcase 0x51 /*VT_USTR*/: return parse_VtUnalignedString(blob, t/*, 4*/).replace(chr0,'');\n\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: return parse_VtVecHeadingPairValue(blob);\n\t\tcase 0x101E /*VT_VECTOR|VT_LPSTR*/:\n\t\tcase 0x101F /*VT_VECTOR|VT_LPWSTR*/:\n\t\t\treturn t == 0x101F ? parse_VtVecLpwstrValue(blob) : parse_VtVecUnalignedLpstrValue(blob);\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n\t}\n}\nfunction write_TypedPropertyValue(type/*:number*/, value) {\n\tvar o = new_buf(4), p = new_buf(4);\n\to.write_shift(4, type == 0x50 ? 0x1F : type);\n\tswitch(type) {\n\t\tcase 0x03 /*VT_I4*/: p.write_shift(-4, value); break;\n\t\tcase 0x05 /*VT_I4*/: p = new_buf(8); p.write_shift(8, value, 'f'); break;\n\t\tcase 0x0B /*VT_BOOL*/: p.write_shift(4, value ? 0x01 : 0x00); break;\n\t\tcase 0x40 /*VT_FILETIME*/: /*:: if(typeof value !== \"string\" && !(value instanceof Date)) throw \"unreachable\"; */ p = write_FILETIME(value); break;\n\t\tcase 0x1F /*VT_LPWSTR*/:\n\t\tcase 0x50 /*VT_STRING*/:\n\t\t\t/*:: if(typeof value !== \"string\") throw \"unreachable\"; */\n\t\t\tp = new_buf(4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n\t\t\tp.write_shift(4, value.length + 1);\n\t\t\tp.write_shift(0, value, \"dbcs\");\n\t\t\twhile(p.l != p.length) p.write_shift(1, 0);\n\t\t\tbreak;\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + value);\n\t}\n\treturn bconcat([o, p]);\n}\n\n/* [MS-OLEPS] 2.20 PropertySet */\nfunction parse_PropertySet(blob, PIDSI) {\n\tvar start_addr = blob.l;\n\tvar size = blob.read_shift(4);\n\tvar NumProps = blob.read_shift(4);\n\tvar Props = [], i = 0;\n\tvar CodePage = 0;\n\tvar Dictionary = -1, DictObj/*:{[number]:string}*/ = ({}/*:any*/);\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tvar PropID = blob.read_shift(4);\n\t\tvar Offset = blob.read_shift(4);\n\t\tProps[i] = [PropID, Offset + start_addr];\n\t}\n\tProps.sort(function(x,y) { return x[1] - y[1]; });\n\tvar PropH = {};\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tif(blob.l !== Props[i][1]) {\n\t\t\tvar fail = true;\n\t\t\tif(i>0 && PIDSI) switch(PIDSI[Props[i-1][0]].t) {\n\t\t\t\tcase 0x02 /*VT_I2*/: if(blob.l+2 === Props[i][1]) { blob.l+=2; fail = false; } break;\n\t\t\t\tcase 0x50 /*VT_STRING*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t}\n\t\t\tif((!PIDSI||i==0) && blob.l <= Props[i][1]) { fail=false; blob.l = Props[i][1]; }\n\t\t\tif(fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n\t\t}\n\t\tif(PIDSI) {\n\t\t\tvar piddsi = PIDSI[Props[i][0]];\n\t\t\tPropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {raw:true});\n\t\t\tif(piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + (\"0000\" + String(PropH[piddsi.n] & 0xFFFF)).slice(-4);\n\t\t\tif(piddsi.n == \"CodePage\") switch(PropH[piddsi.n]) {\n\t\t\t\tcase 0: PropH[piddsi.n] = 1252;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 874:\n\t\t\t\tcase 932:\n\t\t\t\tcase 936:\n\t\t\t\tcase 949:\n\t\t\t\tcase 950:\n\t\t\t\tcase 1250:\n\t\t\t\tcase 1251:\n\t\t\t\tcase 1253:\n\t\t\t\tcase 1254:\n\t\t\t\tcase 1255:\n\t\t\t\tcase 1256:\n\t\t\t\tcase 1257:\n\t\t\t\tcase 1258:\n\t\t\t\tcase 10000:\n\t\t\t\tcase 1200:\n\t\t\t\tcase 1201:\n\t\t\t\tcase 1252:\n\t\t\t\tcase 65000: case -536:\n\t\t\t\tcase 65001: case -535:\n\t\t\t\t\tset_cp(CodePage = (PropH[piddsi.n]>>>0) & 0xFFFF); break;\n\t\t\t\tdefault: throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n\t\t\t}\n\t\t} else {\n\t\t\tif(Props[i][0] === 0x1) {\n\t\t\t\tCodePage = PropH.CodePage = (parse_TypedPropertyValue(blob, VT_I2)/*:number*/);\n\t\t\t\tset_cp(CodePage);\n\t\t\t\tif(Dictionary !== -1) {\n\t\t\t\t\tvar oldpos = blob.l;\n\t\t\t\t\tblob.l = Props[Dictionary][1];\n\t\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t\t\tblob.l = oldpos;\n\t\t\t\t}\n\t\t\t} else if(Props[i][0] === 0) {\n\t\t\t\tif(CodePage === 0) { Dictionary = i; blob.l = Props[i+1][1]; continue; }\n\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t} else {\n\t\t\t\tvar name = DictObj[Props[i][0]];\n\t\t\t\tvar val;\n\t\t\t\t/* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\t\t\t\tswitch(blob[blob.l]) {\n\t\t\t\t\tcase 0x41 /*VT_BLOB*/: blob.l += 4; val = parse_BLOB(blob); break;\n\t\t\t\t\tcase 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/\\u0000+$/,\"\"); break;\n\t\t\t\t\tcase 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]).replace(/\\u0000+$/,\"\"); break;\n\t\t\t\t\tcase 0x03 /*VT_I4*/: blob.l += 4; val = blob.read_shift(4, 'i'); break;\n\t\t\t\t\tcase 0x13 /*VT_UI4*/: blob.l += 4; val = blob.read_shift(4); break;\n\t\t\t\t\tcase 0x05 /*VT_R8*/: blob.l += 4; val = blob.read_shift(8, 'f'); break;\n\t\t\t\t\tcase 0x0B /*VT_BOOL*/: blob.l += 4; val = parsebool(blob, 4); break;\n\t\t\t\t\tcase 0x40 /*VT_FILETIME*/: blob.l += 4; val = parseDate(parse_FILETIME(blob)); break;\n\t\t\t\t\tdefault: throw new Error(\"unparsed value: \" + blob[blob.l]);\n\t\t\t\t}\n\t\t\t\tPropH[name] = val;\n\t\t\t}\n\t\t}\n\t}\n\tblob.l = start_addr + size; /* step ahead to skip padding */\n\treturn PropH;\n}\nvar XLSPSSkip = [ \"CodePage\", \"Thumbnail\", \"_PID_LINKBASE\", \"_PID_HLINKS\", \"SystemIdentifier\", \"FMTID\" ]; //.concat(PseudoPropsPairs);\nfunction guess_property_type(val/*:any*/)/*:number*/ {\n\tswitch(typeof val) {\n\t\tcase \"boolean\": return 0x0B;\n\t\tcase \"number\": return ((val|0)==val) ? 0x03 : 0x05;\n\t\tcase \"string\": return 0x1F;\n\t\tcase \"object\": if(val instanceof Date) return 0x40; break;\n\t}\n\treturn -1;\n}\nfunction write_PropertySet(entries, RE, PIDSI) {\n\tvar hdr = new_buf(8), piao = [], prop = [];\n\tvar sz = 8, i = 0;\n\n\tvar pr = new_buf(8), pio = new_buf(8);\n\tpr.write_shift(4, 0x0002);\n\tpr.write_shift(4, 0x04B0);\n\tpio.write_shift(4, 0x0001);\n\tprop.push(pr); piao.push(pio);\n\tsz += 8 + pr.length;\n\n\tif(!RE) {\n\t\tpio = new_buf(8);\n\t\tpio.write_shift(4, 0);\n\t\tpiao.unshift(pio);\n\n\t\tvar bufs = [new_buf(4)];\n\t\tbufs[0].write_shift(4, entries.length);\n\t\tfor(i = 0; i < entries.length; ++i) {\n\t\t\tvar value = entries[i][0];\n\t\t\tpr = new_buf(4 + 4 + 2 * (value.length + 1) + (value.length % 2 ? 0 : 2));\n\t\t\tpr.write_shift(4, i+2);\n\t\t\tpr.write_shift(4, value.length + 1);\n\t\t\tpr.write_shift(0, value, \"dbcs\");\n\t\t\twhile(pr.l != pr.length) pr.write_shift(1, 0);\n\t\t\tbufs.push(pr);\n\t\t}\n\t\tpr = bconcat(bufs);\n\t\tprop.unshift(pr);\n\t\tsz += 8 + pr.length;\n\t}\n\n\tfor(i = 0; i < entries.length; ++i) {\n\t\tif(RE && !RE[entries[i][0]]) continue;\n\t\tif(XLSPSSkip.indexOf(entries[i][0]) > -1 || PseudoPropsPairs.indexOf(entries[i][0]) > -1) continue;\n\t\tif(entries[i][1] == null) continue;\n\n\t\tvar val = entries[i][1], idx = 0;\n\t\tif(RE) {\n\t\t\tidx = +RE[entries[i][0]];\n\t\t\tvar pinfo = (PIDSI/*:: || {}*/)[idx]/*:: || {} */;\n\t\t\tif(pinfo.p == \"version\" && typeof val == \"string\") {\n\t\t\t\t/*:: if(typeof val !== \"string\") throw \"unreachable\"; */\n\t\t\t\tvar arr = val.split(\".\");\n\t\t\t\tval = ((+arr[0])<<16) + ((+arr[1])||0);\n\t\t\t}\n\t\t\tpr = write_TypedPropertyValue(pinfo.t, val);\n\t\t} else {\n\t\t\tvar T = guess_property_type(val);\n\t\t\tif(T == -1) { T = 0x1F; val = String(val); }\n\t\t\tpr = write_TypedPropertyValue(T, val);\n\t\t}\n\t\tprop.push(pr);\n\n\t\tpio = new_buf(8);\n\t\tpio.write_shift(4, !RE ? 2+i : idx);\n\t\tpiao.push(pio);\n\n\t\tsz += 8 + pr.length;\n\t}\n\n\tvar w = 8 * (prop.length + 1);\n\tfor(i = 0; i < prop.length; ++i) { piao[i].write_shift(4, w); w += prop[i].length; }\n\thdr.write_shift(4, sz);\n\thdr.write_shift(4, prop.length);\n\treturn bconcat([hdr].concat(piao).concat(prop));\n}\n\n/* [MS-OLEPS] 2.21 PropertySetStream */\nfunction parse_PropertySetStream(file, PIDSI, clsid) {\n\tvar blob = file.content;\n\tif(!blob) return ({}/*:any*/);\n\tprep_blob(blob, 0);\n\n\tvar NumSets, FMTID0, FMTID1, Offset0, Offset1 = 0;\n\tblob.chk('feff', 'Byte Order: ');\n\n\t/*var vers = */blob.read_shift(2); // TODO: check version\n\tvar SystemIdentifier = blob.read_shift(4);\n\tvar CLSID = blob.read_shift(16);\n\tif(CLSID !== CFB.utils.consts.HEADER_CLSID && CLSID !== clsid) throw new Error(\"Bad PropertySet CLSID \" + CLSID);\n\tNumSets = blob.read_shift(4);\n\tif(NumSets !== 1 && NumSets !== 2) throw new Error(\"Unrecognized #Sets: \" + NumSets);\n\tFMTID0 = blob.read_shift(16); Offset0 = blob.read_shift(4);\n\n\tif(NumSets === 1 && Offset0 !== blob.l) throw new Error(\"Length mismatch: \" + Offset0 + \" !== \" + blob.l);\n\telse if(NumSets === 2) { FMTID1 = blob.read_shift(16); Offset1 = blob.read_shift(4); }\n\tvar PSet0 = parse_PropertySet(blob, PIDSI);\n\n\tvar rval = ({ SystemIdentifier: SystemIdentifier }/*:any*/);\n\tfor(var y in PSet0) rval[y] = PSet0[y];\n\t//rval.blob = blob;\n\trval.FMTID = FMTID0;\n\t//rval.PSet0 = PSet0;\n\tif(NumSets === 1) return rval;\n\tif(Offset1 - blob.l == 2) blob.l += 2;\n\tif(blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\n\tvar PSet1;\n\ttry { PSet1 = parse_PropertySet(blob, null); } catch(e) {/* empty */}\n\tfor(y in PSet1) rval[y] = PSet1[y];\n\trval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\treturn rval;\n}\nfunction write_PropertySetStream(entries, clsid, RE, PIDSI/*:{[key:string|number]:any}*/, entries2/*:?any*/, clsid2/*:?any*/) {\n\tvar hdr = new_buf(entries2 ? 68 : 48);\n\tvar bufs = [hdr];\n\thdr.write_shift(2, 0xFFFE);\n\thdr.write_shift(2, 0x0000); /* TODO: type 1 props */\n\thdr.write_shift(4, 0x32363237);\n\thdr.write_shift(16, CFB.utils.consts.HEADER_CLSID, \"hex\");\n\thdr.write_shift(4, (entries2 ? 2 : 1));\n\thdr.write_shift(16, clsid, \"hex\");\n\thdr.write_shift(4, (entries2 ? 68 : 48));\n\tvar ps0 = write_PropertySet(entries, RE, PIDSI);\n\tbufs.push(ps0);\n\n\tif(entries2) {\n\t\tvar ps1 = write_PropertySet(entries2, null, null);\n\t\thdr.write_shift(16, clsid2, \"hex\");\n\t\thdr.write_shift(4, 68 + ps0.length);\n\t\tbufs.push(ps1);\n\t}\n\treturn bconcat(bufs);\n}\n\nfunction parsenoop2(blob, length) { blob.read_shift(length); return null; }\nfunction writezeroes(n, o) { if(!o) o=new_buf(n); for(var j=0; j<n; ++j) o.write_shift(1, 0); return o; }\n\nfunction parslurp(blob, length, cb) {\n\tvar arr = [], target = blob.l + length;\n\twhile(blob.l < target) arr.push(cb(blob, target - blob.l));\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\n\treturn arr;\n}\n\nfunction parsebool(blob, length/*:number*/) { return blob.read_shift(length) === 0x1; }\nfunction writebool(v/*:any*/, o) { if(!o) o=new_buf(2); o.write_shift(2, +!!v); return o; }\n\nfunction parseuint16(blob/*::, length:?number, opts:?any*/) { return blob.read_shift(2, 'u'); }\nfunction writeuint16(v/*:number*/, o) { if(!o) o=new_buf(2); o.write_shift(2, v); return o; }\nfunction parseuint16a(blob, length/*:: :?number, opts:?any*/) { return parslurp(blob,length,parseuint16);}\n\n/* --- 2.5 Structures --- */\n\n/* [MS-XLS] 2.5.10 Bes (boolean or error) */\nfunction parse_Bes(blob/*::, length*/) {\n\tvar v = blob.read_shift(1), t = blob.read_shift(1);\n\treturn t === 0x01 ? v : v === 0x01;\n}\nfunction write_Bes(v, t/*:string*/, o) {\n\tif(!o) o = new_buf(2);\n\to.write_shift(1, ((t == 'e') ? +v : +!!v));\n\to.write_shift(1, ((t == 'e') ? 1 : 0));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.240 ShortXLUnicodeString */\nfunction parse_ShortXLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts && opts.biff >= 12 ? 2 : 1);\n\tvar encoding = 'sbcs-cont';\n\tvar cp = current_codepage;\n\tif(opts && opts.biff >= 8) current_codepage = 1200;\n\tif(!opts || opts.biff == 8 ) {\n\t\tvar fHighByte = blob.read_shift(1);\n\t\tif(fHighByte) { encoding = 'dbcs-cont'; }\n\t} else if(opts.biff == 12) {\n\t\tencoding = 'wstr';\n\t}\n\tif(opts.biff >= 2 && opts.biff <= 5) encoding = 'cpstr';\n\tvar o = cch ? blob.read_shift(cch, encoding) : \"\";\n\tcurrent_codepage = cp;\n\treturn o;\n}\n\n/* 2.5.293 XLUnicodeRichExtendedString */\nfunction parse_XLUnicodeRichExtendedString(blob) {\n\tvar cp = current_codepage;\n\tcurrent_codepage = 1200;\n\tvar cch = blob.read_shift(2), flags = blob.read_shift(1);\n\tvar /*fHighByte = flags & 0x1,*/ fExtSt = flags & 0x4, fRichSt = flags & 0x8;\n\tvar width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\tvar cRun = 0, cbExtRst;\n\tvar z = {};\n\tif(fRichSt) cRun = blob.read_shift(2);\n\tif(fExtSt) cbExtRst = blob.read_shift(4);\n\tvar encoding = width == 2 ? 'dbcs-cont' : 'sbcs-cont';\n\tvar msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n\tif(fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\tif(fExtSt) blob.l += cbExtRst; //TODO: parse this\n\tz.t = msg;\n\tif(!fRichSt) { z.raw = \"<t>\" + z.t + \"</t>\"; z.r = z.t; }\n\tcurrent_codepage = cp;\n\treturn z;\n}\nfunction write_XLUnicodeRichExtendedString(xlstr/*:: :XLString, opts*/) {\n\tvar str = (xlstr.t||\"\"), nfmts = 1;\n\n\tvar hdr = new_buf(3 + (nfmts > 1 ? 2 : 0));\n\thdr.write_shift(2, str.length);\n\thdr.write_shift(1, (nfmts > 1 ? 0x08 : 0x00) | 0x01);\n\tif(nfmts > 1) hdr.write_shift(2, nfmts);\n\n\tvar otext = new_buf(2 * str.length);\n\totext.write_shift(2 * str.length, str, 'utf16le');\n\n\tvar out = [hdr, otext];\n\n\treturn bconcat(out);\n}\n\n/* 2.5.296 XLUnicodeStringNoCch */\nfunction parse_XLUnicodeStringNoCch(blob, cch, opts) {\n\tvar retval;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'cpstr');\n\t\tif(opts.biff >= 12) return blob.read_shift(cch, 'dbcs-cont');\n\t}\n\tvar fHighByte = blob.read_shift(1);\n\tif(fHighByte===0) { retval = blob.read_shift(cch, 'sbcs-cont'); }\n\telse { retval = blob.read_shift(cch, 'dbcs-cont'); }\n\treturn retval;\n}\n\n/* 2.5.294 XLUnicodeString */\nfunction parse_XLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn parse_XLUnicodeStringNoCch(blob, cch, opts);\n}\n/* BIFF5 override */\nfunction parse_XLUnicodeString2(blob, length, opts) {\n\tif(opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, (opts.biff <= 4 || !blob.lens ) ? 'cpstr' : 'sbcs-cont');\n}\n/* TODO: BIFF5 and lower, codepage awareness */\nfunction write_XLUnicodeString(str, opts, o) {\n\tif(!o) o = new_buf(3 + 2 * str.length);\n\to.write_shift(2, str.length);\n\to.write_shift(1, 1);\n\to.write_shift(31, str, 'utf16le');\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.61 ControlInfo */\nfunction parse_ControlInfo(blob/*::, length, opts*/) {\n\tvar flags = blob.read_shift(1);\n\tblob.l++;\n\tvar accel = blob.read_shift(2);\n\tblob.l += 2;\n\treturn [flags, accel];\n}\n\n/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\nfunction parse_URLMoniker(blob/*::, length, opts*/) {\n\tvar len = blob.read_shift(4), start = blob.l;\n\tvar extra = false;\n\tif(len > 24) {\n\t\t/* look ahead */\n\t\tblob.l += len - 24;\n\t\tif(blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n\t\tblob.l = start;\n\t}\n\tvar url = blob.read_shift((extra?len-24:len)>>1, 'utf16le').replace(chr0,\"\");\n\tif(extra) blob.l += 24;\n\treturn url;\n}\n\n/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\nfunction parse_FileMoniker(blob/*::, length*/) {\n\tvar cAnti = blob.read_shift(2);\n\tvar preamble = \"\"; while(cAnti-- > 0) preamble += \"../\";\n\tvar ansiPath = blob.read_shift(0, 'lpstr-ansi');\n\tblob.l += 2; //var endServer = blob.read_shift(2);\n\tif(blob.read_shift(2) != 0xDEAD) throw new Error(\"Bad FileMoniker\");\n\tvar sz = blob.read_shift(4);\n\tif(sz === 0) return preamble + ansiPath.replace(/\\\\/g,\"/\");\n\tvar bytes = blob.read_shift(4);\n\tif(blob.read_shift(2) != 3) throw new Error(\"Bad FileMoniker\");\n\tvar unicodePath = blob.read_shift(bytes>>1, 'utf16le').replace(chr0,\"\");\n\treturn preamble + unicodePath;\n}\n\n/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\nfunction parse_HyperlinkMoniker(blob, length) {\n\tvar clsid = blob.read_shift(16); length -= 16;\n\tswitch(clsid) {\n\t\tcase \"e0c9ea79f9bace118c8200aa004ba90b\": return parse_URLMoniker(blob, length);\n\t\tcase \"0303000000000000c000000000000046\": return parse_FileMoniker(blob, length);\n\t\tdefault: throw new Error(\"Unsupported Moniker \" + clsid);\n\t}\n}\n\n/* [MS-OSHARED] 2.3.7.9 HyperlinkString */\nfunction parse_HyperlinkString(blob/*::, length*/) {\n\tvar len = blob.read_shift(4);\n\tvar o = len > 0 ? blob.read_shift(len, 'utf16le').replace(chr0, \"\") : \"\";\n\treturn o;\n}\nfunction write_HyperlinkString(str/*:string*/, o) {\n\tif(!o) o = new_buf(6 + str.length * 2);\n\to.write_shift(4, 1 + str.length);\n\tfor(var i = 0; i < str.length; ++i) o.write_shift(2, str.charCodeAt(i));\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-OSHARED] 2.3.7.1 Hyperlink Object */\nfunction parse_Hyperlink(blob, length)/*:Hyperlink*/ {\n\tvar end = blob.l + length;\n\tvar sVer = blob.read_shift(4);\n\tif(sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n\tvar flags = blob.read_shift(2);\n\tblob.l += 2;\n\tvar displayName, targetFrameName, moniker, oleMoniker, Loc=\"\", guid, fileTime;\n\tif(flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n\tif(flags & 0x0008) Loc = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0020) guid = blob.read_shift(16);\n\tif(flags & 0x0040) fileTime = parse_FILETIME(blob/*, 8*/);\n\tblob.l = end;\n\tvar target = targetFrameName||moniker||oleMoniker||\"\";\n\tif(target && Loc) target+=\"#\"+Loc;\n\tif(!target) target = \"#\" + Loc;\n\tif((flags & 0x0002) && target.charAt(0) == \"/\" && target.charAt(1) != \"/\") target = \"file://\" + target;\n\tvar out = ({Target:target}/*:any*/);\n\tif(guid) out.guid = guid;\n\tif(fileTime) out.time = fileTime;\n\tif(displayName) out.Tooltip = displayName;\n\treturn out;\n}\nfunction write_Hyperlink(hl) {\n\tvar out = new_buf(512), i = 0;\n\tvar Target = hl.Target;\n\tif(Target.slice(0,7) == \"file://\") Target = Target.slice(7);\n\tvar hashidx = Target.indexOf(\"#\");\n\tvar F = hashidx > -1 ? 0x1f : 0x17;\n\tswitch(Target.charAt(0)) { case \"#\": F=0x1c; break; case \".\": F&=~2; break; }\n\tout.write_shift(4,2); out.write_shift(4, F);\n\tvar data = [8,6815827,6619237,4849780,83]; for(i = 0; i < data.length; ++i) out.write_shift(4, data[i]);\n\tif(F == 0x1C) {\n\t\tTarget = Target.slice(1);\n\t\twrite_HyperlinkString(Target, out);\n\t} else if(F & 0x02) {\n\t\tdata = \"e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\t\tfor(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\t\tvar Pretarget = hashidx > -1 ? Target.slice(0, hashidx) : Target;\n\t\tout.write_shift(4, 2*(Pretarget.length + 1));\n\t\tfor(i = 0; i < Pretarget.length; ++i) out.write_shift(2, Pretarget.charCodeAt(i));\n\t\tout.write_shift(2, 0);\n\t\tif(F & 0x08) write_HyperlinkString(hashidx > -1 ? Target.slice(hashidx+1): \"\", out);\n\t} else {\n\t\tdata = \"03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46\".split(\" \");\n\t\tfor(i = 0; i < data.length; ++i) out.write_shift(1, parseInt(data[i], 16));\n\t\tvar P = 0;\n\t\twhile(Target.slice(P*3,P*3+3)==\"../\"||Target.slice(P*3,P*3+3)==\"..\\\\\") ++P;\n\t\tout.write_shift(2, P);\n\t\tout.write_shift(4, Target.length - 3 * P + 1);\n\t\tfor(i = 0; i < Target.length - 3 * P; ++i) out.write_shift(1, Target.charCodeAt(i + 3 * P) & 0xFF);\n\t\tout.write_shift(1, 0);\n\t\tout.write_shift(2, 0xFFFF);\n\t\tout.write_shift(2, 0xDEAD);\n\t\tfor(i = 0; i < 6; ++i) out.write_shift(4, 0);\n\t}\n\treturn out.slice(0, out.l);\n}\n\n/* 2.5.178 LongRGBA */\nfunction parse_LongRGBA(blob/*::, length*/) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r,g,b,a]; }\n\n/* 2.5.177 LongRGB */\nfunction parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }\n\n\n/* [MS-XLS] 2.5.19 */\nfunction parse_XLSCell(blob/*::, length*/)/*:Cell*/ {\n\tvar rw = blob.read_shift(2); // 0-indexed\n\tvar col = blob.read_shift(2);\n\tvar ixfe = blob.read_shift(2);\n\treturn ({r:rw, c:col, ixfe:ixfe}/*:any*/);\n}\nfunction write_XLSCell(R/*:number*/, C/*:number*/, ixfe/*:?number*/, o) {\n\tif(!o) o = new_buf(6);\n\to.write_shift(2, R);\n\to.write_shift(2, C);\n\to.write_shift(2, ixfe||0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.134 */\nfunction parse_frtHeader(blob) {\n\tvar rt = blob.read_shift(2);\n\tvar flags = blob.read_shift(2); // TODO: parse these flags\n\tblob.l += 8;\n\treturn {type: rt, flags: flags};\n}\n\n\n\nfunction parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts); }\n\n/* [MS-XLS] 2.5.344 */\nfunction parse_XTI(blob, length, opts) {\n\tvar w = opts.biff > 8 ? 4 : 2;\n\tvar iSupBook = blob.read_shift(w), itabFirst = blob.read_shift(w,'i'), itabLast = blob.read_shift(w,'i');\n\treturn [iSupBook, itabFirst, itabLast];\n}\n\n/* [MS-XLS] 2.5.218 */\nfunction parse_RkRec(blob) {\n\tvar ixfe = blob.read_shift(2);\n\tvar RK = parse_RkNumber(blob);\n\treturn [ixfe, RK];\n}\n\n/* [MS-XLS] 2.5.1 */\nfunction parse_AddinUdf(blob, length, opts) {\n\tblob.l += 4; length -= 4;\n\tvar l = blob.l + length;\n\tvar udfName = parse_ShortXLUnicodeString(blob, length, opts);\n\tvar cb = blob.read_shift(2);\n\tl -= blob.l;\n\tif(cb !== l) throw new Error(\"Malformed AddinUdf: padding = \" + l + \" != \" + cb);\n\tblob.l += cb;\n\treturn udfName;\n}\n\n/* [MS-XLS] 2.5.209 TODO: Check sizes */\nfunction parse_Ref8U(blob/*::, length*/) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(2);\n\tvar colLast = blob.read_shift(2);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\nfunction write_Ref8U(r/*:Range*/, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(2, r.s.r);\n\to.write_shift(2, r.e.r);\n\to.write_shift(2, r.s.c);\n\to.write_shift(2, r.e.c);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.211 */\nfunction parse_RefU(blob/*::, length*/) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(1);\n\tvar colLast = blob.read_shift(1);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\n\n/* [MS-XLS] 2.5.207 */\nvar parse_Ref = parse_RefU;\n\n/* [MS-XLS] 2.5.143 */\nfunction parse_FtCmo(blob/*::, length*/) {\n\tblob.l += 4;\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tblob.l+=12;\n\treturn [id, ot, flags];\n}\n\n/* [MS-XLS] 2.5.149 */\nfunction parse_FtNts(blob) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.l += 16; // GUID TODO\n\tout.fSharedNote = blob.read_shift(2);\n\tblob.l += 4;\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.142 */\nfunction parse_FtCf(blob) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.cf = blob.read_shift(2);\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.140 - 2.5.154 and friends */\nfunction parse_FtSkip(blob) { blob.l += 2; blob.l += blob.read_shift(2); }\nvar FtTab = {\n\t/*::[*/0x00/*::]*/: parse_FtSkip,      /* FtEnd */\n\t/*::[*/0x04/*::]*/: parse_FtSkip,      /* FtMacro */\n\t/*::[*/0x05/*::]*/: parse_FtSkip,      /* FtButton */\n\t/*::[*/0x06/*::]*/: parse_FtSkip,      /* FtGmo */\n\t/*::[*/0x07/*::]*/: parse_FtCf,        /* FtCf */\n\t/*::[*/0x08/*::]*/: parse_FtSkip,      /* FtPioGrbit */\n\t/*::[*/0x09/*::]*/: parse_FtSkip,      /* FtPictFmla */\n\t/*::[*/0x0A/*::]*/: parse_FtSkip,      /* FtCbls */\n\t/*::[*/0x0B/*::]*/: parse_FtSkip,      /* FtRbo */\n\t/*::[*/0x0C/*::]*/: parse_FtSkip,      /* FtSbs */\n\t/*::[*/0x0D/*::]*/: parse_FtNts,       /* FtNts */\n\t/*::[*/0x0E/*::]*/: parse_FtSkip,      /* FtSbsFmla */\n\t/*::[*/0x0F/*::]*/: parse_FtSkip,      /* FtGboData */\n\t/*::[*/0x10/*::]*/: parse_FtSkip,      /* FtEdoData */\n\t/*::[*/0x11/*::]*/: parse_FtSkip,      /* FtRboData */\n\t/*::[*/0x12/*::]*/: parse_FtSkip,      /* FtCblsData */\n\t/*::[*/0x13/*::]*/: parse_FtSkip,      /* FtLbsData */\n\t/*::[*/0x14/*::]*/: parse_FtSkip,      /* FtCblsFmla */\n\t/*::[*/0x15/*::]*/: parse_FtCmo\n};\nfunction parse_FtArray(blob, length/*::, ot*/) {\n\tvar tgt = blob.l + length;\n\tvar fts = [];\n\twhile(blob.l < tgt) {\n\t\tvar ft = blob.read_shift(2);\n\t\tblob.l-=2;\n\t\ttry {\n\t\t\tfts.push(FtTab[ft](blob, tgt - blob.l));\n\t\t} catch(e) { blob.l = tgt; return fts; }\n\t}\n\tif(blob.l != tgt) blob.l = tgt; //throw new Error(\"bad Object Ft-sequence\");\n\treturn fts;\n}\n\n/* --- 2.4 Records --- */\n\n/* [MS-XLS] 2.4.21 */\nfunction parse_BOF(blob, length) {\n\tvar o = {BIFFVer:0, dt:0};\n\to.BIFFVer = blob.read_shift(2); length -= 2;\n\tif(length >= 2) { o.dt = blob.read_shift(2); blob.l -= 2; }\n\tswitch(o.BIFFVer) {\n\t\tcase 0x0600: /* BIFF8 */\n\t\tcase 0x0500: /* BIFF5 */\n\t\tcase 0x0400: /* BIFF4 */\n\t\tcase 0x0300: /* BIFF3 */\n\t\tcase 0x0200: /* BIFF2 */\n\t\tcase 0x0002: case 0x0007: /* BIFF2 */\n\t\t\tbreak;\n\t\tdefault: if(length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\n\t}\n\n\tblob.read_shift(length);\n\treturn o;\n}\nfunction write_BOF(wb/*:Workbook*/, t/*:number*/, o) {\n\tvar h = 0x0600, w = 16;\n\tswitch(o.bookType) {\n\t\tcase 'biff8': break;\n\t\tcase 'biff5': h = 0x0500; w = 8; break;\n\t\tcase 'biff4': h = 0x0004; w = 6; break;\n\t\tcase 'biff3': h = 0x0003; w = 6; break;\n\t\tcase 'biff2': h = 0x0002; w = 4; break;\n\t\tcase 'xla': break;\n\t\tdefault: throw new Error(\"unsupported BIFF version\");\n\t}\n\tvar out = new_buf(w);\n\tout.write_shift(2, h);\n\tout.write_shift(2, t);\n\tif(w > 4) out.write_shift(2, 0x7262);\n\tif(w > 6) out.write_shift(2, 0x07CD);\n\tif(w > 8) {\n\t\tout.write_shift(2, 0xC009);\n\t\tout.write_shift(2, 0x0001);\n\t\tout.write_shift(2, 0x0706);\n\t\tout.write_shift(2, 0x0000);\n\t}\n\treturn out;\n}\n\n\n/* [MS-XLS] 2.4.146 */\nfunction parse_InterfaceHdr(blob, length) {\n\tif(length === 0) return 0x04b0;\n\tif((blob.read_shift(2))!==0x04b0){/* empty */}\n\treturn 0x04b0;\n}\n\n\n/* [MS-XLS] 2.4.349 */\nfunction parse_WriteAccess(blob, length, opts) {\n\tif(opts.enc) { blob.l += length; return \"\"; }\n\tvar l = blob.l;\n\t// TODO: make sure XLUnicodeString doesnt overrun\n\tvar UserName = parse_XLUnicodeString2(blob, 0, opts);\n\tblob.read_shift(length + l - blob.l);\n\treturn UserName;\n}\nfunction write_WriteAccess(s/*:string*/, opts) {\n\tvar b8 = !opts || opts.biff == 8;\n\tvar o = new_buf(b8 ? 112 : 54);\n\to.write_shift(opts.biff == 8 ? 2 : 1, 7);\n\tif(b8) o.write_shift(1, 0);\n\to.write_shift(4, 0x33336853);\n\to.write_shift(4, (0x00534A74 | (b8 ? 0 : 0x20000000)));\n\twhile(o.l < o.length) o.write_shift(1, (b8 ? 0 : 32));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.351 */\nfunction parse_WsBool(blob, length, opts) {\n\tvar flags = opts && opts.biff == 8 || length == 2 ? blob.read_shift(2) : (blob.l += length, 0);\n\treturn { fDialog: flags & 0x10, fBelow: flags & 0x40, fRight: flags & 0x80 };\n}\n\n/* [MS-XLS] 2.4.28 */\nfunction parse_BoundSheet8(blob, length, opts) {\n\tvar pos = blob.read_shift(4);\n\tvar hidden = blob.read_shift(1) & 0x03;\n\tvar dt = blob.read_shift(1);\n\tswitch(dt) {\n\t\tcase 0: dt = 'Worksheet'; break;\n\t\tcase 1: dt = 'Macrosheet'; break;\n\t\tcase 2: dt = 'Chartsheet'; break;\n\t\tcase 6: dt = 'VBAModule'; break;\n\t}\n\tvar name = parse_ShortXLUnicodeString(blob, 0, opts);\n\tif(name.length === 0) name = \"Sheet1\";\n\treturn { pos:pos, hs:hidden, dt:dt, name:name };\n}\nfunction write_BoundSheet8(data, opts) {\n\tvar w = (!opts || opts.biff >= 8 ? 2 : 1);\n\tvar o = new_buf(8 + w * data.name.length);\n\to.write_shift(4, data.pos);\n\to.write_shift(1, data.hs || 0);\n\to.write_shift(1, data.dt);\n\to.write_shift(1, data.name.length);\n\tif(opts.biff >= 8) o.write_shift(1, 1);\n\to.write_shift(w * data.name.length, data.name, opts.biff < 8 ? 'sbcs' : 'utf16le');\n\tvar out = o.slice(0, o.l);\n\tout.l = o.l; return out;\n}\n\n/* [MS-XLS] 2.4.265 TODO */\nfunction parse_SST(blob, length)/*:SST*/ {\n\tvar end = blob.l + length;\n\tvar cnt = blob.read_shift(4);\n\tvar ucnt = blob.read_shift(4);\n\tvar strs/*:SST*/ = ([]/*:any*/);\n\tfor(var i = 0; i != ucnt && blob.l < end; ++i) {\n\t\tstrs.push(parse_XLUnicodeRichExtendedString(blob));\n\t}\n\tstrs.Count = cnt; strs.Unique = ucnt;\n\treturn strs;\n}\nfunction write_SST(sst, opts) {\n\tvar header = new_buf(8);\n\theader.write_shift(4, sst.Count);\n\theader.write_shift(4, sst.Unique);\n\tvar strs = [];\n\tfor(var j = 0; j < sst.length; ++j) strs[j] = write_XLUnicodeRichExtendedString(sst[j], opts);\n\tvar o = bconcat([header].concat(strs));\n\t/*::(*/o/*:: :any)*/.parts = [header.length].concat(strs.map(function(str) { return str.length; }));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.107 */\nfunction parse_ExtSST(blob, length) {\n\tvar extsst = {};\n\textsst.dsst = blob.read_shift(2);\n\tblob.l += length-2;\n\treturn extsst;\n}\n\n\n/* [MS-XLS] 2.4.221 TODO: check BIFF2-4 */\nfunction parse_Row(blob) {\n\tvar z = ({}/*:any*/);\n\tz.r = blob.read_shift(2);\n\tz.c = blob.read_shift(2);\n\tz.cnt = blob.read_shift(2) - z.c;\n\tvar miyRw = blob.read_shift(2);\n\tblob.l += 4; // reserved(2), unused(2)\n\tvar flags = blob.read_shift(1); // various flags\n\tblob.l += 3; // reserved(8), ixfe(12), flags(4)\n\tif(flags & 0x07) z.level = flags & 0x07;\n\t// collapsed: flags & 0x10\n\tif(flags & 0x20) z.hidden = true;\n\tif(flags & 0x40) z.hpt = miyRw / 20;\n\treturn z;\n}\n\n\n/* [MS-XLS] 2.4.125 */\nfunction parse_ForceFullCalculation(blob) {\n\tvar header = parse_frtHeader(blob);\n\tif(header.type != 0x08A3) throw new Error(\"Invalid Future Record \" + header.type);\n\tvar fullcalc = blob.read_shift(4);\n\treturn fullcalc !== 0x0;\n}\n\n\n\n\n\n/* [MS-XLS] 2.4.215 rt */\nfunction parse_RecalcId(blob) {\n\tblob.read_shift(2);\n\treturn blob.read_shift(4);\n}\n\n/* [MS-XLS] 2.4.87 */\nfunction parse_DefaultRowHeight(blob, length, opts) {\n\tvar f = 0;\n\tif(!(opts && opts.biff == 2)) {\n\t\tf = blob.read_shift(2);\n\t}\n\tvar miyRw = blob.read_shift(2);\n\tif((opts && opts.biff == 2)) {\n\t\tf = 1 - (miyRw >> 15); miyRw &= 0x7fff;\n\t}\n\tvar fl = {Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};\n\treturn [fl, miyRw];\n}\n\n/* [MS-XLS] 2.4.345 TODO */\nfunction parse_Window1(blob) {\n\tvar xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);\n\tvar ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);\n\treturn { Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,\n\t\tFirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio };\n}\nfunction write_Window1(/*::opts*/) {\n\tvar o = new_buf(18);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0x7260);\n\to.write_shift(2, 0x44c0);\n\to.write_shift(2, 0x38);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 1);\n\to.write_shift(2, 0x01f4);\n\treturn o;\n}\n/* [MS-XLS] 2.4.346 TODO */\nfunction parse_Window2(blob, length, opts) {\n\tif(opts && opts.biff >= 2 && opts.biff < 5) return {};\n\tvar f = blob.read_shift(2);\n\treturn { RTL: f & 0x40 };\n}\nfunction write_Window2(view) {\n\tvar o = new_buf(18), f = 0x6b6;\n\tif(view && view.RTL) f |= 0x40;\n\to.write_shift(2, f);\n\to.write_shift(4, 0);\n\to.write_shift(4, 64);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.189 TODO */\nfunction parse_Pane(/*blob, length, opts*/) {\n}\n\n/* [MS-XLS] 2.4.122 TODO */\nfunction parse_Font(blob, length, opts) {\n\tvar o/*:any*/ = {\n\t\tdyHeight: blob.read_shift(2),\n\t\tfl: blob.read_shift(2)\n\t};\n\tswitch((opts && opts.biff) || 8) {\n\t\tcase 2: break;\n\t\tcase 3: case 4: blob.l += 2; break;\n\t\tdefault: blob.l += 10; break;\n\t}\n\to.name = parse_ShortXLUnicodeString(blob, 0, opts);\n\treturn o;\n}\nfunction write_Font(data, opts) {\n\tvar name = data.name || \"Arial\";\n\tvar b5 = (opts && (opts.biff == 5)), w = (b5 ? (15 + name.length) : (16 + 2 * name.length));\n\tvar o = new_buf(w);\n\to.write_shift(2, (data.sz || 12) * 20);\n\to.write_shift(4, 0);\n\to.write_shift(2, 400);\n\to.write_shift(4, 0);\n\to.write_shift(2, 0);\n\to.write_shift(1, name.length);\n\tif(!b5) o.write_shift(1, 1);\n\to.write_shift((b5 ? 1 : 2) * name.length, name, (b5 ? \"sbcs\" : \"utf16le\"));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.149 */\nfunction parse_LabelSst(blob) {\n\tvar cell = parse_XLSCell(blob);\n\tcell.isst = blob.read_shift(4);\n\treturn cell;\n}\nfunction write_LabelSst(R/*:number*/, C/*:number*/, v/*:number*/, os/*:number*/ /*::, opts*/) {\n\tvar o = new_buf(10);\n\twrite_XLSCell(R, C, os, o);\n\to.write_shift(4, v);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.148 */\nfunction parse_Label(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 2) opts.biff = 5;\n\tvar target = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6);\n\tif(opts.biff == 2) blob.l++;\n\tvar str = parse_XLUnicodeString(blob, target - blob.l, opts);\n\tcell.val = str;\n\treturn cell;\n}\nfunction write_Label(R/*:number*/, C/*:number*/, v/*:string*/, os/*:number*/, opts) {\n\tvar b8 = !opts || opts.biff == 8;\n\tvar o = new_buf(6 + 2 + (+b8) + (1 + b8) * v.length);\n\twrite_XLSCell(R, C, os, o);\n\to.write_shift(2, v.length);\n\tif(b8) o.write_shift(1, 1);\n\to.write_shift((1 + b8) * v.length, v, b8 ? 'utf16le' : 'sbcs');\n\treturn o;\n}\n\n\n/* [MS-XLS] 2.4.126 Number Formats */\nfunction parse_Format(blob, length, opts) {\n\tvar numFmtId = blob.read_shift(2);\n\tvar fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n\treturn [numFmtId, fmtstr];\n}\nfunction write_Format(i/*:number*/, f/*:string*/, opts, o) {\n\tvar b5 = (opts && (opts.biff == 5));\n\tif(!o) o = new_buf(b5 ? (3 + f.length) : (5 + 2 * f.length));\n\to.write_shift(2, i);\n\to.write_shift((b5 ? 1 : 2), f.length);\n\tif(!b5) o.write_shift(1, 1);\n\to.write_shift((b5 ? 1 : 2) * f.length, f, (b5 ? 'sbcs' : 'utf16le'));\n\tvar out = (o.length > o.l) ? o.slice(0, o.l) : o;\n\tif(out.l == null) out.l = out.length;\n\treturn out;\n}\nvar parse_BIFF2Format = parse_XLUnicodeString2;\n\n/* [MS-XLS] 2.4.90 */\nfunction parse_Dimensions(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar w = opts.biff == 8 || !opts.biff ? 4 : 2;\n\tvar r = blob.read_shift(w), R = blob.read_shift(w);\n\tvar c = blob.read_shift(2), C = blob.read_shift(2);\n\tblob.l = end;\n\treturn {s: {r:r, c:c}, e: {r:R, c:C}};\n}\nfunction write_Dimensions(range, opts) {\n\tvar w = opts.biff == 8 || !opts.biff ? 4 : 2;\n\tvar o = new_buf(2*w + 6);\n\to.write_shift(w, range.s.r);\n\to.write_shift(w, range.e.r + 1);\n\to.write_shift(2, range.s.c);\n\to.write_shift(2, range.e.c + 1);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.220 */\nfunction parse_RK(blob) {\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrec = parse_RkRec(blob);\n\treturn {r:rw, c:col, ixfe:rkrec[0], rknum:rkrec[1]};\n}\n\n/* [MS-XLS] 2.4.175 */\nfunction parse_MulRk(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrecs = [];\n\twhile(blob.l < target) rkrecs.push(parse_RkRec(blob));\n\tif(blob.l !== target) throw new Error(\"MulRK read error\");\n\tvar lastcol = blob.read_shift(2);\n\tif(rkrecs.length != lastcol - col + 1) throw new Error(\"MulRK length mismatch\");\n\treturn {r:rw, c:col, C:lastcol, rkrec:rkrecs};\n}\n/* [MS-XLS] 2.4.174 */\nfunction parse_MulBlank(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar ixfes = [];\n\twhile(blob.l < target) ixfes.push(blob.read_shift(2));\n\tif(blob.l !== target) throw new Error(\"MulBlank read error\");\n\tvar lastcol = blob.read_shift(2);\n\tif(ixfes.length != lastcol - col + 1) throw new Error(\"MulBlank length mismatch\");\n\treturn {r:rw, c:col, C:lastcol, ixfe:ixfes};\n}\n\n/* [MS-XLS] 2.5.20 2.5.249 TODO: interpret values here */\nfunction parse_CellStyleXF(blob, length, style, opts) {\n\tvar o = {};\n\tvar a = blob.read_shift(4), b = blob.read_shift(4);\n\tvar c = blob.read_shift(4), d = blob.read_shift(2);\n\to.patternType = XLSFillPattern[c >> 26];\n\n\tif(!opts.cellStyles) return o;\n\to.alc = a & 0x07;\n\to.fWrap = (a >> 3) & 0x01;\n\to.alcV = (a >> 4) & 0x07;\n\to.fJustLast = (a >> 7) & 0x01;\n\to.trot = (a >> 8) & 0xFF;\n\to.cIndent = (a >> 16) & 0x0F;\n\to.fShrinkToFit = (a >> 20) & 0x01;\n\to.iReadOrder = (a >> 22) & 0x02;\n\to.fAtrNum = (a >> 26) & 0x01;\n\to.fAtrFnt = (a >> 27) & 0x01;\n\to.fAtrAlc = (a >> 28) & 0x01;\n\to.fAtrBdr = (a >> 29) & 0x01;\n\to.fAtrPat = (a >> 30) & 0x01;\n\to.fAtrProt = (a >> 31) & 0x01;\n\n\to.dgLeft = b & 0x0F;\n\to.dgRight = (b >> 4) & 0x0F;\n\to.dgTop = (b >> 8) & 0x0F;\n\to.dgBottom = (b >> 12) & 0x0F;\n\to.icvLeft = (b >> 16) & 0x7F;\n\to.icvRight = (b >> 23) & 0x7F;\n\to.grbitDiag = (b >> 30) & 0x03;\n\n\to.icvTop = c & 0x7F;\n\to.icvBottom = (c >> 7) & 0x7F;\n\to.icvDiag = (c >> 14) & 0x7F;\n\to.dgDiag = (c >> 21) & 0x0F;\n\n\to.icvFore = d & 0x7F;\n\to.icvBack = (d >> 7) & 0x7F;\n\to.fsxButton = (d >> 14) & 0x01;\n\treturn o;\n}\n//function parse_CellXF(blob, length, opts) {return parse_CellStyleXF(blob,length,0, opts);}\n//function parse_StyleXF(blob, length, opts) {return parse_CellStyleXF(blob,length,1, opts);}\n\n/* [MS-XLS] 2.4.353 TODO: actually do this right */\nfunction parse_XF(blob, length, opts) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(2); o.numFmtId = blob.read_shift(2); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\tlength -= 6;\n\to.data = parse_CellStyleXF(blob, length, o.fStyle, opts);\n\treturn o;\n}\nfunction write_XF(data, ixfeP, opts, o) {\n\tvar b5 = (opts && (opts.biff == 5));\n\tif(!o) o = new_buf(b5 ? 16 : 20);\n\to.write_shift(2, 0);\n\tif(data.style) {\n\t\to.write_shift(2, (data.numFmtId||0));\n\t\to.write_shift(2, 0xFFF4);\n\t} else {\n\t\to.write_shift(2, (data.numFmtId||0));\n\t\to.write_shift(2, (ixfeP<<4));\n\t}\n\tvar f = 0;\n\tif(data.numFmtId > 0 && b5) f |= 0x0400;\n\to.write_shift(4, f);\n\to.write_shift(4, 0);\n\tif(!b5) o.write_shift(4, 0);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.134 */\nfunction parse_Guts(blob) {\n\tblob.l += 4;\n\tvar out = [blob.read_shift(2), blob.read_shift(2)];\n\tif(out[0] !== 0) out[0]--;\n\tif(out[1] !== 0) out[1]--;\n\tif(out[0] > 7 || out[1] > 7) throw new Error(\"Bad Gutters: \" + out.join(\"|\"));\n\treturn out;\n}\nfunction write_Guts(guts/*:Array<number>*/) {\n\tvar o = new_buf(8);\n\to.write_shift(4, 0);\n\to.write_shift(2, guts[0] ? guts[0] + 1 : 0);\n\to.write_shift(2, guts[1] ? guts[1] + 1 : 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.24 */\nfunction parse_BoolErr(blob, length, opts) {\n\tvar cell = parse_XLSCell(blob, 6);\n\tif(opts.biff == 2 || length == 9) ++blob.l;\n\tvar val = parse_Bes(blob, 2);\n\tcell.val = val;\n\tcell.t = (val === true || val === false) ? 'b' : 'e';\n\treturn cell;\n}\nfunction write_BoolErr(R/*:number*/, C/*:number*/, v, os/*:number*/, opts, t/*:string*/) {\n\tvar o = new_buf(8);\n\twrite_XLSCell(R, C, os, o);\n\twrite_Bes(v, t, o);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.180 Number */\nfunction parse_Number(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 2) opts.biff = 5;\n\tvar cell = parse_XLSCell(blob, 6);\n\tvar xnum = parse_Xnum(blob, 8);\n\tcell.val = xnum;\n\treturn cell;\n}\nfunction write_Number(R/*:number*/, C/*:number*/, v, os/*:: :number, opts*/) {\n\tvar o = new_buf(14);\n\twrite_XLSCell(R, C, os, o);\n\twrite_Xnum(v, o);\n\treturn o;\n}\n\nvar parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n/* [MS-XLS] 2.4.271 */\nfunction parse_SupBook(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar ctab = blob.read_shift(2);\n\tvar cch = blob.read_shift(2);\n\topts.sbcch = cch;\n\tif(cch == 0x0401 || cch == 0x3A01) return [cch, ctab];\n\tif(cch < 0x01 || cch >0xff) throw new Error(\"Unexpected SupBook type: \"+cch);\n\tvar virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n\t/* TODO: 2.5.277 Virtual Path */\n\tvar rgst = [];\n\twhile(end > blob.l) rgst.push(parse_XLUnicodeString(blob));\n\treturn [cch, ctab, virtPath, rgst];\n}\n\n/* [MS-XLS] 2.4.105 TODO */\nfunction parse_ExternName(blob, length, opts) {\n\tvar flags = blob.read_shift(2);\n\tvar body;\n\tvar o = ({\n\t\tfBuiltIn: flags & 0x01,\n\t\tfWantAdvise: (flags >>> 1) & 0x01,\n\t\tfWantPict: (flags >>> 2) & 0x01,\n\t\tfOle: (flags >>> 3) & 0x01,\n\t\tfOleLink: (flags >>> 4) & 0x01,\n\t\tcf: (flags >>> 5) & 0x3FF,\n\t\tfIcon: flags >>> 15 & 0x01\n\t}/*:any*/);\n\tif(opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length-2, opts);\n\t//else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\to.body = body || blob.read_shift(length-2);\n\tif(typeof body === \"string\") o.Name = body;\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.150 TODO */\nvar XLSLblBuiltIn = [\n\t\"_xlnm.Consolidate_Area\",\n\t\"_xlnm.Auto_Open\",\n\t\"_xlnm.Auto_Close\",\n\t\"_xlnm.Extract\",\n\t\"_xlnm.Database\",\n\t\"_xlnm.Criteria\",\n\t\"_xlnm.Print_Area\",\n\t\"_xlnm.Print_Titles\",\n\t\"_xlnm.Recorder\",\n\t\"_xlnm.Data_Form\",\n\t\"_xlnm.Auto_Activate\",\n\t\"_xlnm.Auto_Deactivate\",\n\t\"_xlnm.Sheet_Title\",\n\t\"_xlnm._FilterDatabase\"\n];\nfunction parse_Lbl(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar flags = blob.read_shift(2);\n\tvar chKey = blob.read_shift(1);\n\tvar cch = blob.read_shift(1);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tvar itab = 0;\n\tif(!opts || opts.biff >= 5) {\n\t\tif(opts.biff != 5) blob.l += 2;\n\t\titab = blob.read_shift(2);\n\t\tif(opts.biff == 5) blob.l += 2;\n\t\tblob.l += 4;\n\t}\n\tvar name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tif(flags & 0x20) name = XLSLblBuiltIn[name.charCodeAt(0)];\n\tvar npflen = target - blob.l; if(opts && opts.biff == 2) --npflen;\n\t/*jshint -W018 */\n\tvar rgce = (target == blob.l || cce === 0 || !(npflen > 0)) ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\n\t/*jshint +W018 */\n\treturn {\n\t\tchKey: chKey,\n\t\tName: name,\n\t\titab: itab,\n\t\trgce: rgce\n\t};\n}\n\n/* [MS-XLS] 2.4.106 TODO: verify filename encoding */\nfunction parse_ExternSheet(blob, length, opts) {\n\tif(opts.biff < 8) return parse_BIFF5ExternSheet(blob, length, opts);\n\tvar o = [], target = blob.l + length, len = blob.read_shift(opts.biff > 8 ? 4 : 2);\n\twhile(len-- !== 0) o.push(parse_XTI(blob, opts.biff > 8 ? 12 : 6, opts));\n\t\t// [iSupBook, itabFirst, itabLast];\n\tif(blob.l != target) throw new Error(\"Bad ExternSheet: \" + blob.l + \" != \" + target);\n\treturn o;\n}\nfunction parse_BIFF5ExternSheet(blob, length, opts) {\n\tif(blob[blob.l + 1] == 0x03) blob[blob.l]++;\n\tvar o = parse_ShortXLUnicodeString(blob, length, opts);\n\treturn o.charCodeAt(0) == 0x03 ? o.slice(1) : o;\n}\n\n/* [MS-XLS] 2.4.176 TODO: check older biff */\nfunction parse_NameCmt(blob, length, opts) {\n\tif(opts.biff < 8) { blob.l += length; return; }\n\tvar cchName = blob.read_shift(2);\n\tvar cchComment = blob.read_shift(2);\n\tvar name = parse_XLUnicodeStringNoCch(blob, cchName, opts);\n\tvar comment = parse_XLUnicodeStringNoCch(blob, cchComment, opts);\n\treturn [name, comment];\n}\n\n/* [MS-XLS] 2.4.260 */\nfunction parse_ShrFmla(blob, length, opts) {\n\tvar ref = parse_RefU(blob, 6);\n\tblob.l++;\n\tvar cUse = blob.read_shift(1);\n\tlength -= 8;\n\treturn [parse_SharedParsedFormula(blob, length, opts), cUse, ref];\n}\n\n/* [MS-XLS] 2.4.4 TODO */\nfunction parse_Array(blob, length, opts) {\n\tvar ref = parse_Ref(blob, 6);\n\t/* TODO: fAlwaysCalc */\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l ++; length -= 7; break;\n\t\tcase 3: case 4: blob.l += 2; length -= 8; break;\n\t\tdefault: blob.l += 6; length -= 12;\n\t}\n\treturn [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n}\n\n/* [MS-XLS] 2.4.173 */\nfunction parse_MTRSettings(blob) {\n\tvar fMTREnabled = blob.read_shift(4) !== 0x00;\n\tvar fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n\tvar cUserThreadCount = blob.read_shift(4);\n\treturn [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n}\n\n/* [MS-XLS] 2.5.186 TODO: BIFF5 */\nfunction parse_NoteSh(blob, length, opts) {\n\tif(opts.biff < 8) return;\n\tvar row = blob.read_shift(2), col = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), idObj = blob.read_shift(2);\n\tvar stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n\tif(opts.biff < 8) blob.read_shift(1);\n\treturn [{r:row,c:col}, stAuthor, idObj, flags];\n}\n\n/* [MS-XLS] 2.4.179 */\nfunction parse_Note(blob, length, opts) {\n\t/* TODO: Support revisions */\n\treturn parse_NoteSh(blob, length, opts);\n}\n\n/* [MS-XLS] 2.4.168 */\nfunction parse_MergeCells(blob, length)/*:Array<Range>*/ {\n\tvar merges/*:Array<Range>*/ = [];\n\tvar cmcs = blob.read_shift(2);\n\twhile (cmcs--) merges.push(parse_Ref8U(blob,length));\n\treturn merges;\n}\nfunction write_MergeCells(merges/*:Array<Range>*/) {\n\tvar o = new_buf(2 + merges.length * 8);\n\to.write_shift(2, merges.length);\n\tfor(var i = 0; i < merges.length; ++i) write_Ref8U(merges[i], o);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.181 TODO: parse all the things! */\nfunction parse_Obj(blob, length, opts) {\n\tif(opts && opts.biff < 8) return parse_BIFF5Obj(blob, length, opts);\n\tvar cmo = parse_FtCmo(blob, 22); // id, ot, flags\n\tvar fts = parse_FtArray(blob, length-22, cmo[1]);\n\treturn { cmo: cmo, ft:fts };\n}\n/* from older spec */\nvar parse_BIFF5OT = {\n0x08: function(blob, length) {\n\tvar tgt = blob.l + length;\n\tblob.l += 10; // todo\n\tvar cf = blob.read_shift(2);\n\tblob.l += 4;\n\tblob.l += 2; //var cbPictFmla = blob.read_shift(2);\n\tblob.l += 2;\n\tblob.l += 2; //var grbit = blob.read_shift(2);\n\tblob.l += 4;\n\tvar cchName = blob.read_shift(1);\n\tblob.l += cchName; // TODO: stName\n\tblob.l = tgt; // TODO: fmla\n\treturn { fmt:cf };\n}\n};\n\nfunction parse_BIFF5Obj(blob, length, opts) {\n\tblob.l += 4; //var cnt = blob.read_shift(4);\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar grbit = blob.read_shift(2);\n\tblob.l += 2; //var colL = blob.read_shift(2);\n\tblob.l += 2; //var dxL = blob.read_shift(2);\n\tblob.l += 2; //var rwT = blob.read_shift(2);\n\tblob.l += 2; //var dyT = blob.read_shift(2);\n\tblob.l += 2; //var colR = blob.read_shift(2);\n\tblob.l += 2; //var dxR = blob.read_shift(2);\n\tblob.l += 2; //var rwB = blob.read_shift(2);\n\tblob.l += 2; //var dyB = blob.read_shift(2);\n\tblob.l += 2; //var cbMacro = blob.read_shift(2);\n\tblob.l += 6;\n\tlength -= 36;\n\tvar fts = [];\n\tfts.push((parse_BIFF5OT[ot]||parsenoop)(blob, length, opts));\n\treturn { cmo: [id, ot, grbit], ft:fts };\n}\n\n/* [MS-XLS] 2.4.329 TODO: parse properly */\nfunction parse_TxO(blob, length, opts) {\n\tvar s = blob.l;\n\tvar texts = \"\";\ntry {\n\tblob.l += 4;\n\tvar ot = (opts.lastobj||{cmo:[0,0]}).cmo[1];\n\tvar controlInfo; // eslint-disable-line no-unused-vars\n\tif([0,5,7,11,12,14].indexOf(ot) == -1) blob.l += 6;\n\telse controlInfo = parse_ControlInfo(blob, 6, opts); // eslint-disable-line no-unused-vars\n\tvar cchText = blob.read_shift(2);\n\t/*var cbRuns = */blob.read_shift(2);\n\t/*var ifntEmpty = */parseuint16(blob, 2);\n\tvar len = blob.read_shift(2);\n\tblob.l += len;\n\t//var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n\tfor(var i = 1; i < blob.lens.length-1; ++i) {\n\t\tif(blob.l-s != blob.lens[i]) throw new Error(\"TxO: bad continue record\");\n\t\tvar hdr = blob[blob.l];\n\t\tvar t = parse_XLUnicodeStringNoCch(blob, blob.lens[i+1]-blob.lens[i]-1);\n\t\ttexts += t;\n\t\tif(texts.length >= (hdr ? cchText : 2*cchText)) break;\n\t}\n\tif(texts.length !== cchText && texts.length !== cchText*2) {\n\t\tthrow new Error(\"cchText: \" + cchText + \" != \" + texts.length);\n\t}\n\n\tblob.l = s + length;\n\t/* [MS-XLS] 2.5.272 TxORuns */\n//\tvar rgTxoRuns = [];\n//\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n//\tvar cchText2 = blob.read_shift(2);\n//\tif(cchText2 !== cchText) throw new Error(\"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText);\n//\tblob.l += 6;\n//\tif(s + length != blob.l) throw new Error(\"TxO \" + (s + length) + \", at \" + blob.l);\n\treturn { t: texts };\n} catch(e) { blob.l = s + length; return { t: texts }; }\n}\n\n/* [MS-XLS] 2.4.140 */\nfunction parse_HLink(blob, length) {\n\tvar ref = parse_Ref8U(blob, 8);\n\tblob.l += 16; /* CLSID */\n\tvar hlink = parse_Hyperlink(blob, length-24);\n\treturn [ref, hlink];\n}\nfunction write_HLink(hl) {\n\tvar O = new_buf(24);\n\tvar ref = decode_cell(hl[0]);\n\tO.write_shift(2, ref.r); O.write_shift(2, ref.r);\n\tO.write_shift(2, ref.c); O.write_shift(2, ref.c);\n\tvar clsid = \"d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b\".split(\" \");\n\tfor(var i = 0; i < 16; ++i) O.write_shift(1, parseInt(clsid[i], 16));\n\treturn bconcat([O, write_Hyperlink(hl[1])]);\n}\n\n\n/* [MS-XLS] 2.4.141 */\nfunction parse_HLinkTooltip(blob, length) {\n\tblob.read_shift(2);\n\tvar ref = parse_Ref8U(blob, 8);\n\tvar wzTooltip = blob.read_shift((length-10)/2, 'dbcs-cont');\n\twzTooltip = wzTooltip.replace(chr0,\"\");\n\treturn [ref, wzTooltip];\n}\nfunction write_HLinkTooltip(hl) {\n\tvar TT = hl[1].Tooltip;\n\tvar O = new_buf(10 + 2 * (TT.length + 1));\n\tO.write_shift(2, 0x0800);\n\tvar ref = decode_cell(hl[0]);\n\tO.write_shift(2, ref.r); O.write_shift(2, ref.r);\n\tO.write_shift(2, ref.c); O.write_shift(2, ref.c);\n\tfor(var i = 0; i < TT.length; ++i) O.write_shift(2, TT.charCodeAt(i));\n\tO.write_shift(2, 0);\n\treturn O;\n}\n\n/* [MS-XLS] 2.4.63 */\nfunction parse_Country(blob)/*:[string|number, string|number]*/ {\n\tvar o = [0,0], d;\n\td = blob.read_shift(2); o[0] = CountryEnum[d] || d;\n\td = blob.read_shift(2); o[1] = CountryEnum[d] || d;\n\treturn o;\n}\nfunction write_Country(o) {\n\tif(!o) o = new_buf(4);\n\to.write_shift(2, 0x01);\n\to.write_shift(2, 0x01);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.50 ClrtClient */\nfunction parse_ClrtClient(blob) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.188 */\nfunction parse_Palette(blob) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.354 */\nfunction parse_XFCRC(blob) {\n\tblob.l += 2;\n\tvar o = {cxfs:0, crc:0};\n\to.cxfs = blob.read_shift(2);\n\to.crc = blob.read_shift(4);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.53 TODO: parse flags */\n/* [MS-XLSB] 2.4.323 TODO: parse flags */\nfunction parse_ColInfo(blob, length, opts) {\n\tif(!opts.cellStyles) return parsenoop(blob, length);\n\tvar w = opts && opts.biff >= 12 ? 4 : 2;\n\tvar colFirst = blob.read_shift(w);\n\tvar colLast = blob.read_shift(w);\n\tvar coldx = blob.read_shift(w);\n\tvar ixfe = blob.read_shift(w);\n\tvar flags = blob.read_shift(2);\n\tif(w == 2) blob.l += 2;\n\tvar o = ({s:colFirst, e:colLast, w:coldx, ixfe:ixfe, flags:flags}/*:any*/);\n\tif(opts.biff >= 5 || !opts.biff) o.level = (flags >> 8) & 0x7;\n\treturn o;\n}\nfunction write_ColInfo(col, idx) {\n\tvar o = new_buf(12);\n\to.write_shift(2, idx);\n\to.write_shift(2, idx);\n\to.write_shift(2, col.width * 256);\n\to.write_shift(2, 0);\n\tvar f = 0;\n\tif(col.hidden) f |= 1;\n\to.write_shift(1, f);\n\tf = col.level || 0;\n\to.write_shift(1, f);\n\to.write_shift(2, 0);\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.257 */\nfunction parse_Setup(blob, length) {\n\tvar o = {};\n\tif(length < 32) return o;\n\tblob.l += 16;\n\to.header = parse_Xnum(blob, 8);\n\to.footer = parse_Xnum(blob, 8);\n\tblob.l += 2;\n\treturn o;\n}\n\n/* [MS-XLS] 2.4.261 */\nfunction parse_ShtProps(blob, length, opts) {\n\tvar def = {area:false};\n\tif(opts.biff != 5) { blob.l += length; return def; }\n\tvar d = blob.read_shift(1); blob.l += 3;\n\tif((d & 0x10)) def.area = true;\n\treturn def;\n}\n\n/* [MS-XLS] 2.4.241 */\nfunction write_RRTabId(n/*:number*/) {\n\tvar out = new_buf(2 * n);\n\tfor(var i = 0; i < n; ++i) out.write_shift(2, i+1);\n\treturn out;\n}\n\nvar parse_Blank = parse_XLSCell; /* [MS-XLS] 2.4.20 Just the cell */\nvar parse_Scl = parseuint16a; /* [MS-XLS] 2.4.247 num, den */\nvar parse_String = parse_XLUnicodeString; /* [MS-XLS] 2.4.268 */\n\n/* --- Specific to versions before BIFF8 --- */\nfunction parse_ImData(blob) {\n\tvar cf = blob.read_shift(2);\n\tvar env = blob.read_shift(2);\n\tvar lcb = blob.read_shift(4);\n\tvar o = {fmt:cf, env:env, len:lcb, data:blob.slice(blob.l,blob.l+lcb)};\n\tblob.l += lcb;\n\treturn o;\n}\n\n/* BIFF2_??? where ??? is the name from [XLS] */\nfunction parse_BIFF2STR(blob, length, opts) {\n\tif(opts.biffguess && opts.biff == 5) opts.biff = 2;\n\tvar cell = parse_XLSCell(blob, 6);\n\t++blob.l;\n\tvar str = parse_XLUnicodeString2(blob, length-7, opts);\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\n\nfunction parse_BIFF2NUM(blob/*::, length*/) {\n\tvar cell = parse_XLSCell(blob, 6);\n\t++blob.l;\n\tvar num = parse_Xnum(blob, 8);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\nfunction write_BIFF2NUM(r/*:number*/, c/*:number*/, val/*:number*/) {\n\tvar out = new_buf(15);\n\twrite_BIFF2Cell(out, r, c);\n\tout.write_shift(8, val, 'f');\n\treturn out;\n}\n\nfunction parse_BIFF2INT(blob) {\n\tvar cell = parse_XLSCell(blob, 6);\n\t++blob.l;\n\tvar num = blob.read_shift(2);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\nfunction write_BIFF2INT(r/*:number*/, c/*:number*/, val/*:number*/) {\n\tvar out = new_buf(9);\n\twrite_BIFF2Cell(out, r, c);\n\tout.write_shift(2, val);\n\treturn out;\n}\n\nfunction parse_BIFF2STRING(blob) {\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, 'sbcs-cont');\n}\n\n/* TODO: convert to BIFF8 font struct */\nfunction parse_BIFF2FONTXTRA(blob, length) {\n\tblob.l += 6; // unknown\n\tblob.l += 2; // font weight \"bls\"\n\tblob.l += 1; // charset\n\tblob.l += 3; // unknown\n\tblob.l += 1; // font family\n\tblob.l += length - 13;\n}\n\n/* TODO: parse rich text runs */\nfunction parse_RString(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6);\n\tvar cch = blob.read_shift(2);\n\tvar str = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tblob.l = end;\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\n/* from js-harb (C) 2014-present  SheetJS */\nvar DBF_SUPPORTED_VERSIONS = [0x02, 0x03, 0x30, 0x31, 0x83, 0x8B, 0x8C, 0xF5];\nvar DBF = /*#__PURE__*/(function() {\nvar dbf_codepage_map = {\n\t/* Code Pages Supported by Visual FoxPro */\n\t/*::[*/0x01/*::]*/:   437,           /*::[*/0x02/*::]*/:   850,\n\t/*::[*/0x03/*::]*/:  1252,           /*::[*/0x04/*::]*/: 10000,\n\t/*::[*/0x64/*::]*/:   852,           /*::[*/0x65/*::]*/:   866,\n\t/*::[*/0x66/*::]*/:   865,           /*::[*/0x67/*::]*/:   861,\n\t/*::[*/0x68/*::]*/:   895,           /*::[*/0x69/*::]*/:   620,\n\t/*::[*/0x6A/*::]*/:   737,           /*::[*/0x6B/*::]*/:   857,\n\t/*::[*/0x78/*::]*/:   950,           /*::[*/0x79/*::]*/:   949,\n\t/*::[*/0x7A/*::]*/:   936,           /*::[*/0x7B/*::]*/:   932,\n\t/*::[*/0x7C/*::]*/:   874,           /*::[*/0x7D/*::]*/:  1255,\n\t/*::[*/0x7E/*::]*/:  1256,           /*::[*/0x96/*::]*/: 10007,\n\t/*::[*/0x97/*::]*/: 10029,           /*::[*/0x98/*::]*/: 10006,\n\t/*::[*/0xC8/*::]*/:  1250,           /*::[*/0xC9/*::]*/:  1251,\n\t/*::[*/0xCA/*::]*/:  1254,           /*::[*/0xCB/*::]*/:  1253,\n\n\t/* shapefile DBF extension */\n\t/*::[*/0x00/*::]*/: 20127,           /*::[*/0x08/*::]*/:   865,\n\t/*::[*/0x09/*::]*/:   437,           /*::[*/0x0A/*::]*/:   850,\n\t/*::[*/0x0B/*::]*/:   437,           /*::[*/0x0D/*::]*/:   437,\n\t/*::[*/0x0E/*::]*/:   850,           /*::[*/0x0F/*::]*/:   437,\n\t/*::[*/0x10/*::]*/:   850,           /*::[*/0x11/*::]*/:   437,\n\t/*::[*/0x12/*::]*/:   850,           /*::[*/0x13/*::]*/:   932,\n\t/*::[*/0x14/*::]*/:   850,           /*::[*/0x15/*::]*/:   437,\n\t/*::[*/0x16/*::]*/:   850,           /*::[*/0x17/*::]*/:   865,\n\t/*::[*/0x18/*::]*/:   437,           /*::[*/0x19/*::]*/:   437,\n\t/*::[*/0x1A/*::]*/:   850,           /*::[*/0x1B/*::]*/:   437,\n\t/*::[*/0x1C/*::]*/:   863,           /*::[*/0x1D/*::]*/:   850,\n\t/*::[*/0x1F/*::]*/:   852,           /*::[*/0x22/*::]*/:   852,\n\t/*::[*/0x23/*::]*/:   852,           /*::[*/0x24/*::]*/:   860,\n\t/*::[*/0x25/*::]*/:   850,           /*::[*/0x26/*::]*/:   866,\n\t/*::[*/0x37/*::]*/:   850,           /*::[*/0x40/*::]*/:   852,\n\t/*::[*/0x4D/*::]*/:   936,           /*::[*/0x4E/*::]*/:   949,\n\t/*::[*/0x4F/*::]*/:   950,           /*::[*/0x50/*::]*/:   874,\n\t/*::[*/0x57/*::]*/:  1252,           /*::[*/0x58/*::]*/:  1252,\n\t/*::[*/0x59/*::]*/:  1252,           /*::[*/0x6C/*::]*/:   863,\n\t/*::[*/0x86/*::]*/:   737,           /*::[*/0x87/*::]*/:   852,\n\t/*::[*/0x88/*::]*/:   857,           /*::[*/0xCC/*::]*/:  1257,\n\n\t/*::[*/0xFF/*::]*/: 16969\n};\nvar dbf_reverse_map = evert({\n\t/*::[*/0x01/*::]*/:   437,           /*::[*/0x02/*::]*/:   850,\n\t/*::[*/0x03/*::]*/:  1252,           /*::[*/0x04/*::]*/: 10000,\n\t/*::[*/0x64/*::]*/:   852,           /*::[*/0x65/*::]*/:   866,\n\t/*::[*/0x66/*::]*/:   865,           /*::[*/0x67/*::]*/:   861,\n\t/*::[*/0x68/*::]*/:   895,           /*::[*/0x69/*::]*/:   620,\n\t/*::[*/0x6A/*::]*/:   737,           /*::[*/0x6B/*::]*/:   857,\n\t/*::[*/0x78/*::]*/:   950,           /*::[*/0x79/*::]*/:   949,\n\t/*::[*/0x7A/*::]*/:   936,           /*::[*/0x7B/*::]*/:   932,\n\t/*::[*/0x7C/*::]*/:   874,           /*::[*/0x7D/*::]*/:  1255,\n\t/*::[*/0x7E/*::]*/:  1256,           /*::[*/0x96/*::]*/: 10007,\n\t/*::[*/0x97/*::]*/: 10029,           /*::[*/0x98/*::]*/: 10006,\n\t/*::[*/0xC8/*::]*/:  1250,           /*::[*/0xC9/*::]*/:  1251,\n\t/*::[*/0xCA/*::]*/:  1254,           /*::[*/0xCB/*::]*/:  1253,\n\t/*::[*/0x00/*::]*/: 20127\n});\n/* TODO: find an actual specification */\nfunction dbf_to_aoa(buf, opts)/*:AOA*/ {\n\tvar out/*:AOA*/ = [];\n\tvar d/*:Block*/ = (new_raw_buf(1)/*:any*/);\n\tswitch(opts.type) {\n\t\tcase 'base64': d = s2a(Base64_decode(buf)); break;\n\t\tcase 'binary': d = s2a(buf); break;\n\t\tcase 'buffer':\n\t\tcase 'array': d = buf; break;\n\t}\n\tprep_blob(d, 0);\n\n\t/* header */\n\tvar ft = d.read_shift(1);\n\tvar memo = !!(ft & 0x88);\n\tvar vfp = false, l7 = false;\n\tswitch(ft) {\n\t\tcase 0x02: break; // dBASE II\n\t\tcase 0x03: break; // dBASE III\n\t\tcase 0x30: vfp = true; memo = true; break; // VFP\n\t\tcase 0x31: vfp = true; memo = true; break; // VFP with autoincrement\n\t\t// 0x43 dBASE IV SQL table files\n\t\t// 0x63 dBASE IV SQL system files\n\t\tcase 0x83: break; // dBASE III with memo\n\t\tcase 0x8B: break; // dBASE IV with memo\n\t\tcase 0x8C: l7 = true; break; // dBASE Level 7 with memo\n\t\t// case 0xCB dBASE IV SQL table files with memo\n\t\tcase 0xF5: break; // FoxPro 2.x with memo\n\t\t// case 0xFB FoxBASE\n\t\tdefault: throw new Error(\"DBF Unsupported Version: \" + ft.toString(16));\n\t}\n\n\tvar nrow = 0, fpos = 0x0209;\n\tif(ft == 0x02) nrow = d.read_shift(2);\n\td.l += 3; // dBASE II stores DDMMYY date, others use YYMMDD\n\tif(ft != 0x02) nrow = d.read_shift(4);\n\tif(nrow > 1048576) nrow = 1e6;\n\n\tif(ft != 0x02) fpos = d.read_shift(2); // header length\n\tvar rlen = d.read_shift(2); // record length\n\n\tvar /*flags = 0,*/ current_cp = opts.codepage || 1252;\n\tif(ft != 0x02) { // 20 reserved bytes\n\t\td.l+=16;\n\t\t/*flags = */d.read_shift(1);\n\t\t//if(memo && ((flags & 0x02) === 0)) throw new Error(\"DBF Flags \" + flags.toString(16) + \" ft \" + ft.toString(16));\n\n\t\t/* codepage present in FoxPro and dBASE Level 7 */\n\t\tif(d[d.l] !== 0) current_cp = dbf_codepage_map[d[d.l]];\n\t\td.l+=1;\n\n\t\td.l+=2;\n\t}\n\tif(l7) d.l += 36; // Level 7: 32 byte \"Language driver name\", 4 byte reserved\n\n/*:: type DBFField = { name:string; len:number; type:string; } */\n\tvar fields/*:Array<DBFField>*/ = [], field/*:DBFField*/ = ({}/*:any*/);\n\tvar hend = Math.min(d.length, (ft == 0x02 ? 0x209 : (fpos - 10 - (vfp ? 264 : 0))));\n\tvar ww = l7 ? 32 : 11;\n\twhile(d.l < hend && d[d.l] != 0x0d) {\n\t\tfield = ({}/*:any*/);\n\t\tfield.name = $cptable.utils.decode(current_cp, d.slice(d.l, d.l+ww)).replace(/[\\u0000\\r\\n].*$/g,\"\");\n\t\td.l += ww;\n\t\tfield.type = String.fromCharCode(d.read_shift(1));\n\t\tif(ft != 0x02 && !l7) field.offset = d.read_shift(4);\n\t\tfield.len = d.read_shift(1);\n\t\tif(ft == 0x02) field.offset = d.read_shift(2);\n\t\tfield.dec = d.read_shift(1);\n\t\tif(field.name.length) fields.push(field);\n\t\tif(ft != 0x02) d.l += l7 ? 13 : 14;\n\t\tswitch(field.type) {\n\t\t\tcase 'B': // Double (VFP) / Binary (dBASE L7)\n\t\t\t\tif((!vfp || field.len != 8) && opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n\t\t\t\tbreak;\n\t\t\tcase 'G': // General (FoxPro and dBASE L7)\n\t\t\tcase 'P': // Picture (FoxPro and dBASE L7)\n\t\t\t\tif(opts.WTF) console.log('Skipping ' + field.name + ':' + field.type);\n\t\t\t\tbreak;\n\t\t\tcase '+': // Autoincrement (dBASE L7 only)\n\t\t\tcase '0': // _NullFlags (VFP only)\n\t\t\tcase '@': // Timestamp (dBASE L7 only)\n\t\t\tcase 'C': // Character (dBASE II)\n\t\t\tcase 'D': // Date (dBASE III)\n\t\t\tcase 'F': // Float (dBASE IV)\n\t\t\tcase 'I': // Long (VFP and dBASE L7)\n\t\t\tcase 'L': // Logical (dBASE II)\n\t\t\tcase 'M': // Memo (dBASE III)\n\t\t\tcase 'N': // Number (dBASE II)\n\t\t\tcase 'O': // Double (dBASE L7 only)\n\t\t\tcase 'T': // Datetime (VFP only)\n\t\t\tcase 'Y': // Currency (VFP only)\n\t\t\t\tbreak;\n\t\t\tdefault: throw new Error('Unknown Field Type: ' + field.type);\n\t\t}\n\t}\n\n\tif(d[d.l] !== 0x0D) d.l = fpos-1;\n\tif(d.read_shift(1) !== 0x0D) throw new Error(\"DBF Terminator not found \" + d.l + \" \" + d[d.l]);\n\td.l = fpos;\n\n\t/* data */\n\tvar R = 0, C = 0;\n\tout[0] = [];\n\tfor(C = 0; C != fields.length; ++C) out[0][C] = fields[C].name;\n\twhile(nrow-- > 0) {\n\t\tif(d[d.l] === 0x2A) {\n\t\t\t// TODO: record marked as deleted -- create a hidden row?\n\t\t\td.l+=rlen;\n\t\t\tcontinue;\n\t\t}\n\t\t++d.l;\n\t\tout[++R] = []; C = 0;\n\t\tfor(C = 0; C != fields.length; ++C) {\n\t\t\tvar dd = d.slice(d.l, d.l+fields[C].len); d.l+=fields[C].len;\n\t\t\tprep_blob(dd, 0);\n\t\t\tvar s = $cptable.utils.decode(current_cp, dd);\n\t\t\tswitch(fields[C].type) {\n\t\t\t\tcase 'C':\n\t\t\t\t\t// NOTE: it is conventional to write '  /  /  ' for empty dates\n\t\t\t\t\tif(s.trim().length) out[R][C] = s.replace(/\\s+$/,\"\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tif(s.length === 8) out[R][C] = new Date(+s.slice(0,4), +s.slice(4,6)-1, +s.slice(6,8));\n\t\t\t\t\telse out[R][C] = s;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'F': out[R][C] = parseFloat(s.trim()); break;\n\t\t\t\tcase '+': case 'I': out[R][C] = l7 ? dd.read_shift(-4, 'i') ^ 0x80000000 : dd.read_shift(4, 'i'); break;\n\t\t\t\tcase 'L': switch(s.trim().toUpperCase()) {\n\t\t\t\t\tcase 'Y': case 'T': out[R][C] = true; break;\n\t\t\t\t\tcase 'N': case 'F': out[R][C] = false; break;\n\t\t\t\t\tcase '': case '?': break;\n\t\t\t\t\tdefault: throw new Error(\"DBF Unrecognized L:|\" + s + \"|\");\n\t\t\t\t\t} break;\n\t\t\t\tcase 'M': /* TODO: handle memo files */\n\t\t\t\t\tif(!memo) throw new Error(\"DBF Unexpected MEMO for type \" + ft.toString(16));\n\t\t\t\t\tout[R][C] = \"##MEMO##\" + (l7 ? parseInt(s.trim(), 10): dd.read_shift(4));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'N':\n\t\t\t\t\ts = s.replace(/\\u0000/g,\"\").trim();\n\t\t\t\t\t// NOTE: dBASE II interprets \"  .  \" as 0\n\t\t\t\t\tif(s && s != \".\") out[R][C] = +s || 0; break;\n\t\t\t\tcase '@':\n\t\t\t\t\t// NOTE: dBASE specs appear to be incorrect\n\t\t\t\t\tout[R][C] = new Date(dd.read_shift(-8, 'f') - 0x388317533400);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'T': out[R][C] = new Date((dd.read_shift(4) - 0x253D8C) * 0x5265C00 + dd.read_shift(4)); break;\n\t\t\t\tcase 'Y': out[R][C] = dd.read_shift(4,'i')/1e4 + (dd.read_shift(4, 'i')/1e4)*Math.pow(2,32); break;\n\t\t\t\tcase 'O': out[R][C] = -dd.read_shift(-8, 'f'); break;\n\t\t\t\tcase 'B': if(vfp && fields[C].len == 8) { out[R][C] = dd.read_shift(8,'f'); break; }\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 'G': case 'P': dd.l += fields[C].len; break;\n\t\t\t\tcase '0':\n\t\t\t\t\tif(fields[C].name === '_NullFlags') break;\n\t\t\t\t\t/* falls through */\n\t\t\t\tdefault: throw new Error(\"DBF Unsupported data type \" + fields[C].type);\n\t\t\t}\n\t\t}\n\t}\n\tif(ft != 0x02) if(d.l < d.length && d[d.l++] != 0x1A) throw new Error(\"DBF EOF Marker missing \" + (d.l-1) + \" of \" + d.length + \" \" + d[d.l-1].toString(16));\n\tif(opts && opts.sheetRows) out = out.slice(0, opts.sheetRows);\n\topts.DBF = fields;\n\treturn out;\n}\n\nfunction dbf_to_sheet(buf, opts)/*:Worksheet*/ {\n\tvar o = opts || {};\n\tif(!o.dateNF) o.dateNF = \"yyyymmdd\";\n\tvar ws = aoa_to_sheet(dbf_to_aoa(buf, o), o);\n\tws[\"!cols\"] = o.DBF.map(function(field) { return {\n\t\twch: field.len,\n\t\tDBF: field\n\t};});\n\tdelete o.DBF;\n\treturn ws;\n}\n\nfunction dbf_to_workbook(buf, opts)/*:Workbook*/ {\n\ttry { return sheet_to_workbook(dbf_to_sheet(buf, opts), opts); }\n\tcatch(e) { if(opts && opts.WTF) throw e; }\n\treturn ({SheetNames:[],Sheets:{}});\n}\n\nvar _RLEN = { 'B': 8, 'C': 250, 'L': 1, 'D': 8, '?': 0, '': 0 };\nfunction sheet_to_dbf(ws/*:Worksheet*/, opts/*:WriteOpts*/) {\n\tvar o = opts || {};\n\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\tif(o.type == \"string\") throw new Error(\"Cannot write DBF to JS string\");\n\tvar ba = buf_array();\n\tvar aoa/*:AOA*/ = sheet_to_json(ws, {header:1, raw:true, cellDates:true});\n\tvar headers = aoa[0], data = aoa.slice(1), cols = ws[\"!cols\"] || [];\n\tvar i = 0, j = 0, hcnt = 0, rlen = 1;\n\tfor(i = 0; i < headers.length; ++i) {\n\t\tif(((cols[i]||{}).DBF||{}).name) { headers[i] = cols[i].DBF.name; ++hcnt; continue; }\n\t\tif(headers[i] == null) continue;\n\t\t++hcnt;\n\t\tif(typeof headers[i] === 'number') headers[i] = headers[i].toString(10);\n\t\tif(typeof headers[i] !== 'string') throw new Error(\"DBF Invalid column name \" + headers[i] + \" |\" + (typeof headers[i]) + \"|\");\n\t\tif(headers.indexOf(headers[i]) !== i) for(j=0; j<1024;++j)\n\t\t\tif(headers.indexOf(headers[i] + \"_\" + j) == -1) { headers[i] += \"_\" + j; break; }\n\t}\n\tvar range = safe_decode_range(ws['!ref']);\n\tvar coltypes/*:Array<string>*/ = [];\n\tvar colwidths/*:Array<number>*/ = [];\n\tvar coldecimals/*:Array<number>*/ = [];\n\tfor(i = 0; i <= range.e.c - range.s.c; ++i) {\n\t\tvar guess = '', _guess = '', maxlen = 0;\n\t\tvar col/*:Array<any>*/ = [];\n\t\tfor(j=0; j < data.length; ++j) {\n\t\t\tif(data[j][i] != null) col.push(data[j][i]);\n\t\t}\n\t\tif(col.length == 0 || headers[i] == null) { coltypes[i] = '?'; continue; }\n\t\tfor(j = 0; j < col.length; ++j) {\n\t\t\tswitch(typeof col[j]) {\n\t\t\t\t/* TODO: check if L2 compat is desired */\n\t\t\t\tcase 'number': _guess = 'B'; break;\n\t\t\t\tcase 'string': _guess = 'C'; break;\n\t\t\t\tcase 'boolean': _guess = 'L'; break;\n\t\t\t\tcase 'object': _guess = col[j] instanceof Date ? 'D' : 'C'; break;\n\t\t\t\tdefault: _guess = 'C';\n\t\t\t}\n\t\t\tmaxlen = Math.max(maxlen, String(col[j]).length);\n\t\t\tguess = guess && guess != _guess ? 'C' : _guess;\n\t\t\t//if(guess == 'C') break;\n\t\t}\n\t\tif(maxlen > 250) maxlen = 250;\n\t\t_guess = ((cols[i]||{}).DBF||{}).type;\n\t\t/* TODO: more fine grained control over DBF type resolution */\n\t\tif(_guess == 'C') {\n\t\t\tif(cols[i].DBF.len > maxlen) maxlen = cols[i].DBF.len;\n\t\t}\n\t\tif(guess == 'B' && _guess == 'N') {\n\t\t\tguess = 'N';\n\t\t\tcoldecimals[i] = cols[i].DBF.dec;\n\t\t\tmaxlen = cols[i].DBF.len;\n\t\t}\n\t\tcolwidths[i] = guess == 'C' || _guess == 'N' ? maxlen : (_RLEN[guess] || 0);\n\t\trlen += colwidths[i];\n\t\tcoltypes[i] = guess;\n\t}\n\n\tvar h = ba.next(32);\n\th.write_shift(4, 0x13021130);\n\th.write_shift(4, data.length);\n\th.write_shift(2, 296 + 32 * hcnt);\n\th.write_shift(2, rlen);\n\tfor(i=0; i < 4; ++i) h.write_shift(4, 0);\n\th.write_shift(4, 0x00000000 | ((+dbf_reverse_map[/*::String(*/current_ansi/*::)*/] || 0x03)<<8));\n\n\tfor(i = 0, j = 0; i < headers.length; ++i) {\n\t\tif(headers[i] == null) continue;\n\t\tvar hf = ba.next(32);\n\t\tvar _f = (headers[i].slice(-10) + \"\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\").slice(0, 11);\n\t\thf.write_shift(1, _f, \"sbcs\");\n\t\thf.write_shift(1, coltypes[i] == '?' ? 'C' : coltypes[i], \"sbcs\");\n\t\thf.write_shift(4, j);\n\t\thf.write_shift(1, colwidths[i] || _RLEN[coltypes[i]] || 0);\n\t\thf.write_shift(1, coldecimals[i] || 0);\n\t\thf.write_shift(1, 0x02);\n\t\thf.write_shift(4, 0);\n\t\thf.write_shift(1, 0);\n\t\thf.write_shift(4, 0);\n\t\thf.write_shift(4, 0);\n\t\tj += (colwidths[i] || _RLEN[coltypes[i]] || 0);\n\t}\n\n\tvar hb = ba.next(264);\n\thb.write_shift(4, 0x0000000D);\n\tfor(i=0; i < 65;++i) hb.write_shift(4, 0x00000000);\n\tfor(i=0; i < data.length; ++i) {\n\t\tvar rout = ba.next(rlen);\n\t\trout.write_shift(1, 0);\n\t\tfor(j=0; j<headers.length; ++j) {\n\t\t\tif(headers[j] == null) continue;\n\t\t\tswitch(coltypes[j]) {\n\t\t\t\tcase 'L': rout.write_shift(1, data[i][j] == null ? 0x3F : data[i][j] ? 0x54 : 0x46); break;\n\t\t\t\tcase 'B': rout.write_shift(8, data[i][j]||0, 'f'); break;\n\t\t\t\tcase 'N':\n\t\t\t\t\tvar _n = \"0\";\n\t\t\t\t\tif(typeof data[i][j] == \"number\") _n = data[i][j].toFixed(coldecimals[j]||0);\n\t\t\t\t\tfor(hcnt=0; hcnt < colwidths[j]-_n.length; ++hcnt) rout.write_shift(1, 0x20);\n\t\t\t\t\trout.write_shift(1, _n, \"sbcs\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'D':\n\t\t\t\t\tif(!data[i][j]) rout.write_shift(8, \"00000000\", \"sbcs\");\n\t\t\t\t\telse {\n\t\t\t\t\t\trout.write_shift(4, (\"0000\"+data[i][j].getFullYear()).slice(-4), \"sbcs\");\n\t\t\t\t\t\trout.write_shift(2, (\"00\"+(data[i][j].getMonth()+1)).slice(-2), \"sbcs\");\n\t\t\t\t\t\trout.write_shift(2, (\"00\"+data[i][j].getDate()).slice(-2), \"sbcs\");\n\t\t\t\t\t} break;\n\t\t\t\tcase 'C':\n\t\t\t\t\tvar _s = String(data[i][j] != null ? data[i][j] : \"\").slice(0, colwidths[j]);\n\t\t\t\t\trout.write_shift(1, _s, \"sbcs\");\n\t\t\t\t\tfor(hcnt=0; hcnt < colwidths[j]-_s.length; ++hcnt) rout.write_shift(1, 0x20); break;\n\t\t\t}\n\t\t}\n\t\t// data\n\t}\n\tba.next(1).write_shift(1, 0x1A);\n\treturn ba.end();\n}\n\treturn {\n\t\tto_workbook: dbf_to_workbook,\n\t\tto_sheet: dbf_to_sheet,\n\t\tfrom_sheet: sheet_to_dbf\n\t};\n})();\n\nvar SYLK = /*#__PURE__*/(function() {\n\t/* TODO: stress test sequences */\n\tvar sylk_escapes = ({\n\t\tAA:'', BA:'', CA:'', DA:195, HA:'', JA:197,\n\t\tAE:'', BE:'', CE:'',         HE:'',\n\t\tAI:'', BI:'', CI:'',         HI:'',\n\t\tAO:'', BO:'', CO:'', DO:213, HO:'',\n\t\tAU:'', BU:'', CU:'',         HU:'',\n\t\tAa:'', Ba:'', Ca:'', Da:227, Ha:'', Ja:229,\n\t\tAe:'', Be:'', Ce:'',         He:'',\n\t\tAi:'', Bi:'', Ci:'',         Hi:'',\n\t\tAo:'', Bo:'', Co:'', Do:245, Ho:'',\n\t\tAu:'', Bu:'', Cu:'',         Hu:'',\n\t\tKC:'', Kc:'', q:'',  z:'',  a:'',  j:'',\n\t\tDN:209, Dn:241, Hy:255,\n\t\tS:169,  c:170,  R:174,  \"B \":180,\n\t\t/*::[*/0/*::]*/:176,    /*::[*/1/*::]*/:177,  /*::[*/2/*::]*/:178,\n\t\t/*::[*/3/*::]*/:179,    /*::[*/5/*::]*/:181,  /*::[*/6/*::]*/:182,\n\t\t/*::[*/7/*::]*/:183,    Q:185,  k:186,  b:208,  i:216,  l:222,  s:240,  y:248,\n\t\t\"!\":161, '\"':162, \"#\":163, \"(\":164, \"%\":165, \"'\":167, \"H \":168,\n\t\t\"+\":171, \";\":187, \"<\":188, \"=\":189, \">\":190, \"?\":191, \"{\":223\n\t}/*:any*/);\n\tvar sylk_char_regex = new RegExp(\"\\u001BN(\" + keys(sylk_escapes).join(\"|\").replace(/\\|\\|\\|/, \"|\\\\||\").replace(/([?()+])/g,\"\\\\$1\") + \"|\\\\|)\", \"gm\");\n\tvar sylk_char_fn = function(_, $1){ var o = sylk_escapes[$1]; return typeof o == \"number\" ? _getansi(o) : o; };\n\tvar decode_sylk_char = function($$, $1, $2) { var newcc = (($1.charCodeAt(0) - 0x20)<<4) | ($2.charCodeAt(0) - 0x30); return newcc == 59 ? $$ : _getansi(newcc); };\n\tsylk_escapes[\"|\"] = 254;\n\t/* TODO: find an actual specification */\n\tfunction sylk_to_aoa(d/*:RawData*/, opts)/*:[AOA, Worksheet]*/ {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return sylk_to_aoa_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return sylk_to_aoa_str(d, opts);\n\t\t\tcase 'buffer': return sylk_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array': return sylk_to_aoa_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\tfunction sylk_to_aoa_str(str/*:string*/, opts)/*:[AOA, Worksheet]*/ {\n\t\tvar records = str.split(/[\\n\\r]+/), R = -1, C = -1, ri = 0, rj = 0, arr/*:AOA*/ = [];\n\t\tvar formats/*:Array<string>*/ = [];\n\t\tvar next_cell_format/*:string|null*/ = null;\n\t\tvar sht = {}, rowinfo/*:Array<RowInfo>*/ = [], colinfo/*:Array<ColInfo>*/ = [], cw/*:Array<string>*/ = [];\n\t\tvar Mval = 0, j;\n\t\tif(+opts.codepage >= 0) set_cp(+opts.codepage);\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tMval = 0;\n\t\t\tvar rstr=records[ri].trim().replace(/\\x1B([\\x20-\\x2F])([\\x30-\\x3F])/g, decode_sylk_char).replace(sylk_char_regex, sylk_char_fn);\n\t\t\tvar record=rstr.replace(/;;/g, \"\\u0000\").split(\";\").map(function(x) { return x.replace(/\\u0000/g, \";\"); });\n\t\t\tvar RT=record[0], val;\n\t\t\tif(rstr.length > 0) switch(RT) {\n\t\t\tcase 'ID': break; /* header */\n\t\t\tcase 'E': break; /* EOF */\n\t\t\tcase 'B': break; /* dimensions */\n\t\t\tcase 'O': break; /* options? */\n\t\t\tcase 'W': break; /* window? */\n\t\t\tcase 'P':\n\t\t\t\tif(record[1].charAt(0) == 'P')\n\t\t\t\t\tformats.push(rstr.slice(3).replace(/;;/g, \";\"));\n\t\t\t\tbreak;\n\t\t\tcase 'C':\n\t\t\tvar C_seen_K = false, C_seen_X = false, C_seen_S = false, C_seen_E = false, _R = -1, _C = -1;\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'A': break; // TODO: comment\n\t\t\t\tcase 'X': C = parseInt(record[rj].slice(1))-1; C_seen_X = true; break;\n\t\t\t\tcase 'Y':\n\t\t\t\t\tR = parseInt(record[rj].slice(1))-1; if(!C_seen_X) C = 0;\n\t\t\t\t\tfor(j = arr.length; j <= R; ++j) arr[j] = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'K':\n\t\t\t\t\tval = record[rj].slice(1);\n\t\t\t\t\tif(val.charAt(0) === '\"') val = val.slice(1,val.length - 1);\n\t\t\t\t\telse if(val === 'TRUE') val = true;\n\t\t\t\t\telse if(val === 'FALSE') val = false;\n\t\t\t\t\telse if(!isNaN(fuzzynum(val))) {\n\t\t\t\t\t\tval = fuzzynum(val);\n\t\t\t\t\t\tif(next_cell_format !== null && fmt_is_date(next_cell_format)) val = numdate(val);\n\t\t\t\t\t} else if(!isNaN(fuzzydate(val).getDate())) {\n\t\t\t\t\t\tval = parseDate(val);\n\t\t\t\t\t}\n\t\t\t\t\tif(typeof $cptable !== 'undefined' && typeof val == \"string\" && ((opts||{}).type != \"string\") && (opts||{}).codepage) val = $cptable.utils.decode(opts.codepage, val);\n\t\t\t\t\tC_seen_K = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'E':\n\t\t\t\t\tC_seen_E = true;\n\t\t\t\t\tvar formula = rc_to_a1(record[rj].slice(1), {r:R,c:C});\n\t\t\t\t\tarr[R][C] = [arr[R][C], formula];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'S':\n\t\t\t\t\tC_seen_S = true;\n\t\t\t\t\tarr[R][C] = [arr[R][C], \"S5S\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'G': break; // unknown\n\t\t\t\tcase 'R': _R = parseInt(record[rj].slice(1))-1; break;\n\t\t\t\tcase 'C': _C = parseInt(record[rj].slice(1))-1; break;\n\t\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t\tif(C_seen_K) {\n\t\t\t\tif(arr[R][C] && arr[R][C].length == 2) arr[R][C][0] = val;\n\t\t\t\telse arr[R][C] = val;\n\t\t\t\tnext_cell_format = null;\n\t\t\t}\n\t\t\tif(C_seen_S) {\n\t\t\t\tif(C_seen_E) throw new Error(\"SYLK shared formula cannot have own formula\");\n\t\t\t\tvar shrbase = _R > -1 && arr[_R][_C];\n\t\t\t\tif(!shrbase || !shrbase[1]) throw new Error(\"SYLK shared formula cannot find base\");\n\t\t\t\tarr[R][C][1] = shift_formula_str(shrbase[1], {r: R - _R, c: C - _C});\n\t\t\t}\n\t\t\tbreak;\n\t\t\tcase 'F':\n\t\t\tvar F_seen = 0;\n\t\t\tfor(rj=1; rj<record.length; ++rj) switch(record[rj].charAt(0)) {\n\t\t\t\tcase 'X': C = parseInt(record[rj].slice(1))-1; ++F_seen; break;\n\t\t\t\tcase 'Y':\n\t\t\t\t\tR = parseInt(record[rj].slice(1))-1; /*C = 0;*/\n\t\t\t\t\tfor(j = arr.length; j <= R; ++j) arr[j] = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'M': Mval = parseInt(record[rj].slice(1)) / 20; break;\n\t\t\t\tcase 'F': break; /* ??? */\n\t\t\t\tcase 'G': break; /* hide grid */\n\t\t\t\tcase 'P':\n\t\t\t\t\tnext_cell_format = formats[parseInt(record[rj].slice(1))];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'S': break; /* cell style */\n\t\t\t\tcase 'D': break; /* column */\n\t\t\t\tcase 'N': break; /* font */\n\t\t\t\tcase 'W':\n\t\t\t\t\tcw = record[rj].slice(1).split(\" \");\n\t\t\t\t\tfor(j = parseInt(cw[0], 10); j <= parseInt(cw[1], 10); ++j) {\n\t\t\t\t\t\tMval = parseInt(cw[2], 10);\n\t\t\t\t\t\tcolinfo[j-1] = Mval === 0 ? {hidden:true}: {wch:Mval}; process_col(colinfo[j-1]);\n\t\t\t\t\t} break;\n\t\t\t\tcase 'C': /* default column format */\n\t\t\t\t\tC = parseInt(record[rj].slice(1))-1;\n\t\t\t\t\tif(!colinfo[C]) colinfo[C] = {};\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'R': /* row properties */\n\t\t\t\t\tR = parseInt(record[rj].slice(1))-1;\n\t\t\t\t\tif(!rowinfo[R]) rowinfo[R] = {};\n\t\t\t\t\tif(Mval > 0) { rowinfo[R].hpt = Mval; rowinfo[R].hpx = pt2px(Mval); }\n\t\t\t\t\telse if(Mval === 0) rowinfo[R].hidden = true;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t\tif(F_seen < 1) next_cell_format = null; break;\n\t\t\tdefault: if(opts && opts.WTF) throw new Error(\"SYLK bad record \" + rstr);\n\t\t\t}\n\t\t}\n\t\tif(rowinfo.length > 0) sht['!rows'] = rowinfo;\n\t\tif(colinfo.length > 0) sht['!cols'] = colinfo;\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn [arr, sht];\n\t}\n\n\tfunction sylk_to_sheet(d/*:RawData*/, opts)/*:Worksheet*/ {\n\t\tvar aoasht = sylk_to_aoa(d, opts);\n\t\tvar aoa = aoasht[0], ws = aoasht[1];\n\t\tvar o = aoa_to_sheet(aoa, opts);\n\t\tkeys(ws).forEach(function(k) { o[k] = ws[k]; });\n\t\treturn o;\n\t}\n\n\tfunction sylk_to_workbook(d/*:RawData*/, opts)/*:Workbook*/ { return sheet_to_workbook(sylk_to_sheet(d, opts), opts); }\n\n\tfunction write_ws_cell_sylk(cell/*:Cell*/, ws/*:Worksheet*/, R/*:number*/, C/*:number*//*::, opts*/)/*:string*/ {\n\t\tvar o = \"C;Y\" + (R+1) + \";X\" + (C+1) + \";K\";\n\t\tswitch(cell.t) {\n\t\t\tcase 'n':\n\t\t\t\to += (cell.v||0);\n\t\t\t\tif(cell.f && !cell.F) o += \";E\" + a1_to_rc(cell.f, {r:R, c:C}); break;\n\t\t\tcase 'b': o += cell.v ? \"TRUE\" : \"FALSE\"; break;\n\t\t\tcase 'e': o += cell.w || cell.v; break;\n\t\t\tcase 'd': o += '\"' + (cell.w || cell.v) + '\"'; break;\n\t\t\tcase 's': o += '\"' + cell.v.replace(/\"/g,\"\").replace(/;/g, \";;\") + '\"'; break;\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction write_ws_cols_sylk(out, cols) {\n\t\tcols.forEach(function(col, i) {\n\t\t\tvar rec = \"F;W\" + (i+1) + \" \" + (i+1) + \" \";\n\t\t\tif(col.hidden) rec += \"0\";\n\t\t\telse {\n\t\t\t\tif(typeof col.width == 'number' && !col.wpx) col.wpx = width2px(col.width);\n\t\t\t\tif(typeof col.wpx == 'number' && !col.wch) col.wch = px2char(col.wpx);\n\t\t\t\tif(typeof col.wch == 'number') rec += Math.round(col.wch);\n\t\t\t}\n\t\t\tif(rec.charAt(rec.length - 1) != \" \") out.push(rec);\n\t\t});\n\t}\n\n\tfunction write_ws_rows_sylk(out/*:Array<string>*/, rows/*:Array<RowInfo>*/) {\n\t\trows.forEach(function(row, i) {\n\t\t\tvar rec = \"F;\";\n\t\t\tif(row.hidden) rec += \"M0;\";\n\t\t\telse if(row.hpt) rec += \"M\" + 20 * row.hpt + \";\";\n\t\t\telse if(row.hpx) rec += \"M\" + 20 * px2pt(row.hpx) + \";\";\n\t\t\tif(rec.length > 2) out.push(rec + \"R\" + (i+1));\n\t\t});\n\t}\n\n\tfunction sheet_to_sylk(ws/*:Worksheet*/, opts/*:?any*/)/*:string*/ {\n\t\tvar preamble/*:Array<string>*/ = [\"ID;PWXL;N;E\"], o/*:Array<string>*/ = [];\n\t\tvar r = safe_decode_range(ws['!ref']), cell/*:Cell*/;\n\t\tvar dense = Array.isArray(ws);\n\t\tvar RS = \"\\r\\n\";\n\n\t\tpreamble.push(\"P;PGeneral\");\n\t\tpreamble.push(\"F;P0;DG0G8;M255\");\n\t\tif(ws['!cols']) write_ws_cols_sylk(preamble, ws['!cols']);\n\t\tif(ws['!rows']) write_ws_rows_sylk(preamble, ws['!rows']);\n\n\t\tpreamble.push(\"B;Y\" + (r.e.r - r.s.r + 1) + \";X\" + (r.e.c - r.s.c + 1) + \";D\" + [r.s.c,r.s.r,r.e.c,r.e.r].join(\" \"));\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[R]||[])[C]: ws[coord];\n\t\t\t\tif(!cell || (cell.v == null && (!cell.f || cell.F))) continue;\n\t\t\t\to.push(write_ws_cell_sylk(cell, ws, R, C, opts));\n\t\t\t}\n\t\t}\n\t\treturn preamble.join(RS) + RS + o.join(RS) + RS + \"E\" + RS;\n\t}\n\n\treturn {\n\t\tto_workbook: sylk_to_workbook,\n\t\tto_sheet: sylk_to_sheet,\n\t\tfrom_sheet: sheet_to_sylk\n\t};\n})();\n\nvar DIF = /*#__PURE__*/(function() {\n\tfunction dif_to_aoa(d/*:RawData*/, opts)/*:AOA*/ {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return dif_to_aoa_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return dif_to_aoa_str(d, opts);\n\t\t\tcase 'buffer': return dif_to_aoa_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array': return dif_to_aoa_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\tfunction dif_to_aoa_str(str/*:string*/, opts)/*:AOA*/ {\n\t\tvar records = str.split('\\n'), R = -1, C = -1, ri = 0, arr/*:AOA*/ = [];\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tif (records[ri].trim() === 'BOT') { arr[++R] = []; C = 0; continue; }\n\t\t\tif (R < 0) continue;\n\t\t\tvar metadata = records[ri].trim().split(\",\");\n\t\t\tvar type = metadata[0], value = metadata[1];\n\t\t\t++ri;\n\t\t\tvar data = records[ri] || \"\";\n\t\t\twhile(((data.match(/[\"]/g)||[]).length & 1) && ri < records.length - 1) data += \"\\n\" + records[++ri];\n\t\t\tdata = data.trim();\n\t\t\tswitch (+type) {\n\t\t\t\tcase -1:\n\t\t\t\t\tif (data === 'BOT') { arr[++R] = []; C = 0; continue; }\n\t\t\t\t\telse if (data !== 'EOD') throw new Error(\"Unrecognized DIF special command \" + data);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0:\n\t\t\t\t\tif(data === 'TRUE') arr[R][C] = true;\n\t\t\t\t\telse if(data === 'FALSE') arr[R][C] = false;\n\t\t\t\t\telse if(!isNaN(fuzzynum(value))) arr[R][C] = fuzzynum(value);\n\t\t\t\t\telse if(!isNaN(fuzzydate(value).getDate())) arr[R][C] = parseDate(value);\n\t\t\t\t\telse arr[R][C] = value;\n\t\t\t\t\t++C; break;\n\t\t\t\tcase 1:\n\t\t\t\t\tdata = data.slice(1,data.length-1);\n\t\t\t\t\tdata = data.replace(/\"\"/g, '\"');\n\t\t\t\t\tif(DIF_XL && data && data.match(/^=\".*\"$/)) data = data.slice(2, -1);\n\t\t\t\t\tarr[R][C++] = data !== '' ? data : null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (data === 'EOD') break;\n\t\t}\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn arr;\n\t}\n\n\tfunction dif_to_sheet(str/*:string*/, opts)/*:Worksheet*/ { return aoa_to_sheet(dif_to_aoa(str, opts), opts); }\n\tfunction dif_to_workbook(str/*:string*/, opts)/*:Workbook*/ { return sheet_to_workbook(dif_to_sheet(str, opts), opts); }\n\n\tvar sheet_to_dif = /*#__PURE__*/(function() {\n\t\tvar push_field = function pf(o/*:Array<string>*/, topic/*:string*/, v/*:number*/, n/*:number*/, s/*:string*/) {\n\t\t\to.push(topic);\n\t\t\to.push(v + \",\" + n);\n\t\t\to.push('\"' + s.replace(/\"/g,'\"\"') + '\"');\n\t\t};\n\t\tvar push_value = function po(o/*:Array<string>*/, type/*:number*/, v/*:any*/, s/*:string*/) {\n\t\t\to.push(type + \",\" + v);\n\t\t\to.push(type == 1 ? '\"' + s.replace(/\"/g,'\"\"') + '\"' : s);\n\t\t};\n\t\treturn function sheet_to_dif(ws/*:Worksheet*//*::, opts:?any*/)/*:string*/ {\n\t\t\tvar o/*:Array<string>*/ = [];\n\t\t\tvar r = safe_decode_range(ws['!ref']), cell/*:Cell*/;\n\t\t\tvar dense = Array.isArray(ws);\n\t\t\tpush_field(o, \"TABLE\", 0, 1, \"sheetjs\");\n\t\t\tpush_field(o, \"VECTORS\", 0, r.e.r - r.s.r + 1,\"\");\n\t\t\tpush_field(o, \"TUPLES\", 0, r.e.c - r.s.c + 1,\"\");\n\t\t\tpush_field(o, \"DATA\", 0, 0,\"\");\n\t\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\t\tpush_value(o, -1, 0, \"BOT\");\n\t\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\t\tcell = dense ? (ws[R]||[])[C] : ws[coord];\n\t\t\t\t\tif(!cell) { push_value(o, 1, 0, \"\"); continue;}\n\t\t\t\t\tswitch(cell.t) {\n\t\t\t\t\t\tcase 'n':\n\t\t\t\t\t\t\tvar val = DIF_XL ? cell.w : cell.v;\n\t\t\t\t\t\t\tif(!val && cell.v != null) val = cell.v;\n\t\t\t\t\t\t\tif(val == null) {\n\t\t\t\t\t\t\t\tif(DIF_XL && cell.f && !cell.F) push_value(o, 1, 0, \"=\" + cell.f);\n\t\t\t\t\t\t\t\telse push_value(o, 1, 0, \"\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse push_value(o, 0, val, \"V\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\t\tpush_value(o, 0, cell.v ? 1 : 0, cell.v ? \"TRUE\" : \"FALSE\");\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 's':\n\t\t\t\t\t\t\tpush_value(o, 1, 0, (!DIF_XL || isNaN(cell.v)) ? cell.v : '=\"' + cell.v + '\"');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\tif(!cell.w) cell.w = SSF_format(cell.z || table_fmt[14], datenum(parseDate(cell.v)));\n\t\t\t\t\t\t\tif(DIF_XL) push_value(o, 0, cell.w, \"V\");\n\t\t\t\t\t\t\telse push_value(o, 1, 0, cell.w);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault: push_value(o, 1, 0, \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpush_value(o, -1, 0, \"EOD\");\n\t\t\tvar RS = \"\\r\\n\";\n\t\t\tvar oo = o.join(RS);\n\t\t\t//while((oo.length & 0x7F) != 0) oo += \"\\0\";\n\t\t\treturn oo;\n\t\t};\n\t})();\n\treturn {\n\t\tto_workbook: dif_to_workbook,\n\t\tto_sheet: dif_to_sheet,\n\t\tfrom_sheet: sheet_to_dif\n\t};\n})();\n\nvar ETH = /*#__PURE__*/(function() {\n\tfunction decode(s/*:string*/)/*:string*/ { return s.replace(/\\\\b/g,\"\\\\\").replace(/\\\\c/g,\":\").replace(/\\\\n/g,\"\\n\"); }\n\tfunction encode(s/*:string*/)/*:string*/ { return s.replace(/\\\\/g, \"\\\\b\").replace(/:/g, \"\\\\c\").replace(/\\n/g,\"\\\\n\"); }\n\n\tfunction eth_to_aoa(str/*:string*/, opts)/*:AOA*/ {\n\t\tvar records = str.split('\\n'), R = -1, C = -1, ri = 0, arr/*:AOA*/ = [];\n\t\tfor (; ri !== records.length; ++ri) {\n\t\t\tvar record = records[ri].trim().split(\":\");\n\t\t\tif(record[0] !== 'cell') continue;\n\t\t\tvar addr = decode_cell(record[1]);\n\t\t\tif(arr.length <= addr.r) for(R = arr.length; R <= addr.r; ++R) if(!arr[R]) arr[R] = [];\n\t\t\tR = addr.r; C = addr.c;\n\t\t\tswitch(record[2]) {\n\t\t\t\tcase 't': arr[R][C] = decode(record[3]); break;\n\t\t\t\tcase 'v': arr[R][C] = +record[3]; break;\n\t\t\t\tcase 'vtf': var _f = record[record.length - 1];\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 'vtc':\n\t\t\t\t\tswitch(record[3]) {\n\t\t\t\t\t\tcase 'nl': arr[R][C] = +record[4] ? true : false; break;\n\t\t\t\t\t\tdefault: arr[R][C] = +record[4]; break;\n\t\t\t\t\t}\n\t\t\t\t\tif(record[2] == 'vtf') arr[R][C] = [arr[R][C], _f];\n\t\t\t}\n\t\t}\n\t\tif(opts && opts.sheetRows) arr = arr.slice(0, opts.sheetRows);\n\t\treturn arr;\n\t}\n\n\tfunction eth_to_sheet(d/*:string*/, opts)/*:Worksheet*/ { return aoa_to_sheet(eth_to_aoa(d, opts), opts); }\n\tfunction eth_to_workbook(d/*:string*/, opts)/*:Workbook*/ { return sheet_to_workbook(eth_to_sheet(d, opts), opts); }\n\n\tvar header = [\n\t\t\"socialcalc:version:1.5\",\n\t\t\"MIME-Version: 1.0\",\n\t\t\"Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave\"\n\t].join(\"\\n\");\n\n\tvar sep = [\n\t\t\"--SocialCalcSpreadsheetControlSave\",\n\t\t\"Content-type: text/plain; charset=UTF-8\"\n\t].join(\"\\n\") + \"\\n\";\n\n\t/* TODO: the other parts */\n\tvar meta = [\n\t\t\"# SocialCalc Spreadsheet Control Save\",\n\t\t\"part:sheet\"\n\t].join(\"\\n\");\n\n\tvar end = \"--SocialCalcSpreadsheetControlSave--\";\n\n\tfunction sheet_to_eth_data(ws/*:Worksheet*/)/*:string*/ {\n\t\tif(!ws || !ws['!ref']) return \"\";\n\t\tvar o/*:Array<string>*/ = [], oo/*:Array<string>*/ = [], cell, coord = \"\";\n\t\tvar r = decode_range(ws['!ref']);\n\t\tvar dense = Array.isArray(ws);\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tcoord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[R]||[])[C] : ws[coord];\n\t\t\t\tif(!cell || cell.v == null || cell.t === 'z') continue;\n\t\t\t\too = [\"cell\", coord, 't'];\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 's': case 'str': oo.push(encode(cell.v)); break;\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\tif(!cell.f) { oo[2]='v'; oo[3]=cell.v; }\n\t\t\t\t\t\telse { oo[2]='vtf'; oo[3]='n'; oo[4]=cell.v; oo[5]=encode(cell.f); }\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\too[2] = 'vt'+(cell.f?'f':'c'); oo[3]='nl'; oo[4]=cell.v?\"1\":\"0\";\n\t\t\t\t\t\too[5] = encode(cell.f||(cell.v?'TRUE':'FALSE'));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\tvar t = datenum(parseDate(cell.v));\n\t\t\t\t\t\too[2] = 'vtc'; oo[3] = 'nd'; oo[4] = \"\"+t;\n\t\t\t\t\t\too[5] = cell.w || SSF_format(cell.z || table_fmt[14], t);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'e': continue;\n\t\t\t\t}\n\t\t\t\to.push(oo.join(\":\"));\n\t\t\t}\n\t\t}\n\t\to.push(\"sheet:c:\" + (r.e.c-r.s.c+1) + \":r:\" + (r.e.r-r.s.r+1) + \":tvf:1\");\n\t\to.push(\"valueformat:1:text-wiki\");\n\t\t//o.push(\"copiedfrom:\" + ws['!ref']); // clipboard only\n\t\treturn o.join(\"\\n\");\n\t}\n\n\tfunction sheet_to_eth(ws/*:Worksheet*//*::, opts:?any*/)/*:string*/ {\n\t\treturn [header, sep, meta, sep, sheet_to_eth_data(ws), end].join(\"\\n\");\n\t\t// return [\"version:1.5\", sheet_to_eth_data(ws)].join(\"\\n\"); // clipboard form\n\t}\n\n\treturn {\n\t\tto_workbook: eth_to_workbook,\n\t\tto_sheet: eth_to_sheet,\n\t\tfrom_sheet: sheet_to_eth\n\t};\n})();\n\nvar PRN = /*#__PURE__*/(function() {\n\tfunction set_text_arr(data/*:string*/, arr/*:AOA*/, R/*:number*/, C/*:number*/, o/*:any*/) {\n\t\tif(o.raw) arr[R][C] = data;\n\t\telse if(data === \"\"){/* empty */}\n\t\telse if(data === 'TRUE') arr[R][C] = true;\n\t\telse if(data === 'FALSE') arr[R][C] = false;\n\t\telse if(!isNaN(fuzzynum(data))) arr[R][C] = fuzzynum(data);\n\t\telse if(!isNaN(fuzzydate(data).getDate())) arr[R][C] = parseDate(data);\n\t\telse arr[R][C] = data;\n\t}\n\n\tfunction prn_to_aoa_str(f/*:string*/, opts)/*:AOA*/ {\n\t\tvar o = opts || {};\n\t\tvar arr/*:AOA*/ = ([]/*:any*/);\n\t\tif(!f || f.length === 0) return arr;\n\t\tvar lines = f.split(/[\\r\\n]/);\n\t\tvar L = lines.length - 1;\n\t\twhile(L >= 0 && lines[L].length === 0) --L;\n\t\tvar start = 10, idx = 0;\n\t\tvar R = 0;\n\t\tfor(; R <= L; ++R) {\n\t\t\tidx = lines[R].indexOf(\" \");\n\t\t\tif(idx == -1) idx = lines[R].length; else idx++;\n\t\t\tstart = Math.max(start, idx);\n\t\t}\n\t\tfor(R = 0; R <= L; ++R) {\n\t\t\tarr[R] = [];\n\t\t\t/* TODO: confirm that widths are always 10 */\n\t\t\tvar C = 0;\n\t\t\tset_text_arr(lines[R].slice(0, start).trim(), arr, R, C, o);\n\t\t\tfor(C = 1; C <= (lines[R].length - start)/10 + 1; ++C)\n\t\t\t\tset_text_arr(lines[R].slice(start+(C-1)*10,start+C*10).trim(),arr,R,C,o);\n\t\t}\n\t\tif(o.sheetRows) arr = arr.slice(0, o.sheetRows);\n\t\treturn arr;\n\t}\n\n\t// List of accepted CSV separators\n\tvar guess_seps = {\n\t\t/*::[*/0x2C/*::]*/: ',',\n\t\t/*::[*/0x09/*::]*/: \"\\t\",\n\t\t/*::[*/0x3B/*::]*/: ';',\n\t\t/*::[*/0x7C/*::]*/: '|'\n\t};\n\n\t// CSV separator weights to be used in case of equal numbers\n\tvar guess_sep_weights = {\n\t\t/*::[*/0x2C/*::]*/: 3,\n\t\t/*::[*/0x09/*::]*/: 2,\n\t\t/*::[*/0x3B/*::]*/: 1,\n\t\t/*::[*/0x7C/*::]*/: 0\n\t};\n\n\tfunction guess_sep(str) {\n\t\tvar cnt = {}, instr = false, end = 0, cc = 0;\n\t\tfor(;end < str.length;++end) {\n\t\t\tif((cc=str.charCodeAt(end)) == 0x22) instr = !instr;\n\t\t\telse if(!instr && cc in guess_seps) cnt[cc] = (cnt[cc]||0)+1;\n\t\t}\n\n\t\tcc = [];\n\t\tfor(end in cnt) if ( Object.prototype.hasOwnProperty.call(cnt, end) ) {\n\t\t\tcc.push([ cnt[end], end ]);\n\t\t}\n\n\t\tif ( !cc.length ) {\n\t\t\tcnt = guess_sep_weights;\n\t\t\tfor(end in cnt) if ( Object.prototype.hasOwnProperty.call(cnt, end) ) {\n\t\t\t\tcc.push([ cnt[end], end ]);\n\t\t\t}\n\t\t}\n\n\t\tcc.sort(function(a, b) { return a[0] - b[0] || guess_sep_weights[a[1]] - guess_sep_weights[b[1]]; });\n\n\t\treturn guess_seps[cc.pop()[1]] || 0x2C;\n\t}\n\n\tfunction dsv_to_sheet_str(str/*:string*/, opts)/*:Worksheet*/ {\n\t\tvar o = opts || {};\n\t\tvar sep = \"\";\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar ws/*:Worksheet*/ = o.dense ? ([]/*:any*/) : ({}/*:any*/);\n\t\tvar range/*:Range*/ = ({s: {c:0, r:0}, e: {c:0, r:0}}/*:any*/);\n\n\t\tif(str.slice(0,4) == \"sep=\") {\n\t\t\t// If the line ends in \\r\\n\n\t\t\tif(str.charCodeAt(5) == 13 && str.charCodeAt(6) == 10 ) {\n\t\t\t\tsep = str.charAt(4); str = str.slice(7);\n\t\t\t}\n\t\t\t// If line ends in \\r OR \\n\n\t\t\telse if(str.charCodeAt(5) == 13 || str.charCodeAt(5) == 10 ) {\n\t\t\t\tsep = str.charAt(4); str = str.slice(6);\n\t\t\t}\n\t\t\telse sep = guess_sep(str.slice(0,1024));\n\t\t}\n\t\telse if(o && o.FS) sep = o.FS;\n\t\telse sep = guess_sep(str.slice(0,1024));\n\t\tvar R = 0, C = 0, v = 0;\n\t\tvar start = 0, end = 0, sepcc = sep.charCodeAt(0), instr = false, cc=0, startcc=str.charCodeAt(0);\n\t\tstr = str.replace(/\\r\\n/mg, \"\\n\");\n\t\tvar _re/*:?RegExp*/ = o.dateNF != null ? dateNF_regex(o.dateNF) : null;\n\t\tfunction finish_cell() {\n\t\t\tvar s = str.slice(start, end);\n\t\t\tvar cell = ({}/*:any*/);\n\t\t\tif(s.charAt(0) == '\"' && s.charAt(s.length - 1) == '\"') s = s.slice(1,-1).replace(/\"\"/g,'\"');\n\t\t\tif(s.length === 0) cell.t = 'z';\n\t\t\telse if(o.raw) { cell.t = 's'; cell.v = s; }\n\t\t\telse if(s.trim().length === 0) { cell.t = 's'; cell.v = s; }\n\t\t\telse if(s.charCodeAt(0) == 0x3D) {\n\t\t\t\tif(s.charCodeAt(1) == 0x22 && s.charCodeAt(s.length - 1) == 0x22) { cell.t = 's'; cell.v = s.slice(2,-1).replace(/\"\"/g,'\"'); }\n\t\t\t\telse if(fuzzyfmla(s)) { cell.t = 'n'; cell.f = s.slice(1); }\n\t\t\t\telse { cell.t = 's'; cell.v = s; } }\n\t\t\telse if(s == \"TRUE\") { cell.t = 'b'; cell.v = true; }\n\t\t\telse if(s == \"FALSE\") { cell.t = 'b'; cell.v = false; }\n\t\t\telse if(!isNaN(v = fuzzynum(s))) { cell.t = 'n'; if(o.cellText !== false) cell.w = s; cell.v = v; }\n\t\t\telse if(!isNaN(fuzzydate(s).getDate()) || _re && s.match(_re)) {\n\t\t\t\tcell.z = o.dateNF || table_fmt[14];\n\t\t\t\tvar k = 0;\n\t\t\t\tif(_re && s.match(_re)){ s=dateNF_fix(s, o.dateNF, (s.match(_re)||[])); k=1; }\n\t\t\t\tif(o.cellDates) { cell.t = 'd'; cell.v = parseDate(s, k); }\n\t\t\t\telse { cell.t = 'n'; cell.v = datenum(parseDate(s, k)); }\n\t\t\t\tif(o.cellText !== false) cell.w = SSF_format(cell.z, cell.v instanceof Date ? datenum(cell.v):cell.v);\n\t\t\t\tif(!o.cellNF) delete cell.z;\n\t\t\t} else {\n\t\t\t\tcell.t = 's';\n\t\t\t\tcell.v = s;\n\t\t\t}\n\t\t\tif(cell.t == 'z'){}\n\t\t\telse if(o.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = cell; }\n\t\t\telse ws[encode_cell({c:C,r:R})] = cell;\n\t\t\tstart = end+1; startcc = str.charCodeAt(start);\n\t\t\tif(range.e.c < C) range.e.c = C;\n\t\t\tif(range.e.r < R) range.e.r = R;\n\t\t\tif(cc == sepcc) ++C; else { C = 0; ++R; if(o.sheetRows && o.sheetRows <= R) return true; }\n\t\t}\n\t\touter: for(;end < str.length;++end) switch((cc=str.charCodeAt(end))) {\n\t\t\tcase 0x22: if(startcc === 0x22) instr = !instr; break;\n\t\t\tcase sepcc: case 0x0a: case 0x0d: if(!instr && finish_cell()) break outer; break;\n\t\t\tdefault: break;\n\t\t}\n\t\tif(end - start > 0) finish_cell();\n\n\t\tws['!ref'] = encode_range(range);\n\t\treturn ws;\n\t}\n\n\tfunction prn_to_sheet_str(str/*:string*/, opts)/*:Worksheet*/ {\n\t\tif(!(opts && opts.PRN)) return dsv_to_sheet_str(str, opts);\n\t\tif(opts.FS) return dsv_to_sheet_str(str, opts);\n\t\tif(str.slice(0,4) == \"sep=\") return dsv_to_sheet_str(str, opts);\n\t\tif(str.indexOf(\"\\t\") >= 0 || str.indexOf(\",\") >= 0 || str.indexOf(\";\") >= 0) return dsv_to_sheet_str(str, opts);\n\t\treturn aoa_to_sheet(prn_to_aoa_str(str, opts), opts);\n\t}\n\n\tfunction prn_to_sheet(d/*:RawData*/, opts)/*:Worksheet*/ {\n\t\tvar str = \"\", bytes = opts.type == 'string' ? [0,0,0,0] : firstbyte(d, opts);\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': str = Base64_decode(d); break;\n\t\t\tcase 'binary': str = d; break;\n\t\t\tcase 'buffer':\n\t\t\t\tif(opts.codepage == 65001) str = d.toString('utf8'); // TODO: test if buf\n\t\t\t\telse if(opts.codepage && typeof $cptable !== 'undefined') str = $cptable.utils.decode(opts.codepage, d);\n\t\t\t\telse str = has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d);\n\t\t\t\tbreak;\n\t\t\tcase 'array': str = cc2str(d); break;\n\t\t\tcase 'string': str = d; break;\n\t\t\tdefault: throw new Error(\"Unrecognized type \" + opts.type);\n\t\t}\n\t\tif(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str.slice(3));\n\t\telse if(opts.type != 'string' && opts.type != 'buffer' && opts.codepage == 65001) str = utf8read(str);\n\t\telse if((opts.type == 'binary') && typeof $cptable !== 'undefined' && opts.codepage)  str = $cptable.utils.decode(opts.codepage, $cptable.utils.encode(28591,str));\n\t\tif(str.slice(0,19) == \"socialcalc:version:\") return ETH.to_sheet(opts.type == 'string' ? str : utf8read(str), opts);\n\t\treturn prn_to_sheet_str(str, opts);\n\t}\n\n\tfunction prn_to_workbook(d/*:RawData*/, opts)/*:Workbook*/ { return sheet_to_workbook(prn_to_sheet(d, opts), opts); }\n\n\tfunction sheet_to_prn(ws/*:Worksheet*//*::, opts:?any*/)/*:string*/ {\n\t\tvar o/*:Array<string>*/ = [];\n\t\tvar r = safe_decode_range(ws['!ref']), cell/*:Cell*/;\n\t\tvar dense = Array.isArray(ws);\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\tvar oo/*:Array<string>*/ = [];\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[R]||[])[C] : ws[coord];\n\t\t\t\tif(!cell || cell.v == null) { oo.push(\"          \"); continue; }\n\t\t\t\tvar w = (cell.w || (format_cell(cell), cell.w) || \"\").slice(0,10);\n\t\t\t\twhile(w.length < 10) w += \" \";\n\t\t\t\too.push(w + (C === 0 ? \" \" : \"\"));\n\t\t\t}\n\t\t\to.push(oo.join(\"\"));\n\t\t}\n\t\treturn o.join(\"\\n\");\n\t}\n\n\treturn {\n\t\tto_workbook: prn_to_workbook,\n\t\tto_sheet: prn_to_sheet,\n\t\tfrom_sheet: sheet_to_prn\n\t};\n})();\n\n/* Excel defaults to SYLK but warns if data is not valid */\nfunction read_wb_ID(d, opts) {\n\tvar o = opts || {}, OLD_WTF = !!o.WTF; o.WTF = true;\n\ttry {\n\t\tvar out = SYLK.to_workbook(d, o);\n\t\to.WTF = OLD_WTF;\n\t\treturn out;\n\t} catch(e) {\n\t\to.WTF = OLD_WTF;\n\t\tif(!e.message.match(/SYLK bad record ID/) && OLD_WTF) throw e;\n\t\treturn PRN.to_workbook(d, opts);\n\t}\n}\n\nvar WK_ = /*#__PURE__*/(function() {\n\tfunction lotushopper(data, cb/*:RecordHopperCB*/, opts/*:any*/) {\n\t\tif(!data) return;\n\t\tprep_blob(data, data.l || 0);\n\t\tvar Enum = opts.Enum || WK1Enum;\n\t\twhile(data.l < data.length) {\n\t\t\tvar RT = data.read_shift(2);\n\t\t\tvar R = Enum[RT] || Enum[0xFFFF];\n\t\t\tvar length = data.read_shift(2);\n\t\t\tvar tgt = data.l + length;\n\t\t\tvar d = R.f && R.f(data, length, opts);\n\t\t\tdata.l = tgt;\n\t\t\tif(cb(d, R, RT)) return;\n\t\t}\n\t}\n\n\tfunction lotus_to_workbook(d/*:RawData*/, opts) {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return lotus_to_workbook_buf(s2a(Base64_decode(d)), opts);\n\t\t\tcase 'binary': return lotus_to_workbook_buf(s2a(d), opts);\n\t\t\tcase 'buffer':\n\t\t\tcase 'array': return lotus_to_workbook_buf(d, opts);\n\t\t}\n\t\tthrow \"Unsupported type \" + opts.type;\n\t}\n\n\tfunction lotus_to_workbook_buf(d, opts)/*:Workbook*/ {\n\t\tif(!d) return d;\n\t\tvar o = opts || {};\n\t\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\t\tvar s/*:Worksheet*/ = ((o.dense ? [] : {})/*:any*/), n = \"Sheet1\", next_n = \"\", sidx = 0;\n\t\tvar sheets = {}, snames = [], realnames = [];\n\n\t\tvar refguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\tvar sheetRows = o.sheetRows || 0;\n\n\t\tif(d[2] == 0x00) {\n\t\t\tif(d[3] == 0x08 || d[3] == 0x09) {\n\t\t\t\tif(d.length >= 16 && d[14] == 0x05 && d[15] === 0x6c) throw new Error(\"Unsupported Works 3 for Mac file\");\n\t\t\t}\n\t\t}\n\n\t\tif(d[2] == 0x02) {\n\t\t\to.Enum = WK1Enum;\n\t\t\tlotushopper(d, function(val, R, RT) { switch(RT) {\n\t\t\t\tcase 0x00: /* BOF */\n\t\t\t\t\to.vers = val;\n\t\t\t\t\tif(val >= 0x1000) o.qpro = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x06: refguess = val; break; /* RANGE */\n\t\t\t\tcase 0xCC: if(val) next_n = val; break; /* SHEETNAMECS */\n\t\t\t\tcase 0xDE: next_n = val; break; /* SHEETNAMELP */\n\t\t\t\tcase 0x0F: /* LABEL */\n\t\t\t\tcase 0x33: /* STRING */\n\t\t\t\t\tif(!o.qpro) val[1].v = val[1].v.slice(1);\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 0x0D: /* INTEGER */\n\t\t\t\tcase 0x0E: /* NUMBER */\n\t\t\t\tcase 0x10: /* FORMULA */\n\t\t\t\t\t/* TODO: actual translation of the format code */\n\t\t\t\t\tif(RT == 0x0E && (val[2] & 0x70) == 0x70 && (val[2] & 0x0F) > 1 && (val[2] & 0x0F) < 15) {\n\t\t\t\t\t\tval[1].z = o.dateNF || table_fmt[14];\n\t\t\t\t\t\tif(o.cellDates) { val[1].t = 'd'; val[1].v = numdate(val[1].v); }\n\t\t\t\t\t}\n\n\t\t\t\t\tif(o.qpro) {\n\t\t\t\t\t\tif(val[3] > sidx) {\n\t\t\t\t\t\t\ts[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t\t\tsheets[n] = s;\n\t\t\t\t\t\t\tsnames.push(n);\n\t\t\t\t\t\t\ts = (o.dense ? [] : {});\n\t\t\t\t\t\t\trefguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\t\t\t\t\t\tsidx = val[3]; n = next_n || \"Sheet\" + (sidx + 1); next_n = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar tmpcell = o.dense ? (s[val[0].r]||[])[val[0].c] : s[encode_cell(val[0])];\n\t\t\t\t\tif(tmpcell) {\n\t\t\t\t\t\ttmpcell.t = val[1].t; tmpcell.v = val[1].v;\n\t\t\t\t\t\tif(val[1].z != null) tmpcell.z = val[1].z;\n\t\t\t\t\t\tif(val[1].f != null) tmpcell.f = val[1].f;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(o.dense) {\n\t\t\t\t\t\tif(!s[val[0].r]) s[val[0].r] = [];\n\t\t\t\t\t\ts[val[0].r][val[0].c] = val[1];\n\t\t\t\t\t} else s[encode_cell(val[0])] = val[1];\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t}}, o);\n\t\t} else if(d[2] == 0x1A || d[2] == 0x0E) {\n\t\t\to.Enum = WK3Enum;\n\t\t\tif(d[2] == 0x0E) { o.qpro = true; d.l = 0; }\n\t\t\tlotushopper(d, function(val, R, RT) { switch(RT) {\n\t\t\t\tcase 0xCC: n = val; break; /* SHEETNAMECS */\n\t\t\t\tcase 0x16: /* LABEL16 */\n\t\t\t\t\tval[1].v = val[1].v.slice(1);\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 0x17: /* NUMBER17 */\n\t\t\t\tcase 0x18: /* NUMBER18 */\n\t\t\t\tcase 0x19: /* FORMULA19 */\n\t\t\t\tcase 0x25: /* NUMBER25 */\n\t\t\t\tcase 0x27: /* NUMBER27 */\n\t\t\t\tcase 0x28: /* FORMULA28 */\n\t\t\t\t\tif(val[3] > sidx) {\n\t\t\t\t\t\ts[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t\tsheets[n] = s;\n\t\t\t\t\t\tsnames.push(n);\n\t\t\t\t\t\ts = (o.dense ? [] : {});\n\t\t\t\t\t\trefguess = {s: {r:0, c:0}, e: {r:0, c:0} };\n\t\t\t\t\t\tsidx = val[3]; n = \"Sheet\" + (sidx + 1);\n\t\t\t\t\t}\n\t\t\t\t\tif(sheetRows > 0 && val[0].r >= sheetRows) break;\n\t\t\t\t\tif(o.dense) {\n\t\t\t\t\t\tif(!s[val[0].r]) s[val[0].r] = [];\n\t\t\t\t\t\ts[val[0].r][val[0].c] = val[1];\n\t\t\t\t\t} else s[encode_cell(val[0])] = val[1];\n\t\t\t\t\tif(refguess.e.c < val[0].c) refguess.e.c = val[0].c;\n\t\t\t\t\tif(refguess.e.r < val[0].r) refguess.e.r = val[0].r;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x1B: /* XFORMAT */\n\t\t\t\t\tif(val[0x36b0]) realnames[val[0x36b0][0]] = val[0x36b0][1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0601: /* SHEETINFOQP */\n\t\t\t\t\trealnames[val[0]] = val[1]; if(val[0] == sidx) n = val[1]; break;\n\t\t\t\tdefault: break;\n\t\t\t}}, o);\n\t\t} else throw new Error(\"Unrecognized LOTUS BOF \" + d[2]);\n\t\ts[\"!ref\"] = encode_range(refguess);\n\t\tsheets[next_n || n] = s;\n\t\tsnames.push(next_n || n);\n\t\tif(!realnames.length) return { SheetNames: snames, Sheets: sheets };\n\t\tvar osheets = {}, rnames = [];\n\t\t/* TODO: verify no collisions */\n\t\tfor(var i = 0; i < realnames.length; ++i) if(sheets[snames[i]]) {\n\t\t\trnames.push(realnames[i] || snames[i]);\n\t\t\tosheets[realnames[i]] = sheets[realnames[i]] || sheets[snames[i]];\n\t\t} else {\n\t\t\trnames.push(realnames[i]);\n\t\t\tosheets[realnames[i]] = ({ \"!ref\": \"A1\" });\n\t\t}\n\t\treturn { SheetNames: rnames, Sheets: osheets };\n\t}\n\n\tfunction sheet_to_wk1(ws/*:Worksheet*/, opts/*:WriteOpts*/) {\n\t\tvar o = opts || {};\n\t\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\t\tif(o.type == \"string\") throw new Error(\"Cannot write WK1 to JS string\");\n\t\tvar ba = buf_array();\n\t\tvar range = safe_decode_range(ws[\"!ref\"]);\n\t\tvar dense = Array.isArray(ws);\n\t\tvar cols = [];\n\n\t\twrite_biff_rec(ba, 0x00, write_BOF_WK1(0x0406));\n\t\twrite_biff_rec(ba, 0x06, write_RANGE(range));\n\t\tvar max_R = Math.min(range.e.r, 8191);\n\t\tfor(var R = range.s.r; R <= max_R; ++R) {\n\t\t\tvar rr = encode_row(R);\n\t\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\t\tvar ref = cols[C] + rr;\n\t\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\t\tif(!cell || cell.t == \"z\") continue;\n\t\t\t\t/* TODO: formula records */\n\t\t\t\tif(cell.t == \"n\") {\n\t\t\t\t\tif((cell.v|0)==cell.v && cell.v >= -32768 && cell.v <= 32767) write_biff_rec(ba, 0x0d, write_INTEGER(R, C, cell.v));\n\t\t\t\t\telse write_biff_rec(ba, 0x0e, write_NUMBER(R, C, cell.v));\n\t\t\t\t} else {\n\t\t\t\t\tvar str = format_cell(cell);\n\t\t\t\t\twrite_biff_rec(ba, 0x0F, write_LABEL(R, C, str.slice(0, 239)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\twrite_biff_rec(ba, 0x01);\n\t\treturn ba.end();\n\t}\n\n\tfunction book_to_wk3(wb/*:Workbook*/, opts/*:WriteOpts*/) {\n\t\tvar o = opts || {};\n\t\tif(+o.codepage >= 0) set_cp(+o.codepage);\n\t\tif(o.type == \"string\") throw new Error(\"Cannot write WK3 to JS string\");\n\t\tvar ba = buf_array();\n\n\t\twrite_biff_rec(ba, 0x00, write_BOF_WK3(wb));\n\n\t\tfor(var i = 0, cnt = 0; i < wb.SheetNames.length; ++i) if((wb.Sheets[wb.SheetNames[i]] || {})[\"!ref\"]) write_biff_rec(ba, 0x1b, write_XFORMAT_SHEETNAME(wb.SheetNames[i], cnt++));\n\n\t\tvar wsidx = 0;\n\t\tfor(i = 0; i < wb.SheetNames.length; ++i) {\n\t\t\tvar ws = wb.Sheets[wb.SheetNames[i]];\n\t\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\t\tvar range = safe_decode_range(ws[\"!ref\"]);\n\t\t\tvar dense = Array.isArray(ws);\n\t\t\tvar cols = [];\n\t\t\tvar max_R = Math.min(range.e.r, 8191);\n\t\t\tfor(var R = range.s.r; R <= max_R; ++R) {\n\t\t\t\tvar rr = encode_row(R);\n\t\t\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\t\t\tvar ref = cols[C] + rr;\n\t\t\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\t\t\tif(!cell || cell.t == \"z\") continue;\n\t\t\t\t\t/* TODO: FORMULA19 NUMBER18 records */\n\t\t\t\t\tif(cell.t == \"n\") {\n\t\t\t\t\t\twrite_biff_rec(ba, 0x17, write_NUMBER_17(R, C, wsidx, cell.v));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar str = format_cell(cell);\n\t\t\t\t\t\t/* TODO: max len? */\n\t\t\t\t\t\twrite_biff_rec(ba, 0x16, write_LABEL_16(R, C, wsidx, str.slice(0, 239)));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t++wsidx;\n\t\t}\n\n\t\twrite_biff_rec(ba, 0x01);\n\t\treturn ba.end();\n\t}\n\n\n\tfunction write_BOF_WK1(v/*:number*/) {\n\t\tvar out = new_buf(2);\n\t\tout.write_shift(2, v);\n\t\treturn out;\n\t}\n\n\tfunction write_BOF_WK3(wb/*:Workbook*/) {\n\t\tvar out = new_buf(26);\n\t\tout.write_shift(2, 0x1000);\n\t\tout.write_shift(2, 0x0004);\n\t\tout.write_shift(4, 0x0000);\n\t\tvar rows = 0, cols = 0, wscnt = 0;\n\t\tfor(var i = 0; i < wb.SheetNames.length; ++i) {\n\t\t\tvar name = wb.SheetNames[i];\n\t\t\tvar ws = wb.Sheets[name];\n\t\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\t\t++wscnt;\n\t\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\t\tif(rows < range.e.r) rows = range.e.r;\n\t\t\tif(cols < range.e.c) cols = range.e.c;\n\t\t}\n\t\tif(rows > 8191) rows = 8191;\n\t\tout.write_shift(2, rows);\n\t\tout.write_shift(1, wscnt);\n\t\tout.write_shift(1, cols);\n\t\tout.write_shift(2, 0x00);\n\t\tout.write_shift(2, 0x00);\n\t\tout.write_shift(1, 0x01);\n\t\tout.write_shift(1, 0x02);\n\t\tout.write_shift(4, 0);\n\t\tout.write_shift(4, 0);\n\t\treturn out;\n\t}\n\n\tfunction parse_RANGE(blob, length, opts) {\n\t\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\t\tif(length == 8 && opts.qpro) {\n\t\t\to.s.c = blob.read_shift(1);\n\t\t\tblob.l++;\n\t\t\to.s.r = blob.read_shift(2);\n\t\t\to.e.c = blob.read_shift(1);\n\t\t\tblob.l++;\n\t\t\to.e.r = blob.read_shift(2);\n\t\t\treturn o;\n\t\t}\n\t\to.s.c = blob.read_shift(2);\n\t\to.s.r = blob.read_shift(2);\n\t\tif(length == 12 && opts.qpro) blob.l += 2;\n\t\to.e.c = blob.read_shift(2);\n\t\to.e.r = blob.read_shift(2);\n\t\tif(length == 12 && opts.qpro) blob.l += 2;\n\t\tif(o.s.c == 0xFFFF) o.s.c = o.e.c = o.s.r = o.e.r = 0;\n\t\treturn o;\n\t}\n\tfunction write_RANGE(range) {\n\t\tvar out = new_buf(8);\n\t\tout.write_shift(2, range.s.c);\n\t\tout.write_shift(2, range.s.r);\n\t\tout.write_shift(2, range.e.c);\n\t\tout.write_shift(2, range.e.r);\n\t\treturn out;\n\t}\n\n\tfunction parse_cell(blob, length, opts) {\n\t\tvar o = [{c:0,r:0}, {t:'n',v:0}, 0, 0];\n\t\tif(opts.qpro && opts.vers != 0x5120) {\n\t\t\to[0].c = blob.read_shift(1);\n\t\t\to[3] = blob.read_shift(1);\n\t\t\to[0].r = blob.read_shift(2);\n\t\t\tblob.l+=2;\n\t\t} else {\n\t\t\to[2] = blob.read_shift(1);\n\t\t\to[0].c = blob.read_shift(2); o[0].r = blob.read_shift(2);\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction parse_LABEL(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].t = 's';\n\t\tif(opts.vers == 0x5120) {\n\t\t\tblob.l++;\n\t\t\tvar len = blob.read_shift(1);\n\t\t\to[1].v = blob.read_shift(len, 'utf8');\n\t\t\treturn o;\n\t\t}\n\t\tif(opts.qpro) blob.l++;\n\t\to[1].v = blob.read_shift(tgt - blob.l, 'cstr');\n\t\treturn o;\n\t}\n\tfunction write_LABEL(R, C, s) {\n\t\t/* TODO: encoding */\n\t\tvar o = new_buf(7 + s.length);\n\t\to.write_shift(1, 0xFF);\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, 0x27); // ??\n\t\tfor(var i = 0; i < o.length; ++i) {\n\t\t\tvar cc = s.charCodeAt(i);\n\t\t\to.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n\t\t}\n\t\to.write_shift(1, 0);\n\t\treturn o;\n\t}\n\n\tfunction parse_INTEGER(blob, length, opts) {\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].v = blob.read_shift(2, 'i');\n\t\treturn o;\n\t}\n\tfunction write_INTEGER(R, C, v) {\n\t\tvar o = new_buf(7);\n\t\to.write_shift(1, 0xFF);\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(2, v, 'i');\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER(blob, length, opts) {\n\t\tvar o = parse_cell(blob, length, opts);\n\t\to[1].v = blob.read_shift(8, 'f');\n\t\treturn o;\n\t}\n\tfunction write_NUMBER(R, C, v) {\n\t\tvar o = new_buf(13);\n\t\to.write_shift(1, 0xFF);\n\t\to.write_shift(2, C);\n\t\to.write_shift(2, R);\n\t\to.write_shift(8, v, 'f');\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA(blob, length, opts) {\n\t\tvar tgt = blob.l + length;\n\t\tvar o = parse_cell(blob, length, opts);\n\t\t/* TODO: formula */\n\t\to[1].v = blob.read_shift(8, 'f');\n\t\tif(opts.qpro) blob.l = tgt;\n\t\telse {\n\t\t\tvar flen = blob.read_shift(2);\n\t\t\twk1_fmla_to_csf(blob.slice(blob.l, blob.l + flen), o);\n\t\t\tblob.l += flen;\n\t\t}\n\t\treturn o;\n\t}\n\n\tfunction wk1_parse_rc(B, V, col) {\n\t\tvar rel = V & 0x8000;\n\t\tV &= ~0x8000;\n\t\tV = (rel ? B : 0) + ((V >= 0x2000) ? V - 0x4000 : V);\n\t\treturn (rel ? \"\" : \"$\") + (col ? encode_col(V) : encode_row(V));\n\t}\n\t/* var oprec = [\n\t\t8, 8, 8, 8, 8, 8, 8, 8, 6, 4, 4, 5, 5, 7, 3, 3,\n\t\t3, 3, 3, 3, 1, 1, 2, 6, 8, 8, 8, 8, 8, 8, 8, 8\n\t]; */\n\t/* TODO: flesh out */\n\tvar FuncTab = {\n\t\t0x33: [\"FALSE\", 0],\n\t\t0x34: [\"TRUE\", 0],\n\t\t0x46: [\"LEN\", 1],\n\t\t0x50: [\"SUM\", 69],\n\t\t0x51: [\"AVERAGEA\", 69],\n\t\t0x52: [\"COUNTA\", 69],\n\t\t0x53: [\"MINA\", 69],\n\t\t0x54: [\"MAXA\", 69],\n\t\t0x6F: [\"T\", 1]\n\t};\n\tvar BinOpTab = [\n\t\t  \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t  \"\",  \"+\",  \"-\",  \"*\",  \"/\",  \"^\",  \"=\", \"<>\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t\"<=\", \">=\",  \"<\",  \">\",   \"\",   \"\",   \"\",   \"\", // eslint-disable-line no-mixed-spaces-and-tabs\n\t\t \"&\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\",   \"\"  // eslint-disable-line no-mixed-spaces-and-tabs\n\t];\n\n\tfunction wk1_fmla_to_csf(blob, o) {\n\t\tprep_blob(blob, 0);\n\t\tvar out = [], argc = 0, R = \"\", C = \"\", argL = \"\", argR = \"\";\n\t\twhile(blob.l < blob.length) {\n\t\t\tvar cc = blob[blob.l++];\n\t\t\tswitch(cc) {\n\t\t\t\tcase 0x00: out.push(blob.read_shift(8, 'f')); break;\n\t\t\t\tcase 0x01: {\n\t\t\t\t\tC = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tR = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tout.push(C + R);\n\t\t\t\t} break;\n\t\t\t\tcase 0x02: {\n\t\t\t\t\tvar c = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tvar r = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tC = wk1_parse_rc(o[0].c, blob.read_shift(2), true);\n\t\t\t\t\tR = wk1_parse_rc(o[0].r, blob.read_shift(2), false);\n\t\t\t\t\tout.push(c + r + \":\" + C + R);\n\t\t\t\t} break;\n\t\t\t\tcase 0x03:\n\t\t\t\t\tif(blob.l < blob.length) { console.error(\"WK1 premature formula end\"); return; }\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x04: out.push(\"(\" + out.pop() + \")\"); break;\n\t\t\t\tcase 0x05: out.push(blob.read_shift(2)); break;\n\t\t\t\tcase 0x06: {\n\t\t\t\t\t/* TODO: text encoding */\n\t\t\t\t\tvar Z = \"\"; while((cc = blob[blob.l++])) Z += String.fromCharCode(cc);\n\t\t\t\t\tout.push('\"' + Z.replace(/\"/g, '\"\"') + '\"');\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x08: out.push(\"-\" + out.pop()); break;\n\t\t\t\tcase 0x17: out.push(\"+\" + out.pop()); break;\n\t\t\t\tcase 0x16: out.push(\"NOT(\" + out.pop() + \")\"); break;\n\n\t\t\t\tcase 0x14: case 0x15: {\n\t\t\t\t\targR = out.pop(); argL = out.pop();\n\t\t\t\t\tout.push([\"AND\", \"OR\"][cc - 0x14] + \"(\" + argL + \",\" + argR + \")\");\n\t\t\t\t} break;\n\n\t\t\t\tdefault:\n\t\t\t\t\tif(cc < 0x20 && BinOpTab[cc]) {\n\t\t\t\t\t\targR = out.pop(); argL = out.pop();\n\t\t\t\t\t\tout.push(argL + BinOpTab[cc] + argR);\n\t\t\t\t\t} else if(FuncTab[cc]) {\n\t\t\t\t\t\targc = FuncTab[cc][1];\n\t\t\t\t\t\tif(argc == 69) argc = blob[blob.l++];\n\t\t\t\t\t\tif(argc > out.length) { console.error(\"WK1 bad formula parse 0x\" + cc.toString(16) + \":|\" + out.join(\"|\") + \"|\"); return; }\n\t\t\t\t\t\tvar args = out.slice(-argc);\n\t\t\t\t\t\tout.length -= argc;\n\t\t\t\t\t\tout.push(FuncTab[cc][0] + \"(\" + args.join(\",\") + \")\");\n\t\t\t\t\t}\n\t\t\t\t\telse if(cc <= 0x07) return console.error(\"WK1 invalid opcode \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x18) return console.error(\"WK1 unsupported op \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x1E) return console.error(\"WK1 invalid opcode \" + cc.toString(16));\n\t\t\t\t\telse if(cc <= 0x73) return console.error(\"WK1 unsupported function opcode \" + cc.toString(16));\n\t\t\t\t\t// possible future functions ??\n\t\t\t\t\telse return console.error(\"WK1 unrecognized opcode \" + cc.toString(16));\n\t\t\t}\n\t\t}\n\t\tif(out.length == 1) o[1].f = \"\" + out[0];\n\t\telse console.error(\"WK1 bad formula parse |\" + out.join(\"|\") + \"|\");\n\t}\n\n\n\tfunction parse_cell_3(blob/*::, length*/) {\n\t\tvar o = [{c:0,r:0}, {t:'n',v:0}, 0];\n\t\to[0].r = blob.read_shift(2); o[3] = blob[blob.l++]; o[0].c = blob[blob.l++];\n\t\treturn o;\n\t}\n\n\tfunction parse_LABEL_16(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\to[1].t = 's';\n\t\to[1].v = blob.read_shift(length - 4, 'cstr');\n\t\treturn o;\n\t}\n\tfunction write_LABEL_16(R, C, wsidx, s) {\n\t\t/* TODO: encoding */\n\t\tvar o = new_buf(6 + s.length);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, wsidx);\n\t\to.write_shift(1, C);\n\t\to.write_shift(1, 0x27);\n\t\tfor(var i = 0; i < s.length; ++i) {\n\t\t\tvar cc = s.charCodeAt(i);\n\t\t\to.write_shift(1, cc >= 0x80 ? 0x5F : cc);\n\t\t}\n\t\to.write_shift(1, 0);\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_18(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\to[1].v = blob.read_shift(2);\n\t\tvar v = o[1].v >> 1;\n\t\tif(o[1].v & 0x1) {\n\t\t\tswitch(v & 0x07) {\n\t\t\t\tcase 0: v = (v >> 3) * 5000; break;\n\t\t\t\tcase 1: v = (v >> 3) * 500; break;\n\t\t\t\tcase 2: v = (v >> 3) / 20; break;\n\t\t\t\tcase 3: v = (v >> 3) / 200; break;\n\t\t\t\tcase 4: v = (v >> 3) / 2000; break;\n\t\t\t\tcase 5: v = (v >> 3) / 20000; break;\n\t\t\t\tcase 6: v = (v >> 3) / 16; break;\n\t\t\t\tcase 7: v = (v >> 3) / 64; break;\n\t\t\t}\n\t\t}\n\t\to[1].v = v;\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_17(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(4);\n\t\tvar v2 = blob.read_shift(4);\n\t\tvar e = blob.read_shift(2);\n\t\tif(e == 0xFFFF) {\n\t\t\tif(v1 === 0 && v2 === 0xC0000000) { o[1].t = \"e\"; o[1].v = 0x0F; } // ERR -> #VALUE!\n\t\t\telse if(v1 === 0 && v2 === 0xD0000000) { o[1].t = \"e\"; o[1].v = 0x2A; } // NA -> #N/A\n\t\t\telse o[1].v = 0;\n\t\t\treturn o;\n\t\t}\n\t\tvar s = e & 0x8000; e = (e&0x7FFF) - 16446;\n\t\to[1].v = (1 - s*2) * (v2 * Math.pow(2, e+32) + v1 * Math.pow(2, e));\n\t\treturn o;\n\t}\n\tfunction write_NUMBER_17(R, C, wsidx, v) {\n\t\tvar o = new_buf(14);\n\t\to.write_shift(2, R);\n\t\to.write_shift(1, wsidx);\n\t\to.write_shift(1, C);\n\t\tif(v == 0) {\n\t\t\to.write_shift(4, 0);\n\t\t\to.write_shift(4, 0);\n\t\t\to.write_shift(2, 0xFFFF);\n\t\t\treturn o;\n\t\t}\n\t\tvar s = 0, e = 0, v1 = 0, v2 = 0;\n\t\tif(v < 0) { s = 1; v = -v; }\n\t\te = Math.log2(v) | 0;\n\t\tv /= Math.pow(2, e-31);\n\t\tv2 = (v)>>>0;\n\t\tif((v2&0x80000000) == 0) { v/=2; ++e; v2 = v >>> 0; }\n\t\tv -= v2;\n\t\tv2 |= 0x80000000;\n\t\tv2 >>>= 0;\n\t\tv *= Math.pow(2, 32);\n\t\tv1 = v>>>0;\n\t\to.write_shift(4, v1);\n\t\to.write_shift(4, v2);\n\t\te += 0x3FFF + (s ? 0x8000 : 0);\n\t\to.write_shift(2, e);\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA_19(blob, length) {\n\t\tvar o = parse_NUMBER_17(blob, 14);\n\t\tblob.l += length - 14; /* TODO: WK3 formula */\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_25(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(4);\n\t\to[1].v = v1 >> 6;\n\t\treturn o;\n\t}\n\n\tfunction parse_NUMBER_27(blob, length) {\n\t\tvar o = parse_cell_3(blob, length);\n\t\tvar v1 = blob.read_shift(8,'f');\n\t\to[1].v = v1;\n\t\treturn o;\n\t}\n\n\tfunction parse_FORMULA_28(blob, length) {\n\t\tvar o = parse_NUMBER_27(blob, 14);\n\t\tblob.l += length - 10; /* TODO: formula */\n\t\treturn o;\n\t}\n\n\tfunction parse_SHEETNAMECS(blob, length) {\n\t\treturn blob[blob.l + length - 1] == 0 ? blob.read_shift(length, 'cstr') : \"\";\n\t}\n\n\tfunction parse_SHEETNAMELP(blob, length) {\n\t\tvar len = blob[blob.l++];\n\t\tif(len > length - 1) len = length - 1;\n\t\tvar o = \"\"; while(o.length < len) o += String.fromCharCode(blob[blob.l++]);\n\t\treturn o;\n\t}\n\n\tfunction parse_SHEETINFOQP(blob, length, opts) {\n\t\tif(!opts.qpro || length < 21) return;\n\t\tvar id = blob.read_shift(1);\n\t\tblob.l += 17;\n\t\tblob.l += 1; //var len = blob.read_shift(1);\n\t\tblob.l += 2;\n\t\tvar nm = blob.read_shift(length - 21, 'cstr');\n\t\treturn [id, nm];\n\t}\n\n\tfunction parse_XFORMAT(blob, length) {\n\t\tvar o = {}, tgt = blob.l + length;\n\t\twhile(blob.l < tgt) {\n\t\t\tvar dt = blob.read_shift(2);\n\t\t\tif(dt == 0x36b0) {\n\t\t\t\to[dt] = [0, \"\"];\n\t\t\t\to[dt][0] = blob.read_shift(2);\n\t\t\t\twhile(blob[blob.l]) { o[dt][1] += String.fromCharCode(blob[blob.l]); blob.l++; } blob.l++;\n\t\t\t}\n\t\t\t// TODO: 0x3a99 ??\n\t\t}\n\t\treturn o;\n\t}\n\tfunction write_XFORMAT_SHEETNAME(name, wsidx) {\n\t\tvar out = new_buf(5 + name.length);\n\t\tout.write_shift(2, 0x36b0);\n\t\tout.write_shift(2, wsidx);\n\t\tfor(var i = 0; i < name.length; ++i) {\n\t\t\tvar cc = name.charCodeAt(i);\n\t\t\tout[out.l++] = cc > 0x7F ? 0x5F : cc;\n\t\t}\n\t\tout[out.l++] = 0;\n\t\treturn out;\n\t}\n\n\tvar WK1Enum = {\n\t\t/*::[*/0x0000/*::]*/: { n:\"BOF\", f:parseuint16 },\n\t\t/*::[*/0x0001/*::]*/: { n:\"EOF\" },\n\t\t/*::[*/0x0002/*::]*/: { n:\"CALCMODE\" },\n\t\t/*::[*/0x0003/*::]*/: { n:\"CALCORDER\" },\n\t\t/*::[*/0x0004/*::]*/: { n:\"SPLIT\" },\n\t\t/*::[*/0x0005/*::]*/: { n:\"SYNC\" },\n\t\t/*::[*/0x0006/*::]*/: { n:\"RANGE\", f:parse_RANGE },\n\t\t/*::[*/0x0007/*::]*/: { n:\"WINDOW1\" },\n\t\t/*::[*/0x0008/*::]*/: { n:\"COLW1\" },\n\t\t/*::[*/0x0009/*::]*/: { n:\"WINTWO\" },\n\t\t/*::[*/0x000A/*::]*/: { n:\"COLW2\" },\n\t\t/*::[*/0x000B/*::]*/: { n:\"NAME\" },\n\t\t/*::[*/0x000C/*::]*/: { n:\"BLANK\" },\n\t\t/*::[*/0x000D/*::]*/: { n:\"INTEGER\", f:parse_INTEGER },\n\t\t/*::[*/0x000E/*::]*/: { n:\"NUMBER\", f:parse_NUMBER },\n\t\t/*::[*/0x000F/*::]*/: { n:\"LABEL\", f:parse_LABEL },\n\t\t/*::[*/0x0010/*::]*/: { n:\"FORMULA\", f:parse_FORMULA },\n\t\t/*::[*/0x0018/*::]*/: { n:\"TABLE\" },\n\t\t/*::[*/0x0019/*::]*/: { n:\"ORANGE\" },\n\t\t/*::[*/0x001A/*::]*/: { n:\"PRANGE\" },\n\t\t/*::[*/0x001B/*::]*/: { n:\"SRANGE\" },\n\t\t/*::[*/0x001C/*::]*/: { n:\"FRANGE\" },\n\t\t/*::[*/0x001D/*::]*/: { n:\"KRANGE1\" },\n\t\t/*::[*/0x0020/*::]*/: { n:\"HRANGE\" },\n\t\t/*::[*/0x0023/*::]*/: { n:\"KRANGE2\" },\n\t\t/*::[*/0x0024/*::]*/: { n:\"PROTEC\" },\n\t\t/*::[*/0x0025/*::]*/: { n:\"FOOTER\" },\n\t\t/*::[*/0x0026/*::]*/: { n:\"HEADER\" },\n\t\t/*::[*/0x0027/*::]*/: { n:\"SETUP\" },\n\t\t/*::[*/0x0028/*::]*/: { n:\"MARGINS\" },\n\t\t/*::[*/0x0029/*::]*/: { n:\"LABELFMT\" },\n\t\t/*::[*/0x002A/*::]*/: { n:\"TITLES\" },\n\t\t/*::[*/0x002B/*::]*/: { n:\"SHEETJS\" },\n\t\t/*::[*/0x002D/*::]*/: { n:\"GRAPH\" },\n\t\t/*::[*/0x002E/*::]*/: { n:\"NGRAPH\" },\n\t\t/*::[*/0x002F/*::]*/: { n:\"CALCCOUNT\" },\n\t\t/*::[*/0x0030/*::]*/: { n:\"UNFORMATTED\" },\n\t\t/*::[*/0x0031/*::]*/: { n:\"CURSORW12\" },\n\t\t/*::[*/0x0032/*::]*/: { n:\"WINDOW\" },\n\t\t/*::[*/0x0033/*::]*/: { n:\"STRING\", f:parse_LABEL },\n\t\t/*::[*/0x0037/*::]*/: { n:\"PASSWORD\" },\n\t\t/*::[*/0x0038/*::]*/: { n:\"LOCKED\" },\n\t\t/*::[*/0x003C/*::]*/: { n:\"QUERY\" },\n\t\t/*::[*/0x003D/*::]*/: { n:\"QUERYNAME\" },\n\t\t/*::[*/0x003E/*::]*/: { n:\"PRINT\" },\n\t\t/*::[*/0x003F/*::]*/: { n:\"PRINTNAME\" },\n\t\t/*::[*/0x0040/*::]*/: { n:\"GRAPH2\" },\n\t\t/*::[*/0x0041/*::]*/: { n:\"GRAPHNAME\" },\n\t\t/*::[*/0x0042/*::]*/: { n:\"ZOOM\" },\n\t\t/*::[*/0x0043/*::]*/: { n:\"SYMSPLIT\" },\n\t\t/*::[*/0x0044/*::]*/: { n:\"NSROWS\" },\n\t\t/*::[*/0x0045/*::]*/: { n:\"NSCOLS\" },\n\t\t/*::[*/0x0046/*::]*/: { n:\"RULER\" },\n\t\t/*::[*/0x0047/*::]*/: { n:\"NNAME\" },\n\t\t/*::[*/0x0048/*::]*/: { n:\"ACOMM\" },\n\t\t/*::[*/0x0049/*::]*/: { n:\"AMACRO\" },\n\t\t/*::[*/0x004A/*::]*/: { n:\"PARSE\" },\n\t\t/*::[*/0x0066/*::]*/: { n:\"PRANGES??\" },\n\t\t/*::[*/0x0067/*::]*/: { n:\"RRANGES??\" },\n\t\t/*::[*/0x0068/*::]*/: { n:\"FNAME??\" },\n\t\t/*::[*/0x0069/*::]*/: { n:\"MRANGES??\" },\n\t\t/*::[*/0x00CC/*::]*/: { n:\"SHEETNAMECS\", f:parse_SHEETNAMECS },\n\t\t/*::[*/0x00DE/*::]*/: { n:\"SHEETNAMELP\", f:parse_SHEETNAMELP },\n\t\t/*::[*/0xFFFF/*::]*/: { n:\"\" }\n\t};\n\n\tvar WK3Enum = {\n\t\t/*::[*/0x0000/*::]*/: { n:\"BOF\" },\n\t\t/*::[*/0x0001/*::]*/: { n:\"EOF\" },\n\t\t/*::[*/0x0002/*::]*/: { n:\"PASSWORD\" },\n\t\t/*::[*/0x0003/*::]*/: { n:\"CALCSET\" },\n\t\t/*::[*/0x0004/*::]*/: { n:\"WINDOWSET\" },\n\t\t/*::[*/0x0005/*::]*/: { n:\"SHEETCELLPTR\" },\n\t\t/*::[*/0x0006/*::]*/: { n:\"SHEETLAYOUT\" },\n\t\t/*::[*/0x0007/*::]*/: { n:\"COLUMNWIDTH\" },\n\t\t/*::[*/0x0008/*::]*/: { n:\"HIDDENCOLUMN\" },\n\t\t/*::[*/0x0009/*::]*/: { n:\"USERRANGE\" },\n\t\t/*::[*/0x000A/*::]*/: { n:\"SYSTEMRANGE\" },\n\t\t/*::[*/0x000B/*::]*/: { n:\"ZEROFORCE\" },\n\t\t/*::[*/0x000C/*::]*/: { n:\"SORTKEYDIR\" },\n\t\t/*::[*/0x000D/*::]*/: { n:\"FILESEAL\" },\n\t\t/*::[*/0x000E/*::]*/: { n:\"DATAFILLNUMS\" },\n\t\t/*::[*/0x000F/*::]*/: { n:\"PRINTMAIN\" },\n\t\t/*::[*/0x0010/*::]*/: { n:\"PRINTSTRING\" },\n\t\t/*::[*/0x0011/*::]*/: { n:\"GRAPHMAIN\" },\n\t\t/*::[*/0x0012/*::]*/: { n:\"GRAPHSTRING\" },\n\t\t/*::[*/0x0013/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0014/*::]*/: { n:\"ERRCELL\" },\n\t\t/*::[*/0x0015/*::]*/: { n:\"NACELL\" },\n\t\t/*::[*/0x0016/*::]*/: { n:\"LABEL16\", f:parse_LABEL_16},\n\t\t/*::[*/0x0017/*::]*/: { n:\"NUMBER17\", f:parse_NUMBER_17 },\n\t\t/*::[*/0x0018/*::]*/: { n:\"NUMBER18\", f:parse_NUMBER_18 },\n\t\t/*::[*/0x0019/*::]*/: { n:\"FORMULA19\", f:parse_FORMULA_19},\n\t\t/*::[*/0x001A/*::]*/: { n:\"FORMULA1A\" },\n\t\t/*::[*/0x001B/*::]*/: { n:\"XFORMAT\", f:parse_XFORMAT },\n\t\t/*::[*/0x001C/*::]*/: { n:\"DTLABELMISC\" },\n\t\t/*::[*/0x001D/*::]*/: { n:\"DTLABELCELL\" },\n\t\t/*::[*/0x001E/*::]*/: { n:\"GRAPHWINDOW\" },\n\t\t/*::[*/0x001F/*::]*/: { n:\"CPA\" },\n\t\t/*::[*/0x0020/*::]*/: { n:\"LPLAUTO\" },\n\t\t/*::[*/0x0021/*::]*/: { n:\"QUERY\" },\n\t\t/*::[*/0x0022/*::]*/: { n:\"HIDDENSHEET\" },\n\t\t/*::[*/0x0023/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0025/*::]*/: { n:\"NUMBER25\", f:parse_NUMBER_25 },\n\t\t/*::[*/0x0026/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0027/*::]*/: { n:\"NUMBER27\", f:parse_NUMBER_27 },\n\t\t/*::[*/0x0028/*::]*/: { n:\"FORMULA28\", f:parse_FORMULA_28 },\n\t\t/*::[*/0x008E/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0093/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0096/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0097/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0098/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0099/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x009A/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x009B/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x009C/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00A3/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00AE/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00AF/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00B0/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00B1/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00B8/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00B9/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00BA/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00BB/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00BC/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00C3/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00C9/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00CC/*::]*/: { n:\"SHEETNAMECS\", f:parse_SHEETNAMECS },\n\t\t/*::[*/0x00CD/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00CE/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00CF/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x00D0/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0100/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0103/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0104/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0105/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0106/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0107/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0109/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x010A/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x010B/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x010C/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x010E/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x010F/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0180/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0185/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0186/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0189/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x018C/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0200/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0202/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0201/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0204/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0205/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0280/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0281/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0282/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0283/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0284/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0285/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0286/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0287/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0288/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0292/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0293/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0294/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0295/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0296/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0299/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x029A/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0300/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0304/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0601/*::]*/: { n:\"SHEETINFOQP\", f:parse_SHEETINFOQP },\n\t\t/*::[*/0x0640/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0642/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0701/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0702/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0703/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0704/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0780/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0800/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0801/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0804/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x0A80/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x2AF6/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x3231/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x6E49/*::]*/: { n:\"??\" },\n\t\t/*::[*/0x6F44/*::]*/: { n:\"??\" },\n\t\t/*::[*/0xFFFF/*::]*/: { n:\"\" }\n\t};\n\treturn {\n\t\tsheet_to_wk1: sheet_to_wk1,\n\t\tbook_to_wk3: book_to_wk3,\n\t\tto_workbook: lotus_to_workbook\n\t};\n})();\n/* 18.4.7 rPr CT_RPrElt */\nfunction parse_rpr(rpr) {\n\tvar font = {}, m = rpr.match(tagregex), i = 0;\n\tvar pass = false;\n\tif(m) for(;i!=m.length; ++i) {\n\t\tvar y = parsexmltag(m[i]);\n\t\tswitch(y[0].replace(/\\w*:/g,\"\")) {\n\t\t\t/* 18.8.12 condense CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<condense': break;\n\t\t\t/* 18.8.17 extend CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<extend': break;\n\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\n\t\t\t/* ** not required . */\n\t\t\tcase '<shadow':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<shadow>':\n\t\t\tcase '<shadow/>': font.shadow = 1; break;\n\t\t\tcase '</shadow>': break;\n\n\t\t\t/* 18.4.1 charset CT_IntProperty TODO */\n\t\t\tcase '<charset':\n\t\t\t\tif(y.val == '1') break;\n\t\t\t\tfont.cp = CS2CP[parseInt(y.val, 10)];\n\t\t\t\tbreak;\n\n\t\t\t/* 18.4.2 outline CT_BooleanProperty TODO */\n\t\t\tcase '<outline':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<outline>':\n\t\t\tcase '<outline/>': font.outline = 1; break;\n\t\t\tcase '</outline>': break;\n\n\t\t\t/* 18.4.5 rFont CT_FontName */\n\t\t\tcase '<rFont': font.name = y.val; break;\n\n\t\t\t/* 18.4.11 sz CT_FontSize */\n\t\t\tcase '<sz': font.sz = y.val; break;\n\n\t\t\t/* 18.4.10 strike CT_BooleanProperty */\n\t\t\tcase '<strike':\n\t\t\t\tif(!y.val) break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<strike>':\n\t\t\tcase '<strike/>': font.strike = 1; break;\n\t\t\tcase '</strike>': break;\n\n\t\t\t/* 18.4.13 u CT_UnderlineProperty */\n\t\t\tcase '<u':\n\t\t\t\tif(!y.val) break;\n\t\t\t\tswitch(y.val) {\n\t\t\t\t\tcase 'double': font.uval = \"double\"; break;\n\t\t\t\t\tcase 'singleAccounting': font.uval = \"single-accounting\"; break;\n\t\t\t\t\tcase 'doubleAccounting': font.uval = \"double-accounting\"; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '<u>':\n\t\t\tcase '<u/>': font.u = 1; break;\n\t\t\tcase '</u>': break;\n\n\t\t\t/* 18.8.2 b */\n\t\t\tcase '<b':\n\t\t\t\tif(y.val == '0') break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<b>':\n\t\t\tcase '<b/>': font.b = 1; break;\n\t\t\tcase '</b>': break;\n\n\t\t\t/* 18.8.26 i */\n\t\t\tcase '<i':\n\t\t\t\tif(y.val == '0') break;\n\t\t\t\t/* falls through */\n\t\t\tcase '<i>':\n\t\t\tcase '<i/>': font.i = 1; break;\n\t\t\tcase '</i>': break;\n\n\t\t\t/* 18.3.1.15 color CT_Color TODO: tint, theme, auto, indexed */\n\t\t\tcase '<color':\n\t\t\t\tif(y.rgb) font.color = y.rgb.slice(2,8);\n\t\t\t\tbreak;\n\t\t\tcase '<color>': case '<color/>': case '</color>': break;\n\n\t\t\t/* 18.8.18 family ST_FontFamily */\n\t\t\tcase '<family': font.family = y.val; break;\n\t\t\tcase '<family>': case '<family/>': case '</family>': break;\n\n\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty TODO */\n\t\t\tcase '<vertAlign': font.valign = y.val; break;\n\t\t\tcase '<vertAlign>': case '<vertAlign/>': case '</vertAlign>': break;\n\n\t\t\t/* 18.8.35 scheme CT_FontScheme TODO */\n\t\t\tcase '<scheme': break;\n\t\t\tcase '<scheme>': case '<scheme/>': case '</scheme>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault:\n\t\t\t\tif(y[0].charCodeAt(1) !== 47 && !pass) throw new Error('Unrecognized rich format ' + y[0]);\n\t\t}\n\t}\n\treturn font;\n}\n\nvar parse_rs = /*#__PURE__*/(function() {\n\tvar tregex = matchtag(\"t\"), rpregex = matchtag(\"rPr\");\n\t/* 18.4.4 r CT_RElt */\n\tfunction parse_r(r) {\n\t\t/* 18.4.12 t ST_Xstring */\n\t\tvar t = r.match(tregex)/*, cp = 65001*/;\n\t\tif(!t) return {t:\"s\", v:\"\"};\n\n\t\tvar o/*:Cell*/ = ({t:'s', v:unescapexml(t[1])}/*:any*/);\n\t\tvar rpr = r.match(rpregex);\n\t\tif(rpr) o.s = parse_rpr(rpr[1]);\n\t\treturn o;\n\t}\n\tvar rregex = /<(?:\\w+:)?r>/g, rend = /<\\/(?:\\w+:)?r>/;\n\treturn function parse_rs(rs) {\n\t\treturn rs.replace(rregex,\"\").split(rend).map(parse_r).filter(function(r) { return r.v; });\n\t};\n})();\n\n\n/* Parse a list of <r> tags */\nvar rs_to_html = /*#__PURE__*/(function parse_rs_factory() {\n\tvar nlregex = /(\\r\\n|\\n)/g;\n\tfunction parse_rpr2(font, intro, outro) {\n\t\tvar style/*:Array<string>*/ = [];\n\n\t\tif(font.u) style.push(\"text-decoration: underline;\");\n\t\tif(font.uval) style.push(\"text-underline-style:\" + font.uval + \";\");\n\t\tif(font.sz) style.push(\"font-size:\" + font.sz + \"pt;\");\n\t\tif(font.outline) style.push(\"text-effect: outline;\");\n\t\tif(font.shadow) style.push(\"text-shadow: auto;\");\n\t\tintro.push('<span style=\"' + style.join(\"\") + '\">');\n\n\t\tif(font.b) { intro.push(\"<b>\"); outro.push(\"</b>\"); }\n\t\tif(font.i) { intro.push(\"<i>\"); outro.push(\"</i>\"); }\n\t\tif(font.strike) { intro.push(\"<s>\"); outro.push(\"</s>\"); }\n\n\t\tvar align = font.valign || \"\";\n\t\tif(align == \"superscript\" || align == \"super\") align = \"sup\";\n\t\telse if(align == \"subscript\") align = \"sub\";\n\t\tif(align != \"\") { intro.push(\"<\" + align + \">\"); outro.push(\"</\" + align + \">\"); }\n\n\t\toutro.push(\"</span>\");\n\t\treturn font;\n\t}\n\n\t/* 18.4.4 r CT_RElt */\n\tfunction r_to_html(r) {\n\t\tvar terms/*:[Array<string>, string, Array<string>]*/ = [[],r.v,[]];\n\t\tif(!r.v) return \"\";\n\n\t\tif(r.s) parse_rpr2(r.s, terms[0], terms[2]);\n\n\t\treturn terms[0].join(\"\") + terms[1].replace(nlregex,'<br/>') + terms[2].join(\"\");\n\t}\n\n\treturn function parse_rs(rs) {\n\t\treturn rs.map(r_to_html).join(\"\");\n\t};\n})();\n\n/* 18.4.8 si CT_Rst */\nvar sitregex = /<(?:\\w+:)?t[^>]*>([^<]*)<\\/(?:\\w+:)?t>/g, sirregex = /<(?:\\w+:)?r>/;\nvar sirphregex = /<(?:\\w+:)?rPh.*?>([\\s\\S]*?)<\\/(?:\\w+:)?rPh>/g;\nfunction parse_si(x, opts) {\n\tvar html = opts ? opts.cellHTML : true;\n\tvar z = {};\n\tif(!x) return { t: \"\" };\n\t//var y;\n\t/* 18.4.12 t ST_Xstring (Plaintext String) */\n\t// TODO: is whitespace actually valid here?\n\tif(x.match(/^\\s*<(?:\\w+:)?t[^>]*>/)) {\n\t\tz.t = unescapexml(utf8read(x.slice(x.indexOf(\">\")+1).split(/<\\/(?:\\w+:)?t>/)[0]||\"\"));\n\t\tz.r = utf8read(x);\n\t\tif(html) z.h = escapehtml(z.t);\n\t}\n\t/* 18.4.4 r CT_RElt (Rich Text Run) */\n\telse if((/*y = */x.match(sirregex))) {\n\t\tz.r = utf8read(x);\n\t\tz.t = unescapexml(utf8read((x.replace(sirphregex, '').match(sitregex)||[]).join(\"\").replace(tagregex,\"\")));\n\t\tif(html) z.h = rs_to_html(parse_rs(z.r));\n\t}\n\t/* 18.4.3 phoneticPr CT_PhoneticPr (TODO: needed for Asian support) */\n\t/* 18.4.6 rPh CT_PhoneticRun (TODO: needed for Asian support) */\n\treturn z;\n}\n\n/* 18.4 Shared String Table */\nvar sstr0 = /<(?:\\w+:)?sst([^>]*)>([\\s\\S]*)<\\/(?:\\w+:)?sst>/;\nvar sstr1 = /<(?:\\w+:)?(?:si|sstItem)>/g;\nvar sstr2 = /<\\/(?:\\w+:)?(?:si|sstItem)>/;\nfunction parse_sst_xml(data/*:string*/, opts)/*:SST*/ {\n\tvar s/*:SST*/ = ([]/*:any*/), ss = \"\";\n\tif(!data) return s;\n\t/* 18.4.9 sst CT_Sst */\n\tvar sst = data.match(sstr0);\n\tif(sst) {\n\t\tss = sst[2].replace(sstr1,\"\").split(sstr2);\n\t\tfor(var i = 0; i != ss.length; ++i) {\n\t\t\tvar o = parse_si(ss[i].trim(), opts);\n\t\t\tif(o != null) s[s.length] = o;\n\t\t}\n\t\tsst = parsexmltag(sst[1]); s.Count = sst.count; s.Unique = sst.uniqueCount;\n\t}\n\treturn s;\n}\n\nvar straywsregex = /^\\s|\\s$|[\\t\\n\\r]/;\nfunction write_sst_xml(sst/*:SST*/, opts)/*:string*/ {\n\tif(!opts.bookSST) return \"\";\n\tvar o = [XML_HEADER];\n\to[o.length] = (writextag('sst', null, {\n\t\txmlns: XMLNS_main[0],\n\t\tcount: sst.Count,\n\t\tuniqueCount: sst.Unique\n\t}));\n\tfor(var i = 0; i != sst.length; ++i) { if(sst[i] == null) continue;\n\t\tvar s/*:XLString*/ = sst[i];\n\t\tvar sitag = \"<si>\";\n\t\tif(s.r) sitag += s.r;\n\t\telse {\n\t\t\tsitag += \"<t\";\n\t\t\tif(!s.t) s.t = \"\";\n\t\t\tif(s.t.match(straywsregex)) sitag += ' xml:space=\"preserve\"';\n\t\t\tsitag += \">\" + escapexml(s.t) + \"</t>\";\n\t\t}\n\t\tsitag += \"</si>\";\n\t\to[o.length] = (sitag);\n\t}\n\tif(o.length>2){ o[o.length] = ('</sst>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.221 BrtBeginSst */\nfunction parse_BrtBeginSst(data) {\n\treturn [data.read_shift(4), data.read_shift(4)];\n}\n\n/* [MS-XLSB] 2.1.7.45 Shared Strings */\nfunction parse_sst_bin(data, opts)/*:SST*/ {\n\tvar s/*:SST*/ = ([]/*:any*/);\n\tvar pass = false;\n\trecordhopper(data, function hopper_sst(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x009F: /* BrtBeginSst */\n\t\t\t\ts.Count = val[0]; s.Unique = val[1]; break;\n\t\t\tcase 0x0013: /* BrtSSTItem */\n\t\t\t\ts.push(val); break;\n\t\t\tcase 0x00A0: /* BrtEndSst */\n\t\t\t\treturn true;\n\n\t\t\tcase 0x0023: /* BrtFRTBegin */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* BrtFRTEnd */\n\t\t\t\tpass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){}\n\t\t\t\tif(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn s;\n}\n\nfunction write_BrtBeginSst(sst, o) {\n\tif(!o) o = new_buf(8);\n\to.write_shift(4, sst.Count);\n\to.write_shift(4, sst.Unique);\n\treturn o;\n}\n\nvar write_BrtSSTItem = write_RichStr;\n\nfunction write_sst_bin(sst/*::, opts*/) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x009F /* BrtBeginSst */, write_BrtBeginSst(sst));\n\tfor(var i = 0; i < sst.length; ++i) write_record(ba, 0x0013 /* BrtSSTItem */, write_BrtSSTItem(sst[i]));\n\t/* FRTSST */\n\twrite_record(ba, 0x00A0 /* BrtEndSst */);\n\treturn ba.end();\n}\nfunction _JS2ANSI(str/*:string*/)/*:Array<number>*/ {\n\tif(typeof $cptable !== 'undefined') return $cptable.utils.encode(current_ansi, str);\n\tvar o/*:Array<number>*/ = [], oo = str.split(\"\");\n\tfor(var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.4 Version */\nfunction parse_CRYPTOVersion(blob, length/*:?number*/) {\n\tvar o/*:any*/ = {};\n\to.Major = blob.read_shift(2);\n\to.Minor = blob.read_shift(2);\n\t/*:: if(length == null) return o; */\n\tif(length >= 4) blob.l += length - 4;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.5 DataSpaceVersionInfo */\nfunction parse_DataSpaceVersionInfo(blob) {\n\tvar o = {};\n\to.id = blob.read_shift(0, 'lpp4');\n\to.R = parse_CRYPTOVersion(blob, 4);\n\to.U = parse_CRYPTOVersion(blob, 4);\n\to.W = parse_CRYPTOVersion(blob, 4);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.6.1 DataSpaceMapEntry Structure */\nfunction parse_DataSpaceMapEntry(blob) {\n\tvar len = blob.read_shift(4);\n\tvar end = blob.l + len - 4;\n\tvar o = {};\n\tvar cnt = blob.read_shift(4);\n\tvar comps/*:Array<{t:number, v:string}>*/ = [];\n\t/* [MS-OFFCRYPTO] 2.1.6.2 DataSpaceReferenceComponent Structure */\n\twhile(cnt-- > 0) comps.push({ t: blob.read_shift(4), v: blob.read_shift(0, 'lpp4') });\n\to.name = blob.read_shift(0, 'lpp4');\n\to.comps = comps;\n\tif(blob.l != end) throw new Error(\"Bad DataSpaceMapEntry: \" + blob.l + \" != \" + end);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.6 DataSpaceMap */\nfunction parse_DataSpaceMap(blob) {\n\tvar o = [];\n\tblob.l += 4; // must be 0x8\n\tvar cnt = blob.read_shift(4);\n\twhile(cnt-- > 0) o.push(parse_DataSpaceMapEntry(blob));\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.7 DataSpaceDefinition */\nfunction parse_DataSpaceDefinition(blob)/*:Array<string>*/ {\n\tvar o/*:Array<string>*/ = [];\n\tblob.l += 4; // must be 0x8\n\tvar cnt = blob.read_shift(4);\n\twhile(cnt-- > 0) o.push(blob.read_shift(0, 'lpp4'));\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.8 DataSpaceDefinition */\nfunction parse_TransformInfoHeader(blob) {\n\tvar o = {};\n\t/*var len = */blob.read_shift(4);\n\tblob.l += 4; // must be 0x1\n\to.id = blob.read_shift(0, 'lpp4');\n\to.name = blob.read_shift(0, 'lpp4');\n\to.R = parse_CRYPTOVersion(blob, 4);\n\to.U = parse_CRYPTOVersion(blob, 4);\n\to.W = parse_CRYPTOVersion(blob, 4);\n\treturn o;\n}\n\nfunction parse_Primary(blob) {\n\t/* [MS-OFFCRYPTO] 2.2.6 IRMDSTransformInfo */\n\tvar hdr = parse_TransformInfoHeader(blob);\n\t/* [MS-OFFCRYPTO] 2.1.9 EncryptionTransformInfo */\n\thdr.ename = blob.read_shift(0, '8lpp4');\n\thdr.blksz = blob.read_shift(4);\n\thdr.cmode = blob.read_shift(4);\n\tif(blob.read_shift(4) != 0x04) throw new Error(\"Bad !Primary record\");\n\treturn hdr;\n}\n\n/* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\nfunction parse_EncryptionHeader(blob, length/*:number*/) {\n\tvar tgt = blob.l + length;\n\tvar o = {};\n\to.Flags = (blob.read_shift(4) & 0x3F);\n\tblob.l += 4;\n\to.AlgID = blob.read_shift(4);\n\tvar valid = false;\n\tswitch(o.AlgID) {\n\t\tcase 0x660E: case 0x660F: case 0x6610: valid = (o.Flags == 0x24); break;\n\t\tcase 0x6801: valid = (o.Flags == 0x04); break;\n\t\tcase 0: valid = (o.Flags == 0x10 || o.Flags == 0x04 || o.Flags == 0x24); break;\n\t\tdefault: throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n\t}\n\tif(!valid) throw new Error(\"Encryption Flags/AlgID mismatch\");\n\to.AlgIDHash = blob.read_shift(4);\n\to.KeySize = blob.read_shift(4);\n\to.ProviderType = blob.read_shift(4);\n\tblob.l += 8;\n\to.CSPName = blob.read_shift((tgt-blob.l)>>1, 'utf16le');\n\tblob.l = tgt;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\nfunction parse_EncryptionVerifier(blob, length/*:number*/) {\n\tvar o = {}, tgt = blob.l + length;\n\tblob.l += 4; // SaltSize must be 0x10\n\to.Salt = blob.slice(blob.l, blob.l+16); blob.l += 16;\n\to.Verifier = blob.slice(blob.l, blob.l+16); blob.l += 16;\n\t/*var sz = */blob.read_shift(4);\n\to.VerifierHash = blob.slice(blob.l, tgt); blob.l = tgt;\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.4.* EncryptionInfo Stream */\nfunction parse_EncryptionInfo(blob) {\n\tvar vers = parse_CRYPTOVersion(blob);\n\tswitch(vers.Minor) {\n\t\tcase 0x02: return [vers.Minor, parse_EncInfoStd(blob, vers)];\n\t\tcase 0x03: return [vers.Minor, parse_EncInfoExt(blob, vers)];\n\t\tcase 0x04: return [vers.Minor, parse_EncInfoAgl(blob, vers)];\n\t}\n\tthrow new Error(\"ECMA-376 Encrypted file unrecognized Version: \" + vers.Minor);\n}\n\n/* [MS-OFFCRYPTO] 2.3.4.5  EncryptionInfo Stream (Standard Encryption) */\nfunction parse_EncInfoStd(blob/*::, vers*/) {\n\tvar flags = blob.read_shift(4);\n\tif((flags & 0x3F) != 0x24) throw new Error(\"EncryptionInfo mismatch\");\n\tvar sz = blob.read_shift(4);\n\t//var tgt = blob.l + sz;\n\tvar hdr = parse_EncryptionHeader(blob, sz);\n\tvar verifier = parse_EncryptionVerifier(blob, blob.length - blob.l);\n\treturn { t:\"Std\", h:hdr, v:verifier };\n}\n/* [MS-OFFCRYPTO] 2.3.4.6  EncryptionInfo Stream (Extensible Encryption) */\nfunction parse_EncInfoExt(/*::blob, vers*/) { throw new Error(\"File is password-protected: ECMA-376 Extensible\"); }\n/* [MS-OFFCRYPTO] 2.3.4.10 EncryptionInfo Stream (Agile Encryption) */\nfunction parse_EncInfoAgl(blob/*::, vers*/) {\n\tvar KeyData = [\"saltSize\",\"blockSize\",\"keyBits\",\"hashSize\",\"cipherAlgorithm\",\"cipherChaining\",\"hashAlgorithm\",\"saltValue\"];\n\tblob.l+=4;\n\tvar xml = blob.read_shift(blob.length - blob.l, 'utf8');\n\tvar o = {};\n\txml.replace(tagregex, function xml_agile(x) {\n\t\tvar y/*:any*/ = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\t\t\tcase '<encryption': case '</encryption>': break;\n\t\t\tcase '<keyData': KeyData.forEach(function(k) { o[k] = y[k]; }); break;\n\t\t\tcase '<dataIntegrity': o.encryptedHmacKey = y.encryptedHmacKey; o.encryptedHmacValue = y.encryptedHmacValue; break;\n\t\t\tcase '<keyEncryptors>': case '<keyEncryptors': o.encs = []; break;\n\t\t\tcase '</keyEncryptors>': break;\n\n\t\t\tcase '<keyEncryptor': o.uri = y.uri; break;\n\t\t\tcase '</keyEncryptor>': break;\n\t\t\tcase '<encryptedKey': o.encs.push(y); break;\n\t\t\tdefault: throw y[0];\n\t\t}\n\t});\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\nfunction parse_RC4CryptoHeader(blob, length/*:number*/) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4); length -= 4;\n\tif(vers.Minor != 2) throw new Error('unrecognized minor version code: ' + vers.Minor);\n\tif(vers.Major > 4 || vers.Major < 2) throw new Error('unrecognized major version code: ' + vers.Major);\n\to.Flags = blob.read_shift(4); length -= 4;\n\tvar sz = blob.read_shift(4); length -= 4;\n\to.EncryptionHeader = parse_EncryptionHeader(blob, sz); length -= sz;\n\to.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n\treturn o;\n}\n/* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\nfunction parse_RC4Header(blob/*::, length*/) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_CRYPTOVersion(blob, 4);\n\tif(vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n\to.Salt = blob.read_shift(16);\n\to.EncryptedVerifier = blob.read_shift(16);\n\to.EncryptedVerifierHash = blob.read_shift(16);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\nfunction crypto_CreatePasswordVerifier_Method1(Password/*:string*/) {\n\tvar Verifier = 0x0000, PasswordArray;\n\tvar PasswordDecoded = _JS2ANSI(Password);\n\tvar len = PasswordDecoded.length + 1, i, PasswordByte;\n\tvar Intermediate1, Intermediate2, Intermediate3;\n\tPasswordArray = new_raw_buf(len);\n\tPasswordArray[0] = PasswordDecoded.length;\n\tfor(i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i-1];\n\tfor(i = len-1; i >= 0; --i) {\n\t\tPasswordByte = PasswordArray[i];\n\t\tIntermediate1 = ((Verifier & 0x4000) === 0x0000) ? 0 : 1;\n\t\tIntermediate2 = (Verifier << 1) & 0x7FFF;\n\t\tIntermediate3 = Intermediate1 | Intermediate2;\n\t\tVerifier = Intermediate3 ^ PasswordByte;\n\t}\n\treturn Verifier ^ 0xCE4B;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\nvar crypto_CreateXorArray_Method1 = /*#__PURE__*/(function() {\n\tvar PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n\tvar InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n\tvar XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\tvar Ror = function(Byte) { return ((Byte/2) | (Byte*128)) & 0xFF; };\n\tvar XorRor = function(byte1, byte2) { return Ror(byte1 ^ byte2); };\n\tvar CreateXorKey_Method1 = function(Password) {\n\t\tvar XorKey = InitialCode[Password.length - 1];\n\t\tvar CurrentElement = 0x68;\n\t\tfor(var i = Password.length-1; i >= 0; --i) {\n\t\t\tvar Char = Password[i];\n\t\t\tfor(var j = 0; j != 7; ++j) {\n\t\t\t\tif(Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n\t\t\t\tChar *= 2; --CurrentElement;\n\t\t\t}\n\t\t}\n\t\treturn XorKey;\n\t};\n\treturn function(password/*:string*/) {\n\t\tvar Password = _JS2ANSI(password);\n\t\tvar XorKey = CreateXorKey_Method1(Password);\n\t\tvar Index = Password.length;\n\t\tvar ObfuscationArray = new_raw_buf(16);\n\t\tfor(var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n\t\tvar Temp, PasswordLastChar, PadIndex;\n\t\tif((Index & 1) === 1) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tPasswordLastChar = Password[Password.length - 1];\n\t\t\tObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n\t\t}\n\t\twhile(Index > 0) {\n\t\t\t--Index;\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t}\n\t\tIndex = 15;\n\t\tPadIndex = 15 - Password.length;\n\t\twhile(PadIndex > 0) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t}\n\t\treturn ObfuscationArray;\n\t};\n})();\n\n/* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\nvar crypto_DecryptData_Method1 = function(password/*:string*/, Data, XorArrayIndex, XorArray, O) {\n\t/* If XorArray is set, use it; if O is not set, make changes in-place */\n\tif(!O) O = Data;\n\tif(!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n\tvar Index, Value;\n\tfor(Index = 0; Index != Data.length; ++Index) {\n\t\tValue = Data[Index];\n\t\tValue ^= XorArray[XorArrayIndex];\n\t\tValue = ((Value>>5) | (Value<<3)) & 0xFF;\n\t\tO[Index] = Value;\n\t\t++XorArrayIndex;\n\t}\n\treturn [O, XorArrayIndex, XorArray];\n};\n\nvar crypto_MakeXorDecryptor = function(password/*:string*/) {\n\tvar XorArrayIndex = 0, XorArray = crypto_CreateXorArray_Method1(password);\n\treturn function(Data) {\n\t\tvar O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\n\t\tXorArrayIndex = O[1];\n\t\treturn O[0];\n\t};\n};\n\n/* 2.5.343 */\nfunction parse_XORObfuscation(blob, length, opts, out) {\n\tvar o = ({ key: parseuint16(blob), verificationBytes: parseuint16(blob) }/*:any*/);\n\tif(opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n\tout.valid = o.verificationBytes === o.verifier;\n\tif(out.valid) out.insitu = crypto_MakeXorDecryptor(opts.password);\n\treturn o;\n}\n\n/* 2.4.117 */\nfunction parse_FilePassHeader(blob, length/*:number*/, oo) {\n\tvar o = oo || {}; o.Info = blob.read_shift(2); blob.l -= 2;\n\tif(o.Info === 1) o.Data = parse_RC4Header(blob, length);\n\telse o.Data = parse_RC4CryptoHeader(blob, length);\n\treturn o;\n}\nfunction parse_FilePass(blob, length/*:number*/, opts) {\n\tvar o = ({ Type: opts.biff >= 8 ? blob.read_shift(2) : 0 }/*:any*/); /* wEncryptionType */\n\tif(o.Type) parse_FilePassHeader(blob, length-2, o);\n\telse parse_XORObfuscation(blob, opts.biff >= 8 ? length : length - 2, opts, o);\n\treturn o;\n}\n\n\nvar RTF = /*#__PURE__*/(function() {\n\tfunction rtf_to_sheet(d/*:RawData*/, opts)/*:Worksheet*/ {\n\t\tswitch(opts.type) {\n\t\t\tcase 'base64': return rtf_to_sheet_str(Base64_decode(d), opts);\n\t\t\tcase 'binary': return rtf_to_sheet_str(d, opts);\n\t\t\tcase 'buffer': return rtf_to_sheet_str(has_buf && Buffer.isBuffer(d) ? d.toString('binary') : a2s(d), opts);\n\t\t\tcase 'array':  return rtf_to_sheet_str(cc2str(d), opts);\n\t\t}\n\t\tthrow new Error(\"Unrecognized type \" + opts.type);\n\t}\n\n\t/* TODO: this is a stub */\n\tfunction rtf_to_sheet_str(str/*:string*/, opts)/*:Worksheet*/ {\n\t\tvar o = opts || {};\n\t\tvar ws/*:Worksheet*/ = o.dense ? ([]/*:any*/) : ({}/*:any*/);\n\n\t\tvar rows = str.match(/\\\\trowd.*?\\\\row\\b/g);\n\t\tif(!rows.length) throw new Error(\"RTF missing table\");\n\t\tvar range/*:Range*/ = ({s: {c:0, r:0}, e: {c:0, r:rows.length - 1}}/*:any*/);\n\t\trows.forEach(function(rowtf, R) {\n\t\t\tif(Array.isArray(ws)) ws[R] = [];\n\t\t\tvar rtfre = /\\\\\\w+\\b/g;\n\t\t\tvar last_index = 0;\n\t\t\tvar res;\n\t\t\tvar C = -1;\n\t\t\twhile((res = rtfre.exec(rowtf))) {\n\t\t\t\tswitch(res[0]) {\n\t\t\t\t\tcase \"\\\\cell\":\n\t\t\t\t\t\tvar data = rowtf.slice(last_index, rtfre.lastIndex - res[0].length);\n\t\t\t\t\t\tif(data[0] == \" \") data = data.slice(1);\n\t\t\t\t\t\t++C;\n\t\t\t\t\t\tif(data.length) {\n\t\t\t\t\t\t\t// TODO: value parsing, including codepage adjustments\n\t\t\t\t\t\t\tvar cell = {v: data, t:\"s\"};\n\t\t\t\t\t\t\tif(Array.isArray(ws)) ws[R][C] = cell;\n\t\t\t\t\t\t\telse ws[encode_cell({r:R, c:C})] = cell;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlast_index = rtfre.lastIndex;\n\t\t\t}\n\t\t\tif(C > range.e.c) range.e.c = C;\n\t\t});\n\t\tws['!ref'] = encode_range(range);\n\t\treturn ws;\n\t}\n\n\tfunction rtf_to_workbook(d/*:RawData*/, opts)/*:Workbook*/ { return sheet_to_workbook(rtf_to_sheet(d, opts), opts); }\n\n\t/* TODO: this is a stub */\n\tfunction sheet_to_rtf(ws/*:Worksheet*//*::, opts*/)/*:string*/ {\n\t\tvar o = [\"{\\\\rtf1\\\\ansi\"];\n\t\tvar r = safe_decode_range(ws['!ref']), cell/*:Cell*/;\n\t\tvar dense = Array.isArray(ws);\n\t\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\t\to.push(\"\\\\trowd\\\\trautofit1\");\n\t\t\tfor(var C = r.s.c; C <= r.e.c; ++C) o.push(\"\\\\cellx\" + (C+1));\n\t\t\to.push(\"\\\\pard\\\\intbl\");\n\t\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\t\tvar coord = encode_cell({r:R,c:C});\n\t\t\t\tcell = dense ? (ws[R]||[])[C]: ws[coord];\n\t\t\t\tif(!cell || cell.v == null && (!cell.f || cell.F)) continue;\n\t\t\t\to.push(\" \" + (cell.w || (format_cell(cell), cell.w)));\n\t\t\t\to.push(\"\\\\cell\");\n\t\t\t}\n\t\t\to.push(\"\\\\pard\\\\intbl\\\\row\");\n\t\t}\n\t\treturn o.join(\"\") + \"}\";\n\t}\n\n\treturn {\n\t\tto_workbook: rtf_to_workbook,\n\t\tto_sheet: rtf_to_sheet,\n\t\tfrom_sheet: sheet_to_rtf\n\t};\n})();\nfunction hex2RGB(h) {\n\tvar o = h.slice(h[0]===\"#\"?1:0).slice(0,6);\n\treturn [parseInt(o.slice(0,2),16),parseInt(o.slice(2,4),16),parseInt(o.slice(4,6),16)];\n}\nfunction rgb2Hex(rgb) {\n\tfor(var i=0,o=1; i!=3; ++i) o = o*256 + (rgb[i]>255?255:rgb[i]<0?0:rgb[i]);\n\treturn o.toString(16).toUpperCase().slice(1);\n}\n\nfunction rgb2HSL(rgb) {\n\tvar R = rgb[0]/255, G = rgb[1]/255, B=rgb[2]/255;\n\tvar M = Math.max(R, G, B), m = Math.min(R, G, B), C = M - m;\n\tif(C === 0) return [0, 0, R];\n\n\tvar H6 = 0, S = 0, L2 = (M + m);\n\tS = C / (L2 > 1 ? 2 - L2 : L2);\n\tswitch(M){\n\t\tcase R: H6 = ((G - B) / C + 6)%6; break;\n\t\tcase G: H6 = ((B - R) / C + 2); break;\n\t\tcase B: H6 = ((R - G) / C + 4); break;\n\t}\n\treturn [H6 / 6, S, L2 / 2];\n}\n\nfunction hsl2RGB(hsl){\n\tvar H = hsl[0], S = hsl[1], L = hsl[2];\n\tvar C = S * 2 * (L < 0.5 ? L : 1 - L), m = L - C/2;\n\tvar rgb = [m,m,m], h6 = 6*H;\n\n\tvar X;\n\tif(S !== 0) switch(h6|0) {\n\t\tcase 0: case 6: X = C * h6; rgb[0] += C; rgb[1] += X; break;\n\t\tcase 1: X = C * (2 - h6);   rgb[0] += X; rgb[1] += C; break;\n\t\tcase 2: X = C * (h6 - 2);   rgb[1] += C; rgb[2] += X; break;\n\t\tcase 3: X = C * (4 - h6);   rgb[1] += X; rgb[2] += C; break;\n\t\tcase 4: X = C * (h6 - 4);   rgb[2] += C; rgb[0] += X; break;\n\t\tcase 5: X = C * (6 - h6);   rgb[2] += X; rgb[0] += C; break;\n\t}\n\tfor(var i = 0; i != 3; ++i) rgb[i] = Math.round(rgb[i]*255);\n\treturn rgb;\n}\n\n/* 18.8.3 bgColor tint algorithm */\nfunction rgb_tint(hex, tint) {\n\tif(tint === 0) return hex;\n\tvar hsl = rgb2HSL(hex2RGB(hex));\n\tif (tint < 0) hsl[2] = hsl[2] * (1 + tint);\n\telse hsl[2] = 1 - (1 - hsl[2]) * (1 - tint);\n\treturn rgb2Hex(hsl2RGB(hsl));\n}\n\n/* 18.3.1.13 width calculations */\n/* [MS-OI29500] 2.1.595 Column Width & Formatting */\nvar DEF_MDW = 6, MAX_MDW = 15, MIN_MDW = 1, MDW = DEF_MDW;\nfunction width2px(width) { return Math.floor(( width + (Math.round(128/MDW))/256 )* MDW ); }\nfunction px2char(px) { return (Math.floor((px - 5)/MDW * 100 + 0.5))/100; }\nfunction char2width(chr) { return (Math.round((chr * MDW + 5)/MDW*256))/256; }\n//function px2char_(px) { return (((px - 5)/MDW * 100 + 0.5))/100; }\n//function char2width_(chr) { return (((chr * MDW + 5)/MDW*256))/256; }\nfunction cycle_width(collw) { return char2width(px2char(width2px(collw))); }\n/* XLSX/XLSB/XLS specify width in units of MDW */\nfunction find_mdw_colw(collw) {\n\tvar delta = Math.abs(collw - cycle_width(collw)), _MDW = MDW;\n\tif(delta > 0.005) for(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) if(Math.abs(collw - cycle_width(collw)) <= delta) { delta = Math.abs(collw - cycle_width(collw)); _MDW = MDW; }\n\tMDW = _MDW;\n}\n/* XLML specifies width in terms of pixels */\n/*function find_mdw_wpx(wpx) {\n\tvar delta = Infinity, guess = 0, _MDW = MIN_MDW;\n\tfor(MDW=MIN_MDW; MDW<MAX_MDW; ++MDW) {\n\t\tguess = char2width_(px2char_(wpx))*256;\n\t\tguess = (guess) % 1;\n\t\tif(guess > 0.5) guess--;\n\t\tif(Math.abs(guess) < delta) { delta = Math.abs(guess); _MDW = MDW; }\n\t}\n\tMDW = _MDW;\n}*/\n\nfunction process_col(coll/*:ColInfo*/) {\n\tif(coll.width) {\n\t\tcoll.wpx = width2px(coll.width);\n\t\tcoll.wch = px2char(coll.wpx);\n\t\tcoll.MDW = MDW;\n\t} else if(coll.wpx) {\n\t\tcoll.wch = px2char(coll.wpx);\n\t\tcoll.width = char2width(coll.wch);\n\t\tcoll.MDW = MDW;\n\t} else if(typeof coll.wch == 'number') {\n\t\tcoll.width = char2width(coll.wch);\n\t\tcoll.wpx = width2px(coll.width);\n\t\tcoll.MDW = MDW;\n\t}\n\tif(coll.customWidth) delete coll.customWidth;\n}\n\nvar DEF_PPI = 96, PPI = DEF_PPI;\nfunction px2pt(px) { return px * 96 / PPI; }\nfunction pt2px(pt) { return pt * PPI / 96; }\n\n/* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\nvar XLMLPatternTypeMap = {\n\t\"None\": \"none\",\n\t\"Solid\": \"solid\",\n\t\"Gray50\": \"mediumGray\",\n\t\"Gray75\": \"darkGray\",\n\t\"Gray25\": \"lightGray\",\n\t\"HorzStripe\": \"darkHorizontal\",\n\t\"VertStripe\": \"darkVertical\",\n\t\"ReverseDiagStripe\": \"darkDown\",\n\t\"DiagStripe\": \"darkUp\",\n\t\"DiagCross\": \"darkGrid\",\n\t\"ThickDiagCross\": \"darkTrellis\",\n\t\"ThinHorzStripe\": \"lightHorizontal\",\n\t\"ThinVertStripe\": \"lightVertical\",\n\t\"ThinReverseDiagStripe\": \"lightDown\",\n\t\"ThinHorzCross\": \"lightGrid\"\n};\n\n/* 18.8.5 borders CT_Borders */\nfunction parse_borders(t, styles, themes, opts) {\n\tstyles.Borders = [];\n\tvar border = {};\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<borders': case '<borders>': case '</borders>': break;\n\n\t\t\t/* 18.8.4 border CT_Border */\n\t\t\tcase '<border': case '<border>': case '<border/>':\n\t\t\t\tborder = /*::(*/{}/*:: :any)*/;\n\t\t\t\tif(y.diagonalUp) border.diagonalUp = parsexmlbool(y.diagonalUp);\n\t\t\t\tif(y.diagonalDown) border.diagonalDown = parsexmlbool(y.diagonalDown);\n\t\t\t\tstyles.Borders.push(border);\n\t\t\t\tbreak;\n\t\t\tcase '</border>': break;\n\n\t\t\t/* note: not in spec, appears to be CT_BorderPr */\n\t\t\tcase '<left/>': break;\n\t\t\tcase '<left': case '<left>': break;\n\t\t\tcase '</left>': break;\n\n\t\t\t/* note: not in spec, appears to be CT_BorderPr */\n\t\t\tcase '<right/>': break;\n\t\t\tcase '<right': case '<right>': break;\n\t\t\tcase '</right>': break;\n\n\t\t\t/* 18.8.43 top CT_BorderPr */\n\t\t\tcase '<top/>': break;\n\t\t\tcase '<top': case '<top>': break;\n\t\t\tcase '</top>': break;\n\n\t\t\t/* 18.8.6 bottom CT_BorderPr */\n\t\t\tcase '<bottom/>': break;\n\t\t\tcase '<bottom': case '<bottom>': break;\n\t\t\tcase '</bottom>': break;\n\n\t\t\t/* 18.8.13 diagonal CT_BorderPr */\n\t\t\tcase '<diagonal': case '<diagonal>': case '<diagonal/>': break;\n\t\t\tcase '</diagonal>': break;\n\n\t\t\t/* 18.8.25 horizontal CT_BorderPr */\n\t\t\tcase '<horizontal': case '<horizontal>': case '<horizontal/>': break;\n\t\t\tcase '</horizontal>': break;\n\n\t\t\t/* 18.8.44 vertical CT_BorderPr */\n\t\t\tcase '<vertical': case '<vertical>': case '<vertical/>': break;\n\t\t\tcase '</vertical>': break;\n\n\t\t\t/* 18.8.37 start CT_BorderPr */\n\t\t\tcase '<start': case '<start>': case '<start/>': break;\n\t\t\tcase '</start>': break;\n\n\t\t\t/* 18.8.16 end CT_BorderPr */\n\t\t\tcase '<end': case '<end>': case '<end/>': break;\n\t\t\tcase '</end>': break;\n\n\t\t\t/* 18.8.? color CT_Color */\n\t\t\tcase '<color': case '<color>':\n\t\t\t\tbreak;\n\t\t\tcase '<color/>': case '</color>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in borders');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.21 fills CT_Fills */\nfunction parse_fills(t, styles, themes, opts) {\n\tstyles.Fills = [];\n\tvar fill = {};\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<fills': case '<fills>': case '</fills>': break;\n\n\t\t\t/* 18.8.20 fill CT_Fill */\n\t\t\tcase '<fill>': case '<fill': case '<fill/>':\n\t\t\t\tfill = {}; styles.Fills.push(fill); break;\n\t\t\tcase '</fill>': break;\n\n\t\t\t/* 18.8.24 gradientFill CT_GradientFill */\n\t\t\tcase '<gradientFill>': break;\n\t\t\tcase '<gradientFill':\n\t\t\tcase '</gradientFill>': styles.Fills.push(fill); fill = {}; break;\n\n\t\t\t/* 18.8.32 patternFill CT_PatternFill */\n\t\t\tcase '<patternFill': case '<patternFill>':\n\t\t\t\tif(y.patternType) fill.patternType = y.patternType;\n\t\t\t\tbreak;\n\t\t\tcase '<patternFill/>': case '</patternFill>': break;\n\n\t\t\t/* 18.8.3 bgColor CT_Color */\n\t\t\tcase '<bgColor':\n\t\t\t\tif(!fill.bgColor) fill.bgColor = {};\n\t\t\t\tif(y.indexed) fill.bgColor.indexed = parseInt(y.indexed, 10);\n\t\t\t\tif(y.theme) fill.bgColor.theme = parseInt(y.theme, 10);\n\t\t\t\tif(y.tint) fill.bgColor.tint = parseFloat(y.tint);\n\t\t\t\t/* Excel uses ARGB strings */\n\t\t\t\tif(y.rgb) fill.bgColor.rgb = y.rgb.slice(-6);\n\t\t\t\tbreak;\n\t\t\tcase '<bgColor/>': case '</bgColor>': break;\n\n\t\t\t/* 18.8.19 fgColor CT_Color */\n\t\t\tcase '<fgColor':\n\t\t\t\tif(!fill.fgColor) fill.fgColor = {};\n\t\t\t\tif(y.theme) fill.fgColor.theme = parseInt(y.theme, 10);\n\t\t\t\tif(y.tint) fill.fgColor.tint = parseFloat(y.tint);\n\t\t\t\t/* Excel uses ARGB strings */\n\t\t\t\tif(y.rgb != null) fill.fgColor.rgb = y.rgb.slice(-6);\n\t\t\t\tbreak;\n\t\t\tcase '<fgColor/>': case '</fgColor>': break;\n\n\t\t\t/* 18.8.38 stop CT_GradientStop */\n\t\t\tcase '<stop': case '<stop/>': break;\n\t\t\tcase '</stop>': break;\n\n\t\t\t/* 18.8.? color CT_Color */\n\t\t\tcase '<color': case '<color/>': break;\n\t\t\tcase '</color>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in fills');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.23 fonts CT_Fonts */\nfunction parse_fonts(t, styles, themes, opts) {\n\tstyles.Fonts = [];\n\tvar font = {};\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<fonts': case '<fonts>': case '</fonts>': break;\n\n\t\t\t/* 18.8.22 font CT_Font */\n\t\t\tcase '<font': case '<font>': break;\n\t\t\tcase '</font>': case '<font/>':\n\t\t\t\tstyles.Fonts.push(font);\n\t\t\t\tfont = {};\n\t\t\t\tbreak;\n\n\t\t\t/* 18.8.29 name CT_FontName */\n\t\t\tcase '<name': if(y.val) font.name = utf8read(y.val); break;\n\t\t\tcase '<name/>': case '</name>': break;\n\n\t\t\t/* 18.8.2  b CT_BooleanProperty */\n\t\t\tcase '<b': font.bold = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<b/>': font.bold = 1; break;\n\n\t\t\t/* 18.8.26 i CT_BooleanProperty */\n\t\t\tcase '<i': font.italic = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<i/>': font.italic = 1; break;\n\n\t\t\t/* 18.4.13 u CT_UnderlineProperty */\n\t\t\tcase '<u':\n\t\t\t\tswitch(y.val) {\n\t\t\t\t\tcase \"none\": font.underline = 0x00; break;\n\t\t\t\t\tcase \"single\": font.underline = 0x01; break;\n\t\t\t\t\tcase \"double\": font.underline = 0x02; break;\n\t\t\t\t\tcase \"singleAccounting\": font.underline = 0x21; break;\n\t\t\t\t\tcase \"doubleAccounting\": font.underline = 0x22; break;\n\t\t\t\t} break;\n\t\t\tcase '<u/>': font.underline = 1; break;\n\n\t\t\t/* 18.4.10 strike CT_BooleanProperty */\n\t\t\tcase '<strike': font.strike = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<strike/>': font.strike = 1; break;\n\n\t\t\t/* 18.4.2  outline CT_BooleanProperty */\n\t\t\tcase '<outline': font.outline = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<outline/>': font.outline = 1; break;\n\n\t\t\t/* 18.8.36 shadow CT_BooleanProperty */\n\t\t\tcase '<shadow': font.shadow = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<shadow/>': font.shadow = 1; break;\n\n\t\t\t/* 18.8.12 condense CT_BooleanProperty */\n\t\t\tcase '<condense': font.condense = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<condense/>': font.condense = 1; break;\n\n\t\t\t/* 18.8.17 extend CT_BooleanProperty */\n\t\t\tcase '<extend': font.extend = y.val ? parsexmlbool(y.val) : 1; break;\n\t\t\tcase '<extend/>': font.extend = 1; break;\n\n\t\t\t/* 18.4.11 sz CT_FontSize */\n\t\t\tcase '<sz': if(y.val) font.sz = +y.val; break;\n\t\t\tcase '<sz/>': case '</sz>': break;\n\n\t\t\t/* 18.4.14 vertAlign CT_VerticalAlignFontProperty */\n\t\t\tcase '<vertAlign': if(y.val) font.vertAlign = y.val; break;\n\t\t\tcase '<vertAlign/>': case '</vertAlign>': break;\n\n\t\t\t/* 18.8.18 family CT_FontFamily */\n\t\t\tcase '<family': if(y.val) font.family = parseInt(y.val,10); break;\n\t\t\tcase '<family/>': case '</family>': break;\n\n\t\t\t/* 18.8.35 scheme CT_FontScheme */\n\t\t\tcase '<scheme': if(y.val) font.scheme = y.val; break;\n\t\t\tcase '<scheme/>': case '</scheme>': break;\n\n\t\t\t/* 18.4.1 charset CT_IntProperty */\n\t\t\tcase '<charset':\n\t\t\t\tif(y.val == '1') break;\n\t\t\t\ty.codepage = CS2CP[parseInt(y.val, 10)];\n\t\t\t\tbreak;\n\n\t\t\t/* 18.?.? color CT_Color */\n\t\t\tcase '<color':\n\t\t\t\tif(!font.color) font.color = {};\n\t\t\t\tif(y.auto) font.color.auto = parsexmlbool(y.auto);\n\n\t\t\t\tif(y.rgb) font.color.rgb = y.rgb.slice(-6);\n\t\t\t\telse if(y.indexed) {\n\t\t\t\t\tfont.color.index = parseInt(y.indexed, 10);\n\t\t\t\t\tvar icv = XLSIcv[font.color.index];\n\t\t\t\t\tif(font.color.index == 81) icv = XLSIcv[1];\n\t\t\t\t\tif(!icv) icv = XLSIcv[1]; //throw new Error(x); // note: 206 is valid\n\t\t\t\t\tfont.color.rgb = icv[0].toString(16) + icv[1].toString(16) + icv[2].toString(16);\n\t\t\t\t} else if(y.theme) {\n\t\t\t\t\tfont.color.theme = parseInt(y.theme, 10);\n\t\t\t\t\tif(y.tint) font.color.tint = parseFloat(y.tint);\n\t\t\t\t\tif(y.theme && themes.themeElements && themes.themeElements.clrScheme) {\n\t\t\t\t\t\tfont.color.rgb = rgb_tint(themes.themeElements.clrScheme[font.color.theme].rgb, font.color.tint || 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\tcase '<color/>': case '</color>': break;\n\n\t\t\t/* note: sometimes mc:AlternateContent appears bare */\n\t\t\tcase '<AlternateContent': pass = true; break;\n\t\t\tcase '</AlternateContent>': pass = false; break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in fonts');\n\t\t\t}\n\t\t}\n\t});\n}\n\n/* 18.8.31 numFmts CT_NumFmts */\nfunction parse_numFmts(t, styles, opts) {\n\tstyles.NumberFmt = [];\n\tvar k/*Array<number>*/ = (keys(table_fmt)/*:any*/);\n\tfor(var i=0; i < k.length; ++i) styles.NumberFmt[k[i]] = table_fmt[k[i]];\n\tvar m = t[0].match(tagregex);\n\tif(!m) return;\n\tfor(i=0; i < m.length; ++i) {\n\t\tvar y = parsexmltag(m[i]);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<numFmts': case '</numFmts>': case '<numFmts/>': case '<numFmts>': break;\n\t\t\tcase '<numFmt': {\n\t\t\t\tvar f=unescapexml(utf8read(y.formatCode)), j=parseInt(y.numFmtId,10);\n\t\t\t\tstyles.NumberFmt[j] = f;\n\t\t\t\tif(j>0) {\n\t\t\t\t\tif(j > 0x188) {\n\t\t\t\t\t\tfor(j = 0x188; j > 0x3c; --j) if(styles.NumberFmt[j] == null) break;\n\t\t\t\t\t\tstyles.NumberFmt[j] = f;\n\t\t\t\t\t}\n\t\t\t\t\tSSF_load(f,j);\n\t\t\t\t}\n\t\t\t} break;\n\t\t\tcase '</numFmt>': break;\n\t\t\tdefault: if(opts.WTF) throw new Error('unrecognized ' + y[0] + ' in numFmts');\n\t\t}\n\t}\n}\n\nfunction write_numFmts(NF/*:{[n:number|string]:string}*//*::, opts*/) {\n\tvar o = [\"<numFmts>\"];\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) o[o.length] = (writextag('numFmt',null,{numFmtId:i,formatCode:escapexml(NF[i])}));\n\t});\n\tif(o.length === 1) return \"\";\n\to[o.length] = (\"</numFmts>\");\n\to[0] = writextag('numFmts', null, { count:o.length-2 }).replace(\"/>\", \">\");\n\treturn o.join(\"\");\n}\n\n/* 18.8.10 cellXfs CT_CellXfs */\nvar cellXF_uint = [ \"numFmtId\", \"fillId\", \"fontId\", \"borderId\", \"xfId\" ];\nvar cellXF_bool = [ \"applyAlignment\", \"applyBorder\", \"applyFill\", \"applyFont\", \"applyNumberFormat\", \"applyProtection\", \"pivotButton\", \"quotePrefix\" ];\nfunction parse_cellXfs(t, styles, opts) {\n\tstyles.CellXf = [];\n\tvar xf;\n\tvar pass = false;\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x), i = 0;\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<cellXfs': case '<cellXfs>': case '<cellXfs/>': case '</cellXfs>': break;\n\n\t\t\t/* 18.8.45 xf CT_Xf */\n\t\t\tcase '<xf': case '<xf/>':\n\t\t\t\txf = y;\n\t\t\t\tdelete xf[0];\n\t\t\t\tfor(i = 0; i < cellXF_uint.length; ++i) if(xf[cellXF_uint[i]])\n\t\t\t\t\txf[cellXF_uint[i]] = parseInt(xf[cellXF_uint[i]], 10);\n\t\t\t\tfor(i = 0; i < cellXF_bool.length; ++i) if(xf[cellXF_bool[i]])\n\t\t\t\t\txf[cellXF_bool[i]] = parsexmlbool(xf[cellXF_bool[i]]);\n\t\t\t\tif(styles.NumberFmt && xf.numFmtId > 0x188) {\n\t\t\t\t\tfor(i = 0x188; i > 0x3c; --i) if(styles.NumberFmt[xf.numFmtId] == styles.NumberFmt[i]) { xf.numFmtId = i; break; }\n\t\t\t\t}\n\t\t\t\tstyles.CellXf.push(xf); break;\n\t\t\tcase '</xf>': break;\n\n\t\t\t/* 18.8.1 alignment CT_CellAlignment */\n\t\t\tcase '<alignment': case '<alignment/>':\n\t\t\t\tvar alignment = {};\n\t\t\t\tif(y.vertical) alignment.vertical = y.vertical;\n\t\t\t\tif(y.horizontal) alignment.horizontal = y.horizontal;\n\t\t\t\tif(y.textRotation != null) alignment.textRotation = y.textRotation;\n\t\t\t\tif(y.indent) alignment.indent = y.indent;\n\t\t\t\tif(y.wrapText) alignment.wrapText = parsexmlbool(y.wrapText);\n\t\t\t\txf.alignment = alignment;\n\t\t\t\tbreak;\n\t\t\tcase '</alignment>': break;\n\n\t\t\t/* 18.8.33 protection CT_CellProtection */\n\t\t\tcase '<protection':\n\t\t\t\tbreak;\n\t\t\tcase '</protection>': case '<protection/>': break;\n\n\t\t\t/* note: sometimes mc:AlternateContent appears bare */\n\t\t\tcase '<AlternateContent': pass = true; break;\n\t\t\tcase '</AlternateContent>': pass = false; break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': break;\n\t\t\tcase '<ext': pass = true; break;\n\t\t\tcase '</ext>': pass = false; break;\n\t\t\tdefault: if(opts && opts.WTF) {\n\t\t\t\tif(!pass) throw new Error('unrecognized ' + y[0] + ' in cellXfs');\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction write_cellXfs(cellXfs)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\to[o.length] = (writextag('cellXfs',null));\n\tcellXfs.forEach(function(c) {\n\t\to[o.length] = (writextag('xf', null, c));\n\t});\n\to[o.length] = (\"</cellXfs>\");\n\tif(o.length === 2) return \"\";\n\to[0] = writextag('cellXfs',null, {count:o.length-2}).replace(\"/>\",\">\");\n\treturn o.join(\"\");\n}\n\n/* 18.8 Styles CT_Stylesheet*/\nvar parse_sty_xml= /*#__PURE__*/(function make_pstyx() {\nvar numFmtRegex = /<(?:\\w+:)?numFmts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?numFmts>/;\nvar cellXfRegex = /<(?:\\w+:)?cellXfs([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?cellXfs>/;\nvar fillsRegex = /<(?:\\w+:)?fills([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fills>/;\nvar fontsRegex = /<(?:\\w+:)?fonts([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?fonts>/;\nvar bordersRegex = /<(?:\\w+:)?borders([^>]*)>[\\S\\s]*?<\\/(?:\\w+:)?borders>/;\n\nreturn function parse_sty_xml(data, themes, opts) {\n\tvar styles = {};\n\tif(!data) return styles;\n\tdata = data.replace(/<!--([\\s\\S]*?)-->/mg,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");\n\t/* 18.8.39 styleSheet CT_Stylesheet */\n\tvar t;\n\n\t/* 18.8.31 numFmts CT_NumFmts ? */\n\tif((t=data.match(numFmtRegex))) parse_numFmts(t, styles, opts);\n\n\t/* 18.8.23 fonts CT_Fonts ? */\n\tif((t=data.match(fontsRegex))) parse_fonts(t, styles, themes, opts);\n\n\t/* 18.8.21 fills CT_Fills ? */\n\tif((t=data.match(fillsRegex))) parse_fills(t, styles, themes, opts);\n\n\t/* 18.8.5  borders CT_Borders ? */\n\tif((t=data.match(bordersRegex))) parse_borders(t, styles, themes, opts);\n\n\t/* 18.8.9  cellStyleXfs CT_CellStyleXfs ? */\n\t/* 18.8.8  cellStyles CT_CellStyles ? */\n\n\t/* 18.8.10 cellXfs CT_CellXfs ? */\n\tif((t=data.match(cellXfRegex))) parse_cellXfs(t, styles, opts);\n\n\t/* 18.8.15 dxfs CT_Dxfs ? */\n\t/* 18.8.42 tableStyles CT_TableStyles ? */\n\t/* 18.8.11 colors CT_Colors ? */\n\t/* 18.2.10 extLst CT_ExtensionList ? */\n\n\treturn styles;\n};\n})();\n\nfunction write_sty_xml(wb/*:Workbook*/, opts)/*:string*/ {\n\tvar o = [XML_HEADER, writextag('styleSheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:vt': XMLNS.vt\n\t})], w;\n\tif(wb.SSF && (w = write_numFmts(wb.SSF)) != null) o[o.length] = w;\n\to[o.length] = ('<fonts count=\"1\"><font><sz val=\"12\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts>');\n\to[o.length] = ('<fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills>');\n\to[o.length] = ('<borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders>');\n\to[o.length] = ('<cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>');\n\tif((w = write_cellXfs(opts.cellXfs))) o[o.length] = (w);\n\to[o.length] = ('<cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles>');\n\to[o.length] = ('<dxfs count=\"0\"/>');\n\to[o.length] = ('<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\"/>');\n\n\tif(o.length>2){ o[o.length] = ('</styleSheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.657 BrtFmt */\nfunction parse_BrtFmt(data, length/*:number*/) {\n\tvar numFmtId = data.read_shift(2);\n\tvar stFmtCode = parse_XLWideString(data,length-2);\n\treturn [numFmtId, stFmtCode];\n}\nfunction write_BrtFmt(i/*:number*/, f/*:string*/, o) {\n\tif(!o) o = new_buf(6 + 4 * f.length);\n\to.write_shift(2, i);\n\twrite_XLWideString(f, o);\n\tvar out = (o.length > o.l) ? o.slice(0, o.l) : o;\n\tif(o.l == null) o.l = o.length;\n\treturn out;\n}\n\n/* [MS-XLSB] 2.4.659 BrtFont TODO */\nfunction parse_BrtFont(data, length/*:number*/, opts) {\n\tvar out = ({}/*:any*/);\n\n\tout.sz = data.read_shift(2) / 20;\n\n\tvar grbit = parse_FontFlags(data, 2, opts);\n\tif(grbit.fItalic) out.italic = 1;\n\tif(grbit.fCondense) out.condense = 1;\n\tif(grbit.fExtend) out.extend = 1;\n\tif(grbit.fShadow) out.shadow = 1;\n\tif(grbit.fOutline) out.outline = 1;\n\tif(grbit.fStrikeout) out.strike = 1;\n\n\tvar bls = data.read_shift(2);\n\tif(bls === 0x02BC) out.bold = 1;\n\n\tswitch(data.read_shift(2)) {\n\t\t/* case 0: out.vertAlign = \"baseline\"; break; */\n\t\tcase 1: out.vertAlign = \"superscript\"; break;\n\t\tcase 2: out.vertAlign = \"subscript\"; break;\n\t}\n\n\tvar underline = data.read_shift(1);\n\tif(underline != 0) out.underline = underline;\n\n\tvar family = data.read_shift(1);\n\tif(family > 0) out.family = family;\n\n\tvar bCharSet = data.read_shift(1);\n\tif(bCharSet > 0) out.charset = bCharSet;\n\n\tdata.l++;\n\tout.color = parse_BrtColor(data, 8);\n\n\tswitch(data.read_shift(1)) {\n\t\t/* case 0: out.scheme = \"none\": break; */\n\t\tcase 1: out.scheme = \"major\"; break;\n\t\tcase 2: out.scheme = \"minor\"; break;\n\t}\n\n\tout.name = parse_XLWideString(data, length - 21);\n\n\treturn out;\n}\nfunction write_BrtFont(font/*:any*/, o) {\n\tif(!o) o = new_buf(25+4*32);\n\to.write_shift(2, font.sz * 20);\n\twrite_FontFlags(font, o);\n\to.write_shift(2, font.bold ? 0x02BC : 0x0190);\n\tvar sss = 0;\n\tif(font.vertAlign == \"superscript\") sss = 1;\n\telse if(font.vertAlign == \"subscript\") sss = 2;\n\to.write_shift(2, sss);\n\to.write_shift(1, font.underline || 0);\n\to.write_shift(1, font.family || 0);\n\to.write_shift(1, font.charset || 0);\n\to.write_shift(1, 0);\n\twrite_BrtColor(font.color, o);\n\tvar scheme = 0;\n\tif(font.scheme == \"major\") scheme = 1;\n\tif(font.scheme == \"minor\") scheme = 2;\n\to.write_shift(1, scheme);\n\twrite_XLWideString(font.name, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.650 BrtFill */\nvar XLSBFillPTNames = [\n\t\"none\",\n\t\"solid\",\n\t\"mediumGray\",\n\t\"darkGray\",\n\t\"lightGray\",\n\t\"darkHorizontal\",\n\t\"darkVertical\",\n\t\"darkDown\",\n\t\"darkUp\",\n\t\"darkGrid\",\n\t\"darkTrellis\",\n\t\"lightHorizontal\",\n\t\"lightVertical\",\n\t\"lightDown\",\n\t\"lightUp\",\n\t\"lightGrid\",\n\t\"lightTrellis\",\n\t\"gray125\",\n\t\"gray0625\"\n];\nvar rev_XLSBFillPTNames/*:EvertNumType*/;\n/* TODO: gradient fill representation */\nvar parse_BrtFill = parsenoop;\nfunction write_BrtFill(fill, o) {\n\tif(!o) o = new_buf(4*3 + 8*7 + 16*1);\n\tif(!rev_XLSBFillPTNames) rev_XLSBFillPTNames = (evert(XLSBFillPTNames)/*:any*/);\n\tvar fls/*:number*/ = rev_XLSBFillPTNames[fill.patternType];\n\tif(fls == null) fls = 0x28;\n\to.write_shift(4, fls);\n\tvar j = 0;\n\tif(fls != 0x28) {\n\t\t/* TODO: custom FG Color */\n\t\twrite_BrtColor({auto:1}, o);\n\t\t/* TODO: custom BG Color */\n\t\twrite_BrtColor({auto:1}, o);\n\n\t\tfor(; j < 12; ++j) o.write_shift(4, 0);\n\t} else {\n\t\tfor(; j < 4; ++j) o.write_shift(4, 0);\n\n\t\tfor(; j < 12; ++j) o.write_shift(4, 0); /* TODO */\n\t\t/* iGradientType */\n\t\t/* xnumDegree */\n\t\t/* xnumFillToLeft */\n\t\t/* xnumFillToRight */\n\t\t/* xnumFillToTop */\n\t\t/* xnumFillToBottom */\n\t\t/* cNumStop */\n\t\t/* xfillGradientStop */\n\t}\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.824 BrtXF */\nfunction parse_BrtXF(data, length/*:number*/) {\n\tvar tgt = data.l + length;\n\tvar ixfeParent = data.read_shift(2);\n\tvar ifmt = data.read_shift(2);\n\tdata.l = tgt;\n\treturn {ixfe:ixfeParent, numFmtId:ifmt };\n}\nfunction write_BrtXF(data, ixfeP, o) {\n\tif(!o) o = new_buf(16);\n\to.write_shift(2, ixfeP||0);\n\to.write_shift(2, data.numFmtId||0);\n\to.write_shift(2, 0); /* iFont */\n\to.write_shift(2, 0); /* iFill */\n\to.write_shift(2, 0); /* ixBorder */\n\to.write_shift(1, 0); /* trot */\n\to.write_shift(1, 0); /* indent */\n\tvar flow = 0;\n\to.write_shift(1, flow); /* flags */\n\to.write_shift(1, 0); /* flags */\n\to.write_shift(1, 0); /* xfGrbitAtr */\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.5.4 Blxf TODO */\nfunction write_Blxf(data, o) {\n\tif(!o) o = new_buf(10);\n\to.write_shift(1, 0); /* dg */\n\to.write_shift(1, 0);\n\to.write_shift(4, 0); /* color */\n\to.write_shift(4, 0); /* color */\n\treturn o;\n}\n/* [MS-XLSB] 2.4.302 BrtBorder TODO */\nvar parse_BrtBorder = parsenoop;\nfunction write_BrtBorder(border, o) {\n\tif(!o) o = new_buf(51);\n\to.write_shift(1, 0); /* diagonal */\n\twrite_Blxf(null, o); /* top */\n\twrite_Blxf(null, o); /* bottom */\n\twrite_Blxf(null, o); /* left */\n\twrite_Blxf(null, o); /* right */\n\twrite_Blxf(null, o); /* diag */\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.763 BrtStyle TODO */\nfunction write_BrtStyle(style, o) {\n\tif(!o) o = new_buf(12+4*10);\n\to.write_shift(4, style.xfId);\n\to.write_shift(2, 1);\n\to.write_shift(1, +style.builtinId);\n\to.write_shift(1, 0); /* iLevel */\n\twrite_XLNullableWideString(style.name || \"\", o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.272 BrtBeginTableStyles */\nfunction write_BrtBeginTableStyles(cnt, defTableStyle, defPivotStyle) {\n\tvar o = new_buf(4+256*2*4);\n\to.write_shift(4, cnt);\n\twrite_XLNullableWideString(defTableStyle, o);\n\twrite_XLNullableWideString(defPivotStyle, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction parse_sty_bin(data, themes, opts) {\n\tvar styles = {};\n\tstyles.NumberFmt = ([]/*:any*/);\n\tfor(var y in table_fmt) styles.NumberFmt[y] = table_fmt[y];\n\n\tstyles.CellXf = [];\n\tstyles.Fonts = [];\n\tvar state/*:Array<string>*/ = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_sty(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x002C: /* BrtFmt */\n\t\t\t\tstyles.NumberFmt[val[0]] = val[1]; SSF_load(val[1], val[0]);\n\t\t\t\tbreak;\n\t\t\tcase 0x002B: /* BrtFont */\n\t\t\t\tstyles.Fonts.push(val);\n\t\t\t\tif(val.color.theme != null && themes && themes.themeElements && themes.themeElements.clrScheme) {\n\t\t\t\t\tval.color.rgb = rgb_tint(themes.themeElements.clrScheme[val.color.theme].rgb, val.color.tint || 0);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 0x0401: /* BrtKnownFonts */ break;\n\t\t\tcase 0x002D: /* BrtFill */\n\t\t\t\tbreak;\n\t\t\tcase 0x002E: /* BrtBorder */\n\t\t\t\tbreak;\n\t\t\tcase 0x002F: /* BrtXF */\n\t\t\t\tif(state[state.length - 1] == 0x0269 /* BrtBeginCellXFs */) {\n\t\t\t\t\tstyles.CellXf.push(val);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 0x0030: /* BrtStyle */\n\t\t\tcase 0x01FB: /* BrtDXF */\n\t\t\tcase 0x023C: /* BrtMRUColor */\n\t\t\tcase 0x01DB: /* BrtIndexedColor */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0493: /* BrtDXF14 */\n\t\t\tcase 0x0836: /* BrtDXF15 */\n\t\t\tcase 0x046A: /* BrtSlicerStyleElement */\n\t\t\tcase 0x0200: /* BrtTableStyleElement */\n\t\t\tcase 0x082F: /* BrtTimelineStyleElement */\n\t\t\tcase 0x0C00: /* BrtUid */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* BrtFRTBegin */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* BrtFRTEnd */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* BrtACBegin */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* BrtACEnd */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T > 0) state.push(RT);\n\t\t\t\telse if(R.T < 0) state.pop();\n\t\t\t\telse if(!pass || (opts.WTF && state[state.length-1] != 0x0025 /* BrtACBegin */)) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn styles;\n}\n\nfunction write_FMTS_bin(ba, NF/*:?SSFTable*/) {\n\tif(!NF) return;\n\tvar cnt = 0;\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\t/*:: if(!NF) return; */\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) ++cnt;\n\t});\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0267 /* BrtBeginFmts */, write_UInt32LE(cnt));\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\t/*:: if(!NF) return; */\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_record(ba, 0x002C /* BrtFmt */, write_BrtFmt(i, NF[i]));\n\t});\n\twrite_record(ba, 0x0268 /* BrtEndFmts */);\n}\n\nfunction write_FONTS_bin(ba/*::, data*/) {\n\tvar cnt = 1;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0263 /* BrtBeginFonts */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002B /* BrtFont */, write_BrtFont({\n\t\tsz:12,\n\t\tcolor: {theme:1},\n\t\tname: \"Calibri\",\n\t\tfamily: 2,\n\t\tscheme: \"minor\"\n\t}));\n\t/* 1*65491BrtFont [ACFONTS] */\n\twrite_record(ba, 0x0264 /* BrtEndFonts */);\n}\n\nfunction write_FILLS_bin(ba/*::, data*/) {\n\tvar cnt = 2;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x025B /* BrtBeginFills */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002D /* BrtFill */, write_BrtFill({patternType:\"none\"}));\n\twrite_record(ba, 0x002D /* BrtFill */, write_BrtFill({patternType:\"gray125\"}));\n\t/* 1*65431BrtFill */\n\twrite_record(ba, 0x025C /* BrtEndFills */);\n}\n\nfunction write_BORDERS_bin(ba/*::, data*/) {\n\tvar cnt = 1;\n\n\tif(cnt == 0) return;\n\twrite_record(ba, 0x0265 /* BrtBeginBorders */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002E /* BrtBorder */, write_BrtBorder({}));\n\t/* 1*65430BrtBorder */\n\twrite_record(ba, 0x0266 /* BrtEndBorders */);\n}\n\nfunction write_CELLSTYLEXFS_bin(ba/*::, data*/) {\n\tvar cnt = 1;\n\twrite_record(ba, 0x0272 /* BrtBeginCellStyleXFs */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x002F /* BrtXF */, write_BrtXF({\n\t\tnumFmtId: 0,\n\t\tfontId:   0,\n\t\tfillId:   0,\n\t\tborderId: 0\n\t}, 0xFFFF));\n\t/* 1*65430(BrtXF *FRT) */\n\twrite_record(ba, 0x0273 /* BrtEndCellStyleXFs */);\n}\n\nfunction write_CELLXFS_bin(ba, data) {\n\twrite_record(ba, 0x0269 /* BrtBeginCellXFs */, write_UInt32LE(data.length));\n\tdata.forEach(function(c) { write_record(ba, 0x002F /* BrtXF */, write_BrtXF(c,0)); });\n\t/* 1*65430(BrtXF *FRT) */\n\twrite_record(ba, 0x026A /* BrtEndCellXFs */);\n}\n\nfunction write_STYLES_bin(ba/*::, data*/) {\n\tvar cnt = 1;\n\n\twrite_record(ba, 0x026B /* BrtBeginStyles */, write_UInt32LE(cnt));\n\twrite_record(ba, 0x0030 /* BrtStyle */, write_BrtStyle({\n\t\txfId:0,\n\t\tbuiltinId:0,\n\t\tname:\"Normal\"\n\t}));\n\t/* 1*65430(BrtStyle *FRT) */\n\twrite_record(ba, 0x026C /* BrtEndStyles */);\n}\n\nfunction write_DXFS_bin(ba/*::, data*/) {\n\tvar cnt = 0;\n\n\twrite_record(ba, 0x01F9 /* BrtBeginDXFs */, write_UInt32LE(cnt));\n\t/* *2147483647(BrtDXF *FRT) */\n\twrite_record(ba, 0x01FA /* BrtEndDXFs */);\n}\n\nfunction write_TABLESTYLES_bin(ba/*::, data*/) {\n\tvar cnt = 0;\n\n\twrite_record(ba, 0x01FC /* BrtBeginTableStyles */, write_BrtBeginTableStyles(cnt, \"TableStyleMedium9\", \"PivotStyleMedium4\"));\n\t/* *TABLESTYLE */\n\twrite_record(ba, 0x01FD /* BrtEndTableStyles */);\n}\n\nfunction write_COLORPALETTE_bin(/*::ba, data*/) {\n\treturn;\n\t/* BrtBeginColorPalette [INDEXEDCOLORS] [MRUCOLORS] BrtEndColorPalette */\n}\n\n/* [MS-XLSB] 2.1.7.50 Styles */\nfunction write_sty_bin(wb, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0116 /* BrtBeginStyleSheet */);\n\twrite_FMTS_bin(ba, wb.SSF);\n\twrite_FONTS_bin(ba, wb);\n\twrite_FILLS_bin(ba, wb);\n\twrite_BORDERS_bin(ba, wb);\n\twrite_CELLSTYLEXFS_bin(ba, wb);\n\twrite_CELLXFS_bin(ba, opts.cellXfs);\n\twrite_STYLES_bin(ba, wb);\n\twrite_DXFS_bin(ba, wb);\n\twrite_TABLESTYLES_bin(ba, wb);\n\twrite_COLORPALETTE_bin(ba, wb);\n\t/* FRTSTYLESHEET*/\n\twrite_record(ba, 0x0117 /* BrtEndStyleSheet */);\n\treturn ba.end();\n}\n/* Even though theme layout is dk1 lt1 dk2 lt2, true order is lt1 dk1 lt2 dk2 */\nvar XLSXThemeClrScheme = [\n\t'</a:lt1>', '</a:dk1>', '</a:lt2>', '</a:dk2>',\n\t'</a:accent1>', '</a:accent2>', '</a:accent3>',\n\t'</a:accent4>', '</a:accent5>', '</a:accent6>',\n\t'</a:hlink>', '</a:folHlink>'\n];\n/* 20.1.6.2 clrScheme CT_ColorScheme */\nfunction parse_clrScheme(t, themes, opts) {\n\tthemes.themeElements.clrScheme = [];\n\tvar color = {};\n\t(t[0].match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\t/* 20.1.6.2 clrScheme (Color Scheme) CT_ColorScheme */\n\t\t\tcase '<a:clrScheme': case '</a:clrScheme>': break;\n\n\t\t\t/* 20.1.2.3.32 srgbClr CT_SRgbColor */\n\t\t\tcase '<a:srgbClr':\n\t\t\t\tcolor.rgb = y.val; break;\n\n\t\t\t/* 20.1.2.3.33 sysClr CT_SystemColor */\n\t\t\tcase '<a:sysClr':\n\t\t\t\tcolor.rgb = y.lastClr; break;\n\n\t\t\t/* 20.1.4.1.1 accent1 (Accent 1) */\n\t\t\t/* 20.1.4.1.2 accent2 (Accent 2) */\n\t\t\t/* 20.1.4.1.3 accent3 (Accent 3) */\n\t\t\t/* 20.1.4.1.4 accent4 (Accent 4) */\n\t\t\t/* 20.1.4.1.5 accent5 (Accent 5) */\n\t\t\t/* 20.1.4.1.6 accent6 (Accent 6) */\n\t\t\t/* 20.1.4.1.9 dk1 (Dark 1) */\n\t\t\t/* 20.1.4.1.10 dk2 (Dark 2) */\n\t\t\t/* 20.1.4.1.15 folHlink (Followed Hyperlink) */\n\t\t\t/* 20.1.4.1.19 hlink (Hyperlink) */\n\t\t\t/* 20.1.4.1.22 lt1 (Light 1) */\n\t\t\t/* 20.1.4.1.23 lt2 (Light 2) */\n\t\t\tcase '<a:dk1>': case '</a:dk1>':\n\t\t\tcase '<a:lt1>': case '</a:lt1>':\n\t\t\tcase '<a:dk2>': case '</a:dk2>':\n\t\t\tcase '<a:lt2>': case '</a:lt2>':\n\t\t\tcase '<a:accent1>': case '</a:accent1>':\n\t\t\tcase '<a:accent2>': case '</a:accent2>':\n\t\t\tcase '<a:accent3>': case '</a:accent3>':\n\t\t\tcase '<a:accent4>': case '</a:accent4>':\n\t\t\tcase '<a:accent5>': case '</a:accent5>':\n\t\t\tcase '<a:accent6>': case '</a:accent6>':\n\t\t\tcase '<a:hlink>': case '</a:hlink>':\n\t\t\tcase '<a:folHlink>': case '</a:folHlink>':\n\t\t\t\tif (y[0].charAt(1) === '/') {\n\t\t\t\t\tthemes.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(y[0])] = color;\n\t\t\t\t\tcolor = {};\n\t\t\t\t} else {\n\t\t\t\t\tcolor.name = y[0].slice(3, y[0].length - 1);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault: if(opts && opts.WTF) throw new Error('Unrecognized ' + y[0] + ' in clrScheme');\n\t\t}\n\t});\n}\n\n/* 20.1.4.1.18 fontScheme CT_FontScheme */\nfunction parse_fontScheme(/*::t, themes, opts*/) { }\n\n/* 20.1.4.1.15 fmtScheme CT_StyleMatrix */\nfunction parse_fmtScheme(/*::t, themes, opts*/) { }\n\nvar clrsregex = /<a:clrScheme([^>]*)>[\\s\\S]*<\\/a:clrScheme>/;\nvar fntsregex = /<a:fontScheme([^>]*)>[\\s\\S]*<\\/a:fontScheme>/;\nvar fmtsregex = /<a:fmtScheme([^>]*)>[\\s\\S]*<\\/a:fmtScheme>/;\n\n/* 20.1.6.10 themeElements CT_BaseStyles */\nfunction parse_themeElements(data, themes, opts) {\n\tthemes.themeElements = {};\n\n\tvar t;\n\n\t[\n\t\t/* clrScheme CT_ColorScheme */\n\t\t['clrScheme', clrsregex, parse_clrScheme],\n\t\t/* fontScheme CT_FontScheme */\n\t\t['fontScheme', fntsregex, parse_fontScheme],\n\t\t/* fmtScheme CT_StyleMatrix */\n\t\t['fmtScheme', fmtsregex, parse_fmtScheme]\n\t].forEach(function(m) {\n\t\tif(!(t=data.match(m[1]))) throw new Error(m[0] + ' not found in themeElements');\n\t\tm[2](t, themes, opts);\n\t});\n}\n\nvar themeltregex = /<a:themeElements([^>]*)>[\\s\\S]*<\\/a:themeElements>/;\n\n/* 14.2.7 Theme Part */\nfunction parse_theme_xml(data/*:string*/, opts) {\n\t/* 20.1.6.9 theme CT_OfficeStyleSheet */\n\tif(!data || data.length === 0) data = write_theme();\n\n\tvar t;\n\tvar themes = {};\n\n\t/* themeElements CT_BaseStyles */\n\tif(!(t=data.match(themeltregex))) throw new Error('themeElements not found in theme');\n\tparse_themeElements(t[0], themes, opts);\n\tthemes.raw = data;\n\treturn themes;\n}\n\nfunction write_theme(Themes, opts)/*:string*/ {\n\tif(opts && opts.themeXLSX) return opts.themeXLSX;\n\tif(Themes && typeof Themes.raw == \"string\") return Themes.raw;\n\tvar o = [XML_HEADER];\n\to[o.length] = '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\">';\n\to[o.length] =  '<a:themeElements>';\n\n\to[o.length] =   '<a:clrScheme name=\"Office\">';\n\to[o.length] =    '<a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1>';\n\to[o.length] =    '<a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>';\n\to[o.length] =    '<a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2>';\n\to[o.length] =    '<a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2>';\n\to[o.length] =    '<a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1>';\n\to[o.length] =    '<a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2>';\n\to[o.length] =    '<a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3>';\n\to[o.length] =    '<a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4>';\n\to[o.length] =    '<a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>';\n\to[o.length] =    '<a:accent6><a:srgbClr val=\"F79646\"/></a:accent6>';\n\to[o.length] =    '<a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink>';\n\to[o.length] =    '<a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink>';\n\to[o.length] =   '</a:clrScheme>';\n\n\to[o.length] =   '<a:fontScheme name=\"Office\">';\n\to[o.length] =    '<a:majorFont>';\n\to[o.length] =     '<a:latin typeface=\"Cambria\"/>';\n\to[o.length] =     '<a:ea typeface=\"\"/>';\n\to[o.length] =     '<a:cs typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Jpan\" typeface=\" \"/>';\n\to[o.length] =     '<a:font script=\"Hang\" typeface=\" \"/>';\n\to[o.length] =     '<a:font script=\"Hans\" typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Hant\" typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Arab\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Hebr\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n\to[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n\to[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n\to[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n\to[o.length] =     '<a:font script=\"Khmr\" typeface=\"MoolBoran\"/>';\n\to[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n\to[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n\to[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n\to[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n\to[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n\to[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n\to[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n\to[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n\to[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n\to[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n\to[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n\to[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n\to[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n\to[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n\to[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Viet\" typeface=\"Times New Roman\"/>';\n\to[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n\to[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n\to[o.length] =    '</a:majorFont>';\n\to[o.length] =    '<a:minorFont>';\n\to[o.length] =     '<a:latin typeface=\"Calibri\"/>';\n\to[o.length] =     '<a:ea typeface=\"\"/>';\n\to[o.length] =     '<a:cs typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Jpan\" typeface=\" \"/>';\n\to[o.length] =     '<a:font script=\"Hang\" typeface=\" \"/>';\n\to[o.length] =     '<a:font script=\"Hans\" typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Hant\" typeface=\"\"/>';\n\to[o.length] =     '<a:font script=\"Arab\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Hebr\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Thai\" typeface=\"Tahoma\"/>';\n\to[o.length] =     '<a:font script=\"Ethi\" typeface=\"Nyala\"/>';\n\to[o.length] =     '<a:font script=\"Beng\" typeface=\"Vrinda\"/>';\n\to[o.length] =     '<a:font script=\"Gujr\" typeface=\"Shruti\"/>';\n\to[o.length] =     '<a:font script=\"Khmr\" typeface=\"DaunPenh\"/>';\n\to[o.length] =     '<a:font script=\"Knda\" typeface=\"Tunga\"/>';\n\to[o.length] =     '<a:font script=\"Guru\" typeface=\"Raavi\"/>';\n\to[o.length] =     '<a:font script=\"Cans\" typeface=\"Euphemia\"/>';\n\to[o.length] =     '<a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/>';\n\to[o.length] =     '<a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/>';\n\to[o.length] =     '<a:font script=\"Thaa\" typeface=\"MV Boli\"/>';\n\to[o.length] =     '<a:font script=\"Deva\" typeface=\"Mangal\"/>';\n\to[o.length] =     '<a:font script=\"Telu\" typeface=\"Gautami\"/>';\n\to[o.length] =     '<a:font script=\"Taml\" typeface=\"Latha\"/>';\n\to[o.length] =     '<a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/>';\n\to[o.length] =     '<a:font script=\"Orya\" typeface=\"Kalinga\"/>';\n\to[o.length] =     '<a:font script=\"Mlym\" typeface=\"Kartika\"/>';\n\to[o.length] =     '<a:font script=\"Laoo\" typeface=\"DokChampa\"/>';\n\to[o.length] =     '<a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/>';\n\to[o.length] =     '<a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/>';\n\to[o.length] =     '<a:font script=\"Viet\" typeface=\"Arial\"/>';\n\to[o.length] =     '<a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>';\n\to[o.length] =     '<a:font script=\"Geor\" typeface=\"Sylfaen\"/>';\n\to[o.length] =    '</a:minorFont>';\n\to[o.length] =   '</a:fontScheme>';\n\n\to[o.length] =   '<a:fmtScheme name=\"Office\">';\n\to[o.length] =    '<a:fillStyleLst>';\n\to[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:lin ang=\"16200000\" scaled=\"1\"/>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:lin ang=\"16200000\" scaled=\"0\"/>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =    '</a:fillStyleLst>';\n\to[o.length] =    '<a:lnStyleLst>';\n\to[o.length] =     '<a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =     '<a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =     '<a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln>';\n\to[o.length] =    '</a:lnStyleLst>';\n\to[o.length] =    '<a:effectStyleLst>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =     '<a:effectStyle>';\n\to[o.length] =      '<a:effectLst>';\n\to[o.length] =       '<a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw>';\n\to[o.length] =      '</a:effectLst>';\n\to[o.length] =      '<a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d>';\n\to[o.length] =      '<a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d>';\n\to[o.length] =     '</a:effectStyle>';\n\to[o.length] =    '</a:effectStyleLst>';\n\to[o.length] =    '<a:bgFillStyleLst>';\n\to[o.length] =     '<a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =     '<a:gradFill rotWithShape=\"1\">';\n\to[o.length] =      '<a:gsLst>';\n\to[o.length] =       '<a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs>';\n\to[o.length] =       '<a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs>';\n\to[o.length] =      '</a:gsLst>';\n\to[o.length] =      '<a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path>';\n\to[o.length] =     '</a:gradFill>';\n\to[o.length] =    '</a:bgFillStyleLst>';\n\to[o.length] =   '</a:fmtScheme>';\n\to[o.length] =  '</a:themeElements>';\n\n\to[o.length] =  '<a:objectDefaults>';\n\to[o.length] =   '<a:spDef>';\n\to[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"3\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"lt1\"/></a:fontRef></a:style>';\n\to[o.length] =   '</a:spDef>';\n\to[o.length] =   '<a:lnDef>';\n\to[o.length] =    '<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx=\"2\"><a:schemeClr val=\"accent1\"/></a:lnRef><a:fillRef idx=\"0\"><a:schemeClr val=\"accent1\"/></a:fillRef><a:effectRef idx=\"1\"><a:schemeClr val=\"accent1\"/></a:effectRef><a:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></a:fontRef></a:style>';\n\to[o.length] =   '</a:lnDef>';\n\to[o.length] =  '</a:objectDefaults>';\n\to[o.length] =  '<a:extraClrSchemeLst/>';\n\to[o.length] = '</a:theme>';\n\treturn o.join(\"\");\n}\n/* [MS-XLS] 2.4.326 TODO: payload is a zip file */\nfunction parse_Theme(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar dwThemeVersion = blob.read_shift(4);\n\tif(dwThemeVersion === 124226) return;\n\tif(!opts.cellStyles) { blob.l = end; return; }\n\tvar data = blob.slice(blob.l);\n\tblob.l = end;\n\tvar zip; try { zip = zip_read(data, {type: \"array\"}); } catch(e) { return; }\n\tvar themeXML = getzipstr(zip, \"theme/theme/theme1.xml\", true);\n\tif(!themeXML) return;\n\treturn parse_theme_xml(themeXML, opts);\n}\n\n/* 2.5.49 */\nfunction parse_ColorTheme(blob/*::, length*/) { return blob.read_shift(4); }\n\n/* 2.5.155 */\nfunction parse_FullColorExt(blob/*::, length*/) {\n\tvar o = {};\n\to.xclrType = blob.read_shift(2);\n\to.nTintShade = blob.read_shift(2);\n\tswitch(o.xclrType) {\n\t\tcase 0: blob.l += 4; break;\n\t\tcase 1: o.xclrValue = parse_IcvXF(blob, 4); break;\n\t\tcase 2: o.xclrValue = parse_LongRGBA(blob, 4); break;\n\t\tcase 3: o.xclrValue = parse_ColorTheme(blob, 4); break;\n\t\tcase 4: blob.l += 4; break;\n\t}\n\tblob.l += 8;\n\treturn o;\n}\n\n/* 2.5.164 TODO: read 7 bits*/\nfunction parse_IcvXF(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* 2.5.280 */\nfunction parse_XFExtGradient(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* [MS-XLS] 2.5.108 */\nfunction parse_ExtProp(blob/*::, length*/)/*:Array<any>*/ {\n\tvar extType = blob.read_shift(2);\n\tvar cb = blob.read_shift(2) - 4;\n\tvar o = [extType];\n\tswitch(extType) {\n\t\tcase 0x04: case 0x05: case 0x07: case 0x08:\n\t\tcase 0x09: case 0x0A: case 0x0B: case 0x0D:\n\t\t\to[1] = parse_FullColorExt(blob, cb); break;\n\t\tcase 0x06: o[1] = parse_XFExtGradient(blob, cb); break;\n\t\tcase 0x0E: case 0x0F: o[1] = blob.read_shift(cb === 1 ? 1 : 2); break;\n\t\tdefault: throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n\t}\n\treturn o;\n}\n\n/* 2.4.355 */\nfunction parse_XFExt(blob, length) {\n\tvar end = blob.l + length;\n\tblob.l += 2;\n\tvar ixfe = blob.read_shift(2);\n\tblob.l += 2;\n\tvar cexts = blob.read_shift(2);\n\tvar ext/*:AOA*/ = [];\n\twhile(cexts-- > 0) ext.push(parse_ExtProp(blob, end-blob.l));\n\treturn {ixfe:ixfe, ext:ext};\n}\n\n/* xf is an XF, see parse_XFExt for xfext */\nfunction update_xfext(xf, xfext) {\n\txfext.forEach(function(xfe) {\n\t\tswitch(xfe[0]) { /* 2.5.108 extPropData */\n\t\t\tcase 0x04: break; /* foreground color */\n\t\t\tcase 0x05: break; /* background color */\n\t\t\tcase 0x06: break; /* gradient fill */\n\t\t\tcase 0x07: break; /* top cell border color */\n\t\t\tcase 0x08: break; /* bottom cell border color */\n\t\t\tcase 0x09: break; /* left cell border color */\n\t\t\tcase 0x0a: break; /* right cell border color */\n\t\t\tcase 0x0b: break; /* diagonal cell border color */\n\t\t\tcase 0x0d: /* text color */\n\t\t\t\tbreak;\n\t\t\tcase 0x0e: break; /* font scheme */\n\t\t\tcase 0x0f: break; /* indentation level */\n\t\t}\n\t});\n}\n\nfunction parse_BrtMdtinfo(data, length) {\n  return {\n    flags: data.read_shift(4),\n    version: data.read_shift(4),\n    name: parse_XLWideString(data, length - 8)\n  };\n}\nfunction write_BrtMdtinfo(data) {\n  var o = new_buf(12 + 2 * data.name.length);\n  o.write_shift(4, data.flags);\n  o.write_shift(4, data.version);\n  write_XLWideString(data.name, o);\n  return o.slice(0, o.l);\n}\nfunction parse_BrtMdb(data) {\n  var out = [];\n  var cnt = data.read_shift(4);\n  while (cnt-- > 0)\n    out.push([data.read_shift(4), data.read_shift(4)]);\n  return out;\n}\nfunction write_BrtMdb(mdb) {\n  var o = new_buf(4 + 8 * mdb.length);\n  o.write_shift(4, mdb.length);\n  for (var i = 0; i < mdb.length; ++i) {\n    o.write_shift(4, mdb[i][0]);\n    o.write_shift(4, mdb[i][1]);\n  }\n  return o;\n}\nfunction write_BrtBeginEsfmd(cnt, name) {\n  var o = new_buf(8 + 2 * name.length);\n  o.write_shift(4, cnt);\n  write_XLWideString(name, o);\n  return o.slice(0, o.l);\n}\nfunction parse_BrtBeginEsmdb(data) {\n  data.l += 4;\n  return data.read_shift(4) != 0;\n}\nfunction write_BrtBeginEsmdb(cnt, cm) {\n  var o = new_buf(8);\n  o.write_shift(4, cnt);\n  o.write_shift(4, cm ? 1 : 0);\n  return o;\n}\nfunction parse_xlmeta_bin(data, name, _opts) {\n  var out = { Types: [], Cell: [], Value: [] };\n  var opts = _opts || {};\n  var state = [];\n  var pass = false;\n  var metatype = 2;\n  recordhopper(data, function(val, R, RT) {\n    switch (RT) {\n      case 335:\n        out.Types.push({ name: val.name });\n        break;\n      case 51:\n        val.forEach(function(r) {\n          if (metatype == 1)\n            out.Cell.push({ type: out.Types[r[0] - 1].name, index: r[1] });\n          else if (metatype == 0)\n            out.Value.push({ type: out.Types[r[0] - 1].name, index: r[1] });\n        });\n        break;\n      case 337:\n        metatype = val ? 1 : 0;\n        break;\n      case 338:\n        metatype = 2;\n        break;\n      case 35:\n        state.push(RT);\n        pass = true;\n        break;\n      case 36:\n        state.pop();\n        pass = false;\n        break;\n      default:\n        if (R.T) {\n        } else if (!pass || opts.WTF && state[state.length - 1] != 35)\n          throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n    }\n  });\n  return out;\n}\nfunction write_xlmeta_bin() {\n  var ba = buf_array();\n  write_record(ba, 332);\n  write_record(ba, 334, write_UInt32LE(1));\n  write_record(ba, 335, write_BrtMdtinfo({\n    name: \"XLDAPR\",\n    version: 12e4,\n    flags: 3496657072\n  }));\n  write_record(ba, 336);\n  write_record(ba, 339, write_BrtBeginEsfmd(1, \"XLDAPR\"));\n  write_record(ba, 52);\n  write_record(ba, 35, write_UInt32LE(514));\n  write_record(ba, 4096, write_UInt32LE(0));\n  write_record(ba, 4097, writeuint16(1));\n  write_record(ba, 36);\n  write_record(ba, 53);\n  write_record(ba, 340);\n  write_record(ba, 337, write_BrtBeginEsmdb(1, true));\n  write_record(ba, 51, write_BrtMdb([[1, 0]]));\n  write_record(ba, 338);\n  write_record(ba, 333);\n  return ba.end();\n}\nfunction parse_xlmeta_xml(data, name, opts) {\n  var out = { Types: [], Cell: [], Value: [] };\n  if (!data)\n    return out;\n  var pass = false;\n  var metatype = 2;\n  var lastmeta;\n  data.replace(tagregex, function(x) {\n    var y = parsexmltag(x);\n    switch (strip_ns(y[0])) {\n      case \"<?xml\":\n        break;\n      case \"<metadata\":\n      case \"</metadata>\":\n        break;\n      case \"<metadataTypes\":\n      case \"</metadataTypes>\":\n        break;\n      case \"<metadataType\":\n        out.Types.push({ name: y.name });\n        break;\n      case \"</metadataType>\":\n        break;\n      case \"<futureMetadata\":\n        for (var j = 0; j < out.Types.length; ++j)\n          if (out.Types[j].name == y.name)\n            lastmeta = out.Types[j];\n        break;\n      case \"</futureMetadata>\":\n        break;\n      case \"<bk>\":\n        break;\n      case \"</bk>\":\n        break;\n      case \"<rc\":\n        if (metatype == 1)\n          out.Cell.push({ type: out.Types[y.t - 1].name, index: +y.v });\n        else if (metatype == 0)\n          out.Value.push({ type: out.Types[y.t - 1].name, index: +y.v });\n        break;\n      case \"</rc>\":\n        break;\n      case \"<cellMetadata\":\n        metatype = 1;\n        break;\n      case \"</cellMetadata>\":\n        metatype = 2;\n        break;\n      case \"<valueMetadata\":\n        metatype = 0;\n        break;\n      case \"</valueMetadata>\":\n        metatype = 2;\n        break;\n      case \"<extLst\":\n      case \"<extLst>\":\n      case \"</extLst>\":\n      case \"<extLst/>\":\n        break;\n      case \"<ext\":\n        pass = true;\n        break;\n      case \"</ext>\":\n        pass = false;\n        break;\n      case \"<rvb\":\n        if (!lastmeta)\n          break;\n        if (!lastmeta.offsets)\n          lastmeta.offsets = [];\n        lastmeta.offsets.push(+y.i);\n        break;\n      default:\n        if (!pass && opts.WTF)\n          throw new Error(\"unrecognized \" + y[0] + \" in metadata\");\n    }\n    return x;\n  });\n  return out;\n}\nfunction write_xlmeta_xml() {\n  var o = [XML_HEADER];\n  o.push('<metadata xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:xlrd=\"http://schemas.microsoft.com/office/spreadsheetml/2017/richdata\" xmlns:xda=\"http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray\">\\n  <metadataTypes count=\"1\">\\n    <metadataType name=\"XLDAPR\" minSupportedVersion=\"120000\" copy=\"1\" pasteAll=\"1\" pasteValues=\"1\" merge=\"1\" splitFirst=\"1\" rowColShift=\"1\" clearFormats=\"1\" clearComments=\"1\" assign=\"1\" coerce=\"1\" cellMeta=\"1\"/>\\n  </metadataTypes>\\n  <futureMetadata name=\"XLDAPR\" count=\"1\">\\n    <bk>\\n      <extLst>\\n        <ext uri=\"{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}\">\\n          <xda:dynamicArrayProperties fDynamic=\"1\" fCollapsed=\"0\"/>\\n        </ext>\\n      </extLst>\\n    </bk>\\n  </futureMetadata>\\n  <cellMetadata count=\"1\">\\n    <bk>\\n      <rc t=\"1\" v=\"0\"/>\\n    </bk>\\n  </cellMetadata>\\n</metadata>');\n  return o.join(\"\");\n}\n/* 18.6 Calculation Chain */\nfunction parse_cc_xml(data/*::, name, opts*/)/*:Array<any>*/ {\n\tvar d = [];\n\tif(!data) return d;\n\tvar i = 1;\n\t(data.match(tagregex)||[]).forEach(function(x) {\n\t\tvar y = parsexmltag(x);\n\t\tswitch(y[0]) {\n\t\t\tcase '<?xml': break;\n\t\t\t/* 18.6.2  calcChain CT_CalcChain 1 */\n\t\t\tcase '<calcChain': case '<calcChain>': case '</calcChain>': break;\n\t\t\t/* 18.6.1  c CT_CalcCell 1 */\n\t\t\tcase '<c': delete y[0]; if(y.i) i = y.i; else y.i = i; d.push(y); break;\n\t\t}\n\t});\n\treturn d;\n}\n\n//function write_cc_xml(data, opts) { }\n\n/* [MS-XLSB] 2.6.4.1 */\nfunction parse_BrtCalcChainItem$(data) {\n\tvar out = {};\n\tout.i = data.read_shift(4);\n\tvar cell = {};\n\tcell.r = data.read_shift(4);\n\tcell.c = data.read_shift(4);\n\tout.r = encode_cell(cell);\n\tvar flags = data.read_shift(1);\n\tif(flags & 0x2) out.l = '1';\n\tif(flags & 0x8) out.a = '1';\n\treturn out;\n}\n\n/* 18.6 Calculation Chain */\nfunction parse_cc_bin(data, name, opts) {\n\tvar out = [];\n\tvar pass = false;\n\trecordhopper(data, function hopper_cc(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x003F: /* 'BrtCalcChainItem$' */\n\t\t\t\tout.push(val); break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn out;\n}\n\n//function write_cc_bin(data, opts) { }\n/* 18.14 Supplementary Workbook Data */\nfunction parse_xlink_xml(/*::data, rel, name:string, _opts*/) {\n\t//var opts = _opts || {};\n\t//if(opts.WTF) throw \"XLSX External Link\";\n}\n\n/* [MS-XLSB] 2.1.7.25 External Link */\nfunction parse_xlink_bin(data, rel, name/*:string*/, _opts) {\n\tif(!data) return data;\n\tvar opts = _opts || {};\n\n\tvar pass = false, end = false;\n\n\trecordhopper(data, function xlink_parse(val, R, RT) {\n\t\tif(end) return;\n\t\tswitch(RT) {\n\t\t\tcase 0x0167: /* 'BrtSupTabs' */\n\t\t\tcase 0x016B: /* 'BrtExternTableStart' */\n\t\t\tcase 0x016C: /* 'BrtExternTableEnd' */\n\t\t\tcase 0x016E: /* 'BrtExternRowHdr' */\n\t\t\tcase 0x016F: /* 'BrtExternCellBlank' */\n\t\t\tcase 0x0170: /* 'BrtExternCellReal' */\n\t\t\tcase 0x0171: /* 'BrtExternCellBool' */\n\t\t\tcase 0x0172: /* 'BrtExternCellError' */\n\t\t\tcase 0x0173: /* 'BrtExternCellString' */\n\t\t\tcase 0x01D8: /* 'BrtExternValueMeta' */\n\t\t\tcase 0x0241: /* 'BrtSupNameStart' */\n\t\t\tcase 0x0242: /* 'BrtSupNameValueStart' */\n\t\t\tcase 0x0243: /* 'BrtSupNameValueEnd' */\n\t\t\tcase 0x0244: /* 'BrtSupNameNum' */\n\t\t\tcase 0x0245: /* 'BrtSupNameErr' */\n\t\t\tcase 0x0246: /* 'BrtSupNameSt' */\n\t\t\tcase 0x0247: /* 'BrtSupNameNil' */\n\t\t\tcase 0x0248: /* 'BrtSupNameBool' */\n\t\t\tcase 0x0249: /* 'BrtSupNameFmla' */\n\t\t\tcase 0x024A: /* 'BrtSupNameBits' */\n\t\t\tcase 0x024B: /* 'BrtSupNameEnd' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n}\n/* 20.5 DrawingML - SpreadsheetML Drawing */\n/* 20.5.2.35 wsDr CT_Drawing */\nfunction parse_drawing(data, rels/*:any*/) {\n\tif(!data) return \"??\";\n\t/*\n\t  Chartsheet Drawing:\n\t   - 20.5.2.35 wsDr CT_Drawing\n\t    - 20.5.2.1  absoluteAnchor CT_AbsoluteAnchor\n\t     - 20.5.2.16 graphicFrame CT_GraphicalObjectFrame\n\t      - 20.1.2.2.16 graphic CT_GraphicalObject\n\t       - 20.1.2.2.17 graphicData CT_GraphicalObjectData\n          - chart reference\n\t   the actual type is based on the URI of the graphicData\n\t\tTODO: handle embedded charts and other types of graphics\n\t*/\n\tvar id = (data.match(/<c:chart [^>]*r:id=\"([^\"]*)\"/)||[\"\",\"\"])[1];\n\n\treturn rels['!id'][id].Target;\n}\n\n/* L.5.5.2 SpreadsheetML Comments + VML Schema */\nvar _shapeid = 1024;\nfunction write_comments_vml(rId/*:number*/, comments) {\n\tvar csize = [21600, 21600];\n\t/* L.5.2.1.2 Path Attribute */\n\tvar bbox = [\"m0,0l0\",csize[1],csize[0],csize[1],csize[0],\"0xe\"].join(\",\");\n\tvar o = [\n\t\twritextag(\"xml\", null, { 'xmlns:v': XLMLNS.v, 'xmlns:o': XLMLNS.o, 'xmlns:x': XLMLNS.x, 'xmlns:mv': XLMLNS.mv }).replace(/\\/>/,\">\"),\n\t\twritextag(\"o:shapelayout\", writextag(\"o:idmap\", null, {'v:ext':\"edit\", 'data':rId}), {'v:ext':\"edit\"}),\n\t\twritextag(\"v:shapetype\", [\n\t\t\twritextag(\"v:stroke\", null, {joinstyle:\"miter\"}),\n\t\t\twritextag(\"v:path\", null, {gradientshapeok:\"t\", 'o:connecttype':\"rect\"})\n\t\t].join(\"\"), {id:\"_x0000_t202\", 'o:spt':202, coordsize:csize.join(\",\"),path:bbox})\n\t];\n\twhile(_shapeid < rId * 1000) _shapeid += 1000;\n\n\tcomments.forEach(function(x) {\n\tvar c = decode_cell(x[0]);\n\tvar fillopts = /*::(*/{'color2':\"#BEFF82\", 'type':\"gradient\"}/*:: :any)*/;\n\tif(fillopts.type == \"gradient\") fillopts.angle = \"-180\";\n\tvar fillparm = fillopts.type == \"gradient\" ? writextag(\"o:fill\", null, {type:\"gradientUnscaled\", 'v:ext':\"view\"}) : null;\n\tvar fillxml = writextag('v:fill', fillparm, fillopts);\n\n\tvar shadata = ({on:\"t\", 'obscured':\"t\"}/*:any*/);\n\t++_shapeid;\n\n\to = o.concat([\n\t'<v:shape' + wxt_helper({\n\t\tid:'_x0000_s' + _shapeid,\n\t\ttype:\"#_x0000_t202\",\n\t\tstyle:\"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10\" + (x[1].hidden ? \";visibility:hidden\" : \"\") ,\n\t\tfillcolor:\"#ECFAD4\",\n\t\tstrokecolor:\"#edeaa1\"\n\t}) + '>',\n\t\tfillxml,\n\t\twritextag(\"v:shadow\", null, shadata),\n\t\twritextag(\"v:path\", null, {'o:connecttype':\"none\"}),\n\t\t'<v:textbox><div style=\"text-align:left\"></div></v:textbox>',\n\t\t'<x:ClientData ObjectType=\"Note\">',\n\t\t\t'<x:MoveWithCells/>',\n\t\t\t'<x:SizeWithCells/>',\n\t\t\t/* Part 4 19.4.2.3 Anchor (Anchor) */\n\t\t\twritetag('x:Anchor', [c.c+1, 0, c.r+1, 0, c.c+3, 20, c.r+5, 20].join(\",\")),\n\t\t\twritetag('x:AutoFill', \"False\"),\n\t\t\twritetag('x:Row', String(c.r)),\n\t\t\twritetag('x:Column', String(c.c)),\n\t\t\tx[1].hidden ? '' : '<x:Visible/>',\n\t\t'</x:ClientData>',\n\t'</v:shape>'\n\t]); });\n\to.push('</xml>');\n\treturn o.join(\"\");\n}\nfunction sheet_insert_comments(sheet, comments/*:Array<RawComment>*/, threaded/*:boolean*/, people/*:?Array<any>*/) {\n\tvar dense = Array.isArray(sheet);\n\tvar cell/*:Cell*/;\n\tcomments.forEach(function(comment) {\n\t\tvar r = decode_cell(comment.ref);\n\t\tif(dense) {\n\t\t\tif(!sheet[r.r]) sheet[r.r] = [];\n\t\t\tcell = sheet[r.r][r.c];\n\t\t} else cell = sheet[comment.ref];\n\t\tif (!cell) {\n\t\t\tcell = ({t:\"z\"}/*:any*/);\n\t\t\tif(dense) sheet[r.r][r.c] = cell;\n\t\t\telse sheet[comment.ref] = cell;\n\t\t\tvar range = safe_decode_range(sheet[\"!ref\"]||\"BDWGO1000001:A1\");\n\t\t\tif(range.s.r > r.r) range.s.r = r.r;\n\t\t\tif(range.e.r < r.r) range.e.r = r.r;\n\t\t\tif(range.s.c > r.c) range.s.c = r.c;\n\t\t\tif(range.e.c < r.c) range.e.c = r.c;\n\t\t\tvar encoded = encode_range(range);\n\t\t\tif (encoded !== sheet[\"!ref\"]) sheet[\"!ref\"] = encoded;\n\t\t}\n\n\t\tif (!cell.c) cell.c = [];\n\t\tvar o/*:Comment*/ = ({a: comment.author, t: comment.t, r: comment.r, T: threaded});\n\t\tif(comment.h) o.h = comment.h;\n\n\t\t/* threaded comments always override */\n\t\tfor(var i = cell.c.length - 1; i >= 0; --i) {\n\t\t\tif(!threaded && cell.c[i].T) return;\n\t\t\tif(threaded && !cell.c[i].T) cell.c.splice(i, 1);\n\t\t}\n\t\tif(threaded && people) for(i = 0; i < people.length; ++i) {\n\t\t\tif(o.a == people[i].id) { o.a = people[i].name || o.a; break; }\n\t\t}\n\t\tcell.c.push(o);\n\t});\n}\n\n/* 18.7 Comments */\nfunction parse_comments_xml(data/*:string*/, opts)/*:Array<RawComment>*/ {\n\t/* 18.7.6 CT_Comments */\n\tif(data.match(/<(?:\\w+:)?comments *\\/>/)) return [];\n\tvar authors/*:Array<string>*/ = [];\n\tvar commentList/*:Array<RawComment>*/ = [];\n\tvar authtag = data.match(/<(?:\\w+:)?authors>([\\s\\S]*)<\\/(?:\\w+:)?authors>/);\n\tif(authtag && authtag[1]) authtag[1].split(/<\\/\\w*:?author>/).forEach(function(x) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tvar a = x.match(/<(?:\\w+:)?author[^>]*>(.*)/);\n\t\tif(a) authors.push(a[1]);\n\t});\n\tvar cmnttag = data.match(/<(?:\\w+:)?commentList>([\\s\\S]*)<\\/(?:\\w+:)?commentList>/);\n\tif(cmnttag && cmnttag[1]) cmnttag[1].split(/<\\/\\w*:?comment>/).forEach(function(x) {\n\t\tif(x === \"\" || x.trim() === \"\") return;\n\t\tvar cm = x.match(/<(?:\\w+:)?comment[^>]*>/);\n\t\tif(!cm) return;\n\t\tvar y = parsexmltag(cm[0]);\n\t\tvar comment/*:RawComment*/ = ({ author: y.authorId && authors[y.authorId] || \"sheetjsghost\", ref: y.ref, guid: y.guid }/*:any*/);\n\t\tvar cell = decode_cell(y.ref);\n\t\tif(opts.sheetRows && opts.sheetRows <= cell.r) return;\n\t\tvar textMatch = x.match(/<(?:\\w+:)?text>([\\s\\S]*)<\\/(?:\\w+:)?text>/);\n\t\tvar rt = !!textMatch && !!textMatch[1] && parse_si(textMatch[1]) || {r:\"\",t:\"\",h:\"\"};\n\t\tcomment.r = rt.r;\n\t\tif(rt.r == \"<t></t>\") rt.t = rt.h = \"\";\n\t\tcomment.t = (rt.t||\"\").replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\n\t\tif(opts.cellHTML) comment.h = rt.h;\n\t\tcommentList.push(comment);\n\t});\n\treturn commentList;\n}\n\nfunction write_comments_xml(data/*::, opts*/) {\n\tvar o = [XML_HEADER, writextag('comments', null, { 'xmlns': XMLNS_main[0] })];\n\n\tvar iauthor/*:Array<string>*/ = [];\n\to.push(\"<authors>\");\n\tdata.forEach(function(x) { x[1].forEach(function(w) { var a = escapexml(w.a);\n\t\tif(iauthor.indexOf(a) == -1) {\n\t\t\tiauthor.push(a);\n\t\t\to.push(\"<author>\" + a + \"</author>\");\n\t\t}\n\t\tif(w.T && w.ID && iauthor.indexOf(\"tc=\" + w.ID) == -1) {\n\t\t\tiauthor.push(\"tc=\" + w.ID);\n\t\t\to.push(\"<author>\" + \"tc=\" + w.ID + \"</author>\");\n\t\t}\n\t}); });\n\tif(iauthor.length == 0) { iauthor.push(\"SheetJ5\"); o.push(\"<author>SheetJ5</author>\"); }\n\to.push(\"</authors>\");\n\to.push(\"<commentList>\");\n\tdata.forEach(function(d) {\n\t\t/* 18.7.3 CT_Comment */\n\t\tvar lastauthor = 0, ts = [];\n\t\tif(d[1][0] && d[1][0].T && d[1][0].ID) lastauthor = iauthor.indexOf(\"tc=\" + d[1][0].ID);\n\t\telse d[1].forEach(function(c) {\n\t\t\tif(c.a) lastauthor = iauthor.indexOf(escapexml(c.a));\n\t\t\tts.push(c.t||\"\");\n\t\t});\n\t\to.push('<comment ref=\"' + d[0] + '\" authorId=\"' + lastauthor + '\"><text>');\n\t\tif(ts.length <= 1) o.push(writetag(\"t\", escapexml(ts[0]||\"\")));\n\t\telse {\n\t\t\t/* based on Threaded Comments -> Comments projection */\n\t\t\tvar t = \"Comment:\\n    \" + (ts[0]) + \"\\n\";\n\t\t\tfor(var i = 1; i < ts.length; ++i) t += \"Reply:\\n    \" + ts[i] + \"\\n\";\n\t\t\to.push(writetag(\"t\", escapexml(t)));\n\t\t}\n\t\to.push('</text></comment>');\n\t});\n\to.push(\"</commentList>\");\n\tif(o.length>2) { o[o.length] = ('</comments>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSX] 2.1.17 */\nfunction parse_tcmnt_xml(data/*:string*/, opts)/*:Array<RawComment>*/ {\n\tvar out = [];\n\tvar pass = false, comment = {}, tidx = 0;\n\tdata.replace(tagregex, function xml_tcmnt(x, idx) {\n\t\tvar y/*:any*/ = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 2.6.207 ThreadedComments CT_ThreadedComments */\n\t\t\tcase '<ThreadedComments': break;\n\t\t\tcase '</ThreadedComments>': break;\n\n\t\t\t/* 2.6.205 threadedComment CT_ThreadedComment */\n\t\t\tcase '<threadedComment': comment = {author: y.personId, guid: y.id, ref: y.ref, T: 1}; break;\n\t\t\tcase '</threadedComment>': if(comment.t != null) out.push(comment); break;\n\n\t\t\tcase '<text>': case '<text': tidx = idx + x.length; break;\n\t\t\tcase '</text>': comment.t = data.slice(tidx, idx).replace(/\\r\\n/g, \"\\n\").replace(/\\r/g, \"\\n\"); break;\n\n\t\t\t/* 2.6.206 mentions CT_ThreadedCommentMentions TODO */\n\t\t\tcase '<mentions': case '<mentions>': pass = true; break;\n\t\t\tcase '</mentions>': pass = false; break;\n\n\t\t\t/* 2.6.202 mention CT_Mention TODO */\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break;\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\n\nfunction write_tcmnt_xml(comments, people, opts) {\n\tvar o = [XML_HEADER, writextag('ThreadedComments', null, { 'xmlns': XMLNS.TCMNT }).replace(/[\\/]>/, \">\")];\n\tcomments.forEach(function(carr) {\n\t\tvar rootid = \"\";\n\t\t(carr[1] || []).forEach(function(c, idx) {\n\t\t\tif(!c.T) { delete c.ID; return; }\n\t\t\tif(c.a && people.indexOf(c.a) == -1) people.push(c.a);\n\t\t\tvar tcopts = {\n\t\t\t\tref: carr[0],\n\t\t\t\tid: \"{54EE7951-7262-4200-6969-\" + (\"000000000000\" + opts.tcid++).slice(-12) + \"}\"\n\t\t\t};\n\t\t\tif(idx == 0) rootid = tcopts.id;\n\t\t\telse tcopts.parentId = rootid;\n\t\t\tc.ID = tcopts.id;\n\t\t\tif(c.a) tcopts.personId = \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + people.indexOf(c.a)).slice(-12) + \"}\";\n\t\t\to.push(writextag('threadedComment', writetag('text', c.t||\"\"), tcopts));\n\t\t});\n\t});\n\to.push('</ThreadedComments>');\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSX] 2.1.18 */\nfunction parse_people_xml(data/*:string*/, opts) {\n\tvar out = [];\n\tvar pass = false;\n\tdata.replace(tagregex, function xml_tcmnt(x) {\n\t\tvar y/*:any*/ = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 2.4.85 personList CT_PersonList */\n\t\t\tcase '<personList': break;\n\t\t\tcase '</personList>': break;\n\n\t\t\t/* 2.6.203 person CT_Person TODO: providers */\n\t\t\tcase '<person': out.push({name: y.displayname, id: y.id }); break;\n\t\t\tcase '</person>': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break;\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in threaded comments');\n\t\t}\n\t\treturn x;\n\t});\n\treturn out;\n}\nfunction write_people_xml(people/*, opts*/) {\n\tvar o = [XML_HEADER, writextag('personList', null, {\n\t\t'xmlns': XMLNS.TCMNT,\n\t\t'xmlns:x': XMLNS_main[0]\n\t}).replace(/[\\/]>/, \">\")];\n\tpeople.forEach(function(person, idx) {\n\t\to.push(writextag('person', null, {\n\t\t\tdisplayName: person,\n\t\t\tid: \"{54EE7950-7262-4200-6969-\" + (\"000000000000\" + idx).slice(-12) + \"}\",\n\t\t\tuserId: person,\n\t\t\tproviderId: \"None\"\n\t\t}));\n\t});\n\to.push(\"</personList>\");\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.28 BrtBeginComment */\nfunction parse_BrtBeginComment(data) {\n\tvar out = {};\n\tout.iauthor = data.read_shift(4);\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tout.rfx = rfx.s;\n\tout.ref = encode_cell(rfx.s);\n\tdata.l += 16; /*var guid = parse_GUID(data); */\n\treturn out;\n}\nfunction write_BrtBeginComment(data, o) {\n\tif(o == null) o = new_buf(36);\n\to.write_shift(4, data[1].iauthor);\n\twrite_UncheckedRfX((data[0]/*:any*/), o);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\to.write_shift(4, 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.327 BrtCommentAuthor */\nvar parse_BrtCommentAuthor = parse_XLWideString;\nfunction write_BrtCommentAuthor(data) { return write_XLWideString(data.slice(0, 54)); }\n\n/* [MS-XLSB] 2.1.7.8 Comments */\nfunction parse_comments_bin(data, opts)/*:Array<RawComment>*/ {\n\tvar out/*:Array<RawComment>*/ = [];\n\tvar authors/*:Array<string>*/ = [];\n\tvar c = {};\n\tvar pass = false;\n\trecordhopper(data, function hopper_cmnt(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x0278: /* 'BrtCommentAuthor' */\n\t\t\t\tauthors.push(val); break;\n\t\t\tcase 0x027B: /* 'BrtBeginComment' */\n\t\t\t\tc = val; break;\n\t\t\tcase 0x027D: /* 'BrtCommentText' */\n\t\t\t\tc.t = val.t; c.h = val.h; c.r = val.r; break;\n\t\t\tcase 0x027C: /* 'BrtEndComment' */\n\t\t\t\tc.author = authors[c.iauthor];\n\t\t\t\tdelete (c/*:any*/).iauthor;\n\t\t\t\tif(opts.sheetRows && c.rfx && opts.sheetRows <= c.rfx.r) break;\n\t\t\t\tif(!c.t) c.t = \"\";\n\t\t\t\tdelete c.rfx; out.push(c); break;\n\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */ break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */ break;\n\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t});\n\treturn out;\n}\n\nfunction write_comments_bin(data/*::, opts*/) {\n\tvar ba = buf_array();\n\tvar iauthor/*:Array<string>*/ = [];\n\twrite_record(ba, 0x0274 /* BrtBeginComments */);\n\n\twrite_record(ba, 0x0276 /* BrtBeginCommentAuthors */);\n\tdata.forEach(function(comment) {\n\t\tcomment[1].forEach(function(c) {\n\t\t\tif(iauthor.indexOf(c.a) > -1) return;\n\t\t\tiauthor.push(c.a.slice(0,54));\n\t\t\twrite_record(ba, 0x0278 /* BrtCommentAuthor */, write_BrtCommentAuthor(c.a));\n\t\t});\n\t});\n\twrite_record(ba, 0x0277 /* BrtEndCommentAuthors */);\n\n\twrite_record(ba, 0x0279 /* BrtBeginCommentList */);\n\tdata.forEach(function(comment) {\n\t\tcomment[1].forEach(function(c) {\n\t\t\tc.iauthor = iauthor.indexOf(c.a);\n\t\t\tvar range = {s:decode_cell(comment[0]),e:decode_cell(comment[0])};\n\t\t\twrite_record(ba, 0x027B /* BrtBeginComment */, write_BrtBeginComment([range, c]));\n\t\t\tif(c.t && c.t.length > 0) write_record(ba, 0x027D /* BrtCommentText */, write_BrtCommentText(c));\n\t\t\twrite_record(ba, 0x027C /* BrtEndComment */);\n\t\t\tdelete c.iauthor;\n\t\t});\n\t});\n\twrite_record(ba, 0x027A /* BrtEndCommentList */);\n\n\twrite_record(ba, 0x0275 /* BrtEndComments */);\n\treturn ba.end();\n}\nvar CT_VBA = \"application/vnd.ms-office.vbaProject\";\nfunction make_vba_xls(cfb) {\n  var newcfb = CFB.utils.cfb_new({ root: \"R\" });\n  cfb.FullPaths.forEach(function(p, i) {\n    if (p.slice(-1) === \"/\" || !p.match(/_VBA_PROJECT_CUR/))\n      return;\n    var newpath = p.replace(/^[^\\/]*/, \"R\").replace(/\\/_VBA_PROJECT_CUR\\u0000*/, \"\");\n    CFB.utils.cfb_add(newcfb, newpath, cfb.FileIndex[i].content);\n  });\n  return CFB.write(newcfb);\n}\nfunction fill_vba_xls(cfb, vba) {\n  vba.FullPaths.forEach(function(p, i) {\n    if (i == 0)\n      return;\n    var newpath = p.replace(/[^\\/]*[\\/]/, \"/_VBA_PROJECT_CUR/\");\n    if (newpath.slice(-1) !== \"/\")\n      CFB.utils.cfb_add(cfb, newpath, vba.FileIndex[i].content);\n  });\n}\nvar VBAFMTS = [\"xlsb\", \"xlsm\", \"xlam\", \"biff8\", \"xla\"];\n/* macro and dialog sheet stubs */\nfunction parse_ds_bin(/*::data:any, opts, idx:number, rels, wb, themes, styles*/)/*:Worksheet*/ { return {'!type':'dialog'}; }\nfunction parse_ds_xml(/*::data:any, opts, idx:number, rels, wb, themes, styles*/)/*:Worksheet*/ { return {'!type':'dialog'}; }\nfunction parse_ms_bin(/*::data:any, opts, idx:number, rels, wb, themes, styles*/)/*:Worksheet*/ { return {'!type':'macro'}; }\nfunction parse_ms_xml(/*::data:any, opts, idx:number, rels, wb, themes, styles*/)/*:Worksheet*/ { return {'!type':'macro'}; }\n/* TODO: it will be useful to parse the function str */\nvar rc_to_a1 = /*#__PURE__*/(function(){\n\tvar rcregex = /(^|[^A-Za-z_])R(\\[?-?\\d+\\]|[1-9]\\d*|)C(\\[?-?\\d+\\]|[1-9]\\d*|)(?![A-Za-z0-9_])/g;\n\tvar rcbase/*:Cell*/ = ({r:0,c:0}/*:any*/);\n\tfunction rcfunc($$,$1,$2,$3) {\n\t\tvar cRel = false, rRel = false;\n\n\t\tif($2.length == 0) rRel = true;\n\t\telse if($2.charAt(0) == \"[\") { rRel = true; $2 = $2.slice(1, -1); }\n\n\t\tif($3.length == 0) cRel = true;\n\t\telse if($3.charAt(0) == \"[\") { cRel = true; $3 = $3.slice(1, -1); }\n\n\t\tvar R = $2.length>0?parseInt($2,10)|0:0, C = $3.length>0?parseInt($3,10)|0:0;\n\n\t\tif(cRel) C += rcbase.c; else --C;\n\t\tif(rRel) R += rcbase.r; else --R;\n\t\treturn $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\n\t}\n\treturn function rc_to_a1(fstr/*:string*/, base/*:Cell*/)/*:string*/ {\n\t\trcbase = base;\n\t\treturn fstr.replace(rcregex, rcfunc);\n\t};\n})();\n\nvar crefregex = /(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\\d{4}|104[0-7]\\d{3}|1048[0-4]\\d{2}|10485[0-6]\\d|104857[0-6]|[1-9]\\d{0,5})(?![_.\\(A-Za-z0-9])/g;\nvar a1_to_rc = /*#__PURE__*/(function(){\n\treturn function a1_to_rc(fstr/*:string*/, base/*:CellAddress*/) {\n\t\treturn fstr.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\n\t\t\tvar c = decode_col($3) - ($2 ? 0 : base.c);\n\t\t\tvar r = decode_row($5) - ($4 ? 0 : base.r);\n\t\t\tvar R = (r == 0 ? \"\" : !$4 ? \"[\" + r + \"]\" : (r+1));\n\t\t\tvar C = (c == 0 ? \"\" : !$2 ? \"[\" + c + \"]\" : (c+1));\n\t\t\treturn $1 + \"R\" + R + \"C\" + C;\n\t\t});\n\t};\n})();\n\n/* no defined name can collide with a valid cell address A1:XFD1048576 ... except LOG10! */\nfunction shift_formula_str(f/*:string*/, delta/*:Cell*/)/*:string*/ {\n\treturn f.replace(crefregex, function($0, $1, $2, $3, $4, $5) {\n\t\treturn $1+($2==\"$\" ? $2+$3 : encode_col(decode_col($3)+delta.c))+($4==\"$\" ? $4+$5 : encode_row(decode_row($5) + delta.r));\n\t});\n}\n\nfunction shift_formula_xlsx(f/*:string*/, range/*:string*/, cell/*:string*/)/*:string*/ {\n\tvar r = decode_range(range), s = r.s, c = decode_cell(cell);\n\tvar delta = {r:c.r - s.r, c:c.c - s.c};\n\treturn shift_formula_str(f, delta);\n}\n\n/* TODO: parse formula */\nfunction fuzzyfmla(f/*:string*/)/*:boolean*/ {\n\tif(f.length == 1) return false;\n\treturn true;\n}\n\nfunction _xlfn(f/*:string*/)/*:string*/ {\n\treturn f.replace(/_xlfn\\./g,\"\");\n}\nfunction parseread1(blob) { blob.l+=1; return; }\n\n/* [MS-XLS] 2.5.51 */\nfunction parse_ColRelU(blob, length) {\n\tvar c = blob.read_shift(length == 1 ? 1 : 2);\n\treturn [c & 0x3FFF, (c >> 14) & 1, (c >> 15) & 1];\n}\n\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.89 */\nfunction parse_RgceArea(blob, length, opts) {\n\tvar w = 2;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);\n\t\telse if(opts.biff == 12) w = 4;\n\t}\n\tvar r=blob.read_shift(w), R=blob.read_shift(w);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n/* BIFF 2-5 encodes flags in the row field */\nfunction parse_RgceArea_BIFF2(blob/*::, length, opts*/) {\n\tvar r=parse_ColRelU(blob, 2), R=parse_ColRelU(blob, 2);\n\tvar c=blob.read_shift(1);\n\tvar C=blob.read_shift(1);\n\treturn { s:{r:r[0], c:c, cRel:r[1], rRel:r[2]}, e:{r:R[0], c:C, cRel:R[1], rRel:R[2]} };\n}\n\n/* [MS-XLS] 2.5.198.105 ; [MS-XLSB] 2.5.97.90 */\nfunction parse_RgceAreaRel(blob, length, opts) {\n\tif(opts.biff < 8) return parse_RgceArea_BIFF2(blob, length, opts);\n\tvar r=blob.read_shift(opts.biff == 12 ? 4 : 2), R=blob.read_shift(opts.biff == 12 ? 4 : 2);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n\n/* [MS-XLS] 2.5.198.109 ; [MS-XLSB] 2.5.97.91 */\nfunction parse_RgceLoc(blob, length, opts) {\n\tif(opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(opts && opts.biff == 12 ? 4 : 2);\n\tvar c = parse_ColRelU(blob, 2);\n\treturn {r:r, c:c[0], cRel:c[1], rRel:c[2]};\n}\nfunction parse_RgceLoc_BIFF2(blob/*::, length, opts*/) {\n\tvar r = parse_ColRelU(blob, 2);\n\tvar c = blob.read_shift(1);\n\treturn {r:r[0], c:c, cRel:r[1], rRel:r[2]};\n}\n\n/* [MS-XLS] 2.5.198.107, 2.5.47 */\nfunction parse_RgceElfLoc(blob/*::, length, opts*/) {\n\tvar r = blob.read_shift(2);\n\tvar c = blob.read_shift(2);\n\treturn {r:r, c:c & 0xFF, fQuoted:!!(c & 0x4000), cRel:c>>15, rRel:c>>15 };\n}\n\n/* [MS-XLS] 2.5.198.111 ; [MS-XLSB] 2.5.97.92 TODO */\nfunction parse_RgceLocRel(blob, length, opts) {\n\tvar biff = opts && opts.biff ? opts.biff : 8;\n\tif(biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(biff >= 12 ? 4 : 2);\n\tvar cl = blob.read_shift(2);\n\tvar cRel = (cl & 0x4000) >> 14, rRel = (cl & 0x8000) >> 15;\n\tcl &= 0x3FFF;\n\tif(rRel == 1) while(r > 0x7FFFF) r -= 0x100000;\n\tif(cRel == 1) while(cl > 0x1FFF) cl = cl - 0x4000;\n\treturn {r:r,c:cl,cRel:cRel,rRel:rRel};\n}\nfunction parse_RgceLocRel_BIFF2(blob/*::, length:number, opts*/) {\n\tvar rl = blob.read_shift(2);\n\tvar c = blob.read_shift(1);\n\tvar rRel = (rl & 0x8000) >> 15, cRel = (rl & 0x4000) >> 14;\n\trl &= 0x3FFF;\n\tif(rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\n\tif(cRel == 1 && c >= 0x80) c = c - 0x100;\n\treturn {r:rl,c:c,cRel:cRel,rRel:rRel};\n}\n\n/* [MS-XLS] 2.5.198.27 ; [MS-XLSB] 2.5.97.18 */\nfunction parse_PtgArea(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\n\treturn [type, area];\n}\n\n/* [MS-XLS] 2.5.198.28 ; [MS-XLSB] 2.5.97.19 */\nfunction parse_PtgArea3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2, 'i');\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t\tcase 12: w = 12; break;\n\t}\n\tvar area = parse_RgceArea(blob, w, opts);\n\treturn [type, ixti, area];\n}\n\n/* [MS-XLS] 2.5.198.29 ; [MS-XLSB] 2.5.97.20 */\nfunction parse_PtgAreaErr(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += opts && (opts.biff > 8) ? 12 : (opts.biff < 8 ? 6 : 8);\n\treturn [type];\n}\n/* [MS-XLS] 2.5.198.30 ; [MS-XLSB] 2.5.97.21 */\nfunction parse_PtgAreaErr3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t\tcase 12: w = 12; break;\n\t}\n\tblob.l += w;\n\treturn [type, ixti];\n}\n\n/* [MS-XLS] 2.5.198.31 ; [MS-XLSB] 2.5.97.22 */\nfunction parse_PtgAreaN(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceAreaRel(blob, length - 1, opts);\n\treturn [type, area];\n}\n\n/* [MS-XLS] 2.5.198.32 ; [MS-XLSB] 2.5.97.23 */\nfunction parse_PtgArray(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += opts.biff == 2 ? 6 : opts.biff == 12 ? 14 : 7;\n\treturn [type];\n}\n\n/* [MS-XLS] 2.5.198.33 ; [MS-XLSB] 2.5.97.24 */\nfunction parse_PtgAttrBaxcel(blob) {\n\tvar bitSemi = blob[blob.l+1] & 0x01; /* 1 = volatile */\n\tvar bitBaxcel = 1;\n\tblob.l += 4;\n\treturn [bitSemi, bitBaxcel];\n}\n\n/* [MS-XLS] 2.5.198.34 ; [MS-XLSB] 2.5.97.25 */\nfunction parse_PtgAttrChoose(blob, length, opts)/*:Array<number>*/ {\n\tblob.l +=2;\n\tvar offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tvar o/*:Array<number>*/ = [];\n\t/* offset is 1 less than the number of elements */\n\tfor(var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.35 ; [MS-XLSB] 2.5.97.26 */\nfunction parse_PtgAttrGoto(blob, length, opts) {\n\tvar bitGoto = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* [MS-XLS] 2.5.198.36 ; [MS-XLSB] 2.5.97.27 */\nfunction parse_PtgAttrIf(blob, length, opts) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* [MS-XLSB] 2.5.97.28 */\nfunction parse_PtgAttrIfError(blob) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(2)];\n}\n\n/* [MS-XLS] 2.5.198.37 ; [MS-XLSB] 2.5.97.29 */\nfunction parse_PtgAttrSemi(blob, length, opts) {\n\tvar bitSemi = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += opts && opts.biff == 2 ? 3 : 4;\n\treturn [bitSemi];\n}\n\n/* [MS-XLS] 2.5.198.40 ; [MS-XLSB] 2.5.97.32 */\nfunction parse_PtgAttrSpaceType(blob/*::, length*/) {\n\tvar type = blob.read_shift(1), cch = blob.read_shift(1);\n\treturn [type, cch];\n}\n\n/* [MS-XLS] 2.5.198.38 ; [MS-XLSB] 2.5.97.30 */\nfunction parse_PtgAttrSpace(blob) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* [MS-XLS] 2.5.198.39 ; [MS-XLSB] 2.5.97.31 */\nfunction parse_PtgAttrSpaceSemi(blob) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* [MS-XLS] 2.5.198.84 ; [MS-XLSB] 2.5.97.68 TODO */\nfunction parse_PtgRef(blob, length, opts) {\n\t//var ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLoc(blob, 0, opts);\n\treturn [type, loc];\n}\n\n/* [MS-XLS] 2.5.198.88 ; [MS-XLSB] 2.5.97.72 TODO */\nfunction parse_PtgRefN(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLocRel(blob, 0, opts);\n\treturn [type, loc];\n}\n\n/* [MS-XLS] 2.5.198.85 ; [MS-XLSB] 2.5.97.69 TODO */\nfunction parse_PtgRef3d(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tif(opts && opts.biff == 5) blob.l += 12;\n\tvar loc = parse_RgceLoc(blob, 0, opts); // TODO: or RgceLocRel\n\treturn [type, ixti, loc];\n}\n\n\n/* [MS-XLS] 2.5.198.62 ; [MS-XLSB] 2.5.97.45 TODO */\nfunction parse_PtgFunc(blob, length, opts) {\n\t//var ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\n\treturn [FtabArgc[iftab], Ftab[iftab], type];\n}\n/* [MS-XLS] 2.5.198.63 ; [MS-XLSB] 2.5.97.46 TODO */\nfunction parse_PtgFuncVar(blob, length, opts) {\n\tvar type = blob[blob.l++];\n\tvar cparams = blob.read_shift(1), tab = opts && opts.biff <= 3 ? [(type == 0x58 ? -1 : 0), blob.read_shift(1)]: parsetab(blob);\n\treturn [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n}\n\nfunction parsetab(blob) {\n\treturn [blob[blob.l+1]>>7, blob.read_shift(2) & 0x7FFF];\n}\n\n/* [MS-XLS] 2.5.198.41 ; [MS-XLSB] 2.5.97.33 */\nfunction parse_PtgAttrSum(blob, length, opts) {\n\tblob.l += opts && opts.biff == 2 ? 3 : 4; return;\n}\n\n/* [MS-XLS] 2.5.198.58 ; [MS-XLSB] 2.5.97.40 */\nfunction parse_PtgExp(blob, length, opts) {\n\tblob.l++;\n\tif(opts && opts.biff == 12) return [blob.read_shift(4, 'i'), 0];\n\tvar row = blob.read_shift(2);\n\tvar col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [row, col];\n}\n\n/* [MS-XLS] 2.5.198.57 ; [MS-XLSB] 2.5.97.39 */\nfunction parse_PtgErr(blob) { blob.l++; return BErr[blob.read_shift(1)]; }\n\n/* [MS-XLS] 2.5.198.66 ; [MS-XLSB] 2.5.97.49 */\nfunction parse_PtgInt(blob) { blob.l++; return blob.read_shift(2); }\n\n/* [MS-XLS] 2.5.198.42 ; [MS-XLSB] 2.5.97.34 */\nfunction parse_PtgBool(blob) { blob.l++; return blob.read_shift(1)!==0;}\n\n/* [MS-XLS] 2.5.198.79 ; [MS-XLSB] 2.5.97.63 */\nfunction parse_PtgNum(blob) { blob.l++; return parse_Xnum(blob, 8); }\n\n/* [MS-XLS] 2.5.198.89 ; [MS-XLSB] 2.5.97.74 */\nfunction parse_PtgStr(blob, length, opts) { blob.l++; return parse_ShortXLUnicodeString(blob, length-1, opts); }\n\n/* [MS-XLS] 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n/* [MS-XLSB] 2.5.97.93 + 2.5.97.9{4,5,6,7} */\nfunction parse_SerAr(blob, biff/*:number*/) {\n\tvar val = [blob.read_shift(1)];\n\tif(biff == 12) switch(val[0]) {\n\t\tcase 0x02: val[0] = 0x04; break; /* SerBool */\n\t\tcase 0x04: val[0] = 0x10; break; /* SerErr */\n\t\tcase 0x00: val[0] = 0x01; break; /* SerNum */\n\t\tcase 0x01: val[0] = 0x02; break; /* SerStr */\n\t}\n\tswitch(val[0]) {\n\t\tcase 0x04: /* SerBool -- boolean */\n\t\t\tval[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n\t\t\tif(biff != 12) blob.l += 7; break;\n\t\tcase 0x25: /* appears to be an alias */\n\t\tcase 0x10: /* SerErr -- error */\n\t\t\tval[1] = BErr[blob[blob.l]];\n\t\t\tblob.l += ((biff == 12) ? 4 : 8); break;\n\t\tcase 0x00: /* SerNil -- honestly, I'm not sure how to reproduce this */\n\t\t\tblob.l += 8; break;\n\t\tcase 0x01: /* SerNum -- Xnum */\n\t\t\tval[1] = parse_Xnum(blob, 8); break;\n\t\tcase 0x02: /* SerStr -- XLUnicodeString (<256 chars) */\n\t\t\tval[1] = parse_XLUnicodeString2(blob, 0, {biff:biff > 0 && biff < 8 ? 2 : biff}); break;\n\t\tdefault: throw new Error(\"Bad SerAr: \" + val[0]); /* Unreachable */\n\t}\n\treturn val;\n}\n\n/* [MS-XLS] 2.5.198.61 ; [MS-XLSB] 2.5.97.44 */\nfunction parse_PtgExtraMem(blob, cce, opts) {\n\tvar count = blob.read_shift((opts.biff == 12) ? 4 : 2);\n\tvar out/*:Array<Range>*/ = [];\n\tfor(var i = 0; i != count; ++i) out.push(((opts.biff == 12) ? parse_UncheckedRfX : parse_Ref8U)(blob, 8));\n\treturn out;\n}\n\n/* [MS-XLS] 2.5.198.59 ; [MS-XLSB] 2.5.97.41 */\nfunction parse_PtgExtraArray(blob, length, opts) {\n\tvar rows = 0, cols = 0;\n\tif(opts.biff == 12) {\n\t\trows = blob.read_shift(4); // DRw\n\t\tcols = blob.read_shift(4); // DCol\n\t} else {\n\t\tcols = 1 + blob.read_shift(1); //DColByteU\n\t\trows = 1 + blob.read_shift(2); //DRw\n\t}\n\tif(opts.biff >= 2 && opts.biff < 8) { --rows; if(--cols == 0) cols = 0x100; }\n\t// $FlowIgnore\n\tfor(var i = 0, o/*:Array<Array<any>>*/ = []; i != rows && (o[i] = []); ++i)\n\t\tfor(var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 */\nfunction parse_PtgName(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar w = (!opts || (opts.biff >= 8)) ? 4 : 2;\n\tvar nameindex = blob.read_shift(w);\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l += 5; break;\n\t\tcase 3: case 4: blob.l += 8; break;\n\t\tcase 5: blob.l += 12; break;\n\t}\n\treturn [type, 0, nameindex];\n}\n\n/* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 */\nfunction parse_PtgNameX(blob, length, opts) {\n\tif(opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tvar nameindex = blob.read_shift(4);\n\treturn [type, ixti, nameindex];\n}\nfunction parse_PtgNameX_BIFF5(blob/*::, length, opts*/) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2, 'i'); // XtiIndex\n\tblob.l += 8;\n\tvar nameindex = blob.read_shift(2);\n\tblob.l += 12;\n\treturn [type, ixti, nameindex];\n}\n\n/* [MS-XLS] 2.5.198.70 ; [MS-XLSB] 2.5.97.54 */\nfunction parse_PtgMemArea(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += (opts && opts.biff == 2 ? 3 : 4);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n/* [MS-XLS] 2.5.198.72 ; [MS-XLSB] 2.5.97.56 */\nfunction parse_PtgMemFunc(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n\n/* [MS-XLS] 2.5.198.86 ; [MS-XLSB] 2.5.97.69 */\nfunction parse_PtgRefErr(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += 4;\n\tif(opts.biff < 8) blob.l--;\n\tif(opts.biff == 12) blob.l += 2;\n\treturn [type];\n}\n\n/* [MS-XLS] 2.5.198.87 ; [MS-XLSB] 2.5.97.71 */\nfunction parse_PtgRefErr3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar w = 4;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: w = 15; break;\n\t\tcase 12: w = 6; break;\n\t}\n\tblob.l += w;\n\treturn [type, ixti];\n}\n\n/* [MS-XLS] 2.5.198.71 ; [MS-XLSB] 2.5.97.55 */\nvar parse_PtgMemErr = parsenoop;\n/* [MS-XLS] 2.5.198.73  ; [MS-XLSB] 2.5.97.57 */\nvar parse_PtgMemNoMem = parsenoop;\n/* [MS-XLS] 2.5.198.92 */\nvar parse_PtgTbl = parsenoop;\n\nfunction parse_PtgElfLoc(blob, length, opts) {\n\tblob.l += 2;\n\treturn [parse_RgceElfLoc(blob, 4, opts)];\n}\nfunction parse_PtgElfNoop(blob/*::, length, opts*/) {\n\tblob.l += 6;\n\treturn [];\n}\n/* [MS-XLS] 2.5.198.46 */\nvar parse_PtgElfCol = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.47 */\nvar parse_PtgElfColS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.48 */\nvar parse_PtgElfColSV = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.49 */\nvar parse_PtgElfColV = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.50 */\nfunction parse_PtgElfLel(blob/*::, length, opts*/) {\n\tblob.l += 2;\n\treturn [parseuint16(blob), blob.read_shift(2) & 0x01];\n}\n/* [MS-XLS] 2.5.198.51 */\nvar parse_PtgElfRadical = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.52 */\nvar parse_PtgElfRadicalLel = parse_PtgElfLel;\n/* [MS-XLS] 2.5.198.53 */\nvar parse_PtgElfRadicalS = parse_PtgElfNoop;\n/* [MS-XLS] 2.5.198.54 */\nvar parse_PtgElfRw = parse_PtgElfLoc;\n/* [MS-XLS] 2.5.198.55 */\nvar parse_PtgElfRwV = parse_PtgElfLoc;\n\n/* [MS-XLSB] 2.5.97.52 TODO */\nvar PtgListRT = [\n\t\"Data\",\n\t\"All\",\n\t\"Headers\",\n\t\"??\",\n\t\"?Data2\",\n\t\"??\",\n\t\"?DataHeaders\",\n\t\"??\",\n\t\"Totals\",\n\t\"??\",\n\t\"??\",\n\t\"??\",\n\t\"?DataTotals\",\n\t\"??\",\n\t\"??\",\n\t\"??\",\n\t\"?Current\"\n];\nfunction parse_PtgList(blob/*::, length, opts*/) {\n\tblob.l += 2;\n\tvar ixti = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tvar idx = blob.read_shift(4);\n\tvar c = blob.read_shift(2);\n\tvar C = blob.read_shift(2);\n\tvar rt = PtgListRT[(flags >> 2) & 0x1F];\n\treturn {ixti: ixti, coltype:(flags&0x3), rt:rt, idx:idx, c:c, C:C};\n}\n/* [MS-XLS] 2.5.198.91 ; [MS-XLSB] 2.5.97.76 */\nfunction parse_PtgSxName(blob/*::, length, opts*/) {\n\tblob.l += 2;\n\treturn [blob.read_shift(4)];\n}\n\n/* [XLS] old spec */\nfunction parse_PtgSheet(blob, length, opts) {\n\tblob.l += 5;\n\tblob.l += 2;\n\tblob.l += (opts.biff == 2 ? 1 : 4);\n\treturn [\"PTGSHEET\"];\n}\nfunction parse_PtgEndSheet(blob, length, opts) {\n\tblob.l += (opts.biff == 2 ? 4 : 5);\n\treturn [\"PTGENDSHEET\"];\n}\nfunction parse_PtgMemAreaN(blob/*::, length, opts*/) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\nfunction parse_PtgMemNoMemN(blob/*::, length, opts*/) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(2);\n\treturn [type, cce];\n}\nfunction parse_PtgAttrNoop(blob/*::, length, opts*/) {\n\tblob.l += 4;\n\treturn [0, 0];\n}\n\n/* [MS-XLS] 2.5.198.25 ; [MS-XLSB] 2.5.97.16 */\nvar PtgTypes = {\n\t/*::[*/0x01/*::]*/: { n:'PtgExp', f:parse_PtgExp },\n\t/*::[*/0x02/*::]*/: { n:'PtgTbl', f:parse_PtgTbl },\n\t/*::[*/0x03/*::]*/: { n:'PtgAdd', f:parseread1 },\n\t/*::[*/0x04/*::]*/: { n:'PtgSub', f:parseread1 },\n\t/*::[*/0x05/*::]*/: { n:'PtgMul', f:parseread1 },\n\t/*::[*/0x06/*::]*/: { n:'PtgDiv', f:parseread1 },\n\t/*::[*/0x07/*::]*/: { n:'PtgPower', f:parseread1 },\n\t/*::[*/0x08/*::]*/: { n:'PtgConcat', f:parseread1 },\n\t/*::[*/0x09/*::]*/: { n:'PtgLt', f:parseread1 },\n\t/*::[*/0x0A/*::]*/: { n:'PtgLe', f:parseread1 },\n\t/*::[*/0x0B/*::]*/: { n:'PtgEq', f:parseread1 },\n\t/*::[*/0x0C/*::]*/: { n:'PtgGe', f:parseread1 },\n\t/*::[*/0x0D/*::]*/: { n:'PtgGt', f:parseread1 },\n\t/*::[*/0x0E/*::]*/: { n:'PtgNe', f:parseread1 },\n\t/*::[*/0x0F/*::]*/: { n:'PtgIsect', f:parseread1 },\n\t/*::[*/0x10/*::]*/: { n:'PtgUnion', f:parseread1 },\n\t/*::[*/0x11/*::]*/: { n:'PtgRange', f:parseread1 },\n\t/*::[*/0x12/*::]*/: { n:'PtgUplus', f:parseread1 },\n\t/*::[*/0x13/*::]*/: { n:'PtgUminus', f:parseread1 },\n\t/*::[*/0x14/*::]*/: { n:'PtgPercent', f:parseread1 },\n\t/*::[*/0x15/*::]*/: { n:'PtgParen', f:parseread1 },\n\t/*::[*/0x16/*::]*/: { n:'PtgMissArg', f:parseread1 },\n\t/*::[*/0x17/*::]*/: { n:'PtgStr', f:parse_PtgStr },\n\t/*::[*/0x1A/*::]*/: { n:'PtgSheet', f:parse_PtgSheet },\n\t/*::[*/0x1B/*::]*/: { n:'PtgEndSheet', f:parse_PtgEndSheet },\n\t/*::[*/0x1C/*::]*/: { n:'PtgErr', f:parse_PtgErr },\n\t/*::[*/0x1D/*::]*/: { n:'PtgBool', f:parse_PtgBool },\n\t/*::[*/0x1E/*::]*/: { n:'PtgInt', f:parse_PtgInt },\n\t/*::[*/0x1F/*::]*/: { n:'PtgNum', f:parse_PtgNum },\n\t/*::[*/0x20/*::]*/: { n:'PtgArray', f:parse_PtgArray },\n\t/*::[*/0x21/*::]*/: { n:'PtgFunc', f:parse_PtgFunc },\n\t/*::[*/0x22/*::]*/: { n:'PtgFuncVar', f:parse_PtgFuncVar },\n\t/*::[*/0x23/*::]*/: { n:'PtgName', f:parse_PtgName },\n\t/*::[*/0x24/*::]*/: { n:'PtgRef', f:parse_PtgRef },\n\t/*::[*/0x25/*::]*/: { n:'PtgArea', f:parse_PtgArea },\n\t/*::[*/0x26/*::]*/: { n:'PtgMemArea', f:parse_PtgMemArea },\n\t/*::[*/0x27/*::]*/: { n:'PtgMemErr', f:parse_PtgMemErr },\n\t/*::[*/0x28/*::]*/: { n:'PtgMemNoMem', f:parse_PtgMemNoMem },\n\t/*::[*/0x29/*::]*/: { n:'PtgMemFunc', f:parse_PtgMemFunc },\n\t/*::[*/0x2A/*::]*/: { n:'PtgRefErr', f:parse_PtgRefErr },\n\t/*::[*/0x2B/*::]*/: { n:'PtgAreaErr', f:parse_PtgAreaErr },\n\t/*::[*/0x2C/*::]*/: { n:'PtgRefN', f:parse_PtgRefN },\n\t/*::[*/0x2D/*::]*/: { n:'PtgAreaN', f:parse_PtgAreaN },\n\t/*::[*/0x2E/*::]*/: { n:'PtgMemAreaN', f:parse_PtgMemAreaN },\n\t/*::[*/0x2F/*::]*/: { n:'PtgMemNoMemN', f:parse_PtgMemNoMemN },\n\t/*::[*/0x39/*::]*/: { n:'PtgNameX', f:parse_PtgNameX },\n\t/*::[*/0x3A/*::]*/: { n:'PtgRef3d', f:parse_PtgRef3d },\n\t/*::[*/0x3B/*::]*/: { n:'PtgArea3d', f:parse_PtgArea3d },\n\t/*::[*/0x3C/*::]*/: { n:'PtgRefErr3d', f:parse_PtgRefErr3d },\n\t/*::[*/0x3D/*::]*/: { n:'PtgAreaErr3d', f:parse_PtgAreaErr3d },\n\t/*::[*/0xFF/*::]*/: {}\n};\n/* These are duplicated in the PtgTypes table */\nvar PtgDupes = {\n\t/*::[*/0x40/*::]*/: 0x20, /*::[*/0x60/*::]*/: 0x20,\n\t/*::[*/0x41/*::]*/: 0x21, /*::[*/0x61/*::]*/: 0x21,\n\t/*::[*/0x42/*::]*/: 0x22, /*::[*/0x62/*::]*/: 0x22,\n\t/*::[*/0x43/*::]*/: 0x23, /*::[*/0x63/*::]*/: 0x23,\n\t/*::[*/0x44/*::]*/: 0x24, /*::[*/0x64/*::]*/: 0x24,\n\t/*::[*/0x45/*::]*/: 0x25, /*::[*/0x65/*::]*/: 0x25,\n\t/*::[*/0x46/*::]*/: 0x26, /*::[*/0x66/*::]*/: 0x26,\n\t/*::[*/0x47/*::]*/: 0x27, /*::[*/0x67/*::]*/: 0x27,\n\t/*::[*/0x48/*::]*/: 0x28, /*::[*/0x68/*::]*/: 0x28,\n\t/*::[*/0x49/*::]*/: 0x29, /*::[*/0x69/*::]*/: 0x29,\n\t/*::[*/0x4A/*::]*/: 0x2A, /*::[*/0x6A/*::]*/: 0x2A,\n\t/*::[*/0x4B/*::]*/: 0x2B, /*::[*/0x6B/*::]*/: 0x2B,\n\t/*::[*/0x4C/*::]*/: 0x2C, /*::[*/0x6C/*::]*/: 0x2C,\n\t/*::[*/0x4D/*::]*/: 0x2D, /*::[*/0x6D/*::]*/: 0x2D,\n\t/*::[*/0x4E/*::]*/: 0x2E, /*::[*/0x6E/*::]*/: 0x2E,\n\t/*::[*/0x4F/*::]*/: 0x2F, /*::[*/0x6F/*::]*/: 0x2F,\n\t/*::[*/0x58/*::]*/: 0x22, /*::[*/0x78/*::]*/: 0x22,\n\t/*::[*/0x59/*::]*/: 0x39, /*::[*/0x79/*::]*/: 0x39,\n\t/*::[*/0x5A/*::]*/: 0x3A, /*::[*/0x7A/*::]*/: 0x3A,\n\t/*::[*/0x5B/*::]*/: 0x3B, /*::[*/0x7B/*::]*/: 0x3B,\n\t/*::[*/0x5C/*::]*/: 0x3C, /*::[*/0x7C/*::]*/: 0x3C,\n\t/*::[*/0x5D/*::]*/: 0x3D, /*::[*/0x7D/*::]*/: 0x3D\n};\n\nvar Ptg18 = {\n\t/*::[*/0x01/*::]*/: { n:'PtgElfLel', f:parse_PtgElfLel },\n\t/*::[*/0x02/*::]*/: { n:'PtgElfRw', f:parse_PtgElfRw },\n\t/*::[*/0x03/*::]*/: { n:'PtgElfCol', f:parse_PtgElfCol },\n\t/*::[*/0x06/*::]*/: { n:'PtgElfRwV', f:parse_PtgElfRwV },\n\t/*::[*/0x07/*::]*/: { n:'PtgElfColV', f:parse_PtgElfColV },\n\t/*::[*/0x0A/*::]*/: { n:'PtgElfRadical', f:parse_PtgElfRadical },\n\t/*::[*/0x0B/*::]*/: { n:'PtgElfRadicalS', f:parse_PtgElfRadicalS },\n\t/*::[*/0x0D/*::]*/: { n:'PtgElfColS', f:parse_PtgElfColS },\n\t/*::[*/0x0F/*::]*/: { n:'PtgElfColSV', f:parse_PtgElfColSV },\n\t/*::[*/0x10/*::]*/: { n:'PtgElfRadicalLel', f:parse_PtgElfRadicalLel },\n\t/*::[*/0x19/*::]*/: { n:'PtgList', f:parse_PtgList },\n\t/*::[*/0x1D/*::]*/: { n:'PtgSxName', f:parse_PtgSxName },\n\t/*::[*/0xFF/*::]*/: {}\n};\nvar Ptg19 = {\n\t/*::[*/0x00/*::]*/: { n:'PtgAttrNoop', f:parse_PtgAttrNoop },\n\t/*::[*/0x01/*::]*/: { n:'PtgAttrSemi', f:parse_PtgAttrSemi },\n\t/*::[*/0x02/*::]*/: { n:'PtgAttrIf', f:parse_PtgAttrIf },\n\t/*::[*/0x04/*::]*/: { n:'PtgAttrChoose', f:parse_PtgAttrChoose },\n\t/*::[*/0x08/*::]*/: { n:'PtgAttrGoto', f:parse_PtgAttrGoto },\n\t/*::[*/0x10/*::]*/: { n:'PtgAttrSum', f:parse_PtgAttrSum },\n\t/*::[*/0x20/*::]*/: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n\t/*::[*/0x21/*::]*/: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n\t/*::[*/0x40/*::]*/: { n:'PtgAttrSpace', f:parse_PtgAttrSpace },\n\t/*::[*/0x41/*::]*/: { n:'PtgAttrSpaceSemi', f:parse_PtgAttrSpaceSemi },\n\t/*::[*/0x80/*::]*/: { n:'PtgAttrIfError', f:parse_PtgAttrIfError },\n\t/*::[*/0xFF/*::]*/: {}\n};\n\n/* [MS-XLS] 2.5.198.103 ; [MS-XLSB] 2.5.97.87 */\nfunction parse_RgbExtra(blob, length, rgce, opts) {\n\tif(opts.biff < 8) return parsenoop(blob, length);\n\tvar target = blob.l + length;\n\tvar o = [];\n\tfor(var i = 0; i !== rgce.length; ++i) {\n\t\tswitch(rgce[i][0]) {\n\t\t\tcase 'PtgArray': /* PtgArray -> PtgExtraArray */\n\t\t\t\trgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\n\t\t\t\to.push(rgce[i][1]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemArea': /* PtgMemArea -> PtgExtraMem */\n\t\t\t\trgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1], opts);\n\t\t\t\to.push(rgce[i][2]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgExp': /* PtgExp -> PtgExtraCol */\n\t\t\t\tif(opts && opts.biff == 12) {\n\t\t\t\t\trgce[i][1][1] = blob.read_shift(4);\n\t\t\t\t\to.push(rgce[i][1]);\n\t\t\t\t} break;\n\t\t\tcase 'PtgList': /* TODO: PtgList -> PtgExtraList */\n\t\t\tcase 'PtgElfRadicalS': /* TODO: PtgElfRadicalS -> PtgExtraElf */\n\t\t\tcase 'PtgElfColS': /* TODO: PtgElfColS -> PtgExtraElf */\n\t\t\tcase 'PtgElfColSV': /* TODO: PtgElfColSV -> PtgExtraElf */\n\t\t\t\tthrow \"Unsupported \" + rgce[i][0];\n\t\t\tdefault: break;\n\t\t}\n\t}\n\tlength = target - blob.l;\n\t/* note: this is technically an error but Excel disregards */\n\t//if(target !== blob.l && blob.l !== target - length) throw new Error(target + \" != \" + blob.l);\n\tif(length !== 0) o.push(parsenoop(blob, length));\n\treturn o;\n}\n\n/* [MS-XLS] 2.5.198.104 ; [MS-XLSB] 2.5.97.88 */\nfunction parse_Rgce(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar R, id, ptgs = [];\n\twhile(target != blob.l) {\n\t\tlength = target - blob.l;\n\t\tid = blob[blob.l];\n\t\tR = PtgTypes[id] || PtgTypes[PtgDupes[id]];\n\t\tif(id === 0x18 || id === 0x19) R = (id === 0x18 ? Ptg18 : Ptg19)[blob[blob.l + 1]];\n\t\tif(!R || !R.f) { /*ptgs.push*/(parsenoop(blob, length)); }\n\t\telse { ptgs.push([R.n, R.f(blob, length, opts)]); }\n\t}\n\treturn ptgs;\n}\n\nfunction stringify_array(f/*:Array<Array<string>>*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\tfor(var i = 0; i < f.length; ++i) {\n\t\tvar x = f[i], r/*:Array<string>*/ = [];\n\t\tfor(var j = 0; j < x.length; ++j) {\n\t\t\tvar y = x[j];\n\t\t\tif(y) switch(y[0]) {\n\t\t\t\t// TODO: handle embedded quotes\n\t\t\t\tcase 0x02:\n\t\t\t\t\t/*:: if(typeof y[1] != 'string') throw \"unreachable\"; */\n\t\t\t\t\tr.push('\"' + y[1].replace(/\"/g,'\"\"') + '\"'); break;\n\t\t\t\tdefault: r.push(y[1]);\n\t\t\t} else r.push(\"\");\n\t\t}\n\t\to.push(r.join(\",\"));\n\t}\n\treturn o.join(\";\");\n}\n\n/* [MS-XLS] 2.2.2 ; [MS-XLSB] 2.2.2 TODO */\nvar PtgBinOp = {\n\tPtgAdd: \"+\",\n\tPtgConcat: \"&\",\n\tPtgDiv: \"/\",\n\tPtgEq: \"=\",\n\tPtgGe: \">=\",\n\tPtgGt: \">\",\n\tPtgLe: \"<=\",\n\tPtgLt: \"<\",\n\tPtgMul: \"*\",\n\tPtgNe: \"<>\",\n\tPtgPower: \"^\",\n\tPtgSub: \"-\"\n};\n\n// List of invalid characters needs to be tested further\nfunction formula_quote_sheet_name(sname/*:string*/, opts)/*:string*/ {\n\tif(!sname && !(opts && opts.biff <= 5 && opts.biff >= 2)) throw new Error(\"empty sheet name\");\n\tif (/[^\\w\\u4E00-\\u9FFF\\u3040-\\u30FF]/.test(sname)) return \"'\" + sname + \"'\";\n\treturn sname;\n}\nfunction get_ixti_raw(supbooks, ixti/*:number*/, opts)/*:string*/ {\n\tif(!supbooks) return \"SH33TJSERR0\";\n\tif(opts.biff > 8 && (!supbooks.XTI || !supbooks.XTI[ixti])) return supbooks.SheetNames[ixti];\n\tif(!supbooks.XTI) return \"SH33TJSERR6\";\n\tvar XTI = supbooks.XTI[ixti];\n\tif(opts.biff < 8) {\n\t\tif(ixti > 10000) ixti-= 65536;\n\t\tif(ixti < 0) ixti = -ixti;\n\t\treturn ixti == 0 ? \"\" : supbooks.XTI[ixti - 1];\n\t}\n\tif(!XTI) return \"SH33TJSERR1\";\n\tvar o = \"\";\n\tif(opts.biff > 8) switch(supbooks[XTI[0]][0]) {\n\t\tcase 0x0165: /* 'BrtSupSelf' */\n\t\t\to = XTI[1] == -1 ? \"#REF\" : supbooks.SheetNames[XTI[1]];\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\t\tcase 0x0166: /* 'BrtSupSame' */\n\t\t\tif(opts.SID != null) return supbooks.SheetNames[opts.SID];\n\t\t\treturn \"SH33TJSSAME\" + supbooks[XTI[0]][0];\n\t\tcase 0x0163: /* 'BrtSupBookSrc' */\n\t\t\t/* falls through */\n\t\tdefault: return \"SH33TJSSRC\" + supbooks[XTI[0]][0];\n\t}\n\tswitch(supbooks[XTI[0]][0][0]) {\n\t\tcase 0x0401:\n\t\t\to = XTI[1] == -1 ? \"#REF\" : (supbooks.SheetNames[XTI[1]] || \"SH33TJSERR3\");\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks.SheetNames[XTI[2]];\n\t\tcase 0x3A01: return supbooks[XTI[0]].slice(1).map(function(name) { return name.Name; }).join(\";;\"); //return \"SH33TJSERR8\";\n\t\tdefault:\n\t\t\tif(!supbooks[XTI[0]][0][3]) return \"SH33TJSERR2\";\n\t\t\to = XTI[1] == -1 ? \"#REF\" : (supbooks[XTI[0]][0][3][XTI[1]] || \"SH33TJSERR4\");\n\t\t\treturn XTI[1] == XTI[2] ? o : o + \":\" + supbooks[XTI[0]][0][3][XTI[2]];\n\t}\n}\nfunction get_ixti(supbooks, ixti/*:number*/, opts)/*:string*/ {\n\tvar ixtiraw = get_ixti_raw(supbooks, ixti, opts);\n\treturn ixtiraw == \"#REF\" ? ixtiraw : formula_quote_sheet_name(ixtiraw, opts);\n}\nfunction stringify_formula(formula/*Array<any>*/, range, cell/*:any*/, supbooks, opts)/*:string*/ {\n\tvar biff = (opts && opts.biff) || 8;\n\tvar _range = /*range != null ? range :*/ {s:{c:0, r:0},e:{c:0, r:0}};\n\tvar stack/*:Array<string>*/ = [], e1, e2, /*::type,*/ c/*:CellAddress*/, ixti=0, nameidx=0, r, sname=\"\";\n\tif(!formula[0] || !formula[0][0]) return \"\";\n\tvar last_sp = -1, sp = \"\";\n\tfor(var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n\t\tvar f = formula[0][ff];\n\t\tswitch(f[0]) {\n\t\t\tcase 'PtgUminus': /* [MS-XLS] 2.5.198.93 */\n\t\t\t\tstack.push(\"-\" + stack.pop()); break;\n\t\t\tcase 'PtgUplus': /* [MS-XLS] 2.5.198.95 */\n\t\t\t\tstack.push(\"+\" + stack.pop()); break;\n\t\t\tcase 'PtgPercent': /* [MS-XLS] 2.5.198.81 */\n\t\t\t\tstack.push(stack.pop() + \"%\"); break;\n\n\t\t\tcase 'PtgAdd':    /* [MS-XLS] 2.5.198.26 */\n\t\t\tcase 'PtgConcat': /* [MS-XLS] 2.5.198.43 */\n\t\t\tcase 'PtgDiv':    /* [MS-XLS] 2.5.198.45 */\n\t\t\tcase 'PtgEq':     /* [MS-XLS] 2.5.198.56 */\n\t\t\tcase 'PtgGe':     /* [MS-XLS] 2.5.198.64 */\n\t\t\tcase 'PtgGt':     /* [MS-XLS] 2.5.198.65 */\n\t\t\tcase 'PtgLe':     /* [MS-XLS] 2.5.198.68 */\n\t\t\tcase 'PtgLt':     /* [MS-XLS] 2.5.198.69 */\n\t\t\tcase 'PtgMul':    /* [MS-XLS] 2.5.198.75 */\n\t\t\tcase 'PtgNe':     /* [MS-XLS] 2.5.198.78 */\n\t\t\tcase 'PtgPower':  /* [MS-XLS] 2.5.198.82 */\n\t\t\tcase 'PtgSub':    /* [MS-XLS] 2.5.198.90 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tsp = fill(\" \", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tsp = fill(\"\\r\", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tsp = \"\";\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\te2 = e2 + sp;\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(e2+PtgBinOp[f[0]]+e1);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgIsect': /* [MS-XLS] 2.5.198.67 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\" \"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgUnion': /* [MS-XLS] 2.5.198.94 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\",\"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRange': /* [MS-XLS] 2.5.198.83 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\":\"+e1);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrChoose': /* [MS-XLS] 2.5.198.34 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrGoto': /* [MS-XLS] 2.5.198.35 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrIf': /* [MS-XLS] 2.5.198.36 */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrIfError': /* [MS-XLSB] 2.5.97.28 */\n\t\t\t\tbreak;\n\n\n\t\t\tcase 'PtgRef': /* [MS-XLS] 2.5.198.84 */\n\t\t\t\t/*::type = f[1][0]; */c = shift_cell_xls((f[1][1]/*:any*/), _range, opts);\n\t\t\t\tstack.push(encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRefN': /* [MS-XLS] 2.5.198.88 */\n\t\t\t\t/*::type = f[1][0]; */c = cell ? shift_cell_xls((f[1][1]/*:any*/), cell, opts) : (f[1][1]/*:any*/);\n\t\t\t\tstack.push(encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRef3d': /* [MS-XLS] 2.5.198.85 */\n\t\t\t\t/*::type = f[1][0]; */ixti = /*::Number(*/f[1][1]/*::)*/; c = shift_cell_xls((f[1][2]/*:any*/), _range, opts);\n\t\t\t\tsname = get_ixti(supbooks, ixti, opts);\n\t\t\t\tvar w = sname; /* IE9 fails on defined names */ // eslint-disable-line no-unused-vars\n\t\t\t\tstack.push(sname + \"!\" + encode_cell_xls(c, biff));\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgFunc': /* [MS-XLS] 2.5.198.62 */\n\t\t\tcase 'PtgFuncVar': /* [MS-XLS] 2.5.198.63 */\n\t\t\t\t/* f[1] = [argc, func, type] */\n\t\t\t\tvar argc/*:number*/ = (f[1][0]/*:any*/), func/*:string*/ = (f[1][1]/*:any*/);\n\t\t\t\tif(!argc) argc = 0;\n\t\t\t\targc &= 0x7F;\n\t\t\t\tvar args = argc == 0 ? [] : stack.slice(-argc);\n\t\t\t\tstack.length -= argc;\n\t\t\t\tif(func === 'User') func = args.shift();\n\t\t\t\tstack.push(func + \"(\" + args.join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgBool': /* [MS-XLS] 2.5.198.42 */\n\t\t\t\tstack.push(f[1] ? \"TRUE\" : \"FALSE\"); break;\n\t\t\tcase 'PtgInt': /* [MS-XLS] 2.5.198.66 */\n\t\t\t\tstack.push(/*::String(*/f[1]/*::)*/); break;\n\t\t\tcase 'PtgNum': /* [MS-XLS] 2.5.198.79 TODO: precision? */\n\t\t\t\tstack.push(String(f[1])); break;\n\t\t\tcase 'PtgStr': /* [MS-XLS] 2.5.198.89 */\n\t\t\t\t// $FlowIgnore\n\t\t\t\tstack.push('\"' + f[1].replace(/\"/g, '\"\"') + '\"'); break;\n\t\t\tcase 'PtgErr': /* [MS-XLS] 2.5.198.57 */\n\t\t\t\tstack.push(/*::String(*/f[1]/*::)*/); break;\n\t\t\tcase 'PtgAreaN': /* [MS-XLS] 2.5.198.31 TODO */\n\t\t\t\t/*::type = f[1][0]; */r = shift_range_xls(f[1][1], cell ? {s:cell} : _range, opts);\n\t\t\t\tstack.push(encode_range_xls((r/*:any*/), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgArea': /* [MS-XLS] 2.5.198.27 TODO: fixed points */\n\t\t\t\t/*::type = f[1][0]; */r = shift_range_xls(f[1][1], _range, opts);\n\t\t\t\tstack.push(encode_range_xls((r/*:any*/), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgArea3d': /* [MS-XLS] 2.5.198.28 TODO */\n\t\t\t\t/*::type = f[1][0]; */ixti = /*::Number(*/f[1][1]/*::)*/; r = f[1][2];\n\t\t\t\tsname = get_ixti(supbooks, ixti, opts);\n\t\t\t\tstack.push(sname + \"!\" + encode_range_xls((r/*:any*/), opts));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgAttrSum': /* [MS-XLS] 2.5.198.41 */\n\t\t\t\tstack.push(\"SUM(\" + stack.pop() + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrBaxcel': /* [MS-XLS] 2.5.198.33 */\n\t\t\tcase 'PtgAttrSemi': /* [MS-XLS] 2.5.198.37 */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgName': /* [MS-XLS] 2.5.198.76 ; [MS-XLSB] 2.5.97.60 TODO: revisions */\n\t\t\t\t/* f[1] = type, 0, nameindex */\n\t\t\t\tnameidx = (f[1][2]/*:any*/);\n\t\t\t\tvar lbl = (supbooks.names||[])[nameidx-1] || (supbooks[0]||[])[nameidx];\n\t\t\t\tvar name = lbl ? lbl.Name : \"SH33TJSNAME\" + String(nameidx);\n\t\t\t\t/* [MS-XLSB] 2.5.97.10 Ftab -- last verified 20220204 */\n\t\t\t\tif(name && name.slice(0,6) == \"_xlfn.\" && !opts.xlfn) name = name.slice(6);\n\t\t\t\tstack.push(name);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgNameX': /* [MS-XLS] 2.5.198.77 ; [MS-XLSB] 2.5.97.61 TODO: revisions */\n\t\t\t\t/* f[1] = type, ixti, nameindex */\n\t\t\t\tvar bookidx/*:number*/ = (f[1][1]/*:any*/); nameidx = (f[1][2]/*:any*/); var externbook;\n\t\t\t\t/* TODO: Properly handle missing values -- this should be using get_ixti_raw primarily */\n\t\t\t\tif(opts.biff <= 5) {\n\t\t\t\t\tif(bookidx < 0) bookidx = -bookidx;\n\t\t\t\t\tif(supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\n\t\t\t\t} else {\n\t\t\t\t\tvar o = \"\";\n\t\t\t\t\tif(((supbooks[bookidx]||[])[0]||[])[0] == 0x3A01){/* empty */}\n\t\t\t\t\telse if(((supbooks[bookidx]||[])[0]||[])[0] == 0x0401){\n\t\t\t\t\t\tif(supbooks[bookidx][nameidx] && supbooks[bookidx][nameidx].itab > 0) {\n\t\t\t\t\t\t\to = supbooks.SheetNames[supbooks[bookidx][nameidx].itab-1] + \"!\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse o = supbooks.SheetNames[nameidx-1]+ \"!\";\n\t\t\t\t\tif(supbooks[bookidx] && supbooks[bookidx][nameidx]) o += supbooks[bookidx][nameidx].Name;\n\t\t\t\t\telse if(supbooks[0] && supbooks[0][nameidx]) o += supbooks[0][nameidx].Name;\n\t\t\t\t\telse {\n\t\t\t\t\t\tvar ixtidata = (get_ixti_raw(supbooks, bookidx, opts)||\"\").split(\";;\");\n\t\t\t\t\t\tif(ixtidata[nameidx - 1]) o = ixtidata[nameidx - 1]; // TODO: confirm this is correct\n\t\t\t\t\t\telse o += \"SH33TJSERRX\";\n\t\t\t\t\t}\n\t\t\t\t\tstack.push(o);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!externbook) externbook = {Name: \"SH33TJSERRY\"};\n\t\t\t\tstack.push(externbook.Name);\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgParen': /* [MS-XLS] 2.5.198.80 */\n\t\t\t\tvar lp = '(', rp = ')';\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 2: lp = fill(\" \", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 3: lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 4: rp = fill(\" \", formula[0][last_sp][1][1]) + rp; break;\n\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\tcase 5: rp = fill(\"\\r\", formula[0][last_sp][1][1]) + rp; break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(lp + stack.pop() + rp); break;\n\n\t\t\tcase 'PtgRefErr': /* [MS-XLS] 2.5.198.86 */\n\t\t\t\tstack.push('#REF!'); break;\n\n\t\t\tcase 'PtgRefErr3d': /* [MS-XLS] 2.5.198.87 */\n\t\t\t\tstack.push('#REF!'); break;\n\n\t\t\tcase 'PtgExp': /* [MS-XLS] 2.5.198.58 TODO */\n\t\t\t\tc = {c:(f[1][1]/*:any*/),r:(f[1][0]/*:any*/)};\n\t\t\t\tvar q = ({c: cell.c, r:cell.r}/*:any*/);\n\t\t\t\tif(supbooks.sharedf[encode_cell(c)]) {\n\t\t\t\t\tvar parsedf = (supbooks.sharedf[encode_cell(c)]);\n\t\t\t\t\tstack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n\t\t\t\t} else {\n\t\t\t\t\tvar fnd = false;\n\t\t\t\t\tfor(e1=0;e1!=supbooks.arrayf.length; ++e1) {\n\t\t\t\t\t\t/* TODO: should be something like range_has */\n\t\t\t\t\t\te2 = supbooks.arrayf[e1];\n\t\t\t\t\t\tif(c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n\t\t\t\t\t\tif(c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n\t\t\t\t\t\tstack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n\t\t\t\t\t\tfnd = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(!fnd) stack.push(/*::String(*/f[1]/*::)*/);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgArray': /* [MS-XLS] 2.5.198.32 TODO */\n\t\t\t\tstack.push(\"{\" + stringify_array(/*::(*/f[1]/*:: :any)*/) + \"}\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemArea': /* [MS-XLS] 2.5.198.70 TODO: confirm this is a non-display */\n\t\t\t\t//stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAttrSpace': /* [MS-XLS] 2.5.198.38 */\n\t\t\tcase 'PtgAttrSpaceSemi': /* [MS-XLS] 2.5.198.39 */\n\t\t\t\tlast_sp = ff;\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgTbl': /* [MS-XLS] 2.5.198.92 TODO */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemErr': /* [MS-XLS] 2.5.198.71 */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMissArg': /* [MS-XLS] 2.5.198.74 */\n\t\t\t\tstack.push(\"\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgAreaErr': /* [MS-XLS] 2.5.198.29 */\n\t\t\t\tstack.push(\"#REF!\"); break;\n\n\t\t\tcase 'PtgAreaErr3d': /* [MS-XLS] 2.5.198.30 */\n\t\t\t\tstack.push(\"#REF!\"); break;\n\n\t\t\tcase 'PtgList': /* [MS-XLSB] 2.5.97.52 */\n\t\t\t\t// $FlowIgnore\n\t\t\t\tstack.push(\"Table\" + f[1].idx + \"[#\" + f[1].rt + \"]\");\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemAreaN':\n\t\t\tcase 'PtgMemNoMemN':\n\t\t\tcase 'PtgAttrNoop':\n\t\t\tcase 'PtgSheet':\n\t\t\tcase 'PtgEndSheet':\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgMemFunc': /* [MS-XLS] 2.5.198.72 TODO */\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemNoMem': /* [MS-XLS] 2.5.198.73 TODO */\n\t\t\t\tbreak;\n\n\t\t\tcase 'PtgElfCol': /* [MS-XLS] 2.5.198.46 */\n\t\t\tcase 'PtgElfColS': /* [MS-XLS] 2.5.198.47 */\n\t\t\tcase 'PtgElfColSV': /* [MS-XLS] 2.5.198.48 */\n\t\t\tcase 'PtgElfColV': /* [MS-XLS] 2.5.198.49 */\n\t\t\tcase 'PtgElfLel': /* [MS-XLS] 2.5.198.50 */\n\t\t\tcase 'PtgElfRadical': /* [MS-XLS] 2.5.198.51 */\n\t\t\tcase 'PtgElfRadicalLel': /* [MS-XLS] 2.5.198.52 */\n\t\t\tcase 'PtgElfRadicalS': /* [MS-XLS] 2.5.198.53 */\n\t\t\tcase 'PtgElfRw': /* [MS-XLS] 2.5.198.54 */\n\t\t\tcase 'PtgElfRwV': /* [MS-XLS] 2.5.198.55 */\n\t\t\t\tthrow new Error(\"Unsupported ELFs\");\n\n\t\t\tcase 'PtgSxName': /* [MS-XLS] 2.5.198.91 TODO -- find a test case */\n\t\t\t\tthrow new Error('Unrecognized Formula Token: ' + String(f));\n\t\t\tdefault: throw new Error('Unrecognized Formula Token: ' + String(f));\n\t\t}\n\t\tvar PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\n\t\tif(opts.biff != 3) if(last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\n\t\t\tf = formula[0][last_sp];\n\t\t\tvar _left = true;\n\t\t\tswitch(f[1][0]) {\n\t\t\t\t/* note: some bad XLSB files omit the PtgParen */\n\t\t\t\tcase 4: _left = false;\n\t\t\t\t/* falls through */\n\t\t\t\tcase 0:\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tsp = fill(\" \", f[1][1]); break;\n\t\t\t\tcase 5: _left = false;\n\t\t\t\t/* falls through */\n\t\t\t\tcase 1:\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tsp = fill(\"\\r\", f[1][1]); break;\n\t\t\t\tdefault:\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgAttrSpaceType \" + f[1][0]);\n\t\t\t}\n\t\t\tstack.push((_left ? sp : \"\") + stack.pop() + (_left ? \"\" : sp));\n\t\t\tlast_sp = -1;\n\t\t}\n\t}\n\tif(stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\n\treturn stack[0];\n}\n\n/* [MS-XLS] 2.5.198.1 TODO */\nfunction parse_ArrayParsedFormula(blob, length, opts/*::, ref*/) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n\tblob.l = target;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.3 TODO */\nfunction parse_XLSCellParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n\tblob.l = target;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.21 */\nfunction parse_NameParsedFormula(blob, length, opts, cce) {\n\tvar target = blob.l + length;\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tvar rgcb;\n\tif(target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.198.118 TODO */\nfunction parse_SharedParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLS] 2.5.133 TODO: how to emit empty strings? */\nfunction parse_FormulaValue(blob/*::, length*/) {\n\tvar b;\n\tif(__readUInt16LE(blob,blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob),'n'];\n\tswitch(blob[blob.l]) {\n\t\tcase 0x00: blob.l += 8; return [\"String\", 's'];\n\t\tcase 0x01: b = blob[blob.l+2] === 0x1; blob.l += 8; return [b,'b'];\n\t\tcase 0x02: b = blob[blob.l+2]; blob.l += 8; return [b,'e'];\n\t\tcase 0x03: blob.l += 8; return [\"\",'s'];\n\t}\n\treturn [];\n}\nfunction write_FormulaValue(value) {\n\tif(value == null) {\n\t\t// Blank String Value\n\t\tvar o = new_buf(8);\n\t\to.write_shift(1, 0x03);\n\t\to.write_shift(1, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0);\n\t\to.write_shift(2, 0xFFFF);\n\t\treturn o;\n\t} else if(typeof value == \"number\") return write_Xnum(value);\n\treturn write_Xnum(0);\n}\n\n/* [MS-XLS] 2.4.127 TODO */\nfunction parse_Formula(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_XLSCell(blob, 6);\n\tif(opts.biff == 2) ++blob.l;\n\tvar val = parse_FormulaValue(blob,8);\n\tvar flags = blob.read_shift(1);\n\tif(opts.biff != 2) {\n\t\tblob.read_shift(1);\n\t\tif(opts.biff >= 5) {\n\t\t\t/*var chn = */blob.read_shift(4);\n\t\t}\n\t}\n\tvar cbf = parse_XLSCellParsedFormula(blob, end - blob.l, opts);\n\treturn {cell:cell, val:val[0], formula:cbf, shared: (flags >> 3) & 1, tt:val[1]};\n}\nfunction write_Formula(cell/*:Cell*/, R/*:number*/, C/*:number*/, opts, os/*:number*/) {\n\t// Cell\n\tvar o1 = write_XLSCell(R, C, os);\n\n\t// FormulaValue\n\tvar o2 = write_FormulaValue(cell.v);\n\n\t// flags + cache\n\tvar o3 = new_buf(6);\n\tvar flags = 0x01 | 0x20;\n\to3.write_shift(2, flags);\n\to3.write_shift(4, 0);\n\n\t// CellParsedFormula\n\tvar bf = new_buf(cell.bf.length);\n\tfor(var i = 0; i < cell.bf.length; ++i) bf[i] = cell.bf[i];\n\n\tvar out = bconcat([o1, o2, o3, bf]);\n\treturn out;\n}\n\n\n/* XLSB Parsed Formula records have the same shape */\nfunction parse_XLSBParsedFormula(data, length, opts) {\n\tvar cce = data.read_shift(4);\n\tvar rgce = parse_Rgce(data, cce, opts);\n\tvar cb = data.read_shift(4);\n\tvar rgcb = cb > 0 ? parse_RgbExtra(data, cb, rgce, opts) : null;\n\treturn [rgce, rgcb];\n}\n\n/* [MS-XLSB] 2.5.97.1 ArrayParsedFormula */\nvar parse_XLSBArrayParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.4 CellParsedFormula */\nvar parse_XLSBCellParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.8 DVParsedFormula */\n//var parse_XLSBDVParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.9 FRTParsedFormula */\n//var parse_XLSBFRTParsedFormula = parse_XLSBParsedFormula2;\n/* [MS-XLSB] 2.5.97.12 NameParsedFormula */\nvar parse_XLSBNameParsedFormula = parse_XLSBParsedFormula;\n/* [MS-XLSB] 2.5.97.98 SharedParsedFormula */\nvar parse_XLSBSharedParsedFormula = parse_XLSBParsedFormula;\nvar Cetab = {\n  0: \"BEEP\",\n  1: \"OPEN\",\n  2: \"OPEN.LINKS\",\n  3: \"CLOSE.ALL\",\n  4: \"SAVE\",\n  5: \"SAVE.AS\",\n  6: \"FILE.DELETE\",\n  7: \"PAGE.SETUP\",\n  8: \"PRINT\",\n  9: \"PRINTER.SETUP\",\n  10: \"QUIT\",\n  11: \"NEW.WINDOW\",\n  12: \"ARRANGE.ALL\",\n  13: \"WINDOW.SIZE\",\n  14: \"WINDOW.MOVE\",\n  15: \"FULL\",\n  16: \"CLOSE\",\n  17: \"RUN\",\n  22: \"SET.PRINT.AREA\",\n  23: \"SET.PRINT.TITLES\",\n  24: \"SET.PAGE.BREAK\",\n  25: \"REMOVE.PAGE.BREAK\",\n  26: \"FONT\",\n  27: \"DISPLAY\",\n  28: \"PROTECT.DOCUMENT\",\n  29: \"PRECISION\",\n  30: \"A1.R1C1\",\n  31: \"CALCULATE.NOW\",\n  32: \"CALCULATION\",\n  34: \"DATA.FIND\",\n  35: \"EXTRACT\",\n  36: \"DATA.DELETE\",\n  37: \"SET.DATABASE\",\n  38: \"SET.CRITERIA\",\n  39: \"SORT\",\n  40: \"DATA.SERIES\",\n  41: \"TABLE\",\n  42: \"FORMAT.NUMBER\",\n  43: \"ALIGNMENT\",\n  44: \"STYLE\",\n  45: \"BORDER\",\n  46: \"CELL.PROTECTION\",\n  47: \"COLUMN.WIDTH\",\n  48: \"UNDO\",\n  49: \"CUT\",\n  50: \"COPY\",\n  51: \"PASTE\",\n  52: \"CLEAR\",\n  53: \"PASTE.SPECIAL\",\n  54: \"EDIT.DELETE\",\n  55: \"INSERT\",\n  56: \"FILL.RIGHT\",\n  57: \"FILL.DOWN\",\n  61: \"DEFINE.NAME\",\n  62: \"CREATE.NAMES\",\n  63: \"FORMULA.GOTO\",\n  64: \"FORMULA.FIND\",\n  65: \"SELECT.LAST.CELL\",\n  66: \"SHOW.ACTIVE.CELL\",\n  67: \"GALLERY.AREA\",\n  68: \"GALLERY.BAR\",\n  69: \"GALLERY.COLUMN\",\n  70: \"GALLERY.LINE\",\n  71: \"GALLERY.PIE\",\n  72: \"GALLERY.SCATTER\",\n  73: \"COMBINATION\",\n  74: \"PREFERRED\",\n  75: \"ADD.OVERLAY\",\n  76: \"GRIDLINES\",\n  77: \"SET.PREFERRED\",\n  78: \"AXES\",\n  79: \"LEGEND\",\n  80: \"ATTACH.TEXT\",\n  81: \"ADD.ARROW\",\n  82: \"SELECT.CHART\",\n  83: \"SELECT.PLOT.AREA\",\n  84: \"PATTERNS\",\n  85: \"MAIN.CHART\",\n  86: \"OVERLAY\",\n  87: \"SCALE\",\n  88: \"FORMAT.LEGEND\",\n  89: \"FORMAT.TEXT\",\n  90: \"EDIT.REPEAT\",\n  91: \"PARSE\",\n  92: \"JUSTIFY\",\n  93: \"HIDE\",\n  94: \"UNHIDE\",\n  95: \"WORKSPACE\",\n  96: \"FORMULA\",\n  97: \"FORMULA.FILL\",\n  98: \"FORMULA.ARRAY\",\n  99: \"DATA.FIND.NEXT\",\n  100: \"DATA.FIND.PREV\",\n  101: \"FORMULA.FIND.NEXT\",\n  102: \"FORMULA.FIND.PREV\",\n  103: \"ACTIVATE\",\n  104: \"ACTIVATE.NEXT\",\n  105: \"ACTIVATE.PREV\",\n  106: \"UNLOCKED.NEXT\",\n  107: \"UNLOCKED.PREV\",\n  108: \"COPY.PICTURE\",\n  109: \"SELECT\",\n  110: \"DELETE.NAME\",\n  111: \"DELETE.FORMAT\",\n  112: \"VLINE\",\n  113: \"HLINE\",\n  114: \"VPAGE\",\n  115: \"HPAGE\",\n  116: \"VSCROLL\",\n  117: \"HSCROLL\",\n  118: \"ALERT\",\n  119: \"NEW\",\n  120: \"CANCEL.COPY\",\n  121: \"SHOW.CLIPBOARD\",\n  122: \"MESSAGE\",\n  124: \"PASTE.LINK\",\n  125: \"APP.ACTIVATE\",\n  126: \"DELETE.ARROW\",\n  127: \"ROW.HEIGHT\",\n  128: \"FORMAT.MOVE\",\n  129: \"FORMAT.SIZE\",\n  130: \"FORMULA.REPLACE\",\n  131: \"SEND.KEYS\",\n  132: \"SELECT.SPECIAL\",\n  133: \"APPLY.NAMES\",\n  134: \"REPLACE.FONT\",\n  135: \"FREEZE.PANES\",\n  136: \"SHOW.INFO\",\n  137: \"SPLIT\",\n  138: \"ON.WINDOW\",\n  139: \"ON.DATA\",\n  140: \"DISABLE.INPUT\",\n  142: \"OUTLINE\",\n  143: \"LIST.NAMES\",\n  144: \"FILE.CLOSE\",\n  145: \"SAVE.WORKBOOK\",\n  146: \"DATA.FORM\",\n  147: \"COPY.CHART\",\n  148: \"ON.TIME\",\n  149: \"WAIT\",\n  150: \"FORMAT.FONT\",\n  151: \"FILL.UP\",\n  152: \"FILL.LEFT\",\n  153: \"DELETE.OVERLAY\",\n  155: \"SHORT.MENUS\",\n  159: \"SET.UPDATE.STATUS\",\n  161: \"COLOR.PALETTE\",\n  162: \"DELETE.STYLE\",\n  163: \"WINDOW.RESTORE\",\n  164: \"WINDOW.MAXIMIZE\",\n  166: \"CHANGE.LINK\",\n  167: \"CALCULATE.DOCUMENT\",\n  168: \"ON.KEY\",\n  169: \"APP.RESTORE\",\n  170: \"APP.MOVE\",\n  171: \"APP.SIZE\",\n  172: \"APP.MINIMIZE\",\n  173: \"APP.MAXIMIZE\",\n  174: \"BRING.TO.FRONT\",\n  175: \"SEND.TO.BACK\",\n  185: \"MAIN.CHART.TYPE\",\n  186: \"OVERLAY.CHART.TYPE\",\n  187: \"SELECT.END\",\n  188: \"OPEN.MAIL\",\n  189: \"SEND.MAIL\",\n  190: \"STANDARD.FONT\",\n  191: \"CONSOLIDATE\",\n  192: \"SORT.SPECIAL\",\n  193: \"GALLERY.3D.AREA\",\n  194: \"GALLERY.3D.COLUMN\",\n  195: \"GALLERY.3D.LINE\",\n  196: \"GALLERY.3D.PIE\",\n  197: \"VIEW.3D\",\n  198: \"GOAL.SEEK\",\n  199: \"WORKGROUP\",\n  200: \"FILL.GROUP\",\n  201: \"UPDATE.LINK\",\n  202: \"PROMOTE\",\n  203: \"DEMOTE\",\n  204: \"SHOW.DETAIL\",\n  206: \"UNGROUP\",\n  207: \"OBJECT.PROPERTIES\",\n  208: \"SAVE.NEW.OBJECT\",\n  209: \"SHARE\",\n  210: \"SHARE.NAME\",\n  211: \"DUPLICATE\",\n  212: \"APPLY.STYLE\",\n  213: \"ASSIGN.TO.OBJECT\",\n  214: \"OBJECT.PROTECTION\",\n  215: \"HIDE.OBJECT\",\n  216: \"SET.EXTRACT\",\n  217: \"CREATE.PUBLISHER\",\n  218: \"SUBSCRIBE.TO\",\n  219: \"ATTRIBUTES\",\n  220: \"SHOW.TOOLBAR\",\n  222: \"PRINT.PREVIEW\",\n  223: \"EDIT.COLOR\",\n  224: \"SHOW.LEVELS\",\n  225: \"FORMAT.MAIN\",\n  226: \"FORMAT.OVERLAY\",\n  227: \"ON.RECALC\",\n  228: \"EDIT.SERIES\",\n  229: \"DEFINE.STYLE\",\n  240: \"LINE.PRINT\",\n  243: \"ENTER.DATA\",\n  249: \"GALLERY.RADAR\",\n  250: \"MERGE.STYLES\",\n  251: \"EDITION.OPTIONS\",\n  252: \"PASTE.PICTURE\",\n  253: \"PASTE.PICTURE.LINK\",\n  254: \"SPELLING\",\n  256: \"ZOOM\",\n  259: \"INSERT.OBJECT\",\n  260: \"WINDOW.MINIMIZE\",\n  265: \"SOUND.NOTE\",\n  266: \"SOUND.PLAY\",\n  267: \"FORMAT.SHAPE\",\n  268: \"EXTEND.POLYGON\",\n  269: \"FORMAT.AUTO\",\n  272: \"GALLERY.3D.BAR\",\n  273: \"GALLERY.3D.SURFACE\",\n  274: \"FILL.AUTO\",\n  276: \"CUSTOMIZE.TOOLBAR\",\n  277: \"ADD.TOOL\",\n  278: \"EDIT.OBJECT\",\n  279: \"ON.DOUBLECLICK\",\n  280: \"ON.ENTRY\",\n  281: \"WORKBOOK.ADD\",\n  282: \"WORKBOOK.MOVE\",\n  283: \"WORKBOOK.COPY\",\n  284: \"WORKBOOK.OPTIONS\",\n  285: \"SAVE.WORKSPACE\",\n  288: \"CHART.WIZARD\",\n  289: \"DELETE.TOOL\",\n  290: \"MOVE.TOOL\",\n  291: \"WORKBOOK.SELECT\",\n  292: \"WORKBOOK.ACTIVATE\",\n  293: \"ASSIGN.TO.TOOL\",\n  295: \"COPY.TOOL\",\n  296: \"RESET.TOOL\",\n  297: \"CONSTRAIN.NUMERIC\",\n  298: \"PASTE.TOOL\",\n  302: \"WORKBOOK.NEW\",\n  305: \"SCENARIO.CELLS\",\n  306: \"SCENARIO.DELETE\",\n  307: \"SCENARIO.ADD\",\n  308: \"SCENARIO.EDIT\",\n  309: \"SCENARIO.SHOW\",\n  310: \"SCENARIO.SHOW.NEXT\",\n  311: \"SCENARIO.SUMMARY\",\n  312: \"PIVOT.TABLE.WIZARD\",\n  313: \"PIVOT.FIELD.PROPERTIES\",\n  314: \"PIVOT.FIELD\",\n  315: \"PIVOT.ITEM\",\n  316: \"PIVOT.ADD.FIELDS\",\n  318: \"OPTIONS.CALCULATION\",\n  319: \"OPTIONS.EDIT\",\n  320: \"OPTIONS.VIEW\",\n  321: \"ADDIN.MANAGER\",\n  322: \"MENU.EDITOR\",\n  323: \"ATTACH.TOOLBARS\",\n  324: \"VBAActivate\",\n  325: \"OPTIONS.CHART\",\n  328: \"VBA.INSERT.FILE\",\n  330: \"VBA.PROCEDURE.DEFINITION\",\n  336: \"ROUTING.SLIP\",\n  338: \"ROUTE.DOCUMENT\",\n  339: \"MAIL.LOGON\",\n  342: \"INSERT.PICTURE\",\n  343: \"EDIT.TOOL\",\n  344: \"GALLERY.DOUGHNUT\",\n  350: \"CHART.TREND\",\n  352: \"PIVOT.ITEM.PROPERTIES\",\n  354: \"WORKBOOK.INSERT\",\n  355: \"OPTIONS.TRANSITION\",\n  356: \"OPTIONS.GENERAL\",\n  370: \"FILTER.ADVANCED\",\n  373: \"MAIL.ADD.MAILER\",\n  374: \"MAIL.DELETE.MAILER\",\n  375: \"MAIL.REPLY\",\n  376: \"MAIL.REPLY.ALL\",\n  377: \"MAIL.FORWARD\",\n  378: \"MAIL.NEXT.LETTER\",\n  379: \"DATA.LABEL\",\n  380: \"INSERT.TITLE\",\n  381: \"FONT.PROPERTIES\",\n  382: \"MACRO.OPTIONS\",\n  383: \"WORKBOOK.HIDE\",\n  384: \"WORKBOOK.UNHIDE\",\n  385: \"WORKBOOK.DELETE\",\n  386: \"WORKBOOK.NAME\",\n  388: \"GALLERY.CUSTOM\",\n  390: \"ADD.CHART.AUTOFORMAT\",\n  391: \"DELETE.CHART.AUTOFORMAT\",\n  392: \"CHART.ADD.DATA\",\n  393: \"AUTO.OUTLINE\",\n  394: \"TAB.ORDER\",\n  395: \"SHOW.DIALOG\",\n  396: \"SELECT.ALL\",\n  397: \"UNGROUP.SHEETS\",\n  398: \"SUBTOTAL.CREATE\",\n  399: \"SUBTOTAL.REMOVE\",\n  400: \"RENAME.OBJECT\",\n  412: \"WORKBOOK.SCROLL\",\n  413: \"WORKBOOK.NEXT\",\n  414: \"WORKBOOK.PREV\",\n  415: \"WORKBOOK.TAB.SPLIT\",\n  416: \"FULL.SCREEN\",\n  417: \"WORKBOOK.PROTECT\",\n  420: \"SCROLLBAR.PROPERTIES\",\n  421: \"PIVOT.SHOW.PAGES\",\n  422: \"TEXT.TO.COLUMNS\",\n  423: \"FORMAT.CHARTTYPE\",\n  424: \"LINK.FORMAT\",\n  425: \"TRACER.DISPLAY\",\n  430: \"TRACER.NAVIGATE\",\n  431: \"TRACER.CLEAR\",\n  432: \"TRACER.ERROR\",\n  433: \"PIVOT.FIELD.GROUP\",\n  434: \"PIVOT.FIELD.UNGROUP\",\n  435: \"CHECKBOX.PROPERTIES\",\n  436: \"LABEL.PROPERTIES\",\n  437: \"LISTBOX.PROPERTIES\",\n  438: \"EDITBOX.PROPERTIES\",\n  439: \"PIVOT.REFRESH\",\n  440: \"LINK.COMBO\",\n  441: \"OPEN.TEXT\",\n  442: \"HIDE.DIALOG\",\n  443: \"SET.DIALOG.FOCUS\",\n  444: \"ENABLE.OBJECT\",\n  445: \"PUSHBUTTON.PROPERTIES\",\n  446: \"SET.DIALOG.DEFAULT\",\n  447: \"FILTER\",\n  448: \"FILTER.SHOW.ALL\",\n  449: \"CLEAR.OUTLINE\",\n  450: \"FUNCTION.WIZARD\",\n  451: \"ADD.LIST.ITEM\",\n  452: \"SET.LIST.ITEM\",\n  453: \"REMOVE.LIST.ITEM\",\n  454: \"SELECT.LIST.ITEM\",\n  455: \"SET.CONTROL.VALUE\",\n  456: \"SAVE.COPY.AS\",\n  458: \"OPTIONS.LISTS.ADD\",\n  459: \"OPTIONS.LISTS.DELETE\",\n  460: \"SERIES.AXES\",\n  461: \"SERIES.X\",\n  462: \"SERIES.Y\",\n  463: \"ERRORBAR.X\",\n  464: \"ERRORBAR.Y\",\n  465: \"FORMAT.CHART\",\n  466: \"SERIES.ORDER\",\n  467: \"MAIL.LOGOFF\",\n  468: \"CLEAR.ROUTING.SLIP\",\n  469: \"APP.ACTIVATE.MICROSOFT\",\n  470: \"MAIL.EDIT.MAILER\",\n  471: \"ON.SHEET\",\n  472: \"STANDARD.WIDTH\",\n  473: \"SCENARIO.MERGE\",\n  474: \"SUMMARY.INFO\",\n  475: \"FIND.FILE\",\n  476: \"ACTIVE.CELL.FONT\",\n  477: \"ENABLE.TIPWIZARD\",\n  478: \"VBA.MAKE.ADDIN\",\n  480: \"INSERTDATATABLE\",\n  481: \"WORKGROUP.OPTIONS\",\n  482: \"MAIL.SEND.MAILER\",\n  485: \"AUTOCORRECT\",\n  489: \"POST.DOCUMENT\",\n  491: \"PICKLIST\",\n  493: \"VIEW.SHOW\",\n  494: \"VIEW.DEFINE\",\n  495: \"VIEW.DELETE\",\n  509: \"SHEET.BACKGROUND\",\n  510: \"INSERT.MAP.OBJECT\",\n  511: \"OPTIONS.MENONO\",\n  517: \"MSOCHECKS\",\n  518: \"NORMAL\",\n  519: \"LAYOUT\",\n  520: \"RM.PRINT.AREA\",\n  521: \"CLEAR.PRINT.AREA\",\n  522: \"ADD.PRINT.AREA\",\n  523: \"MOVE.BRK\",\n  545: \"HIDECURR.NOTE\",\n  546: \"HIDEALL.NOTES\",\n  547: \"DELETE.NOTE\",\n  548: \"TRAVERSE.NOTES\",\n  549: \"ACTIVATE.NOTES\",\n  620: \"PROTECT.REVISIONS\",\n  621: \"UNPROTECT.REVISIONS\",\n  647: \"OPTIONS.ME\",\n  653: \"WEB.PUBLISH\",\n  667: \"NEWWEBQUERY\",\n  673: \"PIVOT.TABLE.CHART\",\n  753: \"OPTIONS.SAVE\",\n  755: \"OPTIONS.SPELL\",\n  808: \"HIDEALL.INKANNOTS\"\n};\nvar Ftab = {\n  0: \"COUNT\",\n  1: \"IF\",\n  2: \"ISNA\",\n  3: \"ISERROR\",\n  4: \"SUM\",\n  5: \"AVERAGE\",\n  6: \"MIN\",\n  7: \"MAX\",\n  8: \"ROW\",\n  9: \"COLUMN\",\n  10: \"NA\",\n  11: \"NPV\",\n  12: \"STDEV\",\n  13: \"DOLLAR\",\n  14: \"FIXED\",\n  15: \"SIN\",\n  16: \"COS\",\n  17: \"TAN\",\n  18: \"ATAN\",\n  19: \"PI\",\n  20: \"SQRT\",\n  21: \"EXP\",\n  22: \"LN\",\n  23: \"LOG10\",\n  24: \"ABS\",\n  25: \"INT\",\n  26: \"SIGN\",\n  27: \"ROUND\",\n  28: \"LOOKUP\",\n  29: \"INDEX\",\n  30: \"REPT\",\n  31: \"MID\",\n  32: \"LEN\",\n  33: \"VALUE\",\n  34: \"TRUE\",\n  35: \"FALSE\",\n  36: \"AND\",\n  37: \"OR\",\n  38: \"NOT\",\n  39: \"MOD\",\n  40: \"DCOUNT\",\n  41: \"DSUM\",\n  42: \"DAVERAGE\",\n  43: \"DMIN\",\n  44: \"DMAX\",\n  45: \"DSTDEV\",\n  46: \"VAR\",\n  47: \"DVAR\",\n  48: \"TEXT\",\n  49: \"LINEST\",\n  50: \"TREND\",\n  51: \"LOGEST\",\n  52: \"GROWTH\",\n  53: \"GOTO\",\n  54: \"HALT\",\n  55: \"RETURN\",\n  56: \"PV\",\n  57: \"FV\",\n  58: \"NPER\",\n  59: \"PMT\",\n  60: \"RATE\",\n  61: \"MIRR\",\n  62: \"IRR\",\n  63: \"RAND\",\n  64: \"MATCH\",\n  65: \"DATE\",\n  66: \"TIME\",\n  67: \"DAY\",\n  68: \"MONTH\",\n  69: \"YEAR\",\n  70: \"WEEKDAY\",\n  71: \"HOUR\",\n  72: \"MINUTE\",\n  73: \"SECOND\",\n  74: \"NOW\",\n  75: \"AREAS\",\n  76: \"ROWS\",\n  77: \"COLUMNS\",\n  78: \"OFFSET\",\n  79: \"ABSREF\",\n  80: \"RELREF\",\n  81: \"ARGUMENT\",\n  82: \"SEARCH\",\n  83: \"TRANSPOSE\",\n  84: \"ERROR\",\n  85: \"STEP\",\n  86: \"TYPE\",\n  87: \"ECHO\",\n  88: \"SET.NAME\",\n  89: \"CALLER\",\n  90: \"DEREF\",\n  91: \"WINDOWS\",\n  92: \"SERIES\",\n  93: \"DOCUMENTS\",\n  94: \"ACTIVE.CELL\",\n  95: \"SELECTION\",\n  96: \"RESULT\",\n  97: \"ATAN2\",\n  98: \"ASIN\",\n  99: \"ACOS\",\n  100: \"CHOOSE\",\n  101: \"HLOOKUP\",\n  102: \"VLOOKUP\",\n  103: \"LINKS\",\n  104: \"INPUT\",\n  105: \"ISREF\",\n  106: \"GET.FORMULA\",\n  107: \"GET.NAME\",\n  108: \"SET.VALUE\",\n  109: \"LOG\",\n  110: \"EXEC\",\n  111: \"CHAR\",\n  112: \"LOWER\",\n  113: \"UPPER\",\n  114: \"PROPER\",\n  115: \"LEFT\",\n  116: \"RIGHT\",\n  117: \"EXACT\",\n  118: \"TRIM\",\n  119: \"REPLACE\",\n  120: \"SUBSTITUTE\",\n  121: \"CODE\",\n  122: \"NAMES\",\n  123: \"DIRECTORY\",\n  124: \"FIND\",\n  125: \"CELL\",\n  126: \"ISERR\",\n  127: \"ISTEXT\",\n  128: \"ISNUMBER\",\n  129: \"ISBLANK\",\n  130: \"T\",\n  131: \"N\",\n  132: \"FOPEN\",\n  133: \"FCLOSE\",\n  134: \"FSIZE\",\n  135: \"FREADLN\",\n  136: \"FREAD\",\n  137: \"FWRITELN\",\n  138: \"FWRITE\",\n  139: \"FPOS\",\n  140: \"DATEVALUE\",\n  141: \"TIMEVALUE\",\n  142: \"SLN\",\n  143: \"SYD\",\n  144: \"DDB\",\n  145: \"GET.DEF\",\n  146: \"REFTEXT\",\n  147: \"TEXTREF\",\n  148: \"INDIRECT\",\n  149: \"REGISTER\",\n  150: \"CALL\",\n  151: \"ADD.BAR\",\n  152: \"ADD.MENU\",\n  153: \"ADD.COMMAND\",\n  154: \"ENABLE.COMMAND\",\n  155: \"CHECK.COMMAND\",\n  156: \"RENAME.COMMAND\",\n  157: \"SHOW.BAR\",\n  158: \"DELETE.MENU\",\n  159: \"DELETE.COMMAND\",\n  160: \"GET.CHART.ITEM\",\n  161: \"DIALOG.BOX\",\n  162: \"CLEAN\",\n  163: \"MDETERM\",\n  164: \"MINVERSE\",\n  165: \"MMULT\",\n  166: \"FILES\",\n  167: \"IPMT\",\n  168: \"PPMT\",\n  169: \"COUNTA\",\n  170: \"CANCEL.KEY\",\n  171: \"FOR\",\n  172: \"WHILE\",\n  173: \"BREAK\",\n  174: \"NEXT\",\n  175: \"INITIATE\",\n  176: \"REQUEST\",\n  177: \"POKE\",\n  178: \"EXECUTE\",\n  179: \"TERMINATE\",\n  180: \"RESTART\",\n  181: \"HELP\",\n  182: \"GET.BAR\",\n  183: \"PRODUCT\",\n  184: \"FACT\",\n  185: \"GET.CELL\",\n  186: \"GET.WORKSPACE\",\n  187: \"GET.WINDOW\",\n  188: \"GET.DOCUMENT\",\n  189: \"DPRODUCT\",\n  190: \"ISNONTEXT\",\n  191: \"GET.NOTE\",\n  192: \"NOTE\",\n  193: \"STDEVP\",\n  194: \"VARP\",\n  195: \"DSTDEVP\",\n  196: \"DVARP\",\n  197: \"TRUNC\",\n  198: \"ISLOGICAL\",\n  199: \"DCOUNTA\",\n  200: \"DELETE.BAR\",\n  201: \"UNREGISTER\",\n  204: \"USDOLLAR\",\n  205: \"FINDB\",\n  206: \"SEARCHB\",\n  207: \"REPLACEB\",\n  208: \"LEFTB\",\n  209: \"RIGHTB\",\n  210: \"MIDB\",\n  211: \"LENB\",\n  212: \"ROUNDUP\",\n  213: \"ROUNDDOWN\",\n  214: \"ASC\",\n  215: \"DBCS\",\n  216: \"RANK\",\n  219: \"ADDRESS\",\n  220: \"DAYS360\",\n  221: \"TODAY\",\n  222: \"VDB\",\n  223: \"ELSE\",\n  224: \"ELSE.IF\",\n  225: \"END.IF\",\n  226: \"FOR.CELL\",\n  227: \"MEDIAN\",\n  228: \"SUMPRODUCT\",\n  229: \"SINH\",\n  230: \"COSH\",\n  231: \"TANH\",\n  232: \"ASINH\",\n  233: \"ACOSH\",\n  234: \"ATANH\",\n  235: \"DGET\",\n  236: \"CREATE.OBJECT\",\n  237: \"VOLATILE\",\n  238: \"LAST.ERROR\",\n  239: \"CUSTOM.UNDO\",\n  240: \"CUSTOM.REPEAT\",\n  241: \"FORMULA.CONVERT\",\n  242: \"GET.LINK.INFO\",\n  243: \"TEXT.BOX\",\n  244: \"INFO\",\n  245: \"GROUP\",\n  246: \"GET.OBJECT\",\n  247: \"DB\",\n  248: \"PAUSE\",\n  251: \"RESUME\",\n  252: \"FREQUENCY\",\n  253: \"ADD.TOOLBAR\",\n  254: \"DELETE.TOOLBAR\",\n  255: \"User\",\n  256: \"RESET.TOOLBAR\",\n  257: \"EVALUATE\",\n  258: \"GET.TOOLBAR\",\n  259: \"GET.TOOL\",\n  260: \"SPELLING.CHECK\",\n  261: \"ERROR.TYPE\",\n  262: \"APP.TITLE\",\n  263: \"WINDOW.TITLE\",\n  264: \"SAVE.TOOLBAR\",\n  265: \"ENABLE.TOOL\",\n  266: \"PRESS.TOOL\",\n  267: \"REGISTER.ID\",\n  268: \"GET.WORKBOOK\",\n  269: \"AVEDEV\",\n  270: \"BETADIST\",\n  271: \"GAMMALN\",\n  272: \"BETAINV\",\n  273: \"BINOMDIST\",\n  274: \"CHIDIST\",\n  275: \"CHIINV\",\n  276: \"COMBIN\",\n  277: \"CONFIDENCE\",\n  278: \"CRITBINOM\",\n  279: \"EVEN\",\n  280: \"EXPONDIST\",\n  281: \"FDIST\",\n  282: \"FINV\",\n  283: \"FISHER\",\n  284: \"FISHERINV\",\n  285: \"FLOOR\",\n  286: \"GAMMADIST\",\n  287: \"GAMMAINV\",\n  288: \"CEILING\",\n  289: \"HYPGEOMDIST\",\n  290: \"LOGNORMDIST\",\n  291: \"LOGINV\",\n  292: \"NEGBINOMDIST\",\n  293: \"NORMDIST\",\n  294: \"NORMSDIST\",\n  295: \"NORMINV\",\n  296: \"NORMSINV\",\n  297: \"STANDARDIZE\",\n  298: \"ODD\",\n  299: \"PERMUT\",\n  300: \"POISSON\",\n  301: \"TDIST\",\n  302: \"WEIBULL\",\n  303: \"SUMXMY2\",\n  304: \"SUMX2MY2\",\n  305: \"SUMX2PY2\",\n  306: \"CHITEST\",\n  307: \"CORREL\",\n  308: \"COVAR\",\n  309: \"FORECAST\",\n  310: \"FTEST\",\n  311: \"INTERCEPT\",\n  312: \"PEARSON\",\n  313: \"RSQ\",\n  314: \"STEYX\",\n  315: \"SLOPE\",\n  316: \"TTEST\",\n  317: \"PROB\",\n  318: \"DEVSQ\",\n  319: \"GEOMEAN\",\n  320: \"HARMEAN\",\n  321: \"SUMSQ\",\n  322: \"KURT\",\n  323: \"SKEW\",\n  324: \"ZTEST\",\n  325: \"LARGE\",\n  326: \"SMALL\",\n  327: \"QUARTILE\",\n  328: \"PERCENTILE\",\n  329: \"PERCENTRANK\",\n  330: \"MODE\",\n  331: \"TRIMMEAN\",\n  332: \"TINV\",\n  334: \"MOVIE.COMMAND\",\n  335: \"GET.MOVIE\",\n  336: \"CONCATENATE\",\n  337: \"POWER\",\n  338: \"PIVOT.ADD.DATA\",\n  339: \"GET.PIVOT.TABLE\",\n  340: \"GET.PIVOT.FIELD\",\n  341: \"GET.PIVOT.ITEM\",\n  342: \"RADIANS\",\n  343: \"DEGREES\",\n  344: \"SUBTOTAL\",\n  345: \"SUMIF\",\n  346: \"COUNTIF\",\n  347: \"COUNTBLANK\",\n  348: \"SCENARIO.GET\",\n  349: \"OPTIONS.LISTS.GET\",\n  350: \"ISPMT\",\n  351: \"DATEDIF\",\n  352: \"DATESTRING\",\n  353: \"NUMBERSTRING\",\n  354: \"ROMAN\",\n  355: \"OPEN.DIALOG\",\n  356: \"SAVE.DIALOG\",\n  357: \"VIEW.GET\",\n  358: \"GETPIVOTDATA\",\n  359: \"HYPERLINK\",\n  360: \"PHONETIC\",\n  361: \"AVERAGEA\",\n  362: \"MAXA\",\n  363: \"MINA\",\n  364: \"STDEVPA\",\n  365: \"VARPA\",\n  366: \"STDEVA\",\n  367: \"VARA\",\n  368: \"BAHTTEXT\",\n  369: \"THAIDAYOFWEEK\",\n  370: \"THAIDIGIT\",\n  371: \"THAIMONTHOFYEAR\",\n  372: \"THAINUMSOUND\",\n  373: \"THAINUMSTRING\",\n  374: \"THAISTRINGLENGTH\",\n  375: \"ISTHAIDIGIT\",\n  376: \"ROUNDBAHTDOWN\",\n  377: \"ROUNDBAHTUP\",\n  378: \"THAIYEAR\",\n  379: \"RTD\",\n  380: \"CUBEVALUE\",\n  381: \"CUBEMEMBER\",\n  382: \"CUBEMEMBERPROPERTY\",\n  383: \"CUBERANKEDMEMBER\",\n  384: \"HEX2BIN\",\n  385: \"HEX2DEC\",\n  386: \"HEX2OCT\",\n  387: \"DEC2BIN\",\n  388: \"DEC2HEX\",\n  389: \"DEC2OCT\",\n  390: \"OCT2BIN\",\n  391: \"OCT2HEX\",\n  392: \"OCT2DEC\",\n  393: \"BIN2DEC\",\n  394: \"BIN2OCT\",\n  395: \"BIN2HEX\",\n  396: \"IMSUB\",\n  397: \"IMDIV\",\n  398: \"IMPOWER\",\n  399: \"IMABS\",\n  400: \"IMSQRT\",\n  401: \"IMLN\",\n  402: \"IMLOG2\",\n  403: \"IMLOG10\",\n  404: \"IMSIN\",\n  405: \"IMCOS\",\n  406: \"IMEXP\",\n  407: \"IMARGUMENT\",\n  408: \"IMCONJUGATE\",\n  409: \"IMAGINARY\",\n  410: \"IMREAL\",\n  411: \"COMPLEX\",\n  412: \"IMSUM\",\n  413: \"IMPRODUCT\",\n  414: \"SERIESSUM\",\n  415: \"FACTDOUBLE\",\n  416: \"SQRTPI\",\n  417: \"QUOTIENT\",\n  418: \"DELTA\",\n  419: \"GESTEP\",\n  420: \"ISEVEN\",\n  421: \"ISODD\",\n  422: \"MROUND\",\n  423: \"ERF\",\n  424: \"ERFC\",\n  425: \"BESSELJ\",\n  426: \"BESSELK\",\n  427: \"BESSELY\",\n  428: \"BESSELI\",\n  429: \"XIRR\",\n  430: \"XNPV\",\n  431: \"PRICEMAT\",\n  432: \"YIELDMAT\",\n  433: \"INTRATE\",\n  434: \"RECEIVED\",\n  435: \"DISC\",\n  436: \"PRICEDISC\",\n  437: \"YIELDDISC\",\n  438: \"TBILLEQ\",\n  439: \"TBILLPRICE\",\n  440: \"TBILLYIELD\",\n  441: \"PRICE\",\n  442: \"YIELD\",\n  443: \"DOLLARDE\",\n  444: \"DOLLARFR\",\n  445: \"NOMINAL\",\n  446: \"EFFECT\",\n  447: \"CUMPRINC\",\n  448: \"CUMIPMT\",\n  449: \"EDATE\",\n  450: \"EOMONTH\",\n  451: \"YEARFRAC\",\n  452: \"COUPDAYBS\",\n  453: \"COUPDAYS\",\n  454: \"COUPDAYSNC\",\n  455: \"COUPNCD\",\n  456: \"COUPNUM\",\n  457: \"COUPPCD\",\n  458: \"DURATION\",\n  459: \"MDURATION\",\n  460: \"ODDLPRICE\",\n  461: \"ODDLYIELD\",\n  462: \"ODDFPRICE\",\n  463: \"ODDFYIELD\",\n  464: \"RANDBETWEEN\",\n  465: \"WEEKNUM\",\n  466: \"AMORDEGRC\",\n  467: \"AMORLINC\",\n  468: \"CONVERT\",\n  724: \"SHEETJS\",\n  469: \"ACCRINT\",\n  470: \"ACCRINTM\",\n  471: \"WORKDAY\",\n  472: \"NETWORKDAYS\",\n  473: \"GCD\",\n  474: \"MULTINOMIAL\",\n  475: \"LCM\",\n  476: \"FVSCHEDULE\",\n  477: \"CUBEKPIMEMBER\",\n  478: \"CUBESET\",\n  479: \"CUBESETCOUNT\",\n  480: \"IFERROR\",\n  481: \"COUNTIFS\",\n  482: \"SUMIFS\",\n  483: \"AVERAGEIF\",\n  484: \"AVERAGEIFS\"\n};\nvar FtabArgc = {\n  2: 1,\n  3: 1,\n  10: 0,\n  15: 1,\n  16: 1,\n  17: 1,\n  18: 1,\n  19: 0,\n  20: 1,\n  21: 1,\n  22: 1,\n  23: 1,\n  24: 1,\n  25: 1,\n  26: 1,\n  27: 2,\n  30: 2,\n  31: 3,\n  32: 1,\n  33: 1,\n  34: 0,\n  35: 0,\n  38: 1,\n  39: 2,\n  40: 3,\n  41: 3,\n  42: 3,\n  43: 3,\n  44: 3,\n  45: 3,\n  47: 3,\n  48: 2,\n  53: 1,\n  61: 3,\n  63: 0,\n  65: 3,\n  66: 3,\n  67: 1,\n  68: 1,\n  69: 1,\n  70: 1,\n  71: 1,\n  72: 1,\n  73: 1,\n  74: 0,\n  75: 1,\n  76: 1,\n  77: 1,\n  79: 2,\n  80: 2,\n  83: 1,\n  85: 0,\n  86: 1,\n  89: 0,\n  90: 1,\n  94: 0,\n  95: 0,\n  97: 2,\n  98: 1,\n  99: 1,\n  101: 3,\n  102: 3,\n  105: 1,\n  106: 1,\n  108: 2,\n  111: 1,\n  112: 1,\n  113: 1,\n  114: 1,\n  117: 2,\n  118: 1,\n  119: 4,\n  121: 1,\n  126: 1,\n  127: 1,\n  128: 1,\n  129: 1,\n  130: 1,\n  131: 1,\n  133: 1,\n  134: 1,\n  135: 1,\n  136: 2,\n  137: 2,\n  138: 2,\n  140: 1,\n  141: 1,\n  142: 3,\n  143: 4,\n  144: 4,\n  161: 1,\n  162: 1,\n  163: 1,\n  164: 1,\n  165: 2,\n  172: 1,\n  175: 2,\n  176: 2,\n  177: 3,\n  178: 2,\n  179: 1,\n  184: 1,\n  186: 1,\n  189: 3,\n  190: 1,\n  195: 3,\n  196: 3,\n  197: 1,\n  198: 1,\n  199: 3,\n  201: 1,\n  207: 4,\n  210: 3,\n  211: 1,\n  212: 2,\n  213: 2,\n  214: 1,\n  215: 1,\n  225: 0,\n  229: 1,\n  230: 1,\n  231: 1,\n  232: 1,\n  233: 1,\n  234: 1,\n  235: 3,\n  244: 1,\n  247: 4,\n  252: 2,\n  257: 1,\n  261: 1,\n  271: 1,\n  273: 4,\n  274: 2,\n  275: 2,\n  276: 2,\n  277: 3,\n  278: 3,\n  279: 1,\n  280: 3,\n  281: 3,\n  282: 3,\n  283: 1,\n  284: 1,\n  285: 2,\n  286: 4,\n  287: 3,\n  288: 2,\n  289: 4,\n  290: 3,\n  291: 3,\n  292: 3,\n  293: 4,\n  294: 1,\n  295: 3,\n  296: 1,\n  297: 3,\n  298: 1,\n  299: 2,\n  300: 3,\n  301: 3,\n  302: 4,\n  303: 2,\n  304: 2,\n  305: 2,\n  306: 2,\n  307: 2,\n  308: 2,\n  309: 3,\n  310: 2,\n  311: 2,\n  312: 2,\n  313: 2,\n  314: 2,\n  315: 2,\n  316: 4,\n  325: 2,\n  326: 2,\n  327: 2,\n  328: 2,\n  331: 2,\n  332: 2,\n  337: 2,\n  342: 1,\n  343: 1,\n  346: 2,\n  347: 1,\n  350: 4,\n  351: 3,\n  352: 1,\n  353: 2,\n  360: 1,\n  368: 1,\n  369: 1,\n  370: 1,\n  371: 1,\n  372: 1,\n  373: 1,\n  374: 1,\n  375: 1,\n  376: 1,\n  377: 1,\n  378: 1,\n  382: 3,\n  385: 1,\n  392: 1,\n  393: 1,\n  396: 2,\n  397: 2,\n  398: 2,\n  399: 1,\n  400: 1,\n  401: 1,\n  402: 1,\n  403: 1,\n  404: 1,\n  405: 1,\n  406: 1,\n  407: 1,\n  408: 1,\n  409: 1,\n  410: 1,\n  414: 4,\n  415: 1,\n  416: 1,\n  417: 2,\n  420: 1,\n  421: 1,\n  422: 2,\n  424: 1,\n  425: 2,\n  426: 2,\n  427: 2,\n  428: 2,\n  430: 3,\n  438: 3,\n  439: 3,\n  440: 3,\n  443: 2,\n  444: 2,\n  445: 2,\n  446: 2,\n  447: 6,\n  448: 6,\n  449: 2,\n  450: 2,\n  464: 2,\n  468: 3,\n  476: 2,\n  479: 1,\n  480: 2,\n  65535: 0\n};\n/* Part 3 TODO: actually parse formulae */\nfunction ods_to_csf_formula(f/*:string*/)/*:string*/ {\n\tif(f.slice(0,3) == \"of:\") f = f.slice(3);\n\t/* 5.2 Basic Expressions */\n\tif(f.charCodeAt(0) == 61) {\n\t\tf = f.slice(1);\n\t\tif(f.charCodeAt(0) == 61) f = f.slice(1);\n\t}\n\tf = f.replace(/COM\\.MICROSOFT\\./g, \"\");\n\t/* Part 3 Section 5.8 References */\n\tf = f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, function($$, $1) { return $1.replace(/\\./g,\"\"); });\n\t/* TODO: something other than this */\n\tf = f.replace(/\\[.(#[A-Z]*[?!])\\]/g, \"$1\");\n\treturn f.replace(/[;~]/g,\",\").replace(/\\|/g,\";\");\n}\n\nfunction csf_to_ods_formula(f/*:string*/)/*:string*/ {\n\tvar o = \"of:=\" + f.replace(crefregex, \"$1[.$2$3$4$5]\").replace(/\\]:\\[/g,\":\");\n\t/* TODO: something other than this */\n\treturn o.replace(/;/g, \"|\").replace(/,/g,\";\");\n}\n\nfunction ods_to_csf_3D(r/*:string*/)/*:[string, string]*/ {\n\tvar a = r.split(\":\");\n\tvar s = a[0].split(\".\")[0];\n\treturn [s, a[0].split(\".\")[1] + (a.length > 1 ? (\":\" + (a[1].split(\".\")[1] || a[1].split(\".\")[0])) : \"\")];\n}\n\nfunction csf_to_ods_3D(r/*:string*/)/*:string*/ {\n\treturn r.replace(/\\./,\"!\");\n}\n\nvar strs = {}; // shared strings\nvar _ssfopts = {}; // spreadsheet formatting options\n\n\n/*global Map */\nvar browser_has_Map = typeof Map !== 'undefined';\n\nfunction get_sst_id(sst/*:SST*/, str/*:string*/, rev)/*:number*/ {\n\tvar i = 0, len = sst.length;\n\tif(rev) {\n\t\tif(browser_has_Map ? rev.has(str) : Object.prototype.hasOwnProperty.call(rev, str)) {\n\t\t\tvar revarr = browser_has_Map ? rev.get(str) : rev[str];\n\t\t\tfor(; i < revarr.length; ++i) {\n\t\t\t\tif(sst[revarr[i]].t === str) { sst.Count ++; return revarr[i]; }\n\t\t\t}\n\t\t}\n\t} else for(; i < len; ++i) {\n\t\tif(sst[i].t === str) { sst.Count ++; return i; }\n\t}\n\tsst[len] = ({t:str}/*:any*/); sst.Count ++; sst.Unique ++;\n\tif(rev) {\n\t\tif(browser_has_Map) {\n\t\t\tif(!rev.has(str)) rev.set(str, []);\n\t\t\trev.get(str).push(len);\n\t\t} else {\n\t\t\tif(!Object.prototype.hasOwnProperty.call(rev, str)) rev[str] = [];\n\t\t\trev[str].push(len);\n\t\t}\n\t}\n\treturn len;\n}\n\nfunction col_obj_w(C/*:number*/, col) {\n\tvar p = ({min:C+1,max:C+1}/*:any*/);\n\t/* wch (chars), wpx (pixels) */\n\tvar wch = -1;\n\tif(col.MDW) MDW = col.MDW;\n\tif(col.width != null) p.customWidth = 1;\n\telse if(col.wpx != null) wch = px2char(col.wpx);\n\telse if(col.wch != null) wch = col.wch;\n\tif(wch > -1) { p.width = char2width(wch); p.customWidth = 1; }\n\telse if(col.width != null) p.width = col.width;\n\tif(col.hidden) p.hidden = true;\n\tif(col.level != null) { p.outlineLevel = p.level = col.level; }\n\treturn p;\n}\n\nfunction default_margins(margins/*:Margins*/, mode/*:?string*/) {\n\tif(!margins) return;\n\tvar defs = [0.7, 0.7, 0.75, 0.75, 0.3, 0.3];\n\tif(mode == 'xlml') defs = [1, 1, 1, 1, 0.5, 0.5];\n\tif(margins.left   == null) margins.left   = defs[0];\n\tif(margins.right  == null) margins.right  = defs[1];\n\tif(margins.top    == null) margins.top    = defs[2];\n\tif(margins.bottom == null) margins.bottom = defs[3];\n\tif(margins.header == null) margins.header = defs[4];\n\tif(margins.footer == null) margins.footer = defs[5];\n}\n\nfunction get_cell_style(styles/*:Array<any>*/, cell/*:Cell*/, opts) {\n\tvar z = opts.revssf[cell.z != null ? cell.z : \"General\"];\n\tvar i = 0x3c, len = styles.length;\n\tif(z == null && opts.ssf) {\n\t\tfor(; i < 0x188; ++i) if(opts.ssf[i] == null) {\n\t\t\tSSF_load(cell.z, i);\n\t\t\t// $FlowIgnore\n\t\t\topts.ssf[i] = cell.z;\n\t\t\topts.revssf[cell.z] = z = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(i = 0; i != len; ++i) if(styles[i].numFmtId === z) return i;\n\tstyles[len] = {\n\t\tnumFmtId:z,\n\t\tfontId:0,\n\t\tfillId:0,\n\t\tborderId:0,\n\t\txfId:0,\n\t\tapplyNumberFormat:1\n\t};\n\treturn len;\n}\n\nfunction safe_format(p/*:Cell*/, fmtid/*:number*/, fillid/*:?number*/, opts, themes, styles) {\n\ttry {\n\t\tif(opts.cellNF) p.z = table_fmt[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(p.t === 'z' && !opts.cellStyles) return;\n\tif(p.t === 'd' && typeof p.v === 'string') p.v = parseDate(p.v);\n\tif((!opts || opts.cellText !== false) && p.t !== 'z') try {\n\t\tif(table_fmt[fmtid] == null) SSF_load(SSFImplicit[fmtid] || \"General\", fmtid);\n\t\tif(p.t === 'e') p.w = p.w || BErr[p.v];\n\t\telse if(fmtid === 0) {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = p.v.toString(10);\n\t\t\t\telse p.w = SSF_general_num(p.v);\n\t\t\t}\n\t\t\telse if(p.t === 'd') {\n\t\t\t\tvar dd = datenum(p.v);\n\t\t\t\tif((dd|0) === dd) p.w = dd.toString(10);\n\t\t\t\telse p.w = SSF_general_num(dd);\n\t\t\t}\n\t\t\telse if(p.v === undefined) return \"\";\n\t\t\telse p.w = SSF_general(p.v,_ssfopts);\n\t\t}\n\t\telse if(p.t === 'd') p.w = SSF_format(fmtid,datenum(p.v),_ssfopts);\n\t\telse p.w = SSF_format(fmtid,p.v,_ssfopts);\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(!opts.cellStyles) return;\n\tif(fillid != null) try {\n\t\tp.s = styles.Fills[fillid];\n\t\tif (p.s.fgColor && p.s.fgColor.theme && !p.s.fgColor.rgb) {\n\t\t\tp.s.fgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.fgColor.theme].rgb, p.s.fgColor.tint || 0);\n\t\t\tif(opts.WTF) p.s.fgColor.raw_rgb = themes.themeElements.clrScheme[p.s.fgColor.theme].rgb;\n\t\t}\n\t\tif (p.s.bgColor && p.s.bgColor.theme) {\n\t\t\tp.s.bgColor.rgb = rgb_tint(themes.themeElements.clrScheme[p.s.bgColor.theme].rgb, p.s.bgColor.tint || 0);\n\t\t\tif(opts.WTF) p.s.bgColor.raw_rgb = themes.themeElements.clrScheme[p.s.bgColor.theme].rgb;\n\t\t}\n\t} catch(e) { if(opts.WTF && styles.Fills) throw e; }\n}\n\nfunction check_ws(ws/*:Worksheet*/, sname/*:string*/, i/*:number*/) {\n\tif(ws && ws['!ref']) {\n\t\tvar range = safe_decode_range(ws['!ref']);\n\t\tif(range.e.c < range.s.c || range.e.r < range.s.r) throw new Error(\"Bad range (\" + i + \"): \" + ws['!ref']);\n\t}\n}\nfunction parse_ws_xml_dim(ws/*:Worksheet*/, s/*:string*/) {\n\tvar d = safe_decode_range(s);\n\tif(d.s.r<=d.e.r && d.s.c<=d.e.c && d.s.r>=0 && d.s.c>=0) ws[\"!ref\"] = encode_range(d);\n}\nvar mergecregex = /<(?:\\w:)?mergeCell ref=\"[A-Z0-9:]+\"\\s*[\\/]?>/g;\nvar sheetdataregex = /<(?:\\w+:)?sheetData[^>]*>([\\s\\S]*)<\\/(?:\\w+:)?sheetData>/;\nvar hlinkregex = /<(?:\\w:)?hyperlink [^>]*>/mg;\nvar dimregex = /\"(\\w*:\\w*)\"/;\nvar colregex = /<(?:\\w:)?col\\b[^>]*[\\/]?>/g;\nvar afregex = /<(?:\\w:)?autoFilter[^>]*([\\/]|>([\\s\\S]*)<\\/(?:\\w:)?autoFilter)>/g;\nvar marginregex= /<(?:\\w:)?pageMargins[^>]*\\/>/g;\nvar sheetprregex = /<(?:\\w:)?sheetPr\\b(?:[^>a-z][^>]*)?\\/>/;\nvar sheetprregex2= /<(?:\\w:)?sheetPr[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetPr)>/;\nvar svsregex = /<(?:\\w:)?sheetViews[^>]*(?:[\\/]|>([\\s\\S]*)<\\/(?:\\w:)?sheetViews)>/;\n\n/* 18.3 Worksheets */\nfunction parse_ws_xml(data/*:?string*/, opts, idx/*:number*/, rels, wb/*:WBWBProps*/, themes, styles)/*:Worksheet*/ {\n\tif(!data) return data;\n\tif(!rels) rels = {'!id':{}};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\n\t/* 18.3.1.99 worksheet CT_Worksheet */\n\tvar s = opts.dense ? ([]/*:any*/) : ({}/*:any*/);\n\tvar refguess/*:Range*/ = ({s: {r:2000000, c:2000000}, e: {r:0, c:0} }/*:any*/);\n\n\tvar data1 = \"\", data2 = \"\";\n\tvar mtch/*:?any*/ = data.match(sheetdataregex);\n\tif(mtch) {\n\t\tdata1 = data.slice(0, mtch.index);\n\t\tdata2 = data.slice(mtch.index + mtch[0].length);\n\t} else data1 = data2 = data;\n\n\t/* 18.3.1.82 sheetPr CT_SheetPr */\n\tvar sheetPr = data1.match(sheetprregex);\n\tif(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n\telse if((sheetPr = data1.match(sheetprregex2))) parse_ws_xml_sheetpr2(sheetPr[0], sheetPr[1]||\"\", s, wb, idx, styles, themes);\n\n\t/* 18.3.1.35 dimension CT_SheetDimension */\n\tvar ridx = (data1.match(/<(?:\\w*:)?dimension/)||{index:-1}).index;\n\tif(ridx > 0) {\n\t\tvar ref = data1.slice(ridx,ridx+50).match(dimregex);\n\t\tif(ref) parse_ws_xml_dim(s, ref[1]);\n\t}\n\n\t/* 18.3.1.88 sheetViews CT_SheetViews */\n\tvar svs = data1.match(svsregex);\n\tif(svs && svs[1]) parse_ws_xml_sheetviews(svs[1], wb);\n\n\t/* 18.3.1.17 cols CT_Cols */\n\tvar columns/*:Array<ColInfo>*/ = [];\n\tif(opts.cellStyles) {\n\t\t/* 18.3.1.13 col CT_Col */\n\t\tvar cols = data1.match(colregex);\n\t\tif(cols) parse_ws_xml_cols(columns, cols);\n\t}\n\n\t/* 18.3.1.80 sheetData CT_SheetData ? */\n\tif(mtch) parse_ws_xml_data(mtch[1], s, opts, refguess, themes, styles);\n\n\t/* 18.3.1.2  autoFilter CT_AutoFilter */\n\tvar afilter = data2.match(afregex);\n\tif(afilter) s['!autofilter'] = parse_ws_xml_autofilter(afilter[0]);\n\n\t/* 18.3.1.55 mergeCells CT_MergeCells */\n\tvar merges/*:Array<Range>*/ = [];\n\tvar _merge = data2.match(mergecregex);\n\tif(_merge) for(ridx = 0; ridx != _merge.length; ++ridx)\n\t\tmerges[ridx] = safe_decode_range(_merge[ridx].slice(_merge[ridx].indexOf(\"\\\"\")+1));\n\n\t/* 18.3.1.48 hyperlinks CT_Hyperlinks */\n\tvar hlink = data2.match(hlinkregex);\n\tif(hlink) parse_ws_xml_hlinks(s, hlink, rels);\n\n\t/* 18.3.1.62 pageMargins CT_PageMargins */\n\tvar margins = data2.match(marginregex);\n\tif(margins) s['!margins'] = parse_ws_xml_margins(parsexmltag(margins[0]));\n\n\tif(!s[\"!ref\"] && refguess.e.c >= refguess.s.c && refguess.e.r >= refguess.s.r) s[\"!ref\"] = encode_range(refguess);\n\tif(opts.sheetRows > 0 && s[\"!ref\"]) {\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif(opts.sheetRows <= +tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif(columns.length > 0) s[\"!cols\"] = columns;\n\tif(merges.length > 0) s[\"!merges\"] = merges;\n\treturn s;\n}\n\nfunction write_ws_xml_merges(merges/*:Array<Range>*/)/*:string*/ {\n\tif(merges.length === 0) return \"\";\n\tvar o = '<mergeCells count=\"' + merges.length + '\">';\n\tfor(var i = 0; i != merges.length; ++i) o += '<mergeCell ref=\"' + encode_range(merges[i]) + '\"/>';\n\treturn o + '</mergeCells>';\n}\n\n/* 18.3.1.82-3 sheetPr CT_ChartsheetPr / CT_SheetPr */\nfunction parse_ws_xml_sheetpr(sheetPr/*:string*/, s, wb/*:WBWBProps*/, idx/*:number*/) {\n\tvar data = parsexmltag(sheetPr);\n\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\tif(data.codeName) wb.Sheets[idx].CodeName = unescapexml(utf8read(data.codeName));\n}\nfunction parse_ws_xml_sheetpr2(sheetPr/*:string*/, body/*:string*/, s, wb/*:WBWBProps*/, idx/*:number*/) {\n\tparse_ws_xml_sheetpr(sheetPr.slice(0, sheetPr.indexOf(\">\")), s, wb, idx);\n}\nfunction write_ws_xml_sheetpr(ws, wb, idx, opts, o) {\n\tvar needed = false;\n\tvar props = {}, payload = null;\n\tif(opts.bookType !== 'xlsx' && wb.vbaraw) {\n\t\tvar cname = wb.SheetNames[idx];\n\t\ttry { if(wb.Workbook) cname = wb.Workbook.Sheets[idx].CodeName || cname; } catch(e) {}\n\t\tneeded = true;\n\t\tprops.codeName = utf8write(escapexml(cname));\n\t}\n\n\tif(ws && ws[\"!outline\"]) {\n\t\tvar outlineprops = {summaryBelow:1, summaryRight:1};\n\t\tif(ws[\"!outline\"].above) outlineprops.summaryBelow = 0;\n\t\tif(ws[\"!outline\"].left) outlineprops.summaryRight = 0;\n\t\tpayload = (payload||\"\") + writextag('outlinePr', null, outlineprops);\n\t}\n\n\tif(!needed && !payload) return;\n\to[o.length] = (writextag('sheetPr', payload, props));\n}\n\n/* 18.3.1.85 sheetProtection CT_SheetProtection */\nvar sheetprot_deffalse = [\"objects\", \"scenarios\", \"selectLockedCells\", \"selectUnlockedCells\"];\nvar sheetprot_deftrue = [\n\t\"formatColumns\", \"formatRows\", \"formatCells\",\n\t\"insertColumns\", \"insertRows\", \"insertHyperlinks\",\n\t\"deleteColumns\", \"deleteRows\",\n\t\"sort\", \"autoFilter\", \"pivotTables\"\n];\nfunction write_ws_xml_protection(sp)/*:string*/ {\n\t// algorithmName, hashValue, saltValue, spinCount\n\tvar o = ({sheet:1}/*:any*/);\n\tsheetprot_deffalse.forEach(function(n) { if(sp[n] != null && sp[n]) o[n] = \"1\"; });\n\tsheetprot_deftrue.forEach(function(n) { if(sp[n] != null && !sp[n]) o[n] = \"0\"; });\n\t/* TODO: algorithm */\n\tif(sp.password) o.password = crypto_CreatePasswordVerifier_Method1(sp.password).toString(16).toUpperCase();\n\treturn writextag('sheetProtection', null, o);\n}\n\nfunction parse_ws_xml_hlinks(s, data/*:Array<string>*/, rels) {\n\tvar dense = Array.isArray(s);\n\tfor(var i = 0; i != data.length; ++i) {\n\t\tvar val = parsexmltag(utf8read(data[i]), true);\n\t\tif(!val.ref) return;\n\t\tvar rel = ((rels || {})['!id']||[])[val.id];\n\t\tif(rel) {\n\t\t\tval.Target = rel.Target;\n\t\t\tif(val.location) val.Target += \"#\"+unescapexml(val.location);\n\t\t} else {\n\t\t\tval.Target = \"#\" + unescapexml(val.location);\n\t\t\trel = {Target: val.Target, TargetMode: 'Internal'};\n\t\t}\n\t\tval.Rel = rel;\n\t\tif(val.tooltip) { val.Tooltip = val.tooltip; delete val.tooltip; }\n\t\tvar rng = safe_decode_range(val.ref);\n\t\tfor(var R=rng.s.r;R<=rng.e.r;++R) for(var C=rng.s.c;C<=rng.e.c;++C) {\n\t\t\tvar addr = encode_cell({c:C,r:R});\n\t\t\tif(dense) {\n\t\t\t\tif(!s[R]) s[R] = [];\n\t\t\t\tif(!s[R][C]) s[R][C] = {t:\"z\",v:undefined};\n\t\t\t\ts[R][C].l = val;\n\t\t\t} else {\n\t\t\t\tif(!s[addr]) s[addr] = {t:\"z\",v:undefined};\n\t\t\t\ts[addr].l = val;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction parse_ws_xml_margins(margin) {\n\tvar o = {};\n\t[\"left\", \"right\", \"top\", \"bottom\", \"header\", \"footer\"].forEach(function(k) {\n\t\tif(margin[k]) o[k] = parseFloat(margin[k]);\n\t});\n\treturn o;\n}\nfunction write_ws_xml_margins(margin)/*:string*/ {\n\tdefault_margins(margin);\n\treturn writextag('pageMargins', null, margin);\n}\n\nfunction parse_ws_xml_cols(columns, cols) {\n\tvar seencol = false;\n\tfor(var coli = 0; coli != cols.length; ++coli) {\n\t\tvar coll = parsexmltag(cols[coli], true);\n\t\tif(coll.hidden) coll.hidden = parsexmlbool(coll.hidden);\n\t\tvar colm=parseInt(coll.min, 10)-1, colM=parseInt(coll.max,10)-1;\n\t\tif(coll.outlineLevel) coll.level = (+coll.outlineLevel || 0);\n\t\tdelete coll.min; delete coll.max; coll.width = +coll.width;\n\t\tif(!seencol && coll.width) { seencol = true; find_mdw_colw(coll.width); }\n\t\tprocess_col(coll);\n\t\twhile(colm <= colM) columns[colm++] = dup(coll);\n\t}\n}\nfunction write_ws_xml_cols(ws, cols)/*:string*/ {\n\tvar o = [\"<cols>\"], col;\n\tfor(var i = 0; i != cols.length; ++i) {\n\t\tif(!(col = cols[i])) continue;\n\t\to[o.length] = (writextag('col', null, col_obj_w(i, col)));\n\t}\n\to[o.length] = \"</cols>\";\n\treturn o.join(\"\");\n}\n\nfunction parse_ws_xml_autofilter(data/*:string*/) {\n\tvar o = { ref: (data.match(/ref=\"([^\"]*)\"/)||[])[1]};\n\treturn o;\n}\nfunction write_ws_xml_autofilter(data, ws, wb, idx)/*:string*/ {\n\tvar ref = typeof data.ref == \"string\" ? data.ref : encode_range(data.ref);\n\tif(!wb.Workbook) wb.Workbook = ({Sheets:[]}/*:any*/);\n\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\tvar names/*: Array<any> */ = wb.Workbook.Names;\n\tvar range = decode_range(ref);\n\tif(range.s.r == range.e.r) { range.e.r = decode_range(ws[\"!ref\"]).e.r; ref = encode_range(range); }\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar name = names[i];\n\t\tif(name.Name != '_xlnm._FilterDatabase') continue;\n\t\tif(name.Sheet != idx) continue;\n\t\tname.Ref = \"'\" + wb.SheetNames[idx] + \"'!\" + ref; break;\n\t}\n\tif(i == names.length) names.push({ Name: '_xlnm._FilterDatabase', Sheet: idx, Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref  });\n\treturn writextag(\"autoFilter\", null, {ref:ref});\n}\n\n/* 18.3.1.88 sheetViews CT_SheetViews */\n/* 18.3.1.87 sheetView CT_SheetView */\nvar sviewregex = /<(?:\\w:)?sheetView(?:[^>a-z][^>]*)?\\/?>/;\nfunction parse_ws_xml_sheetviews(data, wb/*:WBWBProps*/) {\n\tif(!wb.Views) wb.Views = [{}];\n\t(data.match(sviewregex)||[]).forEach(function(r/*:string*/, i/*:number*/) {\n\t\tvar tag = parsexmltag(r);\n\t\t// $FlowIgnore\n\t\tif(!wb.Views[i]) wb.Views[i] = {};\n\t\t// $FlowIgnore\n\t\tif(+tag.zoomScale) wb.Views[i].zoom = +tag.zoomScale;\n\t\t// $FlowIgnore\n\t\tif(parsexmlbool(tag.rightToLeft)) wb.Views[i].RTL = true;\n\t});\n}\nfunction write_ws_xml_sheetviews(ws, opts, idx, wb)/*:string*/ {\n\tvar sview = ({workbookViewId:\"0\"}/*:any*/);\n\t// $FlowIgnore\n\tif((((wb||{}).Workbook||{}).Views||[])[0]) sview.rightToLeft = wb.Workbook.Views[0].RTL ? \"1\" : \"0\";\n\treturn writextag(\"sheetViews\", writextag(\"sheetView\", null, sview), {});\n}\n\nfunction write_ws_xml_cell(cell/*:Cell*/, ref, ws, opts/*::, idx, wb*/)/*:string*/ {\n\tif(cell.c) ws['!comments'].push([ref, cell.c]);\n\tif(cell.v === undefined && typeof cell.f !== \"string\" || cell.t === 'z' && !cell.f) return \"\";\n\tvar vv = \"\";\n\tvar oldt = cell.t, oldv = cell.v;\n\tif(cell.t !== \"z\") switch(cell.t) {\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\n\t\tcase 'n': vv = ''+cell.v; break;\n\t\tcase 'e': vv = BErr[cell.v]; break;\n\t\tcase 'd':\n\t\t\tif(opts && opts.cellDates) vv = parseDate(cell.v, -1).toISOString();\n\t\t\telse {\n\t\t\t\tcell = dup(cell);\n\t\t\t\tcell.t = 'n';\n\t\t\t\tvv = ''+(cell.v = datenum(parseDate(cell.v)));\n\t\t\t}\n\t\t\tif(typeof cell.z === 'undefined') cell.z = table_fmt[14];\n\t\t\tbreak;\n\t\tdefault: vv = cell.v; break;\n\t}\n\tvar v = writetag('v', escapexml(vv)), o = ({r:ref}/*:any*/);\n\t/* TODO: cell style */\n\tvar os = get_cell_style(opts.cellXfs, cell, opts);\n\tif(os !== 0) o.s = os;\n\tswitch(cell.t) {\n\t\tcase 'n': break;\n\t\tcase 'd': o.t = \"d\"; break;\n\t\tcase 'b': o.t = \"b\"; break;\n\t\tcase 'e': o.t = \"e\"; break;\n\t\tcase 'z': break;\n\t\tdefault: if(cell.v == null) { delete cell.t; break; }\n\t\t\tif(cell.v.length > 32767) throw new Error(\"Text length must not exceed 32767 characters\");\n\t\t\tif(opts && opts.bookSST) {\n\t\t\t\tv = writetag('v', ''+get_sst_id(opts.Strings, cell.v, opts.revStrings));\n\t\t\t\to.t = \"s\"; break;\n\t\t\t}\n\t\t\to.t = \"str\"; break;\n\t}\n\tif(cell.t != oldt) { cell.t = oldt; cell.v = oldv; }\n\tif(typeof cell.f == \"string\" && cell.f) {\n\t\tvar ff = cell.F && cell.F.slice(0, ref.length) == ref ? {t:\"array\", ref:cell.F} : null;\n\t\tv = writextag('f', escapexml(cell.f), ff) + (cell.v != null ? v : \"\");\n\t}\n\tif(cell.l) ws['!links'].push([ref, cell.l]);\n\tif(cell.D) o.cm = 1;\n\treturn writextag('c', v, o);\n}\n\nvar parse_ws_xml_data = /*#__PURE__*/(function() {\n\tvar cellregex = /<(?:\\w+:)?c[ \\/>]/, rowregex = /<\\/(?:\\w+:)?row>/;\n\tvar rregex = /r=[\"']([^\"']*)[\"']/, isregex = /<(?:\\w+:)?is>([\\S\\s]*?)<\\/(?:\\w+:)?is>/;\n\tvar refregex = /ref=[\"']([^\"']*)[\"']/;\n\tvar match_v = matchtag(\"v\"), match_f = matchtag(\"f\");\n\nreturn function parse_ws_xml_data(sdata/*:string*/, s, opts, guess/*:Range*/, themes, styles) {\n\tvar ri = 0, x = \"\", cells/*:Array<string>*/ = [], cref/*:?Array<string>*/ = [], idx=0, i=0, cc=0, d=\"\", p/*:any*/;\n\tvar tag, tagr = 0, tagc = 0;\n\tvar sstr, ftag;\n\tvar fmtid = 0, fillid = 0;\n\tvar do_format = Array.isArray(styles.CellXf), cf;\n\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\tvar sharedf = [];\n\tvar dense = Array.isArray(s);\n\tvar rows/*:Array<RowInfo>*/ = [], rowobj = {}, rowrite = false;\n\tvar sheetStubs = !!opts.sheetStubs;\n\tfor(var marr = sdata.split(rowregex), mt = 0, marrlen = marr.length; mt != marrlen; ++mt) {\n\t\tx = marr[mt].trim();\n\t\tvar xlen = x.length;\n\t\tif(xlen === 0) continue;\n\n\t\t/* 18.3.1.73 row CT_Row */\n\t\tvar rstarti = 0;\n\t\touta: for(ri = 0; ri < xlen; ++ri) switch(/*x.charCodeAt(ri)*/x[ri]) {\n\t\t\tcase \">\" /*62*/:\n\t\t\t\tif(/*x.charCodeAt(ri-1) != 47*/x[ri-1] != \"/\") { ++ri; break outa; }\n\t\t\t\tif(opts && opts.cellStyles) {\n\t\t\t\t\t// TODO: avoid duplication\n\t\t\t\t\ttag = parsexmltag(x.slice(rstarti,ri), true);\n\t\t\t\t\ttagr = tag.r != null ? parseInt(tag.r, 10) : tagr+1; tagc = -1;\n\t\t\t\t\tif(opts.sheetRows && opts.sheetRows < tagr) continue;\n\t\t\t\t\trowobj = {}; rowrite = false;\n\t\t\t\t\tif(tag.ht) { rowrite = true; rowobj.hpt = parseFloat(tag.ht); rowobj.hpx = pt2px(rowobj.hpt); }\n\t\t\t\t\tif(tag.hidden == \"1\") { rowrite = true; rowobj.hidden = true; }\n\t\t\t\t\tif(tag.outlineLevel != null) { rowrite = true; rowobj.level = +tag.outlineLevel; }\n\t\t\t\t\tif(rowrite) rows[tagr-1] = rowobj;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"<\" /*60*/: rstarti = ri; break;\n\t\t}\n\t\tif(rstarti >= ri) break;\n\t\ttag = parsexmltag(x.slice(rstarti,ri), true);\n\t\ttagr = tag.r != null ? parseInt(tag.r, 10) : tagr+1; tagc = -1;\n\t\tif(opts.sheetRows && opts.sheetRows < tagr) continue;\n\t\tif(guess.s.r > tagr - 1) guess.s.r = tagr - 1;\n\t\tif(guess.e.r < tagr - 1) guess.e.r = tagr - 1;\n\n\t\tif(opts && opts.cellStyles) {\n\t\t\trowobj = {}; rowrite = false;\n\t\t\tif(tag.ht) { rowrite = true; rowobj.hpt = parseFloat(tag.ht); rowobj.hpx = pt2px(rowobj.hpt); }\n\t\t\tif(tag.hidden == \"1\") { rowrite = true; rowobj.hidden = true; }\n\t\t\tif(tag.outlineLevel != null) { rowrite = true; rowobj.level = +tag.outlineLevel; }\n\t\t\tif(rowrite) rows[tagr-1] = rowobj;\n\t\t}\n\n\t\t/* 18.3.1.4 c CT_Cell */\n\t\tcells = x.slice(ri).split(cellregex);\n\t\tfor(var rslice = 0; rslice != cells.length; ++rslice) if(cells[rslice].trim().charAt(0) != \"<\") break;\n\t\tcells = cells.slice(rslice);\n\t\tfor(ri = 0; ri != cells.length; ++ri) {\n\t\t\tx = cells[ri].trim();\n\t\t\tif(x.length === 0) continue;\n\t\t\tcref = x.match(rregex); idx = ri; i=0; cc=0;\n\t\t\tx = \"<c \" + (x.slice(0,1)==\"<\"?\">\":\"\") + x;\n\t\t\tif(cref != null && cref.length === 2) {\n\t\t\t\tidx = 0; d=cref[1];\n\t\t\t\tfor(i=0; i != d.length; ++i) {\n\t\t\t\t\tif((cc=d.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\t\t\t\tidx = 26*idx + cc;\n\t\t\t\t}\n\t\t\t\t--idx;\n\t\t\t\ttagc = idx;\n\t\t\t} else ++tagc;\n\t\t\tfor(i = 0; i != x.length; ++i) if(x.charCodeAt(i) === 62) break; ++i;\n\t\t\ttag = parsexmltag(x.slice(0,i), true);\n\t\t\tif(!tag.r) tag.r = encode_cell({r:tagr-1, c:tagc});\n\t\t\td = x.slice(i);\n\t\t\tp = ({t:\"\"}/*:any*/);\n\n\t\t\tif((cref=d.match(match_v))!= null && /*::cref != null && */cref[1] !== '') p.v=unescapexml(cref[1]);\n\t\t\tif(opts.cellFormula) {\n\t\t\t\tif((cref=d.match(match_f))!= null && /*::cref != null && */cref[1] !== '') {\n\t\t\t\t\t/* TODO: match against XLSXFutureFunctions */\n\t\t\t\t\tp.f=unescapexml(utf8read(cref[1])).replace(/\\r\\n/g, \"\\n\");\n\t\t\t\t\tif(!opts.xlfn) p.f = _xlfn(p.f);\n\t\t\t\t\tif(/*::cref != null && cref[0] != null && */cref[0].indexOf('t=\"array\"') > -1) {\n\t\t\t\t\t\tp.F = (d.match(refregex)||[])[1];\n\t\t\t\t\t\tif(p.F.indexOf(\":\") > -1) arrayf.push([safe_decode_range(p.F), p.F]);\n\t\t\t\t\t} else if(/*::cref != null && cref[0] != null && */cref[0].indexOf('t=\"shared\"') > -1) {\n\t\t\t\t\t\t// TODO: parse formula\n\t\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\t\tvar ___f = unescapexml(utf8read(cref[1]));\n\t\t\t\t\t\tif(!opts.xlfn) ___f = _xlfn(___f);\n\t\t\t\t\t\tsharedf[parseInt(ftag.si, 10)] = [ftag, ___f, tag.r];\n\t\t\t\t\t}\n\t\t\t\t} else if((cref=d.match(/<f[^>]*\\/>/))) {\n\t\t\t\t\tftag = parsexmltag(cref[0]);\n\t\t\t\t\tif(sharedf[ftag.si]) p.f = shift_formula_xlsx(sharedf[ftag.si][1], sharedf[ftag.si][2]/*[0].ref*/, tag.r);\n\t\t\t\t}\n\t\t\t\t/* TODO: factor out contains logic */\n\t\t\t\tvar _tag = decode_cell(tag.r);\n\t\t\t\tfor(i = 0; i < arrayf.length; ++i)\n\t\t\t\t\tif(_tag.r >= arrayf[i][0].s.r && _tag.r <= arrayf[i][0].e.r)\n\t\t\t\t\t\tif(_tag.c >= arrayf[i][0].s.c && _tag.c <= arrayf[i][0].e.c)\n\t\t\t\t\t\t\tp.F = arrayf[i][1];\n\t\t\t}\n\n\t\t\tif(tag.t == null && p.v === undefined) {\n\t\t\t\tif(p.f || p.F) {\n\t\t\t\t\tp.v = 0; p.t = \"n\";\n\t\t\t\t} else if(!sheetStubs) continue;\n\t\t\t\telse p.t = \"z\";\n\t\t\t}\n\t\t\telse p.t = tag.t || \"n\";\n\t\t\tif(guess.s.c > tagc) guess.s.c = tagc;\n\t\t\tif(guess.e.c < tagc) guess.e.c = tagc;\n\t\t\t/* 18.18.11 t ST_CellType */\n\t\t\tswitch(p.t) {\n\t\t\t\tcase 'n':\n\t\t\t\t\tif(p.v == \"\" || p.v == null) {\n\t\t\t\t\t\tif(!sheetStubs) continue;\n\t\t\t\t\t\tp.t = 'z';\n\t\t\t\t\t} else p.v = parseFloat(p.v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 's':\n\t\t\t\t\tif(typeof p.v == 'undefined') {\n\t\t\t\t\t\tif(!sheetStubs) continue;\n\t\t\t\t\t\tp.t = 'z';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsstr = strs[parseInt(p.v, 10)];\n\t\t\t\t\t\tp.v = sstr.t;\n\t\t\t\t\t\tp.r = sstr.r;\n\t\t\t\t\t\tif(opts.cellHTML) p.h = sstr.h;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'str':\n\t\t\t\t\tp.t = \"s\";\n\t\t\t\t\tp.v = (p.v!=null) ? utf8read(p.v) : '';\n\t\t\t\t\tif(opts.cellHTML) p.h = escapehtml(p.v);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'inlineStr':\n\t\t\t\t\tcref = d.match(isregex);\n\t\t\t\t\tp.t = 's';\n\t\t\t\t\tif(cref != null && (sstr = parse_si(cref[1]))) {\n\t\t\t\t\t\tp.v = sstr.t;\n\t\t\t\t\t\tif(opts.cellHTML) p.h = sstr.h;\n\t\t\t\t\t} else p.v = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'b': p.v = parsexmlbool(p.v); break;\n\t\t\t\tcase 'd':\n\t\t\t\t\tif(opts.cellDates) p.v = parseDate(p.v, 1);\n\t\t\t\t\telse { p.v = datenum(parseDate(p.v, 1)); p.t = 'n'; }\n\t\t\t\t\tbreak;\n\t\t\t\t/* error string in .w, number in .v */\n\t\t\t\tcase 'e':\n\t\t\t\t\tif(!opts || opts.cellText !== false) p.w = p.v;\n\t\t\t\t\tp.v = RBErr[p.v]; break;\n\t\t\t}\n\t\t\t/* formatting */\n\t\t\tfmtid = fillid = 0;\n\t\t\tcf = null;\n\t\t\tif(do_format && tag.s !== undefined) {\n\t\t\t\tcf = styles.CellXf[tag.s];\n\t\t\t\tif(cf != null) {\n\t\t\t\t\tif(cf.numFmtId != null) fmtid = cf.numFmtId;\n\t\t\t\t\tif(opts.cellStyles) {\n\t\t\t\t\t\tif(cf.fillId != null) fillid = cf.fillId;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tsafe_format(p, fmtid, fillid, opts, themes, styles);\n\t\t\tif(opts.cellDates && do_format && p.t == 'n' && fmt_is_date(table_fmt[fmtid])) { p.t = 'd'; p.v = numdate(p.v); }\n\t\t\tif(tag.cm && opts.xlmeta) {\n\t\t\t\tvar cm = (opts.xlmeta.Cell||[])[+tag.cm-1];\n\t\t\t\tif(cm && cm.type == 'XLDAPR') p.D = true;\n\t\t\t}\n\t\t\tif(dense) {\n\t\t\t\tvar _r = decode_cell(tag.r);\n\t\t\t\tif(!s[_r.r]) s[_r.r] = [];\n\t\t\t\ts[_r.r][_r.c] = p;\n\t\t\t} else s[tag.r] = p;\n\t\t}\n\t}\n\tif(rows.length > 0) s['!rows'] = rows;\n}; })();\n\nfunction write_ws_xml_data(ws/*:Worksheet*/, opts, idx/*:number*/, wb/*:Workbook*//*::, rels*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [], r/*:Array<string>*/ = [], range = safe_decode_range(ws['!ref']), cell=\"\", ref, rr = \"\", cols/*:Array<string>*/ = [], R=0, C=0, rows = ws['!rows'];\n\tvar dense = Array.isArray(ws);\n\tvar params = ({r:rr}/*:any*/), row/*:RowInfo*/, height = -1;\n\tfor(C = range.s.c; C <= range.e.c; ++C) cols[C] = encode_col(C);\n\tfor(R = range.s.r; R <= range.e.r; ++R) {\n\t\tr = [];\n\t\trr = encode_row(R);\n\t\tfor(C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tref = cols[C] + rr;\n\t\t\tvar _cell = dense ? (ws[R]||[])[C]: ws[ref];\n\t\t\tif(_cell === undefined) continue;\n\t\t\tif((cell = write_ws_xml_cell(_cell, ref, ws, opts, idx, wb)) != null) r.push(cell);\n\t\t}\n\t\tif(r.length > 0 || (rows && rows[R])) {\n\t\t\tparams = ({r:rr}/*:any*/);\n\t\t\tif(rows && rows[R]) {\n\t\t\t\trow = rows[R];\n\t\t\t\tif(row.hidden) params.hidden = 1;\n\t\t\t\theight = -1;\n\t\t\t\tif(row.hpx) height = px2pt(row.hpx);\n\t\t\t\telse if(row.hpt) height = row.hpt;\n\t\t\t\tif(height > -1) { params.ht = height; params.customHeight = 1; }\n\t\t\t\tif(row.level) { params.outlineLevel = row.level; }\n\t\t\t}\n\t\t\to[o.length] = (writextag('row', r.join(\"\"), params));\n\t\t}\n\t}\n\tif(rows) for(; R < rows.length; ++R) {\n\t\tif(rows && rows[R]) {\n\t\t\tparams = ({r:R+1}/*:any*/);\n\t\t\trow = rows[R];\n\t\t\tif(row.hidden) params.hidden = 1;\n\t\t\theight = -1;\n\t\t\tif (row.hpx) height = px2pt(row.hpx);\n\t\t\telse if (row.hpt) height = row.hpt;\n\t\t\tif (height > -1) { params.ht = height; params.customHeight = 1; }\n\t\t\tif (row.level) { params.outlineLevel = row.level; }\n\t\t\to[o.length] = (writextag('row', \"\", params));\n\t\t}\n\t}\n\treturn o.join(\"\");\n}\n\nfunction write_ws_xml(idx/*:number*/, opts, wb/*:Workbook*/, rels)/*:string*/ {\n\tvar o = [XML_HEADER, writextag('worksheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t})];\n\tvar s = wb.SheetNames[idx], sidx = 0, rdata = \"\";\n\tvar ws = wb.Sheets[s];\n\tif(ws == null) ws = {};\n\tvar ref = ws['!ref'] || 'A1';\n\tvar range = safe_decode_range(ref);\n\tif(range.e.c > 0x3FFF || range.e.r > 0xFFFFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + ref + \" exceeds format limit A1:XFD1048576\");\n\t\trange.e.c = Math.min(range.e.c, 0x3FFF);\n\t\trange.e.r = Math.min(range.e.c, 0xFFFFF);\n\t\tref = encode_range(range);\n\t}\n\tif(!rels) rels = {};\n\tws['!comments'] = [];\n\tvar _drawing = [];\n\n\twrite_ws_xml_sheetpr(ws, wb, idx, opts, o);\n\n\to[o.length] = (writextag('dimension', null, {'ref': ref}));\n\n\to[o.length] = write_ws_xml_sheetviews(ws, opts, idx, wb);\n\n\t/* TODO: store in WB, process styles */\n\tif(opts.sheetFormat) o[o.length] = (writextag('sheetFormatPr', null, {\n\t\tdefaultRowHeight:opts.sheetFormat.defaultRowHeight||'16',\n\t\tbaseColWidth:opts.sheetFormat.baseColWidth||'10',\n\t\toutlineLevelRow:opts.sheetFormat.outlineLevelRow||'7'\n\t}));\n\n\tif(ws['!cols'] != null && ws['!cols'].length > 0) o[o.length] = (write_ws_xml_cols(ws, ws['!cols']));\n\n\to[sidx = o.length] = '<sheetData/>';\n\tws['!links'] = [];\n\tif(ws['!ref'] != null) {\n\t\trdata = write_ws_xml_data(ws, opts, idx, wb, rels);\n\t\tif(rdata.length > 0) o[o.length] = (rdata);\n\t}\n\tif(o.length>sidx+1) { o[o.length] = ('</sheetData>'); o[sidx]=o[sidx].replace(\"/>\",\">\"); }\n\n\t/* sheetCalcPr */\n\n\tif(ws['!protect']) o[o.length] = write_ws_xml_protection(ws['!protect']);\n\n\t/* protectedRanges */\n\t/* scenarios */\n\n\tif(ws['!autofilter'] != null) o[o.length] = write_ws_xml_autofilter(ws['!autofilter'], ws, wb, idx);\n\n\t/* sortState */\n\t/* dataConsolidate */\n\t/* customSheetViews */\n\n\tif(ws['!merges'] != null && ws['!merges'].length > 0) o[o.length] = (write_ws_xml_merges(ws['!merges']));\n\n\t/* phoneticPr */\n\t/* conditionalFormatting */\n\t/* dataValidations */\n\n\tvar relc = -1, rel, rId = -1;\n\tif(/*::(*/ws['!links']/*::||[])*/.length > 0) {\n\t\to[o.length] = \"<hyperlinks>\";\n\t\t/*::(*/ws['!links']/*::||[])*/.forEach(function(l) {\n\t\t\tif(!l[1].Target) return;\n\t\t\trel = ({\"ref\":l[0]}/*:any*/);\n\t\t\tif(l[1].Target.charAt(0) != \"#\") {\n\t\t\t\trId = add_rels(rels, -1, escapexml(l[1].Target).replace(/#.*$/, \"\"), RELS.HLINK);\n\t\t\t\trel[\"r:id\"] = \"rId\"+rId;\n\t\t\t}\n\t\t\tif((relc = l[1].Target.indexOf(\"#\")) > -1) rel.location = escapexml(l[1].Target.slice(relc+1));\n\t\t\tif(l[1].Tooltip) rel.tooltip = escapexml(l[1].Tooltip);\n\t\t\to[o.length] = writextag(\"hyperlink\",null,rel);\n\t\t});\n\t\to[o.length] = \"</hyperlinks>\";\n\t}\n\tdelete ws['!links'];\n\n\t/* printOptions */\n\n\tif(ws['!margins'] != null) o[o.length] =  write_ws_xml_margins(ws['!margins']);\n\n\t/* pageSetup */\n\t/* headerFooter */\n\t/* rowBreaks */\n\t/* colBreaks */\n\t/* customProperties */\n\t/* cellWatches */\n\n\tif(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) o[o.length] = writetag(\"ignoredErrors\", writextag(\"ignoredError\", null, {numberStoredAsText:1, sqref:ref}));\n\n\t/* smartTags */\n\n\tif(_drawing.length > 0) {\n\t\trId = add_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\n\t\to[o.length] = writextag(\"drawing\", null, {\"r:id\":\"rId\" + rId});\n\t\tws['!drawing'] = _drawing;\n\t}\n\n\tif(ws['!comments'].length > 0) {\n\t\trId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\n\t\to[o.length] = writextag(\"legacyDrawing\", null, {\"r:id\":\"rId\" + rId});\n\t\tws['!legacy'] = rId;\n\t}\n\n\t/* legacyDrawingHF */\n\t/* picture */\n\t/* oleObjects */\n\t/* controls */\n\t/* webPublishItems */\n\t/* tableParts */\n\t/* extLst */\n\n\tif(o.length>1) { o[o.length] = ('</worksheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSB] 2.4.726 BrtRowHdr */\nfunction parse_BrtRowHdr(data, length) {\n\tvar z = ({}/*:any*/);\n\tvar tgt = data.l + length;\n\tz.r = data.read_shift(4);\n\tdata.l += 4; // TODO: ixfe\n\tvar miyRw = data.read_shift(2);\n\tdata.l += 1; // TODO: top/bot padding\n\tvar flags = data.read_shift(1);\n\tdata.l = tgt;\n\tif(flags & 0x07) z.level = flags & 0x07;\n\tif(flags & 0x10) z.hidden = true;\n\tif(flags & 0x20) z.hpt = miyRw / 20;\n\treturn z;\n}\nfunction write_BrtRowHdr(R/*:number*/, range, ws) {\n\tvar o = new_buf(17+8*16);\n\tvar row = (ws['!rows']||[])[R]||{};\n\to.write_shift(4, R);\n\n\to.write_shift(4, 0); /* TODO: ixfe */\n\n\tvar miyRw = 0x0140;\n\tif(row.hpx) miyRw = px2pt(row.hpx) * 20;\n\telse if(row.hpt) miyRw = row.hpt * 20;\n\to.write_shift(2, miyRw);\n\n\to.write_shift(1, 0); /* top/bot padding */\n\n\tvar flags = 0x0;\n\tif(row.level) flags |= row.level;\n\tif(row.hidden) flags |= 0x10;\n\tif(row.hpx || row.hpt) flags |= 0x20;\n\to.write_shift(1, flags);\n\n\to.write_shift(1, 0); /* phonetic guide */\n\n\t/* [MS-XLSB] 2.5.8 BrtColSpan explains the mechanism */\n\tvar ncolspan = 0, lcs = o.l;\n\to.l += 4;\n\n\tvar caddr = {r:R, c:0};\n\tfor(var i = 0; i < 16; ++i) {\n\t\tif((range.s.c > ((i+1) << 10)) || (range.e.c < (i << 10))) continue;\n\t\tvar first = -1, last = -1;\n\t\tfor(var j = (i<<10); j < ((i+1)<<10); ++j) {\n\t\t\tcaddr.c = j;\n\t\t\tvar cell = Array.isArray(ws) ? (ws[caddr.r]||[])[caddr.c] : ws[encode_cell(caddr)];\n\t\t\tif(cell) { if(first < 0) first = j; last = j; }\n\t\t}\n\t\tif(first < 0) continue;\n\t\t++ncolspan;\n\t\to.write_shift(4, first);\n\t\to.write_shift(4, last);\n\t}\n\n\tvar l = o.l;\n\to.l = lcs;\n\to.write_shift(4, ncolspan);\n\to.l = l;\n\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\nfunction write_row_header(ba, ws, range, R) {\n\tvar o = write_BrtRowHdr(R, range, ws);\n\tif((o.length > 17) || (ws['!rows']||[])[R]) write_record(ba, 0x0000 /* BrtRowHdr */, o);\n}\n\n/* [MS-XLSB] 2.4.820 BrtWsDim */\nvar parse_BrtWsDim = parse_UncheckedRfX;\nvar write_BrtWsDim = write_UncheckedRfX;\n\n/* [MS-XLSB] 2.4.821 BrtWsFmtInfo */\nfunction parse_BrtWsFmtInfo(/*::data, length*/) {\n}\n//function write_BrtWsFmtInfo(ws, o) { }\n\n/* [MS-XLSB] 2.4.823 BrtWsProp */\nfunction parse_BrtWsProp(data, length) {\n\tvar z = {};\n\tvar f = data[data.l]; ++data.l;\n\tz.above = !(f & 0x40);\n\tz.left  = !(f & 0x80);\n\t/* TODO: pull flags */\n\tdata.l += 18;\n\tz.name = parse_XLSBCodeName(data, length - 19);\n\treturn z;\n}\nfunction write_BrtWsProp(str, outl, o) {\n\tif(o == null) o = new_buf(84+4*str.length);\n\tvar f = 0xC0;\n\tif(outl) {\n\t\tif(outl.above) f &= ~0x40;\n\t\tif(outl.left)  f &= ~0x80;\n\t}\n\to.write_shift(1, f);\n\tfor(var i = 1; i < 3; ++i) o.write_shift(1,0);\n\twrite_BrtColor({auto:1}, o);\n\to.write_shift(-4,-1);\n\to.write_shift(-4,-1);\n\twrite_XLSBCodeName(str, o);\n\treturn o.slice(0, o.l);\n}\n\n/* [MS-XLSB] 2.4.306 BrtCellBlank */\nfunction parse_BrtCellBlank(data) {\n\tvar cell = parse_XLSBCell(data);\n\treturn [cell];\n}\nfunction write_BrtCellBlank(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\treturn write_XLSBCell(ncell, o);\n}\nfunction parse_BrtShortBlank(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\treturn [cell];\n}\nfunction write_BrtShortBlank(cell, ncell, o) {\n\tif(o == null) o = new_buf(4);\n\treturn write_XLSBShortCell(ncell, o);\n}\n\n/* [MS-XLSB] 2.4.307 BrtCellBool */\nfunction parse_BrtCellBool(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'b'];\n}\nfunction write_BrtCellBool(cell, ncell, o) {\n\tif(o == null) o = new_buf(9);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(1, cell.v ? 1 : 0);\n\treturn o;\n}\nfunction parse_BrtShortBool(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar fBool = data.read_shift(1);\n\treturn [cell, fBool, 'b'];\n}\nfunction write_BrtShortBool(cell, ncell, o) {\n\tif(o == null) o = new_buf(5);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(1, cell.v ? 1 : 0);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.308 BrtCellError */\nfunction parse_BrtCellError(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar bError = data.read_shift(1);\n\treturn [cell, bError, 'e'];\n}\nfunction write_BrtCellError(cell, ncell, o) {\n\tif(o == null) o = new_buf(9);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(1, cell.v);\n\treturn o;\n}\nfunction parse_BrtShortError(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar bError = data.read_shift(1);\n\treturn [cell, bError, 'e'];\n}\nfunction write_BrtShortError(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(1, cell.v);\n\to.write_shift(2, 0);\n\to.write_shift(1, 0);\n\treturn o;\n}\n\n\n/* [MS-XLSB] 2.4.311 BrtCellIsst */\nfunction parse_BrtCellIsst(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar isst = data.read_shift(4);\n\treturn [cell, isst, 's'];\n}\nfunction write_BrtCellIsst(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBCell(ncell, o);\n\to.write_shift(4, ncell.v);\n\treturn o;\n}\nfunction parse_BrtShortIsst(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar isst = data.read_shift(4);\n\treturn [cell, isst, 's'];\n}\nfunction write_BrtShortIsst(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\to.write_shift(4, ncell.v);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.313 BrtCellReal */\nfunction parse_BrtCellReal(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_Xnum(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtCellReal(cell, ncell, o) {\n\tif(o == null) o = new_buf(16);\n\twrite_XLSBCell(ncell, o);\n\twrite_Xnum(cell.v, o);\n\treturn o;\n}\nfunction parse_BrtShortReal(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_Xnum(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtShortReal(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_Xnum(cell.v, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.314 BrtCellRk */\nfunction parse_BrtCellRk(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_RkNumber(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtCellRk(cell, ncell, o) {\n\tif(o == null) o = new_buf(12);\n\twrite_XLSBCell(ncell, o);\n\twrite_RkNumber(cell.v, o);\n\treturn o;\n}\nfunction parse_BrtShortRk(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_RkNumber(data);\n\treturn [cell, value, 'n'];\n}\nfunction write_BrtShortRk(cell, ncell, o) {\n\tif(o == null) o = new_buf(8);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_RkNumber(cell.v, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.323 BrtCellRString */\nfunction parse_BrtCellRString(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_RichStr(data);\n\treturn [cell, value, 'is'];\n}\n\n/* [MS-XLSB] 2.4.317 BrtCellSt */\nfunction parse_BrtCellSt(data) {\n\tvar cell = parse_XLSBCell(data);\n\tvar value = parse_XLWideString(data);\n\treturn [cell, value, 'str'];\n}\nfunction write_BrtCellSt(cell, ncell, o) {\n\tif(o == null) o = new_buf(12 + 4 * cell.v.length);\n\twrite_XLSBCell(ncell, o);\n\twrite_XLWideString(cell.v, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\nfunction parse_BrtShortSt(data) {\n\tvar cell = parse_XLSBShortCell(data);\n\tvar value = parse_XLWideString(data);\n\treturn [cell, value, 'str'];\n}\nfunction write_BrtShortSt(cell, ncell, o) {\n\tif(o == null) o = new_buf(8 + 4 * cell.v.length);\n\twrite_XLSBShortCell(ncell, o);\n\twrite_XLWideString(cell.v, o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.653 BrtFmlaBool */\nfunction parse_BrtFmlaBool(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'b'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.654 BrtFmlaError */\nfunction parse_BrtFmlaError(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = data.read_shift(1);\n\tvar o = [cell, value, 'e'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.655 BrtFmlaNum */\nfunction parse_BrtFmlaNum(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = parse_Xnum(data);\n\tvar o = [cell, value, 'n'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.656 BrtFmlaString */\nfunction parse_BrtFmlaString(data, length, opts) {\n\tvar end = data.l + length;\n\tvar cell = parse_XLSBCell(data);\n\tcell.r = opts['!row'];\n\tvar value = parse_XLWideString(data);\n\tvar o = [cell, value, 'str'];\n\tif(opts.cellFormula) {\n\t\tdata.l += 2;\n\t\tvar formula = parse_XLSBCellParsedFormula(data, end - data.l, opts);\n\t\to[3] = stringify_formula(formula, null/*range*/, cell, opts.supbooks, opts);/* TODO */\n\t}\n\telse data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.682 BrtMergeCell */\nvar parse_BrtMergeCell = parse_UncheckedRfX;\nvar write_BrtMergeCell = write_UncheckedRfX;\n/* [MS-XLSB] 2.4.107 BrtBeginMergeCells */\nfunction write_BrtBeginMergeCells(cnt, o) {\n\tif(o == null) o = new_buf(4);\n\to.write_shift(4, cnt);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.662 BrtHLink */\nfunction parse_BrtHLink(data, length/*::, opts*/) {\n\tvar end = data.l + length;\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tvar relId = parse_XLNullableWideString(data);\n\tvar loc = parse_XLWideString(data);\n\tvar tooltip = parse_XLWideString(data);\n\tvar display = parse_XLWideString(data);\n\tdata.l = end;\n\tvar o = ({rfx:rfx, relId:relId, loc:loc, display:display}/*:any*/);\n\tif(tooltip) o.Tooltip = tooltip;\n\treturn o;\n}\nfunction write_BrtHLink(l, rId) {\n\tvar o = new_buf(50+4*(l[1].Target.length + (l[1].Tooltip || \"\").length));\n\twrite_UncheckedRfX({s:decode_cell(l[0]), e:decode_cell(l[0])}, o);\n\twrite_RelID(\"rId\" + rId, o);\n\tvar locidx = l[1].Target.indexOf(\"#\");\n\tvar loc = locidx == -1 ? \"\" : l[1].Target.slice(locidx+1);\n\twrite_XLWideString(loc || \"\", o);\n\twrite_XLWideString(l[1].Tooltip || \"\", o);\n\twrite_XLWideString(\"\", o);\n\treturn o.slice(0, o.l);\n}\n\n/* [MS-XLSB] 2.4.692 BrtPane */\nfunction parse_BrtPane(/*data, length, opts*/) {\n}\n\n/* [MS-XLSB] 2.4.6 BrtArrFmla */\nfunction parse_BrtArrFmla(data, length, opts) {\n\tvar end = data.l + length;\n\tvar rfx = parse_RfX(data, 16);\n\tvar fAlwaysCalc = data.read_shift(1);\n\tvar o = [rfx]; o[2] = fAlwaysCalc;\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBArrayParsedFormula(data, end - data.l, opts);\n\t\to[1] = formula;\n\t} else data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.750 BrtShrFmla */\nfunction parse_BrtShrFmla(data, length, opts) {\n\tvar end = data.l + length;\n\tvar rfx = parse_UncheckedRfX(data, 16);\n\tvar o = [rfx];\n\tif(opts.cellFormula) {\n\t\tvar formula = parse_XLSBSharedParsedFormula(data, end - data.l, opts);\n\t\to[1] = formula;\n\t\tdata.l = end;\n\t} else data.l = end;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.323 BrtColInfo */\n/* TODO: once XLS ColInfo is set, combine the functions */\nfunction write_BrtColInfo(C/*:number*/, col, o) {\n\tif(o == null) o = new_buf(18);\n\tvar p = col_obj_w(C, col);\n\to.write_shift(-4, C);\n\to.write_shift(-4, C);\n\to.write_shift(4, (p.width || 10) * 256);\n\to.write_shift(4, 0/*ixfe*/); // style\n\tvar flags = 0;\n\tif(col.hidden) flags |= 0x01;\n\tif(typeof p.width == 'number') flags |= 0x02;\n\tif(col.level) flags |= (col.level << 8);\n\to.write_shift(2, flags); // bit flag\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.678 BrtMargins */\nvar BrtMarginKeys = [\"left\",\"right\",\"top\",\"bottom\",\"header\",\"footer\"];\nfunction parse_BrtMargins(data/*::, length, opts*/)/*:Margins*/ {\n\tvar margins = ({}/*:any*/);\n\tBrtMarginKeys.forEach(function(k) { margins[k] = parse_Xnum(data, 8); });\n\treturn margins;\n}\nfunction write_BrtMargins(margins/*:Margins*/, o) {\n\tif(o == null) o = new_buf(6*8);\n\tdefault_margins(margins);\n\tBrtMarginKeys.forEach(function(k) { write_Xnum((margins/*:any*/)[k], o); });\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.299 BrtBeginWsView */\nfunction parse_BrtBeginWsView(data/*::, length, opts*/) {\n\tvar f = data.read_shift(2);\n\tdata.l += 28;\n\treturn { RTL: f & 0x20 };\n}\nfunction write_BrtBeginWsView(ws, Workbook, o) {\n\tif(o == null) o = new_buf(30);\n\tvar f = 0x39c;\n\tif((((Workbook||{}).Views||[])[0]||{}).RTL) f |= 0x20;\n\to.write_shift(2, f); // bit flag\n\to.write_shift(4, 0);\n\to.write_shift(4, 0); // view first row\n\to.write_shift(4, 0); // view first col\n\to.write_shift(1, 0); // gridline color ICV\n\to.write_shift(1, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 100); // zoom scale\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(2, 0);\n\to.write_shift(4, 0); // workbook view id\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.309 BrtCellIgnoreEC */\nfunction write_BrtCellIgnoreEC(ref) {\n\tvar o = new_buf(24);\n\to.write_shift(4, 4);\n\to.write_shift(4, 1);\n\twrite_UncheckedRfX(ref, o);\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.748 BrtSheetProtection */\nfunction write_BrtSheetProtection(sp, o) {\n\tif(o == null) o = new_buf(16*4+2);\n\to.write_shift(2, sp.password ? crypto_CreatePasswordVerifier_Method1(sp.password) : 0);\n\to.write_shift(4, 1); // this record should not be written if no protection\n\t[\n\t\t[\"objects\",             false], // fObjects\n\t\t[\"scenarios\",           false], // fScenarios\n\t\t[\"formatCells\",          true], // fFormatCells\n\t\t[\"formatColumns\",        true], // fFormatColumns\n\t\t[\"formatRows\",           true], // fFormatRows\n\t\t[\"insertColumns\",        true], // fInsertColumns\n\t\t[\"insertRows\",           true], // fInsertRows\n\t\t[\"insertHyperlinks\",     true], // fInsertHyperlinks\n\t\t[\"deleteColumns\",        true], // fDeleteColumns\n\t\t[\"deleteRows\",           true], // fDeleteRows\n\t\t[\"selectLockedCells\",   false], // fSelLockedCells\n\t\t[\"sort\",                 true], // fSort\n\t\t[\"autoFilter\",           true], // fAutoFilter\n\t\t[\"pivotTables\",          true], // fPivotTables\n\t\t[\"selectUnlockedCells\", false]  // fSelUnlockedCells\n\t].forEach(function(n) {\n\t\t/*:: if(o == null) throw \"unreachable\"; */\n\t\tif(n[1]) o.write_shift(4, sp[n[0]] != null && !sp[n[0]] ? 1 : 0);\n\t\telse      o.write_shift(4, sp[n[0]] != null && sp[n[0]] ? 0 : 1);\n\t});\n\treturn o;\n}\n\nfunction parse_BrtDVal(/*data, length, opts*/) {\n}\nfunction parse_BrtDVal14(/*data, length, opts*/) {\n}\n/* [MS-XLSB] 2.1.7.61 Worksheet */\nfunction parse_ws_bin(data, _opts, idx, rels, wb/*:WBWBProps*/, themes, styles)/*:Worksheet*/ {\n\tif(!data) return data;\n\tvar opts = _opts || {};\n\tif(!rels) rels = {'!id':{}};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar s/*:Worksheet*/ = (opts.dense ? [] : {});\n\n\tvar ref;\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\n\tvar state/*:Array<string>*/ = [];\n\tvar pass = false, end = false;\n\tvar row, p, cf, R, C, addr, sstr, rr, cell/*:Cell*/;\n\tvar merges/*:Array<Range>*/ = [];\n\topts.biff = 12;\n\topts['!row'] = 0;\n\n\tvar ai = 0, af = false;\n\n\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\tvar sharedf = {};\n\tvar supbooks = opts.supbooks || /*::(*/wb/*:: :any)*/.supbooks || ([[]]/*:any*/);\n\tsupbooks.sharedf = sharedf;\n\tsupbooks.arrayf = arrayf;\n\tsupbooks.SheetNames = wb.SheetNames || wb.Sheets.map(function(x) { return x.name; });\n\tif(!opts.supbooks) {\n\t\topts.supbooks = supbooks;\n\t\tif(wb.Names) for(var i = 0; i < wb.Names.length; ++i) supbooks[0][i+1] = wb.Names[i];\n\t}\n\n\tvar colinfo/*:Array<ColInfo>*/ = [], rowinfo/*:Array<RowInfo>*/ = [];\n\tvar seencol = false;\n\n\tXLSBRecordEnum[0x0010] = { n:\"BrtShortReal\", f:parse_BrtShortReal };\n\n\tvar cm, vm;\n\n\trecordhopper(data, function ws_parse(val, RR, RT) {\n\t\tif(end) return;\n\t\tswitch(RT) {\n\t\t\tcase 0x0094: /* 'BrtWsDim' */\n\t\t\t\tref = val; break;\n\t\t\tcase 0x0000: /* 'BrtRowHdr' */\n\t\t\t\trow = val;\n\t\t\t\tif(opts.sheetRows && opts.sheetRows <= row.r) end=true;\n\t\t\t\trr = encode_row(R = row.r);\n\t\t\t\topts['!row'] = row.r;\n\t\t\t\tif(val.hidden || val.hpt || val.level != null) {\n\t\t\t\t\tif(val.hpt) val.hpx = pt2px(val.hpt);\n\t\t\t\t\trowinfo[val.r] = val;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0002: /* 'BrtCellRk' */\n\t\t\tcase 0x0003: /* 'BrtCellError' */\n\t\t\tcase 0x0004: /* 'BrtCellBool' */\n\t\t\tcase 0x0005: /* 'BrtCellReal' */\n\t\t\tcase 0x0006: /* 'BrtCellSt' */\n\t\t\tcase 0x0007: /* 'BrtCellIsst' */\n\t\t\tcase 0x0008: /* 'BrtFmlaString' */\n\t\t\tcase 0x0009: /* 'BrtFmlaNum' */\n\t\t\tcase 0x000A: /* 'BrtFmlaBool' */\n\t\t\tcase 0x000B: /* 'BrtFmlaError' */\n\t\t\tcase 0x000D: /* 'BrtShortRk' */\n\t\t\tcase 0x000E: /* 'BrtShortError' */\n\t\t\tcase 0x000F: /* 'BrtShortBool' */\n\t\t\tcase 0x0010: /* 'BrtShortReal' */\n\t\t\tcase 0x0011: /* 'BrtShortSt' */\n\t\t\tcase 0x0012: /* 'BrtShortIsst' */\n\t\t\tcase 0x003E: /* 'BrtCellRString' */\n\t\t\t\tp = ({t:val[2]}/*:any*/);\n\t\t\t\tswitch(val[2]) {\n\t\t\t\t\tcase 'n': p.v = val[1]; break;\n\t\t\t\t\tcase 's': sstr = strs[val[1]]; p.v = sstr.t; p.r = sstr.r; break;\n\t\t\t\t\tcase 'b': p.v = val[1] ? true : false; break;\n\t\t\t\t\tcase 'e': p.v = val[1]; if(opts.cellText !== false) p.w = BErr[p.v]; break;\n\t\t\t\t\tcase 'str': p.t = 's'; p.v = val[1]; break;\n\t\t\t\t\tcase 'is': p.t = 's'; p.v = val[1].t; break;\n\t\t\t\t}\n\t\t\t\tif((cf = styles.CellXf[val[0].iStyleRef])) safe_format(p,cf.numFmtId,null,opts, themes, styles);\n\t\t\t\tC = val[0].c == -1 ? C + 1 : val[0].c;\n\t\t\t\tif(opts.dense) { if(!s[R]) s[R] = []; s[R][C] = p; }\n\t\t\t\telse s[encode_col(C) + rr] = p;\n\t\t\t\tif(opts.cellFormula) {\n\t\t\t\t\taf = false;\n\t\t\t\t\tfor(ai = 0; ai < arrayf.length; ++ai) {\n\t\t\t\t\t\tvar aii = arrayf[ai];\n\t\t\t\t\t\tif(row.r >= aii[0].s.r && row.r <= aii[0].e.r)\n\t\t\t\t\t\t\tif(C >= aii[0].s.c && C <= aii[0].e.c) {\n\t\t\t\t\t\t\t\tp.F = encode_range(aii[0]); af = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!af && val.length > 3) p.f = val[3];\n\t\t\t\t}\n\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tif(opts.cellDates && cf && p.t == 'n' && fmt_is_date(table_fmt[cf.numFmtId])) {\n\t\t\t\t\tvar _d = SSF_parse_date_code(p.v); if(_d) { p.t = 'd'; p.v = new Date(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u); }\n\t\t\t\t}\n\t\t\t\tif(cm) {\n\t\t\t\t\tif(cm.type == 'XLDAPR') p.D = true;\n\t\t\t\t\tcm = void 0;\n\t\t\t\t}\n\t\t\t\tif(vm) vm = void 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0001: /* 'BrtCellBlank' */\n\t\t\tcase 0x000C: /* 'BrtShortBlank' */\n\t\t\t\tif(!opts.sheetStubs || pass) break;\n\t\t\t\tp = ({t:'z',v:void 0}/*:any*/);\n\t\t\t\tC = val[0].c == -1 ? C + 1 : val[0].c;\n\t\t\t\tif(opts.dense) { if(!s[R]) s[R] = []; s[R][C] = p; }\n\t\t\t\telse s[encode_col(C) + rr] = p;\n\t\t\t\tif(refguess.s.r > row.r) refguess.s.r = row.r;\n\t\t\t\tif(refguess.s.c > C) refguess.s.c = C;\n\t\t\t\tif(refguess.e.r < row.r) refguess.e.r = row.r;\n\t\t\t\tif(refguess.e.c < C) refguess.e.c = C;\n\t\t\t\tif(cm) {\n\t\t\t\t\tif(cm.type == 'XLDAPR') p.D = true;\n\t\t\t\t\tcm = void 0;\n\t\t\t\t}\n\t\t\t\tif(vm) vm = void 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x00B0: /* 'BrtMergeCell' */\n\t\t\t\tmerges.push(val); break;\n\n\t\t\tcase 0x0031: { /* 'BrtCellMeta' */\n\t\t\t\tcm = ((opts.xlmeta||{}).Cell||[])[val-1];\n\t\t\t} break;\n\n\t\t\tcase 0x01EE: /* 'BrtHLink' */\n\t\t\t\tvar rel = rels['!id'][val.relId];\n\t\t\t\tif(rel) {\n\t\t\t\t\tval.Target = rel.Target;\n\t\t\t\t\tif(val.loc) val.Target += \"#\"+val.loc;\n\t\t\t\t\tval.Rel = rel;\n\t\t\t\t} else if(val.relId == '') {\n\t\t\t\t\tval.Target = \"#\" + val.loc;\n\t\t\t\t}\n\t\t\t\tfor(R=val.rfx.s.r;R<=val.rfx.e.r;++R) for(C=val.rfx.s.c;C<=val.rfx.e.c;++C) {\n\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\tif(!s[R]) s[R] = [];\n\t\t\t\t\t\tif(!s[R][C]) s[R][C] = {t:'z',v:undefined};\n\t\t\t\t\t\ts[R][C].l = val;\n\t\t\t\t\t} else {\n\t\t\t\t\t\taddr = encode_cell({c:C,r:R});\n\t\t\t\t\t\tif(!s[addr]) s[addr] = {t:'z',v:undefined};\n\t\t\t\t\t\ts[addr].l = val;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01AA: /* 'BrtArrFmla' */\n\t\t\t\tif(!opts.cellFormula) break;\n\t\t\t\tarrayf.push(val);\n\t\t\t\tcell = ((opts.dense ? s[R][C] : s[encode_col(C) + rr])/*:any*/);\n\t\t\t\tcell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\n\t\t\t\tcell.F = encode_range(val[0]);\n\t\t\t\tbreak;\n\t\t\tcase 0x01AB: /* 'BrtShrFmla' */\n\t\t\t\tif(!opts.cellFormula) break;\n\t\t\t\tsharedf[encode_cell(val[0].s)] = val[1];\n\t\t\t\tcell = (opts.dense ? s[R][C] : s[encode_col(C) + rr]);\n\t\t\t\tcell.f = stringify_formula(val[1], refguess, {r:row.r, c:C}, supbooks, opts);\n\t\t\t\tbreak;\n\n\t\t\t/* identical to 'ColInfo' in XLS */\n\t\t\tcase 0x003C: /* 'BrtColInfo' */\n\t\t\t\tif(!opts.cellStyles) break;\n\t\t\t\twhile(val.e >= val.s) {\n\t\t\t\t\tcolinfo[val.e--] = { width: val.w/256, hidden: !!(val.flags & 0x01), level: val.level };\n\t\t\t\t\tif(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\n\t\t\t\t\tprocess_col(colinfo[val.e+1]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 0x00A1: /* 'BrtBeginAFilter' */\n\t\t\t\ts['!autofilter'] = { ref:encode_range(val) };\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01DC: /* 'BrtMargins' */\n\t\t\t\ts['!margins'] = val;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0093: /* 'BrtWsProp' */\n\t\t\t\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\t\t\t\tif(val.name) wb.Sheets[idx].CodeName = val.name;\n\t\t\t\tif(val.above || val.left) s['!outline'] = { above: val.above, left: val.left };\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0089: /* 'BrtBeginWsView' */\n\t\t\t\tif(!wb.Views) wb.Views = [{}];\n\t\t\t\tif(!wb.Views[0]) wb.Views[0] = {};\n\t\t\t\tif(val.RTL) wb.Views[0].RTL = true;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x01E5: /* 'BrtWsFmtInfo' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0040: /* 'BrtDVal' */\n\t\t\tcase 0x041D: /* 'BrtDVal14' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0097: /* 'BrtPane' */\n\t\t\t\tbreak;\n\t\t\tcase 0x0098: /* 'BrtSel' */\n\t\t\tcase 0x00AF: /* 'BrtAFilterDateGroupItem' */\n\t\t\tcase 0x0284: /* 'BrtActiveX' */\n\t\t\tcase 0x0271: /* 'BrtBigName' */\n\t\t\tcase 0x0232: /* 'BrtBkHim' */\n\t\t\tcase 0x018C: /* 'BrtBrk' */\n\t\t\tcase 0x0458: /* 'BrtCFIcon' */\n\t\t\tcase 0x047A: /* 'BrtCFRuleExt' */\n\t\t\tcase 0x01D7: /* 'BrtCFVO' */\n\t\t\tcase 0x041A: /* 'BrtCFVO14' */\n\t\t\tcase 0x0289: /* 'BrtCellIgnoreEC' */\n\t\t\tcase 0x0451: /* 'BrtCellIgnoreEC14' */\n\t\t\tcase 0x024D: /* 'BrtCellSmartTagProperty' */\n\t\t\tcase 0x025F: /* 'BrtCellWatch' */\n\t\t\tcase 0x0234: /* 'BrtColor' */\n\t\t\tcase 0x041F: /* 'BrtColor14' */\n\t\t\tcase 0x00A8: /* 'BrtColorFilter' */\n\t\t\tcase 0x00AE: /* 'BrtCustomFilter' */\n\t\t\tcase 0x049C: /* 'BrtCustomFilter14' */\n\t\t\tcase 0x01F3: /* 'BrtDRef' */\n\t\t\tcase 0x01FB: /* 'BrtDXF' */\n\t\t\tcase 0x0226: /* 'BrtDrawing' */\n\t\t\tcase 0x00AB: /* 'BrtDynamicFilter' */\n\t\t\tcase 0x00A7: /* 'BrtFilter' */\n\t\t\tcase 0x0499: /* 'BrtFilter14' */\n\t\t\tcase 0x00A9: /* 'BrtIconFilter' */\n\t\t\tcase 0x049D: /* 'BrtIconFilter14' */\n\t\t\tcase 0x0227: /* 'BrtLegacyDrawing' */\n\t\t\tcase 0x0228: /* 'BrtLegacyDrawingHF' */\n\t\t\tcase 0x0295: /* 'BrtListPart' */\n\t\t\tcase 0x027F: /* 'BrtOleObject' */\n\t\t\tcase 0x01DE: /* 'BrtPageSetup' */\n\t\t\tcase 0x0219: /* 'BrtPhoneticInfo' */\n\t\t\tcase 0x01DD: /* 'BrtPrintOptions' */\n\t\t\tcase 0x0218: /* 'BrtRangeProtection' */\n\t\t\tcase 0x044F: /* 'BrtRangeProtection14' */\n\t\t\tcase 0x02A8: /* 'BrtRangeProtectionIso' */\n\t\t\tcase 0x0450: /* 'BrtRangeProtectionIso14' */\n\t\t\tcase 0x0400: /* 'BrtRwDescent' */\n\t\t\tcase 0x0297: /* 'BrtSheetCalcProp' */\n\t\t\tcase 0x0217: /* 'BrtSheetProtection' */\n\t\t\tcase 0x02A6: /* 'BrtSheetProtectionIso' */\n\t\t\tcase 0x01F8: /* 'BrtSlc' */\n\t\t\tcase 0x0413: /* 'BrtSparkline' */\n\t\t\tcase 0x01AC: /* 'BrtTable' */\n\t\t\tcase 0x00AA: /* 'BrtTop10Filter' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\tcase 0x0032: /* 'BrtValueMeta' */\n\t\t\tcase 0x0816: /* 'BrtWebExtension' */\n\t\t\tcase 0x0415: /* 'BrtWsFmtInfoEx14' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tdefault:\n\t\t\t\tif(RR.T){/* empty */}\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tdelete opts.supbooks;\n\tdelete opts['!row'];\n\n\tif(!s[\"!ref\"] && (refguess.s.r < 2000000 || ref && (ref.e.r > 0 || ref.e.c > 0 || ref.s.r > 0 || ref.s.c > 0))) s[\"!ref\"] = encode_range(ref || refguess);\n\tif(opts.sheetRows && s[\"!ref\"]) {\n\t\tvar tmpref = safe_decode_range(s[\"!ref\"]);\n\t\tif(opts.sheetRows <= +tmpref.e.r) {\n\t\t\ttmpref.e.r = opts.sheetRows - 1;\n\t\t\tif(tmpref.e.r > refguess.e.r) tmpref.e.r = refguess.e.r;\n\t\t\tif(tmpref.e.r < tmpref.s.r) tmpref.s.r = tmpref.e.r;\n\t\t\tif(tmpref.e.c > refguess.e.c) tmpref.e.c = refguess.e.c;\n\t\t\tif(tmpref.e.c < tmpref.s.c) tmpref.s.c = tmpref.e.c;\n\t\t\ts[\"!fullref\"] = s[\"!ref\"];\n\t\t\ts[\"!ref\"] = encode_range(tmpref);\n\t\t}\n\t}\n\tif(merges.length > 0) s[\"!merges\"] = merges;\n\tif(colinfo.length > 0) s[\"!cols\"] = colinfo;\n\tif(rowinfo.length > 0) s[\"!rows\"] = rowinfo;\n\treturn s;\n}\n\n/* TODO: something useful -- this is a stub */\nfunction write_ws_bin_cell(ba/*:BufArray*/, cell/*:Cell*/, R/*:number*/, C/*:number*/, opts, ws/*:Worksheet*/, last_seen/*:boolean*/)/*:boolean*/ {\n\tif(cell.v === undefined) return false;\n\tvar vv = \"\";\n\tswitch(cell.t) {\n\t\tcase 'b': vv = cell.v ? \"1\" : \"0\"; break;\n\t\tcase 'd': // no BrtCellDate :(\n\t\t\tcell = dup(cell);\n\t\t\tcell.z = cell.z || table_fmt[14];\n\t\t\tcell.v = datenum(parseDate(cell.v)); cell.t = 'n';\n\t\t\tbreak;\n\t\t/* falls through */\n\t\tcase 'n': case 'e': vv = ''+cell.v; break;\n\t\tdefault: vv = cell.v; break;\n\t}\n\tvar o/*:any*/ = ({r:R, c:C}/*:any*/);\n\t/* TODO: cell style */\n\to.s = get_cell_style(opts.cellXfs, cell, opts);\n\tif(cell.l) ws['!links'].push([encode_cell(o), cell.l]);\n\tif(cell.c) ws['!comments'].push([encode_cell(o), cell.c]);\n\tswitch(cell.t) {\n\t\tcase 's': case 'str':\n\t\t\tif(opts.bookSST) {\n\t\t\t\tvv = get_sst_id(opts.Strings, (cell.v/*:any*/), opts.revStrings);\n\t\t\t\to.t = \"s\"; o.v = vv;\n\t\t\t\tif(last_seen) write_record(ba, 0x0012 /* BrtShortIsst */, write_BrtShortIsst(cell, o));\n\t\t\t\telse write_record(ba, 0x0007 /* BrtCellIsst */, write_BrtCellIsst(cell, o));\n\t\t\t} else {\n\t\t\t\to.t = \"str\";\n\t\t\t\tif(last_seen) write_record(ba, 0x0011 /* BrtShortSt */, write_BrtShortSt(cell, o));\n\t\t\t\telse write_record(ba, 0x0006 /* BrtCellSt */, write_BrtCellSt(cell, o));\n\t\t\t}\n\t\t\treturn true;\n\t\tcase 'n':\n\t\t\t/* TODO: determine threshold for Real vs RK */\n\t\t\tif(cell.v == (cell.v | 0) && cell.v > -1000 && cell.v < 1000) {\n\t\t\t\tif(last_seen) write_record(ba, 0x000D /* BrtShortRk */, write_BrtShortRk(cell, o));\n\t\t\t\telse write_record(ba, 0x0002 /* BrtCellRk */, write_BrtCellRk(cell, o));\n\t\t\t} else {\n\t\t\t\tif(last_seen) write_record(ba, 0x0010 /* BrtShortReal */, write_BrtShortReal(cell, o));\n\t\t\t\telse write_record(ba, 0x0005 /* BrtCellReal */, write_BrtCellReal(cell, o));\n\t\t\t} return true;\n\t\tcase 'b':\n\t\t\to.t = \"b\";\n\t\t\tif(last_seen) write_record(ba, 0x000F /* BrtShortBool */, write_BrtShortBool(cell, o));\n\t\t\telse write_record(ba, 0x0004 /* BrtCellBool */, write_BrtCellBool(cell, o));\n\t\t\treturn true;\n\t\tcase 'e':\n\t\t\to.t = \"e\";\n\t\t\tif(last_seen) write_record(ba, 0x000E /* BrtShortError */, write_BrtShortError(cell, o));\n\t\t\telse write_record(ba, 0x0003 /* BrtCellError */, write_BrtCellError(cell, o));\n\t\t\treturn true;\n\t}\n\tif(last_seen) write_record(ba, 0x000C /* BrtShortBlank */, write_BrtShortBlank(cell, o));\n\telse write_record(ba, 0x0001 /* BrtCellBlank */, write_BrtCellBlank(cell, o));\n\treturn true;\n}\n\nfunction write_CELLTABLE(ba, ws/*:Worksheet*/, idx/*:number*/, opts/*::, wb:Workbook*/) {\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), ref, rr = \"\", cols/*:Array<string>*/ = [];\n\twrite_record(ba, 0x0091 /* BrtBeginSheetData */);\n\tvar dense = Array.isArray(ws);\n\tvar cap = range.e.r;\n\tif(ws['!rows']) cap = Math.max(range.e.r, ws['!rows'].length - 1);\n\tfor(var R = range.s.r; R <= cap; ++R) {\n\t\trr = encode_row(R);\n\t\t/* [ACCELLTABLE] */\n\t\t/* BrtRowHdr */\n\t\twrite_row_header(ba, ws, range, R);\n\t\tvar last_seen = false;\n\t\tif(R <= range.e.r) for(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\t/* *16384CELL */\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\tref = cols[C] + rr;\n\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\tif(!cell) { last_seen = false; continue; }\n\t\t\t/* write cell */\n\t\t\tlast_seen = write_ws_bin_cell(ba, cell, R, C, opts, ws, last_seen);\n\t\t}\n\t}\n\twrite_record(ba, 0x0092 /* BrtEndSheetData */);\n}\n\nfunction write_MERGECELLS(ba, ws/*:Worksheet*/) {\n\tif(!ws || !ws['!merges']) return;\n\twrite_record(ba, 0x00B1 /* BrtBeginMergeCells */, write_BrtBeginMergeCells(ws['!merges'].length));\n\tws['!merges'].forEach(function(m) { write_record(ba, 0x00B0 /* BrtMergeCell */, write_BrtMergeCell(m)); });\n\twrite_record(ba, 0x00B2 /* BrtEndMergeCells */);\n}\n\nfunction write_COLINFOS(ba, ws/*:Worksheet*//*::, idx:number, opts, wb:Workbook*/) {\n\tif(!ws || !ws['!cols']) return;\n\twrite_record(ba, 0x0186 /* BrtBeginColInfos */);\n\tws['!cols'].forEach(function(m, i) { if(m) write_record(ba, 0x003C /* 'BrtColInfo' */, write_BrtColInfo(i, m)); });\n\twrite_record(ba, 0x0187 /* BrtEndColInfos */);\n}\n\nfunction write_IGNOREECS(ba, ws/*:Worksheet*/) {\n\tif(!ws || !ws['!ref']) return;\n\twrite_record(ba, 0x0288 /* BrtBeginCellIgnoreECs */);\n\twrite_record(ba, 0x0289 /* BrtCellIgnoreEC */, write_BrtCellIgnoreEC(safe_decode_range(ws['!ref'])));\n\twrite_record(ba, 0x028A /* BrtEndCellIgnoreECs */);\n}\n\nfunction write_HLINKS(ba, ws/*:Worksheet*/, rels) {\n\t/* *BrtHLink */\n\tws['!links'].forEach(function(l) {\n\t\tif(!l[1].Target) return;\n\t\tvar rId = add_rels(rels, -1, l[1].Target.replace(/#.*$/, \"\"), RELS.HLINK);\n\t\twrite_record(ba, 0x01EE /* BrtHLink */, write_BrtHLink(l, rId));\n\t});\n\tdelete ws['!links'];\n}\nfunction write_LEGACYDRAWING(ba, ws/*:Worksheet*/, idx/*:number*/, rels) {\n\t/* [BrtLegacyDrawing] */\n\tif(ws['!comments'].length > 0) {\n\t\tvar rId = add_rels(rels, -1, \"../drawings/vmlDrawing\" + (idx+1) + \".vml\", RELS.VML);\n\t\twrite_record(ba, 0x0227 /* BrtLegacyDrawing */, write_RelID(\"rId\" + rId));\n\t\tws['!legacy'] = rId;\n\t}\n}\n\nfunction write_AUTOFILTER(ba, ws, wb, idx) {\n\tif(!ws['!autofilter']) return;\n\tvar data = ws['!autofilter'];\n\tvar ref = typeof data.ref === \"string\" ? data.ref : encode_range(data.ref);\n\n\t/* Update FilterDatabase defined name for the worksheet */\n\tif(!wb.Workbook) wb.Workbook = ({Sheets:[]}/*:any*/);\n\tif(!wb.Workbook.Names) wb.Workbook.Names = [];\n\tvar names/*: Array<any> */ = wb.Workbook.Names;\n\tvar range = decode_range(ref);\n\tif(range.s.r == range.e.r) { range.e.r = decode_range(ws[\"!ref\"]).e.r; ref = encode_range(range); }\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar name = names[i];\n\t\tif(name.Name != '_xlnm._FilterDatabase') continue;\n\t\tif(name.Sheet != idx) continue;\n\t\tname.Ref = \"'\" + wb.SheetNames[idx] + \"'!\" + ref; break;\n\t}\n\tif(i == names.length) names.push({ Name: '_xlnm._FilterDatabase', Sheet: idx, Ref: \"'\" + wb.SheetNames[idx] + \"'!\" + ref  });\n\n\twrite_record(ba, 0x00A1 /* BrtBeginAFilter */, write_UncheckedRfX(safe_decode_range(ref)));\n\t/* *FILTERCOLUMN */\n\t/* [SORTSTATE] */\n\t/* BrtEndAFilter */\n\twrite_record(ba, 0x00A2 /* BrtEndAFilter */);\n}\n\nfunction write_WSVIEWS2(ba, ws, Workbook) {\n\twrite_record(ba, 0x0085 /* BrtBeginWsViews */);\n\t{ /* 1*WSVIEW2 */\n\t\t/* [ACUID] */\n\t\twrite_record(ba, 0x0089 /* BrtBeginWsView */, write_BrtBeginWsView(ws, Workbook));\n\t\t/* [BrtPane] */\n\t\t/* *4BrtSel */\n\t\t/* *4SXSELECT */\n\t\t/* *FRT */\n\t\twrite_record(ba, 0x008A /* BrtEndWsView */);\n\t}\n\t/* *FRT */\n\twrite_record(ba, 0x0086 /* BrtEndWsViews */);\n}\n\nfunction write_WSFMTINFO(/*::ba, ws*/) {\n\t/* [ACWSFMTINFO] */\n\t// write_record(ba, 0x01E5 /* BrtWsFmtInfo */, write_BrtWsFmtInfo(ws));\n}\n\nfunction write_SHEETPROTECT(ba, ws) {\n\tif(!ws['!protect']) return;\n\t/* [BrtSheetProtectionIso] */\n\twrite_record(ba, 0x0217 /* BrtSheetProtection */, write_BrtSheetProtection(ws['!protect']));\n}\n\nfunction write_ws_bin(idx/*:number*/, opts, wb/*:Workbook*/, rels) {\n\tvar ba = buf_array();\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\n\tvar c/*:string*/ = s; try { if(wb && wb.Workbook) c = wb.Workbook.Sheets[idx].CodeName || c; } catch(e) {}\n\tvar r = safe_decode_range(ws['!ref'] || \"A1\");\n\tif(r.e.c > 0x3FFF || r.e.r > 0xFFFFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:XFD1048576\");\n\t\tr.e.c = Math.min(r.e.c, 0x3FFF);\n\t\tr.e.r = Math.min(r.e.c, 0xFFFFF);\n\t}\n\tws['!links'] = [];\n\t/* passed back to write_zip and removed there */\n\tws['!comments'] = [];\n\twrite_record(ba, 0x0081 /* BrtBeginSheet */);\n\tif(wb.vbaraw || ws['!outline']) write_record(ba, 0x0093 /* BrtWsProp */, write_BrtWsProp(c, ws['!outline']));\n\twrite_record(ba, 0x0094 /* BrtWsDim */, write_BrtWsDim(r));\n\twrite_WSVIEWS2(ba, ws, wb.Workbook);\n\twrite_WSFMTINFO(ba, ws);\n\twrite_COLINFOS(ba, ws, idx, opts, wb);\n\twrite_CELLTABLE(ba, ws, idx, opts, wb);\n\t/* [BrtSheetCalcProp] */\n\twrite_SHEETPROTECT(ba, ws);\n\t/* *([BrtRangeProtectionIso] BrtRangeProtection) */\n\t/* [SCENMAN] */\n\twrite_AUTOFILTER(ba, ws, wb, idx);\n\t/* [SORTSTATE] */\n\t/* [DCON] */\n\t/* [USERSHVIEWS] */\n\twrite_MERGECELLS(ba, ws);\n\t/* [BrtPhoneticInfo] */\n\t/* *CONDITIONALFORMATTING */\n\t/* [DVALS] */\n\twrite_HLINKS(ba, ws, rels);\n\t/* [BrtPrintOptions] */\n\tif(ws['!margins']) write_record(ba, 0x01DC /* BrtMargins */, write_BrtMargins(ws['!margins']));\n\t/* [BrtPageSetup] */\n\t/* [HEADERFOOTER] */\n\t/* [RWBRK] */\n\t/* [COLBRK] */\n\t/* *BrtBigName */\n\t/* [CELLWATCHES] */\n\tif(!opts || opts.ignoreEC || (opts.ignoreEC == (void 0))) write_IGNOREECS(ba, ws);\n\t/* [SMARTTAGS] */\n\t/* [BrtDrawing] */\n\twrite_LEGACYDRAWING(ba, ws, idx, rels);\n\t/* [BrtLegacyDrawingHF] */\n\t/* [BrtBkHim] */\n\t/* [OLEOBJECTS] */\n\t/* [ACTIVEXCONTROLS] */\n\t/* [WEBPUBITEMS] */\n\t/* [LISTPARTS] */\n\t/* FRTWORKSHEET */\n\twrite_record(ba, 0x0082 /* BrtEndSheet */);\n\treturn ba.end();\n}\nfunction parse_Cache(data/*:string*/)/*:[Array<number|string>, string, ?string]*/ {\n\tvar col/*:Array<number|string>*/ = [];\n\tvar num = data.match(/^<c:numCache>/);\n\tvar f;\n\n\t/* 21.2.2.150 pt CT_NumVal */\n\t(data.match(/<c:pt idx=\"(\\d*)\">(.*?)<\\/c:pt>/mg)||[]).forEach(function(pt) {\n\t\tvar q = pt.match(/<c:pt idx=\"(\\d*?)\"><c:v>(.*)<\\/c:v><\\/c:pt>/);\n\t\tif(!q) return;\n\t\tcol[+q[1]] = num ? +q[2] : q[2];\n\t});\n\n\t/* 21.2.2.71 formatCode CT_Xstring */\n\tvar nf = unescapexml((data.match(/<c:formatCode>([\\s\\S]*?)<\\/c:formatCode>/) || [\"\",\"General\"])[1]);\n\n\t(data.match(/<c:f>(.*?)<\\/c:f>/mg)||[]).forEach(function(F) { f = F.replace(/<.*?>/g,\"\"); });\n\n\treturn [col, nf, f];\n}\n\n/* 21.2 DrawingML - Charts */\nfunction parse_chart(data/*:?string*/, name/*:string*/, opts, rels, wb, csheet) {\n\tvar cs/*:Worksheet*/ = ((csheet || {\"!type\":\"chart\"})/*:any*/);\n\tif(!data) return csheet;\n\t/* 21.2.2.27 chart CT_Chart */\n\n\tvar C = 0, R = 0, col = \"A\";\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\n\t/* 21.2.2.120 numCache CT_NumData */\n\t(data.match(/<c:numCache>[\\s\\S]*?<\\/c:numCache>/gm)||[]).forEach(function(nc) {\n\t\tvar cache = parse_Cache(nc);\n\t\trefguess.s.r = refguess.s.c = 0;\n\t\trefguess.e.c = C;\n\t\tcol = encode_col(C);\n\t\tcache[0].forEach(function(n,i) {\n\t\t\tcs[col + encode_row(i)] = {t:'n', v:n, z:cache[1] };\n\t\t\tR = i;\n\t\t});\n\t\tif(refguess.e.r < R) refguess.e.r = R;\n\t\t++C;\n\t});\n\tif(C > 0) cs[\"!ref\"] = encode_range(refguess);\n\treturn cs;\n}\n/* 18.3 Worksheets also covers Chartsheets */\nfunction parse_cs_xml(data/*:?string*/, opts, idx/*:number*/, rels, wb/*::, themes, styles*/)/*:Worksheet*/ {\n\tif(!data) return data;\n\t/* 18.3.1.12 chartsheet CT_ChartSheet */\n\tif(!rels) rels = {'!id':{}};\n\tvar s = ({'!type':\"chart\", '!drawel':null, '!rel':\"\"}/*:any*/);\n\tvar m;\n\n\t/* 18.3.1.83 sheetPr CT_ChartsheetPr */\n\tvar sheetPr = data.match(sheetprregex);\n\tif(sheetPr) parse_ws_xml_sheetpr(sheetPr[0], s, wb, idx);\n\n\t/* 18.3.1.36 drawing CT_Drawing */\n\tif((m = data.match(/drawing r:id=\"(.*?)\"/))) s['!rel'] = m[1];\n\n\tif(rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n\treturn s;\n}\nfunction write_cs_xml(idx/*:number*/, opts, wb/*:Workbook*/, rels)/*:string*/ {\n\tvar o = [XML_HEADER, writextag('chartsheet', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t})];\n\to[o.length] = writextag(\"drawing\", null, {\"r:id\": \"rId1\"});\n\tadd_rels(rels, -1, \"../drawings/drawing\" + (idx+1) + \".xml\", RELS.DRAW);\n\tif(o.length>2) { o[o.length] = ('</chartsheet>'); o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n\n/* [MS-XLSB] 2.4.331 BrtCsProp */\nfunction parse_BrtCsProp(data, length/*:number*/) {\n\tdata.l += 10;\n\tvar name = parse_XLWideString(data, length - 10);\n\treturn { name: name };\n}\n\n/* [MS-XLSB] 2.1.7.7 Chart Sheet */\nfunction parse_cs_bin(data, opts, idx/*:number*/, rels, wb/*::, themes, styles*/)/*:Worksheet*/ {\n\tif(!data) return data;\n\tif(!rels) rels = {'!id':{}};\n\tvar s = {'!type':\"chart\", '!drawel':null, '!rel':\"\"};\n\tvar state/*:Array<string>*/ = [];\n\tvar pass = false;\n\trecordhopper(data, function cs_parse(val, R, RT) {\n\t\tswitch(RT) {\n\n\t\t\tcase 0x0226: /* 'BrtDrawing' */\n\t\t\t\ts['!rel'] = val; break;\n\n\t\t\tcase 0x028B: /* 'BrtCsProp' */\n\t\t\t\tif(!wb.Sheets[idx]) wb.Sheets[idx] = {};\n\t\t\t\tif(val.name) wb.Sheets[idx].CodeName = val.name;\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0232: /* 'BrtBkHim' */\n\t\t\tcase 0x028C: /* 'BrtCsPageSetup' */\n\t\t\tcase 0x029D: /* 'BrtCsProtection' */\n\t\t\tcase 0x02A7: /* 'BrtCsProtectionIso' */\n\t\t\tcase 0x0227: /* 'BrtLegacyDrawing' */\n\t\t\tcase 0x0228: /* 'BrtLegacyDrawingHF' */\n\t\t\tcase 0x01DC: /* 'BrtMargins' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tpass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tpass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T > 0) state.push(RT);\n\t\t\t\telse if(R.T < 0) state.pop();\n\t\t\t\telse if(!pass || opts.WTF) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tif(rels['!id'][s['!rel']]) s['!drawel'] = rels['!id'][s['!rel']];\n\treturn s;\n}\nfunction write_cs_bin(/*::idx:number, opts, wb:Workbook, rels*/) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0081 /* BrtBeginSheet */);\n\t/* [BrtCsProp] */\n\t/* CSVIEWS */\n\t/* [[BrtCsProtectionIso] BrtCsProtection] */\n\t/* [USERCSVIEWS] */\n\t/* [BrtMargins] */\n\t/* [BrtCsPageSetup] */\n\t/* [HEADERFOOTER] */\n\t/* BrtDrawing */\n\t/* [BrtLegacyDrawing] */\n\t/* [BrtLegacyDrawingHF] */\n\t/* [BrtBkHim] */\n\t/* [WEBPUBITEMS] */\n\t/* FRTCHARTSHEET */\n\twrite_record(ba, 0x0082 /* BrtEndSheet */);\n\treturn ba.end();\n}\n/* 18.2.28 (CT_WorkbookProtection) Defaults */\nvar WBPropsDef = [\n\t['allowRefreshQuery',           false, \"bool\"],\n\t['autoCompressPictures',        true,  \"bool\"],\n\t['backupFile',                  false, \"bool\"],\n\t['checkCompatibility',          false, \"bool\"],\n\t['CodeName',                    ''],\n\t['date1904',                    false, \"bool\"],\n\t['defaultThemeVersion',         0,      \"int\"],\n\t['filterPrivacy',               false, \"bool\"],\n\t['hidePivotFieldList',          false, \"bool\"],\n\t['promptedSolutions',           false, \"bool\"],\n\t['publishItems',                false, \"bool\"],\n\t['refreshAllConnections',       false, \"bool\"],\n\t['saveExternalLinkValues',      true,  \"bool\"],\n\t['showBorderUnselectedTables',  true,  \"bool\"],\n\t['showInkAnnotation',           true,  \"bool\"],\n\t['showObjects',                 'all'],\n\t['showPivotChartFilter',        false, \"bool\"],\n\t['updateLinks', 'userSet']\n];\n\n/* 18.2.30 (CT_BookView) Defaults */\nvar WBViewDef = [\n\t['activeTab',                   0,      \"int\"],\n\t['autoFilterDateGrouping',      true,  \"bool\"],\n\t['firstSheet',                  0,      \"int\"],\n\t['minimized',                   false, \"bool\"],\n\t['showHorizontalScroll',        true,  \"bool\"],\n\t['showSheetTabs',               true,  \"bool\"],\n\t['showVerticalScroll',          true,  \"bool\"],\n\t['tabRatio',                    600,    \"int\"],\n\t['visibility',                  'visible']\n\t//window{Height,Width}, {x,y}Window\n];\n\n/* 18.2.19 (CT_Sheet) Defaults */\nvar SheetDef = [\n\t//['state', 'visible']\n];\n\n/* 18.2.2  (CT_CalcPr) Defaults */\nvar CalcPrDef = [\n\t['calcCompleted', 'true'],\n\t['calcMode', 'auto'],\n\t['calcOnSave', 'true'],\n\t['concurrentCalc', 'true'],\n\t['fullCalcOnLoad', 'false'],\n\t['fullPrecision', 'true'],\n\t['iterate', 'false'],\n\t['iterateCount', '100'],\n\t['iterateDelta', '0.001'],\n\t['refMode', 'A1']\n];\n\n/* 18.2.3 (CT_CustomWorkbookView) Defaults */\n/*var CustomWBViewDef = [\n\t['autoUpdate', 'false'],\n\t['changesSavedWin', 'false'],\n\t['includeHiddenRowCol', 'true'],\n\t['includePrintSettings', 'true'],\n\t['maximized', 'false'],\n\t['minimized', 'false'],\n\t['onlySync', 'false'],\n\t['personalView', 'false'],\n\t['showComments', 'commIndicator'],\n\t['showFormulaBar', 'true'],\n\t['showHorizontalScroll', 'true'],\n\t['showObjects', 'all'],\n\t['showSheetTabs', 'true'],\n\t['showStatusbar', 'true'],\n\t['showVerticalScroll', 'true'],\n\t['tabRatio', '600'],\n\t['xWindow', '0'],\n\t['yWindow', '0']\n];*/\n\nfunction push_defaults_array(target, defaults) {\n\tfor(var j = 0; j != target.length; ++j) { var w = target[j];\n\t\tfor(var i=0; i != defaults.length; ++i) { var z = defaults[i];\n\t\t\tif(w[z[0]] == null) w[z[0]] = z[1];\n\t\t\telse switch(z[2]) {\n\t\t\tcase \"bool\": if(typeof w[z[0]] == \"string\") w[z[0]] = parsexmlbool(w[z[0]]); break;\n\t\t\tcase \"int\": if(typeof w[z[0]] == \"string\") w[z[0]] = parseInt(w[z[0]], 10); break;\n\t\t\t}\n\t\t}\n\t}\n}\nfunction push_defaults(target, defaults) {\n\tfor(var i = 0; i != defaults.length; ++i) { var z = defaults[i];\n\t\tif(target[z[0]] == null) target[z[0]] = z[1];\n\t\telse switch(z[2]) {\n\t\t\tcase \"bool\": if(typeof target[z[0]] == \"string\") target[z[0]] = parsexmlbool(target[z[0]]); break;\n\t\t\tcase \"int\": if(typeof target[z[0]] == \"string\") target[z[0]] = parseInt(target[z[0]], 10); break;\n\t\t}\n\t}\n}\n\nfunction parse_wb_defaults(wb) {\n\tpush_defaults(wb.WBProps, WBPropsDef);\n\tpush_defaults(wb.CalcPr, CalcPrDef);\n\n\tpush_defaults_array(wb.WBView, WBViewDef);\n\tpush_defaults_array(wb.Sheets, SheetDef);\n\n\t_ssfopts.date1904 = parsexmlbool(wb.WBProps.date1904);\n}\n\nfunction safe1904(wb/*:Workbook*/)/*:string*/ {\n\t/* TODO: store date1904 somewhere else */\n\tif(!wb.Workbook) return \"false\";\n\tif(!wb.Workbook.WBProps) return \"false\";\n\treturn parsexmlbool(wb.Workbook.WBProps.date1904) ? \"true\" : \"false\";\n}\n\nvar badchars = /*#__PURE__*/\"][*?\\/\\\\\".split(\"\");\nfunction check_ws_name(n/*:string*/, safe/*:?boolean*/)/*:boolean*/ {\n\tif(n.length > 31) { if(safe) return false; throw new Error(\"Sheet names cannot exceed 31 chars\"); }\n\tvar _good = true;\n\tbadchars.forEach(function(c) {\n\t\tif(n.indexOf(c) == -1) return;\n\t\tif(!safe) throw new Error(\"Sheet name cannot contain : \\\\ / ? * [ ]\");\n\t\t_good = false;\n\t});\n\treturn _good;\n}\nfunction check_wb_names(N, S, codes) {\n\tN.forEach(function(n,i) {\n\t\tcheck_ws_name(n);\n\t\tfor(var j = 0; j < i; ++j) if(n == N[j]) throw new Error(\"Duplicate Sheet Name: \" + n);\n\t\tif(codes) {\n\t\t\tvar cn = (S && S[i] && S[i].CodeName) || n;\n\t\t\tif(cn.charCodeAt(0) == 95 && cn.length > 22) throw new Error(\"Bad Code Name: Worksheet\" + cn);\n\t\t}\n\t});\n}\nfunction check_wb(wb) {\n\tif(!wb || !wb.SheetNames || !wb.Sheets) throw new Error(\"Invalid Workbook\");\n\tif(!wb.SheetNames.length) throw new Error(\"Workbook is empty\");\n\tvar Sheets = (wb.Workbook && wb.Workbook.Sheets) || [];\n\tcheck_wb_names(wb.SheetNames, Sheets, !!wb.vbaraw);\n\tfor(var i = 0; i < wb.SheetNames.length; ++i) check_ws(wb.Sheets[wb.SheetNames[i]], wb.SheetNames[i], i);\n\t/* TODO: validate workbook */\n}\n/* 18.2 Workbook */\nvar wbnsregex = /<\\w+:workbook/;\nfunction parse_wb_xml(data, opts)/*:WorkbookFile*/ {\n\tif(!data) throw new Error(\"Could not find file\");\n\tvar wb = /*::(*/{ AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, Names:[], xmlns: \"\" }/*::)*/;\n\tvar pass = false, xmlns = \"xmlns\";\n\tvar dname = {}, dnstart = 0;\n\tdata.replace(tagregex, function xml_wb(x, idx) {\n\t\tvar y/*:any*/ = parsexmltag(x);\n\t\tswitch(strip_ns(y[0])) {\n\t\t\tcase '<?xml': break;\n\n\t\t\t/* 18.2.27 workbook CT_Workbook 1 */\n\t\t\tcase '<workbook':\n\t\t\t\tif(x.match(wbnsregex)) xmlns = \"xmlns\" + x.match(/<(\\w+):/)[1];\n\t\t\t\twb.xmlns = y[xmlns];\n\t\t\t\tbreak;\n\t\t\tcase '</workbook>': break;\n\n\t\t\t/* 18.2.13 fileVersion CT_FileVersion ? */\n\t\t\tcase '<fileVersion': delete y[0]; wb.AppVersion = y; break;\n\t\t\tcase '<fileVersion/>': case '</fileVersion>': break;\n\n\t\t\t/* 18.2.12 fileSharing CT_FileSharing ? */\n\t\t\tcase '<fileSharing':\n\t\t\t\tbreak;\n\t\t\tcase '<fileSharing/>': break;\n\n\t\t\t/* 18.2.28 workbookPr CT_WorkbookPr ? */\n\t\t\tcase '<workbookPr':\n\t\t\tcase '<workbookPr/>':\n\t\t\t\tWBPropsDef.forEach(function(w) {\n\t\t\t\t\tif(y[w[0]] == null) return;\n\t\t\t\t\tswitch(w[2]) {\n\t\t\t\t\t\tcase \"bool\": wb.WBProps[w[0]] = parsexmlbool(y[w[0]]); break;\n\t\t\t\t\t\tcase \"int\": wb.WBProps[w[0]] = parseInt(y[w[0]], 10); break;\n\t\t\t\t\t\tdefault: wb.WBProps[w[0]] = y[w[0]];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif(y.codeName) wb.WBProps.CodeName = utf8read(y.codeName);\n\t\t\t\tbreak;\n\t\t\tcase '</workbookPr>': break;\n\n\t\t\t/* 18.2.29 workbookProtection CT_WorkbookProtection ? */\n\t\t\tcase '<workbookProtection':\n\t\t\t\tbreak;\n\t\t\tcase '<workbookProtection/>': break;\n\n\t\t\t/* 18.2.1  bookViews CT_BookViews ? */\n\t\t\tcase '<bookViews': case '<bookViews>': case '</bookViews>': break;\n\t\t\t/* 18.2.30   workbookView CT_BookView + */\n\t\t\tcase '<workbookView': case '<workbookView/>': delete y[0]; wb.WBView.push(y); break;\n\t\t\tcase '</workbookView>': break;\n\n\t\t\t/* 18.2.20 sheets CT_Sheets 1 */\n\t\t\tcase '<sheets': case '<sheets>': case '</sheets>': break; // aggregate sheet\n\t\t\t/* 18.2.19   sheet CT_Sheet + */\n\t\t\tcase '<sheet':\n\t\t\t\tswitch(y.state) {\n\t\t\t\t\tcase \"hidden\": y.Hidden = 1; break;\n\t\t\t\t\tcase \"veryHidden\": y.Hidden = 2; break;\n\t\t\t\t\tdefault: y.Hidden = 0;\n\t\t\t\t}\n\t\t\t\tdelete y.state;\n\t\t\t\ty.name = unescapexml(utf8read(y.name));\n\t\t\t\tdelete y[0]; wb.Sheets.push(y); break;\n\t\t\tcase '</sheet>': break;\n\n\t\t\t/* 18.2.15 functionGroups CT_FunctionGroups ? */\n\t\t\tcase '<functionGroups': case '<functionGroups/>': break;\n\t\t\t/* 18.2.14   functionGroup CT_FunctionGroup + */\n\t\t\tcase '<functionGroup': break;\n\n\t\t\t/* 18.2.9  externalReferences CT_ExternalReferences ? */\n\t\t\tcase '<externalReferences': case '</externalReferences>': case '<externalReferences>': break;\n\t\t\t/* 18.2.8    externalReference CT_ExternalReference + */\n\t\t\tcase '<externalReference': break;\n\n\t\t\t/* 18.2.6  definedNames CT_DefinedNames ? */\n\t\t\tcase '<definedNames/>': break;\n\t\t\tcase '<definedNames>': case '<definedNames': pass=true; break;\n\t\t\tcase '</definedNames>': pass=false; break;\n\t\t\t/* 18.2.5    definedName CT_DefinedName + */\n\t\t\tcase '<definedName': {\n\t\t\t\tdname = {};\n\t\t\t\tdname.Name = utf8read(y.name);\n\t\t\t\tif(y.comment) dname.Comment = y.comment;\n\t\t\t\tif(y.localSheetId) dname.Sheet = +y.localSheetId;\n\t\t\t\tif(parsexmlbool(y.hidden||\"0\")) dname.Hidden = true;\n\t\t\t\tdnstart = idx + x.length;\n\t\t\t}\tbreak;\n\t\t\tcase '</definedName>': {\n\t\t\t\tdname.Ref = unescapexml(utf8read(data.slice(dnstart, idx)));\n\t\t\t\twb.Names.push(dname);\n\t\t\t} break;\n\t\t\tcase '<definedName/>': break;\n\n\t\t\t/* 18.2.2  calcPr CT_CalcPr ? */\n\t\t\tcase '<calcPr': delete y[0]; wb.CalcPr = y; break;\n\t\t\tcase '<calcPr/>': delete y[0]; wb.CalcPr = y; break;\n\t\t\tcase '</calcPr>': break;\n\n\t\t\t/* 18.2.16 oleSize CT_OleSize ? (ref required) */\n\t\t\tcase '<oleSize': break;\n\n\t\t\t/* 18.2.4  customWorkbookViews CT_CustomWorkbookViews ? */\n\t\t\tcase '<customWorkbookViews>': case '</customWorkbookViews>': case '<customWorkbookViews': break;\n\t\t\t/* 18.2.3  customWorkbookView CT_CustomWorkbookView + */\n\t\t\tcase '<customWorkbookView': case '</customWorkbookView>': break;\n\n\t\t\t/* 18.2.18 pivotCaches CT_PivotCaches ? */\n\t\t\tcase '<pivotCaches>': case '</pivotCaches>': case '<pivotCaches': break;\n\t\t\t/* 18.2.17 pivotCache CT_PivotCache ? */\n\t\t\tcase '<pivotCache': break;\n\n\t\t\t/* 18.2.21 smartTagPr CT_SmartTagPr ? */\n\t\t\tcase '<smartTagPr': case '<smartTagPr/>': break;\n\n\t\t\t/* 18.2.23 smartTagTypes CT_SmartTagTypes ? */\n\t\t\tcase '<smartTagTypes': case '<smartTagTypes>': case '</smartTagTypes>': break;\n\t\t\t/* 18.2.22 smartTagType CT_SmartTagType ? */\n\t\t\tcase '<smartTagType': break;\n\n\t\t\t/* 18.2.24 webPublishing CT_WebPublishing ? */\n\t\t\tcase '<webPublishing': case '<webPublishing/>': break;\n\n\t\t\t/* 18.2.11 fileRecoveryPr CT_FileRecoveryPr ? */\n\t\t\tcase '<fileRecoveryPr': case '<fileRecoveryPr/>': break;\n\n\t\t\t/* 18.2.26 webPublishObjects CT_WebPublishObjects ? */\n\t\t\tcase '<webPublishObjects>': case '<webPublishObjects': case '</webPublishObjects>': break;\n\t\t\t/* 18.2.25 webPublishObject CT_WebPublishObject ? */\n\t\t\tcase '<webPublishObject': break;\n\n\t\t\t/* 18.2.10 extLst CT_ExtensionList ? */\n\t\t\tcase '<extLst': case '<extLst>': case '</extLst>': case '<extLst/>': break;\n\t\t\t/* 18.2.7  ext CT_Extension + */\n\t\t\tcase '<ext': pass=true; break; //TODO: check with versions of excel\n\t\t\tcase '</ext>': pass=false; break;\n\n\t\t\t/* Others */\n\t\t\tcase '<ArchID': break;\n\t\t\tcase '<AlternateContent':\n\t\t\tcase '<AlternateContent>': pass=true; break;\n\t\t\tcase '</AlternateContent>': pass=false; break;\n\n\t\t\t/* TODO */\n\t\t\tcase '<revisionPtr': break;\n\n\t\t\tdefault: if(!pass && opts.WTF) throw new Error('unrecognized ' + y[0] + ' in workbook');\n\t\t}\n\t\treturn x;\n\t});\n\tif(XMLNS_main.indexOf(wb.xmlns) === -1) throw new Error(\"Unknown Namespace: \" + wb.xmlns);\n\n\tparse_wb_defaults(wb);\n\n\treturn wb;\n}\n\nfunction write_wb_xml(wb/*:Workbook*//*::, opts:?WriteOpts*/)/*:string*/ {\n\tvar o = [XML_HEADER];\n\to[o.length] = writextag('workbook', null, {\n\t\t'xmlns': XMLNS_main[0],\n\t\t//'xmlns:mx': XMLNS.mx,\n\t\t//'xmlns:s': XMLNS_main[0],\n\t\t'xmlns:r': XMLNS.r\n\t});\n\n\tvar write_names = (wb.Workbook && (wb.Workbook.Names||[]).length > 0);\n\n\t/* fileVersion */\n\t/* fileSharing */\n\n\tvar workbookPr/*:any*/ = ({codeName:\"ThisWorkbook\"}/*:any*/);\n\tif(wb.Workbook && wb.Workbook.WBProps) {\n\t\tWBPropsDef.forEach(function(x) {\n\t\t\t/*:: if(!wb.Workbook || !wb.Workbook.WBProps) throw \"unreachable\"; */\n\t\t\tif((wb.Workbook.WBProps[x[0]]/*:any*/) == null) return;\n\t\t\tif((wb.Workbook.WBProps[x[0]]/*:any*/) == x[1]) return;\n\t\t\tworkbookPr[x[0]] = (wb.Workbook.WBProps[x[0]]/*:any*/);\n\t\t});\n\t\t/*:: if(!wb.Workbook || !wb.Workbook.WBProps) throw \"unreachable\"; */\n\t\tif(wb.Workbook.WBProps.CodeName) { workbookPr.codeName = wb.Workbook.WBProps.CodeName; delete workbookPr.CodeName; }\n\t}\n\to[o.length] = (writextag('workbookPr', null, workbookPr));\n\n\t/* workbookProtection */\n\n\tvar sheets = wb.Workbook && wb.Workbook.Sheets || [];\n\tvar i = 0;\n\n\t/* bookViews only written if first worksheet is hidden */\n\tif(sheets && sheets[0] && !!sheets[0].Hidden) {\n\t\to[o.length] = \"<bookViews>\";\n\t\tfor(i = 0; i != wb.SheetNames.length; ++i) {\n\t\t\tif(!sheets[i]) break;\n\t\t\tif(!sheets[i].Hidden) break;\n\t\t}\n\t\tif(i == wb.SheetNames.length) i = 0;\n\t\to[o.length] = '<workbookView firstSheet=\"' + i + '\" activeTab=\"' + i + '\"/>';\n\t\to[o.length] = \"</bookViews>\";\n\t}\n\n\to[o.length] = \"<sheets>\";\n\tfor(i = 0; i != wb.SheetNames.length; ++i) {\n\t\tvar sht = ({name:escapexml(wb.SheetNames[i].slice(0,31))}/*:any*/);\n\t\tsht.sheetId = \"\"+(i+1);\n\t\tsht[\"r:id\"] = \"rId\"+(i+1);\n\t\tif(sheets[i]) switch(sheets[i].Hidden) {\n\t\t\tcase 1: sht.state = \"hidden\"; break;\n\t\t\tcase 2: sht.state = \"veryHidden\"; break;\n\t\t}\n\t\to[o.length] = (writextag('sheet',null,sht));\n\t}\n\to[o.length] = \"</sheets>\";\n\n\t/* functionGroups */\n\t/* externalReferences */\n\n\tif(write_names) {\n\t\to[o.length] = \"<definedNames>\";\n\t\tif(wb.Workbook && wb.Workbook.Names) wb.Workbook.Names.forEach(function(n) {\n\t\t\tvar d/*:any*/ = {name:n.Name};\n\t\t\tif(n.Comment) d.comment = n.Comment;\n\t\t\tif(n.Sheet != null) d.localSheetId = \"\"+n.Sheet;\n\t\t\tif(n.Hidden) d.hidden = \"1\";\n\t\t\tif(!n.Ref) return;\n\t\t\to[o.length] = writextag('definedName', escapexml(n.Ref), d);\n\t\t});\n\t\to[o.length] = \"</definedNames>\";\n\t}\n\n\t/* calcPr */\n\t/* oleSize */\n\t/* customWorkbookViews */\n\t/* pivotCaches */\n\t/* smartTagPr */\n\t/* smartTagTypes */\n\t/* webPublishing */\n\t/* fileRecoveryPr */\n\t/* webPublishObjects */\n\t/* extLst */\n\n\tif(o.length>2){ o[o.length] = '</workbook>'; o[1]=o[1].replace(\"/>\",\">\"); }\n\treturn o.join(\"\");\n}\n/* [MS-XLSB] 2.4.304 BrtBundleSh */\nfunction parse_BrtBundleSh(data, length/*:number*/) {\n\tvar z = {};\n\tz.Hidden = data.read_shift(4); //hsState ST_SheetState\n\tz.iTabID = data.read_shift(4);\n\tz.strRelID = parse_RelID(data,length-8);\n\tz.name = parse_XLWideString(data);\n\treturn z;\n}\nfunction write_BrtBundleSh(data, o) {\n\tif(!o) o = new_buf(127);\n\to.write_shift(4, data.Hidden);\n\to.write_shift(4, data.iTabID);\n\twrite_RelID(data.strRelID, o);\n\twrite_XLWideString(data.name.slice(0,31), o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.815 BrtWbProp */\nfunction parse_BrtWbProp(data, length)/*:WBProps*/ {\n\tvar o/*:WBProps*/ = ({}/*:any*/);\n\tvar flags = data.read_shift(4);\n\to.defaultThemeVersion = data.read_shift(4);\n\tvar strName = (length > 8) ? parse_XLWideString(data) : \"\";\n\tif(strName.length > 0) o.CodeName = strName;\n\to.autoCompressPictures = !!(flags & 0x10000);\n\to.backupFile = !!(flags & 0x40);\n\to.checkCompatibility = !!(flags & 0x1000);\n\to.date1904 = !!(flags & 0x01);\n\to.filterPrivacy = !!(flags & 0x08);\n\to.hidePivotFieldList = !!(flags & 0x400);\n\to.promptedSolutions = !!(flags & 0x10);\n\to.publishItems = !!(flags & 0x800);\n\to.refreshAllConnections = !!(flags & 0x40000);\n\to.saveExternalLinkValues = !!(flags & 0x80);\n\to.showBorderUnselectedTables = !!(flags & 0x04);\n\to.showInkAnnotation = !!(flags & 0x20);\n\to.showObjects = [\"all\", \"placeholders\", \"none\"][(flags >> 13) & 0x03];\n\to.showPivotChartFilter = !!(flags & 0x8000);\n\to.updateLinks = [\"userSet\", \"never\", \"always\"][(flags >> 8) & 0x03];\n\treturn o;\n}\nfunction write_BrtWbProp(data/*:?WBProps*/, o) {\n\tif(!o) o = new_buf(72);\n\tvar flags = 0;\n\tif(data) {\n\t\t/* TODO: mirror parse_BrtWbProp fields */\n\t\tif(data.filterPrivacy) flags |= 0x08;\n\t}\n\to.write_shift(4, flags);\n\to.write_shift(4, 0);\n\twrite_XLSBCodeName(data && data.CodeName || \"ThisWorkbook\", o);\n\treturn o.slice(0, o.l);\n}\n\nfunction parse_BrtFRTArchID$(data, length) {\n\tvar o = {};\n\tdata.read_shift(4);\n\to.ArchID = data.read_shift(4);\n\tdata.l += length - 8;\n\treturn o;\n}\n\n/* [MS-XLSB] 2.4.687 BrtName */\nfunction parse_BrtName(data, length, opts) {\n\tvar end = data.l + length;\n\tdata.l += 4; //var flags = data.read_shift(4);\n\tdata.l += 1; //var chKey = data.read_shift(1);\n\tvar itab = data.read_shift(4);\n\tvar name = parse_XLNameWideString(data);\n\tvar formula = parse_XLSBNameParsedFormula(data, 0, opts);\n\tvar comment = parse_XLNullableWideString(data);\n\t//if(0 /* fProc */) {\n\t\t// unusedstring1: XLNullableWideString\n\t\t// description: XLNullableWideString\n\t\t// helpTopic: XLNullableWideString\n\t\t// unusedstring2: XLNullableWideString\n\t//}\n\tdata.l = end;\n\tvar out = ({Name:name, Ptg:formula}/*:any*/);\n\tif(itab < 0xFFFFFFF) out.Sheet = itab;\n\tif(comment) out.Comment = comment;\n\treturn out;\n}\n\n/* [MS-XLSB] 2.1.7.61 Workbook */\nfunction parse_wb_bin(data, opts)/*:WorkbookFile*/ {\n\tvar wb = { AppVersion:{}, WBProps:{}, WBView:[], Sheets:[], CalcPr:{}, xmlns: \"\" };\n\tvar state/*:Array<string>*/ = [];\n\tvar pass = false;\n\n\tif(!opts) opts = {};\n\topts.biff = 12;\n\n\tvar Names = [];\n\tvar supbooks = ([[]]/*:any*/);\n\tsupbooks.SheetNames = [];\n\tsupbooks.XTI = [];\n\n\tXLSBRecordEnum[0x0010] = { n:\"BrtFRTArchID$\", f:parse_BrtFRTArchID$ };\n\n\trecordhopper(data, function hopper_wb(val, R, RT) {\n\t\tswitch(RT) {\n\t\t\tcase 0x009C: /* 'BrtBundleSh' */\n\t\t\t\tsupbooks.SheetNames.push(val.name);\n\t\t\t\twb.Sheets.push(val); break;\n\n\t\t\tcase 0x0099: /* 'BrtWbProp' */\n\t\t\t\twb.WBProps = val; break;\n\n\t\t\tcase 0x0027: /* 'BrtName' */\n\t\t\t\tif(val.Sheet != null) opts.SID = val.Sheet;\n\t\t\t\tval.Ref = stringify_formula(val.Ptg, null, null, supbooks, opts);\n\t\t\t\tdelete opts.SID;\n\t\t\t\tdelete val.Ptg;\n\t\t\t\tNames.push(val);\n\t\t\t\tbreak;\n\t\t\tcase 0x040C: /* 'BrtNameExt' */ break;\n\n\t\t\tcase 0x0165: /* 'BrtSupSelf' */\n\t\t\tcase 0x0166: /* 'BrtSupSame' */\n\t\t\tcase 0x0163: /* 'BrtSupBookSrc' */\n\t\t\tcase 0x029B: /* 'BrtSupAddin' */\n\t\t\t\tif(!supbooks[0].length) supbooks[0] = [RT, val];\n\t\t\t\telse supbooks.push([RT, val]);\n\t\t\t\tsupbooks[supbooks.length - 1].XTI = [];\n\t\t\t\tbreak;\n\t\t\tcase 0x016A: /* 'BrtExternSheet' */\n\t\t\t\tif(supbooks.length === 0) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\tsupbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val);\n\t\t\t\tsupbooks.XTI = supbooks.XTI.concat(val);\n\t\t\t\tbreak;\n\t\t\tcase 0x0169: /* 'BrtPlaceholderName' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0817: /* 'BrtAbsPath15' */\n\t\t\tcase 0x009E: /* 'BrtBookView' */\n\t\t\tcase 0x008F: /* 'BrtBeginBundleShs' */\n\t\t\tcase 0x0298: /* 'BrtBeginFnGroup' */\n\t\t\tcase 0x0161: /* 'BrtBeginExternals' */\n\t\t\t\tbreak;\n\n\t\t\t/* case 'BrtModelTimeGroupingCalcCol' */\n\t\t\tcase 0x0C00: /* 'BrtUid' */\n\t\t\tcase 0x0C01: /* 'BrtRevisionPtr' */\n\t\t\tcase 0x0216: /* 'BrtBookProtection' */\n\t\t\tcase 0x02A5: /* 'BrtBookProtectionIso' */\n\t\t\tcase 0x009D: /* 'BrtCalcProp' */\n\t\t\tcase 0x0262: /* 'BrtCrashRecErr' */\n\t\t\tcase 0x0802: /* 'BrtDecoupledPivotCacheID' */\n\t\t\tcase 0x009B: /* 'BrtFileRecover' */\n\t\t\tcase 0x0224: /* 'BrtFileSharing' */\n\t\t\tcase 0x02A4: /* 'BrtFileSharingIso' */\n\t\t\tcase 0x0080: /* 'BrtFileVersion' */\n\t\t\tcase 0x0299: /* 'BrtFnGroup' */\n\t\t\tcase 0x0850: /* 'BrtModelRelationship' */\n\t\t\tcase 0x084D: /* 'BrtModelTable' */\n\t\t\tcase 0x0225: /* 'BrtOleSize' */\n\t\t\tcase 0x0805: /* 'BrtPivotTableRef' */\n\t\t\tcase 0x0254: /* 'BrtSmartTagType' */\n\t\t\tcase 0x081C: /* 'BrtTableSlicerCacheID' */\n\t\t\tcase 0x081B: /* 'BrtTableSlicerCacheIDs' */\n\t\t\tcase 0x0822: /* 'BrtTimelineCachePivotCacheID' */\n\t\t\tcase 0x018D: /* 'BrtUserBookView' */\n\t\t\tcase 0x009A: /* 'BrtWbFactoid' */\n\t\t\tcase 0x045D: /* 'BrtWbProp14' */\n\t\t\tcase 0x0229: /* 'BrtWebOpt' */\n\t\t\tcase 0x082B: /* 'BrtWorkBookPr15' */\n\t\t\t\tbreak;\n\n\t\t\tcase 0x0023: /* 'BrtFRTBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0024: /* 'BrtFRTEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\t\t\tcase 0x0025: /* 'BrtACBegin' */\n\t\t\t\tstate.push(RT); pass = true; break;\n\t\t\tcase 0x0026: /* 'BrtACEnd' */\n\t\t\t\tstate.pop(); pass = false; break;\n\n\t\t\tcase 0x0010: /* 'BrtFRTArchID$' */ break;\n\n\t\t\tdefault:\n\t\t\t\tif(R.T){/* empty */}\n\t\t\t\telse if(!pass || (opts.WTF && state[state.length-1] != 0x0025 /* BrtACBegin */ && state[state.length-1] != 0x0023 /* BrtFRTBegin */)) throw new Error(\"Unexpected record 0x\" + RT.toString(16));\n\t\t}\n\t}, opts);\n\n\tparse_wb_defaults(wb);\n\n\t// $FlowIgnore\n\twb.Names = Names;\n\n\t(wb/*:any*/).supbooks = supbooks;\n\treturn wb;\n}\n\nfunction write_BUNDLESHS(ba, wb/*::, opts*/) {\n\twrite_record(ba, 0x008F /* BrtBeginBundleShs */);\n\tfor(var idx = 0; idx != wb.SheetNames.length; ++idx) {\n\t\tvar viz = wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx] && wb.Workbook.Sheets[idx].Hidden || 0;\n\t\tvar d = { Hidden: viz, iTabID: idx+1, strRelID: 'rId' + (idx+1), name: wb.SheetNames[idx] };\n\t\twrite_record(ba, 0x009C /* BrtBundleSh */, write_BrtBundleSh(d));\n\t}\n\twrite_record(ba, 0x0090 /* BrtEndBundleShs */);\n}\n\n/* [MS-XLSB] 2.4.649 BrtFileVersion */\nfunction write_BrtFileVersion(data, o) {\n\tif(!o) o = new_buf(127);\n\tfor(var i = 0; i != 4; ++i) o.write_shift(4, 0);\n\twrite_XLWideString(\"SheetJS\", o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(XLSX.version, o);\n\twrite_XLWideString(\"7262\", o);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\n/* [MS-XLSB] 2.4.301 BrtBookView */\nfunction write_BrtBookView(idx, o) {\n\tif(!o) o = new_buf(29);\n\to.write_shift(-4, 0);\n\to.write_shift(-4, 460);\n\to.write_shift(4,  28800);\n\to.write_shift(4,  17600);\n\to.write_shift(4,  500);\n\to.write_shift(4,  idx);\n\to.write_shift(4,  idx);\n\tvar flags = 0x78;\n\to.write_shift(1,  flags);\n\treturn o.length > o.l ? o.slice(0, o.l) : o;\n}\n\nfunction write_BOOKVIEWS(ba, wb/*::, opts*/) {\n\t/* required if hidden tab appears before visible tab */\n\tif(!wb.Workbook || !wb.Workbook.Sheets) return;\n\tvar sheets = wb.Workbook.Sheets;\n\tvar i = 0, vistab = -1, hidden = -1;\n\tfor(; i < sheets.length; ++i) {\n\t\tif(!sheets[i] || !sheets[i].Hidden && vistab == -1) vistab = i;\n\t\telse if(sheets[i].Hidden == 1 && hidden == -1) hidden = i;\n\t}\n\tif(hidden > vistab) return;\n\twrite_record(ba, 0x0087 /* BrtBeginBookViews */);\n\twrite_record(ba, 0x009E /* BrtBookView */, write_BrtBookView(vistab));\n\t/* 1*(BrtBookView *FRT) */\n\twrite_record(ba, 0x0088 /* BrtEndBookViews */);\n}\n\n/* [MS-XLSB] 2.4.305 BrtCalcProp */\n/*function write_BrtCalcProp(data, o) {\n\tif(!o) o = new_buf(26);\n\to.write_shift(4,0); // force recalc\n\to.write_shift(4,1);\n\to.write_shift(4,0);\n\twrite_Xnum(0, o);\n\to.write_shift(-4, 1023);\n\to.write_shift(1, 0x33);\n\to.write_shift(1, 0x00);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.4.646 BrtFileRecover */\n/*function write_BrtFileRecover(data, o) {\n\tif(!o) o = new_buf(1);\n\to.write_shift(1,0);\n\treturn o;\n}*/\n\n/* [MS-XLSB] 2.1.7.61 Workbook */\nfunction write_wb_bin(wb, opts) {\n\tvar ba = buf_array();\n\twrite_record(ba, 0x0083 /* BrtBeginBook */);\n\twrite_record(ba, 0x0080 /* BrtFileVersion */, write_BrtFileVersion());\n\t/* [[BrtFileSharingIso] BrtFileSharing] */\n\twrite_record(ba, 0x0099 /* BrtWbProp */, write_BrtWbProp(wb.Workbook && wb.Workbook.WBProps || null));\n\t/* [ACABSPATH] */\n\t/* [[BrtBookProtectionIso] BrtBookProtection] */\n\twrite_BOOKVIEWS(ba, wb, opts);\n\twrite_BUNDLESHS(ba, wb, opts);\n\t/* [FNGROUP] */\n\t/* [EXTERNALS] */\n\t/* *BrtName */\n\t/* write_record(ba, 0x009D BrtCalcProp, write_BrtCalcProp()); */\n\t/* [BrtOleSize] */\n\t/* *(BrtUserBookView *FRT) */\n\t/* [PIVOTCACHEIDS] */\n\t/* [BrtWbFactoid] */\n\t/* [SMARTTAGTYPES] */\n\t/* [BrtWebOpt] */\n\t/* write_record(ba, 0x009B BrtFileRecover, write_BrtFileRecover()); */\n\t/* [WEBPUBITEMS] */\n\t/* [CRERRS] */\n\t/* FRTWORKBOOK */\n\twrite_record(ba, 0x0084 /* BrtEndBook */);\n\n\treturn ba.end();\n}\nfunction parse_wb(data, name/*:string*/, opts)/*:WorkbookFile*/ {\n\tif(name.slice(-4)===\".bin\") return parse_wb_bin((data/*:any*/), opts);\n\treturn parse_wb_xml((data/*:any*/), opts);\n}\n\nfunction parse_ws(data, name/*:string*/, idx/*:number*/, opts, rels, wb, themes, styles)/*:Worksheet*/ {\n\tif(name.slice(-4)===\".bin\") return parse_ws_bin((data/*:any*/), opts, idx, rels, wb, themes, styles);\n\treturn parse_ws_xml((data/*:any*/), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_cs(data, name/*:string*/, idx/*:number*/, opts, rels, wb, themes, styles)/*:Worksheet*/ {\n\tif(name.slice(-4)===\".bin\") return parse_cs_bin((data/*:any*/), opts, idx, rels, wb, themes, styles);\n\treturn parse_cs_xml((data/*:any*/), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ms(data, name/*:string*/, idx/*:number*/, opts, rels, wb, themes, styles)/*:Worksheet*/ {\n\tif(name.slice(-4)===\".bin\") return parse_ms_bin((data/*:any*/), opts, idx, rels, wb, themes, styles);\n\treturn parse_ms_xml((data/*:any*/), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_ds(data, name/*:string*/, idx/*:number*/, opts, rels, wb, themes, styles)/*:Worksheet*/ {\n\tif(name.slice(-4)===\".bin\") return parse_ds_bin((data/*:any*/), opts, idx, rels, wb, themes, styles);\n\treturn parse_ds_xml((data/*:any*/), opts, idx, rels, wb, themes, styles);\n}\n\nfunction parse_sty(data, name/*:string*/, themes, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_sty_bin((data/*:any*/), themes, opts);\n\treturn parse_sty_xml((data/*:any*/), themes, opts);\n}\n\nfunction parse_theme(data/*:string*/, name/*:string*/, opts) {\n\treturn parse_theme_xml(data, opts);\n}\n\nfunction parse_sst(data, name/*:string*/, opts)/*:SST*/ {\n\tif(name.slice(-4)===\".bin\") return parse_sst_bin((data/*:any*/), opts);\n\treturn parse_sst_xml((data/*:any*/), opts);\n}\n\nfunction parse_cmnt(data, name/*:string*/, opts)/*:Array<RawComment>*/ {\n\tif(name.slice(-4)===\".bin\") return parse_comments_bin((data/*:any*/), opts);\n\treturn parse_comments_xml((data/*:any*/), opts);\n}\n\nfunction parse_cc(data, name/*:string*/, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_cc_bin((data/*:any*/), name, opts);\n\treturn parse_cc_xml((data/*:any*/), name, opts);\n}\n\nfunction parse_xlink(data, rel, name/*:string*/, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_xlink_bin((data/*:any*/), rel, name, opts);\n\treturn parse_xlink_xml((data/*:any*/), rel, name, opts);\n}\n\nfunction parse_xlmeta(data, name/*:string*/, opts) {\n\tif(name.slice(-4)===\".bin\") return parse_xlmeta_bin((data/*:any*/), name, opts);\n\treturn parse_xlmeta_xml((data/*:any*/), name, opts);\n}\n\nfunction write_wb(wb, name/*:string*/, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_wb_bin : write_wb_xml)(wb, opts);\n}\n\nfunction write_ws(data/*:number*/, name/*:string*/, opts, wb/*:Workbook*/, rels) {\n\treturn (name.slice(-4)===\".bin\" ? write_ws_bin : write_ws_xml)(data, opts, wb, rels);\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction write_cs(data/*:number*/, name/*:string*/, opts, wb/*:Workbook*/, rels) {\n\treturn (name.slice(-4)===\".bin\" ? write_cs_bin : write_cs_xml)(data, opts, wb, rels);\n}\n\nfunction write_sty(data, name/*:string*/, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_sty_bin : write_sty_xml)(data, opts);\n}\n\nfunction write_sst(data/*:SST*/, name/*:string*/, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_sst_bin : write_sst_xml)(data, opts);\n}\n\nfunction write_cmnt(data/*:Array<any>*/, name/*:string*/, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_comments_bin : write_comments_xml)(data, opts);\n}\n/*\nfunction write_cc(data, name:string, opts) {\n\treturn (name.slice(-4)===\".bin\" ? write_cc_bin : write_cc_xml)(data, opts);\n}\n*/\n\nfunction write_xlmeta(name/*:string*/) {\n\treturn (name.slice(-4)===\".bin\" ? write_xlmeta_bin : write_xlmeta_xml)();\n}\nvar attregexg2=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\nvar attregex2=/([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\nfunction xlml_parsexmltag(tag/*:string*/, skip_root/*:?boolean*/) {\n\tvar words = tag.split(/\\s+/);\n\tvar z/*:any*/ = ([]/*:any*/); if(!skip_root) z[0] = words[0];\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\n/*:: if(!y || !y[2]) continue; */\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\n\t\telse {\n\t\t\tif(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\n\t\t\telse w = y[1].slice(j+1);\n\t\t\tz[w] = y[2].slice(1,y[2].length-1);\n\t\t}\n\t}\n\treturn z;\n}\nfunction xlml_parsexmltagobj(tag/*:string*/) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = {};\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg2), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex2);\n/*:: if(!y || !y[2]) continue; */\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].slice(1,y[2].length-1);\n\t\telse {\n\t\t\tif(y[1].slice(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].slice(6);\n\t\t\telse w = y[1].slice(j+1);\n\t\t\tz[w] = y[2].slice(1,y[2].length-1);\n\t\t}\n\t}\n\treturn z;\n}\n\n// ----\n\n/* map from xlml named formats to SSF TODO: localize */\nvar XLMLFormatMap/*: {[string]:string}*/;\n\nfunction xlml_format(format, value)/*:string*/ {\n\tvar fmt = XLMLFormatMap[format] || unescapexml(format);\n\tif(fmt === \"General\") return SSF_general(value);\n\treturn SSF_format(fmt, value);\n}\n\nfunction xlml_set_custprop(Custprops, key, cp, val/*:string*/) {\n\tvar oval/*:any*/ = val;\n\tswitch((cp[0].match(/dt:dt=\"([\\w.]+)\"/)||[\"\",\"\"])[1]) {\n\t\tcase \"boolean\": oval = parsexmlbool(val); break;\n\t\tcase \"i2\": case \"int\": oval = parseInt(val, 10); break;\n\t\tcase \"r4\": case \"float\": oval = parseFloat(val); break;\n\t\tcase \"date\": case \"dateTime.tz\": oval = parseDate(val); break;\n\t\tcase \"i8\": case \"string\": case \"fixed\": case \"uuid\": case \"bin.base64\": break;\n\t\tdefault: throw new Error(\"bad custprop:\" + cp[0]);\n\t}\n\tCustprops[unescapexml(key)] = oval;\n}\n\nfunction safe_format_xlml(cell/*:Cell*/, nf, o) {\n\tif(cell.t === 'z') return;\n\tif(!o || o.cellText !== false) try {\n\t\tif(cell.t === 'e') { cell.w = cell.w || BErr[cell.v]; }\n\t\telse if(nf === \"General\") {\n\t\t\tif(cell.t === 'n') {\n\t\t\t\tif((cell.v|0) === cell.v) cell.w = cell.v.toString(10);\n\t\t\t\telse cell.w = SSF_general_num(cell.v);\n\t\t\t}\n\t\t\telse cell.w = SSF_general(cell.v);\n\t\t}\n\t\telse cell.w = xlml_format(nf||\"General\", cell.v);\n\t} catch(e) { if(o.WTF) throw e; }\n\ttry {\n\t\tvar z = XLMLFormatMap[nf]||nf||\"General\";\n\t\tif(o.cellNF) cell.z = z;\n\t\tif(o.cellDates && cell.t == 'n' && fmt_is_date(z)) {\n\t\t\tvar _d = SSF_parse_date_code(cell.v); if(_d) { cell.t = 'd'; cell.v = new Date(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u); }\n\t\t}\n\t} catch(e) { if(o.WTF) throw e; }\n}\n\nfunction process_style_xlml(styles, stag, opts) {\n\tif(opts.cellStyles) {\n\t\tif(stag.Interior) {\n\t\t\tvar I = stag.Interior;\n\t\t\tif(I.Pattern) I.patternType = XLMLPatternTypeMap[I.Pattern] || I.Pattern;\n\t\t}\n\t}\n\tstyles[stag.ID] = stag;\n}\n\n/* TODO: there must exist some form of OSP-blessed spec */\nfunction parse_xlml_data(xml, ss, data, cell/*:any*/, base, styles, csty, row, arrayf, o) {\n\tvar nf = \"General\", sid = cell.StyleID, S = {}; o = o || {};\n\tvar interiors = [];\n\tvar i = 0;\n\tif(sid === undefined && row) sid = row.StyleID;\n\tif(sid === undefined && csty) sid = csty.StyleID;\n\twhile(styles[sid] !== undefined) {\n\t\tif(styles[sid].nf) nf = styles[sid].nf;\n\t\tif(styles[sid].Interior) interiors.push(styles[sid].Interior);\n\t\tif(!styles[sid].Parent) break;\n\t\tsid = styles[sid].Parent;\n\t}\n\tswitch(data.Type) {\n\t\tcase 'Boolean':\n\t\t\tcell.t = 'b';\n\t\t\tcell.v = parsexmlbool(xml);\n\t\t\tbreak;\n\t\tcase 'String':\n\t\t\tcell.t = 's'; cell.r = xlml_fixstr(unescapexml(xml));\n\t\t\tcell.v = (xml.indexOf(\"<\") > -1 ? unescapexml(ss||xml).replace(/<.*?>/g, \"\") : cell.r); // todo: BR etc\n\t\t\tbreak;\n\t\tcase 'DateTime':\n\t\t\tif(xml.slice(-1) != \"Z\") xml += \"Z\";\n\t\t\tcell.v = (parseDate(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n\t\t\tif(cell.v !== cell.v) cell.v = unescapexml(xml);\n\t\t\telse if(cell.v<60) cell.v = cell.v -1;\n\t\t\tif(!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\t\t\t/* falls through */\n\t\tcase 'Number':\n\t\t\tif(cell.v === undefined) cell.v=+xml;\n\t\t\tif(!cell.t) cell.t = 'n';\n\t\t\tbreak;\n\t\tcase 'Error': cell.t = 'e'; cell.v = RBErr[xml]; if(o.cellText !== false) cell.w = xml; break;\n\t\tdefault:\n\t\t\tif(xml == \"\" && ss == \"\") { cell.t = 'z'; }\n\t\t\telse { cell.t = 's'; cell.v = xlml_fixstr(ss||xml); }\n\t\t\tbreak;\n\t}\n\tsafe_format_xlml(cell, nf, o);\n\tif(o.cellFormula !== false) {\n\t\tif(cell.Formula) {\n\t\t\tvar fstr = unescapexml(cell.Formula);\n\t\t\t/* strictly speaking, the leading = is required but some writers omit */\n\t\t\tif(fstr.charCodeAt(0) == 61 /* = */) fstr = fstr.slice(1);\n\t\t\tcell.f = rc_to_a1(fstr, base);\n\t\t\tdelete cell.Formula;\n\t\t\tif(cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);\n\t\t\telse if(cell.ArrayRange) {\n\t\t\t\tcell.F = rc_to_a1(cell.ArrayRange, base);\n\t\t\t\tarrayf.push([safe_decode_range(cell.F), cell.F]);\n\t\t\t}\n\t\t} else {\n\t\t\tfor(i = 0; i < arrayf.length; ++i)\n\t\t\t\tif(base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r)\n\t\t\t\t\tif(base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c)\n\t\t\t\t\t\tcell.F = arrayf[i][1];\n\t\t}\n\t}\n\tif(o.cellStyles) {\n\t\tinteriors.forEach(function(x) {\n\t\t\tif(!S.patternType && x.patternType) S.patternType = x.patternType;\n\t\t});\n\t\tcell.s = S;\n\t}\n\tif(cell.StyleID !== undefined) cell.ixfe = cell.StyleID;\n}\n\nfunction xlml_clean_comment(comment/*:any*/) {\n\tcomment.t = comment.v || \"\";\n\tcomment.t = comment.t.replace(/\\r\\n/g,\"\\n\").replace(/\\r/g,\"\\n\");\n\tcomment.v = comment.w = comment.ixfe = undefined;\n}\n\n/* TODO: Everything */\nfunction parse_xlml_xml(d, _opts)/*:Workbook*/ {\n\tvar opts = _opts || {};\n\tmake_ssf();\n\tvar str = debom(xlml_normalize(d));\n\tif(opts.type == 'binary' || opts.type == 'array' || opts.type == 'base64') {\n\t\tif(typeof $cptable !== 'undefined') str = $cptable.utils.decode(65001, char_codes(str));\n\t\telse str = utf8read(str);\n\t}\n\tvar opening = str.slice(0, 1024).toLowerCase(), ishtml = false;\n\topening = opening.replace(/\".*?\"/g, \"\");\n\tif((opening.indexOf(\">\") & 1023) > Math.min((opening.indexOf(\",\") & 1023), (opening.indexOf(\";\")&1023))) { var _o = dup(opts); _o.type = \"string\"; return PRN.to_workbook(str, _o); }\n\tif(opening.indexOf(\"<?xml\") == -1) [\"html\", \"table\", \"head\", \"meta\", \"script\", \"style\", \"div\"].forEach(function(tag) { if(opening.indexOf(\"<\" + tag) >= 0) ishtml = true; });\n\tif(ishtml) return html_to_workbook(str, opts);\n\n\tXLMLFormatMap = ({\n\t\t\"General Number\": \"General\",\n\t\t\"General Date\": table_fmt[22],\n\t\t\"Long Date\": \"dddd, mmmm dd, yyyy\",\n\t\t\"Medium Date\": table_fmt[15],\n\t\t\"Short Date\": table_fmt[14],\n\t\t\"Long Time\": table_fmt[19],\n\t\t\"Medium Time\": table_fmt[18],\n\t\t\"Short Time\": table_fmt[20],\n\t\t\"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\t\"Fixed\": table_fmt[2],\n\t\t\"Standard\": table_fmt[4],\n\t\t\"Percent\": table_fmt[10],\n\t\t\"Scientific\": table_fmt[11],\n\t\t\"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n\t\t\"True/False\": '\"True\";\"True\";\"False\";@',\n\t\t\"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n\t}/*:any*/);\n\n\n\tvar Rn;\n\tvar state = [], tmp;\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar sheets = {}, sheetnames/*:Array<string>*/ = [], cursheet/*:Worksheet*/ = (opts.dense ? [] : {}), sheetname = \"\";\n\tvar cell = ({}/*:any*/), row = {};// eslint-disable-line no-unused-vars\n\tvar dtag = xlml_parsexmltag('<Data ss:Type=\"String\">'), didx = 0;\n\tvar c = 0, r = 0;\n\tvar refguess/*:Range*/ = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\tvar styles = {}, stag = {};\n\tvar ss = \"\", fidx = 0;\n\tvar merges/*:Array<Range>*/ = [];\n\tvar Props = {}, Custprops = {}, pidx = 0, cp = [];\n\tvar comments/*:Array<Comment>*/ = [], comment/*:Comment*/ = ({}/*:any*/);\n\tvar cstys = [], csty, seencol = false;\n\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\tvar rowinfo/*:Array<RowInfo>*/ = [], rowobj = {}, cc = 0, rr = 0;\n\tvar Workbook/*:WBWBProps*/ = ({ Sheets:[], WBProps:{date1904:false} }/*:any*/), wsprops = {};\n\txlmlregex.lastIndex = 0;\n\tstr = str.replace(/<!--([\\s\\S]*?)-->/mg,\"\");\n\tvar raw_Rn3 = \"\";\n\twhile((Rn = xlmlregex.exec(str))) switch((Rn[3] = (raw_Rn3 = Rn[3]).toLowerCase())) {\n\t\tcase 'data' /*case 'Data'*/:\n\t\t\tif(raw_Rn3 == \"data\") {\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(state[state.length-1][1]) break;\n\t\t\tif(Rn[1]==='/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length-1][0]==/*\"Comment\"*/\"comment\"?comment:cell, {c:c,r:r}, styles, cstys[c], row, arrayf, opts);\n\t\t\telse { ss = \"\"; dtag = xlml_parsexmltag(Rn[0]); didx = Rn.index + Rn[0].length; }\n\t\t\tbreak;\n\t\tcase 'cell' /*case 'Cell'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif(comments.length > 0) cell.c = comments;\n\t\t\t\tif((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) {\n\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\tif(!cursheet[r]) cursheet[r] = [];\n\t\t\t\t\t\tcursheet[r][c] = cell;\n\t\t\t\t\t} else cursheet[encode_col(c) + encode_row(r)] = cell;\n\t\t\t\t}\n\t\t\t\tif(cell.HRef) {\n\t\t\t\t\tcell.l = ({Target:unescapexml(cell.HRef)}/*:any*/);\n\t\t\t\t\tif(cell.HRefScreenTip) cell.l.Tooltip = cell.HRefScreenTip;\n\t\t\t\t\tdelete cell.HRef; delete cell.HRefScreenTip;\n\t\t\t\t}\n\t\t\t\tif(cell.MergeAcross || cell.MergeDown) {\n\t\t\t\t\tcc = c + (parseInt(cell.MergeAcross,10)|0);\n\t\t\t\t\trr = r + (parseInt(cell.MergeDown,10)|0);\n\t\t\t\t\tmerges.push({s:{c:c,r:r},e:{c:cc,r:rr}});\n\t\t\t\t}\n\t\t\t\tif(!opts.sheetStubs) { if(cell.MergeAcross) c = cc + 1; else ++c; }\n\t\t\t\telse if(cell.MergeAcross || cell.MergeDown) {\n\t\t\t\t\t/*:: if(!cc) cc = 0; if(!rr) rr = 0; */\n\t\t\t\t\tfor(var cma = c; cma <= cc; ++cma) {\n\t\t\t\t\t\tfor(var cmd = r; cmd <= rr; ++cmd) {\n\t\t\t\t\t\t\tif(cma > c || cmd > r) {\n\t\t\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\t\t\tif(!cursheet[cmd]) cursheet[cmd] = [];\n\t\t\t\t\t\t\t\t\tcursheet[cmd][cma] = {t:'z'};\n\t\t\t\t\t\t\t\t} else cursheet[encode_col(cma) + encode_row(cmd)] = {t:'z'};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tc = cc + 1;\n\t\t\t\t}\n\t\t\t\telse ++c;\n\t\t\t} else {\n\t\t\t\tcell = xlml_parsexmltagobj(Rn[0]);\n\t\t\t\tif(cell.Index) c = +cell.Index - 1;\n\t\t\t\tif(c < refguess.s.c) refguess.s.c = c;\n\t\t\t\tif(c > refguess.e.c) refguess.e.c = c;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") ++c;\n\t\t\t\tcomments = [];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'row' /*case 'Row'*/:\n\t\t\tif(Rn[1]==='/' || Rn[0].slice(-2) === \"/>\") {\n\t\t\t\tif(r < refguess.s.r) refguess.s.r = r;\n\t\t\t\tif(r > refguess.e.r) refguess.e.r = r;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") {\n\t\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\t}\n\t\t\t\tc = 0; ++r;\n\t\t\t} else {\n\t\t\t\trow = xlml_parsexmltag(Rn[0]);\n\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\trowobj = {};\n\t\t\t\tif(row.AutoFitHeight == \"0\" || row.Height) {\n\t\t\t\t\trowobj.hpx = parseInt(row.Height, 10); rowobj.hpt = px2pt(rowobj.hpx);\n\t\t\t\t\trowinfo[r] = rowobj;\n\t\t\t\t}\n\t\t\t\tif(row.Hidden == \"1\") { rowobj.hidden = true; rowinfo[r] = rowobj; }\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'worksheet' /*case 'Worksheet'*/: /* TODO: read range from FullRows/FullColumns */\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t\tsheetnames.push(sheetname);\n\t\t\t\tif(refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) {\n\t\t\t\t\tcursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\tif(opts.sheetRows && opts.sheetRows <= refguess.e.r) {\n\t\t\t\t\t\tcursheet[\"!fullref\"] = cursheet[\"!ref\"];\n\t\t\t\t\t\trefguess.e.r = opts.sheetRows - 1;\n\t\t\t\t\t\tcursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(merges.length) cursheet[\"!merges\"] = merges;\n\t\t\t\tif(cstys.length > 0) cursheet[\"!cols\"] = cstys;\n\t\t\t\tif(rowinfo.length > 0) cursheet[\"!rows\"] = rowinfo;\n\t\t\t\tsheets[sheetname] = cursheet;\n\t\t\t} else {\n\t\t\t\trefguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\t\t\t\tr = c = 0;\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tsheetname = unescapexml(tmp.Name);\n\t\t\t\tcursheet = (opts.dense ? [] : {});\n\t\t\t\tmerges = [];\n\t\t\t\tarrayf = [];\n\t\t\t\trowinfo = [];\n\t\t\t\twsprops = {name:sheetname, Hidden:0};\n\t\t\t\tWorkbook.Sheets.push(wsprops);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'table' /*case 'Table'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].slice(-2) == \"/>\") break;\n\t\t\telse {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\tcstys = []; seencol = false;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'style' /*case 'Style'*/:\n\t\t\tif(Rn[1]==='/') process_style_xlml(styles, stag, opts);\n\t\t\telse stag = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\n\t\tcase 'numberformat' /*case 'NumberFormat'*/:\n\t\t\tstag.nf = unescapexml(xlml_parsexmltag(Rn[0]).Format || \"General\");\n\t\t\tif(XLMLFormatMap[stag.nf]) stag.nf = XLMLFormatMap[stag.nf];\n\t\t\tfor(var ssfidx = 0; ssfidx != 0x188; ++ssfidx) if(table_fmt[ssfidx] == stag.nf) break;\n\t\t\tif(ssfidx == 0x188) for(ssfidx = 0x39; ssfidx != 0x188; ++ssfidx) if(table_fmt[ssfidx] == null) { SSF_load(stag.nf, ssfidx); break; }\n\t\t\tbreak;\n\n\t\tcase 'column' /*case 'Column'*/:\n\t\t\tif(state[state.length-1][0] !== /*'Table'*/'table') break;\n\t\t\tcsty = xlml_parsexmltag(Rn[0]);\n\t\t\tif(csty.Hidden) { csty.hidden = true; delete csty.Hidden; }\n\t\t\tif(csty.Width) csty.wpx = parseInt(csty.Width, 10);\n\t\t\tif(!seencol && csty.wpx > 10) {\n\t\t\t\tseencol = true; MDW = DEF_MDW; //find_mdw_wpx(csty.wpx);\n\t\t\t\tfor(var _col = 0; _col < cstys.length; ++_col) if(cstys[_col]) process_col(cstys[_col]);\n\t\t\t}\n\t\t\tif(seencol) process_col(csty);\n\t\t\tcstys[(csty.Index-1||cstys.length)] = csty;\n\t\t\tfor(var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = dup(csty);\n\t\t\tbreak;\n\n\t\tcase 'namedrange' /*case 'NamedRange'*/:\n\t\t\tif(Rn[1]==='/') break;\n\t\t\tif(!Workbook.Names) Workbook.Names = [];\n\t\t\tvar _NamedRange = parsexmltag(Rn[0]);\n\t\t\tvar _DefinedName/*:DefinedName*/ = ({\n\t\t\t\tName: _NamedRange.Name,\n\t\t\t\tRef: rc_to_a1(_NamedRange.RefersTo.slice(1), {r:0, c:0})\n\t\t\t}/*:any*/);\n\t\t\tif(Workbook.Sheets.length>0) _DefinedName.Sheet=Workbook.Sheets.length-1;\n\t\t\t/*:: if(Workbook.Names) */Workbook.Names.push(_DefinedName);\n\t\t\tbreak;\n\n\t\tcase 'namedcell' /*case 'NamedCell'*/: break;\n\t\tcase 'b' /*case 'B'*/: break;\n\t\tcase 'i' /*case 'I'*/: break;\n\t\tcase 'u' /*case 'U'*/: break;\n\t\tcase 's' /*case 'S'*/: break;\n\t\tcase 'em' /*case 'EM'*/: break;\n\t\tcase 'h2' /*case 'H2'*/: break;\n\t\tcase 'h3' /*case 'H3'*/: break;\n\t\tcase 'sub' /*case 'Sub'*/: break;\n\t\tcase 'sup' /*case 'Sup'*/: break;\n\t\tcase 'span' /*case 'Span'*/: break;\n\t\tcase 'alignment' /*case 'Alignment'*/:\n\t\t\tbreak;\n\t\tcase 'borders' /*case 'Borders'*/: break;\n\t\tcase 'border' /*case 'Border'*/: break;\n\t\tcase 'font' /*case 'Font'*/:\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") ss += str.slice(fidx, Rn.index);\n\t\t\telse fidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'interior' /*case 'Interior'*/:\n\t\t\tif(!opts.cellStyles) break;\n\t\t\tstag.Interior = xlml_parsexmltag(Rn[0]);\n\t\t\tbreak;\n\t\tcase 'protection' /*case 'Protection'*/: break;\n\n\t\tcase 'author' /*case 'Author'*/:\n\t\tcase 'title' /*case 'Title'*/:\n\t\tcase 'description' /*case 'Description'*/:\n\t\tcase 'created' /*case 'Created'*/:\n\t\tcase 'keywords' /*case 'Keywords'*/:\n\t\tcase 'subject' /*case 'Subject'*/:\n\t\tcase 'category' /*case 'Category'*/:\n\t\tcase 'company' /*case 'Company'*/:\n\t\tcase 'lastauthor' /*case 'LastAuthor'*/:\n\t\tcase 'lastsaved' /*case 'LastSaved'*/:\n\t\tcase 'lastprinted' /*case 'LastPrinted'*/:\n\t\tcase 'version' /*case 'Version'*/:\n\t\tcase 'revision' /*case 'Revision'*/:\n\t\tcase 'totaltime' /*case 'TotalTime'*/:\n\t\tcase 'hyperlinkbase' /*case 'HyperlinkBase'*/:\n\t\tcase 'manager' /*case 'Manager'*/:\n\t\tcase 'contentstatus' /*case 'ContentStatus'*/:\n\t\tcase 'identifier' /*case 'Identifier'*/:\n\t\tcase 'language' /*case 'Language'*/:\n\t\tcase 'appname' /*case 'AppName'*/:\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") xlml_set_prop(Props, raw_Rn3, str.slice(pidx, Rn.index));\n\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'paragraphs' /*case 'Paragraphs'*/: break;\n\n\t\tcase 'styles' /*case 'Styles'*/:\n\t\tcase 'workbook' /*case 'Workbook'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse state.push([Rn[3], false]);\n\t\t\tbreak;\n\n\t\tcase 'comment' /*case 'Comment'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t\txlml_clean_comment(comment);\n\t\t\t\tcomments.push(comment);\n\t\t\t} else {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = xlml_parsexmltag(Rn[0]);\n\t\t\t\tcomment = ({a:tmp.Author}/*:any*/);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'autofilter' /*case 'AutoFilter'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\tvar AutoFilter = xlml_parsexmltag(Rn[0]);\n\t\t\t\tcursheet['!autofilter'] = { ref:rc_to_a1(AutoFilter.Range).replace(/\\$/g,\"\") };\n\t\t\t\tstate.push([Rn[3], true]);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'name' /*case 'Name'*/: break;\n\n\t\tcase 'datavalidation' /*case 'DataValidation'*/:\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));\n\t\t\t} else {\n\t\t\t\tif(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'pixelsperinch' /*case 'PixelsPerInch'*/:\n\t\t\tbreak;\n\t\tcase 'componentoptions' /*case 'ComponentOptions'*/:\n\t\tcase 'documentproperties' /*case 'DocumentProperties'*/:\n\t\tcase 'customdocumentproperties' /*case 'CustomDocumentProperties'*/:\n\t\tcase 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/:\n\t\tcase 'pivottable' /*case 'PivotTable'*/:\n\t\tcase 'pivotcache' /*case 'PivotCache'*/:\n\t\tcase 'names' /*case 'Names'*/:\n\t\tcase 'mapinfo' /*case 'MapInfo'*/:\n\t\tcase 'pagebreaks' /*case 'PageBreaks'*/:\n\t\tcase 'querytable' /*case 'QueryTable'*/:\n\t\tcase 'sorting' /*case 'Sorting'*/:\n\t\tcase 'schema' /*case 'Schema'*/: //case 'data' /*case 'data'*/:\n\t\tcase 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n\t\tcase 'smarttagtype' /*case 'SmartTagType'*/:\n\t\tcase 'smarttags' /*case 'SmartTags'*/:\n\t\tcase 'excelworkbook' /*case 'ExcelWorkbook'*/:\n\t\tcase 'workbookoptions' /*case 'WorkbookOptions'*/:\n\t\tcase 'worksheetoptions' /*case 'WorksheetOptions'*/:\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw new Error(\"Bad state: \"+tmp.join(\"|\"));}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\tbreak;\n\n\t\tcase 'null' /*case 'Null'*/: break;\n\n\t\tdefault:\n\t\t\t/* FODS file root is <office:document> */\n\t\t\tif(state.length == 0 && Rn[3] == \"document\") return parse_fods(str, opts);\n\t\t\t/* UOS file root is <uof:UOF> */\n\t\t\tif(state.length == 0 && Rn[3] == \"uof\"/*\"UOF\"*/) return parse_fods(str, opts);\n\n\t\t\tvar seen = true;\n\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t/* OfficeDocumentSettings */\n\t\t\t\tcase 'officedocumentsettings' /*case 'OfficeDocumentSettings'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'allowpng' /*case 'AllowPNG'*/: break;\n\t\t\t\t\tcase 'removepersonalinformation' /*case 'RemovePersonalInformation'*/: break;\n\t\t\t\t\tcase 'downloadcomponents' /*case 'DownloadComponents'*/: break;\n\t\t\t\t\tcase 'locationofcomponents' /*case 'LocationOfComponents'*/: break;\n\t\t\t\t\tcase 'colors' /*case 'Colors'*/: break;\n\t\t\t\t\tcase 'color' /*case 'Color'*/: break;\n\t\t\t\t\tcase 'index' /*case 'Index'*/: break;\n\t\t\t\t\tcase 'rgb' /*case 'RGB'*/: break;\n\t\t\t\t\tcase 'targetscreensize' /*case 'TargetScreenSize'*/: break;\n\t\t\t\t\tcase 'readonlyrecommended' /*case 'ReadOnlyRecommended'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ComponentOptions */\n\t\t\t\tcase 'componentoptions' /*case 'ComponentOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'toolbar' /*case 'Toolbar'*/: break;\n\t\t\t\t\tcase 'hideofficelogo' /*case 'HideOfficeLogo'*/: break;\n\t\t\t\t\tcase 'spreadsheetautofit' /*case 'SpreadsheetAutoFit'*/: break;\n\t\t\t\t\tcase 'label' /*case 'Label'*/: break;\n\t\t\t\t\tcase 'caption' /*case 'Caption'*/: break;\n\t\t\t\t\tcase 'maxheight' /*case 'MaxHeight'*/: break;\n\t\t\t\t\tcase 'maxwidth' /*case 'MaxWidth'*/: break;\n\t\t\t\t\tcase 'nextsheetnumber' /*case 'NextSheetNumber'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ExcelWorkbook */\n\t\t\t\tcase 'excelworkbook' /*case 'ExcelWorkbook'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'date1904' /*case 'Date1904'*/:\n\t\t\t\t\t\t/*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n\t\t\t\t\t\tWorkbook.WBProps.date1904 = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'windowheight' /*case 'WindowHeight'*/: break;\n\t\t\t\t\tcase 'windowwidth' /*case 'WindowWidth'*/: break;\n\t\t\t\t\tcase 'windowtopx' /*case 'WindowTopX'*/: break;\n\t\t\t\t\tcase 'windowtopy' /*case 'WindowTopY'*/: break;\n\t\t\t\t\tcase 'tabratio' /*case 'TabRatio'*/: break;\n\t\t\t\t\tcase 'protectstructure' /*case 'ProtectStructure'*/: break;\n\t\t\t\t\tcase 'protectwindow' /*case 'ProtectWindow'*/: break;\n\t\t\t\t\tcase 'protectwindows' /*case 'ProtectWindows'*/: break;\n\t\t\t\t\tcase 'activesheet' /*case 'ActiveSheet'*/: break;\n\t\t\t\t\tcase 'displayinknotes' /*case 'DisplayInkNotes'*/: break;\n\t\t\t\t\tcase 'firstvisiblesheet' /*case 'FirstVisibleSheet'*/: break;\n\t\t\t\t\tcase 'supbook' /*case 'SupBook'*/: break;\n\t\t\t\t\tcase 'sheetname' /*case 'SheetName'*/: break;\n\t\t\t\t\tcase 'sheetindex' /*case 'SheetIndex'*/: break;\n\t\t\t\t\tcase 'sheetindexfirst' /*case 'SheetIndexFirst'*/: break;\n\t\t\t\t\tcase 'sheetindexlast' /*case 'SheetIndexLast'*/: break;\n\t\t\t\t\tcase 'dll' /*case 'Dll'*/: break;\n\t\t\t\t\tcase 'acceptlabelsinformulas' /*case 'AcceptLabelsInFormulas'*/: break;\n\t\t\t\t\tcase 'donotsavelinkvalues' /*case 'DoNotSaveLinkValues'*/: break;\n\t\t\t\t\tcase 'iteration' /*case 'Iteration'*/: break;\n\t\t\t\t\tcase 'maxiterations' /*case 'MaxIterations'*/: break;\n\t\t\t\t\tcase 'maxchange' /*case 'MaxChange'*/: break;\n\t\t\t\t\tcase 'path' /*case 'Path'*/: break;\n\t\t\t\t\tcase 'xct' /*case 'Xct'*/: break;\n\t\t\t\t\tcase 'count' /*case 'Count'*/: break;\n\t\t\t\t\tcase 'selectedsheets' /*case 'SelectedSheets'*/: break;\n\t\t\t\t\tcase 'calculation' /*case 'Calculation'*/: break;\n\t\t\t\t\tcase 'uncalced' /*case 'Uncalced'*/: break;\n\t\t\t\t\tcase 'startupprompt' /*case 'StartupPrompt'*/: break;\n\t\t\t\t\tcase 'crn' /*case 'Crn'*/: break;\n\t\t\t\t\tcase 'externname' /*case 'ExternName'*/: break;\n\t\t\t\t\tcase 'formula' /*case 'Formula'*/: break;\n\t\t\t\t\tcase 'colfirst' /*case 'ColFirst'*/: break;\n\t\t\t\t\tcase 'collast' /*case 'ColLast'*/: break;\n\t\t\t\t\tcase 'wantadvise' /*case 'WantAdvise'*/: break;\n\t\t\t\t\tcase 'boolean' /*case 'Boolean'*/: break;\n\t\t\t\t\tcase 'error' /*case 'Error'*/: break;\n\t\t\t\t\tcase 'text' /*case 'Text'*/: break;\n\t\t\t\t\tcase 'ole' /*case 'OLE'*/: break;\n\t\t\t\t\tcase 'noautorecover' /*case 'NoAutoRecover'*/: break;\n\t\t\t\t\tcase 'publishobjects' /*case 'PublishObjects'*/: break;\n\t\t\t\t\tcase 'donotcalculatebeforesave' /*case 'DoNotCalculateBeforeSave'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'refmoder1c1' /*case 'RefModeR1C1'*/: break;\n\t\t\t\t\tcase 'embedsavesmarttags' /*case 'EmbedSaveSmartTags'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorkbookOptions */\n\t\t\t\tcase 'workbookoptions' /*case 'WorkbookOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'owcversion' /*case 'OWCVersion'*/: break;\n\t\t\t\t\tcase 'height' /*case 'Height'*/: break;\n\t\t\t\t\tcase 'width' /*case 'Width'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorksheetOptions */\n\t\t\t\tcase 'worksheetoptions' /*case 'WorksheetOptions'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'visible' /*case 'Visible'*/:\n\t\t\t\t\t\tif(Rn[0].slice(-2) === \"/>\"){/* empty */}\n\t\t\t\t\t\telse if(Rn[1]===\"/\") switch(str.slice(pidx, Rn.index)) {\n\t\t\t\t\t\t\tcase \"SheetHidden\": wsprops.Hidden = 1; break;\n\t\t\t\t\t\t\tcase \"SheetVeryHidden\": wsprops.Hidden = 2; break;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'header' /*case 'Header'*/:\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\n\t\t\t\t\t\tif(!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].header = +parsexmltag(Rn[0]).Margin;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'footer' /*case 'Footer'*/:\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={}, 'xlml');\n\t\t\t\t\t\tif(!isNaN(+parsexmltag(Rn[0]).Margin)) cursheet['!margins'].footer = +parsexmltag(Rn[0]).Margin;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'pagemargins' /*case 'PageMargins'*/:\n\t\t\t\t\t\tvar pagemargins = parsexmltag(Rn[0]);\n\t\t\t\t\t\tif(!cursheet['!margins']) default_margins(cursheet['!margins']={},'xlml');\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Top)) cursheet['!margins'].top = +pagemargins.Top;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Left)) cursheet['!margins'].left = +pagemargins.Left;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Right)) cursheet['!margins'].right = +pagemargins.Right;\n\t\t\t\t\t\tif(!isNaN(+pagemargins.Bottom)) cursheet['!margins'].bottom = +pagemargins.Bottom;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'displayrighttoleft' /*case 'DisplayRightToLeft'*/:\n\t\t\t\t\t\tif(!Workbook.Views) Workbook.Views = [];\n\t\t\t\t\t\tif(!Workbook.Views[0]) Workbook.Views[0] = {};\n\t\t\t\t\t\tWorkbook.Views[0].RTL = true;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'freezepanes' /*case 'FreezePanes'*/: break;\n\t\t\t\t\tcase 'frozennosplit' /*case 'FrozenNoSplit'*/: break;\n\n\t\t\t\t\tcase 'splithorizontal' /*case 'SplitHorizontal'*/:\n\t\t\t\t\tcase 'splitvertical' /*case 'SplitVertical'*/:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'donotdisplaygridlines' /*case 'DoNotDisplayGridlines'*/:\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'activerow' /*case 'ActiveRow'*/: break;\n\t\t\t\t\tcase 'activecol' /*case 'ActiveCol'*/: break;\n\t\t\t\t\tcase 'toprowbottompane' /*case 'TopRowBottomPane'*/: break;\n\t\t\t\t\tcase 'leftcolumnrightpane' /*case 'LeftColumnRightPane'*/: break;\n\n\t\t\t\t\tcase 'unsynced' /*case 'Unsynced'*/: break;\n\t\t\t\t\tcase 'print' /*case 'Print'*/: break;\n\t\t\t\t\tcase 'printerrors' /*case 'PrintErrors'*/: break;\n\t\t\t\t\tcase 'panes' /*case 'Panes'*/: break;\n\t\t\t\t\tcase 'scale' /*case 'Scale'*/: break;\n\t\t\t\t\tcase 'pane' /*case 'Pane'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'layout' /*case 'Layout'*/: break;\n\t\t\t\t\tcase 'pagesetup' /*case 'PageSetup'*/: break;\n\t\t\t\t\tcase 'selected' /*case 'Selected'*/: break;\n\t\t\t\t\tcase 'protectobjects' /*case 'ProtectObjects'*/: break;\n\t\t\t\t\tcase 'enableselection' /*case 'EnableSelection'*/: break;\n\t\t\t\t\tcase 'protectscenarios' /*case 'ProtectScenarios'*/: break;\n\t\t\t\t\tcase 'validprinterinfo' /*case 'ValidPrinterInfo'*/: break;\n\t\t\t\t\tcase 'horizontalresolution' /*case 'HorizontalResolution'*/: break;\n\t\t\t\t\tcase 'verticalresolution' /*case 'VerticalResolution'*/: break;\n\t\t\t\t\tcase 'numberofcopies' /*case 'NumberofCopies'*/: break;\n\t\t\t\t\tcase 'activepane' /*case 'ActivePane'*/: break;\n\t\t\t\t\tcase 'toprowvisible' /*case 'TopRowVisible'*/: break;\n\t\t\t\t\tcase 'leftcolumnvisible' /*case 'LeftColumnVisible'*/: break;\n\t\t\t\t\tcase 'fittopage' /*case 'FitToPage'*/: break;\n\t\t\t\t\tcase 'rangeselection' /*case 'RangeSelection'*/: break;\n\t\t\t\t\tcase 'papersizeindex' /*case 'PaperSizeIndex'*/: break;\n\t\t\t\t\tcase 'pagelayoutzoom' /*case 'PageLayoutZoom'*/: break;\n\t\t\t\t\tcase 'pagebreakzoom' /*case 'PageBreakZoom'*/: break;\n\t\t\t\t\tcase 'filteron' /*case 'FilterOn'*/: break;\n\t\t\t\t\tcase 'fitwidth' /*case 'FitWidth'*/: break;\n\t\t\t\t\tcase 'fitheight' /*case 'FitHeight'*/: break;\n\t\t\t\t\tcase 'commentslayout' /*case 'CommentsLayout'*/: break;\n\t\t\t\t\tcase 'zoom' /*case 'Zoom'*/: break;\n\t\t\t\t\tcase 'lefttoright' /*case 'LeftToRight'*/: break;\n\t\t\t\t\tcase 'gridlines' /*case 'Gridlines'*/: break;\n\t\t\t\t\tcase 'allowsort' /*case 'AllowSort'*/: break;\n\t\t\t\t\tcase 'allowfilter' /*case 'AllowFilter'*/: break;\n\t\t\t\t\tcase 'allowinsertrows' /*case 'AllowInsertRows'*/: break;\n\t\t\t\t\tcase 'allowdeleterows' /*case 'AllowDeleteRows'*/: break;\n\t\t\t\t\tcase 'allowinsertcols' /*case 'AllowInsertCols'*/: break;\n\t\t\t\t\tcase 'allowdeletecols' /*case 'AllowDeleteCols'*/: break;\n\t\t\t\t\tcase 'allowinserthyperlinks' /*case 'AllowInsertHyperlinks'*/: break;\n\t\t\t\t\tcase 'allowformatcells' /*case 'AllowFormatCells'*/: break;\n\t\t\t\t\tcase 'allowsizecols' /*case 'AllowSizeCols'*/: break;\n\t\t\t\t\tcase 'allowsizerows' /*case 'AllowSizeRows'*/: break;\n\t\t\t\t\tcase 'nosummaryrowsbelowdetail' /*case 'NoSummaryRowsBelowDetail'*/:\n\t\t\t\t\t\tif(!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n\t\t\t\t\t\tcursheet[\"!outline\"].above = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'tabcolorindex' /*case 'TabColorIndex'*/: break;\n\t\t\t\t\tcase 'donotdisplayheadings' /*case 'DoNotDisplayHeadings'*/: break;\n\t\t\t\t\tcase 'showpagelayoutzoom' /*case 'ShowPageLayoutZoom'*/: break;\n\t\t\t\t\tcase 'nosummarycolumnsrightdetail' /*case 'NoSummaryColumnsRightDetail'*/:\n\t\t\t\t\t\tif(!cursheet[\"!outline\"]) cursheet[\"!outline\"] = {};\n\t\t\t\t\t\tcursheet[\"!outline\"].left = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'blackandwhite' /*case 'BlackAndWhite'*/: break;\n\t\t\t\t\tcase 'donotdisplayzeros' /*case 'DoNotDisplayZeros'*/: break;\n\t\t\t\t\tcase 'displaypagebreak' /*case 'DisplayPageBreak'*/: break;\n\t\t\t\t\tcase 'rowcolheadings' /*case 'RowColHeadings'*/: break;\n\t\t\t\t\tcase 'donotdisplayoutline' /*case 'DoNotDisplayOutline'*/: break;\n\t\t\t\t\tcase 'noorientation' /*case 'NoOrientation'*/: break;\n\t\t\t\t\tcase 'allowusepivottables' /*case 'AllowUsePivotTables'*/: break;\n\t\t\t\t\tcase 'zeroheight' /*case 'ZeroHeight'*/: break;\n\t\t\t\t\tcase 'viewablerange' /*case 'ViewableRange'*/: break;\n\t\t\t\t\tcase 'selection' /*case 'Selection'*/: break;\n\t\t\t\t\tcase 'protectcontents' /*case 'ProtectContents'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PivotTable */\n\t\t\t\tcase 'pivottable' /*case 'PivotTable'*/: case 'pivotcache' /*case 'PivotCache'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'immediateitemsondrop' /*case 'ImmediateItemsOnDrop'*/: break;\n\t\t\t\t\tcase 'showpagemultipleitemlabel' /*case 'ShowPageMultipleItemLabel'*/: break;\n\t\t\t\t\tcase 'compactrowindent' /*case 'CompactRowIndent'*/: break;\n\t\t\t\t\tcase 'location' /*case 'Location'*/: break;\n\t\t\t\t\tcase 'pivotfield' /*case 'PivotField'*/: break;\n\t\t\t\t\tcase 'orientation' /*case 'Orientation'*/: break;\n\t\t\t\t\tcase 'layoutform' /*case 'LayoutForm'*/: break;\n\t\t\t\t\tcase 'layoutsubtotallocation' /*case 'LayoutSubtotalLocation'*/: break;\n\t\t\t\t\tcase 'layoutcompactrow' /*case 'LayoutCompactRow'*/: break;\n\t\t\t\t\tcase 'position' /*case 'Position'*/: break;\n\t\t\t\t\tcase 'pivotitem' /*case 'PivotItem'*/: break;\n\t\t\t\t\tcase 'datatype' /*case 'DataType'*/: break;\n\t\t\t\t\tcase 'datafield' /*case 'DataField'*/: break;\n\t\t\t\t\tcase 'sourcename' /*case 'SourceName'*/: break;\n\t\t\t\t\tcase 'parentfield' /*case 'ParentField'*/: break;\n\t\t\t\t\tcase 'ptlineitems' /*case 'PTLineItems'*/: break;\n\t\t\t\t\tcase 'ptlineitem' /*case 'PTLineItem'*/: break;\n\t\t\t\t\tcase 'countofsameitems' /*case 'CountOfSameItems'*/: break;\n\t\t\t\t\tcase 'item' /*case 'Item'*/: break;\n\t\t\t\t\tcase 'itemtype' /*case 'ItemType'*/: break;\n\t\t\t\t\tcase 'ptsource' /*case 'PTSource'*/: break;\n\t\t\t\t\tcase 'cacheindex' /*case 'CacheIndex'*/: break;\n\t\t\t\t\tcase 'consolidationreference' /*case 'ConsolidationReference'*/: break;\n\t\t\t\t\tcase 'filename' /*case 'FileName'*/: break;\n\t\t\t\t\tcase 'reference' /*case 'Reference'*/: break;\n\t\t\t\t\tcase 'nocolumngrand' /*case 'NoColumnGrand'*/: break;\n\t\t\t\t\tcase 'norowgrand' /*case 'NoRowGrand'*/: break;\n\t\t\t\t\tcase 'blanklineafteritems' /*case 'BlankLineAfterItems'*/: break;\n\t\t\t\t\tcase 'hidden' /*case 'Hidden'*/: break;\n\t\t\t\t\tcase 'subtotal' /*case 'Subtotal'*/: break;\n\t\t\t\t\tcase 'basefield' /*case 'BaseField'*/: break;\n\t\t\t\t\tcase 'mapchilditems' /*case 'MapChildItems'*/: break;\n\t\t\t\t\tcase 'function' /*case 'Function'*/: break;\n\t\t\t\t\tcase 'refreshonfileopen' /*case 'RefreshOnFileOpen'*/: break;\n\t\t\t\t\tcase 'printsettitles' /*case 'PrintSetTitles'*/: break;\n\t\t\t\t\tcase 'mergelabels' /*case 'MergeLabels'*/: break;\n\t\t\t\t\tcase 'defaultversion' /*case 'DefaultVersion'*/: break;\n\t\t\t\t\tcase 'refreshname' /*case 'RefreshName'*/: break;\n\t\t\t\t\tcase 'refreshdate' /*case 'RefreshDate'*/: break;\n\t\t\t\t\tcase 'refreshdatecopy' /*case 'RefreshDateCopy'*/: break;\n\t\t\t\t\tcase 'versionlastrefresh' /*case 'VersionLastRefresh'*/: break;\n\t\t\t\t\tcase 'versionlastupdate' /*case 'VersionLastUpdate'*/: break;\n\t\t\t\t\tcase 'versionupdateablemin' /*case 'VersionUpdateableMin'*/: break;\n\t\t\t\t\tcase 'versionrefreshablemin' /*case 'VersionRefreshableMin'*/: break;\n\t\t\t\t\tcase 'calculation' /*case 'Calculation'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PageBreaks */\n\t\t\t\tcase 'pagebreaks' /*case 'PageBreaks'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'colbreaks' /*case 'ColBreaks'*/: break;\n\t\t\t\t\tcase 'colbreak' /*case 'ColBreak'*/: break;\n\t\t\t\t\tcase 'rowbreaks' /*case 'RowBreaks'*/: break;\n\t\t\t\t\tcase 'rowbreak' /*case 'RowBreak'*/: break;\n\t\t\t\t\tcase 'colstart' /*case 'ColStart'*/: break;\n\t\t\t\t\tcase 'colend' /*case 'ColEnd'*/: break;\n\t\t\t\t\tcase 'rowend' /*case 'RowEnd'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* AutoFilter */\n\t\t\t\tcase 'autofilter' /*case 'AutoFilter'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'autofiltercolumn' /*case 'AutoFilterColumn'*/: break;\n\t\t\t\t\tcase 'autofiltercondition' /*case 'AutoFilterCondition'*/: break;\n\t\t\t\t\tcase 'autofilterand' /*case 'AutoFilterAnd'*/: break;\n\t\t\t\t\tcase 'autofilteror' /*case 'AutoFilterOr'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* QueryTable */\n\t\t\t\tcase 'querytable' /*case 'QueryTable'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'id' /*case 'Id'*/: break;\n\t\t\t\t\tcase 'autoformatfont' /*case 'AutoFormatFont'*/: break;\n\t\t\t\t\tcase 'autoformatpattern' /*case 'AutoFormatPattern'*/: break;\n\t\t\t\t\tcase 'querysource' /*case 'QuerySource'*/: break;\n\t\t\t\t\tcase 'querytype' /*case 'QueryType'*/: break;\n\t\t\t\t\tcase 'enableredirections' /*case 'EnableRedirections'*/: break;\n\t\t\t\t\tcase 'refreshedinxl9' /*case 'RefreshedInXl9'*/: break;\n\t\t\t\t\tcase 'urlstring' /*case 'URLString'*/: break;\n\t\t\t\t\tcase 'htmltables' /*case 'HTMLTables'*/: break;\n\t\t\t\t\tcase 'connection' /*case 'Connection'*/: break;\n\t\t\t\t\tcase 'commandtext' /*case 'CommandText'*/: break;\n\t\t\t\t\tcase 'refreshinfo' /*case 'RefreshInfo'*/: break;\n\t\t\t\t\tcase 'notitles' /*case 'NoTitles'*/: break;\n\t\t\t\t\tcase 'nextid' /*case 'NextId'*/: break;\n\t\t\t\t\tcase 'columninfo' /*case 'ColumnInfo'*/: break;\n\t\t\t\t\tcase 'overwritecells' /*case 'OverwriteCells'*/: break;\n\t\t\t\t\tcase 'donotpromptforfile' /*case 'DoNotPromptForFile'*/: break;\n\t\t\t\t\tcase 'textwizardsettings' /*case 'TextWizardSettings'*/: break;\n\t\t\t\t\tcase 'source' /*case 'Source'*/: break;\n\t\t\t\t\tcase 'number' /*case 'Number'*/: break;\n\t\t\t\t\tcase 'decimal' /*case 'Decimal'*/: break;\n\t\t\t\t\tcase 'thousandseparator' /*case 'ThousandSeparator'*/: break;\n\t\t\t\t\tcase 'trailingminusnumbers' /*case 'TrailingMinusNumbers'*/: break;\n\t\t\t\t\tcase 'formatsettings' /*case 'FormatSettings'*/: break;\n\t\t\t\t\tcase 'fieldtype' /*case 'FieldType'*/: break;\n\t\t\t\t\tcase 'delimiters' /*case 'Delimiters'*/: break;\n\t\t\t\t\tcase 'tab' /*case 'Tab'*/: break;\n\t\t\t\t\tcase 'comma' /*case 'Comma'*/: break;\n\t\t\t\t\tcase 'autoformatname' /*case 'AutoFormatName'*/: break;\n\t\t\t\t\tcase 'versionlastedit' /*case 'VersionLastEdit'*/: break;\n\t\t\t\t\tcase 'versionlastrefresh' /*case 'VersionLastRefresh'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\tcase 'datavalidation' /*case 'DataValidation'*/:\n\t\t\t\tswitch(Rn[3]) {\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\n\t\t\t\t\tcase 'type' /*case 'Type'*/: break;\n\t\t\t\t\tcase 'min' /*case 'Min'*/: break;\n\t\t\t\t\tcase 'max' /*case 'Max'*/: break;\n\t\t\t\t\tcase 'sort' /*case 'Sort'*/: break;\n\t\t\t\t\tcase 'descending' /*case 'Descending'*/: break;\n\t\t\t\t\tcase 'order' /*case 'Order'*/: break;\n\t\t\t\t\tcase 'casesensitive' /*case 'CaseSensitive'*/: break;\n\t\t\t\t\tcase 'value' /*case 'Value'*/: break;\n\t\t\t\t\tcase 'errorstyle' /*case 'ErrorStyle'*/: break;\n\t\t\t\t\tcase 'errormessage' /*case 'ErrorMessage'*/: break;\n\t\t\t\t\tcase 'errortitle' /*case 'ErrorTitle'*/: break;\n\t\t\t\t\tcase 'inputmessage' /*case 'InputMessage'*/: break;\n\t\t\t\t\tcase 'inputtitle' /*case 'InputTitle'*/: break;\n\t\t\t\t\tcase 'combohide' /*case 'ComboHide'*/: break;\n\t\t\t\t\tcase 'inputhide' /*case 'InputHide'*/: break;\n\t\t\t\t\tcase 'condition' /*case 'Condition'*/: break;\n\t\t\t\t\tcase 'qualifier' /*case 'Qualifier'*/: break;\n\t\t\t\t\tcase 'useblank' /*case 'UseBlank'*/: break;\n\t\t\t\t\tcase 'value1' /*case 'Value1'*/: break;\n\t\t\t\t\tcase 'value2' /*case 'Value2'*/: break;\n\t\t\t\t\tcase 'format' /*case 'Format'*/: break;\n\n\t\t\t\t\tcase 'cellrangelist' /*case 'CellRangeList'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\tcase 'sorting' /*case 'Sorting'*/:\n\t\t\t\tcase 'conditionalformatting' /*case 'ConditionalFormatting'*/:\n\t\t\t\tswitch(Rn[3]) {\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\t\t\t\t\tcase 'type' /*case 'Type'*/: break;\n\t\t\t\t\tcase 'min' /*case 'Min'*/: break;\n\t\t\t\t\tcase 'max' /*case 'Max'*/: break;\n\t\t\t\t\tcase 'sort' /*case 'Sort'*/: break;\n\t\t\t\t\tcase 'descending' /*case 'Descending'*/: break;\n\t\t\t\t\tcase 'order' /*case 'Order'*/: break;\n\t\t\t\t\tcase 'casesensitive' /*case 'CaseSensitive'*/: break;\n\t\t\t\t\tcase 'value' /*case 'Value'*/: break;\n\t\t\t\t\tcase 'errorstyle' /*case 'ErrorStyle'*/: break;\n\t\t\t\t\tcase 'errormessage' /*case 'ErrorMessage'*/: break;\n\t\t\t\t\tcase 'errortitle' /*case 'ErrorTitle'*/: break;\n\t\t\t\t\tcase 'cellrangelist' /*case 'CellRangeList'*/: break;\n\t\t\t\t\tcase 'inputmessage' /*case 'InputMessage'*/: break;\n\t\t\t\t\tcase 'inputtitle' /*case 'InputTitle'*/: break;\n\t\t\t\t\tcase 'combohide' /*case 'ComboHide'*/: break;\n\t\t\t\t\tcase 'inputhide' /*case 'InputHide'*/: break;\n\t\t\t\t\tcase 'condition' /*case 'Condition'*/: break;\n\t\t\t\t\tcase 'qualifier' /*case 'Qualifier'*/: break;\n\t\t\t\t\tcase 'useblank' /*case 'UseBlank'*/: break;\n\t\t\t\t\tcase 'value1' /*case 'Value1'*/: break;\n\t\t\t\t\tcase 'value2' /*case 'Value2'*/: break;\n\t\t\t\t\tcase 'format' /*case 'Format'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* MapInfo (schema) */\n\t\t\t\tcase 'mapinfo' /*case 'MapInfo'*/: case 'schema' /*case 'Schema'*/: case 'data' /*case 'data'*/: switch(Rn[3]) {\n\t\t\t\t\tcase 'map' /*case 'Map'*/: break;\n\t\t\t\t\tcase 'entry' /*case 'Entry'*/: break;\n\t\t\t\t\tcase 'range' /*case 'Range'*/: break;\n\t\t\t\t\tcase 'xpath' /*case 'XPath'*/: break;\n\t\t\t\t\tcase 'field' /*case 'Field'*/: break;\n\t\t\t\t\tcase 'xsdtype' /*case 'XSDType'*/: break;\n\t\t\t\t\tcase 'filteron' /*case 'FilterOn'*/: break;\n\t\t\t\t\tcase 'aggregate' /*case 'Aggregate'*/: break;\n\t\t\t\t\tcase 'elementtype' /*case 'ElementType'*/: break;\n\t\t\t\t\tcase 'attributetype' /*case 'AttributeType'*/: break;\n\t\t\t\t/* These are from xsd (XML Schema Definition) */\n\t\t\t\t\tcase 'schema' /*case 'schema'*/:\n\t\t\t\t\tcase 'element' /*case 'element'*/:\n\t\t\t\t\tcase 'complextype' /*case 'complexType'*/:\n\t\t\t\t\tcase 'datatype' /*case 'datatype'*/:\n\t\t\t\t\tcase 'all' /*case 'all'*/:\n\t\t\t\t\tcase 'attribute' /*case 'attribute'*/:\n\t\t\t\t\tcase 'extends' /*case 'extends'*/: break;\n\n\t\t\t\t\tcase 'row' /*case 'row'*/: break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* SmartTags (can be anything) */\n\t\t\t\tcase 'smarttags' /*case 'SmartTags'*/: break;\n\n\t\t\t\tdefault: seen = false; break;\n\t\t\t}\n\t\t\tif(seen) break;\n\t\t\t/* CustomDocumentProperties */\n\t\t\tif(Rn[3].match(/!\\[CDATA/)) break;\n\t\t\tif(!state[state.length-1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t\t\tif(state[state.length-1][0]===/*'CustomDocumentProperties'*/'customdocumentproperties') {\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") xlml_set_custprop(Custprops, raw_Rn3, cp, str.slice(pidx, Rn.index));\n\t\t\t\telse { cp = Rn; pidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t}\n\tvar out = ({}/*:any*/);\n\tif(!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n\tout.SheetNames = sheetnames;\n\tout.Workbook = Workbook;\n\tout.SSF = dup(table_fmt);\n\tout.Props = Props;\n\tout.Custprops = Custprops;\n\treturn out;\n}\n\nfunction parse_xlml(data/*:RawBytes|string*/, opts)/*:Workbook*/ {\n\tfix_read_opts(opts=opts||{});\n\tswitch(opts.type||\"base64\") {\n\t\tcase \"base64\": return parse_xlml_xml(Base64_decode(data), opts);\n\t\tcase \"binary\": case \"buffer\": case \"file\": return parse_xlml_xml(data, opts);\n\t\tcase \"array\": return parse_xlml_xml(a2s(data), opts);\n\t}\n\t/*:: throw new Error(\"unsupported type \" + opts.type); */\n}\n\n/* TODO */\nfunction write_props_xlml(wb/*:Workbook*/, opts)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\t/* DocumentProperties */\n\tif(wb.Props) o.push(xlml_write_docprops(wb.Props, opts));\n\t/* CustomDocumentProperties */\n\tif(wb.Custprops) o.push(xlml_write_custprops(wb.Props, wb.Custprops, opts));\n\treturn o.join(\"\");\n}\n/* TODO */\nfunction write_wb_xlml(/*::wb, opts*/)/*:string*/ {\n\t/* OfficeDocumentSettings */\n\t/* ExcelWorkbook */\n\treturn \"\";\n}\n/* TODO */\nfunction write_sty_xlml(wb, opts)/*:string*/ {\n\t/* Styles */\n\tvar styles/*:Array<string>*/ = ['<Style ss:ID=\"Default\" ss:Name=\"Normal\"><NumberFormat/></Style>'];\n\topts.cellXfs.forEach(function(xf, id) {\n\t\tvar payload/*:Array<string>*/ = [];\n\t\tpayload.push(writextag('NumberFormat', null, {\"ss:Format\": escapexml(table_fmt[xf.numFmtId])}));\n\n\t\tvar o = /*::(*/{\"ss:ID\": \"s\" + (21+id)}/*:: :any)*/;\n\t\tstyles.push(writextag('Style', payload.join(\"\"), o));\n\t});\n\treturn writextag(\"Styles\", styles.join(\"\"));\n}\nfunction write_name_xlml(n) { return writextag(\"NamedRange\", null, {\"ss:Name\": n.Name, \"ss:RefersTo\":\"=\" + a1_to_rc(n.Ref, {r:0,c:0})}); }\nfunction write_names_xlml(wb/*::, opts*/)/*:string*/ {\n\tif(!((wb||{}).Workbook||{}).Names) return \"\";\n\t/*:: if(!wb || !wb.Workbook || !wb.Workbook.Names) throw new Error(\"unreachable\"); */\n\tvar names/*:Array<any>*/ = wb.Workbook.Names;\n\tvar out/*:Array<string>*/ = [];\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar n = names[i];\n\t\tif(n.Sheet != null) continue;\n\t\tif(n.Name.match(/^_xlfn\\./)) continue;\n\t\tout.push(write_name_xlml(n));\n\t}\n\treturn writextag(\"Names\", out.join(\"\"));\n}\nfunction write_ws_xlml_names(ws/*:Worksheet*/, opts, idx/*:number*/, wb/*:Workbook*/)/*:string*/ {\n\tif(!ws) return \"\";\n\tif(!((wb||{}).Workbook||{}).Names) return \"\";\n\t/*:: if(!wb || !wb.Workbook || !wb.Workbook.Names) throw new Error(\"unreachable\"); */\n\tvar names/*:Array<any>*/ = wb.Workbook.Names;\n\tvar out/*:Array<string>*/ = [];\n\tfor(var i = 0; i < names.length; ++i) {\n\t\tvar n = names[i];\n\t\tif(n.Sheet != idx) continue;\n\t\t/*switch(n.Name) {\n\t\t\tcase \"_\": continue;\n\t\t}*/\n\t\tif(n.Name.match(/^_xlfn\\./)) continue;\n\t\tout.push(write_name_xlml(n));\n\t}\n\treturn out.join(\"\");\n}\n/* WorksheetOptions */\nfunction write_ws_xlml_wsopts(ws/*:Worksheet*/, opts, idx/*:number*/, wb/*:Workbook*/)/*:string*/ {\n\tif(!ws) return \"\";\n\tvar o/*:Array<string>*/ = [];\n\t/* NOTE: spec technically allows any order, but stick with implied order */\n\n\t/* FitToPage */\n\t/* DoNotDisplayColHeaders */\n\t/* DoNotDisplayRowHeaders */\n\t/* ViewableRange */\n\t/* Selection */\n\t/* GridlineColor */\n\t/* Name */\n\t/* ExcelWorksheetType */\n\t/* IntlMacro */\n\t/* Unsynced */\n\t/* Selected */\n\t/* CodeName */\n\n\tif(ws['!margins']) {\n\t\to.push(\"<PageSetup>\");\n\t\tif(ws['!margins'].header) o.push(writextag(\"Header\", null, {'x:Margin':ws['!margins'].header}));\n\t\tif(ws['!margins'].footer) o.push(writextag(\"Footer\", null, {'x:Margin':ws['!margins'].footer}));\n\t\to.push(writextag(\"PageMargins\", null, {\n\t\t\t'x:Bottom': ws['!margins'].bottom || \"0.75\",\n\t\t\t'x:Left': ws['!margins'].left || \"0.7\",\n\t\t\t'x:Right': ws['!margins'].right || \"0.7\",\n\t\t\t'x:Top': ws['!margins'].top || \"0.75\"\n\t\t}));\n\t\to.push(\"</PageSetup>\");\n\t}\n\n\t/* PageSetup */\n\t/* DisplayPageBreak */\n\t/* TransitionExpressionEvaluation */\n\t/* TransitionFormulaEntry */\n\t/* Print */\n\t/* Zoom */\n\t/* PageLayoutZoom */\n\t/* PageBreakZoom */\n\t/* ShowPageBreakZoom */\n\t/* DefaultRowHeight */\n\t/* DefaultColumnWidth */\n\t/* StandardWidth */\n\n\tif(wb && wb.Workbook && wb.Workbook.Sheets && wb.Workbook.Sheets[idx]) {\n\t\t/* Visible */\n\t\tif(wb.Workbook.Sheets[idx].Hidden) o.push(writextag(\"Visible\", (wb.Workbook.Sheets[idx].Hidden == 1 ? \"SheetHidden\" : \"SheetVeryHidden\"), {}));\n\t\telse {\n\t\t\t/* Selected */\n\t\t\tfor(var i = 0; i < idx; ++i) if(wb.Workbook.Sheets[i] && !wb.Workbook.Sheets[i].Hidden) break;\n\t\t\tif(i == idx) o.push(\"<Selected/>\");\n\t\t}\n\t}\n\n\t/* LeftColumnVisible */\n\n\tif(((((wb||{}).Workbook||{}).Views||[])[0]||{}).RTL) o.push(\"<DisplayRightToLeft/>\");\n\n\t/* GridlineColorIndex */\n\t/* DisplayFormulas */\n\t/* DoNotDisplayGridlines */\n\t/* DoNotDisplayHeadings */\n\t/* DoNotDisplayOutline */\n\t/* ApplyAutomaticOutlineStyles */\n\t/* NoSummaryRowsBelowDetail */\n\t/* NoSummaryColumnsRightDetail */\n\t/* DoNotDisplayZeros */\n\t/* ActiveRow */\n\t/* ActiveColumn */\n\t/* FilterOn */\n\t/* RangeSelection */\n\t/* TopRowVisible */\n\t/* TopRowBottomPane */\n\t/* LeftColumnRightPane */\n\t/* ActivePane */\n\t/* SplitHorizontal */\n\t/* SplitVertical */\n\t/* FreezePanes */\n\t/* FrozenNoSplit */\n\t/* TabColorIndex */\n\t/* Panes */\n\n\t/* NOTE: Password not supported in XLML Format */\n\tif(ws['!protect']) {\n\t\to.push(writetag(\"ProtectContents\", \"True\"));\n\t\tif(ws['!protect'].objects) o.push(writetag(\"ProtectObjects\", \"True\"));\n\t\tif(ws['!protect'].scenarios) o.push(writetag(\"ProtectScenarios\", \"True\"));\n\t\tif(ws['!protect'].selectLockedCells != null && !ws['!protect'].selectLockedCells) o.push(writetag(\"EnableSelection\", \"NoSelection\"));\n\t\telse if(ws['!protect'].selectUnlockedCells != null && !ws['!protect'].selectUnlockedCells) o.push(writetag(\"EnableSelection\", \"UnlockedCells\"));\n\t[\n\t\t[ \"formatCells\", \"AllowFormatCells\" ],\n\t\t[ \"formatColumns\", \"AllowSizeCols\" ],\n\t\t[ \"formatRows\", \"AllowSizeRows\" ],\n\t\t[ \"insertColumns\", \"AllowInsertCols\" ],\n\t\t[ \"insertRows\", \"AllowInsertRows\" ],\n\t\t[ \"insertHyperlinks\", \"AllowInsertHyperlinks\" ],\n\t\t[ \"deleteColumns\", \"AllowDeleteCols\" ],\n\t\t[ \"deleteRows\", \"AllowDeleteRows\" ],\n\t\t[ \"sort\", \"AllowSort\" ],\n\t\t[ \"autoFilter\", \"AllowFilter\" ],\n\t\t[ \"pivotTables\", \"AllowUsePivotTables\" ]\n\t].forEach(function(x) { if(ws['!protect'][x[0]]) o.push(\"<\"+x[1]+\"/>\"); });\n\t}\n\n\tif(o.length == 0) return \"\";\n\treturn writextag(\"WorksheetOptions\", o.join(\"\"), {xmlns:XLMLNS.x});\n}\nfunction write_ws_xlml_comment(comments/*:Array<any>*/)/*:string*/ {\n\treturn comments.map(function(c) {\n\t\t// TODO: formatted text\n\t\tvar t = xlml_unfixstr(c.t||\"\");\n\t\tvar d =writextag(\"ss:Data\", t, {\"xmlns\":\"http://www.w3.org/TR/REC-html40\"});\n\t\treturn writextag(\"Comment\", d, {\"ss:Author\":c.a});\n\t}).join(\"\");\n}\nfunction write_ws_xlml_cell(cell, ref/*:string*/, ws, opts, idx/*:number*/, wb, addr)/*:string*/{\n\tif(!cell || (cell.v == undefined && cell.f == undefined)) return \"\";\n\n\tvar attr = {};\n\tif(cell.f) attr[\"ss:Formula\"] = \"=\" + escapexml(a1_to_rc(cell.f, addr));\n\tif(cell.F && cell.F.slice(0, ref.length) == ref) {\n\t\tvar end = decode_cell(cell.F.slice(ref.length + 1));\n\t\tattr[\"ss:ArrayRange\"] = \"RC:R\" + (end.r == addr.r ? \"\" : \"[\" + (end.r - addr.r) + \"]\") + \"C\" + (end.c == addr.c ? \"\" : \"[\" + (end.c - addr.c) + \"]\");\n\t}\n\n\tif(cell.l && cell.l.Target) {\n\t\tattr[\"ss:HRef\"] = escapexml(cell.l.Target);\n\t\tif(cell.l.Tooltip) attr[\"x:HRefScreenTip\"] = escapexml(cell.l.Tooltip);\n\t}\n\n\tif(ws['!merges']) {\n\t\tvar marr = ws['!merges'];\n\t\tfor(var mi = 0; mi != marr.length; ++mi) {\n\t\t\tif(marr[mi].s.c != addr.c || marr[mi].s.r != addr.r) continue;\n\t\t\tif(marr[mi].e.c > marr[mi].s.c) attr['ss:MergeAcross'] = marr[mi].e.c - marr[mi].s.c;\n\t\t\tif(marr[mi].e.r > marr[mi].s.r) attr['ss:MergeDown'] = marr[mi].e.r - marr[mi].s.r;\n\t\t}\n\t}\n\n\tvar t = \"\", p = \"\";\n\tswitch(cell.t) {\n\t\tcase 'z': if(!opts.sheetStubs) return \"\"; break;\n\t\tcase 'n': t = 'Number'; p = String(cell.v); break;\n\t\tcase 'b': t = 'Boolean'; p = (cell.v ? \"1\" : \"0\"); break;\n\t\tcase 'e': t = 'Error'; p = BErr[cell.v]; break;\n\t\tcase 'd': t = 'DateTime'; p = new Date(cell.v).toISOString(); if(cell.z == null) cell.z = cell.z || table_fmt[14]; break;\n\t\tcase 's': t = 'String'; p = escapexlml(cell.v||\"\"); break;\n\t}\n\t/* TODO: cell style */\n\tvar os = get_cell_style(opts.cellXfs, cell, opts);\n\tattr[\"ss:StyleID\"] = \"s\" + (21+os);\n\tattr[\"ss:Index\"] = addr.c + 1;\n\tvar _v = (cell.v != null ? p : \"\");\n\tvar m = cell.t == 'z' ? \"\" : ('<Data ss:Type=\"' + t + '\">' + _v + '</Data>');\n\n\tif((cell.c||[]).length > 0) m += write_ws_xlml_comment(cell.c);\n\n\treturn writextag(\"Cell\", m, attr);\n}\nfunction write_ws_xlml_row(R/*:number*/, row)/*:string*/ {\n\tvar o = '<Row ss:Index=\"' + (R+1) + '\"';\n\tif(row) {\n\t\tif(row.hpt && !row.hpx) row.hpx = pt2px(row.hpt);\n\t\tif(row.hpx) o += ' ss:AutoFitHeight=\"0\" ss:Height=\"' + row.hpx + '\"';\n\t\tif(row.hidden) o += ' ss:Hidden=\"1\"';\n\t}\n\treturn o + '>';\n}\n/* TODO */\nfunction write_ws_xlml_table(ws/*:Worksheet*/, opts, idx/*:number*/, wb/*:Workbook*/)/*:string*/ {\n\tif(!ws['!ref']) return \"\";\n\tvar range/*:Range*/ = safe_decode_range(ws['!ref']);\n\tvar marr/*:Array<Range>*/ = ws['!merges'] || [], mi = 0;\n\tvar o/*:Array<string>*/ = [];\n\tif(ws['!cols']) ws['!cols'].forEach(function(n, i) {\n\t\tprocess_col(n);\n\t\tvar w = !!n.width;\n\t\tvar p = col_obj_w(i, n);\n\t\tvar k/*:any*/ = {\"ss:Index\":i+1};\n\t\tif(w) k['ss:Width'] = width2px(p.width);\n\t\tif(n.hidden) k['ss:Hidden']=\"1\";\n\t\to.push(writextag(\"Column\",null,k));\n\t});\n\tvar dense = Array.isArray(ws);\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\tvar row = [write_ws_xlml_row(R, (ws['!rows']||[])[R])];\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tvar skip = false;\n\t\t\tfor(mi = 0; mi != marr.length; ++mi) {\n\t\t\t\tif(marr[mi].s.c > C) continue;\n\t\t\t\tif(marr[mi].s.r > R) continue;\n\t\t\t\tif(marr[mi].e.c < C) continue;\n\t\t\t\tif(marr[mi].e.r < R) continue;\n\t\t\t\tif(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(skip) continue;\n\t\t\tvar addr = {r:R,c:C};\n\t\t\tvar ref = encode_cell(addr), cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\trow.push(write_ws_xlml_cell(cell, ref, ws, opts, idx, wb, addr));\n\t\t}\n\t\trow.push(\"</Row>\");\n\t\tif(row.length > 2) o.push(row.join(\"\"));\n\t}\n\treturn o.join(\"\");\n}\nfunction write_ws_xlml(idx/*:number*/, opts, wb/*:Workbook*/)/*:string*/ {\n\tvar o/*:Array<string>*/ = [];\n\tvar s = wb.SheetNames[idx];\n\tvar ws = wb.Sheets[s];\n\n\tvar t/*:string*/ = ws ? write_ws_xlml_names(ws, opts, idx, wb) : \"\";\n\tif(t.length > 0) o.push(\"<Names>\" + t + \"</Names>\");\n\n\t/* Table */\n\tt = ws ? write_ws_xlml_table(ws, opts, idx, wb) : \"\";\n\tif(t.length > 0) o.push(\"<Table>\" + t + \"</Table>\");\n\n\t/* WorksheetOptions */\n\to.push(write_ws_xlml_wsopts(ws, opts, idx, wb));\n\n\treturn o.join(\"\");\n}\nfunction write_xlml(wb, opts)/*:string*/ {\n\tif(!opts) opts = {};\n\tif(!wb.SSF) wb.SSF = dup(table_fmt);\n\tif(wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t\topts.cellXfs = [];\n\t\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\t}\n\tvar d/*:Array<string>*/ = [];\n\td.push(write_props_xlml(wb, opts));\n\td.push(write_wb_xlml(wb, opts));\n\td.push(\"\");\n\td.push(\"\");\n\tfor(var i = 0; i < wb.SheetNames.length; ++i)\n\t\td.push(writextag(\"Worksheet\", write_ws_xlml(i, opts, wb), {\"ss:Name\":escapexml(wb.SheetNames[i])}));\n\td[2] = write_sty_xlml(wb, opts);\n\td[3] = write_names_xlml(wb, opts);\n\treturn XML_HEADER + writextag(\"Workbook\", d.join(\"\"), {\n\t\t'xmlns':      XLMLNS.ss,\n\t\t'xmlns:o':    XLMLNS.o,\n\t\t'xmlns:x':    XLMLNS.x,\n\t\t'xmlns:ss':   XLMLNS.ss,\n\t\t'xmlns:dt':   XLMLNS.dt,\n\t\t'xmlns:html': XLMLNS.html\n\t});\n}\n/* [MS-OLEDS] 2.3.8 CompObjStream */\nfunction parse_compobj(obj/*:CFBEntry*/) {\n\tvar v = {};\n\tvar o = obj.content;\n\t/*:: if(o == null) return; */\n\n\t/* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\to.l = 28;\n\n\tv.AnsiUserType = o.read_shift(0, \"lpstr-ansi\");\n\tv.AnsiClipboardFormat = parse_ClipboardFormatOrAnsiString(o);\n\n\tif(o.length - o.l <= 4) return v;\n\n\tvar m/*:number*/ = o.read_shift(4);\n\tif(m == 0 || m > 40) return v;\n\to.l-=4; v.Reserved1 = o.read_shift(0, \"lpstr-ansi\");\n\n\tif(o.length - o.l <= 4) return v;\n\tm = o.read_shift(4);\n\tif(m !== 0x71b239f4) return v;\n\tv.UnicodeClipboardFormat = parse_ClipboardFormatOrUnicodeString(o);\n\n\tm = o.read_shift(4);\n\tif(m == 0 || m > 40) return v;\n\to.l-=4; v.Reserved2 = o.read_shift(0, \"lpwstr\");\n}\n\n/*\n\tContinue logic for:\n\t- 2.4.58 Continue          0x003c\n\t- 2.4.59 ContinueBigName   0x043c\n\t- 2.4.60 ContinueFrt       0x0812\n\t- 2.4.61 ContinueFrt11     0x0875\n\t- 2.4.62 ContinueFrt12     0x087f\n*/\nvar CONTINUE_RT = [ 0x003c, 0x043c, 0x0812, 0x0875, 0x087f ];\nfunction slurp(RecordType, R, blob, length/*:number*/, opts)/*:any*/ {\n\tvar l = length;\n\tvar bufs = [];\n\tvar d = blob.slice(blob.l,blob.l+l);\n\tif(opts && opts.enc && opts.enc.insitu && d.length > 0) switch(RecordType) {\n\tcase 0x0009: case 0x0209: case 0x0409: case 0x0809/* BOF */: case 0x002f /* FilePass */: case 0x0195 /* FileLock */: case 0x00e1 /* InterfaceHdr */: case 0x0196 /* RRDInfo */: case 0x0138 /* RRDHead */: case 0x0194 /* UsrExcl */: case 0x000a /* EOF */:\n\t\tbreak;\n\tcase 0x0085 /* BoundSheet8 */:\n\t\tbreak;\n\tdefault:\n\t\topts.enc.insitu(d);\n\t}\n\tbufs.push(d);\n\tblob.l += l;\n\tvar nextrt = __readUInt16LE(blob,blob.l), next = XLSRecordEnum[nextrt];\n\tvar start = 0;\n\twhile(next != null && CONTINUE_RT.indexOf(nextrt) > -1) {\n\t\tl = __readUInt16LE(blob,blob.l+2);\n\t\tstart = blob.l + 4;\n\t\tif(nextrt == 0x0812 /* ContinueFrt */) start += 4;\n\t\telse if(nextrt == 0x0875 || nextrt == 0x087f) {\n\t\t\tstart += 12;\n\t\t}\n\t\td = blob.slice(start,blob.l+4+l);\n\t\tbufs.push(d);\n\t\tblob.l += 4+l;\n\t\tnext = (XLSRecordEnum[nextrt = __readUInt16LE(blob, blob.l)]);\n\t}\n\tvar b = (bconcat(bufs)/*:any*/);\n\tprep_blob(b, 0);\n\tvar ll = 0; b.lens = [];\n\tfor(var j = 0; j < bufs.length; ++j) { b.lens.push(ll); ll += bufs[j].length; }\n\tif(b.length < length) throw \"XLS Record 0x\" + RecordType.toString(16) + \" Truncated: \" + b.length + \" < \" + length;\n\treturn R.f(b, b.length, opts);\n}\n\nfunction safe_format_xf(p/*:any*/, opts/*:ParseOpts*/, date1904/*:?boolean*/) {\n\tif(p.t === 'z') return;\n\tif(!p.XF) return;\n\tvar fmtid = 0;\n\ttry {\n\t\tfmtid = p.z || p.XF.numFmtId || 0;\n\t\tif(opts.cellNF) p.z = table_fmt[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(!opts || opts.cellText !== false) try {\n\t\tif(p.t === 'e') { p.w = p.w || BErr[p.v]; }\n\t\telse if(fmtid === 0 || fmtid == \"General\") {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = p.v.toString(10);\n\t\t\t\telse p.w = SSF_general_num(p.v);\n\t\t\t}\n\t\t\telse p.w = SSF_general(p.v);\n\t\t}\n\t\telse p.w = SSF_format(fmtid,p.v, {date1904:!!date1904, dateNF: opts && opts.dateNF});\n\t} catch(e) { if(opts.WTF) throw e; }\n\tif(opts.cellDates && fmtid && p.t == 'n' && fmt_is_date(table_fmt[fmtid] || String(fmtid))) {\n\t\tvar _d = SSF_parse_date_code(p.v); if(_d) { p.t = 'd'; p.v = new Date(_d.y, _d.m-1,_d.d,_d.H,_d.M,_d.S,_d.u); }\n\t}\n}\n\nfunction make_cell(val, ixfe, t)/*:Cell*/ {\n\treturn ({v:val, ixfe:ixfe, t:t}/*:any*/);\n}\n\n// 2.3.2\nfunction parse_workbook(blob, options/*:ParseOpts*/)/*:Workbook*/ {\n\tvar wb = ({opts:{}}/*:any*/);\n\tvar Sheets = {};\n\tif(DENSE != null && options.dense == null) options.dense = DENSE;\n\tvar out/*:Worksheet*/ = ((options.dense ? [] : {})/*:any*/);\n\tvar Directory = {};\n\tvar range/*:Range*/ = ({}/*:any*/);\n\tvar last_formula = null;\n\tvar sst/*:SST*/ = ([]/*:any*/);\n\tvar cur_sheet = \"\";\n\tvar Preamble = {};\n\tvar lastcell, last_cell = \"\", cc/*:Cell*/, cmnt, rngC, rngR;\n\tvar sharedf = {};\n\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\tvar temp_val/*:Cell*/;\n\tvar country;\n\tvar XFs = []; /* XF records */\n\tvar palette/*:Array<[number, number, number]>*/ = [];\n\tvar Workbook/*:WBWBProps*/ = ({ Sheets:[], WBProps:{date1904:false}, Views:[{}] }/*:any*/), wsprops = {};\n\tvar get_rgb = function getrgb(icv/*:number*/)/*:[number, number, number]*/ {\n\t\tif(icv < 8) return XLSIcv[icv];\n\t\tif(icv < 64) return palette[icv-8] || XLSIcv[icv];\n\t\treturn XLSIcv[icv];\n\t};\n\tvar process_cell_style = function pcs(cell, line/*:any*/, options) {\n\t\tvar xfd = line.XF.data;\n\t\tif(!xfd || !xfd.patternType || !options || !options.cellStyles) return;\n\t\tline.s = ({}/*:any*/);\n\t\tline.s.patternType = xfd.patternType;\n\t\tvar t;\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvFore)))) { line.s.fgColor = {rgb:t}; }\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvBack)))) { line.s.bgColor = {rgb:t}; }\n\t};\n\tvar addcell = function addcell(cell/*:any*/, line/*:any*/, options/*:any*/) {\n\t\tif(file_depth > 1) return;\n\t\tif(options.sheetRows && cell.r >= options.sheetRows) return;\n\t\tif(options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line, options);\n\t\tdelete line.ixfe; delete line.XF;\n\t\tlastcell = cell;\n\t\tlast_cell = encode_cell(cell);\n\t\tif(!range || !range.s || !range.e) range = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\tif(cell.r < range.s.r) range.s.r = cell.r;\n\t\tif(cell.c < range.s.c) range.s.c = cell.c;\n\t\tif(cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n\t\tif(cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n\t\tif(options.cellFormula && line.f) {\n\t\t\tfor(var afi = 0; afi < arrayf.length; ++afi) {\n\t\t\t\tif(arrayf[afi][0].s.c > cell.c || arrayf[afi][0].s.r > cell.r) continue;\n\t\t\t\tif(arrayf[afi][0].e.c < cell.c || arrayf[afi][0].e.r < cell.r) continue;\n\t\t\t\tline.F = encode_range(arrayf[afi][0]);\n\t\t\t\tif(arrayf[afi][0].s.c != cell.c || arrayf[afi][0].s.r != cell.r) delete line.f;\n\t\t\t\tif(line.f) line.f = \"\" + stringify_formula(arrayf[afi][1], range, cell, supbooks, opts);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t{\n\t\t\tif(options.dense) {\n\t\t\t\tif(!out[cell.r]) out[cell.r] = [];\n\t\t\t\tout[cell.r][cell.c] = line;\n\t\t\t} else out[last_cell] = line;\n\t\t}\n\t};\n\tvar opts = ({\n\t\tenc: false, // encrypted\n\t\tsbcch: 0, // cch in the preceding SupBook\n\t\tsnames: [], // sheetnames\n\t\tsharedf: sharedf, // shared formulae by address\n\t\tarrayf: arrayf, // array formulae array\n\t\trrtabid: [], // RRTabId\n\t\tlastuser: \"\", // Last User from WriteAccess\n\t\tbiff: 8, // BIFF version\n\t\tcodepage: 0, // CP from CodePage record\n\t\twinlocked: 0, // fLockWn from WinProtect\n\t\tcellStyles: !!options && !!options.cellStyles,\n\t\tWTF: !!options && !!options.wtf\n\t}/*:any*/);\n\tif(options.password) opts.password = options.password;\n\tvar themes;\n\tvar merges/*:Array<Range>*/ = [];\n\tvar objects = [];\n\tvar colinfo/*:Array<ColInfo>*/ = [], rowinfo/*:Array<RowInfo>*/ = [];\n\tvar seencol = false;\n\tvar supbooks = ([]/*:any*/); // 1-indexed, will hold extern names\n\tsupbooks.SheetNames = opts.snames;\n\tsupbooks.sharedf = opts.sharedf;\n\tsupbooks.arrayf = opts.arrayf;\n\tsupbooks.names = [];\n\tsupbooks.XTI = [];\n\tvar last_RT = 0;\n\tvar file_depth = 0; /* TODO: make a real stack */\n\tvar BIFF2Fmt = 0, BIFF2FmtTable/*:Array<string>*/ = [];\n\tvar FilterDatabases = []; /* TODO: sort out supbooks and process elsewhere */\n\tvar last_lbl/*:?DefinedName*/;\n\n\t/* explicit override for some broken writers */\n\topts.codepage = 1200;\n\tset_cp(1200);\n\tvar seen_codepage = false;\n\twhile(blob.l < blob.length - 1) {\n\t\tvar s = blob.l;\n\t\tvar RecordType = blob.read_shift(2);\n\t\tif(RecordType === 0 && last_RT === 0x000a /* EOF */) break;\n\t\tvar length = (blob.l === blob.length ? 0 : blob.read_shift(2));\n\t\tvar R = XLSRecordEnum[RecordType];\n\t\t//console.log(RecordType.toString(16), RecordType, R, blob.l, length, blob.length);\n\t\t//if(!R) console.log(blob.slice(blob.l, blob.l + length));\n\t\tif(R && R.f) {\n\t\t\tif(options.bookSheets) {\n\t\t\t\tif(last_RT === 0x0085 /* BoundSheet8 */ && RecordType !== 0x0085 /* R.n !== 'BoundSheet8' */) break;\n\t\t\t}\n\t\t\tlast_RT = RecordType;\n\t\t\tif(R.r === 2 || R.r == 12) {\n\t\t\t\tvar rt = blob.read_shift(2); length -= 2;\n\t\t\t\tif(!opts.enc && rt !== RecordType && (((rt&0xFF)<<8)|(rt>>8)) !== RecordType) throw new Error(\"rt mismatch: \" + rt + \"!=\" + RecordType);\n\t\t\t\tif(R.r == 12){\n\t\t\t\t\tblob.l += 10; length -= 10;\n\t\t\t\t} // skip FRT\n\t\t\t}\n\t\t\t//console.error(R,blob.l,length,blob.length);\n\t\t\tvar val/*:any*/ = ({}/*:any*/);\n\t\t\tif(RecordType === 0x000a /* EOF */) val = /*::(*/R.f(blob, length, opts)/*:: :any)*/;\n\t\t\telse val = /*::(*/slurp(RecordType, R, blob, length, opts)/*:: :any)*/;\n\t\t\t/*:: val = (val:any); */\n\t\t\tif(file_depth == 0 && [0x0009, 0x0209, 0x0409, 0x0809].indexOf(last_RT) === -1 /* 'BOF' */) continue;\n\t\t\tswitch(RecordType) {\n\t\t\t\tcase 0x0022 /* Date1904 */:\n\t\t\t\t\t/*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n\t\t\t\t\twb.opts.Date1904 = Workbook.WBProps.date1904 = val; break;\n\t\t\t\tcase 0x0086 /* WriteProtect */: wb.opts.WriteProtect = true; break;\n\t\t\t\tcase 0x002f /* FilePass */:\n\t\t\t\t\tif(!opts.enc) blob.l = 0;\n\t\t\t\t\topts.enc = val;\n\t\t\t\t\tif(!options.password) throw new Error(\"File is password-protected\");\n\t\t\t\t\tif(val.valid == null) throw new Error(\"Encryption scheme unsupported\");\n\t\t\t\t\tif(!val.valid) throw new Error(\"Password is incorrect\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x005c /* WriteAccess */: opts.lastuser = val; break;\n\t\t\t\tcase 0x0042 /* CodePage */:\n\t\t\t\t\tvar cpval = Number(val);\n\t\t\t\t\t/* overrides based on test cases */\n\t\t\t\t\tswitch(cpval) {\n\t\t\t\t\t\tcase 0x5212: cpval =  1200; break;\n\t\t\t\t\t\tcase 0x8000: cpval = 10000; break;\n\t\t\t\t\t\tcase 0x8001: cpval =  1252; break;\n\t\t\t\t\t}\n\t\t\t\t\tset_cp(opts.codepage = cpval);\n\t\t\t\t\tseen_codepage = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x013d /* RRTabId */: opts.rrtabid = val; break;\n\t\t\t\tcase 0x0019 /* WinProtect */: opts.winlocked = val; break;\n\t\t\t\tcase 0x01b7 /* RefreshAll */: wb.opts[\"RefreshAll\"] = val; break;\n\t\t\t\tcase 0x000c /* CalcCount */: wb.opts[\"CalcCount\"] = val; break;\n\t\t\t\tcase 0x0010 /* CalcDelta */: wb.opts[\"CalcDelta\"] = val; break;\n\t\t\t\tcase 0x0011 /* CalcIter */: wb.opts[\"CalcIter\"] = val; break;\n\t\t\t\tcase 0x000d /* CalcMode */: wb.opts[\"CalcMode\"] = val; break;\n\t\t\t\tcase 0x000e /* CalcPrecision */: wb.opts[\"CalcPrecision\"] = val; break;\n\t\t\t\tcase 0x005f /* CalcSaveRecalc */: wb.opts[\"CalcSaveRecalc\"] = val; break;\n\t\t\t\tcase 0x000f /* CalcRefMode */: opts.CalcRefMode = val; break; // TODO: implement R1C1\n\t\t\t\tcase 0x08a3 /* ForceFullCalculation */: wb.opts.FullCalc = val; break;\n\t\t\t\tcase 0x0081 /* WsBool */:\n\t\t\t\t\tif(val.fDialog) out[\"!type\"] = \"dialog\";\n\t\t\t\t\tif(!val.fBelow) (out[\"!outline\"] || (out[\"!outline\"] = {})).above = true;\n\t\t\t\t\tif(!val.fRight) (out[\"!outline\"] || (out[\"!outline\"] = {})).left = true;\n\t\t\t\t\tbreak; // TODO\n\t\t\t\tcase 0x00e0 /* XF */:\n\t\t\t\t\tXFs.push(val); break;\n\t\t\t\tcase 0x01ae /* SupBook */:\n\t\t\t\t\tsupbooks.push([val]);\n\t\t\t\t\tsupbooks[supbooks.length-1].XTI = [];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0023: case 0x0223 /* ExternName */:\n\t\t\t\t\tsupbooks[supbooks.length-1].push(val);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0018: case 0x0218 /* Lbl */:\n\t\t\t\t\tlast_lbl = ({\n\t\t\t\t\t\tName: val.Name,\n\t\t\t\t\t\tRef: stringify_formula(val.rgce,range,null,supbooks,opts)\n\t\t\t\t\t}/*:DefinedName*/);\n\t\t\t\t\tif(val.itab > 0) last_lbl.Sheet = val.itab - 1;\n\t\t\t\t\tsupbooks.names.push(last_lbl);\n\t\t\t\t\tif(!supbooks[0]) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\t\tsupbooks[supbooks.length-1].push(val);\n\t\t\t\t\tif(val.Name == \"_xlnm._FilterDatabase\" && val.itab > 0)\n\t\t\t\t\t\tif(val.rgce && val.rgce[0] && val.rgce[0][0] && val.rgce[0][0][0] == 'PtgArea3d')\n\t\t\t\t\t\t\tFilterDatabases[val.itab - 1] = { ref: encode_range(val.rgce[0][0][1][2]) };\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0016 /* ExternCount */: opts.ExternCount = val; break;\n\t\t\t\tcase 0x0017 /* ExternSheet */:\n\t\t\t\t\tif(supbooks.length == 0) { supbooks[0] = []; supbooks[0].XTI = []; }\n\t\t\t\t\tsupbooks[supbooks.length - 1].XTI = supbooks[supbooks.length - 1].XTI.concat(val); supbooks.XTI = supbooks.XTI.concat(val); break;\n\t\t\t\tcase 0x0894 /* NameCmt */:\n\t\t\t\t\t/* TODO: search for correct name */\n\t\t\t\t\tif(opts.biff < 8) break;\n\t\t\t\t\tif(last_lbl != null) last_lbl.Comment = val[1];\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0012 /* Protect */: out[\"!protect\"] = val; break; /* for sheet or book */\n\t\t\t\tcase 0x0013 /* Password */: if(val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val); break;\n\t\t\t\tcase 0x0085 /* BoundSheet8 */: {\n\t\t\t\t\tDirectory[val.pos] = val;\n\t\t\t\t\topts.snames.push(val.name);\n\t\t\t\t} break;\n\t\t\t\tcase 0x000a /* EOF */: {\n\t\t\t\t\tif(--file_depth) break;\n\t\t\t\t\tif(range.e) {\n\t\t\t\t\t\tif(range.e.r > 0 && range.e.c > 0) {\n\t\t\t\t\t\t\trange.e.r--; range.e.c--;\n\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\tif(options.sheetRows && options.sheetRows <= range.e.r) {\n\t\t\t\t\t\t\t\tvar tmpri = range.e.r;\n\t\t\t\t\t\t\t\trange.e.r = options.sheetRows - 1;\n\t\t\t\t\t\t\t\tout[\"!fullref\"] = out[\"!ref\"];\n\t\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\t\trange.e.r = tmpri;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.e.r++; range.e.c++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(merges.length > 0) out[\"!merges\"] = merges;\n\t\t\t\t\t\tif(objects.length > 0) out[\"!objects\"] = objects;\n\t\t\t\t\t\tif(colinfo.length > 0) out[\"!cols\"] = colinfo;\n\t\t\t\t\t\tif(rowinfo.length > 0) out[\"!rows\"] = rowinfo;\n\t\t\t\t\t\tWorkbook.Sheets.push(wsprops);\n\t\t\t\t\t}\n\t\t\t\t\tif(cur_sheet === \"\") Preamble = out; else Sheets[cur_sheet] = out;\n\t\t\t\t\tout = ((options.dense ? [] : {})/*:any*/);\n\t\t\t\t} break;\n\t\t\t\tcase 0x0009: case 0x0209: case 0x0409: case 0x0809 /* BOF */: {\n\t\t\t\t\tif(opts.biff === 8) opts.biff = {\n\t\t\t\t\t\t/*::[*/0x0009/*::]*/:2,\n\t\t\t\t\t\t/*::[*/0x0209/*::]*/:3,\n\t\t\t\t\t\t/*::[*/0x0409/*::]*/:4\n\t\t\t\t\t}[RecordType] || {\n\t\t\t\t\t\t/*::[*/0x0200/*::]*/:2,\n\t\t\t\t\t\t/*::[*/0x0300/*::]*/:3,\n\t\t\t\t\t\t/*::[*/0x0400/*::]*/:4,\n\t\t\t\t\t\t/*::[*/0x0500/*::]*/:5,\n\t\t\t\t\t\t/*::[*/0x0600/*::]*/:8,\n\t\t\t\t\t\t/*::[*/0x0002/*::]*/:2,\n\t\t\t\t\t\t/*::[*/0x0007/*::]*/:2\n\t\t\t\t\t}[val.BIFFVer] || 8;\n\t\t\t\t\topts.biffguess = val.BIFFVer == 0;\n\t\t\t\t\tif(val.BIFFVer == 0 && val.dt == 0x1000) { opts.biff = 5; seen_codepage = true; set_cp(opts.codepage = 28591); }\n\t\t\t\t\tif(opts.biff == 8 && val.BIFFVer == 0 && val.dt == 16) opts.biff = 2;\n\t\t\t\t\tif(file_depth++) break;\n\t\t\t\t\tout = ((options.dense ? [] : {})/*:any*/);\n\n\t\t\t\t\tif(opts.biff < 8 && !seen_codepage) { seen_codepage = true; set_cp(opts.codepage = options.codepage || 1252); }\n\n\t\t\t\t\tif(opts.biff < 5 || val.BIFFVer == 0 && val.dt == 0x1000) {\n\t\t\t\t\t\tif(cur_sheet === \"\") cur_sheet = \"Sheet1\";\n\t\t\t\t\t\trange = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\t\t\t\t\t/* fake BoundSheet8 */\n\t\t\t\t\t\tvar fakebs8 = {pos: blob.l - length, name:cur_sheet};\n\t\t\t\t\t\tDirectory[fakebs8.pos] = fakebs8;\n\t\t\t\t\t\topts.snames.push(cur_sheet);\n\t\t\t\t\t}\n\t\t\t\t\telse cur_sheet = (Directory[s] || {name:\"\"}).name;\n\t\t\t\t\tif(val.dt == 0x20) out[\"!type\"] = \"chart\";\n\t\t\t\t\tif(val.dt == 0x40) out[\"!type\"] = \"macro\";\n\t\t\t\t\tmerges = [];\n\t\t\t\t\tobjects = [];\n\t\t\t\t\topts.arrayf = arrayf = [];\n\t\t\t\t\tcolinfo = []; rowinfo = [];\n\t\t\t\t\tseencol = false;\n\t\t\t\t\twsprops = {Hidden:(Directory[s]||{hs:0}).hs, name:cur_sheet };\n\t\t\t\t} break;\n\t\t\t\tcase 0x0203 /* Number */: case 0x0003 /* BIFF2NUM */: case 0x0002 /* BIFF2INT */: {\n\t\t\t\t\tif(out[\"!type\"] == \"chart\") if(options.dense ? (out[val.r]||[])[val.c]: out[encode_cell({c:val.c, r:val.r})]) ++val.c;\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe]||{}, v:val.val, t:'n'}/*:any*/);\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x0005: case 0x0205 /* BoolErr */: {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:val.t}/*:any*/);\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x027e /* RK */: {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.rknum, t:'n'}/*:any*/);\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x00bd /* MulRk */: {\n\t\t\t\t\tfor(var j = val.c; j <= val.C; ++j) {\n\t\t\t\t\t\tvar ixfe = val.rkrec[j-val.c][0];\n\t\t\t\t\t\ttemp_val= ({ixfe:ixfe, XF:XFs[ixfe], v:val.rkrec[j-val.c][1], t:'n'}/*:any*/);\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0006: case 0x0206: case 0x0406 /* Formula */: {\n\t\t\t\t\tif(val.val == 'String') { last_formula = val; break; }\n\t\t\t\t\ttemp_val = make_cell(val.val, val.cell.ixfe, val.tt);\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(options.cellFormula) {\n\t\t\t\t\t\tvar _f = val.formula;\n\t\t\t\t\t\tif(_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\n\t\t\t\t\t\t\tvar _fr = _f[0][0][1][0], _fc = _f[0][0][1][1];\n\t\t\t\t\t\t\tvar _fe = encode_cell({r:_fr, c:_fc});\n\t\t\t\t\t\t\tif(sharedf[_fe]) temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t\t\telse temp_val.F = ((options.dense ? (out[_fr]||[])[_fc]: out[_fe]) || {}).F;\n\t\t\t\t\t\t} else temp_val.f = \"\"+stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t}\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell(val.cell, temp_val, options);\n\t\t\t\t\tlast_formula = val;\n\t\t\t\t} break;\n\t\t\t\tcase 0x0007: case 0x0207 /* String */: {\n\t\t\t\t\tif(last_formula) { /* technically always true */\n\t\t\t\t\t\tlast_formula.val = val;\n\t\t\t\t\t\ttemp_val = make_cell(val, last_formula.cell.ixfe, 's');\n\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\t\tif(options.cellFormula) {\n\t\t\t\t\t\t\ttemp_val.f = \"\"+stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell(last_formula.cell, temp_val, options);\n\t\t\t\t\t\tlast_formula = null;\n\t\t\t\t\t} else throw new Error(\"String record expects Formula\");\n\t\t\t\t} break;\n\t\t\t\tcase 0x0021: case 0x0221 /* Array */: {\n\t\t\t\t\tarrayf.push(val);\n\t\t\t\t\tvar _arraystart = encode_cell(val[0].s);\n\t\t\t\t\tcc = options.dense ? (out[val[0].s.r]||[])[val[0].s.c] : out[_arraystart];\n\t\t\t\t\tif(options.cellFormula && cc) {\n\t\t\t\t\t\tif(!last_formula) break; /* technically unreachable */\n\t\t\t\t\t\tif(!_arraystart || !cc) break;\n\t\t\t\t\t\tcc.f = \"\"+stringify_formula(val[1], range, val[0], supbooks, opts);\n\t\t\t\t\t\tcc.F = encode_range(val[0]);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x04bc /* ShrFmla */: {\n\t\t\t\t\tif(!options.cellFormula) break;\n\t\t\t\t\tif(last_cell) {\n\t\t\t\t\t\t/* TODO: capture range */\n\t\t\t\t\t\tif(!last_formula) break; /* technically unreachable */\n\t\t\t\t\t\tsharedf[encode_cell(last_formula.cell)]= val[0];\n\t\t\t\t\t\tcc = options.dense ? (out[last_formula.cell.r]||[])[last_formula.cell.c] : out[encode_cell(last_formula.cell)];\n\t\t\t\t\t\t(cc||{}).f = \"\"+stringify_formula(val[0], range, lastcell, supbooks, opts);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x00fd /* LabelSst */:\n\t\t\t\t\ttemp_val=make_cell(sst[val.isst].t, val.ixfe, 's');\n\t\t\t\t\tif(sst[val.isst].h) temp_val.h = sst[val.isst].h;\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0201 /* Blank */: if(options.sheetStubs) {\n\t\t\t\t\ttemp_val = ({ixfe: val.ixfe, XF: XFs[val.ixfe], t:'z'}/*:any*/);\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 0x00be /* MulBlank */: if(options.sheetStubs) {\n\t\t\t\t\tfor(var _j = val.c; _j <= val.C; ++_j) {\n\t\t\t\t\t\tvar _ixfe = val.ixfe[_j-val.c];\n\t\t\t\t\t\ttemp_val= ({ixfe:_ixfe, XF:XFs[_ixfe], t:'z'}/*:any*/);\n\t\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:_j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x00d6 /* RString */:\n\t\t\t\tcase 0x0204 /* Label */: case 0x0004 /* BIFF2STR */:\n\t\t\t\t\ttemp_val=make_cell(val.val, val.ixfe, 's');\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tif(BIFF2Fmt > 0) temp_val.z = BIFF2FmtTable[(temp_val.ixfe>>8) & 0x3F];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0x0000: case 0x0200 /* Dimensions */: {\n\t\t\t\t\tif(file_depth === 1) range = val; /* TODO: stack */\n\t\t\t\t} break;\n\t\t\t\tcase 0x00fc /* SST */: {\n\t\t\t\t\tsst = val;\n\t\t\t\t} break;\n\t\t\t\tcase 0x041e /* Format */: { /* val = [id, fmt] */\n\t\t\t\t\tif(opts.biff == 4) {\n\t\t\t\t\t\tBIFF2FmtTable[BIFF2Fmt++] = val[1];\n\t\t\t\t\t\tfor(var b4idx = 0; b4idx < BIFF2Fmt + 163; ++b4idx) if(table_fmt[b4idx] == val[1]) break;\n\t\t\t\t\t\tif(b4idx >= 163) SSF_load(val[1], BIFF2Fmt + 163);\n\t\t\t\t\t}\n\t\t\t\t\telse SSF_load(val[1], val[0]);\n\t\t\t\t} break;\n\t\t\t\tcase 0x001e /* BIFF2FORMAT */: {\n\t\t\t\t\tBIFF2FmtTable[BIFF2Fmt++] = val;\n\t\t\t\t\tfor(var b2idx = 0; b2idx < BIFF2Fmt + 163; ++b2idx) if(table_fmt[b2idx] == val) break;\n\t\t\t\t\tif(b2idx >= 163) SSF_load(val, BIFF2Fmt + 163);\n\t\t\t\t} break;\n\n\t\t\t\tcase 0x00e5 /* MergeCells */: merges = merges.concat(val); break;\n\n\t\t\t\tcase 0x005d /* Obj */: objects[val.cmo[0]] = opts.lastobj = val; break;\n\t\t\t\tcase 0x01b6 /* TxO */: opts.lastobj.TxO = val; break;\n\t\t\t\tcase 0x007f /* ImData */: opts.lastobj.ImData = val; break;\n\n\t\t\t\tcase 0x01b8 /* HLink */: {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n\t\t\t\t\t\t\tcc = options.dense ? (out[rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\n\t\t\t\t\t\t\tif(cc) cc.l = val[1];\n\t\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0800 /* HLinkTooltip */: {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) {\n\t\t\t\t\t\t\tcc = options.dense ? (out[rngR]||[])[rngC] : out[encode_cell({c:rngC,r:rngR})];\n\t\t\t\t\t\t\tif(cc && cc.l) cc.l.Tooltip = val[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x001c /* Note */: {\n\t\t\t\t\tif(opts.biff <= 5 && opts.biff >= 2) break; /* TODO: BIFF5 */\n\t\t\t\t\tcc = options.dense ? (out[val[0].r]||[])[val[0].c] : out[encode_cell(val[0])];\n\t\t\t\t\tvar noteobj = objects[val[2]];\n\t\t\t\t\tif(!cc) {\n\t\t\t\t\t\tif(options.dense) {\n\t\t\t\t\t\t\tif(!out[val[0].r]) out[val[0].r] = [];\n\t\t\t\t\t\t\tcc = out[val[0].r][val[0].c] = ({t:\"z\"}/*:any*/);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcc = out[encode_cell(val[0])] = ({t:\"z\"}/*:any*/);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.e.r = Math.max(range.e.r, val[0].r);\n\t\t\t\t\t\trange.s.r = Math.min(range.s.r, val[0].r);\n\t\t\t\t\t\trange.e.c = Math.max(range.e.c, val[0].c);\n\t\t\t\t\t\trange.s.c = Math.min(range.s.c, val[0].c);\n\t\t\t\t\t}\n\t\t\t\t\tif(!cc.c) cc.c = [];\n\t\t\t\t\tcmnt = {a:val[1],t:noteobj.TxO.t};\n\t\t\t\t\tcc.c.push(cmnt);\n\t\t\t\t} break;\n\t\t\t\tcase 0x087d /* XFExt */: update_xfext(XFs[val.ixfe], val.ext); break;\n\t\t\t\tcase 0x007d /* ColInfo */: {\n\t\t\t\t\tif(!opts.cellStyles) break;\n\t\t\t\t\twhile(val.e >= val.s) {\n\t\t\t\t\t\tcolinfo[val.e--] = { width: val.w/256, level: (val.level || 0), hidden: !!(val.flags & 1) };\n\t\t\t\t\t\tif(!seencol) { seencol = true; find_mdw_colw(val.w/256); }\n\t\t\t\t\t\tprocess_col(colinfo[val.e+1]);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0208 /* Row */: {\n\t\t\t\t\tvar rowobj = {};\n\t\t\t\t\tif(val.level != null) { rowinfo[val.r] = rowobj; rowobj.level = val.level; }\n\t\t\t\t\tif(val.hidden) { rowinfo[val.r] = rowobj; rowobj.hidden = true; }\n\t\t\t\t\tif(val.hpt) {\n\t\t\t\t\t\trowinfo[val.r] = rowobj;\n\t\t\t\t\t\trowobj.hpt = val.hpt; rowobj.hpx = pt2px(val.hpt);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 0x0026 /* LeftMargin */:\n\t\t\t\tcase 0x0027 /* RightMargin */:\n\t\t\t\tcase 0x0028 /* TopMargin */:\n\t\t\t\tcase 0x0029 /* BottomMargin */:\n\t\t\t\t\tif(!out['!margins']) default_margins(out['!margins'] = {});\n\t\t\t\t\tout['!margins'][({0x26: \"left\", 0x27:\"right\", 0x28:\"top\", 0x29:\"bottom\"})[RecordType]] = val;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x00a1 /* Setup */: // TODO\n\t\t\t\t\tif(!out['!margins']) default_margins(out['!margins'] = {});\n\t\t\t\t\tout['!margins'].header = val.header;\n\t\t\t\t\tout['!margins'].footer = val.footer;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x023e /* Window2 */: // TODO\n\t\t\t\t\t// $FlowIgnore\n\t\t\t\t\tif(val.RTL) Workbook.Views[0].RTL = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0x0092 /* Palette */: palette = val; break;\n\t\t\t\tcase 0x0896 /* Theme */: themes = val; break;\n\t\t\t\tcase 0x008c /* Country */: country = val; break;\n\t\t\t\tcase 0x01ba /* CodeName */: {\n\t\t\t\t\t/*:: if(!Workbook.WBProps) Workbook.WBProps = {}; */\n\t\t\t\t\tif(!cur_sheet) Workbook.WBProps.CodeName = val || \"ThisWorkbook\";\n\t\t\t\t\telse wsprops.CodeName = val || wsprops.name;\n\t\t\t\t} break;\n\t\t\t}\n\t\t} else {\n\t\t\tif(!R) console.error(\"Missing Info for XLS Record 0x\" + RecordType.toString(16));\n\t\t\tblob.l += length;\n\t\t}\n\t}\n\twb.SheetNames=keys(Directory).sort(function(a,b) { return Number(a) - Number(b); }).map(function(x){return Directory[x].name;});\n\tif(!options.bookSheets) wb.Sheets=Sheets;\n\tif(!wb.SheetNames.length && Preamble[\"!ref\"]) {\n\t\twb.SheetNames.push(\"Sheet1\");\n\t\t/*jshint -W069 */\n\t\tif(wb.Sheets) wb.Sheets[\"Sheet1\"] = Preamble;\n\t\t/*jshint +W069 */\n\t} else wb.Preamble=Preamble;\n\tif(wb.Sheets) FilterDatabases.forEach(function(r,i) { wb.Sheets[wb.SheetNames[i]]['!autofilter'] = r; });\n\twb.Strings = sst;\n\twb.SSF = dup(table_fmt);\n\tif(opts.enc) wb.Encryption = opts.enc;\n\tif(themes) wb.Themes = themes;\n\twb.Metadata = {};\n\tif(country !== undefined) wb.Metadata.Country = country;\n\tif(supbooks.names.length > 0) Workbook.Names = supbooks.names;\n\twb.Workbook = Workbook;\n\treturn wb;\n}\n\n/* TODO: split props*/\nvar PSCLSID = {\n\tSI: \"e0859ff2f94f6810ab9108002b27b3d9\",\n\tDSI: \"02d5cdd59c2e1b10939708002b2cf9ae\",\n\tUDI: \"05d5cdd59c2e1b10939708002b2cf9ae\"\n};\nfunction parse_xls_props(cfb/*:CFBContainer*/, props, o) {\n\t/* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n\tvar DSI = CFB.find(cfb, '/!DocumentSummaryInformation');\n\tif(DSI && DSI.size > 0) try {\n\t\tvar DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI, PSCLSID.DSI);\n\t\tfor(var d in DocSummary) props[d] = DocSummary[d];\n\t} catch(e) {if(o.WTF) throw e;/* empty */}\n\n\t/* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\tvar SI = CFB.find(cfb, '/!SummaryInformation');\n\tif(SI && SI.size > 0) try {\n\t\tvar Summary = parse_PropertySetStream(SI, SummaryPIDSI, PSCLSID.SI);\n\t\tfor(var s in Summary) if(props[s] == null) props[s] = Summary[s];\n\t} catch(e) {if(o.WTF) throw e;/* empty */}\n\n\tif(props.HeadingPairs && props.TitlesOfParts) {\n\t\tload_props_pairs(props.HeadingPairs, props.TitlesOfParts, props, o);\n\t\tdelete props.HeadingPairs; delete props.TitlesOfParts;\n\t}\n}\nfunction write_xls_props(wb/*:Workbook*/, cfb/*:CFBContainer*/) {\n\tvar DSEntries = [], SEntries = [], CEntries = [];\n\tvar i = 0, Keys;\n\tvar DocSummaryRE/*:{[key:string]:string}*/ = evert_key(DocSummaryPIDDSI, \"n\");\n\tvar SummaryRE/*:{[key:string]:string}*/ = evert_key(SummaryPIDSI, \"n\");\n\tif(wb.Props) {\n\t\tKeys = keys(wb.Props);\n\t\t// $FlowIgnore\n\t\tfor(i = 0; i < Keys.length; ++i) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Props[Keys[i]]]);\n\t}\n\tif(wb.Custprops) {\n\t\tKeys = keys(wb.Custprops);\n\t\t// $FlowIgnore\n\t\tfor(i = 0; i < Keys.length; ++i) if(!Object.prototype.hasOwnProperty.call((wb.Props||{}), Keys[i])) (Object.prototype.hasOwnProperty.call(DocSummaryRE, Keys[i]) ? DSEntries : Object.prototype.hasOwnProperty.call(SummaryRE, Keys[i]) ? SEntries : CEntries).push([Keys[i], wb.Custprops[Keys[i]]]);\n\t}\n\tvar CEntries2 = [];\n\tfor(i = 0; i < CEntries.length; ++i) {\n\t\tif(XLSPSSkip.indexOf(CEntries[i][0]) > -1 || PseudoPropsPairs.indexOf(CEntries[i][0]) > -1) continue;\n\t\tif(CEntries[i][1] == null) continue;\n\t\tCEntries2.push(CEntries[i]);\n\t}\n\tif(SEntries.length) CFB.utils.cfb_add(cfb, \"/\\u0005SummaryInformation\", write_PropertySetStream(SEntries, PSCLSID.SI, SummaryRE, SummaryPIDSI));\n\tif(DSEntries.length || CEntries2.length) CFB.utils.cfb_add(cfb, \"/\\u0005DocumentSummaryInformation\", write_PropertySetStream(DSEntries, PSCLSID.DSI, DocSummaryRE, DocSummaryPIDDSI, CEntries2.length ? CEntries2 : null, PSCLSID.UDI));\n}\n\nfunction parse_xlscfb(cfb/*:any*/, options/*:?ParseOpts*/)/*:Workbook*/ {\nif(!options) options = {};\nfix_read_opts(options);\nreset_cp();\nif(options.codepage) set_ansi(options.codepage);\nvar CompObj/*:?CFBEntry*/, WB/*:?any*/;\nif(cfb.FullPaths) {\n\tif(CFB.find(cfb, '/encryption')) throw new Error(\"File is password-protected\");\n\tCompObj = CFB.find(cfb, '!CompObj');\n\tWB = CFB.find(cfb, '/Workbook') || CFB.find(cfb, '/Book');\n} else {\n\tswitch(options.type) {\n\t\tcase 'base64': cfb = s2a(Base64_decode(cfb)); break;\n\t\tcase 'binary': cfb = s2a(cfb); break;\n\t\tcase 'buffer': break;\n\t\tcase 'array': if(!Array.isArray(cfb)) cfb = Array.prototype.slice.call(cfb); break;\n\t}\n\tprep_blob(cfb, 0);\n\tWB = ({content: cfb}/*:any*/);\n}\nvar /*::CompObjP, */WorkbookP/*:: :Workbook = XLSX.utils.book_new(); */;\n\nvar _data/*:?any*/;\nif(CompObj) /*::CompObjP = */parse_compobj(CompObj);\nif(options.bookProps && !options.bookSheets) WorkbookP = ({}/*:any*/);\nelse/*:: if(cfb instanceof CFBContainer) */ {\n\tvar T = has_buf ? 'buffer' : 'array';\n\tif(WB && WB.content) WorkbookP = parse_workbook(WB.content, options);\n\t/* Quattro Pro 7-8 */\n\telse if((_data=CFB.find(cfb, 'PerfectOffice_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n\t/* Quattro Pro 9 */\n\telse if((_data=CFB.find(cfb, 'NativeContent_MAIN')) && _data.content) WorkbookP = WK_.to_workbook(_data.content, (options.type = T, options));\n\t/* Works 4 for Mac */\n\telse if((_data=CFB.find(cfb, 'MN0')) && _data.content) throw new Error(\"Unsupported Works 4 for Mac file\");\n\telse throw new Error(\"Cannot find Workbook stream\");\n\tif(options.bookVBA && cfb.FullPaths && CFB.find(cfb, '/_VBA_PROJECT_CUR/VBA/dir')) WorkbookP.vbaraw = make_vba_xls(cfb);\n}\n\nvar props = {};\nif(cfb.FullPaths) parse_xls_props(/*::((*/cfb/*:: :any):CFBContainer)*/, props, options);\n\nWorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\nif(options.bookFiles) WorkbookP.cfb = cfb;\n/*WorkbookP.CompObjP = CompObjP; // TODO: storage? */\nreturn WorkbookP;\n}\n\n\nfunction write_xlscfb(wb/*:Workbook*/, opts/*:WriteOpts*/)/*:CFBContainer*/ {\n\tvar o = opts || {};\n\tvar cfb = CFB.utils.cfb_new({root:\"R\"});\n\tvar wbpath = \"/Workbook\";\n\tswitch(o.bookType || \"xls\") {\n\t\tcase \"xls\": o.bookType = \"biff8\";\n\t\t/* falls through */\n\t\tcase \"xla\": if(!o.bookType) o.bookType = \"xla\";\n\t\t/* falls through */\n\t\tcase \"biff8\": wbpath = \"/Workbook\"; o.biff = 8; break;\n\t\tcase \"biff5\": wbpath = \"/Book\"; o.biff = 5; break;\n\t\tdefault: throw new Error(\"invalid type \" + o.bookType + \" for XLS CFB\");\n\t}\n\tCFB.utils.cfb_add(cfb, wbpath, write_biff_buf(wb, o));\n\tif(o.biff == 8 && (wb.Props || wb.Custprops)) write_xls_props(wb, cfb);\n\t// TODO: SI, DSI, CO\n\tif(o.biff == 8 && wb.vbaraw) fill_vba_xls(cfb, CFB.read(wb.vbaraw, {type: typeof wb.vbaraw == \"string\" ? \"binary\" : \"buffer\"}));\n\treturn cfb;\n}\n/* [MS-XLSB] 2.3 Record Enumeration */\nvar XLSBRecordEnum = {\n\t/*::[*/0x0000/*::]*/: { /* n:\"BrtRowHdr\", */ f:parse_BrtRowHdr },\n\t/*::[*/0x0001/*::]*/: { /* n:\"BrtCellBlank\", */ f:parse_BrtCellBlank },\n\t/*::[*/0x0002/*::]*/: { /* n:\"BrtCellRk\", */ f:parse_BrtCellRk },\n\t/*::[*/0x0003/*::]*/: { /* n:\"BrtCellError\", */ f:parse_BrtCellError },\n\t/*::[*/0x0004/*::]*/: { /* n:\"BrtCellBool\", */ f:parse_BrtCellBool },\n\t/*::[*/0x0005/*::]*/: { /* n:\"BrtCellReal\", */ f:parse_BrtCellReal },\n\t/*::[*/0x0006/*::]*/: { /* n:\"BrtCellSt\", */ f:parse_BrtCellSt },\n\t/*::[*/0x0007/*::]*/: { /* n:\"BrtCellIsst\", */ f:parse_BrtCellIsst },\n\t/*::[*/0x0008/*::]*/: { /* n:\"BrtFmlaString\", */ f:parse_BrtFmlaString },\n\t/*::[*/0x0009/*::]*/: { /* n:\"BrtFmlaNum\", */ f:parse_BrtFmlaNum },\n\t/*::[*/0x000A/*::]*/: { /* n:\"BrtFmlaBool\", */ f:parse_BrtFmlaBool },\n\t/*::[*/0x000B/*::]*/: { /* n:\"BrtFmlaError\", */ f:parse_BrtFmlaError },\n\t/*::[*/0x000C/*::]*/: { /* n:\"BrtShortBlank\", */ f:parse_BrtShortBlank },\n\t/*::[*/0x000D/*::]*/: { /* n:\"BrtShortRk\", */ f:parse_BrtShortRk },\n\t/*::[*/0x000E/*::]*/: { /* n:\"BrtShortError\", */ f:parse_BrtShortError },\n\t/*::[*/0x000F/*::]*/: { /* n:\"BrtShortBool\", */ f:parse_BrtShortBool },\n\t/*::[*/0x0010/*::]*/: { /* n:\"BrtShortReal\", */ f:parse_BrtShortReal },\n\t/*::[*/0x0011/*::]*/: { /* n:\"BrtShortSt\", */ f:parse_BrtShortSt },\n\t/*::[*/0x0012/*::]*/: { /* n:\"BrtShortIsst\", */ f:parse_BrtShortIsst },\n\t/*::[*/0x0013/*::]*/: { /* n:\"BrtSSTItem\", */ f:parse_RichStr },\n\t/*::[*/0x0014/*::]*/: { /* n:\"BrtPCDIMissing\" */ },\n\t/*::[*/0x0015/*::]*/: { /* n:\"BrtPCDINumber\" */ },\n\t/*::[*/0x0016/*::]*/: { /* n:\"BrtPCDIBoolean\" */ },\n\t/*::[*/0x0017/*::]*/: { /* n:\"BrtPCDIError\" */ },\n\t/*::[*/0x0018/*::]*/: { /* n:\"BrtPCDIString\" */ },\n\t/*::[*/0x0019/*::]*/: { /* n:\"BrtPCDIDatetime\" */ },\n\t/*::[*/0x001A/*::]*/: { /* n:\"BrtPCDIIndex\" */ },\n\t/*::[*/0x001B/*::]*/: { /* n:\"BrtPCDIAMissing\" */ },\n\t/*::[*/0x001C/*::]*/: { /* n:\"BrtPCDIANumber\" */ },\n\t/*::[*/0x001D/*::]*/: { /* n:\"BrtPCDIABoolean\" */ },\n\t/*::[*/0x001E/*::]*/: { /* n:\"BrtPCDIAError\" */ },\n\t/*::[*/0x001F/*::]*/: { /* n:\"BrtPCDIAString\" */ },\n\t/*::[*/0x0020/*::]*/: { /* n:\"BrtPCDIADatetime\" */ },\n\t/*::[*/0x0021/*::]*/: { /* n:\"BrtPCRRecord\" */ },\n\t/*::[*/0x0022/*::]*/: { /* n:\"BrtPCRRecordDt\" */ },\n\t/*::[*/0x0023/*::]*/: { /* n:\"BrtFRTBegin\", */ T:1 },\n\t/*::[*/0x0024/*::]*/: { /* n:\"BrtFRTEnd\", */ T:-1 },\n\t/*::[*/0x0025/*::]*/: { /* n:\"BrtACBegin\", */ T:1 },\n\t/*::[*/0x0026/*::]*/: { /* n:\"BrtACEnd\", */ T:-1 },\n\t/*::[*/0x0027/*::]*/: { /* n:\"BrtName\", */ f:parse_BrtName },\n\t/*::[*/0x0028/*::]*/: { /* n:\"BrtIndexRowBlock\" */ },\n\t/*::[*/0x002A/*::]*/: { /* n:\"BrtIndexBlock\" */ },\n\t/*::[*/0x002B/*::]*/: { /* n:\"BrtFont\", */ f:parse_BrtFont },\n\t/*::[*/0x002C/*::]*/: { /* n:\"BrtFmt\", */ f:parse_BrtFmt },\n\t/*::[*/0x002D/*::]*/: { /* n:\"BrtFill\", */ f:parse_BrtFill },\n\t/*::[*/0x002E/*::]*/: { /* n:\"BrtBorder\", */ f:parse_BrtBorder },\n\t/*::[*/0x002F/*::]*/: { /* n:\"BrtXF\", */ f:parse_BrtXF },\n\t/*::[*/0x0030/*::]*/: { /* n:\"BrtStyle\" */ },\n\t/*::[*/0x0031/*::]*/: { /* n:\"BrtCellMeta\", */ f:parse_Int32LE },\n\t/*::[*/0x0032/*::]*/: { /* n:\"BrtValueMeta\" */ },\n\t/*::[*/0x0033/*::]*/: { /* n:\"BrtMdb\" */ f:parse_BrtMdb },\n\t/*::[*/0x0034/*::]*/: { /* n:\"BrtBeginFmd\", */ T:1 },\n\t/*::[*/0x0035/*::]*/: { /* n:\"BrtEndFmd\", */ T:-1 },\n\t/*::[*/0x0036/*::]*/: { /* n:\"BrtBeginMdx\", */ T:1 },\n\t/*::[*/0x0037/*::]*/: { /* n:\"BrtEndMdx\", */ T:-1 },\n\t/*::[*/0x0038/*::]*/: { /* n:\"BrtBeginMdxTuple\", */ T:1 },\n\t/*::[*/0x0039/*::]*/: { /* n:\"BrtEndMdxTuple\", */ T:-1 },\n\t/*::[*/0x003A/*::]*/: { /* n:\"BrtMdxMbrIstr\" */ },\n\t/*::[*/0x003B/*::]*/: { /* n:\"BrtStr\" */ },\n\t/*::[*/0x003C/*::]*/: { /* n:\"BrtColInfo\", */ f:parse_ColInfo },\n\t/*::[*/0x003E/*::]*/: { /* n:\"BrtCellRString\", */ f:parse_BrtCellRString },\n\t/*::[*/0x003F/*::]*/: { /* n:\"BrtCalcChainItem$\", */ f:parse_BrtCalcChainItem$ },\n\t/*::[*/0x0040/*::]*/: { /* n:\"BrtDVal\", */ f:parse_BrtDVal },\n\t/*::[*/0x0041/*::]*/: { /* n:\"BrtSxvcellNum\" */ },\n\t/*::[*/0x0042/*::]*/: { /* n:\"BrtSxvcellStr\" */ },\n\t/*::[*/0x0043/*::]*/: { /* n:\"BrtSxvcellBool\" */ },\n\t/*::[*/0x0044/*::]*/: { /* n:\"BrtSxvcellErr\" */ },\n\t/*::[*/0x0045/*::]*/: { /* n:\"BrtSxvcellDate\" */ },\n\t/*::[*/0x0046/*::]*/: { /* n:\"BrtSxvcellNil\" */ },\n\t/*::[*/0x0080/*::]*/: { /* n:\"BrtFileVersion\" */ },\n\t/*::[*/0x0081/*::]*/: { /* n:\"BrtBeginSheet\", */ T:1 },\n\t/*::[*/0x0082/*::]*/: { /* n:\"BrtEndSheet\", */ T:-1 },\n\t/*::[*/0x0083/*::]*/: { /* n:\"BrtBeginBook\", */ T:1, f:parsenoop, p:0 },\n\t/*::[*/0x0084/*::]*/: { /* n:\"BrtEndBook\", */ T:-1 },\n\t/*::[*/0x0085/*::]*/: { /* n:\"BrtBeginWsViews\", */ T:1 },\n\t/*::[*/0x0086/*::]*/: { /* n:\"BrtEndWsViews\", */ T:-1 },\n\t/*::[*/0x0087/*::]*/: { /* n:\"BrtBeginBookViews\", */ T:1 },\n\t/*::[*/0x0088/*::]*/: { /* n:\"BrtEndBookViews\", */ T:-1 },\n\t/*::[*/0x0089/*::]*/: { /* n:\"BrtBeginWsView\", */ T:1, f:parse_BrtBeginWsView },\n\t/*::[*/0x008A/*::]*/: { /* n:\"BrtEndWsView\", */ T:-1 },\n\t/*::[*/0x008B/*::]*/: { /* n:\"BrtBeginCsViews\", */ T:1 },\n\t/*::[*/0x008C/*::]*/: { /* n:\"BrtEndCsViews\", */ T:-1 },\n\t/*::[*/0x008D/*::]*/: { /* n:\"BrtBeginCsView\", */ T:1 },\n\t/*::[*/0x008E/*::]*/: { /* n:\"BrtEndCsView\", */ T:-1 },\n\t/*::[*/0x008F/*::]*/: { /* n:\"BrtBeginBundleShs\", */ T:1 },\n\t/*::[*/0x0090/*::]*/: { /* n:\"BrtEndBundleShs\", */ T:-1 },\n\t/*::[*/0x0091/*::]*/: { /* n:\"BrtBeginSheetData\", */ T:1 },\n\t/*::[*/0x0092/*::]*/: { /* n:\"BrtEndSheetData\", */ T:-1 },\n\t/*::[*/0x0093/*::]*/: { /* n:\"BrtWsProp\", */ f:parse_BrtWsProp },\n\t/*::[*/0x0094/*::]*/: { /* n:\"BrtWsDim\", */ f:parse_BrtWsDim, p:16 },\n\t/*::[*/0x0097/*::]*/: { /* n:\"BrtPane\", */ f:parse_BrtPane },\n\t/*::[*/0x0098/*::]*/: { /* n:\"BrtSel\" */ },\n\t/*::[*/0x0099/*::]*/: { /* n:\"BrtWbProp\", */ f:parse_BrtWbProp },\n\t/*::[*/0x009A/*::]*/: { /* n:\"BrtWbFactoid\" */ },\n\t/*::[*/0x009B/*::]*/: { /* n:\"BrtFileRecover\" */ },\n\t/*::[*/0x009C/*::]*/: { /* n:\"BrtBundleSh\", */ f:parse_BrtBundleSh },\n\t/*::[*/0x009D/*::]*/: { /* n:\"BrtCalcProp\" */ },\n\t/*::[*/0x009E/*::]*/: { /* n:\"BrtBookView\" */ },\n\t/*::[*/0x009F/*::]*/: { /* n:\"BrtBeginSst\", */ T:1, f:parse_BrtBeginSst },\n\t/*::[*/0x00A0/*::]*/: { /* n:\"BrtEndSst\", */ T:-1 },\n\t/*::[*/0x00A1/*::]*/: { /* n:\"BrtBeginAFilter\", */ T:1, f:parse_UncheckedRfX },\n\t/*::[*/0x00A2/*::]*/: { /* n:\"BrtEndAFilter\", */ T:-1 },\n\t/*::[*/0x00A3/*::]*/: { /* n:\"BrtBeginFilterColumn\", */ T:1 },\n\t/*::[*/0x00A4/*::]*/: { /* n:\"BrtEndFilterColumn\", */ T:-1 },\n\t/*::[*/0x00A5/*::]*/: { /* n:\"BrtBeginFilters\", */ T:1 },\n\t/*::[*/0x00A6/*::]*/: { /* n:\"BrtEndFilters\", */ T:-1 },\n\t/*::[*/0x00A7/*::]*/: { /* n:\"BrtFilter\" */ },\n\t/*::[*/0x00A8/*::]*/: { /* n:\"BrtColorFilter\" */ },\n\t/*::[*/0x00A9/*::]*/: { /* n:\"BrtIconFilter\" */ },\n\t/*::[*/0x00AA/*::]*/: { /* n:\"BrtTop10Filter\" */ },\n\t/*::[*/0x00AB/*::]*/: { /* n:\"BrtDynamicFilter\" */ },\n\t/*::[*/0x00AC/*::]*/: { /* n:\"BrtBeginCustomFilters\", */ T:1 },\n\t/*::[*/0x00AD/*::]*/: { /* n:\"BrtEndCustomFilters\", */ T:-1 },\n\t/*::[*/0x00AE/*::]*/: { /* n:\"BrtCustomFilter\" */ },\n\t/*::[*/0x00AF/*::]*/: { /* n:\"BrtAFilterDateGroupItem\" */ },\n\t/*::[*/0x00B0/*::]*/: { /* n:\"BrtMergeCell\", */ f:parse_BrtMergeCell },\n\t/*::[*/0x00B1/*::]*/: { /* n:\"BrtBeginMergeCells\", */ T:1 },\n\t/*::[*/0x00B2/*::]*/: { /* n:\"BrtEndMergeCells\", */ T:-1 },\n\t/*::[*/0x00B3/*::]*/: { /* n:\"BrtBeginPivotCacheDef\", */ T:1 },\n\t/*::[*/0x00B4/*::]*/: { /* n:\"BrtEndPivotCacheDef\", */ T:-1 },\n\t/*::[*/0x00B5/*::]*/: { /* n:\"BrtBeginPCDFields\", */ T:1 },\n\t/*::[*/0x00B6/*::]*/: { /* n:\"BrtEndPCDFields\", */ T:-1 },\n\t/*::[*/0x00B7/*::]*/: { /* n:\"BrtBeginPCDField\", */ T:1 },\n\t/*::[*/0x00B8/*::]*/: { /* n:\"BrtEndPCDField\", */ T:-1 },\n\t/*::[*/0x00B9/*::]*/: { /* n:\"BrtBeginPCDSource\", */ T:1 },\n\t/*::[*/0x00BA/*::]*/: { /* n:\"BrtEndPCDSource\", */ T:-1 },\n\t/*::[*/0x00BB/*::]*/: { /* n:\"BrtBeginPCDSRange\", */ T:1 },\n\t/*::[*/0x00BC/*::]*/: { /* n:\"BrtEndPCDSRange\", */ T:-1 },\n\t/*::[*/0x00BD/*::]*/: { /* n:\"BrtBeginPCDFAtbl\", */ T:1 },\n\t/*::[*/0x00BE/*::]*/: { /* n:\"BrtEndPCDFAtbl\", */ T:-1 },\n\t/*::[*/0x00BF/*::]*/: { /* n:\"BrtBeginPCDIRun\", */ T:1 },\n\t/*::[*/0x00C0/*::]*/: { /* n:\"BrtEndPCDIRun\", */ T:-1 },\n\t/*::[*/0x00C1/*::]*/: { /* n:\"BrtBeginPivotCacheRecords\", */ T:1 },\n\t/*::[*/0x00C2/*::]*/: { /* n:\"BrtEndPivotCacheRecords\", */ T:-1 },\n\t/*::[*/0x00C3/*::]*/: { /* n:\"BrtBeginPCDHierarchies\", */ T:1 },\n\t/*::[*/0x00C4/*::]*/: { /* n:\"BrtEndPCDHierarchies\", */ T:-1 },\n\t/*::[*/0x00C5/*::]*/: { /* n:\"BrtBeginPCDHierarchy\", */ T:1 },\n\t/*::[*/0x00C6/*::]*/: { /* n:\"BrtEndPCDHierarchy\", */ T:-1 },\n\t/*::[*/0x00C7/*::]*/: { /* n:\"BrtBeginPCDHFieldsUsage\", */ T:1 },\n\t/*::[*/0x00C8/*::]*/: { /* n:\"BrtEndPCDHFieldsUsage\", */ T:-1 },\n\t/*::[*/0x00C9/*::]*/: { /* n:\"BrtBeginExtConnection\", */ T:1 },\n\t/*::[*/0x00CA/*::]*/: { /* n:\"BrtEndExtConnection\", */ T:-1 },\n\t/*::[*/0x00CB/*::]*/: { /* n:\"BrtBeginECDbProps\", */ T:1 },\n\t/*::[*/0x00CC/*::]*/: { /* n:\"BrtEndECDbProps\", */ T:-1 },\n\t/*::[*/0x00CD/*::]*/: { /* n:\"BrtBeginECOlapProps\", */ T:1 },\n\t/*::[*/0x00CE/*::]*/: { /* n:\"BrtEndECOlapProps\", */ T:-1 },\n\t/*::[*/0x00CF/*::]*/: { /* n:\"BrtBeginPCDSConsol\", */ T:1 },\n\t/*::[*/0x00D0/*::]*/: { /* n:\"BrtEndPCDSConsol\", */ T:-1 },\n\t/*::[*/0x00D1/*::]*/: { /* n:\"BrtBeginPCDSCPages\", */ T:1 },\n\t/*::[*/0x00D2/*::]*/: { /* n:\"BrtEndPCDSCPages\", */ T:-1 },\n\t/*::[*/0x00D3/*::]*/: { /* n:\"BrtBeginPCDSCPage\", */ T:1 },\n\t/*::[*/0x00D4/*::]*/: { /* n:\"BrtEndPCDSCPage\", */ T:-1 },\n\t/*::[*/0x00D5/*::]*/: { /* n:\"BrtBeginPCDSCPItem\", */ T:1 },\n\t/*::[*/0x00D6/*::]*/: { /* n:\"BrtEndPCDSCPItem\", */ T:-1 },\n\t/*::[*/0x00D7/*::]*/: { /* n:\"BrtBeginPCDSCSets\", */ T:1 },\n\t/*::[*/0x00D8/*::]*/: { /* n:\"BrtEndPCDSCSets\", */ T:-1 },\n\t/*::[*/0x00D9/*::]*/: { /* n:\"BrtBeginPCDSCSet\", */ T:1 },\n\t/*::[*/0x00DA/*::]*/: { /* n:\"BrtEndPCDSCSet\", */ T:-1 },\n\t/*::[*/0x00DB/*::]*/: { /* n:\"BrtBeginPCDFGroup\", */ T:1 },\n\t/*::[*/0x00DC/*::]*/: { /* n:\"BrtEndPCDFGroup\", */ T:-1 },\n\t/*::[*/0x00DD/*::]*/: { /* n:\"BrtBeginPCDFGItems\", */ T:1 },\n\t/*::[*/0x00DE/*::]*/: { /* n:\"BrtEndPCDFGItems\", */ T:-1 },\n\t/*::[*/0x00DF/*::]*/: { /* n:\"BrtBeginPCDFGRange\", */ T:1 },\n\t/*::[*/0x00E0/*::]*/: { /* n:\"BrtEndPCDFGRange\", */ T:-1 },\n\t/*::[*/0x00E1/*::]*/: { /* n:\"BrtBeginPCDFGDiscrete\", */ T:1 },\n\t/*::[*/0x00E2/*::]*/: { /* n:\"BrtEndPCDFGDiscrete\", */ T:-1 },\n\t/*::[*/0x00E3/*::]*/: { /* n:\"BrtBeginPCDSDTupleCache\", */ T:1 },\n\t/*::[*/0x00E4/*::]*/: { /* n:\"BrtEndPCDSDTupleCache\", */ T:-1 },\n\t/*::[*/0x00E5/*::]*/: { /* n:\"BrtBeginPCDSDTCEntries\", */ T:1 },\n\t/*::[*/0x00E6/*::]*/: { /* n:\"BrtEndPCDSDTCEntries\", */ T:-1 },\n\t/*::[*/0x00E7/*::]*/: { /* n:\"BrtBeginPCDSDTCEMembers\", */ T:1 },\n\t/*::[*/0x00E8/*::]*/: { /* n:\"BrtEndPCDSDTCEMembers\", */ T:-1 },\n\t/*::[*/0x00E9/*::]*/: { /* n:\"BrtBeginPCDSDTCEMember\", */ T:1 },\n\t/*::[*/0x00EA/*::]*/: { /* n:\"BrtEndPCDSDTCEMember\", */ T:-1 },\n\t/*::[*/0x00EB/*::]*/: { /* n:\"BrtBeginPCDSDTCQueries\", */ T:1 },\n\t/*::[*/0x00EC/*::]*/: { /* n:\"BrtEndPCDSDTCQueries\", */ T:-1 },\n\t/*::[*/0x00ED/*::]*/: { /* n:\"BrtBeginPCDSDTCQuery\", */ T:1 },\n\t/*::[*/0x00EE/*::]*/: { /* n:\"BrtEndPCDSDTCQuery\", */ T:-1 },\n\t/*::[*/0x00EF/*::]*/: { /* n:\"BrtBeginPCDSDTCSets\", */ T:1 },\n\t/*::[*/0x00F0/*::]*/: { /* n:\"BrtEndPCDSDTCSets\", */ T:-1 },\n\t/*::[*/0x00F1/*::]*/: { /* n:\"BrtBeginPCDSDTCSet\", */ T:1 },\n\t/*::[*/0x00F2/*::]*/: { /* n:\"BrtEndPCDSDTCSet\", */ T:-1 },\n\t/*::[*/0x00F3/*::]*/: { /* n:\"BrtBeginPCDCalcItems\", */ T:1 },\n\t/*::[*/0x00F4/*::]*/: { /* n:\"BrtEndPCDCalcItems\", */ T:-1 },\n\t/*::[*/0x00F5/*::]*/: { /* n:\"BrtBeginPCDCalcItem\", */ T:1 },\n\t/*::[*/0x00F6/*::]*/: { /* n:\"BrtEndPCDCalcItem\", */ T:-1 },\n\t/*::[*/0x00F7/*::]*/: { /* n:\"BrtBeginPRule\", */ T:1 },\n\t/*::[*/0x00F8/*::]*/: { /* n:\"BrtEndPRule\", */ T:-1 },\n\t/*::[*/0x00F9/*::]*/: { /* n:\"BrtBeginPRFilters\", */ T:1 },\n\t/*::[*/0x00FA/*::]*/: { /* n:\"BrtEndPRFilters\", */ T:-1 },\n\t/*::[*/0x00FB/*::]*/: { /* n:\"BrtBeginPRFilter\", */ T:1 },\n\t/*::[*/0x00FC/*::]*/: { /* n:\"BrtEndPRFilter\", */ T:-1 },\n\t/*::[*/0x00FD/*::]*/: { /* n:\"BrtBeginPNames\", */ T:1 },\n\t/*::[*/0x00FE/*::]*/: { /* n:\"BrtEndPNames\", */ T:-1 },\n\t/*::[*/0x00FF/*::]*/: { /* n:\"BrtBeginPName\", */ T:1 },\n\t/*::[*/0x0100/*::]*/: { /* n:\"BrtEndPName\", */ T:-1 },\n\t/*::[*/0x0101/*::]*/: { /* n:\"BrtBeginPNPairs\", */ T:1 },\n\t/*::[*/0x0102/*::]*/: { /* n:\"BrtEndPNPairs\", */ T:-1 },\n\t/*::[*/0x0103/*::]*/: { /* n:\"BrtBeginPNPair\", */ T:1 },\n\t/*::[*/0x0104/*::]*/: { /* n:\"BrtEndPNPair\", */ T:-1 },\n\t/*::[*/0x0105/*::]*/: { /* n:\"BrtBeginECWebProps\", */ T:1 },\n\t/*::[*/0x0106/*::]*/: { /* n:\"BrtEndECWebProps\", */ T:-1 },\n\t/*::[*/0x0107/*::]*/: { /* n:\"BrtBeginEcWpTables\", */ T:1 },\n\t/*::[*/0x0108/*::]*/: { /* n:\"BrtEndECWPTables\", */ T:-1 },\n\t/*::[*/0x0109/*::]*/: { /* n:\"BrtBeginECParams\", */ T:1 },\n\t/*::[*/0x010A/*::]*/: { /* n:\"BrtEndECParams\", */ T:-1 },\n\t/*::[*/0x010B/*::]*/: { /* n:\"BrtBeginECParam\", */ T:1 },\n\t/*::[*/0x010C/*::]*/: { /* n:\"BrtEndECParam\", */ T:-1 },\n\t/*::[*/0x010D/*::]*/: { /* n:\"BrtBeginPCDKPIs\", */ T:1 },\n\t/*::[*/0x010E/*::]*/: { /* n:\"BrtEndPCDKPIs\", */ T:-1 },\n\t/*::[*/0x010F/*::]*/: { /* n:\"BrtBeginPCDKPI\", */ T:1 },\n\t/*::[*/0x0110/*::]*/: { /* n:\"BrtEndPCDKPI\", */ T:-1 },\n\t/*::[*/0x0111/*::]*/: { /* n:\"BrtBeginDims\", */ T:1 },\n\t/*::[*/0x0112/*::]*/: { /* n:\"BrtEndDims\", */ T:-1 },\n\t/*::[*/0x0113/*::]*/: { /* n:\"BrtBeginDim\", */ T:1 },\n\t/*::[*/0x0114/*::]*/: { /* n:\"BrtEndDim\", */ T:-1 },\n\t/*::[*/0x0115/*::]*/: { /* n:\"BrtIndexPartEnd\" */ },\n\t/*::[*/0x0116/*::]*/: { /* n:\"BrtBeginStyleSheet\", */ T:1 },\n\t/*::[*/0x0117/*::]*/: { /* n:\"BrtEndStyleSheet\", */ T:-1 },\n\t/*::[*/0x0118/*::]*/: { /* n:\"BrtBeginSXView\", */ T:1 },\n\t/*::[*/0x0119/*::]*/: { /* n:\"BrtEndSXVI\", */ T:-1 },\n\t/*::[*/0x011A/*::]*/: { /* n:\"BrtBeginSXVI\", */ T:1 },\n\t/*::[*/0x011B/*::]*/: { /* n:\"BrtBeginSXVIs\", */ T:1 },\n\t/*::[*/0x011C/*::]*/: { /* n:\"BrtEndSXVIs\", */ T:-1 },\n\t/*::[*/0x011D/*::]*/: { /* n:\"BrtBeginSXVD\", */ T:1 },\n\t/*::[*/0x011E/*::]*/: { /* n:\"BrtEndSXVD\", */ T:-1 },\n\t/*::[*/0x011F/*::]*/: { /* n:\"BrtBeginSXVDs\", */ T:1 },\n\t/*::[*/0x0120/*::]*/: { /* n:\"BrtEndSXVDs\", */ T:-1 },\n\t/*::[*/0x0121/*::]*/: { /* n:\"BrtBeginSXPI\", */ T:1 },\n\t/*::[*/0x0122/*::]*/: { /* n:\"BrtEndSXPI\", */ T:-1 },\n\t/*::[*/0x0123/*::]*/: { /* n:\"BrtBeginSXPIs\", */ T:1 },\n\t/*::[*/0x0124/*::]*/: { /* n:\"BrtEndSXPIs\", */ T:-1 },\n\t/*::[*/0x0125/*::]*/: { /* n:\"BrtBeginSXDI\", */ T:1 },\n\t/*::[*/0x0126/*::]*/: { /* n:\"BrtEndSXDI\", */ T:-1 },\n\t/*::[*/0x0127/*::]*/: { /* n:\"BrtBeginSXDIs\", */ T:1 },\n\t/*::[*/0x0128/*::]*/: { /* n:\"BrtEndSXDIs\", */ T:-1 },\n\t/*::[*/0x0129/*::]*/: { /* n:\"BrtBeginSXLI\", */ T:1 },\n\t/*::[*/0x012A/*::]*/: { /* n:\"BrtEndSXLI\", */ T:-1 },\n\t/*::[*/0x012B/*::]*/: { /* n:\"BrtBeginSXLIRws\", */ T:1 },\n\t/*::[*/0x012C/*::]*/: { /* n:\"BrtEndSXLIRws\", */ T:-1 },\n\t/*::[*/0x012D/*::]*/: { /* n:\"BrtBeginSXLICols\", */ T:1 },\n\t/*::[*/0x012E/*::]*/: { /* n:\"BrtEndSXLICols\", */ T:-1 },\n\t/*::[*/0x012F/*::]*/: { /* n:\"BrtBeginSXFormat\", */ T:1 },\n\t/*::[*/0x0130/*::]*/: { /* n:\"BrtEndSXFormat\", */ T:-1 },\n\t/*::[*/0x0131/*::]*/: { /* n:\"BrtBeginSXFormats\", */ T:1 },\n\t/*::[*/0x0132/*::]*/: { /* n:\"BrtEndSxFormats\", */ T:-1 },\n\t/*::[*/0x0133/*::]*/: { /* n:\"BrtBeginSxSelect\", */ T:1 },\n\t/*::[*/0x0134/*::]*/: { /* n:\"BrtEndSxSelect\", */ T:-1 },\n\t/*::[*/0x0135/*::]*/: { /* n:\"BrtBeginISXVDRws\", */ T:1 },\n\t/*::[*/0x0136/*::]*/: { /* n:\"BrtEndISXVDRws\", */ T:-1 },\n\t/*::[*/0x0137/*::]*/: { /* n:\"BrtBeginISXVDCols\", */ T:1 },\n\t/*::[*/0x0138/*::]*/: { /* n:\"BrtEndISXVDCols\", */ T:-1 },\n\t/*::[*/0x0139/*::]*/: { /* n:\"BrtEndSXLocation\", */ T:-1 },\n\t/*::[*/0x013A/*::]*/: { /* n:\"BrtBeginSXLocation\", */ T:1 },\n\t/*::[*/0x013B/*::]*/: { /* n:\"BrtEndSXView\", */ T:-1 },\n\t/*::[*/0x013C/*::]*/: { /* n:\"BrtBeginSXTHs\", */ T:1 },\n\t/*::[*/0x013D/*::]*/: { /* n:\"BrtEndSXTHs\", */ T:-1 },\n\t/*::[*/0x013E/*::]*/: { /* n:\"BrtBeginSXTH\", */ T:1 },\n\t/*::[*/0x013F/*::]*/: { /* n:\"BrtEndSXTH\", */ T:-1 },\n\t/*::[*/0x0140/*::]*/: { /* n:\"BrtBeginISXTHRws\", */ T:1 },\n\t/*::[*/0x0141/*::]*/: { /* n:\"BrtEndISXTHRws\", */ T:-1 },\n\t/*::[*/0x0142/*::]*/: { /* n:\"BrtBeginISXTHCols\", */ T:1 },\n\t/*::[*/0x0143/*::]*/: { /* n:\"BrtEndISXTHCols\", */ T:-1 },\n\t/*::[*/0x0144/*::]*/: { /* n:\"BrtBeginSXTDMPS\", */ T:1 },\n\t/*::[*/0x0145/*::]*/: { /* n:\"BrtEndSXTDMPs\", */ T:-1 },\n\t/*::[*/0x0146/*::]*/: { /* n:\"BrtBeginSXTDMP\", */ T:1 },\n\t/*::[*/0x0147/*::]*/: { /* n:\"BrtEndSXTDMP\", */ T:-1 },\n\t/*::[*/0x0148/*::]*/: { /* n:\"BrtBeginSXTHItems\", */ T:1 },\n\t/*::[*/0x0149/*::]*/: { /* n:\"BrtEndSXTHItems\", */ T:-1 },\n\t/*::[*/0x014A/*::]*/: { /* n:\"BrtBeginSXTHItem\", */ T:1 },\n\t/*::[*/0x014B/*::]*/: { /* n:\"BrtEndSXTHItem\", */ T:-1 },\n\t/*::[*/0x014C/*::]*/: { /* n:\"BrtBeginMetadata\", */ T:1 },\n\t/*::[*/0x014D/*::]*/: { /* n:\"BrtEndMetadata\", */ T:-1 },\n\t/*::[*/0x014E/*::]*/: { /* n:\"BrtBeginEsmdtinfo\", */ T:1 },\n\t/*::[*/0x014F/*::]*/: { /* n:\"BrtMdtinfo\", */ f:parse_BrtMdtinfo },\n\t/*::[*/0x0150/*::]*/: { /* n:\"BrtEndEsmdtinfo\", */ T:-1 },\n\t/*::[*/0x0151/*::]*/: { /* n:\"BrtBeginEsmdb\", */ f:parse_BrtBeginEsmdb, T:1 },\n\t/*::[*/0x0152/*::]*/: { /* n:\"BrtEndEsmdb\", */ T:-1 },\n\t/*::[*/0x0153/*::]*/: { /* n:\"BrtBeginEsfmd\", */ T:1 },\n\t/*::[*/0x0154/*::]*/: { /* n:\"BrtEndEsfmd\", */ T:-1 },\n\t/*::[*/0x0155/*::]*/: { /* n:\"BrtBeginSingleCells\", */ T:1 },\n\t/*::[*/0x0156/*::]*/: { /* n:\"BrtEndSingleCells\", */ T:-1 },\n\t/*::[*/0x0157/*::]*/: { /* n:\"BrtBeginList\", */ T:1 },\n\t/*::[*/0x0158/*::]*/: { /* n:\"BrtEndList\", */ T:-1 },\n\t/*::[*/0x0159/*::]*/: { /* n:\"BrtBeginListCols\", */ T:1 },\n\t/*::[*/0x015A/*::]*/: { /* n:\"BrtEndListCols\", */ T:-1 },\n\t/*::[*/0x015B/*::]*/: { /* n:\"BrtBeginListCol\", */ T:1 },\n\t/*::[*/0x015C/*::]*/: { /* n:\"BrtEndListCol\", */ T:-1 },\n\t/*::[*/0x015D/*::]*/: { /* n:\"BrtBeginListXmlCPr\", */ T:1 },\n\t/*::[*/0x015E/*::]*/: { /* n:\"BrtEndListXmlCPr\", */ T:-1 },\n\t/*::[*/0x015F/*::]*/: { /* n:\"BrtListCCFmla\" */ },\n\t/*::[*/0x0160/*::]*/: { /* n:\"BrtListTrFmla\" */ },\n\t/*::[*/0x0161/*::]*/: { /* n:\"BrtBeginExternals\", */ T:1 },\n\t/*::[*/0x0162/*::]*/: { /* n:\"BrtEndExternals\", */ T:-1 },\n\t/*::[*/0x0163/*::]*/: { /* n:\"BrtSupBookSrc\", */ f:parse_RelID},\n\t/*::[*/0x0165/*::]*/: { /* n:\"BrtSupSelf\" */ },\n\t/*::[*/0x0166/*::]*/: { /* n:\"BrtSupSame\" */ },\n\t/*::[*/0x0167/*::]*/: { /* n:\"BrtSupTabs\" */ },\n\t/*::[*/0x0168/*::]*/: { /* n:\"BrtBeginSupBook\", */ T:1 },\n\t/*::[*/0x0169/*::]*/: { /* n:\"BrtPlaceholderName\" */ },\n\t/*::[*/0x016A/*::]*/: { /* n:\"BrtExternSheet\", */ f:parse_ExternSheet },\n\t/*::[*/0x016B/*::]*/: { /* n:\"BrtExternTableStart\" */ },\n\t/*::[*/0x016C/*::]*/: { /* n:\"BrtExternTableEnd\" */ },\n\t/*::[*/0x016E/*::]*/: { /* n:\"BrtExternRowHdr\" */ },\n\t/*::[*/0x016F/*::]*/: { /* n:\"BrtExternCellBlank\" */ },\n\t/*::[*/0x0170/*::]*/: { /* n:\"BrtExternCellReal\" */ },\n\t/*::[*/0x0171/*::]*/: { /* n:\"BrtExternCellBool\" */ },\n\t/*::[*/0x0172/*::]*/: { /* n:\"BrtExternCellError\" */ },\n\t/*::[*/0x0173/*::]*/: { /* n:\"BrtExternCellString\" */ },\n\t/*::[*/0x0174/*::]*/: { /* n:\"BrtBeginEsmdx\", */ T:1 },\n\t/*::[*/0x0175/*::]*/: { /* n:\"BrtEndEsmdx\", */ T:-1 },\n\t/*::[*/0x0176/*::]*/: { /* n:\"BrtBeginMdxSet\", */ T:1 },\n\t/*::[*/0x0177/*::]*/: { /* n:\"BrtEndMdxSet\", */ T:-1 },\n\t/*::[*/0x0178/*::]*/: { /* n:\"BrtBeginMdxMbrProp\", */ T:1 },\n\t/*::[*/0x0179/*::]*/: { /* n:\"BrtEndMdxMbrProp\", */ T:-1 },\n\t/*::[*/0x017A/*::]*/: { /* n:\"BrtBeginMdxKPI\", */ T:1 },\n\t/*::[*/0x017B/*::]*/: { /* n:\"BrtEndMdxKPI\", */ T:-1 },\n\t/*::[*/0x017C/*::]*/: { /* n:\"BrtBeginEsstr\", */ T:1 },\n\t/*::[*/0x017D/*::]*/: { /* n:\"BrtEndEsstr\", */ T:-1 },\n\t/*::[*/0x017E/*::]*/: { /* n:\"BrtBeginPRFItem\", */ T:1 },\n\t/*::[*/0x017F/*::]*/: { /* n:\"BrtEndPRFItem\", */ T:-1 },\n\t/*::[*/0x0180/*::]*/: { /* n:\"BrtBeginPivotCacheIDs\", */ T:1 },\n\t/*::[*/0x0181/*::]*/: { /* n:\"BrtEndPivotCacheIDs\", */ T:-1 },\n\t/*::[*/0x0182/*::]*/: { /* n:\"BrtBeginPivotCacheID\", */ T:1 },\n\t/*::[*/0x0183/*::]*/: { /* n:\"BrtEndPivotCacheID\", */ T:-1 },\n\t/*::[*/0x0184/*::]*/: { /* n:\"BrtBeginISXVIs\", */ T:1 },\n\t/*::[*/0x0185/*::]*/: { /* n:\"BrtEndISXVIs\", */ T:-1 },\n\t/*::[*/0x0186/*::]*/: { /* n:\"BrtBeginColInfos\", */ T:1 },\n\t/*::[*/0x0187/*::]*/: { /* n:\"BrtEndColInfos\", */ T:-1 },\n\t/*::[*/0x0188/*::]*/: { /* n:\"BrtBeginRwBrk\", */ T:1 },\n\t/*::[*/0x0189/*::]*/: { /* n:\"BrtEndRwBrk\", */ T:-1 },\n\t/*::[*/0x018A/*::]*/: { /* n:\"BrtBeginColBrk\", */ T:1 },\n\t/*::[*/0x018B/*::]*/: { /* n:\"BrtEndColBrk\", */ T:-1 },\n\t/*::[*/0x018C/*::]*/: { /* n:\"BrtBrk\" */ },\n\t/*::[*/0x018D/*::]*/: { /* n:\"BrtUserBookView\" */ },\n\t/*::[*/0x018E/*::]*/: { /* n:\"BrtInfo\" */ },\n\t/*::[*/0x018F/*::]*/: { /* n:\"BrtCUsr\" */ },\n\t/*::[*/0x0190/*::]*/: { /* n:\"BrtUsr\" */ },\n\t/*::[*/0x0191/*::]*/: { /* n:\"BrtBeginUsers\", */ T:1 },\n\t/*::[*/0x0193/*::]*/: { /* n:\"BrtEOF\" */ },\n\t/*::[*/0x0194/*::]*/: { /* n:\"BrtUCR\" */ },\n\t/*::[*/0x0195/*::]*/: { /* n:\"BrtRRInsDel\" */ },\n\t/*::[*/0x0196/*::]*/: { /* n:\"BrtRREndInsDel\" */ },\n\t/*::[*/0x0197/*::]*/: { /* n:\"BrtRRMove\" */ },\n\t/*::[*/0x0198/*::]*/: { /* n:\"BrtRREndMove\" */ },\n\t/*::[*/0x0199/*::]*/: { /* n:\"BrtRRChgCell\" */ },\n\t/*::[*/0x019A/*::]*/: { /* n:\"BrtRREndChgCell\" */ },\n\t/*::[*/0x019B/*::]*/: { /* n:\"BrtRRHeader\" */ },\n\t/*::[*/0x019C/*::]*/: { /* n:\"BrtRRUserView\" */ },\n\t/*::[*/0x019D/*::]*/: { /* n:\"BrtRRRenSheet\" */ },\n\t/*::[*/0x019E/*::]*/: { /* n:\"BrtRRInsertSh\" */ },\n\t/*::[*/0x019F/*::]*/: { /* n:\"BrtRRDefName\" */ },\n\t/*::[*/0x01A0/*::]*/: { /* n:\"BrtRRNote\" */ },\n\t/*::[*/0x01A1/*::]*/: { /* n:\"BrtRRConflict\" */ },\n\t/*::[*/0x01A2/*::]*/: { /* n:\"BrtRRTQSIF\" */ },\n\t/*::[*/0x01A3/*::]*/: { /* n:\"BrtRRFormat\" */ },\n\t/*::[*/0x01A4/*::]*/: { /* n:\"BrtRREndFormat\" */ },\n\t/*::[*/0x01A5/*::]*/: { /* n:\"BrtRRAutoFmt\" */ },\n\t/*::[*/0x01A6/*::]*/: { /* n:\"BrtBeginUserShViews\", */ T:1 },\n\t/*::[*/0x01A7/*::]*/: { /* n:\"BrtBeginUserShView\", */ T:1 },\n\t/*::[*/0x01A8/*::]*/: { /* n:\"BrtEndUserShView\", */ T:-1 },\n\t/*::[*/0x01A9/*::]*/: { /* n:\"BrtEndUserShViews\", */ T:-1 },\n\t/*::[*/0x01AA/*::]*/: { /* n:\"BrtArrFmla\", */ f:parse_BrtArrFmla },\n\t/*::[*/0x01AB/*::]*/: { /* n:\"BrtShrFmla\", */ f:parse_BrtShrFmla },\n\t/*::[*/0x01AC/*::]*/: { /* n:\"BrtTable\" */ },\n\t/*::[*/0x01AD/*::]*/: { /* n:\"BrtBeginExtConnections\", */ T:1 },\n\t/*::[*/0x01AE/*::]*/: { /* n:\"BrtEndExtConnections\", */ T:-1 },\n\t/*::[*/0x01AF/*::]*/: { /* n:\"BrtBeginPCDCalcMems\", */ T:1 },\n\t/*::[*/0x01B0/*::]*/: { /* n:\"BrtEndPCDCalcMems\", */ T:-1 },\n\t/*::[*/0x01B1/*::]*/: { /* n:\"BrtBeginPCDCalcMem\", */ T:1 },\n\t/*::[*/0x01B2/*::]*/: { /* n:\"BrtEndPCDCalcMem\", */ T:-1 },\n\t/*::[*/0x01B3/*::]*/: { /* n:\"BrtBeginPCDHGLevels\", */ T:1 },\n\t/*::[*/0x01B4/*::]*/: { /* n:\"BrtEndPCDHGLevels\", */ T:-1 },\n\t/*::[*/0x01B5/*::]*/: { /* n:\"BrtBeginPCDHGLevel\", */ T:1 },\n\t/*::[*/0x01B6/*::]*/: { /* n:\"BrtEndPCDHGLevel\", */ T:-1 },\n\t/*::[*/0x01B7/*::]*/: { /* n:\"BrtBeginPCDHGLGroups\", */ T:1 },\n\t/*::[*/0x01B8/*::]*/: { /* n:\"BrtEndPCDHGLGroups\", */ T:-1 },\n\t/*::[*/0x01B9/*::]*/: { /* n:\"BrtBeginPCDHGLGroup\", */ T:1 },\n\t/*::[*/0x01BA/*::]*/: { /* n:\"BrtEndPCDHGLGroup\", */ T:-1 },\n\t/*::[*/0x01BB/*::]*/: { /* n:\"BrtBeginPCDHGLGMembers\", */ T:1 },\n\t/*::[*/0x01BC/*::]*/: { /* n:\"BrtEndPCDHGLGMembers\", */ T:-1 },\n\t/*::[*/0x01BD/*::]*/: { /* n:\"BrtBeginPCDHGLGMember\", */ T:1 },\n\t/*::[*/0x01BE/*::]*/: { /* n:\"BrtEndPCDHGLGMember\", */ T:-1 },\n\t/*::[*/0x01BF/*::]*/: { /* n:\"BrtBeginQSI\", */ T:1 },\n\t/*::[*/0x01C0/*::]*/: { /* n:\"BrtEndQSI\", */ T:-1 },\n\t/*::[*/0x01C1/*::]*/: { /* n:\"BrtBeginQSIR\", */ T:1 },\n\t/*::[*/0x01C2/*::]*/: { /* n:\"BrtEndQSIR\", */ T:-1 },\n\t/*::[*/0x01C3/*::]*/: { /* n:\"BrtBeginDeletedNames\", */ T:1 },\n\t/*::[*/0x01C4/*::]*/: { /* n:\"BrtEndDeletedNames\", */ T:-1 },\n\t/*::[*/0x01C5/*::]*/: { /* n:\"BrtBeginDeletedName\", */ T:1 },\n\t/*::[*/0x01C6/*::]*/: { /* n:\"BrtEndDeletedName\", */ T:-1 },\n\t/*::[*/0x01C7/*::]*/: { /* n:\"BrtBeginQSIFs\", */ T:1 },\n\t/*::[*/0x01C8/*::]*/: { /* n:\"BrtEndQSIFs\", */ T:-1 },\n\t/*::[*/0x01C9/*::]*/: { /* n:\"BrtBeginQSIF\", */ T:1 },\n\t/*::[*/0x01CA/*::]*/: { /* n:\"BrtEndQSIF\", */ T:-1 },\n\t/*::[*/0x01CB/*::]*/: { /* n:\"BrtBeginAutoSortScope\", */ T:1 },\n\t/*::[*/0x01CC/*::]*/: { /* n:\"BrtEndAutoSortScope\", */ T:-1 },\n\t/*::[*/0x01CD/*::]*/: { /* n:\"BrtBeginConditionalFormatting\", */ T:1 },\n\t/*::[*/0x01CE/*::]*/: { /* n:\"BrtEndConditionalFormatting\", */ T:-1 },\n\t/*::[*/0x01CF/*::]*/: { /* n:\"BrtBeginCFRule\", */ T:1 },\n\t/*::[*/0x01D0/*::]*/: { /* n:\"BrtEndCFRule\", */ T:-1 },\n\t/*::[*/0x01D1/*::]*/: { /* n:\"BrtBeginIconSet\", */ T:1 },\n\t/*::[*/0x01D2/*::]*/: { /* n:\"BrtEndIconSet\", */ T:-1 },\n\t/*::[*/0x01D3/*::]*/: { /* n:\"BrtBeginDatabar\", */ T:1 },\n\t/*::[*/0x01D4/*::]*/: { /* n:\"BrtEndDatabar\", */ T:-1 },\n\t/*::[*/0x01D5/*::]*/: { /* n:\"BrtBeginColorScale\", */ T:1 },\n\t/*::[*/0x01D6/*::]*/: { /* n:\"BrtEndColorScale\", */ T:-1 },\n\t/*::[*/0x01D7/*::]*/: { /* n:\"BrtCFVO\" */ },\n\t/*::[*/0x01D8/*::]*/: { /* n:\"BrtExternValueMeta\" */ },\n\t/*::[*/0x01D9/*::]*/: { /* n:\"BrtBeginColorPalette\", */ T:1 },\n\t/*::[*/0x01DA/*::]*/: { /* n:\"BrtEndColorPalette\", */ T:-1 },\n\t/*::[*/0x01DB/*::]*/: { /* n:\"BrtIndexedColor\" */ },\n\t/*::[*/0x01DC/*::]*/: { /* n:\"BrtMargins\", */ f:parse_BrtMargins },\n\t/*::[*/0x01DD/*::]*/: { /* n:\"BrtPrintOptions\" */ },\n\t/*::[*/0x01DE/*::]*/: { /* n:\"BrtPageSetup\" */ },\n\t/*::[*/0x01DF/*::]*/: { /* n:\"BrtBeginHeaderFooter\", */ T:1 },\n\t/*::[*/0x01E0/*::]*/: { /* n:\"BrtEndHeaderFooter\", */ T:-1 },\n\t/*::[*/0x01E1/*::]*/: { /* n:\"BrtBeginSXCrtFormat\", */ T:1 },\n\t/*::[*/0x01E2/*::]*/: { /* n:\"BrtEndSXCrtFormat\", */ T:-1 },\n\t/*::[*/0x01E3/*::]*/: { /* n:\"BrtBeginSXCrtFormats\", */ T:1 },\n\t/*::[*/0x01E4/*::]*/: { /* n:\"BrtEndSXCrtFormats\", */ T:-1 },\n\t/*::[*/0x01E5/*::]*/: { /* n:\"BrtWsFmtInfo\", */ f:parse_BrtWsFmtInfo },\n\t/*::[*/0x01E6/*::]*/: { /* n:\"BrtBeginMgs\", */ T:1 },\n\t/*::[*/0x01E7/*::]*/: { /* n:\"BrtEndMGs\", */ T:-1 },\n\t/*::[*/0x01E8/*::]*/: { /* n:\"BrtBeginMGMaps\", */ T:1 },\n\t/*::[*/0x01E9/*::]*/: { /* n:\"BrtEndMGMaps\", */ T:-1 },\n\t/*::[*/0x01EA/*::]*/: { /* n:\"BrtBeginMG\", */ T:1 },\n\t/*::[*/0x01EB/*::]*/: { /* n:\"BrtEndMG\", */ T:-1 },\n\t/*::[*/0x01EC/*::]*/: { /* n:\"BrtBeginMap\", */ T:1 },\n\t/*::[*/0x01ED/*::]*/: { /* n:\"BrtEndMap\", */ T:-1 },\n\t/*::[*/0x01EE/*::]*/: { /* n:\"BrtHLink\", */ f:parse_BrtHLink },\n\t/*::[*/0x01EF/*::]*/: { /* n:\"BrtBeginDCon\", */ T:1 },\n\t/*::[*/0x01F0/*::]*/: { /* n:\"BrtEndDCon\", */ T:-1 },\n\t/*::[*/0x01F1/*::]*/: { /* n:\"BrtBeginDRefs\", */ T:1 },\n\t/*::[*/0x01F2/*::]*/: { /* n:\"BrtEndDRefs\", */ T:-1 },\n\t/*::[*/0x01F3/*::]*/: { /* n:\"BrtDRef\" */ },\n\t/*::[*/0x01F4/*::]*/: { /* n:\"BrtBeginScenMan\", */ T:1 },\n\t/*::[*/0x01F5/*::]*/: { /* n:\"BrtEndScenMan\", */ T:-1 },\n\t/*::[*/0x01F6/*::]*/: { /* n:\"BrtBeginSct\", */ T:1 },\n\t/*::[*/0x01F7/*::]*/: { /* n:\"BrtEndSct\", */ T:-1 },\n\t/*::[*/0x01F8/*::]*/: { /* n:\"BrtSlc\" */ },\n\t/*::[*/0x01F9/*::]*/: { /* n:\"BrtBeginDXFs\", */ T:1 },\n\t/*::[*/0x01FA/*::]*/: { /* n:\"BrtEndDXFs\", */ T:-1 },\n\t/*::[*/0x01FB/*::]*/: { /* n:\"BrtDXF\" */ },\n\t/*::[*/0x01FC/*::]*/: { /* n:\"BrtBeginTableStyles\", */ T:1 },\n\t/*::[*/0x01FD/*::]*/: { /* n:\"BrtEndTableStyles\", */ T:-1 },\n\t/*::[*/0x01FE/*::]*/: { /* n:\"BrtBeginTableStyle\", */ T:1 },\n\t/*::[*/0x01FF/*::]*/: { /* n:\"BrtEndTableStyle\", */ T:-1 },\n\t/*::[*/0x0200/*::]*/: { /* n:\"BrtTableStyleElement\" */ },\n\t/*::[*/0x0201/*::]*/: { /* n:\"BrtTableStyleClient\" */ },\n\t/*::[*/0x0202/*::]*/: { /* n:\"BrtBeginVolDeps\", */ T:1 },\n\t/*::[*/0x0203/*::]*/: { /* n:\"BrtEndVolDeps\", */ T:-1 },\n\t/*::[*/0x0204/*::]*/: { /* n:\"BrtBeginVolType\", */ T:1 },\n\t/*::[*/0x0205/*::]*/: { /* n:\"BrtEndVolType\", */ T:-1 },\n\t/*::[*/0x0206/*::]*/: { /* n:\"BrtBeginVolMain\", */ T:1 },\n\t/*::[*/0x0207/*::]*/: { /* n:\"BrtEndVolMain\", */ T:-1 },\n\t/*::[*/0x0208/*::]*/: { /* n:\"BrtBeginVolTopic\", */ T:1 },\n\t/*::[*/0x0209/*::]*/: { /* n:\"BrtEndVolTopic\", */ T:-1 },\n\t/*::[*/0x020A/*::]*/: { /* n:\"BrtVolSubtopic\" */ },\n\t/*::[*/0x020B/*::]*/: { /* n:\"BrtVolRef\" */ },\n\t/*::[*/0x020C/*::]*/: { /* n:\"BrtVolNum\" */ },\n\t/*::[*/0x020D/*::]*/: { /* n:\"BrtVolErr\" */ },\n\t/*::[*/0x020E/*::]*/: { /* n:\"BrtVolStr\" */ },\n\t/*::[*/0x020F/*::]*/: { /* n:\"BrtVolBool\" */ },\n\t/*::[*/0x0210/*::]*/: { /* n:\"BrtBeginCalcChain$\", */ T:1 },\n\t/*::[*/0x0211/*::]*/: { /* n:\"BrtEndCalcChain$\", */ T:-1 },\n\t/*::[*/0x0212/*::]*/: { /* n:\"BrtBeginSortState\", */ T:1 },\n\t/*::[*/0x0213/*::]*/: { /* n:\"BrtEndSortState\", */ T:-1 },\n\t/*::[*/0x0214/*::]*/: { /* n:\"BrtBeginSortCond\", */ T:1 },\n\t/*::[*/0x0215/*::]*/: { /* n:\"BrtEndSortCond\", */ T:-1 },\n\t/*::[*/0x0216/*::]*/: { /* n:\"BrtBookProtection\" */ },\n\t/*::[*/0x0217/*::]*/: { /* n:\"BrtSheetProtection\" */ },\n\t/*::[*/0x0218/*::]*/: { /* n:\"BrtRangeProtection\" */ },\n\t/*::[*/0x0219/*::]*/: { /* n:\"BrtPhoneticInfo\" */ },\n\t/*::[*/0x021A/*::]*/: { /* n:\"BrtBeginECTxtWiz\", */ T:1 },\n\t/*::[*/0x021B/*::]*/: { /* n:\"BrtEndECTxtWiz\", */ T:-1 },\n\t/*::[*/0x021C/*::]*/: { /* n:\"BrtBeginECTWFldInfoLst\", */ T:1 },\n\t/*::[*/0x021D/*::]*/: { /* n:\"BrtEndECTWFldInfoLst\", */ T:-1 },\n\t/*::[*/0x021E/*::]*/: { /* n:\"BrtBeginECTwFldInfo\", */ T:1 },\n\t/*::[*/0x0224/*::]*/: { /* n:\"BrtFileSharing\" */ },\n\t/*::[*/0x0225/*::]*/: { /* n:\"BrtOleSize\" */ },\n\t/*::[*/0x0226/*::]*/: { /* n:\"BrtDrawing\", */ f:parse_RelID },\n\t/*::[*/0x0227/*::]*/: { /* n:\"BrtLegacyDrawing\" */ },\n\t/*::[*/0x0228/*::]*/: { /* n:\"BrtLegacyDrawingHF\" */ },\n\t/*::[*/0x0229/*::]*/: { /* n:\"BrtWebOpt\" */ },\n\t/*::[*/0x022A/*::]*/: { /* n:\"BrtBeginWebPubItems\", */ T:1 },\n\t/*::[*/0x022B/*::]*/: { /* n:\"BrtEndWebPubItems\", */ T:-1 },\n\t/*::[*/0x022C/*::]*/: { /* n:\"BrtBeginWebPubItem\", */ T:1 },\n\t/*::[*/0x022D/*::]*/: { /* n:\"BrtEndWebPubItem\", */ T:-1 },\n\t/*::[*/0x022E/*::]*/: { /* n:\"BrtBeginSXCondFmt\", */ T:1 },\n\t/*::[*/0x022F/*::]*/: { /* n:\"BrtEndSXCondFmt\", */ T:-1 },\n\t/*::[*/0x0230/*::]*/: { /* n:\"BrtBeginSXCondFmts\", */ T:1 },\n\t/*::[*/0x0231/*::]*/: { /* n:\"BrtEndSXCondFmts\", */ T:-1 },\n\t/*::[*/0x0232/*::]*/: { /* n:\"BrtBkHim\" */ },\n\t/*::[*/0x0234/*::]*/: { /* n:\"BrtColor\" */ },\n\t/*::[*/0x0235/*::]*/: { /* n:\"BrtBeginIndexedColors\", */ T:1 },\n\t/*::[*/0x0236/*::]*/: { /* n:\"BrtEndIndexedColors\", */ T:-1 },\n\t/*::[*/0x0239/*::]*/: { /* n:\"BrtBeginMRUColors\", */ T:1 },\n\t/*::[*/0x023A/*::]*/: { /* n:\"BrtEndMRUColors\", */ T:-1 },\n\t/*::[*/0x023C/*::]*/: { /* n:\"BrtMRUColor\" */ },\n\t/*::[*/0x023D/*::]*/: { /* n:\"BrtBeginDVals\", */ T:1 },\n\t/*::[*/0x023E/*::]*/: { /* n:\"BrtEndDVals\", */ T:-1 },\n\t/*::[*/0x0241/*::]*/: { /* n:\"BrtSupNameStart\" */ },\n\t/*::[*/0x0242/*::]*/: { /* n:\"BrtSupNameValueStart\" */ },\n\t/*::[*/0x0243/*::]*/: { /* n:\"BrtSupNameValueEnd\" */ },\n\t/*::[*/0x0244/*::]*/: { /* n:\"BrtSupNameNum\" */ },\n\t/*::[*/0x0245/*::]*/: { /* n:\"BrtSupNameErr\" */ },\n\t/*::[*/0x0246/*::]*/: { /* n:\"BrtSupNameSt\" */ },\n\t/*::[*/0x0247/*::]*/: { /* n:\"BrtSupNameNil\" */ },\n\t/*::[*/0x0248/*::]*/: { /* n:\"BrtSupNameBool\" */ },\n\t/*::[*/0x0249/*::]*/: { /* n:\"BrtSupNameFmla\" */ },\n\t/*::[*/0x024A/*::]*/: { /* n:\"BrtSupNameBits\" */ },\n\t/*::[*/0x024B/*::]*/: { /* n:\"BrtSupNameEnd\" */ },\n\t/*::[*/0x024C/*::]*/: { /* n:\"BrtEndSupBook\", */ T:-1 },\n\t/*::[*/0x024D/*::]*/: { /* n:\"BrtCellSmartTagProperty\" */ },\n\t/*::[*/0x024E/*::]*/: { /* n:\"BrtBeginCellSmartTag\", */ T:1 },\n\t/*::[*/0x024F/*::]*/: { /* n:\"BrtEndCellSmartTag\", */ T:-1 },\n\t/*::[*/0x0250/*::]*/: { /* n:\"BrtBeginCellSmartTags\", */ T:1 },\n\t/*::[*/0x0251/*::]*/: { /* n:\"BrtEndCellSmartTags\", */ T:-1 },\n\t/*::[*/0x0252/*::]*/: { /* n:\"BrtBeginSmartTags\", */ T:1 },\n\t/*::[*/0x0253/*::]*/: { /* n:\"BrtEndSmartTags\", */ T:-1 },\n\t/*::[*/0x0254/*::]*/: { /* n:\"BrtSmartTagType\" */ },\n\t/*::[*/0x0255/*::]*/: { /* n:\"BrtBeginSmartTagTypes\", */ T:1 },\n\t/*::[*/0x0256/*::]*/: { /* n:\"BrtEndSmartTagTypes\", */ T:-1 },\n\t/*::[*/0x0257/*::]*/: { /* n:\"BrtBeginSXFilters\", */ T:1 },\n\t/*::[*/0x0258/*::]*/: { /* n:\"BrtEndSXFilters\", */ T:-1 },\n\t/*::[*/0x0259/*::]*/: { /* n:\"BrtBeginSXFILTER\", */ T:1 },\n\t/*::[*/0x025A/*::]*/: { /* n:\"BrtEndSXFilter\", */ T:-1 },\n\t/*::[*/0x025B/*::]*/: { /* n:\"BrtBeginFills\", */ T:1 },\n\t/*::[*/0x025C/*::]*/: { /* n:\"BrtEndFills\", */ T:-1 },\n\t/*::[*/0x025D/*::]*/: { /* n:\"BrtBeginCellWatches\", */ T:1 },\n\t/*::[*/0x025E/*::]*/: { /* n:\"BrtEndCellWatches\", */ T:-1 },\n\t/*::[*/0x025F/*::]*/: { /* n:\"BrtCellWatch\" */ },\n\t/*::[*/0x0260/*::]*/: { /* n:\"BrtBeginCRErrs\", */ T:1 },\n\t/*::[*/0x0261/*::]*/: { /* n:\"BrtEndCRErrs\", */ T:-1 },\n\t/*::[*/0x0262/*::]*/: { /* n:\"BrtCrashRecErr\" */ },\n\t/*::[*/0x0263/*::]*/: { /* n:\"BrtBeginFonts\", */ T:1 },\n\t/*::[*/0x0264/*::]*/: { /* n:\"BrtEndFonts\", */ T:-1 },\n\t/*::[*/0x0265/*::]*/: { /* n:\"BrtBeginBorders\", */ T:1 },\n\t/*::[*/0x0266/*::]*/: { /* n:\"BrtEndBorders\", */ T:-1 },\n\t/*::[*/0x0267/*::]*/: { /* n:\"BrtBeginFmts\", */ T:1 },\n\t/*::[*/0x0268/*::]*/: { /* n:\"BrtEndFmts\", */ T:-1 },\n\t/*::[*/0x0269/*::]*/: { /* n:\"BrtBeginCellXFs\", */ T:1 },\n\t/*::[*/0x026A/*::]*/: { /* n:\"BrtEndCellXFs\", */ T:-1 },\n\t/*::[*/0x026B/*::]*/: { /* n:\"BrtBeginStyles\", */ T:1 },\n\t/*::[*/0x026C/*::]*/: { /* n:\"BrtEndStyles\", */ T:-1 },\n\t/*::[*/0x0271/*::]*/: { /* n:\"BrtBigName\" */ },\n\t/*::[*/0x0272/*::]*/: { /* n:\"BrtBeginCellStyleXFs\", */ T:1 },\n\t/*::[*/0x0273/*::]*/: { /* n:\"BrtEndCellStyleXFs\", */ T:-1 },\n\t/*::[*/0x0274/*::]*/: { /* n:\"BrtBeginComments\", */ T:1 },\n\t/*::[*/0x0275/*::]*/: { /* n:\"BrtEndComments\", */ T:-1 },\n\t/*::[*/0x0276/*::]*/: { /* n:\"BrtBeginCommentAuthors\", */ T:1 },\n\t/*::[*/0x0277/*::]*/: { /* n:\"BrtEndCommentAuthors\", */ T:-1 },\n\t/*::[*/0x0278/*::]*/: { /* n:\"BrtCommentAuthor\", */ f:parse_BrtCommentAuthor },\n\t/*::[*/0x0279/*::]*/: { /* n:\"BrtBeginCommentList\", */ T:1 },\n\t/*::[*/0x027A/*::]*/: { /* n:\"BrtEndCommentList\", */ T:-1 },\n\t/*::[*/0x027B/*::]*/: { /* n:\"BrtBeginComment\", */ T:1, f:parse_BrtBeginComment},\n\t/*::[*/0x027C/*::]*/: { /* n:\"BrtEndComment\", */ T:-1 },\n\t/*::[*/0x027D/*::]*/: { /* n:\"BrtCommentText\", */ f:parse_BrtCommentText },\n\t/*::[*/0x027E/*::]*/: { /* n:\"BrtBeginOleObjects\", */ T:1 },\n\t/*::[*/0x027F/*::]*/: { /* n:\"BrtOleObject\" */ },\n\t/*::[*/0x0280/*::]*/: { /* n:\"BrtEndOleObjects\", */ T:-1 },\n\t/*::[*/0x0281/*::]*/: { /* n:\"BrtBeginSxrules\", */ T:1 },\n\t/*::[*/0x0282/*::]*/: { /* n:\"BrtEndSxRules\", */ T:-1 },\n\t/*::[*/0x0283/*::]*/: { /* n:\"BrtBeginActiveXControls\", */ T:1 },\n\t/*::[*/0x0284/*::]*/: { /* n:\"BrtActiveX\" */ },\n\t/*::[*/0x0285/*::]*/: { /* n:\"BrtEndActiveXControls\", */ T:-1 },\n\t/*::[*/0x0286/*::]*/: { /* n:\"BrtBeginPCDSDTCEMembersSortBy\", */ T:1 },\n\t/*::[*/0x0288/*::]*/: { /* n:\"BrtBeginCellIgnoreECs\", */ T:1 },\n\t/*::[*/0x0289/*::]*/: { /* n:\"BrtCellIgnoreEC\" */ },\n\t/*::[*/0x028A/*::]*/: { /* n:\"BrtEndCellIgnoreECs\", */ T:-1 },\n\t/*::[*/0x028B/*::]*/: { /* n:\"BrtCsProp\", */ f:parse_BrtCsProp },\n\t/*::[*/0x028C/*::]*/: { /* n:\"BrtCsPageSetup\" */ },\n\t/*::[*/0x028D/*::]*/: { /* n:\"BrtBeginUserCsViews\", */ T:1 },\n\t/*::[*/0x028E/*::]*/: { /* n:\"BrtEndUserCsViews\", */ T:-1 },\n\t/*::[*/0x028F/*::]*/: { /* n:\"BrtBeginUserCsView\", */ T:1 },\n\t/*::[*/0x0290/*::]*/: { /* n:\"BrtEndUserCsView\", */ T:-1 },\n\t/*::[*/0x0291/*::]*/: { /* n:\"BrtBeginPcdSFCIEntries\", */ T:1 },\n\t/*::[*/0x0292/*::]*/: { /* n:\"BrtEndPCDSFCIEntries\", */ T:-1 },\n\t/*::[*/0x0293/*::]*/: { /* n:\"BrtPCDSFCIEntry\" */ },\n\t/*::[*/0x0294/*::]*/: { /* n:\"BrtBeginListParts\", */ T:1 },\n\t/*::[*/0x0295/*::]*/: { /* n:\"BrtListPart\" */ },\n\t/*::[*/0x0296/*::]*/: { /* n:\"BrtEndListParts\", */ T:-1 },\n\t/*::[*/0x0297/*::]*/: { /* n:\"BrtSheetCalcProp\" */ },\n\t/*::[*/0x0298/*::]*/: { /* n:\"BrtBeginFnGroup\", */ T:1 },\n\t/*::[*/0x0299/*::]*/: { /* n:\"BrtFnGroup\" */ },\n\t/*::[*/0x029A/*::]*/: { /* n:\"BrtEndFnGroup\", */ T:-1 },\n\t/*::[*/0x029B/*::]*/: { /* n:\"BrtSupAddin\" */ },\n\t/*::[*/0x029C/*::]*/: { /* n:\"BrtSXTDMPOrder\" */ },\n\t/*::[*/0x029D/*::]*/: { /* n:\"BrtCsProtection\" */ },\n\t/*::[*/0x029F/*::]*/: { /* n:\"BrtBeginWsSortMap\", */ T:1 },\n\t/*::[*/0x02A0/*::]*/: { /* n:\"BrtEndWsSortMap\", */ T:-1 },\n\t/*::[*/0x02A1/*::]*/: { /* n:\"BrtBeginRRSort\", */ T:1 },\n\t/*::[*/0x02A2/*::]*/: { /* n:\"BrtEndRRSort\", */ T:-1 },\n\t/*::[*/0x02A3/*::]*/: { /* n:\"BrtRRSortItem\" */ },\n\t/*::[*/0x02A4/*::]*/: { /* n:\"BrtFileSharingIso\" */ },\n\t/*::[*/0x02A5/*::]*/: { /* n:\"BrtBookProtectionIso\" */ },\n\t/*::[*/0x02A6/*::]*/: { /* n:\"BrtSheetProtectionIso\" */ },\n\t/*::[*/0x02A7/*::]*/: { /* n:\"BrtCsProtectionIso\" */ },\n\t/*::[*/0x02A8/*::]*/: { /* n:\"BrtRangeProtectionIso\" */ },\n\t/*::[*/0x02A9/*::]*/: { /* n:\"BrtDValList\" */ },\n\t/*::[*/0x0400/*::]*/: { /* n:\"BrtRwDescent\" */ },\n\t/*::[*/0x0401/*::]*/: { /* n:\"BrtKnownFonts\" */ },\n\t/*::[*/0x0402/*::]*/: { /* n:\"BrtBeginSXTupleSet\", */ T:1 },\n\t/*::[*/0x0403/*::]*/: { /* n:\"BrtEndSXTupleSet\", */ T:-1 },\n\t/*::[*/0x0404/*::]*/: { /* n:\"BrtBeginSXTupleSetHeader\", */ T:1 },\n\t/*::[*/0x0405/*::]*/: { /* n:\"BrtEndSXTupleSetHeader\", */ T:-1 },\n\t/*::[*/0x0406/*::]*/: { /* n:\"BrtSXTupleSetHeaderItem\" */ },\n\t/*::[*/0x0407/*::]*/: { /* n:\"BrtBeginSXTupleSetData\", */ T:1 },\n\t/*::[*/0x0408/*::]*/: { /* n:\"BrtEndSXTupleSetData\", */ T:-1 },\n\t/*::[*/0x0409/*::]*/: { /* n:\"BrtBeginSXTupleSetRow\", */ T:1 },\n\t/*::[*/0x040A/*::]*/: { /* n:\"BrtEndSXTupleSetRow\", */ T:-1 },\n\t/*::[*/0x040B/*::]*/: { /* n:\"BrtSXTupleSetRowItem\" */ },\n\t/*::[*/0x040C/*::]*/: { /* n:\"BrtNameExt\" */ },\n\t/*::[*/0x040D/*::]*/: { /* n:\"BrtPCDH14\" */ },\n\t/*::[*/0x040E/*::]*/: { /* n:\"BrtBeginPCDCalcMem14\", */ T:1 },\n\t/*::[*/0x040F/*::]*/: { /* n:\"BrtEndPCDCalcMem14\", */ T:-1 },\n\t/*::[*/0x0410/*::]*/: { /* n:\"BrtSXTH14\" */ },\n\t/*::[*/0x0411/*::]*/: { /* n:\"BrtBeginSparklineGroup\", */ T:1 },\n\t/*::[*/0x0412/*::]*/: { /* n:\"BrtEndSparklineGroup\", */ T:-1 },\n\t/*::[*/0x0413/*::]*/: { /* n:\"BrtSparkline\" */ },\n\t/*::[*/0x0414/*::]*/: { /* n:\"BrtSXDI14\" */ },\n\t/*::[*/0x0415/*::]*/: { /* n:\"BrtWsFmtInfoEx14\" */ },\n\t/*::[*/0x0416/*::]*/: { /* n:\"BrtBeginConditionalFormatting14\", */ T:1 },\n\t/*::[*/0x0417/*::]*/: { /* n:\"BrtEndConditionalFormatting14\", */ T:-1 },\n\t/*::[*/0x0418/*::]*/: { /* n:\"BrtBeginCFRule14\", */ T:1 },\n\t/*::[*/0x0419/*::]*/: { /* n:\"BrtEndCFRule14\", */ T:-1 },\n\t/*::[*/0x041A/*::]*/: { /* n:\"BrtCFVO14\" */ },\n\t/*::[*/0x041B/*::]*/: { /* n:\"BrtBeginDatabar14\", */ T:1 },\n\t/*::[*/0x041C/*::]*/: { /* n:\"BrtBeginIconSet14\", */ T:1 },\n\t/*::[*/0x041D/*::]*/: { /* n:\"BrtDVal14\", */ f: parse_BrtDVal14 },\n\t/*::[*/0x041E/*::]*/: { /* n:\"BrtBeginDVals14\", */ T:1 },\n\t/*::[*/0x041F/*::]*/: { /* n:\"BrtColor14\" */ },\n\t/*::[*/0x0420/*::]*/: { /* n:\"BrtBeginSparklines\", */ T:1 },\n\t/*::[*/0x0421/*::]*/: { /* n:\"BrtEndSparklines\", */ T:-1 },\n\t/*::[*/0x0422/*::]*/: { /* n:\"BrtBeginSparklineGroups\", */ T:1 },\n\t/*::[*/0x0423/*::]*/: { /* n:\"BrtEndSparklineGroups\", */ T:-1 },\n\t/*::[*/0x0425/*::]*/: { /* n:\"BrtSXVD14\" */ },\n\t/*::[*/0x0426/*::]*/: { /* n:\"BrtBeginSXView14\", */ T:1 },\n\t/*::[*/0x0427/*::]*/: { /* n:\"BrtEndSXView14\", */ T:-1 },\n\t/*::[*/0x0428/*::]*/: { /* n:\"BrtBeginSXView16\", */ T:1 },\n\t/*::[*/0x0429/*::]*/: { /* n:\"BrtEndSXView16\", */ T:-1 },\n\t/*::[*/0x042A/*::]*/: { /* n:\"BrtBeginPCD14\", */ T:1 },\n\t/*::[*/0x042B/*::]*/: { /* n:\"BrtEndPCD14\", */ T:-1 },\n\t/*::[*/0x042C/*::]*/: { /* n:\"BrtBeginExtConn14\", */ T:1 },\n\t/*::[*/0x042D/*::]*/: { /* n:\"BrtEndExtConn14\", */ T:-1 },\n\t/*::[*/0x042E/*::]*/: { /* n:\"BrtBeginSlicerCacheIDs\", */ T:1 },\n\t/*::[*/0x042F/*::]*/: { /* n:\"BrtEndSlicerCacheIDs\", */ T:-1 },\n\t/*::[*/0x0430/*::]*/: { /* n:\"BrtBeginSlicerCacheID\", */ T:1 },\n\t/*::[*/0x0431/*::]*/: { /* n:\"BrtEndSlicerCacheID\", */ T:-1 },\n\t/*::[*/0x0433/*::]*/: { /* n:\"BrtBeginSlicerCache\", */ T:1 },\n\t/*::[*/0x0434/*::]*/: { /* n:\"BrtEndSlicerCache\", */ T:-1 },\n\t/*::[*/0x0435/*::]*/: { /* n:\"BrtBeginSlicerCacheDef\", */ T:1 },\n\t/*::[*/0x0436/*::]*/: { /* n:\"BrtEndSlicerCacheDef\", */ T:-1 },\n\t/*::[*/0x0437/*::]*/: { /* n:\"BrtBeginSlicersEx\", */ T:1 },\n\t/*::[*/0x0438/*::]*/: { /* n:\"BrtEndSlicersEx\", */ T:-1 },\n\t/*::[*/0x0439/*::]*/: { /* n:\"BrtBeginSlicerEx\", */ T:1 },\n\t/*::[*/0x043A/*::]*/: { /* n:\"BrtEndSlicerEx\", */ T:-1 },\n\t/*::[*/0x043B/*::]*/: { /* n:\"BrtBeginSlicer\", */ T:1 },\n\t/*::[*/0x043C/*::]*/: { /* n:\"BrtEndSlicer\", */ T:-1 },\n\t/*::[*/0x043D/*::]*/: { /* n:\"BrtSlicerCachePivotTables\" */ },\n\t/*::[*/0x043E/*::]*/: { /* n:\"BrtBeginSlicerCacheOlapImpl\", */ T:1 },\n\t/*::[*/0x043F/*::]*/: { /* n:\"BrtEndSlicerCacheOlapImpl\", */ T:-1 },\n\t/*::[*/0x0440/*::]*/: { /* n:\"BrtBeginSlicerCacheLevelsData\", */ T:1 },\n\t/*::[*/0x0441/*::]*/: { /* n:\"BrtEndSlicerCacheLevelsData\", */ T:-1 },\n\t/*::[*/0x0442/*::]*/: { /* n:\"BrtBeginSlicerCacheLevelData\", */ T:1 },\n\t/*::[*/0x0443/*::]*/: { /* n:\"BrtEndSlicerCacheLevelData\", */ T:-1 },\n\t/*::[*/0x0444/*::]*/: { /* n:\"BrtBeginSlicerCacheSiRanges\", */ T:1 },\n\t/*::[*/0x0445/*::]*/: { /* n:\"BrtEndSlicerCacheSiRanges\", */ T:-1 },\n\t/*::[*/0x0446/*::]*/: { /* n:\"BrtBeginSlicerCacheSiRange\", */ T:1 },\n\t/*::[*/0x0447/*::]*/: { /* n:\"BrtEndSlicerCacheSiRange\", */ T:-1 },\n\t/*::[*/0x0448/*::]*/: { /* n:\"BrtSlicerCacheOlapItem\" */ },\n\t/*::[*/0x0449/*::]*/: { /* n:\"BrtBeginSlicerCacheSelections\", */ T:1 },\n\t/*::[*/0x044A/*::]*/: { /* n:\"BrtSlicerCacheSelection\" */ },\n\t/*::[*/0x044B/*::]*/: { /* n:\"BrtEndSlicerCacheSelections\", */ T:-1 },\n\t/*::[*/0x044C/*::]*/: { /* n:\"BrtBeginSlicerCacheNative\", */ T:1 },\n\t/*::[*/0x044D/*::]*/: { /* n:\"BrtEndSlicerCacheNative\", */ T:-1 },\n\t/*::[*/0x044E/*::]*/: { /* n:\"BrtSlicerCacheNativeItem\" */ },\n\t/*::[*/0x044F/*::]*/: { /* n:\"BrtRangeProtection14\" */ },\n\t/*::[*/0x0450/*::]*/: { /* n:\"BrtRangeProtectionIso14\" */ },\n\t/*::[*/0x0451/*::]*/: { /* n:\"BrtCellIgnoreEC14\" */ },\n\t/*::[*/0x0457/*::]*/: { /* n:\"BrtList14\" */ },\n\t/*::[*/0x0458/*::]*/: { /* n:\"BrtCFIcon\" */ },\n\t/*::[*/0x0459/*::]*/: { /* n:\"BrtBeginSlicerCachesPivotCacheIDs\", */ T:1 },\n\t/*::[*/0x045A/*::]*/: { /* n:\"BrtEndSlicerCachesPivotCacheIDs\", */ T:-1 },\n\t/*::[*/0x045B/*::]*/: { /* n:\"BrtBeginSlicers\", */ T:1 },\n\t/*::[*/0x045C/*::]*/: { /* n:\"BrtEndSlicers\", */ T:-1 },\n\t/*::[*/0x045D/*::]*/: { /* n:\"BrtWbProp14\" */ },\n\t/*::[*/0x045E/*::]*/: { /* n:\"BrtBeginSXEdit\", */ T:1 },\n\t/*::[*/0x045F/*::]*/: { /* n:\"BrtEndSXEdit\", */ T:-1 },\n\t/*::[*/0x0460/*::]*/: { /* n:\"BrtBeginSXEdits\", */ T:1 },\n\t/*::[*/0x0461/*::]*/: { /* n:\"BrtEndSXEdits\", */ T:-1 },\n\t/*::[*/0x0462/*::]*/: { /* n:\"BrtBeginSXChange\", */ T:1 },\n\t/*::[*/0x0463/*::]*/: { /* n:\"BrtEndSXChange\", */ T:-1 },\n\t/*::[*/0x0464/*::]*/: { /* n:\"BrtBeginSXChanges\", */ T:1 },\n\t/*::[*/0x0465/*::]*/: { /* n:\"BrtEndSXChanges\", */ T:-1 },\n\t/*::[*/0x0466/*::]*/: { /* n:\"BrtSXTupleItems\" */ },\n\t/*::[*/0x0468/*::]*/: { /* n:\"BrtBeginSlicerStyle\", */ T:1 },\n\t/*::[*/0x0469/*::]*/: { /* n:\"BrtEndSlicerStyle\", */ T:-1 },\n\t/*::[*/0x046A/*::]*/: { /* n:\"BrtSlicerStyleElement\" */ },\n\t/*::[*/0x046B/*::]*/: { /* n:\"BrtBeginStyleSheetExt14\", */ T:1 },\n\t/*::[*/0x046C/*::]*/: { /* n:\"BrtEndStyleSheetExt14\", */ T:-1 },\n\t/*::[*/0x046D/*::]*/: { /* n:\"BrtBeginSlicerCachesPivotCacheID\", */ T:1 },\n\t/*::[*/0x046E/*::]*/: { /* n:\"BrtEndSlicerCachesPivotCacheID\", */ T:-1 },\n\t/*::[*/0x046F/*::]*/: { /* n:\"BrtBeginConditionalFormattings\", */ T:1 },\n\t/*::[*/0x0470/*::]*/: { /* n:\"BrtEndConditionalFormattings\", */ T:-1 },\n\t/*::[*/0x0471/*::]*/: { /* n:\"BrtBeginPCDCalcMemExt\", */ T:1 },\n\t/*::[*/0x0472/*::]*/: { /* n:\"BrtEndPCDCalcMemExt\", */ T:-1 },\n\t/*::[*/0x0473/*::]*/: { /* n:\"BrtBeginPCDCalcMemsExt\", */ T:1 },\n\t/*::[*/0x0474/*::]*/: { /* n:\"BrtEndPCDCalcMemsExt\", */ T:-1 },\n\t/*::[*/0x0475/*::]*/: { /* n:\"BrtPCDField14\" */ },\n\t/*::[*/0x0476/*::]*/: { /* n:\"BrtBeginSlicerStyles\", */ T:1 },\n\t/*::[*/0x0477/*::]*/: { /* n:\"BrtEndSlicerStyles\", */ T:-1 },\n\t/*::[*/0x0478/*::]*/: { /* n:\"BrtBeginSlicerStyleElements\", */ T:1 },\n\t/*::[*/0x0479/*::]*/: { /* n:\"BrtEndSlicerStyleElements\", */ T:-1 },\n\t/*::[*/0x047A/*::]*/: { /* n:\"BrtCFRuleExt\" */ },\n\t/*::[*/0x047B/*::]*/: { /* n:\"BrtBeginSXCondFmt14\", */ T:1 },\n\t/*::[*/0x047C/*::]*/: { /* n:\"BrtEndSXCondFmt14\", */ T:-1 },\n\t/*::[*/0x047D/*::]*/: { /* n:\"BrtBeginSXCondFmts14\", */ T:1 },\n\t/*::[*/0x047E/*::]*/: { /* n:\"BrtEndSXCondFmts14\", */ T:-1 },\n\t/*::[*/0x0480/*::]*/: { /* n:\"BrtBeginSortCond14\", */ T:1 },\n\t/*::[*/0x0481/*::]*/: { /* n:\"BrtEndSortCond14\", */ T:-1 },\n\t/*::[*/0x0482/*::]*/: { /* n:\"BrtEndDVals14\", */ T:-1 },\n\t/*::[*/0x0483/*::]*/: { /* n:\"BrtEndIconSet14\", */ T:-1 },\n\t/*::[*/0x0484/*::]*/: { /* n:\"BrtEndDatabar14\", */ T:-1 },\n\t/*::[*/0x0485/*::]*/: { /* n:\"BrtBeginColorScale14\", */ T:1 },\n\t/*::[*/0x0486/*::]*/: { /* n:\"BrtEndColorScale14\", */ T:-1 },\n\t/*::[*/0x0487/*::]*/: { /* n:\"BrtBeginSxrules14\", */ T:1 },\n\t/*::[*/0x0488/*::]*/: { /* n:\"BrtEndSxrules14\", */ T:-1 },\n\t/*::[*/0x0489/*::]*/: { /* n:\"BrtBeginPRule14\", */ T:1 },\n\t/*::[*/0x048A/*::]*/: { /* n:\"BrtEndPRule14\", */ T:-1 },\n\t/*::[*/0x048B/*::]*/: { /* n:\"BrtBeginPRFilters14\", */ T:1 },\n\t/*::[*/0x048C/*::]*/: { /* n:\"BrtEndPRFilters14\", */ T:-1 },\n\t/*::[*/0x048D/*::]*/: { /* n:\"BrtBeginPRFilter14\", */ T:1 },\n\t/*::[*/0x048E/*::]*/: { /* n:\"BrtEndPRFilter14\", */ T:-1 },\n\t/*::[*/0x048F/*::]*/: { /* n:\"BrtBeginPRFItem14\", */ T:1 },\n\t/*::[*/0x0490/*::]*/: { /* n:\"BrtEndPRFItem14\", */ T:-1 },\n\t/*::[*/0x0491/*::]*/: { /* n:\"BrtBeginCellIgnoreECs14\", */ T:1 },\n\t/*::[*/0x0492/*::]*/: { /* n:\"BrtEndCellIgnoreECs14\", */ T:-1 },\n\t/*::[*/0x0493/*::]*/: { /* n:\"BrtDxf14\" */ },\n\t/*::[*/0x0494/*::]*/: { /* n:\"BrtBeginDxF14s\", */ T:1 },\n\t/*::[*/0x0495/*::]*/: { /* n:\"BrtEndDxf14s\", */ T:-1 },\n\t/*::[*/0x0499/*::]*/: { /* n:\"BrtFilter14\" */ },\n\t/*::[*/0x049A/*::]*/: { /* n:\"BrtBeginCustomFilters14\", */ T:1 },\n\t/*::[*/0x049C/*::]*/: { /* n:\"BrtCustomFilter14\" */ },\n\t/*::[*/0x049D/*::]*/: { /* n:\"BrtIconFilter14\" */ },\n\t/*::[*/0x049E/*::]*/: { /* n:\"BrtPivotCacheConnectionName\" */ },\n\t/*::[*/0x0800/*::]*/: { /* n:\"BrtBeginDecoupledPivotCacheIDs\", */ T:1 },\n\t/*::[*/0x0801/*::]*/: { /* n:\"BrtEndDecoupledPivotCacheIDs\", */ T:-1 },\n\t/*::[*/0x0802/*::]*/: { /* n:\"BrtDecoupledPivotCacheID\" */ },\n\t/*::[*/0x0803/*::]*/: { /* n:\"BrtBeginPivotTableRefs\", */ T:1 },\n\t/*::[*/0x0804/*::]*/: { /* n:\"BrtEndPivotTableRefs\", */ T:-1 },\n\t/*::[*/0x0805/*::]*/: { /* n:\"BrtPivotTableRef\" */ },\n\t/*::[*/0x0806/*::]*/: { /* n:\"BrtSlicerCacheBookPivotTables\" */ },\n\t/*::[*/0x0807/*::]*/: { /* n:\"BrtBeginSxvcells\", */ T:1 },\n\t/*::[*/0x0808/*::]*/: { /* n:\"BrtEndSxvcells\", */ T:-1 },\n\t/*::[*/0x0809/*::]*/: { /* n:\"BrtBeginSxRow\", */ T:1 },\n\t/*::[*/0x080A/*::]*/: { /* n:\"BrtEndSxRow\", */ T:-1 },\n\t/*::[*/0x080C/*::]*/: { /* n:\"BrtPcdCalcMem15\" */ },\n\t/*::[*/0x0813/*::]*/: { /* n:\"BrtQsi15\" */ },\n\t/*::[*/0x0814/*::]*/: { /* n:\"BrtBeginWebExtensions\", */ T:1 },\n\t/*::[*/0x0815/*::]*/: { /* n:\"BrtEndWebExtensions\", */ T:-1 },\n\t/*::[*/0x0816/*::]*/: { /* n:\"BrtWebExtension\" */ },\n\t/*::[*/0x0817/*::]*/: { /* n:\"BrtAbsPath15\" */ },\n\t/*::[*/0x0818/*::]*/: { /* n:\"BrtBeginPivotTableUISettings\", */ T:1 },\n\t/*::[*/0x0819/*::]*/: { /* n:\"BrtEndPivotTableUISettings\", */ T:-1 },\n\t/*::[*/0x081B/*::]*/: { /* n:\"BrtTableSlicerCacheIDs\" */ },\n\t/*::[*/0x081C/*::]*/: { /* n:\"BrtTableSlicerCacheID\" */ },\n\t/*::[*/0x081D/*::]*/: { /* n:\"BrtBeginTableSlicerCache\", */ T:1 },\n\t/*::[*/0x081E/*::]*/: { /* n:\"BrtEndTableSlicerCache\", */ T:-1 },\n\t/*::[*/0x081F/*::]*/: { /* n:\"BrtSxFilter15\" */ },\n\t/*::[*/0x0820/*::]*/: { /* n:\"BrtBeginTimelineCachePivotCacheIDs\", */ T:1 },\n\t/*::[*/0x0821/*::]*/: { /* n:\"BrtEndTimelineCachePivotCacheIDs\", */ T:-1 },\n\t/*::[*/0x0822/*::]*/: { /* n:\"BrtTimelineCachePivotCacheID\" */ },\n\t/*::[*/0x0823/*::]*/: { /* n:\"BrtBeginTimelineCacheIDs\", */ T:1 },\n\t/*::[*/0x0824/*::]*/: { /* n:\"BrtEndTimelineCacheIDs\", */ T:-1 },\n\t/*::[*/0x0825/*::]*/: { /* n:\"BrtBeginTimelineCacheID\", */ T:1 },\n\t/*::[*/0x0826/*::]*/: { /* n:\"BrtEndTimelineCacheID\", */ T:-1 },\n\t/*::[*/0x0827/*::]*/: { /* n:\"BrtBeginTimelinesEx\", */ T:1 },\n\t/*::[*/0x0828/*::]*/: { /* n:\"BrtEndTimelinesEx\", */ T:-1 },\n\t/*::[*/0x0829/*::]*/: { /* n:\"BrtBeginTimelineEx\", */ T:1 },\n\t/*::[*/0x082A/*::]*/: { /* n:\"BrtEndTimelineEx\", */ T:-1 },\n\t/*::[*/0x082B/*::]*/: { /* n:\"BrtWorkBookPr15\" */ },\n\t/*::[*/0x082C/*::]*/: { /* n:\"BrtPCDH15\" */ },\n\t/*::[*/0x082D/*::]*/: { /* n:\"BrtBeginTimelineStyle\", */ T:1 },\n\t/*::[*/0x082E/*::]*/: { /* n:\"BrtEndTimelineStyle\", */ T:-1 },\n\t/*::[*/0x082F/*::]*/: { /* n:\"BrtTimelineStyleElement\" */ },\n\t/*::[*/0x0830/*::]*/: { /* n:\"BrtBeginTimelineStylesheetExt15\", */ T:1 },\n\t/*::[*/0x0831/*::]*/: { /* n:\"BrtEndTimelineStylesheetExt15\", */ T:-1 },\n\t/*::[*/0x0832/*::]*/: { /* n:\"BrtBeginTimelineStyles\", */ T:1 },\n\t/*::[*/0x0833/*::]*/: { /* n:\"BrtEndTimelineStyles\", */ T:-1 },\n\t/*::[*/0x0834/*::]*/: { /* n:\"BrtBeginTimelineStyleElements\", */ T:1 },\n\t/*::[*/0x0835/*::]*/: { /* n:\"BrtEndTimelineStyleElements\", */ T:-1 },\n\t/*::[*/0x0836/*::]*/: { /* n:\"BrtDxf15\" */ },\n\t/*::[*/0x0837/*::]*/: { /* n:\"BrtBeginDxfs15\", */ T:1 },\n\t/*::[*/0x0838/*::]*/: { /* n:\"BrtEndDxfs15\", */ T:-1 },\n\t/*::[*/0x0839/*::]*/: { /* n:\"BrtSlicerCacheHideItemsWithNoData\" */ },\n\t/*::[*/0x083A/*::]*/: { /* n:\"BrtBeginItemUniqueNames\", */ T:1 },\n\t/*::[*/0x083B/*::]*/: { /* n:\"BrtEndItemUniqueNames\", */ T:-1 },\n\t/*::[*/0x083C/*::]*/: { /* n:\"BrtItemUniqueName\" */ },\n\t/*::[*/0x083D/*::]*/: { /* n:\"BrtBeginExtConn15\", */ T:1 },\n\t/*::[*/0x083E/*::]*/: { /* n:\"BrtEndExtConn15\", */ T:-1 },\n\t/*::[*/0x083F/*::]*/: { /* n:\"BrtBeginOledbPr15\", */ T:1 },\n\t/*::[*/0x0840/*::]*/: { /* n:\"BrtEndOledbPr15\", */ T:-1 },\n\t/*::[*/0x0841/*::]*/: { /* n:\"BrtBeginDataFeedPr15\", */ T:1 },\n\t/*::[*/0x0842/*::]*/: { /* n:\"BrtEndDataFeedPr15\", */ T:-1 },\n\t/*::[*/0x0843/*::]*/: { /* n:\"BrtTextPr15\" */ },\n\t/*::[*/0x0844/*::]*/: { /* n:\"BrtRangePr15\" */ },\n\t/*::[*/0x0845/*::]*/: { /* n:\"BrtDbCommand15\" */ },\n\t/*::[*/0x0846/*::]*/: { /* n:\"BrtBeginDbTables15\", */ T:1 },\n\t/*::[*/0x0847/*::]*/: { /* n:\"BrtEndDbTables15\", */ T:-1 },\n\t/*::[*/0x0848/*::]*/: { /* n:\"BrtDbTable15\" */ },\n\t/*::[*/0x0849/*::]*/: { /* n:\"BrtBeginDataModel\", */ T:1 },\n\t/*::[*/0x084A/*::]*/: { /* n:\"BrtEndDataModel\", */ T:-1 },\n\t/*::[*/0x084B/*::]*/: { /* n:\"BrtBeginModelTables\", */ T:1 },\n\t/*::[*/0x084C/*::]*/: { /* n:\"BrtEndModelTables\", */ T:-1 },\n\t/*::[*/0x084D/*::]*/: { /* n:\"BrtModelTable\" */ },\n\t/*::[*/0x084E/*::]*/: { /* n:\"BrtBeginModelRelationships\", */ T:1 },\n\t/*::[*/0x084F/*::]*/: { /* n:\"BrtEndModelRelationships\", */ T:-1 },\n\t/*::[*/0x0850/*::]*/: { /* n:\"BrtModelRelationship\" */ },\n\t/*::[*/0x0851/*::]*/: { /* n:\"BrtBeginECTxtWiz15\", */ T:1 },\n\t/*::[*/0x0852/*::]*/: { /* n:\"BrtEndECTxtWiz15\", */ T:-1 },\n\t/*::[*/0x0853/*::]*/: { /* n:\"BrtBeginECTWFldInfoLst15\", */ T:1 },\n\t/*::[*/0x0854/*::]*/: { /* n:\"BrtEndECTWFldInfoLst15\", */ T:-1 },\n\t/*::[*/0x0855/*::]*/: { /* n:\"BrtBeginECTWFldInfo15\", */ T:1 },\n\t/*::[*/0x0856/*::]*/: { /* n:\"BrtFieldListActiveItem\" */ },\n\t/*::[*/0x0857/*::]*/: { /* n:\"BrtPivotCacheIdVersion\" */ },\n\t/*::[*/0x0858/*::]*/: { /* n:\"BrtSXDI15\" */ },\n\t/*::[*/0x0859/*::]*/: { /* n:\"BrtBeginModelTimeGroupings\", */ T:1 },\n\t/*::[*/0x085A/*::]*/: { /* n:\"BrtEndModelTimeGroupings\", */ T:-1 },\n\t/*::[*/0x085B/*::]*/: { /* n:\"BrtBeginModelTimeGrouping\", */ T:1 },\n\t/*::[*/0x085C/*::]*/: { /* n:\"BrtEndModelTimeGrouping\", */ T:-1 },\n\t/*::[*/0x085D/*::]*/: { /* n:\"BrtModelTimeGroupingCalcCol\" */ },\n\t/*::[*/0x0C00/*::]*/: { /* n:\"BrtUid\" */ },\n\t/*::[*/0x0C01/*::]*/: { /* n:\"BrtRevisionPtr\" */ },\n\t/*::[*/0x1000/*::]*/: { /* n:\"BrtBeginDynamicArrayPr\", */ T:1 },\n\t/*::[*/0x1001/*::]*/: { /* n:\"BrtEndDynamicArrayPr\", */ T:-1 },\n\t/*::[*/0x138A/*::]*/: { /* n:\"BrtBeginRichValueBlock\", */ T:1 },\n\t/*::[*/0x138B/*::]*/: { /* n:\"BrtEndRichValueBlock\", */ T:-1 },\n\t/*::[*/0x13D9/*::]*/: { /* n:\"BrtBeginRichFilters\", */ T:1 },\n\t/*::[*/0x13DA/*::]*/: { /* n:\"BrtEndRichFilters\", */ T:-1 },\n\t/*::[*/0x13DB/*::]*/: { /* n:\"BrtRichFilter\" */ },\n\t/*::[*/0x13DC/*::]*/: { /* n:\"BrtBeginRichFilterColumn\", */ T:1 },\n\t/*::[*/0x13DD/*::]*/: { /* n:\"BrtEndRichFilterColumn\", */ T:-1 },\n\t/*::[*/0x13DE/*::]*/: { /* n:\"BrtBeginCustomRichFilters\", */ T:1 },\n\t/*::[*/0x13DF/*::]*/: { /* n:\"BrtEndCustomRichFilters\", */ T:-1 },\n\t/*::[*/0x13E0/*::]*/: { /* n:\"BrtCustomRichFilter\" */ },\n\t/*::[*/0x13E1/*::]*/: { /* n:\"BrtTop10RichFilter\" */ },\n\t/*::[*/0x13E2/*::]*/: { /* n:\"BrtDynamicRichFilter\" */ },\n\t/*::[*/0x13E4/*::]*/: { /* n:\"BrtBeginRichSortCondition\", */ T:1 },\n\t/*::[*/0x13E5/*::]*/: { /* n:\"BrtEndRichSortCondition\", */ T:-1 },\n\t/*::[*/0x13E6/*::]*/: { /* n:\"BrtRichFilterDateGroupItem\" */ },\n\t/*::[*/0x13E7/*::]*/: { /* n:\"BrtBeginCalcFeatures\", */ T:1 },\n\t/*::[*/0x13E8/*::]*/: { /* n:\"BrtEndCalcFeatures\", */ T:-1 },\n\t/*::[*/0x13E9/*::]*/: { /* n:\"BrtCalcFeature\" */ },\n\t/*::[*/0x13EB/*::]*/: { /* n:\"BrtExternalLinksPr\" */ },\n\t/*::[*/0xFFFF/*::]*/: { n:\"\" }\n};\n\n/* [MS-XLS] 2.3 Record Enumeration (and other sources) */\nvar XLSRecordEnum = {\n\t/* [MS-XLS] 2.3 Record Enumeration 2021-08-17 */\n\t/*::[*/0x0006/*::]*/: { /* n:\"Formula\", */ f:parse_Formula },\n\t/*::[*/0x000a/*::]*/: { /* n:\"EOF\", */ f:parsenoop2 },\n\t/*::[*/0x000c/*::]*/: { /* n:\"CalcCount\", */ f:parseuint16 }, //\n\t/*::[*/0x000d/*::]*/: { /* n:\"CalcMode\", */ f:parseuint16 }, //\n\t/*::[*/0x000e/*::]*/: { /* n:\"CalcPrecision\", */ f:parsebool }, //\n\t/*::[*/0x000f/*::]*/: { /* n:\"CalcRefMode\", */ f:parsebool }, //\n\t/*::[*/0x0010/*::]*/: { /* n:\"CalcDelta\", */ f:parse_Xnum }, //\n\t/*::[*/0x0011/*::]*/: { /* n:\"CalcIter\", */ f:parsebool }, //\n\t/*::[*/0x0012/*::]*/: { /* n:\"Protect\", */ f:parsebool },\n\t/*::[*/0x0013/*::]*/: { /* n:\"Password\", */ f:parseuint16 },\n\t/*::[*/0x0014/*::]*/: { /* n:\"Header\", */ f:parse_XLHeaderFooter },\n\t/*::[*/0x0015/*::]*/: { /* n:\"Footer\", */ f:parse_XLHeaderFooter },\n\t/*::[*/0x0017/*::]*/: { /* n:\"ExternSheet\", */ f:parse_ExternSheet },\n\t/*::[*/0x0018/*::]*/: { /* n:\"Lbl\", */ f:parse_Lbl },\n\t/*::[*/0x0019/*::]*/: { /* n:\"WinProtect\", */ f:parsebool },\n\t/*::[*/0x001a/*::]*/: { /* n:\"VerticalPageBreaks\", */ },\n\t/*::[*/0x001b/*::]*/: { /* n:\"HorizontalPageBreaks\", */ },\n\t/*::[*/0x001c/*::]*/: { /* n:\"Note\", */ f:parse_Note },\n\t/*::[*/0x001d/*::]*/: { /* n:\"Selection\", */ },\n\t/*::[*/0x0022/*::]*/: { /* n:\"Date1904\", */ f:parsebool },\n\t/*::[*/0x0023/*::]*/: { /* n:\"ExternName\", */ f:parse_ExternName },\n\t/*::[*/0x0026/*::]*/: { /* n:\"LeftMargin\", */ f:parse_Xnum }, // *\n\t/*::[*/0x0027/*::]*/: { /* n:\"RightMargin\", */ f:parse_Xnum }, // *\n\t/*::[*/0x0028/*::]*/: { /* n:\"TopMargin\", */ f:parse_Xnum }, // *\n\t/*::[*/0x0029/*::]*/: { /* n:\"BottomMargin\", */ f:parse_Xnum }, // *\n\t/*::[*/0x002a/*::]*/: { /* n:\"PrintRowCol\", */ f:parsebool },\n\t/*::[*/0x002b/*::]*/: { /* n:\"PrintGrid\", */ f:parsebool },\n\t/*::[*/0x002f/*::]*/: { /* n:\"FilePass\", */ f:parse_FilePass },\n\t/*::[*/0x0031/*::]*/: { /* n:\"Font\", */ f:parse_Font },\n\t/*::[*/0x0033/*::]*/: { /* n:\"PrintSize\", */ f:parseuint16 },\n\t/*::[*/0x003c/*::]*/: { /* n:\"Continue\", */ },\n\t/*::[*/0x003d/*::]*/: { /* n:\"Window1\", */ f:parse_Window1 },\n\t/*::[*/0x0040/*::]*/: { /* n:\"Backup\", */ f:parsebool },\n\t/*::[*/0x0041/*::]*/: { /* n:\"Pane\", */ f:parse_Pane },\n\t/*::[*/0x0042/*::]*/: { /* n:\"CodePage\", */ f:parseuint16 },\n\t/*::[*/0x004d/*::]*/: { /* n:\"Pls\", */ },\n\t/*::[*/0x0050/*::]*/: { /* n:\"DCon\", */ },\n\t/*::[*/0x0051/*::]*/: { /* n:\"DConRef\", */ },\n\t/*::[*/0x0052/*::]*/: { /* n:\"DConName\", */ },\n\t/*::[*/0x0055/*::]*/: { /* n:\"DefColWidth\", */ f:parseuint16 },\n\t/*::[*/0x0059/*::]*/: { /* n:\"XCT\", */ },\n\t/*::[*/0x005a/*::]*/: { /* n:\"CRN\", */ },\n\t/*::[*/0x005b/*::]*/: { /* n:\"FileSharing\", */ },\n\t/*::[*/0x005c/*::]*/: { /* n:\"WriteAccess\", */ f:parse_WriteAccess },\n\t/*::[*/0x005d/*::]*/: { /* n:\"Obj\", */ f:parse_Obj },\n\t/*::[*/0x005e/*::]*/: { /* n:\"Uncalced\", */ },\n\t/*::[*/0x005f/*::]*/: { /* n:\"CalcSaveRecalc\", */ f:parsebool }, //\n\t/*::[*/0x0060/*::]*/: { /* n:\"Template\", */ },\n\t/*::[*/0x0061/*::]*/: { /* n:\"Intl\", */ },\n\t/*::[*/0x0063/*::]*/: { /* n:\"ObjProtect\", */ f:parsebool },\n\t/*::[*/0x007d/*::]*/: { /* n:\"ColInfo\", */ f:parse_ColInfo },\n\t/*::[*/0x0080/*::]*/: { /* n:\"Guts\", */ f:parse_Guts },\n\t/*::[*/0x0081/*::]*/: { /* n:\"WsBool\", */ f:parse_WsBool },\n\t/*::[*/0x0082/*::]*/: { /* n:\"GridSet\", */ f:parseuint16 },\n\t/*::[*/0x0083/*::]*/: { /* n:\"HCenter\", */ f:parsebool },\n\t/*::[*/0x0084/*::]*/: { /* n:\"VCenter\", */ f:parsebool },\n\t/*::[*/0x0085/*::]*/: { /* n:\"BoundSheet8\", */ f:parse_BoundSheet8 },\n\t/*::[*/0x0086/*::]*/: { /* n:\"WriteProtect\", */ },\n\t/*::[*/0x008c/*::]*/: { /* n:\"Country\", */ f:parse_Country },\n\t/*::[*/0x008d/*::]*/: { /* n:\"HideObj\", */ f:parseuint16 },\n\t/*::[*/0x0090/*::]*/: { /* n:\"Sort\", */ },\n\t/*::[*/0x0092/*::]*/: { /* n:\"Palette\", */ f:parse_Palette },\n\t/*::[*/0x0097/*::]*/: { /* n:\"Sync\", */ },\n\t/*::[*/0x0098/*::]*/: { /* n:\"LPr\", */ },\n\t/*::[*/0x0099/*::]*/: { /* n:\"DxGCol\", */ },\n\t/*::[*/0x009a/*::]*/: { /* n:\"FnGroupName\", */ },\n\t/*::[*/0x009b/*::]*/: { /* n:\"FilterMode\", */ },\n\t/*::[*/0x009c/*::]*/: { /* n:\"BuiltInFnGroupCount\", */ f:parseuint16 },\n\t/*::[*/0x009d/*::]*/: { /* n:\"AutoFilterInfo\", */ },\n\t/*::[*/0x009e/*::]*/: { /* n:\"AutoFilter\", */ },\n\t/*::[*/0x00a0/*::]*/: { /* n:\"Scl\", */ f:parse_Scl },\n\t/*::[*/0x00a1/*::]*/: { /* n:\"Setup\", */ f:parse_Setup },\n\t/*::[*/0x00ae/*::]*/: { /* n:\"ScenMan\", */ },\n\t/*::[*/0x00af/*::]*/: { /* n:\"SCENARIO\", */ },\n\t/*::[*/0x00b0/*::]*/: { /* n:\"SxView\", */ },\n\t/*::[*/0x00b1/*::]*/: { /* n:\"Sxvd\", */ },\n\t/*::[*/0x00b2/*::]*/: { /* n:\"SXVI\", */ },\n\t/*::[*/0x00b4/*::]*/: { /* n:\"SxIvd\", */ },\n\t/*::[*/0x00b5/*::]*/: { /* n:\"SXLI\", */ },\n\t/*::[*/0x00b6/*::]*/: { /* n:\"SXPI\", */ },\n\t/*::[*/0x00b8/*::]*/: { /* n:\"DocRoute\", */ },\n\t/*::[*/0x00b9/*::]*/: { /* n:\"RecipName\", */ },\n\t/*::[*/0x00bd/*::]*/: { /* n:\"MulRk\", */ f:parse_MulRk },\n\t/*::[*/0x00be/*::]*/: { /* n:\"MulBlank\", */ f:parse_MulBlank },\n\t/*::[*/0x00c1/*::]*/: { /* n:\"Mms\", */ f:parsenoop2 },\n\t/*::[*/0x00c5/*::]*/: { /* n:\"SXDI\", */ },\n\t/*::[*/0x00c6/*::]*/: { /* n:\"SXDB\", */ },\n\t/*::[*/0x00c7/*::]*/: { /* n:\"SXFDB\", */ },\n\t/*::[*/0x00c8/*::]*/: { /* n:\"SXDBB\", */ },\n\t/*::[*/0x00c9/*::]*/: { /* n:\"SXNum\", */ },\n\t/*::[*/0x00ca/*::]*/: { /* n:\"SxBool\", */ f:parsebool },\n\t/*::[*/0x00cb/*::]*/: { /* n:\"SxErr\", */ },\n\t/*::[*/0x00cc/*::]*/: { /* n:\"SXInt\", */ },\n\t/*::[*/0x00cd/*::]*/: { /* n:\"SXString\", */ },\n\t/*::[*/0x00ce/*::]*/: { /* n:\"SXDtr\", */ },\n\t/*::[*/0x00cf/*::]*/: { /* n:\"SxNil\", */ },\n\t/*::[*/0x00d0/*::]*/: { /* n:\"SXTbl\", */ },\n\t/*::[*/0x00d1/*::]*/: { /* n:\"SXTBRGIITM\", */ },\n\t/*::[*/0x00d2/*::]*/: { /* n:\"SxTbpg\", */ },\n\t/*::[*/0x00d3/*::]*/: { /* n:\"ObProj\", */ },\n\t/*::[*/0x00d5/*::]*/: { /* n:\"SXStreamID\", */ },\n\t/*::[*/0x00d7/*::]*/: { /* n:\"DBCell\", */ },\n\t/*::[*/0x00d8/*::]*/: { /* n:\"SXRng\", */ },\n\t/*::[*/0x00d9/*::]*/: { /* n:\"SxIsxoper\", */ },\n\t/*::[*/0x00da/*::]*/: { /* n:\"BookBool\", */ f:parseuint16 },\n\t/*::[*/0x00dc/*::]*/: { /* n:\"DbOrParamQry\", */ },\n\t/*::[*/0x00dd/*::]*/: { /* n:\"ScenarioProtect\", */ f:parsebool },\n\t/*::[*/0x00de/*::]*/: { /* n:\"OleObjectSize\", */ },\n\t/*::[*/0x00e0/*::]*/: { /* n:\"XF\", */ f:parse_XF },\n\t/*::[*/0x00e1/*::]*/: { /* n:\"InterfaceHdr\", */ f:parse_InterfaceHdr },\n\t/*::[*/0x00e2/*::]*/: { /* n:\"InterfaceEnd\", */ f:parsenoop2 },\n\t/*::[*/0x00e3/*::]*/: { /* n:\"SXVS\", */ },\n\t/*::[*/0x00e5/*::]*/: { /* n:\"MergeCells\", */ f:parse_MergeCells },\n\t/*::[*/0x00e9/*::]*/: { /* n:\"BkHim\", */ },\n\t/*::[*/0x00eb/*::]*/: { /* n:\"MsoDrawingGroup\", */ },\n\t/*::[*/0x00ec/*::]*/: { /* n:\"MsoDrawing\", */ },\n\t/*::[*/0x00ed/*::]*/: { /* n:\"MsoDrawingSelection\", */ },\n\t/*::[*/0x00ef/*::]*/: { /* n:\"PhoneticInfo\", */ },\n\t/*::[*/0x00f0/*::]*/: { /* n:\"SxRule\", */ },\n\t/*::[*/0x00f1/*::]*/: { /* n:\"SXEx\", */ },\n\t/*::[*/0x00f2/*::]*/: { /* n:\"SxFilt\", */ },\n\t/*::[*/0x00f4/*::]*/: { /* n:\"SxDXF\", */ },\n\t/*::[*/0x00f5/*::]*/: { /* n:\"SxItm\", */ },\n\t/*::[*/0x00f6/*::]*/: { /* n:\"SxName\", */ },\n\t/*::[*/0x00f7/*::]*/: { /* n:\"SxSelect\", */ },\n\t/*::[*/0x00f8/*::]*/: { /* n:\"SXPair\", */ },\n\t/*::[*/0x00f9/*::]*/: { /* n:\"SxFmla\", */ },\n\t/*::[*/0x00fb/*::]*/: { /* n:\"SxFormat\", */ },\n\t/*::[*/0x00fc/*::]*/: { /* n:\"SST\", */ f:parse_SST },\n\t/*::[*/0x00fd/*::]*/: { /* n:\"LabelSst\", */ f:parse_LabelSst },\n\t/*::[*/0x00ff/*::]*/: { /* n:\"ExtSST\", */ f:parse_ExtSST },\n\t/*::[*/0x0100/*::]*/: { /* n:\"SXVDEx\", */ },\n\t/*::[*/0x0103/*::]*/: { /* n:\"SXFormula\", */ },\n\t/*::[*/0x0122/*::]*/: { /* n:\"SXDBEx\", */ },\n\t/*::[*/0x0137/*::]*/: { /* n:\"RRDInsDel\", */ },\n\t/*::[*/0x0138/*::]*/: { /* n:\"RRDHead\", */ },\n\t/*::[*/0x013b/*::]*/: { /* n:\"RRDChgCell\", */ },\n\t/*::[*/0x013d/*::]*/: { /* n:\"RRTabId\", */ f:parseuint16a },\n\t/*::[*/0x013e/*::]*/: { /* n:\"RRDRenSheet\", */ },\n\t/*::[*/0x013f/*::]*/: { /* n:\"RRSort\", */ },\n\t/*::[*/0x0140/*::]*/: { /* n:\"RRDMove\", */ },\n\t/*::[*/0x014a/*::]*/: { /* n:\"RRFormat\", */ },\n\t/*::[*/0x014b/*::]*/: { /* n:\"RRAutoFmt\", */ },\n\t/*::[*/0x014d/*::]*/: { /* n:\"RRInsertSh\", */ },\n\t/*::[*/0x014e/*::]*/: { /* n:\"RRDMoveBegin\", */ },\n\t/*::[*/0x014f/*::]*/: { /* n:\"RRDMoveEnd\", */ },\n\t/*::[*/0x0150/*::]*/: { /* n:\"RRDInsDelBegin\", */ },\n\t/*::[*/0x0151/*::]*/: { /* n:\"RRDInsDelEnd\", */ },\n\t/*::[*/0x0152/*::]*/: { /* n:\"RRDConflict\", */ },\n\t/*::[*/0x0153/*::]*/: { /* n:\"RRDDefName\", */ },\n\t/*::[*/0x0154/*::]*/: { /* n:\"RRDRstEtxp\", */ },\n\t/*::[*/0x015f/*::]*/: { /* n:\"LRng\", */ },\n\t/*::[*/0x0160/*::]*/: { /* n:\"UsesELFs\", */ f:parsebool },\n\t/*::[*/0x0161/*::]*/: { /* n:\"DSF\", */ f:parsenoop2 },\n\t/*::[*/0x0191/*::]*/: { /* n:\"CUsr\", */ },\n\t/*::[*/0x0192/*::]*/: { /* n:\"CbUsr\", */ },\n\t/*::[*/0x0193/*::]*/: { /* n:\"UsrInfo\", */ },\n\t/*::[*/0x0194/*::]*/: { /* n:\"UsrExcl\", */ },\n\t/*::[*/0x0195/*::]*/: { /* n:\"FileLock\", */ },\n\t/*::[*/0x0196/*::]*/: { /* n:\"RRDInfo\", */ },\n\t/*::[*/0x0197/*::]*/: { /* n:\"BCUsrs\", */ },\n\t/*::[*/0x0198/*::]*/: { /* n:\"UsrChk\", */ },\n\t/*::[*/0x01a9/*::]*/: { /* n:\"UserBView\", */ },\n\t/*::[*/0x01aa/*::]*/: { /* n:\"UserSViewBegin\", */ },\n\t/*::[*/0x01ab/*::]*/: { /* n:\"UserSViewEnd\", */ },\n\t/*::[*/0x01ac/*::]*/: { /* n:\"RRDUserView\", */ },\n\t/*::[*/0x01ad/*::]*/: { /* n:\"Qsi\", */ },\n\t/*::[*/0x01ae/*::]*/: { /* n:\"SupBook\", */ f:parse_SupBook },\n\t/*::[*/0x01af/*::]*/: { /* n:\"Prot4Rev\", */ f:parsebool },\n\t/*::[*/0x01b0/*::]*/: { /* n:\"CondFmt\", */ },\n\t/*::[*/0x01b1/*::]*/: { /* n:\"CF\", */ },\n\t/*::[*/0x01b2/*::]*/: { /* n:\"DVal\", */ },\n\t/*::[*/0x01b5/*::]*/: { /* n:\"DConBin\", */ },\n\t/*::[*/0x01b6/*::]*/: { /* n:\"TxO\", */ f:parse_TxO },\n\t/*::[*/0x01b7/*::]*/: { /* n:\"RefreshAll\", */ f:parsebool }, //\n\t/*::[*/0x01b8/*::]*/: { /* n:\"HLink\", */ f:parse_HLink },\n\t/*::[*/0x01b9/*::]*/: { /* n:\"Lel\", */ },\n\t/*::[*/0x01ba/*::]*/: { /* n:\"CodeName\", */ f:parse_XLUnicodeString },\n\t/*::[*/0x01bb/*::]*/: { /* n:\"SXFDBType\", */ },\n\t/*::[*/0x01bc/*::]*/: { /* n:\"Prot4RevPass\", */ f:parseuint16 },\n\t/*::[*/0x01bd/*::]*/: { /* n:\"ObNoMacros\", */ },\n\t/*::[*/0x01be/*::]*/: { /* n:\"Dv\", */ },\n\t/*::[*/0x01c0/*::]*/: { /* n:\"Excel9File\", */ f:parsenoop2 },\n\t/*::[*/0x01c1/*::]*/: { /* n:\"RecalcId\", */ f:parse_RecalcId, r:2},\n\t/*::[*/0x01c2/*::]*/: { /* n:\"EntExU2\", */ f:parsenoop2 },\n\t/*::[*/0x0200/*::]*/: { /* n:\"Dimensions\", */ f:parse_Dimensions },\n\t/*::[*/0x0201/*::]*/: { /* n:\"Blank\", */ f:parse_Blank },\n\t/*::[*/0x0203/*::]*/: { /* n:\"Number\", */ f:parse_Number },\n\t/*::[*/0x0204/*::]*/: { /* n:\"Label\", */ f:parse_Label },\n\t/*::[*/0x0205/*::]*/: { /* n:\"BoolErr\", */ f:parse_BoolErr },\n\t/*::[*/0x0207/*::]*/: { /* n:\"String\", */ f:parse_String },\n\t/*::[*/0x0208/*::]*/: { /* n:\"Row\", */ f:parse_Row },\n\t/*::[*/0x020b/*::]*/: { /* n:\"Index\", */ },\n\t/*::[*/0x0221/*::]*/: { /* n:\"Array\", */ f:parse_Array },\n\t/*::[*/0x0225/*::]*/: { /* n:\"DefaultRowHeight\", */ f:parse_DefaultRowHeight },\n\t/*::[*/0x0236/*::]*/: { /* n:\"Table\", */ },\n\t/*::[*/0x023e/*::]*/: { /* n:\"Window2\", */ f:parse_Window2 },\n\t/*::[*/0x027e/*::]*/: { /* n:\"RK\", */ f:parse_RK },\n\t/*::[*/0x0293/*::]*/: { /* n:\"Style\", */ },\n\t/*::[*/0x0418/*::]*/: { /* n:\"BigName\", */ },\n\t/*::[*/0x041e/*::]*/: { /* n:\"Format\", */ f:parse_Format },\n\t/*::[*/0x043c/*::]*/: { /* n:\"ContinueBigName\", */ },\n\t/*::[*/0x04bc/*::]*/: { /* n:\"ShrFmla\", */ f:parse_ShrFmla },\n\t/*::[*/0x0800/*::]*/: { /* n:\"HLinkTooltip\", */ f:parse_HLinkTooltip },\n\t/*::[*/0x0801/*::]*/: { /* n:\"WebPub\", */ },\n\t/*::[*/0x0802/*::]*/: { /* n:\"QsiSXTag\", */ },\n\t/*::[*/0x0803/*::]*/: { /* n:\"DBQueryExt\", */ },\n\t/*::[*/0x0804/*::]*/: { /* n:\"ExtString\", */ },\n\t/*::[*/0x0805/*::]*/: { /* n:\"TxtQry\", */ },\n\t/*::[*/0x0806/*::]*/: { /* n:\"Qsir\", */ },\n\t/*::[*/0x0807/*::]*/: { /* n:\"Qsif\", */ },\n\t/*::[*/0x0808/*::]*/: { /* n:\"RRDTQSIF\", */ },\n\t/*::[*/0x0809/*::]*/: { /* n:\"BOF\", */ f:parse_BOF },\n\t/*::[*/0x080a/*::]*/: { /* n:\"OleDbConn\", */ },\n\t/*::[*/0x080b/*::]*/: { /* n:\"WOpt\", */ },\n\t/*::[*/0x080c/*::]*/: { /* n:\"SXViewEx\", */ },\n\t/*::[*/0x080d/*::]*/: { /* n:\"SXTH\", */ },\n\t/*::[*/0x080e/*::]*/: { /* n:\"SXPIEx\", */ },\n\t/*::[*/0x080f/*::]*/: { /* n:\"SXVDTEx\", */ },\n\t/*::[*/0x0810/*::]*/: { /* n:\"SXViewEx9\", */ },\n\t/*::[*/0x0812/*::]*/: { /* n:\"ContinueFrt\", */ },\n\t/*::[*/0x0813/*::]*/: { /* n:\"RealTimeData\", */ },\n\t/*::[*/0x0850/*::]*/: { /* n:\"ChartFrtInfo\", */ },\n\t/*::[*/0x0851/*::]*/: { /* n:\"FrtWrapper\", */ },\n\t/*::[*/0x0852/*::]*/: { /* n:\"StartBlock\", */ },\n\t/*::[*/0x0853/*::]*/: { /* n:\"EndBlock\", */ },\n\t/*::[*/0x0854/*::]*/: { /* n:\"StartObject\", */ },\n\t/*::[*/0x0855/*::]*/: { /* n:\"EndObject\", */ },\n\t/*::[*/0x0856/*::]*/: { /* n:\"CatLab\", */ },\n\t/*::[*/0x0857/*::]*/: { /* n:\"YMult\", */ },\n\t/*::[*/0x0858/*::]*/: { /* n:\"SXViewLink\", */ },\n\t/*::[*/0x0859/*::]*/: { /* n:\"PivotChartBits\", */ },\n\t/*::[*/0x085a/*::]*/: { /* n:\"FrtFontList\", */ },\n\t/*::[*/0x0862/*::]*/: { /* n:\"SheetExt\", */ },\n\t/*::[*/0x0863/*::]*/: { /* n:\"BookExt\", */ r:12},\n\t/*::[*/0x0864/*::]*/: { /* n:\"SXAddl\", */ },\n\t/*::[*/0x0865/*::]*/: { /* n:\"CrErr\", */ },\n\t/*::[*/0x0866/*::]*/: { /* n:\"HFPicture\", */ },\n\t/*::[*/0x0867/*::]*/: { /* n:\"FeatHdr\", */ f:parsenoop2 },\n\t/*::[*/0x0868/*::]*/: { /* n:\"Feat\", */ },\n\t/*::[*/0x086a/*::]*/: { /* n:\"DataLabExt\", */ },\n\t/*::[*/0x086b/*::]*/: { /* n:\"DataLabExtContents\", */ },\n\t/*::[*/0x086c/*::]*/: { /* n:\"CellWatch\", */ },\n\t/*::[*/0x0871/*::]*/: { /* n:\"FeatHdr11\", */ },\n\t/*::[*/0x0872/*::]*/: { /* n:\"Feature11\", */ },\n\t/*::[*/0x0874/*::]*/: { /* n:\"DropDownObjIds\", */ },\n\t/*::[*/0x0875/*::]*/: { /* n:\"ContinueFrt11\", */ },\n\t/*::[*/0x0876/*::]*/: { /* n:\"DConn\", */ },\n\t/*::[*/0x0877/*::]*/: { /* n:\"List12\", */ },\n\t/*::[*/0x0878/*::]*/: { /* n:\"Feature12\", */ },\n\t/*::[*/0x0879/*::]*/: { /* n:\"CondFmt12\", */ },\n\t/*::[*/0x087a/*::]*/: { /* n:\"CF12\", */ },\n\t/*::[*/0x087b/*::]*/: { /* n:\"CFEx\", */ },\n\t/*::[*/0x087c/*::]*/: { /* n:\"XFCRC\", */ f:parse_XFCRC, r:12 },\n\t/*::[*/0x087d/*::]*/: { /* n:\"XFExt\", */ f:parse_XFExt, r:12 },\n\t/*::[*/0x087e/*::]*/: { /* n:\"AutoFilter12\", */ },\n\t/*::[*/0x087f/*::]*/: { /* n:\"ContinueFrt12\", */ },\n\t/*::[*/0x0884/*::]*/: { /* n:\"MDTInfo\", */ },\n\t/*::[*/0x0885/*::]*/: { /* n:\"MDXStr\", */ },\n\t/*::[*/0x0886/*::]*/: { /* n:\"MDXTuple\", */ },\n\t/*::[*/0x0887/*::]*/: { /* n:\"MDXSet\", */ },\n\t/*::[*/0x0888/*::]*/: { /* n:\"MDXProp\", */ },\n\t/*::[*/0x0889/*::]*/: { /* n:\"MDXKPI\", */ },\n\t/*::[*/0x088a/*::]*/: { /* n:\"MDB\", */ },\n\t/*::[*/0x088b/*::]*/: { /* n:\"PLV\", */ },\n\t/*::[*/0x088c/*::]*/: { /* n:\"Compat12\", */ f:parsebool, r:12 },\n\t/*::[*/0x088d/*::]*/: { /* n:\"DXF\", */ },\n\t/*::[*/0x088e/*::]*/: { /* n:\"TableStyles\", */ r:12 },\n\t/*::[*/0x088f/*::]*/: { /* n:\"TableStyle\", */ },\n\t/*::[*/0x0890/*::]*/: { /* n:\"TableStyleElement\", */ },\n\t/*::[*/0x0892/*::]*/: { /* n:\"StyleExt\", */ },\n\t/*::[*/0x0893/*::]*/: { /* n:\"NamePublish\", */ },\n\t/*::[*/0x0894/*::]*/: { /* n:\"NameCmt\", */ f:parse_NameCmt, r:12 },\n\t/*::[*/0x0895/*::]*/: { /* n:\"SortData\", */ },\n\t/*::[*/0x0896/*::]*/: { /* n:\"Theme\", */ f:parse_Theme, r:12 },\n\t/*::[*/0x0897/*::]*/: { /* n:\"GUIDTypeLib\", */ },\n\t/*::[*/0x0898/*::]*/: { /* n:\"FnGrp12\", */ },\n\t/*::[*/0x0899/*::]*/: { /* n:\"NameFnGrp12\", */ },\n\t/*::[*/0x089a/*::]*/: { /* n:\"MTRSettings\", */ f:parse_MTRSettings, r:12 },\n\t/*::[*/0x089b/*::]*/: { /* n:\"CompressPictures\", */ f:parsenoop2 },\n\t/*::[*/0x089c/*::]*/: { /* n:\"HeaderFooter\", */ },\n\t/*::[*/0x089d/*::]*/: { /* n:\"CrtLayout12\", */ },\n\t/*::[*/0x089e/*::]*/: { /* n:\"CrtMlFrt\", */ },\n\t/*::[*/0x089f/*::]*/: { /* n:\"CrtMlFrtContinue\", */ },\n\t/*::[*/0x08a3/*::]*/: { /* n:\"ForceFullCalculation\", */ f:parse_ForceFullCalculation },\n\t/*::[*/0x08a4/*::]*/: { /* n:\"ShapePropsStream\", */ },\n\t/*::[*/0x08a5/*::]*/: { /* n:\"TextPropsStream\", */ },\n\t/*::[*/0x08a6/*::]*/: { /* n:\"RichTextStream\", */ },\n\t/*::[*/0x08a7/*::]*/: { /* n:\"CrtLayout12A\", */ },\n\t/*::[*/0x1001/*::]*/: { /* n:\"Units\", */ },\n\t/*::[*/0x1002/*::]*/: { /* n:\"Chart\", */ },\n\t/*::[*/0x1003/*::]*/: { /* n:\"Series\", */ },\n\t/*::[*/0x1006/*::]*/: { /* n:\"DataFormat\", */ },\n\t/*::[*/0x1007/*::]*/: { /* n:\"LineFormat\", */ },\n\t/*::[*/0x1009/*::]*/: { /* n:\"MarkerFormat\", */ },\n\t/*::[*/0x100a/*::]*/: { /* n:\"AreaFormat\", */ },\n\t/*::[*/0x100b/*::]*/: { /* n:\"PieFormat\", */ },\n\t/*::[*/0x100c/*::]*/: { /* n:\"AttachedLabel\", */ },\n\t/*::[*/0x100d/*::]*/: { /* n:\"SeriesText\", */ },\n\t/*::[*/0x1014/*::]*/: { /* n:\"ChartFormat\", */ },\n\t/*::[*/0x1015/*::]*/: { /* n:\"Legend\", */ },\n\t/*::[*/0x1016/*::]*/: { /* n:\"SeriesList\", */ },\n\t/*::[*/0x1017/*::]*/: { /* n:\"Bar\", */ },\n\t/*::[*/0x1018/*::]*/: { /* n:\"Line\", */ },\n\t/*::[*/0x1019/*::]*/: { /* n:\"Pie\", */ },\n\t/*::[*/0x101a/*::]*/: { /* n:\"Area\", */ },\n\t/*::[*/0x101b/*::]*/: { /* n:\"Scatter\", */ },\n\t/*::[*/0x101c/*::]*/: { /* n:\"CrtLine\", */ },\n\t/*::[*/0x101d/*::]*/: { /* n:\"Axis\", */ },\n\t/*::[*/0x101e/*::]*/: { /* n:\"Tick\", */ },\n\t/*::[*/0x101f/*::]*/: { /* n:\"ValueRange\", */ },\n\t/*::[*/0x1020/*::]*/: { /* n:\"CatSerRange\", */ },\n\t/*::[*/0x1021/*::]*/: { /* n:\"AxisLine\", */ },\n\t/*::[*/0x1022/*::]*/: { /* n:\"CrtLink\", */ },\n\t/*::[*/0x1024/*::]*/: { /* n:\"DefaultText\", */ },\n\t/*::[*/0x1025/*::]*/: { /* n:\"Text\", */ },\n\t/*::[*/0x1026/*::]*/: { /* n:\"FontX\", */ f:parseuint16 },\n\t/*::[*/0x1027/*::]*/: { /* n:\"ObjectLink\", */ },\n\t/*::[*/0x1032/*::]*/: { /* n:\"Frame\", */ },\n\t/*::[*/0x1033/*::]*/: { /* n:\"Begin\", */ },\n\t/*::[*/0x1034/*::]*/: { /* n:\"End\", */ },\n\t/*::[*/0x1035/*::]*/: { /* n:\"PlotArea\", */ },\n\t/*::[*/0x103a/*::]*/: { /* n:\"Chart3d\", */ },\n\t/*::[*/0x103c/*::]*/: { /* n:\"PicF\", */ },\n\t/*::[*/0x103d/*::]*/: { /* n:\"DropBar\", */ },\n\t/*::[*/0x103e/*::]*/: { /* n:\"Radar\", */ },\n\t/*::[*/0x103f/*::]*/: { /* n:\"Surf\", */ },\n\t/*::[*/0x1040/*::]*/: { /* n:\"RadarArea\", */ },\n\t/*::[*/0x1041/*::]*/: { /* n:\"AxisParent\", */ },\n\t/*::[*/0x1043/*::]*/: { /* n:\"LegendException\", */ },\n\t/*::[*/0x1044/*::]*/: { /* n:\"ShtProps\", */ f:parse_ShtProps },\n\t/*::[*/0x1045/*::]*/: { /* n:\"SerToCrt\", */ },\n\t/*::[*/0x1046/*::]*/: { /* n:\"AxesUsed\", */ },\n\t/*::[*/0x1048/*::]*/: { /* n:\"SBaseRef\", */ },\n\t/*::[*/0x104a/*::]*/: { /* n:\"SerParent\", */ },\n\t/*::[*/0x104b/*::]*/: { /* n:\"SerAuxTrend\", */ },\n\t/*::[*/0x104e/*::]*/: { /* n:\"IFmtRecord\", */ },\n\t/*::[*/0x104f/*::]*/: { /* n:\"Pos\", */ },\n\t/*::[*/0x1050/*::]*/: { /* n:\"AlRuns\", */ },\n\t/*::[*/0x1051/*::]*/: { /* n:\"BRAI\", */ },\n\t/*::[*/0x105b/*::]*/: { /* n:\"SerAuxErrBar\", */ },\n\t/*::[*/0x105c/*::]*/: { /* n:\"ClrtClient\", */ f:parse_ClrtClient },\n\t/*::[*/0x105d/*::]*/: { /* n:\"SerFmt\", */ },\n\t/*::[*/0x105f/*::]*/: { /* n:\"Chart3DBarShape\", */ },\n\t/*::[*/0x1060/*::]*/: { /* n:\"Fbi\", */ },\n\t/*::[*/0x1061/*::]*/: { /* n:\"BopPop\", */ },\n\t/*::[*/0x1062/*::]*/: { /* n:\"AxcExt\", */ },\n\t/*::[*/0x1063/*::]*/: { /* n:\"Dat\", */ },\n\t/*::[*/0x1064/*::]*/: { /* n:\"PlotGrowth\", */ },\n\t/*::[*/0x1065/*::]*/: { /* n:\"SIIndex\", */ },\n\t/*::[*/0x1066/*::]*/: { /* n:\"GelFrame\", */ },\n\t/*::[*/0x1067/*::]*/: { /* n:\"BopPopCustom\", */ },\n\t/*::[*/0x1068/*::]*/: { /* n:\"Fbi2\", */ },\n\n\t/*::[*/0x0000/*::]*/: { /* n:\"Dimensions\", */ f:parse_Dimensions },\n\t/*::[*/0x0001/*::]*/: { /* n:\"BIFF2BLANK\", */ },\n\t/*::[*/0x0002/*::]*/: { /* n:\"BIFF2INT\", */ f:parse_BIFF2INT },\n\t/*::[*/0x0003/*::]*/: { /* n:\"BIFF2NUM\", */ f:parse_BIFF2NUM },\n\t/*::[*/0x0004/*::]*/: { /* n:\"BIFF2STR\", */ f:parse_BIFF2STR },\n\t/*::[*/0x0005/*::]*/: { /* n:\"BoolErr\", */ f:parse_BoolErr },\n\t/*::[*/0x0007/*::]*/: { /* n:\"String\", */ f:parse_BIFF2STRING },\n\t/*::[*/0x0008/*::]*/: { /* n:\"BIFF2ROW\", */ },\n\t/*::[*/0x0009/*::]*/: { /* n:\"BOF\", */ f:parse_BOF },\n\t/*::[*/0x000b/*::]*/: { /* n:\"Index\", */ },\n\t/*::[*/0x0016/*::]*/: { /* n:\"ExternCount\", */ f:parseuint16 },\n\t/*::[*/0x001e/*::]*/: { /* n:\"BIFF2FORMAT\", */ f:parse_BIFF2Format },\n\t/*::[*/0x001f/*::]*/: { /* n:\"BIFF2FMTCNT\", */ }, /* 16-bit cnt of BIFF2FORMAT records */\n\t/*::[*/0x0020/*::]*/: { /* n:\"BIFF2COLINFO\", */ },\n\t/*::[*/0x0021/*::]*/: { /* n:\"Array\", */ f:parse_Array },\n\t/*::[*/0x0024/*::]*/: { /* n:\"COLWIDTH\", */ },\n\t/*::[*/0x0025/*::]*/: { /* n:\"DefaultRowHeight\", */ f:parse_DefaultRowHeight },\n\t// 0x2c ??\n\t// 0x2d ??\n\t// 0x2e ??\n\t// 0x30 FONTCOUNT: number of fonts\n\t/*::[*/0x0032/*::]*/: { /* n:\"BIFF2FONTXTRA\", */ f:parse_BIFF2FONTXTRA },\n\t// 0x35: INFOOPTS\n\t// 0x36: TABLE (BIFF2 only)\n\t// 0x37: TABLE2 (BIFF2 only)\n\t// 0x38: WNDESK\n\t// 0x39 ??\n\t// 0x3a: BEGINPREF\n\t// 0x3b: ENDPREF\n\t/*::[*/0x003e/*::]*/: { /* n:\"BIFF2WINDOW2\", */ },\n\t// 0x3f ??\n\t// 0x46: SHOWSCROLL\n\t// 0x47: SHOWFORMULA\n\t// 0x48: STATUSBAR\n\t// 0x49: SHORTMENUS\n\t// 0x4A:\n\t// 0x4B:\n\t// 0x4C:\n\t// 0x4E:\n\t// 0x4F:\n\t// 0x58: TOOLBAR (BIFF3)\n\n\t/* - - - */\n\t/*::[*/0x0034/*::]*/: { /* n:\"DDEObjName\", */ },\n\t/*::[*/0x0043/*::]*/: { /* n:\"BIFF2XF\", */ },\n\t/*::[*/0x0044/*::]*/: { /* n:\"BIFF2XFINDEX\", */ f:parseuint16 },\n\t/*::[*/0x0045/*::]*/: { /* n:\"BIFF2FONTCLR\", */ },\n\t/*::[*/0x0056/*::]*/: { /* n:\"BIFF4FMTCNT\", */ }, /* 16-bit cnt, similar to BIFF2 */\n\t/*::[*/0x007e/*::]*/: { /* n:\"RK\", */ }, /* Not necessarily same as 0x027e */\n\t/*::[*/0x007f/*::]*/: { /* n:\"ImData\", */ f:parse_ImData },\n\t/*::[*/0x0087/*::]*/: { /* n:\"Addin\", */ },\n\t/*::[*/0x0088/*::]*/: { /* n:\"Edg\", */ },\n\t/*::[*/0x0089/*::]*/: { /* n:\"Pub\", */ },\n\t// 0x8A\n\t// 0x8B LH: alternate menu key flag (BIFF3/4)\n\t// 0x8E\n\t// 0x8F\n\t/*::[*/0x0091/*::]*/: { /* n:\"Sub\", */ },\n\t// 0x93 STYLE\n\t/*::[*/0x0094/*::]*/: { /* n:\"LHRecord\", */ },\n\t/*::[*/0x0095/*::]*/: { /* n:\"LHNGraph\", */ },\n\t/*::[*/0x0096/*::]*/: { /* n:\"Sound\", */ },\n\t// 0xA2 FNPROTO: function prototypes (BIFF4)\n\t// 0xA3\n\t// 0xA8\n\t/*::[*/0x00a9/*::]*/: { /* n:\"CoordList\", */ },\n\t/*::[*/0x00ab/*::]*/: { /* n:\"GCW\", */ },\n\t/*::[*/0x00bc/*::]*/: { /* n:\"ShrFmla\", */ }, /* Not necessarily same as 0x04bc */\n\t/*::[*/0x00bf/*::]*/: { /* n:\"ToolbarHdr\", */ },\n\t/*::[*/0x00c0/*::]*/: { /* n:\"ToolbarEnd\", */ },\n\t/*::[*/0x00c2/*::]*/: { /* n:\"AddMenu\", */ },\n\t/*::[*/0x00c3/*::]*/: { /* n:\"DelMenu\", */ },\n\t/*::[*/0x00d6/*::]*/: { /* n:\"RString\", */ f:parse_RString },\n\t/*::[*/0x00df/*::]*/: { /* n:\"UDDesc\", */ },\n\t/*::[*/0x00ea/*::]*/: { /* n:\"TabIdConf\", */ },\n\t/*::[*/0x0162/*::]*/: { /* n:\"XL5Modify\", */ },\n\t/*::[*/0x01a5/*::]*/: { /* n:\"FileSharing2\", */ },\n\t/*::[*/0x0206/*::]*/: { /* n:\"Formula\", */ f:parse_Formula },\n\t/*::[*/0x0209/*::]*/: { /* n:\"BOF\", */ f:parse_BOF },\n\t/*::[*/0x0218/*::]*/: { /* n:\"Lbl\", */ f:parse_Lbl },\n\t/*::[*/0x0223/*::]*/: { /* n:\"ExternName\", */ f:parse_ExternName },\n\t/*::[*/0x0231/*::]*/: { /* n:\"Font\", */ },\n\t/*::[*/0x0243/*::]*/: { /* n:\"BIFF3XF\", */ },\n\t/*::[*/0x0406/*::]*/: { /* n:\"Formula\", */ f:parse_Formula },\n\t/*::[*/0x0409/*::]*/: { /* n:\"BOF\", */ f:parse_BOF },\n\t/*::[*/0x0443/*::]*/: { /* n:\"BIFF4XF\", */ },\n\t/*::[*/0x086d/*::]*/: { /* n:\"FeatInfo\", */ },\n\t/*::[*/0x0873/*::]*/: { /* n:\"FeatInfo11\", */ },\n\t/*::[*/0x0881/*::]*/: { /* n:\"SXAddl12\", */ },\n\t/*::[*/0x08c0/*::]*/: { /* n:\"AutoWebPub\", */ },\n\t/*::[*/0x08c1/*::]*/: { /* n:\"ListObj\", */ },\n\t/*::[*/0x08c2/*::]*/: { /* n:\"ListField\", */ },\n\t/*::[*/0x08c3/*::]*/: { /* n:\"ListDV\", */ },\n\t/*::[*/0x08c4/*::]*/: { /* n:\"ListCondFmt\", */ },\n\t/*::[*/0x08c5/*::]*/: { /* n:\"ListCF\", */ },\n\t/*::[*/0x08c6/*::]*/: { /* n:\"FMQry\", */ },\n\t/*::[*/0x08c7/*::]*/: { /* n:\"FMSQry\", */ },\n\t/*::[*/0x08c8/*::]*/: { /* n:\"PLV\", */ },\n\t/*::[*/0x08c9/*::]*/: { /* n:\"LnExt\", */ },\n\t/*::[*/0x08ca/*::]*/: { /* n:\"MkrExt\", */ },\n\t/*::[*/0x08cb/*::]*/: { /* n:\"CrtCoopt\", */ },\n\t/*::[*/0x08d6/*::]*/: { /* n:\"FRTArchId$\", */ r:12 },\n\n\t/*::[*/0x7262/*::]*/: {}\n};\n\nfunction write_biff_rec(ba/*:BufArray*/, type/*:number*/, payload, length/*:?number*/)/*:void*/ {\n\tvar t/*:number*/ = type;\n\tif(isNaN(t)) return;\n\tvar len = length || (payload||[]).length || 0;\n\tvar o = ba.next(4);\n\to.write_shift(2, t);\n\to.write_shift(2, len);\n\tif(/*:: len != null &&*/len > 0 && is_buf(payload)) ba.push(payload);\n}\n\nfunction write_biff_continue(ba/*:BufArray*/, type/*:number*/, payload, length/*:?number*/)/*:void*/ {\n\tvar len = length || (payload||[]).length || 0;\n\tif(len <= 8224) return write_biff_rec(ba, type, payload, len);\n\tvar t = type;\n\tif(isNaN(t)) return;\n\tvar parts = payload.parts || [], sidx = 0;\n\tvar i = 0, w = 0;\n\twhile(w + (parts[sidx] || 8224) <= 8224) { w+= (parts[sidx] || 8224); sidx++; }\n\tvar o = ba.next(4);\n\to.write_shift(2, t);\n\to.write_shift(2, w);\n\tba.push(payload.slice(i, i + w));\n\ti += w;\n\twhile(i < len) {\n\t\to = ba.next(4);\n\t\to.write_shift(2, 0x3c); // TODO: figure out correct continue type\n\t\tw = 0;\n\t\twhile(w + (parts[sidx] || 8224) <= 8224) { w+= (parts[sidx] || 8224); sidx++; }\n\t\to.write_shift(2, w);\n\t\tba.push(payload.slice(i, i+w)); i+= w;\n\t}\n}\n\nfunction write_BIFF2Cell(out, r/*:number*/, c/*:number*/) {\n\tif(!out) out = new_buf(7);\n\tout.write_shift(2, r);\n\tout.write_shift(2, c);\n\tout.write_shift(2, 0);\n\tout.write_shift(1, 0);\n\treturn out;\n}\n\nfunction write_BIFF2BERR(r/*:number*/, c/*:number*/, val, t/*:?string*/) {\n\tvar out = new_buf(9);\n\twrite_BIFF2Cell(out, r, c);\n\twrite_Bes(val, t || 'b', out);\n\treturn out;\n}\n\n/* TODO: codepage, large strings */\nfunction write_BIFF2LABEL(r/*:number*/, c/*:number*/, val) {\n\tvar out = new_buf(8 + 2*val.length);\n\twrite_BIFF2Cell(out, r, c);\n\tout.write_shift(1, val.length);\n\tout.write_shift(val.length, val, 'sbcs');\n\treturn out.l < out.length ? out.slice(0, out.l) : out;\n}\n\nfunction write_ws_biff2_cell(ba/*:BufArray*/, cell/*:Cell*/, R/*:number*/, C/*:number*//*::, opts*/) {\n\tif(cell.v != null) switch(cell.t) {\n\t\tcase 'd': case 'n':\n\t\t\tvar v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\n\t\t\tif((v == (v|0)) && (v >= 0) && (v < 65536))\n\t\t\t\twrite_biff_rec(ba, 0x0002, write_BIFF2INT(R, C, v));\n\t\t\telse\n\t\t\t\twrite_biff_rec(ba, 0x0003, write_BIFF2NUM(R,C, v));\n\t\t\treturn;\n\t\tcase 'b': case 'e': write_biff_rec(ba, 0x0005, write_BIFF2BERR(R, C, cell.v, cell.t)); return;\n\t\t/* TODO: codepage, sst */\n\t\tcase 's': case 'str':\n\t\t\twrite_biff_rec(ba, 0x0004, write_BIFF2LABEL(R, C, (cell.v||\"\").slice(0,255)));\n\t\t\treturn;\n\t}\n\twrite_biff_rec(ba, 0x0001, write_BIFF2Cell(null, R, C));\n}\n\nfunction write_ws_biff2(ba/*:BufArray*/, ws/*:Worksheet*/, idx/*:number*/, opts/*::, wb:Workbook*/) {\n\tvar dense = Array.isArray(ws);\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\"), ref/*:string*/, rr = \"\", cols/*:Array<string>*/ = [];\n\tif(range.e.c > 0xFF || range.e.r > 0x3FFF) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n\t\trange.e.c = Math.min(range.e.c, 0xFF);\n\t\trange.e.r = Math.min(range.e.c, 0x3FFF);\n\t\tref = encode_range(range);\n\t}\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\tref = cols[C] + rr;\n\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\tif(!cell) continue;\n\t\t\t/* write cell */\n\t\t\twrite_ws_biff2_cell(ba, cell, R, C, opts);\n\t\t}\n\t}\n}\n\n/* Based on test files */\nfunction write_biff2_buf(wb/*:Workbook*/, opts/*:WriteOpts*/) {\n\tvar o = opts || {};\n\tif(DENSE != null && o.dense == null) o.dense = DENSE;\n\tvar ba = buf_array();\n\tvar idx = 0;\n\tfor(var i=0;i<wb.SheetNames.length;++i) if(wb.SheetNames[i] == o.sheet) idx=i;\n\tif(idx == 0 && !!o.sheet && wb.SheetNames[0] != o.sheet) throw new Error(\"Sheet not found: \" + o.sheet);\n\twrite_biff_rec(ba, (o.biff == 4 ? 0x0409 : (o.biff == 3 ? 0x0209 : 0x0009)), write_BOF(wb, 0x10, o));\n\t/* ... */\n\twrite_ws_biff2(ba, wb.Sheets[wb.SheetNames[idx]], idx, o, wb);\n\t/* ... */\n\twrite_biff_rec(ba, 0x000A);\n\treturn ba.end();\n}\n\nfunction write_FONTS_biff8(ba, data, opts) {\n\twrite_biff_rec(ba, 0x0031 /* Font */, write_Font({\n\t\tsz:12,\n\t\tcolor: {theme:1},\n\t\tname: \"Arial\",\n\t\tfamily: 2,\n\t\tscheme: \"minor\"\n\t}, opts));\n}\n\n\nfunction write_FMTS_biff8(ba, NF/*:?SSFTable*/, opts) {\n\tif(!NF) return;\n\t[[5,8],[23,26],[41,44],[/*63*/50,/*66],[164,*/392]].forEach(function(r) {\n\t\t/*:: if(!NF) return; */\n\t\tfor(var i = r[0]; i <= r[1]; ++i) if(NF[i] != null) write_biff_rec(ba, 0x041E /* Format */, write_Format(i, NF[i], opts));\n\t});\n}\n\nfunction write_FEAT(ba, ws) {\n\t/* [MS-XLS] 2.4.112 */\n\tvar o = new_buf(19);\n\to.write_shift(4, 0x867); o.write_shift(4, 0); o.write_shift(4, 0);\n\to.write_shift(2, 3); o.write_shift(1, 1); o.write_shift(4, 0);\n\twrite_biff_rec(ba, 0x0867 /* FeatHdr */, o);\n\t/* [MS-XLS] 2.4.111 */\n\to = new_buf(39);\n\to.write_shift(4, 0x868); o.write_shift(4, 0); o.write_shift(4, 0);\n\to.write_shift(2, 3); o.write_shift(1, 0); o.write_shift(4, 0);\n\to.write_shift(2, 1); o.write_shift(4, 4); o.write_shift(2, 0);\n\twrite_Ref8U(safe_decode_range(ws['!ref']||\"A1\"), o);\n\to.write_shift(4, 4);\n\twrite_biff_rec(ba, 0x0868 /* Feat */, o);\n}\n\nfunction write_CELLXFS_biff8(ba, opts) {\n\tfor(var i = 0; i < 16; ++i) write_biff_rec(ba, 0x00e0 /* XF */, write_XF({numFmtId:0, style:true}, 0, opts));\n\topts.cellXfs.forEach(function(c) {\n\t\twrite_biff_rec(ba, 0x00e0 /* XF */, write_XF(c, 0, opts));\n\t});\n}\n\nfunction write_ws_biff8_hlinks(ba/*:BufArray*/, ws) {\n\tfor(var R=0; R<ws['!links'].length; ++R) {\n\t\tvar HL = ws['!links'][R];\n\t\twrite_biff_rec(ba, 0x01b8 /* HLink */, write_HLink(HL));\n\t\tif(HL[1].Tooltip) write_biff_rec(ba, 0x0800 /* HLinkTooltip */, write_HLinkTooltip(HL));\n\t}\n\tdelete ws['!links'];\n}\n\nfunction write_ws_cols_biff8(ba, cols) {\n\tif(!cols) return;\n\tvar cnt = 0;\n\tcols.forEach(function(col, idx) {\n\t\tif(++cnt <= 256 && col) {\n\t\t\twrite_biff_rec(ba, 0x007d /* ColInfo */, write_ColInfo(col_obj_w(idx, col), idx));\n\t\t}\n\t});\n}\n\nfunction write_ws_biff8_cell(ba/*:BufArray*/, cell/*:Cell*/, R/*:number*/, C/*:number*/, opts) {\n\tvar os = 16 + get_cell_style(opts.cellXfs, cell, opts);\n\tif(cell.v == null && !cell.bf) {\n\t\twrite_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n\t\treturn;\n\t}\n\tif(cell.bf) write_biff_rec(ba, 0x0006 /* Formula */, write_Formula(cell, R, C, opts, os));\n\telse switch(cell.t) {\n\t\tcase 'd': case 'n':\n\t\t\tvar v = cell.t == 'd' ? datenum(parseDate(cell.v)) : cell.v;\n\t\t\t/* TODO: emit RK as appropriate */\n\t\t\twrite_biff_rec(ba, 0x0203 /* Number */, write_Number(R, C, v, os, opts));\n\t\t\tbreak;\n\t\tcase 'b': case 'e':\n\t\t\twrite_biff_rec(ba, 0x0205 /* BoolErr */, write_BoolErr(R, C, cell.v, os, opts, cell.t));\n\t\t\tbreak;\n\t\t/* TODO: codepage, sst */\n\t\tcase 's': case 'str':\n\t\t\tif(opts.bookSST) {\n\t\t\t\tvar isst = get_sst_id(opts.Strings, cell.v, opts.revStrings);\n\t\t\t\twrite_biff_rec(ba, 0x00fd /* LabelSst */, write_LabelSst(R, C, isst, os, opts));\n\t\t\t} else write_biff_rec(ba, 0x0204 /* Label */, write_Label(R, C, (cell.v||\"\").slice(0,255), os, opts));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\twrite_biff_rec(ba, 0x0201 /* Blank */, write_XLSCell(R, C, os));\n\t}\n}\n\n/* [MS-XLS] 2.1.7.20.5 */\nfunction write_ws_biff8(idx/*:number*/, opts, wb/*:Workbook*/) {\n\tvar ba = buf_array();\n\tvar s = wb.SheetNames[idx], ws = wb.Sheets[s] || {};\n\tvar _WB/*:WBWBProps*/ = ((wb||{}).Workbook||{}/*:any*/);\n\tvar _sheet/*:WBWSProp*/ = ((_WB.Sheets||[])[idx]||{}/*:any*/);\n\tvar dense = Array.isArray(ws);\n\tvar b8 = opts.biff == 8;\n\tvar ref/*:string*/, rr = \"\", cols/*:Array<string>*/ = [];\n\tvar range = safe_decode_range(ws['!ref'] || \"A1\");\n\tvar MAX_ROWS = b8 ? 65536 : 16384;\n\tif(range.e.c > 0xFF || range.e.r >= MAX_ROWS) {\n\t\tif(opts.WTF) throw new Error(\"Range \" + (ws['!ref'] || \"A1\") + \" exceeds format limit A1:IV16384\");\n\t\trange.e.c = Math.min(range.e.c, 0xFF);\n\t\trange.e.r = Math.min(range.e.c, MAX_ROWS-1);\n\t}\n\n\twrite_biff_rec(ba, 0x0809, write_BOF(wb, 0x10, opts));\n\t/* [Uncalced] Index */\n\twrite_biff_rec(ba, 0x000d /* CalcMode */, writeuint16(1));\n\twrite_biff_rec(ba, 0x000c /* CalcCount */, writeuint16(100));\n\twrite_biff_rec(ba, 0x000f /* CalcRefMode */, writebool(true));\n\twrite_biff_rec(ba, 0x0011 /* CalcIter */, writebool(false));\n\twrite_biff_rec(ba, 0x0010 /* CalcDelta */, write_Xnum(0.001));\n\twrite_biff_rec(ba, 0x005f /* CalcSaveRecalc */, writebool(true));\n\twrite_biff_rec(ba, 0x002a /* PrintRowCol */, writebool(false));\n\twrite_biff_rec(ba, 0x002b /* PrintGrid */, writebool(false));\n\twrite_biff_rec(ba, 0x0082 /* GridSet */, writeuint16(1));\n\twrite_biff_rec(ba, 0x0080 /* Guts */, write_Guts([0,0]));\n\t/* DefaultRowHeight WsBool [Sync] [LPr] [HorizontalPageBreaks] [VerticalPageBreaks] */\n\t/* Header (string) */\n\t/* Footer (string) */\n\twrite_biff_rec(ba, 0x0083 /* HCenter */, writebool(false));\n\twrite_biff_rec(ba, 0x0084 /* VCenter */, writebool(false));\n\t/* ... */\n\tif(b8) write_ws_cols_biff8(ba, ws[\"!cols\"]);\n\t/* ... */\n\twrite_biff_rec(ba, 0x200, write_Dimensions(range, opts));\n\t/* ... */\n\n\tif(b8) ws['!links'] = [];\n\tfor(var R = range.s.r; R <= range.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(var C = range.s.c; C <= range.e.c; ++C) {\n\t\t\tif(R === range.s.r) cols[C] = encode_col(C);\n\t\t\tref = cols[C] + rr;\n\t\t\tvar cell = dense ? (ws[R]||[])[C] : ws[ref];\n\t\t\tif(!cell) continue;\n\t\t\t/* write cell */\n\t\t\twrite_ws_biff8_cell(ba, cell, R, C, opts);\n\t\t\tif(b8 && cell.l) ws['!links'].push([ref, cell.l]);\n\t\t}\n\t}\n\tvar cname/*:string*/ = _sheet.CodeName || _sheet.name || s;\n\t/* ... */\n\tif(b8) write_biff_rec(ba, 0x023e /* Window2 */, write_Window2((_WB.Views||[])[0]));\n\t/* ... */\n\tif(b8 && (ws['!merges']||[]).length) write_biff_rec(ba, 0x00e5 /* MergeCells */, write_MergeCells(ws['!merges']));\n\t/* [LRng] *QUERYTABLE [PHONETICINFO] CONDFMTS */\n\tif(b8) write_ws_biff8_hlinks(ba, ws);\n\t/* [DVAL] */\n\twrite_biff_rec(ba, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n\t/* *WebPub *CellWatch [SheetExt] */\n\tif(b8) write_FEAT(ba, ws);\n\t/* *FEAT11 *RECORD12 */\n\twrite_biff_rec(ba, 0x000a /* EOF */);\n\treturn ba.end();\n}\n\n/* [MS-XLS] 2.1.7.20.3 */\nfunction write_biff8_global(wb/*:Workbook*/, bufs, opts/*:WriteOpts*/) {\n\tvar A = buf_array();\n\tvar _WB/*:WBWBProps*/ = ((wb||{}).Workbook||{}/*:any*/);\n\tvar _sheets/*:Array<WBWSProp>*/ = (_WB.Sheets||[]);\n\tvar _wb/*:WBProps*/ = /*::((*/_WB.WBProps||{/*::CodeName:\"ThisWorkbook\"*/}/*:: ):any)*/;\n\tvar b8 = opts.biff == 8, b5 = opts.biff == 5;\n\twrite_biff_rec(A, 0x0809, write_BOF(wb, 0x05, opts));\n\tif(opts.bookType == \"xla\") write_biff_rec(A, 0x0087 /* Addin */);\n\twrite_biff_rec(A, 0x00e1 /* InterfaceHdr */, b8 ? writeuint16(0x04b0) : null);\n\twrite_biff_rec(A, 0x00c1 /* Mms */, writezeroes(2));\n\tif(b5) write_biff_rec(A, 0x00bf /* ToolbarHdr */);\n\tif(b5) write_biff_rec(A, 0x00c0 /* ToolbarEnd */);\n\twrite_biff_rec(A, 0x00e2 /* InterfaceEnd */);\n\twrite_biff_rec(A, 0x005c /* WriteAccess */, write_WriteAccess(\"SheetJS\", opts));\n\t/* [FileSharing] */\n\twrite_biff_rec(A, 0x0042 /* CodePage */, writeuint16(b8 ? 0x04b0 : 0x04E4));\n\t/* *2047 Lel */\n\tif(b8) write_biff_rec(A, 0x0161 /* DSF */, writeuint16(0));\n\tif(b8) write_biff_rec(A, 0x01c0 /* Excel9File */);\n\twrite_biff_rec(A, 0x013d /* RRTabId */, write_RRTabId(wb.SheetNames.length));\n\tif(b8 && wb.vbaraw) write_biff_rec(A, 0x00d3 /* ObProj */);\n\t/* [ObNoMacros] */\n\tif(b8 && wb.vbaraw) {\n\t\tvar cname/*:string*/ = _wb.CodeName || \"ThisWorkbook\";\n\t\twrite_biff_rec(A, 0x01ba /* CodeName */, write_XLUnicodeString(cname, opts));\n\t}\n\twrite_biff_rec(A, 0x009c /* BuiltInFnGroupCount */, writeuint16(0x11));\n\t/* *FnGroupName *FnGrp12 */\n\t/* *Lbl */\n\t/* [OleObjectSize] */\n\twrite_biff_rec(A, 0x0019 /* WinProtect */, writebool(false));\n\twrite_biff_rec(A, 0x0012 /* Protect */, writebool(false));\n\twrite_biff_rec(A, 0x0013 /* Password */, writeuint16(0));\n\tif(b8) write_biff_rec(A, 0x01af /* Prot4Rev */, writebool(false));\n\tif(b8) write_biff_rec(A, 0x01bc /* Prot4RevPass */, writeuint16(0));\n\twrite_biff_rec(A, 0x003d /* Window1 */, write_Window1(opts));\n\twrite_biff_rec(A, 0x0040 /* Backup */, writebool(false));\n\twrite_biff_rec(A, 0x008d /* HideObj */, writeuint16(0));\n\twrite_biff_rec(A, 0x0022 /* Date1904 */, writebool(safe1904(wb)==\"true\"));\n\twrite_biff_rec(A, 0x000e /* CalcPrecision */, writebool(true));\n\tif(b8) write_biff_rec(A, 0x01b7 /* RefreshAll */, writebool(false));\n\twrite_biff_rec(A, 0x00DA /* BookBool */, writeuint16(0));\n\t/* ... */\n\twrite_FONTS_biff8(A, wb, opts);\n\twrite_FMTS_biff8(A, wb.SSF, opts);\n\twrite_CELLXFS_biff8(A, opts);\n\t/* ... */\n\tif(b8) write_biff_rec(A, 0x0160 /* UsesELFs */, writebool(false));\n\tvar a = A.end();\n\n\tvar C = buf_array();\n\t/* METADATA [MTRSettings] [ForceFullCalculation] */\n\tif(b8) write_biff_rec(C, 0x008C, write_Country());\n\t/* *SUPBOOK *LBL *RTD [RecalcId] *HFPicture *MSODRAWINGGROUP */\n\n\t/* BIFF8: [SST *Continue] ExtSST */\n\tif(b8 && opts.Strings) write_biff_continue(C, 0x00FC, write_SST(opts.Strings, opts));\n\n\t/* *WebPub [WOpt] [CrErr] [BookExt] *FeatHdr *DConn [THEME] [CompressPictures] [Compat12] [GUIDTypeLib] */\n\twrite_biff_rec(C, 0x000A /* EOF */);\n\tvar c = C.end();\n\n\tvar B = buf_array();\n\tvar blen = 0, j = 0;\n\tfor(j = 0; j < wb.SheetNames.length; ++j) blen += (b8 ? 12 : 11) + (b8 ? 2 : 1) * wb.SheetNames[j].length;\n\tvar start = a.length + blen + c.length;\n\tfor(j = 0; j < wb.SheetNames.length; ++j) {\n\t\tvar _sheet/*:WBWSProp*/ = _sheets[j] || ({}/*:any*/);\n\t\twrite_biff_rec(B, 0x0085 /* BoundSheet8 */, write_BoundSheet8({pos:start, hs:_sheet.Hidden||0, dt:0, name:wb.SheetNames[j]}, opts));\n\t\tstart += bufs[j].length;\n\t}\n\t/* 1*BoundSheet8 */\n\tvar b = B.end();\n\tif(blen != b.length) throw new Error(\"BS8 \" + blen + \" != \" + b.length);\n\n\tvar out = [];\n\tif(a.length) out.push(a);\n\tif(b.length) out.push(b);\n\tif(c.length) out.push(c);\n\treturn bconcat(out);\n}\n\n/* [MS-XLS] 2.1.7.20 Workbook Stream */\nfunction write_biff8_buf(wb/*:Workbook*/, opts/*:WriteOpts*/) {\n\tvar o = opts || {};\n\tvar bufs = [];\n\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\to.revssf = evert_num(wb.SSF); o.revssf[wb.SSF[65535]] = 0;\n\t\to.ssf = wb.SSF;\n\t}\n\n\to.Strings = /*::((*/[]/*:: :any):SST)*/; o.Strings.Count = 0; o.Strings.Unique = 0;\n\tfix_write_opts(o);\n\n\to.cellXfs = [];\n\tget_cell_style(o.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tfor(var i = 0; i < wb.SheetNames.length; ++i) bufs[bufs.length] = write_ws_biff8(i, o, wb);\n\tbufs.unshift(write_biff8_global(wb, bufs, o));\n\treturn bconcat(bufs);\n}\n\nfunction write_biff_buf(wb/*:Workbook*/, opts/*:WriteOpts*/) {\n\tfor(var i = 0; i <= wb.SheetNames.length; ++i) {\n\t\tvar ws = wb.Sheets[wb.SheetNames[i]];\n\t\tif(!ws || !ws[\"!ref\"]) continue;\n\t\tvar range = decode_range(ws[\"!ref\"]);\n\t\tif(range.e.c > 255) { // note: 255 is IV\n\t\tif(typeof console != \"undefined\" && console.error) console.error(\"Worksheet '\" + wb.SheetNames[i] + \"' extends beyond column IV (255).  Data may be lost.\");\n\t\t}\n\t}\n\n\tvar o = opts || {};\n\tswitch(o.biff || 2) {\n\t\tcase 8: case 5: return write_biff8_buf(wb, opts);\n\t\tcase 4: case 3: case 2: return write_biff2_buf(wb, opts);\n\t}\n\tthrow new Error(\"invalid type \" + o.bookType + \" for BIFF\");\n}\n/* note: browser DOM element cannot see mso- style attrs, must parse */\nfunction html_to_sheet(str/*:string*/, _opts)/*:Workbook*/ {\n\tvar opts = _opts || {};\n\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\tvar ws/*:Worksheet*/ = opts.dense ? ([]/*:any*/) : ({}/*:any*/);\n\tstr = str.replace(/<!--.*?-->/g, \"\");\n\tvar mtch/*:any*/ = str.match(/<table/i);\n\tif(!mtch) throw new Error(\"Invalid HTML: could not find <table>\");\n\tvar mtch2/*:any*/ = str.match(/<\\/table/i);\n\tvar i/*:number*/ = mtch.index, j/*:number*/ = mtch2 && mtch2.index || str.length;\n\tvar rows = split_regex(str.slice(i, j), /(:?<tr[^>]*>)/i, \"<tr>\");\n\tvar R = -1, C = 0, RS = 0, CS = 0;\n\tvar range/*:Range*/ = {s:{r:10000000, c:10000000},e:{r:0,c:0}};\n\tvar merges/*:Array<Range>*/ = [];\n\tfor(i = 0; i < rows.length; ++i) {\n\t\tvar row = rows[i].trim();\n\t\tvar hd = row.slice(0,3).toLowerCase();\n\t\tif(hd == \"<tr\") { ++R; if(opts.sheetRows && opts.sheetRows <= R) { --R; break; } C = 0; continue; }\n\t\tif(hd != \"<td\" && hd != \"<th\") continue;\n\t\tvar cells = row.split(/<\\/t[dh]>/i);\n\t\tfor(j = 0; j < cells.length; ++j) {\n\t\t\tvar cell = cells[j].trim();\n\t\t\tif(!cell.match(/<t[dh]/i)) continue;\n\t\t\tvar m = cell, cc = 0;\n\t\t\t/* TODO: parse styles etc */\n\t\t\twhile(m.charAt(0) == \"<\" && (cc = m.indexOf(\">\")) > -1) m = m.slice(cc+1);\n\t\t\tfor(var midx = 0; midx < merges.length; ++midx) {\n\t\t\t\tvar _merge/*:Range*/ = merges[midx];\n\t\t\t\tif(_merge.s.c == C && _merge.s.r < R && R <= _merge.e.r) { C = _merge.e.c + 1; midx = -1; }\n\t\t\t}\n\t\t\tvar tag = parsexmltag(cell.slice(0, cell.indexOf(\">\")));\n\t\t\tCS = tag.colspan ? +tag.colspan : 1;\n\t\t\tif((RS = +tag.rowspan)>1 || CS>1) merges.push({s:{r:R,c:C},e:{r:R + (RS||1) - 1, c:C + CS - 1}});\n\t\t\tvar _t/*:string*/ = tag.t || tag[\"data-t\"] || \"\";\n\t\t\t/* TODO: generate stub cells */\n\t\t\tif(!m.length) { C += CS; continue; }\n\t\t\tm = htmldecode(m);\n\t\t\tif(range.s.r > R) range.s.r = R; if(range.e.r < R) range.e.r = R;\n\t\t\tif(range.s.c > C) range.s.c = C; if(range.e.c < C) range.e.c = C;\n\t\t\tif(!m.length) { C += CS; continue; }\n\t\t\tvar o/*:Cell*/ = {t:'s', v:m};\n\t\t\tif(opts.raw || !m.trim().length || _t == 's'){}\n\t\t\telse if(m === 'TRUE') o = {t:'b', v:true};\n\t\t\telse if(m === 'FALSE') o = {t:'b', v:false};\n\t\t\telse if(!isNaN(fuzzynum(m))) o = {t:'n', v:fuzzynum(m)};\n\t\t\telse if(!isNaN(fuzzydate(m).getDate())) {\n\t\t\t\to = ({t:'d', v:parseDate(m)}/*:any*/);\n\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)}/*:any*/);\n\t\t\t\to.z = opts.dateNF || table_fmt[14];\n\t\t\t}\n\t\t\tif(opts.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = o; }\n\t\t\telse ws[encode_cell({r:R, c:C})] = o;\n\t\t\tC += CS;\n\t\t}\n\t}\n\tws['!ref'] = encode_range(range);\n\tif(merges.length) ws[\"!merges\"] = merges;\n\treturn ws;\n}\nfunction make_html_row(ws/*:Worksheet*/, r/*:Range*/, R/*:number*/, o/*:Sheet2HTMLOpts*/)/*:string*/ {\n\tvar M/*:Array<Range>*/ = (ws['!merges'] ||[]);\n\tvar oo/*:Array<string>*/ = [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\tvar RS = 0, CS = 0;\n\t\tfor(var j = 0; j < M.length; ++j) {\n\t\t\tif(M[j].s.r > R || M[j].s.c > C) continue;\n\t\t\tif(M[j].e.r < R || M[j].e.c < C) continue;\n\t\t\tif(M[j].s.r < R || M[j].s.c < C) { RS = -1; break; }\n\t\t\tRS = M[j].e.r - M[j].s.r + 1; CS = M[j].e.c - M[j].s.c + 1; break;\n\t\t}\n\t\tif(RS < 0) continue;\n\t\tvar coord = encode_cell({r:R,c:C});\n\t\tvar cell = o.dense ? (ws[R]||[])[C] : ws[coord];\n\t\t/* TODO: html entities */\n\t\tvar w = (cell && cell.v != null) && (cell.h || escapehtml(cell.w || (format_cell(cell), cell.w) || \"\")) || \"\";\n\t\tvar sp = ({}/*:any*/);\n\t\tif(RS > 1) sp.rowspan = RS;\n\t\tif(CS > 1) sp.colspan = CS;\n\t\tif(o.editable) w = '<span contenteditable=\"true\">' + w + '</span>';\n\t\telse if(cell) {\n\t\t\tsp[\"data-t\"] = cell && cell.t || 'z';\n\t\t\tif(cell.v != null) sp[\"data-v\"] = cell.v;\n\t\t\tif(cell.z != null) sp[\"data-z\"] = cell.z;\n\t\t\tif(cell.l && (cell.l.Target || \"#\").charAt(0) != \"#\") w = '<a href=\"' + cell.l.Target +'\">' + w + '</a>';\n\t\t}\n\t\tsp.id = (o.id || \"sjs\") + \"-\" + coord;\n\t\too.push(writextag('td', w, sp));\n\t}\n\tvar preamble = \"<tr>\";\n\treturn preamble + oo.join(\"\") + \"</tr>\";\n}\n\nvar HTML_BEGIN = '<html><head><meta charset=\"utf-8\"/><title>SheetJS Table Export</title></head><body>';\nvar HTML_END = '</body></html>';\n\nfunction html_to_workbook(str/*:string*/, opts)/*:Workbook*/ {\n\tvar mtch = str.match(/<table[\\s\\S]*?>[\\s\\S]*?<\\/table>/gi);\n\tif(!mtch || mtch.length == 0) throw new Error(\"Invalid HTML: could not find <table>\");\n\tif(mtch.length == 1) return sheet_to_workbook(html_to_sheet(mtch[0], opts), opts);\n\tvar wb = book_new();\n\tmtch.forEach(function(s, idx) { book_append_sheet(wb, html_to_sheet(s, opts), \"Sheet\" + (idx+1)); });\n\treturn wb;\n}\n\nfunction make_html_preamble(ws/*:Worksheet*/, R/*:Range*/, o/*:Sheet2HTMLOpts*/)/*:string*/ {\n\tvar out/*:Array<string>*/ = [];\n\treturn out.join(\"\") + '<table' + (o && o.id ? ' id=\"' + o.id + '\"' : \"\") + '>';\n}\n\nfunction sheet_to_html(ws/*:Worksheet*/, opts/*:?Sheet2HTMLOpts*//*, wb:?Workbook*/)/*:string*/ {\n\tvar o = opts || {};\n\tvar header = o.header != null ? o.header : HTML_BEGIN;\n\tvar footer = o.footer != null ? o.footer : HTML_END;\n\tvar out/*:Array<string>*/ = [header];\n\tvar r = decode_range(ws['!ref']);\n\to.dense = Array.isArray(ws);\n\tout.push(make_html_preamble(ws, r, o));\n\tfor(var R = r.s.r; R <= r.e.r; ++R) out.push(make_html_row(ws, r, R, o));\n\tout.push(\"</table>\" + footer);\n\treturn out.join(\"\");\n}\n\nfunction sheet_add_dom(ws/*:Worksheet*/, table/*:HTMLElement*/, _opts/*:?any*/)/*:Worksheet*/ {\n\tvar opts = _opts || {};\n\tif(DENSE != null) opts.dense = DENSE;\n\tvar or_R = 0, or_C = 0;\n\tif(opts.origin != null) {\n\t\tif(typeof opts.origin == 'number') or_R = opts.origin;\n\t\telse {\n\t\t\tvar _origin/*:CellAddress*/ = typeof opts.origin == \"string\" ? decode_cell(opts.origin) : opts.origin;\n\t\t\tor_R = _origin.r; or_C = _origin.c;\n\t\t}\n\t}\n\n\tvar rows/*:HTMLCollection<HTMLTableRowElement>*/ = table.getElementsByTagName('tr');\n\tvar sheetRows = Math.min(opts.sheetRows||10000000, rows.length);\n\tvar range/*:Range*/ = {s:{r:0,c:0},e:{r:or_R,c:or_C}};\n\tif(ws[\"!ref\"]) {\n\t\tvar _range/*:Range*/ = decode_range(ws[\"!ref\"]);\n\t\trange.s.r = Math.min(range.s.r, _range.s.r);\n\t\trange.s.c = Math.min(range.s.c, _range.s.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\tif(or_R == -1) range.e.r = or_R = _range.e.r + 1;\n\t}\n\tvar merges/*:Array<Range>*/ = [], midx = 0;\n\tvar rowinfo/*:Array<RowInfo>*/ = ws[\"!rows\"] || (ws[\"!rows\"] = []);\n\tvar _R = 0, R = 0, _C = 0, C = 0, RS = 0, CS = 0;\n\tif(!ws[\"!cols\"]) ws['!cols'] = [];\n\tfor(; _R < rows.length && R < sheetRows; ++_R) {\n\t\tvar row/*:HTMLTableRowElement*/ = rows[_R];\n\t\tif (is_dom_element_hidden(row)) {\n\t\t\tif (opts.display) continue;\n\t\t\trowinfo[R] = {hidden: true};\n\t\t}\n\t\tvar elts/*:HTMLCollection<HTMLTableCellElement>*/ = (row.children/*:any*/);\n\t\tfor(_C = C = 0; _C < elts.length; ++_C) {\n\t\t\tvar elt/*:HTMLTableCellElement*/ = elts[_C];\n\t\t\tif (opts.display && is_dom_element_hidden(elt)) continue;\n\t\t\tvar v/*:?string*/ = elt.hasAttribute('data-v') ? elt.getAttribute('data-v') : elt.hasAttribute('v') ? elt.getAttribute('v') : htmldecode(elt.innerHTML);\n\t\t\tvar z/*:?string*/ = elt.getAttribute('data-z') || elt.getAttribute('z');\n\t\t\tfor(midx = 0; midx < merges.length; ++midx) {\n\t\t\t\tvar m/*:Range*/ = merges[midx];\n\t\t\t\tif(m.s.c == C + or_C && m.s.r < R + or_R && R + or_R <= m.e.r) { C = m.e.c+1 - or_C; midx = -1; }\n\t\t\t}\n\t\t\t/* TODO: figure out how to extract nonstandard mso- style */\n\t\t\tCS = +elt.getAttribute(\"colspan\") || 1;\n\t\t\tif( ((RS = (+elt.getAttribute(\"rowspan\") || 1)))>1 || CS>1) merges.push({s:{r:R + or_R,c:C + or_C},e:{r:R + or_R + (RS||1) - 1, c:C + or_C + (CS||1) - 1}});\n\t\t\tvar o/*:Cell*/ = {t:'s', v:v};\n\t\t\tvar _t/*:string*/ = elt.getAttribute(\"data-t\") || elt.getAttribute(\"t\") || \"\";\n\t\t\tif(v != null) {\n\t\t\t\tif(v.length == 0) o.t = _t || 'z';\n\t\t\t\telse if(opts.raw || v.trim().length == 0 || _t == \"s\"){}\n\t\t\t\telse if(v === 'TRUE') o = {t:'b', v:true};\n\t\t\t\telse if(v === 'FALSE') o = {t:'b', v:false};\n\t\t\t\telse if(!isNaN(fuzzynum(v))) o = {t:'n', v:fuzzynum(v)};\n\t\t\t\telse if(!isNaN(fuzzydate(v).getDate())) {\n\t\t\t\t\to = ({t:'d', v:parseDate(v)}/*:any*/);\n\t\t\t\t\tif(!opts.cellDates) o = ({t:'n', v:datenum(o.v)}/*:any*/);\n\t\t\t\t\to.z = opts.dateNF || table_fmt[14];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(o.z === undefined && z != null) o.z = z;\n\t\t\t/* The first link is used.  Links are assumed to be fully specified.\n\t\t\t * TODO: The right way to process relative links is to make a new <a> */\n\t\t\tvar l = \"\", Aelts = elt.getElementsByTagName(\"A\");\n\t\t\tif(Aelts && Aelts.length) for(var Aelti = 0; Aelti < Aelts.length; ++Aelti)\tif(Aelts[Aelti].hasAttribute(\"href\")) {\n\t\t\t\tl = Aelts[Aelti].getAttribute(\"href\"); if(l.charAt(0) != \"#\") break;\n\t\t\t}\n\t\t\tif(l && l.charAt(0) != \"#\") o.l = ({ Target: l });\n\t\t\tif(opts.dense) { if(!ws[R + or_R]) ws[R + or_R] = []; ws[R + or_R][C + or_C] = o; }\n\t\t\telse ws[encode_cell({c:C + or_C, r:R + or_R})] = o;\n\t\t\tif(range.e.c < C + or_C) range.e.c = C + or_C;\n\t\t\tC += CS;\n\t\t}\n\t\t++R;\n\t}\n\tif(merges.length) ws['!merges'] = (ws[\"!merges\"] || []).concat(merges);\n\trange.e.r = Math.max(range.e.r, R - 1 + or_R);\n\tws['!ref'] = encode_range(range);\n\tif(R >= sheetRows) ws['!fullref'] = encode_range((range.e.r = rows.length-_R+R-1 + or_R,range)); // We can count the real number of rows to parse but we don't to improve the performance\n\treturn ws;\n}\n\nfunction parse_dom_table(table/*:HTMLElement*/, _opts/*:?any*/)/*:Worksheet*/ {\n\tvar opts = _opts || {};\n\tvar ws/*:Worksheet*/ = opts.dense ? ([]/*:any*/) : ({}/*:any*/);\n\treturn sheet_add_dom(ws, table, _opts);\n}\n\nfunction table_to_book(table/*:HTMLElement*/, opts/*:?any*/)/*:Workbook*/ {\n\treturn sheet_to_workbook(parse_dom_table(table, opts), opts);\n}\n\nfunction is_dom_element_hidden(element/*:HTMLElement*/)/*:boolean*/ {\n\tvar display/*:string*/ = '';\n\tvar get_computed_style/*:?function*/ = get_get_computed_style_function(element);\n\tif(get_computed_style) display = get_computed_style(element).getPropertyValue('display');\n\tif(!display) display = element.style && element.style.display;\n\treturn display === 'none';\n}\n\n/* global getComputedStyle */\nfunction get_get_computed_style_function(element/*:HTMLElement*/)/*:?function*/ {\n\t// The proper getComputedStyle implementation is the one defined in the element window\n\tif(element.ownerDocument.defaultView && typeof element.ownerDocument.defaultView.getComputedStyle === 'function') return element.ownerDocument.defaultView.getComputedStyle;\n\t// If it is not available, try to get one from the global namespace\n\tif(typeof getComputedStyle === 'function') return getComputedStyle;\n\treturn null;\n}\n/* OpenDocument */\nfunction parse_text_p(text/*:string*//*::, tag*/)/*:Array<any>*/ {\n\t/* 6.1.2 White Space Characters */\n\tvar fixed = text\n\t\t.replace(/[\\t\\r\\n]/g, \" \").trim().replace(/ +/g, \" \")\n\t\t.replace(/<text:s\\/>/g,\" \")\n\t\t.replace(/<text:s text:c=\"(\\d+)\"\\/>/g, function($$,$1) { return Array(parseInt($1,10)+1).join(\" \"); })\n\t\t.replace(/<text:tab[^>]*\\/>/g,\"\\t\")\n\t\t.replace(/<text:line-break\\/>/g,\"\\n\");\n\tvar v = unescapexml(fixed.replace(/<[^>]*>/g,\"\"));\n\n\treturn [v];\n}\n\nvar number_formats_ods = {\n\t/* ods name: [short ssf fmt, long ssf fmt] */\n\tday:           [\"d\",   \"dd\"],\n\tmonth:         [\"m\",   \"mm\"],\n\tyear:          [\"y\",   \"yy\"],\n\thours:         [\"h\",   \"hh\"],\n\tminutes:       [\"m\",   \"mm\"],\n\tseconds:       [\"s\",   \"ss\"],\n\t\"am-pm\":       [\"A/P\", \"AM/PM\"],\n\t\"day-of-week\": [\"ddd\", \"dddd\"],\n\tera:           [\"e\",   \"ee\"],\n\t/* there is no native representation of LO \"Q\" format */\n\tquarter:       [\"\\\\Qm\", \"m\\\\\\\"th quarter\\\"\"]\n};\n\n\nfunction parse_content_xml(d/*:string*/, _opts)/*:Workbook*/ {\n\t\tvar opts = _opts || {};\n\t\tif(DENSE != null && opts.dense == null) opts.dense = DENSE;\n\t\tvar str = xlml_normalize(d);\n\t\tvar state/*:Array<any>*/ = [], tmp;\n\t\tvar tag/*:: = {}*/;\n\t\tvar NFtag = {name:\"\"}, NF = \"\", pidx = 0;\n\t\tvar sheetag/*:: = {name:\"\", '':\"\"}*/;\n\t\tvar rowtag/*:: = {'':\"\"}*/;\n\t\tvar Sheets = {}, SheetNames/*:Array<string>*/ = [];\n\t\tvar ws = opts.dense ? ([]/*:any*/) : ({}/*:any*/);\n\t\tvar Rn, q/*:: :any = ({t:\"\", v:null, z:null, w:\"\",c:[],}:any)*/;\n\t\tvar ctag = ({value:\"\"}/*:any*/);\n\t\tvar textp = \"\", textpidx = 0, textptag/*:: = {}*/;\n\t\tvar textR = [];\n\t\tvar R = -1, C = -1, range = {s: {r:1000000,c:10000000}, e: {r:0, c:0}};\n\t\tvar row_ol = 0;\n\t\tvar number_format_map = {};\n\t\tvar merges/*:Array<Range>*/ = [], mrange = {}, mR = 0, mC = 0;\n\t\tvar rowinfo/*:Array<RowInfo>*/ = [], rowpeat = 1, colpeat = 1;\n\t\tvar arrayf/*:Array<[Range, string]>*/ = [];\n\t\tvar WB = {Names:[]};\n\t\tvar atag = ({}/*:any*/);\n\t\tvar _Ref/*:[string, string]*/ = [\"\", \"\"];\n\t\tvar comments/*:Array<Comment>*/ = [], comment/*:Comment*/ = ({}/*:any*/);\n\t\tvar creator = \"\", creatoridx = 0;\n\t\tvar isstub = false, intable = false;\n\t\tvar i = 0;\n\t\txlmlregex.lastIndex = 0;\n\t\tstr = str.replace(/<!--([\\s\\S]*?)-->/mg,\"\").replace(/<!DOCTYPE[^\\[]*\\[[^\\]]*\\]>/gm,\"\");\n\t\twhile((Rn = xlmlregex.exec(str))) switch((Rn[3]=Rn[3].replace(/_.*$/,\"\"))) {\n\n\t\t\tcase 'table': case '': // 9.1.2 <table:table>\n\t\t\t\tif(Rn[1]==='/') {\n\t\t\t\t\tif(range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = encode_range(range);\n\t\t\t\t\telse ws['!ref'] = \"A1:A1\";\n\t\t\t\t\tif(opts.sheetRows > 0 && opts.sheetRows <= range.e.r) {\n\t\t\t\t\t\tws['!fullref'] = ws['!ref'];\n\t\t\t\t\t\trange.e.r = opts.sheetRows - 1;\n\t\t\t\t\t\tws['!ref'] = encode_range(range);\n\t\t\t\t\t}\n\t\t\t\t\tif(merges.length) ws['!merges'] = merges;\n\t\t\t\t\tif(rowinfo.length) ws[\"!rows\"] = rowinfo;\n\t\t\t\t\tsheetag.name = sheetag[''] || sheetag.name;\n\t\t\t\t\tif(typeof JSON !== 'undefined') JSON.stringify(sheetag);\n\t\t\t\t\tSheetNames.push(sheetag.name);\n\t\t\t\t\tSheets[sheetag.name] = ws;\n\t\t\t\t\tintable = false;\n\t\t\t\t}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tsheetag = parsexmltag(Rn[0], false);\n\t\t\t\t\tR = C = -1;\n\t\t\t\t\trange.s.r = range.s.c = 10000000; range.e.r = range.e.c = 0;\n\t\t\t\t\tws = opts.dense ? ([]/*:any*/) : ({}/*:any*/); merges = [];\n\t\t\t\t\trowinfo = [];\n\t\t\t\t\tintable = true;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'table-row-group': // 9.1.9 <table:table-row-group>\n\t\t\t\tif(Rn[1] === \"/\") --row_ol; else ++row_ol;\n\t\t\t\tbreak;\n\t\t\tcase 'table-row': case '': // 9.1.3 <table:table-row>\n\t\t\t\tif(Rn[1] === '/') { R+=rowpeat; rowpeat = 1; break; }\n\t\t\t\trowtag = parsexmltag(Rn[0], false);\n\t\t\t\tif(rowtag['']) R = rowtag[''] - 1; else if(R == -1) R = 0;\n\t\t\t\trowpeat = +rowtag['number-rows-repeated'] || 1;\n\t\t\t\t/* TODO: remove magic */\n\t\t\t\tif(rowpeat < 10) for(i = 0; i < rowpeat; ++i) if(row_ol > 0) rowinfo[R + i] = {level: row_ol};\n\t\t\t\tC = -1; break;\n\t\t\tcase 'covered-table-cell': // 9.1.5 <table:covered-table-cell>\n\t\t\t\tif(Rn[1] !== '/') ++C;\n\t\t\t\tif(opts.sheetStubs) {\n\t\t\t\t\tif(opts.dense) { if(!ws[R]) ws[R] = []; ws[R][C] = {t:'z'}; }\n\t\t\t\t\telse ws[encode_cell({r:R,c:C})] = {t:'z'};\n\t\t\t\t}\n\t\t\t\ttextp = \"\"; textR = [];\n\t\t\t\tbreak; /* stub */\n\t\t\tcase 'table-cell': case '':\n\t\t\t\tif(Rn[0].charAt(Rn[0].length-2) === '/') {\n\t\t\t\t\t++C;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\tq = ({t:'z', v:null/*:: , z:null, w:\"\",c:[]*/}/*:any*/);\n\t\t\t\t\tif(ctag.formula && opts.cellFormula != false) q.f = ods_to_csf_formula(unescapexml(ctag.formula));\n\t\t\t\t\tif((ctag[''] || ctag['value-type']) == \"string\") {\n\t\t\t\t\t\tq.t = \"s\"; q.v = unescapexml(ctag['string-value'] || \"\");\n\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\tif(!ws[R]) ws[R] = [];\n\t\t\t\t\t\t\tws[R][C] = q;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tws[encode_cell({r:R,c:C})] = q;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tC+= colpeat-1;\n\t\t\t\t} else if(Rn[1]!=='/') {\n\t\t\t\t\t++C;\n\t\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\t\tcolpeat = 1;\n\t\t\t\t\tvar rptR = rowpeat ? R + rowpeat - 1 : R;\n\t\t\t\t\tif(C > range.e.c) range.e.c = C;\n\t\t\t\t\tif(C < range.s.c) range.s.c = C;\n\t\t\t\t\tif(R < range.s.r) range.s.r = R;\n\t\t\t\t\tif(rptR > range.e.r) range.e.r = rptR;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tcomments = []; comment = ({}/*:any*/);\n\t\t\t\t\tq = ({t:ctag[''] || ctag['value-type'], v:null/*:: , z:null, w:\"\",c:[]*/}/*:any*/);\n\t\t\t\t\tif(opts.cellFormula) {\n\t\t\t\t\t\tif(ctag.formula) ctag.formula = unescapexml(ctag.formula);\n\t\t\t\t\t\tif(ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\n\t\t\t\t\t\t\tmR = parseInt(ctag['number-matrix-rows-spanned'],10) || 0;\n\t\t\t\t\t\t\tmC = parseInt(ctag['number-matrix-columns-spanned'],10) || 0;\n\t\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\t\tq.F = encode_range(mrange);\n\t\t\t\t\t\t\tarrayf.push([mrange, q.F]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ctag.formula) q.f = ods_to_csf_formula(ctag.formula);\n\t\t\t\t\t\telse for(i = 0; i < arrayf.length; ++i)\n\t\t\t\t\t\t\tif(R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r)\n\t\t\t\t\t\t\t\tif(C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c)\n\t\t\t\t\t\t\t\t\tq.F = arrayf[i][1];\n\t\t\t\t\t}\n\t\t\t\t\tif(ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\n\t\t\t\t\t\tmR = parseInt(ctag['number-rows-spanned'],10) || 0;\n\t\t\t\t\t\tmC = parseInt(ctag['number-columns-spanned'],10) || 0;\n\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\tmerges.push(mrange);\n\t\t\t\t\t}\n\n\t\t\t\t\t/* 19.675.2 table:number-columns-repeated */\n\t\t\t\t\tif(ctag['number-columns-repeated']) colpeat = parseInt(ctag['number-columns-repeated'], 10);\n\n\t\t\t\t\t/* 19.385 office:value-type */\n\t\t\t\t\tswitch(q.t) {\n\t\t\t\t\t\tcase 'boolean': q.t = 'b'; q.v = parsexmlbool(ctag['boolean-value']); break;\n\t\t\t\t\t\tcase 'float': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'percentage': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'currency': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'date': q.t = 'd'; q.v = parseDate(ctag['date-value']);\n\t\t\t\t\t\t\tif(!opts.cellDates) { q.t = 'n'; q.v = datenum(q.v); }\n\t\t\t\t\t\t\tq.z = 'm/d/yy'; break;\n\t\t\t\t\t\tcase 'time': q.t = 'n'; q.v = parse_isodur(ctag['time-value'])/86400;\n\t\t\t\t\t\t\tif(opts.cellDates) { q.t = 'd'; q.v = numdate(q.v); }\n\t\t\t\t\t\t\tq.z = 'HH:MM:SS'; break;\n\t\t\t\t\t\tcase 'number': q.t = 'n'; q.v = parseFloat(ctag['']); break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif(q.t === 'string' || q.t === 'text' || !q.t) {\n\t\t\t\t\t\t\t\tq.t = 's';\n\t\t\t\t\t\t\t\tif(ctag['string-value'] != null) { textp = unescapexml(ctag['string-value']); textR = []; }\n\t\t\t\t\t\t\t} else throw new Error('Unsupported value type ' + q.t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tisstub = false;\n\t\t\t\t\tif(q.t === 's') {\n\t\t\t\t\t\tq.v = textp || '';\n\t\t\t\t\t\tif(textR.length) q.R = textR;\n\t\t\t\t\t\tisstub = textpidx == 0;\n\t\t\t\t\t}\n\t\t\t\t\tif(atag.Target) q.l = atag;\n\t\t\t\t\tif(comments.length > 0) { q.c = comments; comments = []; }\n\t\t\t\t\tif(textp && opts.cellText !== false) q.w = textp;\n\t\t\t\t\tif(isstub) { q.t = \"z\"; delete q.v; }\n\t\t\t\t\tif(!isstub || opts.sheetStubs) {\n\t\t\t\t\t\tif(!(opts.sheetRows && opts.sheetRows <= R)) {\n\t\t\t\t\t\t\tfor(var rpt = 0; rpt < rowpeat; ++rpt) {\n\t\t\t\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\t\t\t\tif(opts.dense) {\n\t\t\t\t\t\t\t\t\tif(!ws[R + rpt]) ws[R + rpt] = [];\n\t\t\t\t\t\t\t\t\tws[R + rpt][C] = rpt == 0 ? q : dup(q);\n\t\t\t\t\t\t\t\t\twhile(--colpeat > 0) ws[R + rpt][C + colpeat] = dup(q);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tws[encode_cell({r:R + rpt,c:C})] = q;\n\t\t\t\t\t\t\t\t\twhile(--colpeat > 0) ws[encode_cell({r:R + rpt,c:C + colpeat})] = dup(q);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(range.e.c <= C) range.e.c = C;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcolpeat = parseInt(ctag['number-columns-repeated']||\"1\", 10);\n\t\t\t\t\tC += colpeat-1; colpeat = 0;\n\t\t\t\t\tq = {/*:: t:\"\", v:null, z:null, w:\"\",c:[]*/};\n\t\t\t\t\ttextp = \"\"; textR = [];\n\t\t\t\t}\n\t\t\t\tatag = ({}/*:any*/);\n\t\t\t\tbreak; // 9.1.4 <table:table-cell>\n\n\t\t\t/* pure state */\n\t\t\tcase 'document': // TODO: <office:document> is the root for FODS\n\t\t\tcase 'document-content': case '': // 3.1.3.2 <office:document-content>\n\t\t\tcase 'spreadsheet': case '': // 3.7 <office:spreadsheet>\n\t\t\tcase 'scripts': // 3.12 <office:scripts>\n\t\t\tcase 'styles': // TODO <office:styles>\n\t\t\tcase 'font-face-decls': // 3.14 <office:font-face-decls>\n\t\t\tcase 'master-styles': // 3.15.4 <office:master-styles> -- relevant for FODS\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t\tbreak;\n\n\t\t\tcase 'annotation': // 14.1 <office:annotation>\n\t\t\t\tif(Rn[1]==='/'){\n\t\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\t\tcomment.t = textp;\n\t\t\t\t\tif(textR.length) /*::(*/comment/*:: :any)*/.R = textR;\n\t\t\t\t\tcomment.a = creator;\n\t\t\t\t\tcomments.push(comment);\n\t\t\t\t}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {state.push([Rn[3], false]);}\n\t\t\t\tcreator = \"\"; creatoridx = 0;\n\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\tbreak;\n\n\t\t\tcase 'creator': // 4.3.2.7 <dc:creator>\n\t\t\t\tif(Rn[1]==='/') { creator = str.slice(creatoridx,Rn.index); }\n\t\t\t\telse creatoridx = Rn.index + Rn[0].length;\n\t\t\t\tbreak;\n\n\t\t\t/* ignore state */\n\t\t\tcase 'meta': case '': // TODO: <office:meta> <uof:> FODS/UOF\n\t\t\tcase 'settings': // TODO: <office:settings>\n\t\t\tcase 'config-item-set': // TODO: <office:config-item-set>\n\t\t\tcase 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\n\t\t\tcase 'config-item-map-entry': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'config-item-map-named': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'shapes': // 9.2.8 <table:shapes>\n\t\t\tcase 'frame': // 10.4.2 <draw:frame>\n\t\t\tcase 'text-box': // 10.4.3 <draw:text-box>\n\t\t\tcase 'image': // 10.4.4 <draw:image>\n\t\t\tcase 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\n\t\t\tcase 'list-style': // 16.30 <text:list-style>\n\t\t\tcase 'form': // 13.13 <form:form>\n\t\t\tcase 'dde-links': // 9.8 <table:dde-links>\n\t\t\tcase 'event-listeners': // TODO\n\t\t\tcase 'chart': // TODO\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], false]);\n\t\t\t\ttextp = \"\"; textpidx = 0; textR = [];\n\t\t\t\tbreak;\n\n\t\t\tcase 'scientific-number': // TODO: <number:scientific-number>\n\t\t\t\tbreak;\n\t\t\tcase 'currency-symbol': // TODO: <number:currency-symbol>\n\t\t\t\tbreak;\n\t\t\tcase 'currency-style': // TODO: <number:currency-style>\n\t\t\t\tbreak;\n\t\t\tcase 'number-style': // 16.27.2 <number:number-style>\n\t\t\tcase 'percentage-style': // 16.27.9 <number:percentage-style>\n\t\t\tcase 'date-style': // 16.27.10 <number:date-style>\n\t\t\tcase 'time-style': // 16.27.18 <number:time-style>\n\t\t\t\tif(Rn[1]==='/'){\n\t\t\t\t\tnumber_format_map[NFtag.name] = NF;\n\t\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tNF = \"\";\n\t\t\t\t\tNFtag = parsexmltag(Rn[0], false);\n\t\t\t\t\tstate.push([Rn[3], true]);\n\t\t\t\t} break;\n\n\t\t\tcase 'script': break; // 3.13 <office:script>\n\t\t\tcase 'libraries': break; // TODO: <ooo:libraries>\n\t\t\tcase 'automatic-styles': break; // 3.15.3 <office:automatic-styles>\n\n\t\t\tcase 'default-style': // TODO: <style:default-style>\n\t\t\tcase 'page-layout': break; // TODO: <style:page-layout>\n\t\t\tcase 'style': // 16.2 <style:style>\n\t\t\t\tbreak;\n\t\t\tcase 'map': break; // 16.3 <style:map>\n\t\t\tcase 'font-face': break; // 16.21 <style:font-face>\n\n\t\t\tcase 'paragraph-properties': break; // 17.6 <style:paragraph-properties>\n\t\t\tcase 'table-properties': break; // 17.15 <style:table-properties>\n\t\t\tcase 'table-column-properties': break; // 17.16 <style:table-column-properties>\n\t\t\tcase 'table-row-properties': break; // 17.17 <style:table-row-properties>\n\t\t\tcase 'table-cell-properties': break; // 17.18 <style:table-cell-properties>\n\n\t\t\tcase 'number': // 16.27.3 <number:number>\n\t\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t\t\tNF += number_formats_ods[Rn[3]][tag.style==='long'?1:0]; break;\n\t\t\t\t} break;\n\n\t\t\tcase 'fraction': break; // TODO 16.27.6 <number:fraction>\n\n\t\t\tcase 'day': // 16.27.11 <number:day>\n\t\t\tcase 'month': // 16.27.12 <number:month>\n\t\t\tcase 'year': // 16.27.13 <number:year>\n\t\t\tcase 'era': // 16.27.14 <number:era>\n\t\t\tcase 'day-of-week': // 16.27.15 <number:day-of-week>\n\t\t\tcase 'week-of-year': // 16.27.16 <number:week-of-year>\n\t\t\tcase 'quarter': // 16.27.17 <number:quarter>\n\t\t\tcase 'hours': // 16.27.19 <number:hours>\n\t\t\tcase 'minutes': // 16.27.20 <number:minutes>\n\t\t\tcase 'seconds': // 16.27.21 <number:seconds>\n\t\t\tcase 'am-pm': // 16.27.22 <number:am-pm>\n\t\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t\t\tNF += number_formats_ods[Rn[3]][tag.style==='long'?1:0]; break;\n\t\t\t\t} break;\n\n\t\t\tcase 'boolean-style': break; // 16.27.23 <number:boolean-style>\n\t\t\tcase 'boolean': break; // 16.27.24 <number:boolean>\n\t\t\tcase 'text-style': break; // 16.27.25 <number:text-style>\n\t\t\tcase 'text': // 16.27.26 <number:text>\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") switch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'number-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\t\tNF += str.slice(pidx, Rn.index);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\t\tbreak;\n\n\t\t\tcase 'named-range': // 9.4.12 <table:named-range>\n\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t_Ref = ods_to_csf_3D(tag['cell-range-address']);\n\t\t\t\tvar nrange = ({Name:tag.name, Ref:_Ref[0] + '!' + _Ref[1]}/*:any*/);\n\t\t\t\tif(intable) nrange.Sheet = SheetNames.length;\n\t\t\t\tWB.Names.push(nrange);\n\t\t\t\tbreak;\n\n\t\t\tcase 'text-content': break; // 16.27.27 <number:text-content>\n\t\t\tcase 'text-properties': break; // 16.27.27 <style:text-properties>\n\t\t\tcase 'embedded-text': break; // 16.27.4 <number:embedded-text>\n\n\t\t\tcase 'body': case '': break; // 3.3 16.9.6 19.726.3\n\n\t\t\tcase 'forms': break; // 12.25.2 13.2\n\t\t\tcase 'table-column': break; // 9.1.6 <table:table-column>\n\t\t\tcase 'table-header-rows': break; // 9.1.7 <table:table-header-rows>\n\t\t\tcase 'table-rows': break; // 9.1.12 <table:table-rows>\n\t\t\t/* TODO: outline levels */\n\t\t\tcase 'table-column-group': break; // 9.1.10 <table:table-column-group>\n\t\t\tcase 'table-header-columns': break; // 9.1.11 <table:table-header-columns>\n\t\t\tcase 'table-columns': break; // 9.1.12 <table:table-columns>\n\n\t\t\tcase 'null-date': break; // 9.4.2 <table:null-date> TODO: date1904\n\n\t\t\tcase 'graphic-properties': break; // 17.21 <style:graphic-properties>\n\t\t\tcase 'calculation-settings': break; // 9.4.1 <table:calculation-settings>\n\t\t\tcase 'named-expressions': break; // 9.4.11 <table:named-expressions>\n\t\t\tcase 'label-range': break; // 9.4.9 <table:label-range>\n\t\t\tcase 'label-ranges': break; // 9.4.10 <table:label-ranges>\n\t\t\tcase 'named-expression': break; // 9.4.13 <table:named-expression>\n\t\t\tcase 'sort': break; // 9.4.19 <table:sort>\n\t\t\tcase 'sort-by': break; // 9.4.20 <table:sort-by>\n\t\t\tcase 'sort-groups': break; // 9.4.22 <table:sort-groups>\n\n\t\t\tcase 'tab': break; // 6.1.4 <text:tab>\n\t\t\tcase 'line-break': break; // 6.1.5 <text:line-break>\n\t\t\tcase 'span': break; // 6.1.7 <text:span>\n\t\t\tcase 'p': case '': // 5.1.3 <text:p>\n\t\t\t\tif(['master-styles'].indexOf(state[state.length-1][0]) > -1) break;\n\t\t\t\tif(Rn[1]==='/' && (!ctag || !ctag['string-value'])) {\n\t\t\t\t\tvar ptp = parse_text_p(str.slice(textpidx,Rn.index), textptag);\n\t\t\t\t\ttextp = (textp.length > 0 ? textp + \"\\n\" : \"\") + ptp[0];\n\t\t\t\t} else { textptag = parsexmltag(Rn[0], false); textpidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak; // <text:p>\n\t\t\tcase 's': break; // <text:s>\n\n\t\t\tcase 'database-range': // 9.4.15 <table:database-range>\n\t\t\t\tif(Rn[1]==='/') break;\n\t\t\t\ttry {\n\t\t\t\t\t_Ref = ods_to_csf_3D(parsexmltag(Rn[0])['target-range-address']);\n\t\t\t\t\tSheets[_Ref[0]]['!autofilter'] = { ref:_Ref[1] };\n\t\t\t\t} catch(e) {/* empty */}\n\t\t\t\tbreak;\n\n\t\t\tcase 'date': break; // <*:date>\n\n\t\t\tcase 'object': break; // 10.4.6.2 <draw:object>\n\t\t\tcase 'title': case '': break; // <*:title> OR <uof:>\n\t\t\tcase 'desc': break; // <*:desc>\n\t\t\tcase 'binary-data': break; // 10.4.5 TODO: b64 blob\n\n\t\t\t/* 9.2 Advanced Tables */\n\t\t\tcase 'table-source': break; // 9.2.6\n\t\t\tcase 'scenario': break; // 9.2.6\n\n\t\t\tcase 'iteration': break; // 9.4.3 <table:iteration>\n\t\t\tcase 'content-validations': break; // 9.4.4 <table:\n\t\t\tcase 'content-validation': break; // 9.4.5 <table:\n\t\t\tcase 'help-message': break; // 9.4.6 <table:\n\t\t\tcase 'error-message': break; // 9.4.7 <table:\n\t\t\tcase 'database-ranges': break; // 9.4.14 <table:database-ranges>\n\t\t\tcase 'filter': break; // 9.5.2 <table:filter>\n\t\t\tcase 'filter-and': break; // 9.5.3 <table:filter-and>\n\t\t\tcase 'filter-or': break; // 9.5.4 <table:filter-or>\n\t\t\tcase 'filter-condition': break; // 9.5.5 <table:filter-condition>\n\n\t\t\tcase 'list-level-style-bullet': break; // 16.31 <text:\n\t\t\tcase 'list-level-style-number': break; // 16.32 <text:\n\t\t\tcase 'list-level-properties': break; // 17.19 <style:\n\n\t\t\t/* 7.3 Document Fields */\n\t\t\tcase 'sender-firstname': // 7.3.6.2\n\t\t\tcase 'sender-lastname': // 7.3.6.3\n\t\t\tcase 'sender-initials': // 7.3.6.4\n\t\t\tcase 'sender-title': // 7.3.6.5\n\t\t\tcase 'sender-position': // 7.3.6.6\n\t\t\tcase 'sender-email': // 7.3.6.7\n\t\t\tcase 'sender-phone-private': // 7.3.6.8\n\t\t\tcase 'sender-fax': // 7.3.6.9\n\t\t\tcase 'sender-company': // 7.3.6.10\n\t\t\tcase 'sender-phone-work': // 7.3.6.11\n\t\t\tcase 'sender-street': // 7.3.6.12\n\t\t\tcase 'sender-city': // 7.3.6.13\n\t\t\tcase 'sender-postal-code': // 7.3.6.14\n\t\t\tcase 'sender-country': // 7.3.6.15\n\t\t\tcase 'sender-state-or-province': // 7.3.6.16\n\t\t\tcase 'author-name': // 7.3.7.1\n\t\t\tcase 'author-initials': // 7.3.7.2\n\t\t\tcase 'chapter': // 7.3.8\n\t\t\tcase 'file-name': // 7.3.9\n\t\t\tcase 'template-name': // 7.3.9\n\t\t\tcase 'sheet-name': // 7.3.9\n\t\t\t\tbreak;\n\n\t\t\tcase 'event-listener':\n\t\t\t\tbreak;\n\t\t\t/* TODO: FODS Properties */\n\t\t\tcase 'initial-creator':\n\t\t\tcase 'creation-date':\n\t\t\tcase 'print-date':\n\t\t\tcase 'generator':\n\t\t\tcase 'document-statistic':\n\t\t\tcase 'user-defined':\n\t\t\tcase 'editing-duration':\n\t\t\tcase 'editing-cycles':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: FODS Config */\n\t\t\tcase 'config-item':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: style tokens */\n\t\t\tcase 'page-number': break; // TODO <text:page-number>\n\t\t\tcase 'page-count': break; // TODO <text:page-count>\n\t\t\tcase 'time': break; // TODO <text:time>\n\n\t\t\t/* 9.3 Advanced Table Cells */\n\t\t\tcase 'cell-range-source': break; // 9.3.1 <table:\n\t\t\tcase 'detective': break; // 9.3.2 <table:\n\t\t\tcase 'operation': break; // 9.3.3 <table:\n\t\t\tcase 'highlighted-range': break; // 9.3.4 <table:\n\n\t\t\t/* 9.6 Data Pilot Tables <table: */\n\t\t\tcase 'data-pilot-table': // 9.6.3\n\t\t\tcase 'source-cell-range': // 9.6.5\n\t\t\tcase 'source-service': // 9.6.6\n\t\t\tcase 'data-pilot-field': // 9.6.7\n\t\t\tcase 'data-pilot-level': // 9.6.8\n\t\t\tcase 'data-pilot-subtotals': // 9.6.9\n\t\t\tcase 'data-pilot-subtotal': // 9.6.10\n\t\t\tcase 'data-pilot-members': // 9.6.11\n\t\t\tcase 'data-pilot-member': // 9.6.12\n\t\t\tcase 'data-pilot-display-info': // 9.6.13\n\t\t\tcase 'data-pilot-sort-info': // 9.6.14\n\t\t\tcase 'data-pilot-layout-info': // 9.6.15\n\t\t\tcase 'data-pilot-field-reference': // 9.6.16\n\t\t\tcase 'data-pilot-groups': // 9.6.17\n\t\t\tcase 'data-pilot-group': // 9.6.18\n\t\t\tcase 'data-pilot-group-member': // 9.6.19\n\t\t\t\tbreak;\n\n\t\t\t/* 10.3 Drawing Shapes */\n\t\t\tcase 'rect': // 10.3.2\n\t\t\t\tbreak;\n\n\t\t\t/* 14.6 DDE Connections */\n\t\t\tcase 'dde-connection-decls': // 14.6.2 <text:\n\t\t\tcase 'dde-connection-decl': // 14.6.3 <text:\n\t\t\tcase 'dde-link': // 14.6.4 <table:\n\t\t\tcase 'dde-source': // 14.6.5 <office:\n\t\t\t\tbreak;\n\n\t\t\tcase 'properties': break; // 13.7 <form:properties>\n\t\t\tcase 'property': break; // 13.8 <form:property>\n\n\t\t\tcase 'a': // 6.1.8 hyperlink\n\t\t\t\tif(Rn[1]!== '/') {\n\t\t\t\t\tatag = parsexmltag(Rn[0], false);\n\t\t\t\t\tif(!atag.href) break;\n\t\t\t\t\tatag.Target = unescapexml(atag.href); delete atag.href;\n\t\t\t\t\tif(atag.Target.charAt(0) == \"#\" && atag.Target.indexOf(\".\") > -1) {\n\t\t\t\t\t\t_Ref = ods_to_csf_3D(atag.Target.slice(1));\n\t\t\t\t\t\tatag.Target = \"#\" + _Ref[0] + \"!\" + _Ref[1];\n\t\t\t\t\t} else if(atag.Target.match(/^\\.\\.[\\\\\\/]/)) atag.Target = atag.Target.slice(3);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t/* non-standard */\n\t\t\tcase 'table-protection': break;\n\t\t\tcase 'data-pilot-grand-total': break; // <table:\n\t\t\tcase 'office-document-common-attrs': break; // bare\n\t\t\tdefault: switch(Rn[2]) {\n\t\t\t\tcase 'dc:':       // TODO: properties\n\t\t\t\tcase 'calcext:':  // ignore undocumented extensions\n\t\t\t\tcase 'loext:':    // ignore undocumented extensions\n\t\t\t\tcase 'ooo:':      // ignore undocumented extensions\n\t\t\t\tcase 'chartooo:': // ignore undocumented extensions\n\t\t\t\tcase 'draw:':     // TODO: drawing\n\t\t\t\tcase 'style:':    // TODO: styles\n\t\t\t\tcase 'chart:':    // TODO: charts\n\t\t\t\tcase 'form:':     // TODO: forms\n\t\t\t\tcase 'uof:':      // TODO: uof\n\t\t\t\tcase ':':       // TODO: uof\n\t\t\t\tcase ':':       // TODO: uof\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: if(opts.WTF) throw new Error(Rn);\n\t\t\t}\n\t\t}\n\t\tvar out/*:Workbook*/ = ({\n\t\t\tSheets: Sheets,\n\t\t\tSheetNames: SheetNames,\n\t\t\tWorkbook: WB\n\t\t}/*:any*/);\n\t\tif(opts.bookSheets) delete /*::(*/out/*:: :any)*/.Sheets;\n\t\treturn out;\n}\n\nfunction parse_ods(zip/*:ZIPFile*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\topts = opts || ({}/*:any*/);\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\n\tvar content = getzipstr(zip, 'content.xml');\n\tif(!content) throw new Error(\"Missing content.xml in ODS / UOF file\");\n\tvar wb = parse_content_xml(utf8read(content), opts);\n\tif(safegetzipfile(zip, 'meta.xml')) wb.Props = parse_core_props(getzipdata(zip, 'meta.xml'));\n\treturn wb;\n}\nfunction parse_fods(data/*:string*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\treturn parse_content_xml(data, opts);\n}\n\n/* OpenDocument */\nvar write_styles_ods/*:{(wb:any, opts:any):string}*/ = /* @__PURE__ */(function() {\n\tvar master_styles = [\n\t\t'<office:master-styles>',\n\t\t\t'<style:master-page style:name=\"mp1\" style:page-layout-name=\"mp1\">',\n\t\t\t\t'<style:header/>',\n\t\t\t\t'<style:header-left style:display=\"false\"/>',\n\t\t\t\t'<style:footer/>',\n\t\t\t\t'<style:footer-left style:display=\"false\"/>',\n\t\t\t'</style:master-page>',\n\t\t'</office:master-styles>'\n\t].join(\"\");\n\n\tvar payload = '<office:document-styles ' + wxt_helper({\n\t\t'xmlns:office':   \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n\t\t'xmlns:table':    \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n\t\t'xmlns:style':    \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n\t\t'xmlns:text':     \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n\t\t'xmlns:draw':     \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n\t\t'xmlns:fo':       \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n\t\t'xmlns:xlink':    \"http://www.w3.org/1999/xlink\",\n\t\t'xmlns:dc':       \"http://purl.org/dc/elements/1.1/\",\n\t\t'xmlns:number':   \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n\t\t'xmlns:svg':      \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n\t\t'xmlns:of':       \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n\t\t'office:version': \"1.2\"\n\t}) + '>' + master_styles + '</office:document-styles>';\n\n\treturn function wso(/*::wb, opts*/) {\n\t\treturn XML_HEADER + payload;\n\t};\n})();\nvar write_content_ods/*:{(wb:any, opts:any):string}*/ = /* @__PURE__ */(function() {\n\t/* 6.1.2 White Space Characters */\n\tvar write_text_p = function(text/*:string*/)/*:string*/ {\n\t\treturn escapexml(text)\n\t\t\t.replace(/  +/g, function($$){return '<text:s text:c=\"'+$$.length+'\"/>';})\n\t\t\t.replace(/\\t/g, \"<text:tab/>\")\n\t\t\t.replace(/\\n/g, \"</text:p><text:p>\")\n\t\t\t.replace(/^ /, \"<text:s/>\").replace(/ $/, \"<text:s/>\");\n\t};\n\n\tvar null_cell_xml = '          <table:table-cell />\\n';\n\tvar covered_cell_xml = '          <table:covered-table-cell/>\\n';\n\tvar write_ws = function(ws, wb/*:Workbook*/, i/*:number*//*::, opts*/)/*:string*/ {\n\t\t/* Section 9 Tables */\n\t\tvar o/*:Array<string>*/ = [];\n\t\to.push('      <table:table table:name=\"' + escapexml(wb.SheetNames[i]) + '\" table:style-name=\"ta1\">\\n');\n\t\tvar R=0,C=0, range = decode_range(ws['!ref']||\"A1\");\n\t\tvar marr/*:Array<Range>*/ = ws['!merges'] || [], mi = 0;\n\t\tvar dense = Array.isArray(ws);\n\t\tif(ws[\"!cols\"]) {\n\t\t\tfor(C = 0; C <= range.e.c; ++C) o.push('        <table:table-column' + (ws[\"!cols\"][C] ? ' table:style-name=\"co' + ws[\"!cols\"][C].ods + '\"' : '') + '></table:table-column>\\n');\n\t\t}\n\t\tvar H = \"\", ROWS = ws[\"!rows\"]||[];\n\t\tfor(R = 0; R < range.s.r; ++R) {\n\t\t\tH = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n\t\t\to.push('        <table:table-row' + H + '></table:table-row>\\n');\n\t\t}\n\t\tfor(; R <= range.e.r; ++R) {\n\t\t\tH = ROWS[R] ? ' table:style-name=\"ro' + ROWS[R].ods + '\"' : \"\";\n\t\t\to.push('        <table:table-row' + H + '>\\n');\n\t\t\tfor(C=0; C < range.s.c; ++C) o.push(null_cell_xml);\n\t\t\tfor(; C <= range.e.c; ++C) {\n\t\t\t\tvar skip = false, ct = {}, textp = \"\";\n\t\t\t\tfor(mi = 0; mi != marr.length; ++mi) {\n\t\t\t\t\tif(marr[mi].s.c > C) continue;\n\t\t\t\t\tif(marr[mi].s.r > R) continue;\n\t\t\t\t\tif(marr[mi].e.c < C) continue;\n\t\t\t\t\tif(marr[mi].e.r < R) continue;\n\t\t\t\t\tif(marr[mi].s.c != C || marr[mi].s.r != R) skip = true;\n\t\t\t\t\tct['table:number-columns-spanned'] = (marr[mi].e.c - marr[mi].s.c + 1);\n\t\t\t\t\tct['table:number-rows-spanned'] =    (marr[mi].e.r - marr[mi].s.r + 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(skip) { o.push(covered_cell_xml); continue; }\n\t\t\t\tvar ref = encode_cell({r:R, c:C}), cell = dense ? (ws[R]||[])[C]: ws[ref];\n\t\t\t\tif(cell && cell.f) {\n\t\t\t\t\tct['table:formula'] = escapexml(csf_to_ods_formula(cell.f));\n\t\t\t\t\tif(cell.F) {\n\t\t\t\t\t\tif(cell.F.slice(0, ref.length) == ref) {\n\t\t\t\t\t\t\tvar _Fref = decode_range(cell.F);\n\t\t\t\t\t\t\tct['table:number-matrix-columns-spanned'] = (_Fref.e.c - _Fref.s.c + 1);\n\t\t\t\t\t\t\tct['table:number-matrix-rows-spanned'] =    (_Fref.e.r - _Fref.s.r + 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!cell) { o.push(null_cell_xml); continue; }\n\t\t\t\tswitch(cell.t) {\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\ttextp = (cell.v ? 'TRUE' : 'FALSE');\n\t\t\t\t\t\tct['office:value-type'] = \"boolean\";\n\t\t\t\t\t\tct['office:boolean-value'] = (cell.v ? 'true' : 'false');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'n':\n\t\t\t\t\t\ttextp = (cell.w||String(cell.v||0));\n\t\t\t\t\t\tct['office:value-type'] = \"float\";\n\t\t\t\t\t\tct['office:value'] = (cell.v||0);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 's': case 'str':\n\t\t\t\t\t\ttextp = cell.v == null ? \"\" : cell.v;\n\t\t\t\t\t\tct['office:value-type'] = \"string\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\ttextp = (cell.w||(parseDate(cell.v).toISOString()));\n\t\t\t\t\t\tct['office:value-type'] = \"date\";\n\t\t\t\t\t\tct['office:date-value'] = (parseDate(cell.v).toISOString());\n\t\t\t\t\t\tct['table:style-name'] = \"ce1\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t//case 'e':\n\t\t\t\t\tdefault: o.push(null_cell_xml); continue;\n\t\t\t\t}\n\t\t\t\tvar text_p = write_text_p(textp);\n\t\t\t\tif(cell.l && cell.l.Target) {\n\t\t\t\t\tvar _tgt = cell.l.Target;\n\t\t\t\t\t_tgt = _tgt.charAt(0) == \"#\" ? \"#\" + csf_to_ods_3D(_tgt.slice(1)) : _tgt;\n\t\t\t\t\t// TODO: choose correct parent path format based on link delimiters\n\t\t\t\t\tif(_tgt.charAt(0) != \"#\" && !_tgt.match(/^\\w+:/)) _tgt = '../' + _tgt;\n\t\t\t\t\ttext_p = writextag('text:a', text_p, {'xlink:href': _tgt.replace(/&/g, \"&amp;\")});\n\t\t\t\t}\n\t\t\t\to.push('          ' + writextag('table:table-cell', writextag('text:p', text_p, {}), ct) + '\\n');\n\t\t\t}\n\t\t\to.push('        </table:table-row>\\n');\n\t\t}\n\t\to.push('      </table:table>\\n');\n\t\treturn o.join(\"\");\n\t};\n\n\tvar write_automatic_styles_ods = function(o/*:Array<string>*/, wb) {\n\t\to.push(' <office:automatic-styles>\\n');\n\n\t\to.push('  <number:date-style style:name=\"N37\" number:automatic-order=\"true\">\\n');\n\t\to.push('   <number:month number:style=\"long\"/>\\n');\n\t\to.push('   <number:text>/</number:text>\\n');\n\t\to.push('   <number:day number:style=\"long\"/>\\n');\n\t\to.push('   <number:text>/</number:text>\\n');\n\t\to.push('   <number:year/>\\n');\n\t\to.push('  </number:date-style>\\n');\n\n\t\t/* column styles */\n\t\tvar cidx = 0;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tif(ws[\"!cols\"]) {\n\t\t\t\tfor(var C = 0; C < ws[\"!cols\"].length; ++C) if(ws[\"!cols\"][C]) {\n\t\t\t\t\tvar colobj = ws[\"!cols\"][C];\n\t\t\t\t\tif(colobj.width == null && colobj.wpx == null && colobj.wch == null) continue;\n\t\t\t\t\tprocess_col(colobj);\n\t\t\t\t\tcolobj.ods = cidx;\n\t\t\t\t\tvar w = ws[\"!cols\"][C].wpx + \"px\";\n\t\t\t\t\to.push('  <style:style style:name=\"co' + cidx + '\" style:family=\"table-column\">\\n');\n\t\t\t\t\to.push('   <style:table-column-properties fo:break-before=\"auto\" style:column-width=\"' + w + '\"/>\\n');\n\t\t\t\t\to.push('  </style:style>\\n');\n\t\t\t\t\t++cidx;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t/* row styles */\n\t\tvar ridx = 0;\n\t\twb.SheetNames.map(function(n) { return wb.Sheets[n]; }).forEach(function(ws) {\n\t\t\tif(!ws) return;\n\t\t\tif(ws[\"!rows\"]) {\n\t\t\t\tfor(var R = 0; R < ws[\"!rows\"].length; ++R) if(ws[\"!rows\"][R]) {\n\t\t\t\t\tws[\"!rows\"][R].ods = ridx;\n\t\t\t\t\tvar h = ws[\"!rows\"][R].hpx + \"px\";\n\t\t\t\t\to.push('  <style:style style:name=\"ro' + ridx + '\" style:family=\"table-row\">\\n');\n\t\t\t\t\to.push('   <style:table-row-properties fo:break-before=\"auto\" style:row-height=\"' + h + '\"/>\\n');\n\t\t\t\t\to.push('  </style:style>\\n');\n\t\t\t\t\t++ridx;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t/* table */\n\t\to.push('  <style:style style:name=\"ta1\" style:family=\"table\" style:master-page-name=\"mp1\">\\n');\n\t\to.push('   <style:table-properties table:display=\"true\" style:writing-mode=\"lr-tb\"/>\\n');\n\t\to.push('  </style:style>\\n');\n\n\t\t/* table cells, text */\n\t\to.push('  <style:style style:name=\"ce1\" style:family=\"table-cell\" style:parent-style-name=\"Default\" style:data-style-name=\"N37\"/>\\n');\n\n\t\t/* page-layout */\n\n\t\to.push(' </office:automatic-styles>\\n');\n\t};\n\n\treturn function wcx(wb, opts) {\n\t\tvar o = [XML_HEADER];\n\t\t/* 3.1.3.2 */\n\t\tvar attr = wxt_helper({\n\t\t\t'xmlns:office':       \"urn:oasis:names:tc:opendocument:xmlns:office:1.0\",\n\t\t\t'xmlns:table':        \"urn:oasis:names:tc:opendocument:xmlns:table:1.0\",\n\t\t\t'xmlns:style':        \"urn:oasis:names:tc:opendocument:xmlns:style:1.0\",\n\t\t\t'xmlns:text':         \"urn:oasis:names:tc:opendocument:xmlns:text:1.0\",\n\t\t\t'xmlns:draw':         \"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\",\n\t\t\t'xmlns:fo':           \"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\",\n\t\t\t'xmlns:xlink':        \"http://www.w3.org/1999/xlink\",\n\t\t\t'xmlns:dc':           \"http://purl.org/dc/elements/1.1/\",\n\t\t\t'xmlns:meta':         \"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\",\n\t\t\t'xmlns:number':       \"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\",\n\t\t\t'xmlns:presentation': \"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\",\n\t\t\t'xmlns:svg':          \"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\",\n\t\t\t'xmlns:chart':        \"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\",\n\t\t\t'xmlns:dr3d':         \"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\",\n\t\t\t'xmlns:math':         \"http://www.w3.org/1998/Math/MathML\",\n\t\t\t'xmlns:form':         \"urn:oasis:names:tc:opendocument:xmlns:form:1.0\",\n\t\t\t'xmlns:script':       \"urn:oasis:names:tc:opendocument:xmlns:script:1.0\",\n\t\t\t'xmlns:ooo':          \"http://openoffice.org/2004/office\",\n\t\t\t'xmlns:ooow':         \"http://openoffice.org/2004/writer\",\n\t\t\t'xmlns:oooc':         \"http://openoffice.org/2004/calc\",\n\t\t\t'xmlns:dom':          \"http://www.w3.org/2001/xml-events\",\n\t\t\t'xmlns:xforms':       \"http://www.w3.org/2002/xforms\",\n\t\t\t'xmlns:xsd':          \"http://www.w3.org/2001/XMLSchema\",\n\t\t\t'xmlns:xsi':          \"http://www.w3.org/2001/XMLSchema-instance\",\n\t\t\t'xmlns:sheet':        \"urn:oasis:names:tc:opendocument:sh33tjs:1.0\",\n\t\t\t'xmlns:rpt':          \"http://openoffice.org/2005/report\",\n\t\t\t'xmlns:of':           \"urn:oasis:names:tc:opendocument:xmlns:of:1.2\",\n\t\t\t'xmlns:xhtml':        \"http://www.w3.org/1999/xhtml\",\n\t\t\t'xmlns:grddl':        \"http://www.w3.org/2003/g/data-view#\",\n\t\t\t'xmlns:tableooo':     \"http://openoffice.org/2009/table\",\n\t\t\t'xmlns:drawooo':      \"http://openoffice.org/2010/draw\",\n\t\t\t'xmlns:calcext':      \"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\",\n\t\t\t'xmlns:loext':        \"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\",\n\t\t\t'xmlns:field':        \"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\",\n\t\t\t'xmlns:formx':        \"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\",\n\t\t\t'xmlns:css3t':        \"http://www.w3.org/TR/css3-text/\",\n\t\t\t'office:version':     \"1.2\"\n\t\t});\n\n\t\tvar fods = wxt_helper({\n\t\t\t'xmlns:config':    \"urn:oasis:names:tc:opendocument:xmlns:config:1.0\",\n\t\t\t'office:mimetype': \"application/vnd.oasis.opendocument.spreadsheet\"\n\t\t});\n\n\t\tif(opts.bookType == \"fods\") {\n\t\t\to.push('<office:document' + attr + fods + '>\\n');\n\t\t\to.push(write_meta_ods().replace(/office:document-meta/g, \"office:meta\"));\n\t\t\t// TODO: settings (equiv of settings.xml for ODS)\n\t\t} else o.push('<office:document-content' + attr  + '>\\n');\n\t\t// o.push('  <office:scripts/>\\n');\n\t\twrite_automatic_styles_ods(o, wb);\n\t\to.push('  <office:body>\\n');\n\t\to.push('    <office:spreadsheet>\\n');\n\t\tfor(var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws(wb.Sheets[wb.SheetNames[i]], wb, i, opts));\n\t\to.push('    </office:spreadsheet>\\n');\n\t\to.push('  </office:body>\\n');\n\t\tif(opts.bookType == \"fods\") o.push('</office:document>');\n\t\telse o.push('</office:document-content>');\n\t\treturn o.join(\"\");\n\t};\n})();\n\nfunction write_ods(wb/*:any*/, opts/*:any*/) {\n\tif(opts.bookType == \"fods\") return write_content_ods(wb, opts);\n\n\tvar zip = zip_new();\n\tvar f = \"\";\n\n\tvar manifest/*:Array<Array<string> >*/ = [];\n\tvar rdf/*:Array<[string, string]>*/ = [];\n\n\t/* Part 3 Section 3.3 MIME Media Type */\n\tf = \"mimetype\";\n\tzip_add_file(zip, f, \"application/vnd.oasis.opendocument.spreadsheet\");\n\n\t/* Part 1 Section 2.2 Documents */\n\tf = \"content.xml\";\n\tzip_add_file(zip, f, write_content_ods(wb, opts));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"ContentFile\"]);\n\n\t/* TODO: these are hard-coded styles to satiate excel */\n\tf = \"styles.xml\";\n\tzip_add_file(zip, f, write_styles_ods(wb, opts));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"StylesFile\"]);\n\n\t/* TODO: this is hard-coded to satiate excel */\n\tf = \"meta.xml\";\n\tzip_add_file(zip, f, XML_HEADER + write_meta_ods(/*::wb, opts*/));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"MetadataFile\"]);\n\n\t/* Part 3 Section 6 Metadata Manifest File */\n\tf = \"manifest.rdf\";\n\tzip_add_file(zip, f, write_rdf(rdf/*, opts*/));\n\tmanifest.push([f, \"application/rdf+xml\"]);\n\n\t/* Part 3 Section 4 Manifest File */\n\tf = \"META-INF/manifest.xml\";\n\tzip_add_file(zip, f, write_manifest(manifest/*, opts*/));\n\n\treturn zip;\n}\n\n/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */\nfunction u8_to_dataview(array) {\n  return new DataView(array.buffer, array.byteOffset, array.byteLength);\n}\nfunction u8str(u8) {\n  return typeof TextDecoder != \"undefined\" ? new TextDecoder().decode(u8) : utf8read(a2s(u8));\n}\nfunction stru8(str) {\n  return typeof TextEncoder != \"undefined\" ? new TextEncoder().encode(str) : s2a(utf8write(str));\n}\nfunction u8contains(body, search) {\n  outer:\n    for (var L = 0; L <= body.length - search.length; ++L) {\n      for (var j = 0; j < search.length; ++j)\n        if (body[L + j] != search[j])\n          continue outer;\n      return true;\n    }\n  return false;\n}\nfunction u8concat(u8a) {\n  var len = u8a.reduce(function(acc, x) {\n    return acc + x.length;\n  }, 0);\n  var out = new Uint8Array(len);\n  var off = 0;\n  u8a.forEach(function(u8) {\n    out.set(u8, off);\n    off += u8.length;\n  });\n  return out;\n}\nfunction popcnt(x) {\n  x -= x >> 1 & 1431655765;\n  x = (x & 858993459) + (x >> 2 & 858993459);\n  return (x + (x >> 4) & 252645135) * 16843009 >>> 24;\n}\nfunction readDecimal128LE(buf, offset) {\n  var exp = (buf[offset + 15] & 127) << 7 | buf[offset + 14] >> 1;\n  var mantissa = buf[offset + 14] & 1;\n  for (var j = offset + 13; j >= offset; --j)\n    mantissa = mantissa * 256 + buf[j];\n  return (buf[offset + 15] & 128 ? -mantissa : mantissa) * Math.pow(10, exp - 6176);\n}\nfunction writeDecimal128LE(buf, offset, value) {\n  var exp = Math.floor(value == 0 ? 0 : Math.LOG10E * Math.log(Math.abs(value))) + 6176 - 20;\n  var mantissa = value / Math.pow(10, exp - 6176);\n  buf[offset + 15] |= exp >> 7;\n  buf[offset + 14] |= (exp & 127) << 1;\n  for (var i = 0; mantissa >= 1; ++i, mantissa /= 256)\n    buf[offset + i] = mantissa & 255;\n  buf[offset + 15] |= value >= 0 ? 0 : 128;\n}\nfunction parse_varint49(buf, ptr) {\n  var l = ptr ? ptr[0] : 0;\n  var usz = buf[l] & 127;\n  varint:\n    if (buf[l++] >= 128) {\n      usz |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128)\n        break varint;\n      usz |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128)\n        break varint;\n      usz |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 28);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 35);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n      usz += (buf[l] & 127) * Math.pow(2, 42);\n      ++l;\n      if (buf[l++] < 128)\n        break varint;\n    }\n  if (ptr)\n    ptr[0] = l;\n  return usz;\n}\nfunction write_varint49(v) {\n  var usz = new Uint8Array(7);\n  usz[0] = v & 127;\n  var L = 1;\n  sz:\n    if (v > 127) {\n      usz[L - 1] |= 128;\n      usz[L] = v >> 7 & 127;\n      ++L;\n      if (v <= 16383)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 14 & 127;\n      ++L;\n      if (v <= 2097151)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v >> 21 & 127;\n      ++L;\n      if (v <= 268435455)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 256 >>> 21 & 127;\n      ++L;\n      if (v <= 34359738367)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 65536 >>> 21 & 127;\n      ++L;\n      if (v <= 4398046511103)\n        break sz;\n      usz[L - 1] |= 128;\n      usz[L] = v / 16777216 >>> 21 & 127;\n      ++L;\n    }\n  return usz.slice(0, L);\n}\nfunction varint_to_i32(buf) {\n  var l = 0, i32 = buf[l] & 127;\n  varint:\n    if (buf[l++] >= 128) {\n      i32 |= (buf[l] & 127) << 7;\n      if (buf[l++] < 128)\n        break varint;\n      i32 |= (buf[l] & 127) << 14;\n      if (buf[l++] < 128)\n        break varint;\n      i32 |= (buf[l] & 127) << 21;\n      if (buf[l++] < 128)\n        break varint;\n      i32 |= (buf[l] & 127) << 28;\n    }\n  return i32;\n}\nfunction parse_shallow(buf) {\n  var out = [], ptr = [0];\n  while (ptr[0] < buf.length) {\n    var off = ptr[0];\n    var num = parse_varint49(buf, ptr);\n    var type = num & 7;\n    num = Math.floor(num / 8);\n    var len = 0;\n    var res;\n    if (num == 0)\n      break;\n    switch (type) {\n      case 0:\n        {\n          var l = ptr[0];\n          while (buf[ptr[0]++] >= 128)\n            ;\n          res = buf.slice(l, ptr[0]);\n        }\n        break;\n      case 5:\n        len = 4;\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n      case 1:\n        len = 8;\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n      case 2:\n        len = parse_varint49(buf, ptr);\n        res = buf.slice(ptr[0], ptr[0] + len);\n        ptr[0] += len;\n        break;\n      case 3:\n      case 4:\n      default:\n        throw new Error(\"PB Type \".concat(type, \" for Field \").concat(num, \" at offset \").concat(off));\n    }\n    var v = { data: res, type: type };\n    if (out[num] == null)\n      out[num] = [v];\n    else\n      out[num].push(v);\n  }\n  return out;\n}\nfunction write_shallow(proto) {\n  var out = [];\n  proto.forEach(function(field, idx) {\n    field.forEach(function(item) {\n      if (!item.data)\n        return;\n      out.push(write_varint49(idx * 8 + item.type));\n      if (item.type == 2)\n        out.push(write_varint49(item.data.length));\n      out.push(item.data);\n    });\n  });\n  return u8concat(out);\n}\nfunction mappa(data, cb) {\n  return (data == null ? void 0 : data.map(function(d) {\n    return cb(d.data);\n  })) || [];\n}\nfunction parse_iwa_file(buf) {\n  var _a;\n  var out = [], ptr = [0];\n  while (ptr[0] < buf.length) {\n    var len = parse_varint49(buf, ptr);\n    var ai = parse_shallow(buf.slice(ptr[0], ptr[0] + len));\n    ptr[0] += len;\n    var res = {\n      id: varint_to_i32(ai[1][0].data),\n      messages: []\n    };\n    ai[2].forEach(function(b) {\n      var mi = parse_shallow(b.data);\n      var fl = varint_to_i32(mi[3][0].data);\n      res.messages.push({\n        meta: mi,\n        data: buf.slice(ptr[0], ptr[0] + fl)\n      });\n      ptr[0] += fl;\n    });\n    if ((_a = ai[3]) == null ? void 0 : _a[0])\n      res.merge = varint_to_i32(ai[3][0].data) >>> 0 > 0;\n    out.push(res);\n  }\n  return out;\n}\nfunction write_iwa_file(ias) {\n  var bufs = [];\n  ias.forEach(function(ia) {\n    var ai = [];\n    ai[1] = [{ data: write_varint49(ia.id), type: 0 }];\n    ai[2] = [];\n    if (ia.merge != null)\n      ai[3] = [{ data: write_varint49(+!!ia.merge), type: 0 }];\n    var midata = [];\n    ia.messages.forEach(function(mi) {\n      midata.push(mi.data);\n      mi.meta[3] = [{ type: 0, data: write_varint49(mi.data.length) }];\n      ai[2].push({ data: write_shallow(mi.meta), type: 2 });\n    });\n    var aipayload = write_shallow(ai);\n    bufs.push(write_varint49(aipayload.length));\n    bufs.push(aipayload);\n    midata.forEach(function(mid) {\n      return bufs.push(mid);\n    });\n  });\n  return u8concat(bufs);\n}\nfunction parse_snappy_chunk(type, buf) {\n  if (type != 0)\n    throw new Error(\"Unexpected Snappy chunk type \".concat(type));\n  var ptr = [0];\n  var usz = parse_varint49(buf, ptr);\n  var chunks = [];\n  while (ptr[0] < buf.length) {\n    var tag = buf[ptr[0]] & 3;\n    if (tag == 0) {\n      var len = buf[ptr[0]++] >> 2;\n      if (len < 60)\n        ++len;\n      else {\n        var c = len - 59;\n        len = buf[ptr[0]];\n        if (c > 1)\n          len |= buf[ptr[0] + 1] << 8;\n        if (c > 2)\n          len |= buf[ptr[0] + 2] << 16;\n        if (c > 3)\n          len |= buf[ptr[0] + 3] << 24;\n        len >>>= 0;\n        len++;\n        ptr[0] += c;\n      }\n      chunks.push(buf.slice(ptr[0], ptr[0] + len));\n      ptr[0] += len;\n      continue;\n    } else {\n      var offset = 0, length = 0;\n      if (tag == 1) {\n        length = (buf[ptr[0]] >> 2 & 7) + 4;\n        offset = (buf[ptr[0]++] & 224) << 3;\n        offset |= buf[ptr[0]++];\n      } else {\n        length = (buf[ptr[0]++] >> 2) + 1;\n        if (tag == 2) {\n          offset = buf[ptr[0]] | buf[ptr[0] + 1] << 8;\n          ptr[0] += 2;\n        } else {\n          offset = (buf[ptr[0]] | buf[ptr[0] + 1] << 8 | buf[ptr[0] + 2] << 16 | buf[ptr[0] + 3] << 24) >>> 0;\n          ptr[0] += 4;\n        }\n      }\n      chunks = [u8concat(chunks)];\n      if (offset == 0)\n        throw new Error(\"Invalid offset 0\");\n      if (offset > chunks[0].length)\n        throw new Error(\"Invalid offset beyond length\");\n      if (length >= offset) {\n        chunks.push(chunks[0].slice(-offset));\n        length -= offset;\n        while (length >= chunks[chunks.length - 1].length) {\n          chunks.push(chunks[chunks.length - 1]);\n          length -= chunks[chunks.length - 1].length;\n        }\n      }\n      chunks.push(chunks[0].slice(-offset, -offset + length));\n    }\n  }\n  var o = u8concat(chunks);\n  if (o.length != usz)\n    throw new Error(\"Unexpected length: \".concat(o.length, \" != \").concat(usz));\n  return o;\n}\nfunction decompress_iwa_file(buf) {\n  var out = [];\n  var l = 0;\n  while (l < buf.length) {\n    var t = buf[l++];\n    var len = buf[l] | buf[l + 1] << 8 | buf[l + 2] << 16;\n    l += 3;\n    out.push(parse_snappy_chunk(t, buf.slice(l, l + len)));\n    l += len;\n  }\n  if (l !== buf.length)\n    throw new Error(\"data is not a valid framed stream!\");\n  return u8concat(out);\n}\nfunction compress_iwa_file(buf) {\n  var out = [];\n  var l = 0;\n  while (l < buf.length) {\n    var c = Math.min(buf.length - l, 268435455);\n    var frame = new Uint8Array(4);\n    out.push(frame);\n    var usz = write_varint49(c);\n    var L = usz.length;\n    out.push(usz);\n    if (c <= 60) {\n      L++;\n      out.push(new Uint8Array([c - 1 << 2]));\n    } else if (c <= 256) {\n      L += 2;\n      out.push(new Uint8Array([240, c - 1 & 255]));\n    } else if (c <= 65536) {\n      L += 3;\n      out.push(new Uint8Array([244, c - 1 & 255, c - 1 >> 8 & 255]));\n    } else if (c <= 16777216) {\n      L += 4;\n      out.push(new Uint8Array([248, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255]));\n    } else if (c <= 4294967296) {\n      L += 5;\n      out.push(new Uint8Array([252, c - 1 & 255, c - 1 >> 8 & 255, c - 1 >> 16 & 255, c - 1 >>> 24 & 255]));\n    }\n    out.push(buf.slice(l, l + c));\n    L += c;\n    frame[0] = 0;\n    frame[1] = L & 255;\n    frame[2] = L >> 8 & 255;\n    frame[3] = L >> 16 & 255;\n    l += c;\n  }\n  return u8concat(out);\n}\nfunction parse_old_storage(buf, sst, rsst, v) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(4, true);\n  var data_offset = (v > 1 ? 12 : 8) + popcnt(flags & (v > 1 ? 3470 : 398)) * 4;\n  var ridx = -1, sidx = -1, ieee = NaN, dt = new Date(2001, 0, 1);\n  if (flags & 512) {\n    ridx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n  data_offset += popcnt(flags & (v > 1 ? 12288 : 4096)) * 4;\n  if (flags & 16) {\n    sidx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n  if (flags & 32) {\n    ieee = dv.getFloat64(data_offset, true);\n    data_offset += 8;\n  }\n  if (flags & 64) {\n    dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n    data_offset += 8;\n  }\n  var ret;\n  switch (buf[2]) {\n    case 0:\n      break;\n    case 2:\n      ret = { t: \"n\", v: ieee };\n      break;\n    case 3:\n      ret = { t: \"s\", v: sst[sidx] };\n      break;\n    case 5:\n      ret = { t: \"d\", v: dt };\n      break;\n    case 6:\n      ret = { t: \"b\", v: ieee > 0 };\n      break;\n    case 7:\n      ret = { t: \"n\", v: ieee / 86400 };\n      break;\n    case 8:\n      ret = { t: \"e\", v: 0 };\n      break;\n    case 9:\n      {\n        if (ridx > -1)\n          ret = { t: \"s\", v: rsst[ridx] };\n        else if (sidx > -1)\n          ret = { t: \"s\", v: sst[sidx] };\n        else if (!isNaN(ieee))\n          ret = { t: \"n\", v: ieee };\n        else\n          throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n      }\n      break;\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf.slice(0, 4)));\n  }\n  return ret;\n}\nfunction parse_new_storage(buf, sst, rsst) {\n  var dv = u8_to_dataview(buf);\n  var flags = dv.getUint32(8, true);\n  var data_offset = 12;\n  var ridx = -1, sidx = -1, d128 = NaN, ieee = NaN, dt = new Date(2001, 0, 1);\n  if (flags & 1) {\n    d128 = readDecimal128LE(buf, data_offset);\n    data_offset += 16;\n  }\n  if (flags & 2) {\n    ieee = dv.getFloat64(data_offset, true);\n    data_offset += 8;\n  }\n  if (flags & 4) {\n    dt.setTime(dt.getTime() + dv.getFloat64(data_offset, true) * 1e3);\n    data_offset += 8;\n  }\n  if (flags & 8) {\n    sidx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n  if (flags & 16) {\n    ridx = dv.getUint32(data_offset, true);\n    data_offset += 4;\n  }\n  var ret;\n  switch (buf[1]) {\n    case 0:\n      break;\n    case 2:\n      ret = { t: \"n\", v: d128 };\n      break;\n    case 3:\n      ret = { t: \"s\", v: sst[sidx] };\n      break;\n    case 5:\n      ret = { t: \"d\", v: dt };\n      break;\n    case 6:\n      ret = { t: \"b\", v: ieee > 0 };\n      break;\n    case 7:\n      ret = { t: \"n\", v: ieee / 86400 };\n      break;\n    case 8:\n      ret = { t: \"e\", v: 0 };\n      break;\n    case 9:\n      {\n        if (ridx > -1)\n          ret = { t: \"s\", v: rsst[ridx] };\n        else\n          throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n      }\n      break;\n    case 10:\n      ret = { t: \"n\", v: d128 };\n      break;\n    default:\n      throw new Error(\"Unsupported cell type \".concat(buf[1], \" : \").concat(flags & 31, \" : \").concat(buf.slice(0, 4)));\n  }\n  return ret;\n}\nfunction write_new_storage(cell, sst) {\n  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, flags = 0;\n  out[0] = 5;\n  switch (cell.t) {\n    case \"n\":\n      out[1] = 2;\n      writeDecimal128LE(out, l, cell.v);\n      flags |= 1;\n      l += 16;\n      break;\n    case \"b\":\n      out[1] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      flags |= 2;\n      l += 8;\n      break;\n    case \"s\":\n      if (sst.indexOf(cell.v) == -1)\n        throw new Error(\"Value \".concat(cell.v, \" missing from SST!\"));\n      out[1] = 3;\n      dv.setUint32(l, sst.indexOf(cell.v), true);\n      flags |= 8;\n      l += 4;\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  dv.setUint32(8, flags, true);\n  return out.slice(0, l);\n}\nfunction write_old_storage(cell, sst) {\n  var out = new Uint8Array(32), dv = u8_to_dataview(out), l = 12, flags = 0;\n  out[0] = 3;\n  switch (cell.t) {\n    case \"n\":\n      out[2] = 2;\n      dv.setFloat64(l, cell.v, true);\n      flags |= 32;\n      l += 8;\n      break;\n    case \"b\":\n      out[2] = 6;\n      dv.setFloat64(l, cell.v ? 1 : 0, true);\n      flags |= 32;\n      l += 8;\n      break;\n    case \"s\":\n      if (sst.indexOf(cell.v) == -1)\n        throw new Error(\"Value \".concat(cell.v, \" missing from SST!\"));\n      out[2] = 3;\n      dv.setUint32(l, sst.indexOf(cell.v), true);\n      flags |= 16;\n      l += 4;\n      break;\n    default:\n      throw \"unsupported cell type \" + cell.t;\n  }\n  dv.setUint32(4, flags, true);\n  return out.slice(0, l);\n}\nfunction parse_cell_storage(buf, sst, rsst) {\n  switch (buf[0]) {\n    case 0:\n    case 1:\n    case 2:\n    case 3:\n      return parse_old_storage(buf, sst, rsst, buf[0]);\n    case 5:\n      return parse_new_storage(buf, sst, rsst);\n    default:\n      throw new Error(\"Unsupported payload version \".concat(buf[0]));\n  }\n}\nfunction parse_TSP_Reference(buf) {\n  var pb = parse_shallow(buf);\n  return parse_varint49(pb[1][0].data);\n}\nfunction write_TSP_Reference(idx) {\n  var out = [];\n  out[1] = [{ type: 0, data: write_varint49(idx) }];\n  return write_shallow(out);\n}\nfunction parse_TST_TableDataList(M, root) {\n  var pb = parse_shallow(root.data);\n  var type = varint_to_i32(pb[1][0].data);\n  var entries = pb[3];\n  var data = [];\n  (entries || []).forEach(function(entry) {\n    var le = parse_shallow(entry.data);\n    var key = varint_to_i32(le[1][0].data) >>> 0;\n    switch (type) {\n      case 1:\n        data[key] = u8str(le[3][0].data);\n        break;\n      case 8:\n        {\n          var rt = M[parse_TSP_Reference(le[9][0].data)][0];\n          var rtp = parse_shallow(rt.data);\n          var rtpref = M[parse_TSP_Reference(rtp[1][0].data)][0];\n          var mtype = varint_to_i32(rtpref.meta[1][0].data);\n          if (mtype != 2001)\n            throw new Error(\"2000 unexpected reference to \".concat(mtype));\n          var tswpsa = parse_shallow(rtpref.data);\n          data[key] = tswpsa[3].map(function(x) {\n            return u8str(x.data);\n          }).join(\"\");\n        }\n        break;\n    }\n  });\n  return data;\n}\nfunction parse_TST_TileRowInfo(u8, type) {\n  var _a, _b, _c, _d, _e, _f, _g, _h, _i, _j, _k, _l, _m, _n;\n  var pb = parse_shallow(u8);\n  var R = varint_to_i32(pb[1][0].data) >>> 0;\n  var cnt = varint_to_i32(pb[2][0].data) >>> 0;\n  var wide_offsets = ((_b = (_a = pb[8]) == null ? void 0 : _a[0]) == null ? void 0 : _b.data) && varint_to_i32(pb[8][0].data) > 0 || false;\n  var used_storage_u8, used_storage;\n  if (((_d = (_c = pb[7]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && type != 0) {\n    used_storage_u8 = (_f = (_e = pb[7]) == null ? void 0 : _e[0]) == null ? void 0 : _f.data;\n    used_storage = (_h = (_g = pb[6]) == null ? void 0 : _g[0]) == null ? void 0 : _h.data;\n  } else if (((_j = (_i = pb[4]) == null ? void 0 : _i[0]) == null ? void 0 : _j.data) && type != 1) {\n    used_storage_u8 = (_l = (_k = pb[4]) == null ? void 0 : _k[0]) == null ? void 0 : _l.data;\n    used_storage = (_n = (_m = pb[3]) == null ? void 0 : _m[0]) == null ? void 0 : _n.data;\n  } else\n    throw \"NUMBERS Tile missing \".concat(type, \" cell storage\");\n  var width = wide_offsets ? 4 : 1;\n  var used_storage_offsets = u8_to_dataview(used_storage_u8);\n  var offsets = [];\n  for (var C = 0; C < used_storage_u8.length / 2; ++C) {\n    var off = used_storage_offsets.getUint16(C * 2, true);\n    if (off < 65535)\n      offsets.push([C, off]);\n  }\n  if (offsets.length != cnt)\n    throw \"Expected \".concat(cnt, \" cells, found \").concat(offsets.length);\n  var cells = [];\n  for (C = 0; C < offsets.length - 1; ++C)\n    cells[offsets[C][0]] = used_storage.subarray(offsets[C][1] * width, offsets[C + 1][1] * width);\n  if (offsets.length >= 1)\n    cells[offsets[offsets.length - 1][0]] = used_storage.subarray(offsets[offsets.length - 1][1] * width);\n  return { R: R, cells: cells };\n}\nfunction parse_TST_Tile(M, root) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var storage = ((_a = pb == null ? void 0 : pb[7]) == null ? void 0 : _a[0]) ? varint_to_i32(pb[7][0].data) >>> 0 > 0 ? 1 : 0 : -1;\n  var ri = mappa(pb[5], function(u8) {\n    return parse_TST_TileRowInfo(u8, storage);\n  });\n  return {\n    nrows: varint_to_i32(pb[4][0].data) >>> 0,\n    data: ri.reduce(function(acc, x) {\n      if (!acc[x.R])\n        acc[x.R] = [];\n      x.cells.forEach(function(cell, C) {\n        if (acc[x.R][C])\n          throw new Error(\"Duplicate cell r=\".concat(x.R, \" c=\").concat(C));\n        acc[x.R][C] = cell;\n      });\n      return acc;\n    }, [])\n  };\n}\nfunction parse_TST_TableModelArchive(M, root, ws) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var range = { s: { r: 0, c: 0 }, e: { r: 0, c: 0 } };\n  range.e.r = (varint_to_i32(pb[6][0].data) >>> 0) - 1;\n  if (range.e.r < 0)\n    throw new Error(\"Invalid row varint \".concat(pb[6][0].data));\n  range.e.c = (varint_to_i32(pb[7][0].data) >>> 0) - 1;\n  if (range.e.c < 0)\n    throw new Error(\"Invalid col varint \".concat(pb[7][0].data));\n  ws[\"!ref\"] = encode_range(range);\n  var store = parse_shallow(pb[4][0].data);\n  var sst = parse_TST_TableDataList(M, M[parse_TSP_Reference(store[4][0].data)][0]);\n  var rsst = ((_a = store[17]) == null ? void 0 : _a[0]) ? parse_TST_TableDataList(M, M[parse_TSP_Reference(store[17][0].data)][0]) : [];\n  var tile = parse_shallow(store[3][0].data);\n  var _R = 0;\n  tile[1].forEach(function(t) {\n    var tl = parse_shallow(t.data);\n    var ref = M[parse_TSP_Reference(tl[2][0].data)][0];\n    var mtype = varint_to_i32(ref.meta[1][0].data);\n    if (mtype != 6002)\n      throw new Error(\"6001 unexpected reference to \".concat(mtype));\n    var _tile = parse_TST_Tile(M, ref);\n    _tile.data.forEach(function(row, R) {\n      row.forEach(function(buf, C) {\n        var addr = encode_cell({ r: _R + R, c: C });\n        var res = parse_cell_storage(buf, sst, rsst);\n        if (res)\n          ws[addr] = res;\n      });\n    });\n    _R += _tile.nrows;\n  });\n}\nfunction parse_TST_TableInfoArchive(M, root) {\n  var pb = parse_shallow(root.data);\n  var out = { \"!ref\": \"A1\" };\n  var tableref = M[parse_TSP_Reference(pb[2][0].data)];\n  var mtype = varint_to_i32(tableref[0].meta[1][0].data);\n  if (mtype != 6001)\n    throw new Error(\"6000 unexpected reference to \".concat(mtype));\n  parse_TST_TableModelArchive(M, tableref[0], out);\n  return out;\n}\nfunction parse_TN_SheetArchive(M, root) {\n  var _a;\n  var pb = parse_shallow(root.data);\n  var out = {\n    name: ((_a = pb[1]) == null ? void 0 : _a[0]) ? u8str(pb[1][0].data) : \"\",\n    sheets: []\n  };\n  var shapeoffs = mappa(pb[2], parse_TSP_Reference);\n  shapeoffs.forEach(function(off) {\n    M[off].forEach(function(m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 6e3)\n        out.sheets.push(parse_TST_TableInfoArchive(M, m));\n    });\n  });\n  return out;\n}\nfunction parse_TN_DocumentArchive(M, root) {\n  var out = book_new();\n  var pb = parse_shallow(root.data);\n  var sheetoffs = mappa(pb[1], parse_TSP_Reference);\n  sheetoffs.forEach(function(off) {\n    M[off].forEach(function(m) {\n      var mtype = varint_to_i32(m.meta[1][0].data);\n      if (mtype == 2) {\n        var root2 = parse_TN_SheetArchive(M, m);\n        root2.sheets.forEach(function(sheet, idx) {\n          book_append_sheet(out, sheet, idx == 0 ? root2.name : root2.name + \"_\" + idx, true);\n        });\n      }\n    });\n  });\n  if (out.SheetNames.length == 0)\n    throw new Error(\"Empty NUMBERS file\");\n  return out;\n}\nfunction parse_numbers_iwa(cfb) {\n  var _a, _b, _c, _d;\n  var M = {}, indices = [];\n  cfb.FullPaths.forEach(function(p) {\n    if (p.match(/\\.iwpv2/))\n      throw new Error(\"Unsupported password protection\");\n  });\n  cfb.FileIndex.forEach(function(s) {\n    if (!s.name.match(/\\.iwa$/))\n      return;\n    var o;\n    try {\n      o = decompress_iwa_file(s.content);\n    } catch (e) {\n      return console.log(\"?? \" + s.content.length + \" \" + (e.message || e));\n    }\n    var packets;\n    try {\n      packets = parse_iwa_file(o);\n    } catch (e) {\n      return console.log(\"## \" + (e.message || e));\n    }\n    packets.forEach(function(packet) {\n      M[packet.id] = packet.messages;\n      indices.push(packet.id);\n    });\n  });\n  if (!indices.length)\n    throw new Error(\"File has no messages\");\n  var docroot = ((_d = (_c = (_b = (_a = M == null ? void 0 : M[1]) == null ? void 0 : _a[0]) == null ? void 0 : _b.meta) == null ? void 0 : _c[1]) == null ? void 0 : _d[0].data) && varint_to_i32(M[1][0].meta[1][0].data) == 1 && M[1][0];\n  if (!docroot)\n    indices.forEach(function(idx) {\n      M[idx].forEach(function(iwam) {\n        var mtype = varint_to_i32(iwam.meta[1][0].data) >>> 0;\n        if (mtype == 1) {\n          if (!docroot)\n            docroot = iwam;\n          else\n            throw new Error(\"Document has multiple roots\");\n        }\n      });\n    });\n  if (!docroot)\n    throw new Error(\"Cannot find Document root\");\n  return parse_TN_DocumentArchive(M, docroot);\n}\nfunction write_tile_row(tri, data, SST) {\n  var _a, _b, _c, _d;\n  if (!((_a = tri[6]) == null ? void 0 : _a[0]) || !((_b = tri[7]) == null ? void 0 : _b[0]))\n    throw \"Mutation only works on post-BNC storages!\";\n  var wide_offsets = ((_d = (_c = tri[8]) == null ? void 0 : _c[0]) == null ? void 0 : _d.data) && varint_to_i32(tri[8][0].data) > 0 || false;\n  if (wide_offsets)\n    throw \"Math only works with normal offsets\";\n  var cnt = 0;\n  var dv = u8_to_dataview(tri[7][0].data), last_offset = 0, cell_storage = [];\n  var _dv = u8_to_dataview(tri[4][0].data), _last_offset = 0, _cell_storage = [];\n  for (var C = 0; C < data.length; ++C) {\n    if (data[C] == null) {\n      dv.setUint16(C * 2, 65535, true);\n      _dv.setUint16(C * 2, 65535);\n      continue;\n    }\n    dv.setUint16(C * 2, last_offset, true);\n    _dv.setUint16(C * 2, _last_offset, true);\n    var celload, _celload;\n    switch (typeof data[C]) {\n      case \"string\":\n        celload = write_new_storage({ t: \"s\", v: data[C] }, SST);\n        _celload = write_old_storage({ t: \"s\", v: data[C] }, SST);\n        break;\n      case \"number\":\n        celload = write_new_storage({ t: \"n\", v: data[C] }, SST);\n        _celload = write_old_storage({ t: \"n\", v: data[C] }, SST);\n        break;\n      case \"boolean\":\n        celload = write_new_storage({ t: \"b\", v: data[C] }, SST);\n        _celload = write_old_storage({ t: \"b\", v: data[C] }, SST);\n        break;\n      default:\n        throw new Error(\"Unsupported value \" + data[C]);\n    }\n    cell_storage.push(celload);\n    last_offset += celload.length;\n    _cell_storage.push(_celload);\n    _last_offset += _celload.length;\n    ++cnt;\n  }\n  tri[2][0].data = write_varint49(cnt);\n  for (; C < tri[7][0].data.length / 2; ++C) {\n    dv.setUint16(C * 2, 65535, true);\n    _dv.setUint16(C * 2, 65535, true);\n  }\n  tri[6][0].data = u8concat(cell_storage);\n  tri[3][0].data = u8concat(_cell_storage);\n  return cnt;\n}\nfunction write_numbers_iwa(wb, opts) {\n  if (!opts || !opts.numbers)\n    throw new Error(\"Must pass a `numbers` option -- check the README\");\n  var ws = wb.Sheets[wb.SheetNames[0]];\n  if (wb.SheetNames.length > 1)\n    console.error(\"The Numbers writer currently writes only the first table\");\n  var range = decode_range(ws[\"!ref\"]);\n  range.s.r = range.s.c = 0;\n  var trunc = false;\n  if (range.e.c > 9) {\n    trunc = true;\n    range.e.c = 9;\n  }\n  if (range.e.r > 49) {\n    trunc = true;\n    range.e.r = 49;\n  }\n  if (trunc)\n    console.error(\"The Numbers writer is currently limited to \".concat(encode_range(range)));\n  var data = sheet_to_json(ws, { range: range, header: 1 });\n  var SST = [\"~Sh33tJ5~\"];\n  data.forEach(function(row) {\n    return row.forEach(function(cell) {\n      if (typeof cell == \"string\")\n        SST.push(cell);\n    });\n  });\n  var dependents = {};\n  var indices = [];\n  var cfb = CFB.read(opts.numbers, { type: \"base64\" });\n  cfb.FileIndex.map(function(fi, idx) {\n    return [fi, cfb.FullPaths[idx]];\n  }).forEach(function(row) {\n    var fi = row[0], fp = row[1];\n    if (fi.type != 2)\n      return;\n    if (!fi.name.match(/\\.iwa/))\n      return;\n    var old_content = fi.content;\n    var raw1 = decompress_iwa_file(old_content);\n    var x2 = parse_iwa_file(raw1);\n    x2.forEach(function(packet2) {\n      indices.push(packet2.id);\n      dependents[packet2.id] = { deps: [], location: fp, type: varint_to_i32(packet2.messages[0].meta[1][0].data) };\n    });\n  });\n  indices.sort(function(x2, y2) {\n    return x2 - y2;\n  });\n  var indices_varint = indices.filter(function(x2) {\n    return x2 > 1;\n  }).map(function(x2) {\n    return [x2, write_varint49(x2)];\n  });\n  cfb.FileIndex.map(function(fi, idx) {\n    return [fi, cfb.FullPaths[idx]];\n  }).forEach(function(row) {\n    var fi = row[0], fp = row[1];\n    if (!fi.name.match(/\\.iwa/))\n      return;\n    var x2 = parse_iwa_file(decompress_iwa_file(fi.content));\n    x2.forEach(function(ia) {\n      ia.messages.forEach(function(m) {\n        indices_varint.forEach(function(ivi) {\n          if (ia.messages.some(function(mess) {\n            return varint_to_i32(mess.meta[1][0].data) != 11006 && u8contains(mess.data, ivi[1]);\n          })) {\n            dependents[ivi[0]].deps.push(ia.id);\n          }\n        });\n      });\n    });\n  });\n  function get_unique_msgid() {\n    for (var i = 927262; i < 2e6; ++i)\n      if (!dependents[i])\n        return i;\n    throw new Error(\"Too many messages\");\n  }\n  var entry = CFB.find(cfb, dependents[1].location);\n  var x = parse_iwa_file(decompress_iwa_file(entry.content));\n  var docroot;\n  for (var xi = 0; xi < x.length; ++xi) {\n    var packet = x[xi];\n    if (packet.id == 1)\n      docroot = packet;\n  }\n  var sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[1][0].data);\n  entry = CFB.find(cfb, dependents[sheetrootref].location);\n  x = parse_iwa_file(decompress_iwa_file(entry.content));\n  for (xi = 0; xi < x.length; ++xi) {\n    packet = x[xi];\n    if (packet.id == sheetrootref)\n      docroot = packet;\n  }\n  sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);\n  entry = CFB.find(cfb, dependents[sheetrootref].location);\n  x = parse_iwa_file(decompress_iwa_file(entry.content));\n  for (xi = 0; xi < x.length; ++xi) {\n    packet = x[xi];\n    if (packet.id == sheetrootref)\n      docroot = packet;\n  }\n  sheetrootref = parse_TSP_Reference(parse_shallow(docroot.messages[0].data)[2][0].data);\n  entry = CFB.find(cfb, dependents[sheetrootref].location);\n  x = parse_iwa_file(decompress_iwa_file(entry.content));\n  for (xi = 0; xi < x.length; ++xi) {\n    packet = x[xi];\n    if (packet.id == sheetrootref)\n      docroot = packet;\n  }\n  var pb = parse_shallow(docroot.messages[0].data);\n  {\n    pb[6][0].data = write_varint49(range.e.r + 1);\n    pb[7][0].data = write_varint49(range.e.c + 1);\n    var cruidsref = parse_TSP_Reference(pb[46][0].data);\n    var oldbucket = CFB.find(cfb, dependents[cruidsref].location);\n    var _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n    {\n      for (var j = 0; j < _x.length; ++j) {\n        if (_x[j].id == cruidsref)\n          break;\n      }\n      if (_x[j].id != cruidsref)\n        throw \"Bad ColumnRowUIDMapArchive\";\n      var cruids = parse_shallow(_x[j].messages[0].data);\n      cruids[1] = [];\n      cruids[2] = [], cruids[3] = [];\n      for (var C = 0; C <= range.e.c; ++C) {\n        var uuid = [];\n        uuid[1] = uuid[2] = [{ type: 0, data: write_varint49(C + 420690) }];\n        cruids[1].push({ type: 2, data: write_shallow(uuid) });\n        cruids[2].push({ type: 0, data: write_varint49(C) });\n        cruids[3].push({ type: 0, data: write_varint49(C) });\n      }\n      cruids[4] = [];\n      cruids[5] = [], cruids[6] = [];\n      for (var R = 0; R <= range.e.r; ++R) {\n        uuid = [];\n        uuid[1] = uuid[2] = [{ type: 0, data: write_varint49(R + 726270) }];\n        cruids[4].push({ type: 2, data: write_shallow(uuid) });\n        cruids[5].push({ type: 0, data: write_varint49(R) });\n        cruids[6].push({ type: 0, data: write_varint49(R) });\n      }\n      _x[j].messages[0].data = write_shallow(cruids);\n    }\n    oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n    oldbucket.size = oldbucket.content.length;\n    delete pb[46];\n    var store = parse_shallow(pb[4][0].data);\n    {\n      store[7][0].data = write_varint49(range.e.r + 1);\n      var row_headers = parse_shallow(store[1][0].data);\n      var row_header_ref = parse_TSP_Reference(row_headers[2][0].data);\n      oldbucket = CFB.find(cfb, dependents[row_header_ref].location);\n      _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n      {\n        if (_x[0].id != row_header_ref)\n          throw \"Bad HeaderStorageBucket\";\n        var base_bucket = parse_shallow(_x[0].messages[0].data);\n        for (R = 0; R < data.length; ++R) {\n          var _bucket = parse_shallow(base_bucket[2][0].data);\n          _bucket[1][0].data = write_varint49(R);\n          _bucket[4][0].data = write_varint49(data[R].length);\n          base_bucket[2][R] = { type: base_bucket[2][0].type, data: write_shallow(_bucket) };\n        }\n        _x[0].messages[0].data = write_shallow(base_bucket);\n      }\n      oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n      oldbucket.size = oldbucket.content.length;\n      var col_header_ref = parse_TSP_Reference(store[2][0].data);\n      oldbucket = CFB.find(cfb, dependents[col_header_ref].location);\n      _x = parse_iwa_file(decompress_iwa_file(oldbucket.content));\n      {\n        if (_x[0].id != col_header_ref)\n          throw \"Bad HeaderStorageBucket\";\n        base_bucket = parse_shallow(_x[0].messages[0].data);\n        for (C = 0; C <= range.e.c; ++C) {\n          _bucket = parse_shallow(base_bucket[2][0].data);\n          _bucket[1][0].data = write_varint49(C);\n          _bucket[4][0].data = write_varint49(range.e.r + 1);\n          base_bucket[2][C] = { type: base_bucket[2][0].type, data: write_shallow(_bucket) };\n        }\n        _x[0].messages[0].data = write_shallow(base_bucket);\n      }\n      oldbucket.content = compress_iwa_file(write_iwa_file(_x));\n      oldbucket.size = oldbucket.content.length;\n      var sstref = parse_TSP_Reference(store[4][0].data);\n      (function() {\n        var sentry = CFB.find(cfb, dependents[sstref].location);\n        var sx = parse_iwa_file(decompress_iwa_file(sentry.content));\n        var sstroot;\n        for (var sxi = 0; sxi < sx.length; ++sxi) {\n          var packet2 = sx[sxi];\n          if (packet2.id == sstref)\n            sstroot = packet2;\n        }\n        var sstdata = parse_shallow(sstroot.messages[0].data);\n        {\n          sstdata[3] = [];\n          var newsst = [];\n          SST.forEach(function(str, i) {\n            newsst[1] = [{ type: 0, data: write_varint49(i) }];\n            newsst[2] = [{ type: 0, data: write_varint49(1) }];\n            newsst[3] = [{ type: 2, data: stru8(str) }];\n            sstdata[3].push({ type: 2, data: write_shallow(newsst) });\n          });\n        }\n        sstroot.messages[0].data = write_shallow(sstdata);\n        var sy = write_iwa_file(sx);\n        var raw32 = compress_iwa_file(sy);\n        sentry.content = raw32;\n        sentry.size = sentry.content.length;\n      })();\n      var tile = parse_shallow(store[3][0].data);\n      {\n        var t = tile[1][0];\n        delete tile[2];\n        var tl = parse_shallow(t.data);\n        {\n          var tileref = parse_TSP_Reference(tl[2][0].data);\n          (function() {\n            var tentry = CFB.find(cfb, dependents[tileref].location);\n            var tx = parse_iwa_file(decompress_iwa_file(tentry.content));\n            var tileroot;\n            for (var sxi = 0; sxi < tx.length; ++sxi) {\n              var packet2 = tx[sxi];\n              if (packet2.id == tileref)\n                tileroot = packet2;\n            }\n            var tiledata = parse_shallow(tileroot.messages[0].data);\n            {\n              delete tiledata[6];\n              delete tile[7];\n              var rowload = new Uint8Array(tiledata[5][0].data);\n              tiledata[5] = [];\n              var cnt = 0;\n              for (var R2 = 0; R2 <= range.e.r; ++R2) {\n                var tilerow = parse_shallow(rowload);\n                cnt += write_tile_row(tilerow, data[R2], SST);\n                tilerow[1][0].data = write_varint49(R2);\n                tiledata[5].push({ data: write_shallow(tilerow), type: 2 });\n              }\n              tiledata[1] = [{ type: 0, data: write_varint49(range.e.c + 1) }];\n              tiledata[2] = [{ type: 0, data: write_varint49(range.e.r + 1) }];\n              tiledata[3] = [{ type: 0, data: write_varint49(cnt) }];\n              tiledata[4] = [{ type: 0, data: write_varint49(range.e.r + 1) }];\n            }\n            tileroot.messages[0].data = write_shallow(tiledata);\n            var ty = write_iwa_file(tx);\n            var raw32 = compress_iwa_file(ty);\n            tentry.content = raw32;\n            tentry.size = tentry.content.length;\n          })();\n        }\n        t.data = write_shallow(tl);\n      }\n      store[3][0].data = write_shallow(tile);\n    }\n    pb[4][0].data = write_shallow(store);\n  }\n  docroot.messages[0].data = write_shallow(pb);\n  var y = write_iwa_file(x);\n  var raw3 = compress_iwa_file(y);\n  entry.content = raw3;\n  entry.size = entry.content.length;\n  return cfb;\n}\nfunction fix_opts_func(defaults/*:Array<Array<any> >*/)/*:{(o:any):void}*/ {\n\treturn function fix_opts(opts) {\n\t\tfor(var i = 0; i != defaults.length; ++i) {\n\t\t\tvar d = defaults[i];\n\t\t\tif(opts[d[0]] === undefined) opts[d[0]] = d[1];\n\t\t\tif(d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n\t\t}\n\t};\n}\n\nfunction fix_read_opts(opts) {\nfix_opts_func([\n\t['cellNF', false], /* emit cell number format string as .z */\n\t['cellHTML', true], /* emit html string as .h */\n\t['cellFormula', true], /* emit formulae as .f */\n\t['cellStyles', false], /* emits style/theme as .s */\n\t['cellText', true], /* emit formatted text as .w */\n\t['cellDates', false], /* emit date cells with type `d` */\n\n\t['sheetStubs', false], /* emit empty cells */\n\t['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\n\n\t['bookDeps', false], /* parse calculation chains */\n\t['bookSheets', false], /* only try to get sheet names (no Sheets) */\n\t['bookProps', false], /* only try to get properties (no Sheets) */\n\t['bookFiles', false], /* include raw file structure (keys, files, cfb) */\n\t['bookVBA', false], /* include vba raw data (vbaraw) */\n\n\t['password',''], /* password */\n\t['WTF', false] /* WTF mode (throws errors) */\n])(opts);\n}\n\nfunction fix_write_opts(opts) {\nfix_opts_func([\n\t['cellDates', false], /* write date cells with type `d` */\n\n\t['bookSST', false], /* Generate Shared String Table */\n\n\t['bookType', 'xlsx'], /* Type of workbook (xlsx/m/b) */\n\n\t['compression', false], /* Use file compression */\n\n\t['WTF', false] /* WTF mode (throws errors) */\n])(opts);\n}\nfunction get_sheet_type(n/*:string*/)/*:string*/ {\n\tif(RELS.WS.indexOf(n) > -1) return \"sheet\";\n\tif(RELS.CS && n == RELS.CS) return \"chart\";\n\tif(RELS.DS && n == RELS.DS) return \"dialog\";\n\tif(RELS.MS && n == RELS.MS) return \"macro\";\n\treturn (n && n.length) ? n : \"sheet\";\n}\nfunction safe_parse_wbrels(wbrels, sheets) {\n\tif(!wbrels) return 0;\n\ttry {\n\t\twbrels = sheets.map(function pwbr(w) { if(!w.id) w.id = w.strRelID; return [w.name, wbrels['!id'][w.id].Target, get_sheet_type(wbrels['!id'][w.id].Type)]; });\n\t} catch(e) { return null; }\n\treturn !wbrels || wbrels.length === 0 ? null : wbrels;\n}\n\nfunction safe_parse_sheet(zip, path/*:string*/, relsPath/*:string*/, sheet, idx/*:number*/, sheetRels, sheets, stype/*:string*/, opts, wb, themes, styles) {\n\ttry {\n\t\tsheetRels[sheet]=parse_rels(getzipstr(zip, relsPath, true), path);\n\t\tvar data = getzipdata(zip, path);\n\t\tvar _ws;\n\t\tswitch(stype) {\n\t\t\tcase 'sheet':  _ws = parse_ws(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tcase 'chart':  _ws = parse_cs(data, path, idx, opts, sheetRels[sheet], wb, themes, styles);\n\t\t\t\tif(!_ws || !_ws['!drawel']) break;\n\t\t\t\tvar dfile = resolve_path(_ws['!drawel'].Target, path);\n\t\t\t\tvar drelsp = get_rels_path(dfile);\n\t\t\t\tvar draw = parse_drawing(getzipstr(zip, dfile, true), parse_rels(getzipstr(zip, drelsp, true), dfile));\n\t\t\t\tvar chartp = resolve_path(draw, dfile);\n\t\t\t\tvar crelsp = get_rels_path(chartp);\n\t\t\t\t_ws = parse_chart(getzipstr(zip, chartp, true), chartp, opts, parse_rels(getzipstr(zip, crelsp, true), chartp), wb, _ws);\n\t\t\t\tbreak;\n\t\t\tcase 'macro':  _ws = parse_ms(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tcase 'dialog': _ws = parse_ds(data, path, idx, opts, sheetRels[sheet], wb, themes, styles); break;\n\t\t\tdefault: throw new Error(\"Unrecognized sheet type \" + stype);\n\t\t}\n\t\tsheets[sheet] = _ws;\n\n\t\t/* scan rels for comments and threaded comments */\n\t\tvar tcomments = [];\n\t\tif(sheetRels && sheetRels[sheet]) keys(sheetRels[sheet]).forEach(function(n) {\n\t\t\tvar dfile = \"\";\n\t\t\tif(sheetRels[sheet][n].Type == RELS.CMNT) {\n\t\t\t\tdfile = resolve_path(sheetRels[sheet][n].Target, path);\n\t\t\t\tvar comments = parse_cmnt(getzipdata(zip, dfile, true), dfile, opts);\n\t\t\t\tif(!comments || !comments.length) return;\n\t\t\t\tsheet_insert_comments(_ws, comments, false);\n\t\t\t}\n\t\t\tif(sheetRels[sheet][n].Type == RELS.TCMNT) {\n\t\t\t\tdfile = resolve_path(sheetRels[sheet][n].Target, path);\n\t\t\t\ttcomments = tcomments.concat(parse_tcmnt_xml(getzipdata(zip, dfile, true), opts));\n\t\t\t}\n\t\t});\n\t\tif(tcomments && tcomments.length) sheet_insert_comments(_ws, tcomments, true, opts.people || []);\n\t} catch(e) { if(opts.WTF) throw e; }\n}\n\nfunction strip_front_slash(x/*:string*/)/*:string*/ { return x.charAt(0) == '/' ? x.slice(1) : x; }\n\nfunction parse_zip(zip/*:ZIP*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tmake_ssf();\n\topts = opts || {};\n\tfix_read_opts(opts);\n\n\t/* OpenDocument Part 3 Section 2.2.1 OpenDocument Package */\n\tif(safegetzipfile(zip, 'META-INF/manifest.xml')) return parse_ods(zip, opts);\n\t/* UOC */\n\tif(safegetzipfile(zip, 'objectdata.xml')) return parse_ods(zip, opts);\n\t/* Numbers */\n\tif(safegetzipfile(zip, 'Index/Document.iwa')) {\n\t\tif(typeof Uint8Array == \"undefined\") throw new Error('NUMBERS file parsing requires Uint8Array support');\n\t\tif(typeof parse_numbers_iwa != \"undefined\") {\n\t\t\tif(zip.FileIndex) return parse_numbers_iwa(zip);\n\t\t\tvar _zip = CFB.utils.cfb_new();\n\t\t\tzipentries(zip).forEach(function(e) { zip_add_file(_zip, e, getzipbin(zip, e)); });\n\t\t\treturn parse_numbers_iwa(_zip);\n\t\t}\n\t\tthrow new Error('Unsupported NUMBERS file');\n\t}\n\tif(!safegetzipfile(zip, '[Content_Types].xml')) {\n\t\tif(safegetzipfile(zip, 'index.xml.gz')) throw new Error('Unsupported NUMBERS 08 file');\n\t\tif(safegetzipfile(zip, 'index.xml')) throw new Error('Unsupported NUMBERS 09 file');\n\t\tthrow new Error('Unsupported ZIP file');\n\t}\n\n\tvar entries = zipentries(zip);\n\tvar dir = parse_ct((getzipstr(zip, '[Content_Types].xml')/*:?any*/));\n\tvar xlsb = false;\n\tvar sheets, binname;\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.xml\";\n\t\tif(getzipdata(zip,binname, true)) dir.workbooks.push(binname);\n\t}\n\tif(dir.workbooks.length === 0) {\n\t\tbinname = \"xl/workbook.bin\";\n\t\tif(!getzipdata(zip,binname,true)) throw new Error(\"Could not find workbook\");\n\t\tdir.workbooks.push(binname);\n\t\txlsb = true;\n\t}\n\tif(dir.workbooks[0].slice(-3) == \"bin\") xlsb = true;\n\n\tvar themes = ({}/*:any*/);\n\tvar styles = ({}/*:any*/);\n\tif(!opts.bookSheets && !opts.bookProps) {\n\t\tstrs = [];\n\t\tif(dir.sst) try { strs=parse_sst(getzipdata(zip, strip_front_slash(dir.sst)), dir.sst, opts); } catch(e) { if(opts.WTF) throw e; }\n\n\t\tif(opts.cellStyles && dir.themes.length) themes = parse_theme(getzipstr(zip, dir.themes[0].replace(/^\\//,''), true)||\"\",dir.themes[0], opts);\n\n\t\tif(dir.style) styles = parse_sty(getzipdata(zip, strip_front_slash(dir.style)), dir.style, themes, opts);\n\t}\n\n\t/*var externbooks = */dir.links.map(function(link) {\n\t\ttry {\n\t\t\tvar rels = parse_rels(getzipstr(zip, get_rels_path(strip_front_slash(link))), link);\n\t\t\treturn parse_xlink(getzipdata(zip, strip_front_slash(link)), rels, link, opts);\n\t\t} catch(e) {}\n\t});\n\n\tvar wb = parse_wb(getzipdata(zip, strip_front_slash(dir.workbooks[0])), dir.workbooks[0], opts);\n\n\tvar props = {}, propdata = \"\";\n\n\tif(dir.coreprops.length) {\n\t\tpropdata = getzipdata(zip, strip_front_slash(dir.coreprops[0]), true);\n\t\tif(propdata) props = parse_core_props(propdata);\n\t\tif(dir.extprops.length !== 0) {\n\t\t\tpropdata = getzipdata(zip, strip_front_slash(dir.extprops[0]), true);\n\t\t\tif(propdata) parse_ext_props(propdata, props, opts);\n\t\t}\n\t}\n\n\tvar custprops = {};\n\tif(!opts.bookSheets || opts.bookProps) {\n\t\tif (dir.custprops.length !== 0) {\n\t\t\tpropdata = getzipstr(zip, strip_front_slash(dir.custprops[0]), true);\n\t\t\tif(propdata) custprops = parse_cust_props(propdata, opts);\n\t\t}\n\t}\n\n\tvar out = ({}/*:any*/);\n\tif(opts.bookSheets || opts.bookProps) {\n\t\tif(wb.Sheets) sheets = wb.Sheets.map(function pluck(x){ return x.name; });\n\t\telse if(props.Worksheets && props.SheetNames.length > 0) sheets=props.SheetNames;\n\t\tif(opts.bookProps) { out.Props = props; out.Custprops = custprops; }\n\t\tif(opts.bookSheets && typeof sheets !== 'undefined') out.SheetNames = sheets;\n\t\tif(opts.bookSheets ? out.SheetNames : opts.bookProps) return out;\n\t}\n\tsheets = {};\n\n\tvar deps = {};\n\tif(opts.bookDeps && dir.calcchain) deps=parse_cc(getzipdata(zip, strip_front_slash(dir.calcchain)),dir.calcchain,opts);\n\n\tvar i=0;\n\tvar sheetRels = ({}/*:any*/);\n\tvar path, relsPath;\n\n\t{\n\t\tvar wbsheets = wb.Sheets;\n\t\tprops.Worksheets = wbsheets.length;\n\t\tprops.SheetNames = [];\n\t\tfor(var j = 0; j != wbsheets.length; ++j) {\n\t\t\tprops.SheetNames[j] = wbsheets[j].name;\n\t\t}\n\t}\n\n\tvar wbext = xlsb ? \"bin\" : \"xml\";\n\tvar wbrelsi = dir.workbooks[0].lastIndexOf(\"/\");\n\tvar wbrelsfile = (dir.workbooks[0].slice(0, wbrelsi+1) + \"_rels/\" + dir.workbooks[0].slice(wbrelsi+1) + \".rels\").replace(/^\\//,\"\");\n\tif(!safegetzipfile(zip, wbrelsfile)) wbrelsfile = 'xl/_rels/workbook.' + wbext + '.rels';\n\tvar wbrels = parse_rels(getzipstr(zip, wbrelsfile, true), wbrelsfile.replace(/_rels.*/, \"s5s\"));\n\n\tif((dir.metadata || []).length >= 1) {\n\t\t/* TODO: MDX and other types of metadata */\n\t\topts.xlmeta = parse_xlmeta(getzipdata(zip, strip_front_slash(dir.metadata[0])),dir.metadata[0],opts);\n\t}\n\n\tif((dir.people || []).length >= 1) {\n\t\topts.people = parse_people_xml(getzipdata(zip, strip_front_slash(dir.people[0])),opts);\n\t}\n\n\tif(wbrels) wbrels = safe_parse_wbrels(wbrels, wb.Sheets);\n\n\t/* Numbers iOS hack */\n\tvar nmode = (getzipdata(zip,\"xl/worksheets/sheet.xml\",true))?1:0;\n\twsloop: for(i = 0; i != props.Worksheets; ++i) {\n\t\tvar stype = \"sheet\";\n\t\tif(wbrels && wbrels[i]) {\n\t\t\tpath = 'xl/' + (wbrels[i][1]).replace(/[\\/]?xl\\//, \"\");\n\t\t\tif(!safegetzipfile(zip, path)) path = wbrels[i][1];\n\t\t\tif(!safegetzipfile(zip, path)) path = wbrelsfile.replace(/_rels\\/.*$/,\"\") + wbrels[i][1];\n\t\t\tstype = wbrels[i][2];\n\t\t} else {\n\t\t\tpath = 'xl/worksheets/sheet'+(i+1-nmode)+\".\" + wbext;\n\t\t\tpath = path.replace(/sheet0\\./,\"sheet.\");\n\t\t}\n\t\trelsPath = path.replace(/^(.*)(\\/)([^\\/]*)$/, \"$1/_rels/$3.rels\");\n\t\tif(opts && opts.sheets != null) switch(typeof opts.sheets) {\n\t\t\tcase \"number\": if(i != opts.sheets) continue wsloop; break;\n\t\t\tcase \"string\": if(props.SheetNames[i].toLowerCase() != opts.sheets.toLowerCase()) continue wsloop; break;\n\t\t\tdefault: if(Array.isArray && Array.isArray(opts.sheets)) {\n\t\t\t\tvar snjseen = false;\n\t\t\t\tfor(var snj = 0; snj != opts.sheets.length; ++snj) {\n\t\t\t\t\tif(typeof opts.sheets[snj] == \"number\" && opts.sheets[snj] == i) snjseen=1;\n\t\t\t\t\tif(typeof opts.sheets[snj] == \"string\" && opts.sheets[snj].toLowerCase() == props.SheetNames[i].toLowerCase()) snjseen = 1;\n\t\t\t\t}\n\t\t\t\tif(!snjseen) continue wsloop;\n\t\t\t}\n\t\t}\n\t\tsafe_parse_sheet(zip, path, relsPath, props.SheetNames[i], i, sheetRels, sheets, stype, opts, wb, themes, styles);\n\t}\n\n\tout = ({\n\t\tDirectory: dir,\n\t\tWorkbook: wb,\n\t\tProps: props,\n\t\tCustprops: custprops,\n\t\tDeps: deps,\n\t\tSheets: sheets,\n\t\tSheetNames: props.SheetNames,\n\t\tStrings: strs,\n\t\tStyles: styles,\n\t\tThemes: themes,\n\t\tSSF: dup(table_fmt)\n\t}/*:any*/);\n\tif(opts && opts.bookFiles) {\n\t\tif(zip.files) {\n\t\t\tout.keys = entries;\n\t\t\tout.files = zip.files;\n\t\t} else {\n\t\t\tout.keys = [];\n\t\t\tout.files = {};\n\t\t\tzip.FullPaths.forEach(function(p, idx) {\n\t\t\t\tp = p.replace(/^Root Entry[\\/]/, \"\");\n\t\t\t\tout.keys.push(p);\n\t\t\t\tout.files[p] = zip.FileIndex[idx];\n\t\t\t});\n\t\t}\n\t}\n\tif(opts && opts.bookVBA) {\n\t\tif(dir.vba.length > 0) out.vbaraw = getzipdata(zip,strip_front_slash(dir.vba[0]),true);\n\t\telse if(dir.defaults && dir.defaults.bin === CT_VBA) out.vbaraw = getzipdata(zip, 'xl/vbaProject.bin',true);\n\t}\n\treturn out;\n}\n\n/* [MS-OFFCRYPTO] 2.1.1 */\nfunction parse_xlsxcfb(cfb, _opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tvar opts = _opts || {};\n\tvar f = 'Workbook', data = CFB.find(cfb, f);\n\ttry {\n\tf = '/!DataSpaces/Version';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\t/*var version = */parse_DataSpaceVersionInfo(data.content);\n\n\t/* 2.3.4.1 */\n\tf = '/!DataSpaces/DataSpaceMap';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar dsm = parse_DataSpaceMap(data.content);\n\tif(dsm.length !== 1 || dsm[0].comps.length !== 1 || dsm[0].comps[0].t !== 0 || dsm[0].name !== \"StrongEncryptionDataSpace\" || dsm[0].comps[0].v !== \"EncryptedPackage\")\n\t\tthrow new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n\t/* 2.3.4.2 */\n\tf = '/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar seds = parse_DataSpaceDefinition(data.content);\n\tif(seds.length != 1 || seds[0] != \"StrongEncryptionTransform\")\n\t\tthrow new Error(\"ECMA-376 Encrypted file bad \" + f);\n\n\t/* 2.3.4.3 */\n\tf = '/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\t/*var hdr = */parse_Primary(data.content);\n\t} catch(e) {}\n\n\tf = '/EncryptionInfo';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\tvar einfo = parse_EncryptionInfo(data.content);\n\n\t/* 2.3.4.4 */\n\tf = '/EncryptedPackage';\n\tdata = CFB.find(cfb, f); if(!data || !data.content) throw new Error(\"ECMA-376 Encrypted file missing \" + f);\n\n/*global decrypt_agile */\n/*:: declare var decrypt_agile:any; */\n\tif(einfo[0] == 0x04 && typeof decrypt_agile !== 'undefined') return decrypt_agile(einfo[1], data.content, opts.password || \"\", opts);\n/*global decrypt_std76 */\n/*:: declare var decrypt_std76:any; */\n\tif(einfo[0] == 0x02 && typeof decrypt_std76 !== 'undefined') return decrypt_std76(einfo[1], data.content, opts.password || \"\", opts);\n\tthrow new Error(\"File is password-protected\");\n}\n\nfunction write_zip(wb/*:Workbook*/, opts/*:WriteOpts*/)/*:ZIP*/ {\n\tif(opts.bookType == \"ods\") return write_ods(wb, opts);\n\tif(opts.bookType == \"numbers\") return write_numbers_iwa(wb, opts);\n\tif(opts.bookType == \"xlsb\") return write_zip_xlsxb(wb, opts);\n\treturn write_zip_xlsx(wb, opts);\n}\n\n/* XLSX and XLSB writing are very similar.  Originally they were unified in one\n   export function.  This is horrible for tree shaking in the common case (most\n   applications need to export files in one format) so this function supports\n   both formats while write_zip_xlsx only handles XLSX */\nfunction write_zip_xlsxb(wb/*:Workbook*/, opts/*:WriteOpts*/)/*:ZIP*/ {\n\t_shapeid = 1024;\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t}\n\topts.rels = {}; opts.wbrels = {};\n\topts.Strings = /*::((*/[]/*:: :any):SST)*/; opts.Strings.Count = 0; opts.Strings.Unique = 0;\n\tif(browser_has_Map) opts.revStrings = new Map();\n\telse { opts.revStrings = {}; opts.revStrings.foo = []; delete opts.revStrings.foo; }\n\tvar wbext = opts.bookType == \"xlsb\" ? \"bin\" : \"xml\";\n\tvar vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n\tvar ct = new_ct();\n\tfix_write_opts(opts = opts || {});\n\tvar zip = zip_new();\n\tvar f = \"\", rId = 0;\n\n\topts.cellXfs = [];\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tf = \"docProps/core.xml\";\n\tzip_add_file(zip, f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n\n\t/*::if(!wb.Props) throw \"unreachable\"; */\n\tf = \"docProps/app.xml\";\n\tif(wb.Props && wb.Props.SheetNames){/* empty */}\n\telse if(!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;\n\telse {\n\t\tvar _sn = [];\n\t\tfor(var _i = 0; _i < wb.SheetNames.length; ++_i)\n\t\t\tif((wb.Workbook.Sheets[_i]||{}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\t\twb.Props.SheetNames = _sn;\n\t}\n\twb.Props.Worksheets = wb.Props.SheetNames.length;\n\tzip_add_file(zip, f, write_ext_props(wb.Props, opts));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n\t}\n\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\n\t\tvar wsrels = {'!id':{}};\n\t\tvar ws = wb.Sheets[wb.SheetNames[rId-1]];\n\t\tvar _type = (ws || {})[\"!type\"] || \"sheet\";\n\t\tswitch(_type) {\n\t\tcase \"chart\":\n\t\t\t/* falls through */\n\t\tdefault:\n\t\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n\t\t\tzip_add_file(zip, f, write_ws(rId-1, f, opts, wb, wsrels));\n\t\t\tct.sheets.push(f);\n\t\t\tadd_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n\t\t}\n\n\t\tif(ws) {\n\t\t\tvar comments = ws['!comments'];\n\t\t\tvar need_vml = false;\n\t\t\tvar cf = \"\";\n\t\t\tif(comments && comments.length > 0) {\n\t\t\t\tcf = \"xl/comments\" + rId + \".\" + wbext;\n\t\t\t\tzip_add_file(zip, cf, write_cmnt(comments, cf, opts));\n\t\t\t\tct.comments.push(cf);\n\t\t\t\tadd_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n\t\t\t\tneed_vml = true;\n\t\t\t}\n\t\t\tif(ws['!legacy']) {\n\t\t\t\tif(need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + (rId) + \".vml\", write_comments_vml(rId, ws['!comments']));\n\t\t\t}\n\t\t\tdelete ws['!comments'];\n\t\t\tdelete ws['!legacy'];\n\t\t}\n\n\t\tif(wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n\t}\n\n\tif(opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.\" + wbext;\n\t\tzip_add_file(zip, f, write_sst(opts.Strings, f, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n\t}\n\n\tf = \"xl/workbook.\" + wbext;\n\tzip_add_file(zip, f, write_wb(wb, f, opts));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELS.WB);\n\n\t/* TODO: something more intelligent with themes */\n\n\tf = \"xl/theme/theme1.xml\";\n\tzip_add_file(zip, f, write_theme(wb.Themes, opts));\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n\t/* TODO: something more intelligent with styles */\n\n\tf = \"xl/styles.\" + wbext;\n\tzip_add_file(zip, f, write_sty(wb, f, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n\tif(wb.vbaraw && vbafmt) {\n\t\tf = \"xl/vbaProject.bin\";\n\t\tzip_add_file(zip, f, wb.vbaraw);\n\t\tct.vba.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n\t}\n\n\tf = \"xl/metadata.\" + wbext;\n\tzip_add_file(zip, f, write_xlmeta(f));\n\tct.metadata.push(f);\n\tadd_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n\n\tzip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n\tzip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n\tzip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n\n\tdelete opts.revssf; delete opts.ssf;\n\treturn zip;\n}\n\nfunction write_zip_xlsx(wb/*:Workbook*/, opts/*:WriteOpts*/)/*:ZIP*/ {\n\t_shapeid = 1024;\n\tif(wb && !wb.SSF) {\n\t\twb.SSF = dup(table_fmt);\n\t}\n\tif(wb && wb.SSF) {\n\t\tmake_ssf(); SSF_load_table(wb.SSF);\n\t\t// $FlowIgnore\n\t\topts.revssf = evert_num(wb.SSF); opts.revssf[wb.SSF[65535]] = 0;\n\t\topts.ssf = wb.SSF;\n\t}\n\topts.rels = {}; opts.wbrels = {};\n\topts.Strings = /*::((*/[]/*:: :any):SST)*/; opts.Strings.Count = 0; opts.Strings.Unique = 0;\n\tif(browser_has_Map) opts.revStrings = new Map();\n\telse { opts.revStrings = {}; opts.revStrings.foo = []; delete opts.revStrings.foo; }\n\tvar wbext = \"xml\";\n\tvar vbafmt = VBAFMTS.indexOf(opts.bookType) > -1;\n\tvar ct = new_ct();\n\tfix_write_opts(opts = opts || {});\n\tvar zip = zip_new();\n\tvar f = \"\", rId = 0;\n\n\topts.cellXfs = [];\n\tget_cell_style(opts.cellXfs, {}, {revssf:{\"General\":0}});\n\n\tif(!wb.Props) wb.Props = {};\n\n\tf = \"docProps/core.xml\";\n\tzip_add_file(zip, f, write_core_props(wb.Props, opts));\n\tct.coreprops.push(f);\n\tadd_rels(opts.rels, 2, f, RELS.CORE_PROPS);\n\n\t/*::if(!wb.Props) throw \"unreachable\"; */\n\tf = \"docProps/app.xml\";\n\tif(wb.Props && wb.Props.SheetNames){/* empty */}\n\telse if(!wb.Workbook || !wb.Workbook.Sheets) wb.Props.SheetNames = wb.SheetNames;\n\telse {\n\t\tvar _sn = [];\n\t\tfor(var _i = 0; _i < wb.SheetNames.length; ++_i)\n\t\t\tif((wb.Workbook.Sheets[_i]||{}).Hidden != 2) _sn.push(wb.SheetNames[_i]);\n\t\twb.Props.SheetNames = _sn;\n\t}\n\twb.Props.Worksheets = wb.Props.SheetNames.length;\n\tzip_add_file(zip, f, write_ext_props(wb.Props, opts));\n\tct.extprops.push(f);\n\tadd_rels(opts.rels, 3, f, RELS.EXT_PROPS);\n\n\tif(wb.Custprops !== wb.Props && keys(wb.Custprops||{}).length > 0) {\n\t\tf = \"docProps/custom.xml\";\n\t\tzip_add_file(zip, f, write_cust_props(wb.Custprops, opts));\n\t\tct.custprops.push(f);\n\t\tadd_rels(opts.rels, 4, f, RELS.CUST_PROPS);\n\t}\n\n\tvar people = [\"SheetJ5\"];\n\topts.tcid = 0;\n\n\tfor(rId=1;rId <= wb.SheetNames.length; ++rId) {\n\t\tvar wsrels = {'!id':{}};\n\t\tvar ws = wb.Sheets[wb.SheetNames[rId-1]];\n\t\tvar _type = (ws || {})[\"!type\"] || \"sheet\";\n\t\tswitch(_type) {\n\t\tcase \"chart\":\n\t\t\t/* falls through */\n\t\tdefault:\n\t\t\tf = \"xl/worksheets/sheet\" + rId + \".\" + wbext;\n\t\t\tzip_add_file(zip, f, write_ws_xml(rId-1, opts, wb, wsrels));\n\t\t\tct.sheets.push(f);\n\t\t\tadd_rels(opts.wbrels, -1, \"worksheets/sheet\" + rId + \".\" + wbext, RELS.WS[0]);\n\t\t}\n\n\t\tif(ws) {\n\t\t\tvar comments = ws['!comments'];\n\t\t\tvar need_vml = false;\n\t\t\tvar cf = \"\";\n\t\t\tif(comments && comments.length > 0) {\n\t\t\t\tvar needtc = false;\n\t\t\t\tcomments.forEach(function(carr) {\n\t\t\t\t\tcarr[1].forEach(function(c) { if(c.T == true) needtc = true; });\n\t\t\t\t});\n\t\t\t\tif(needtc) {\n\t\t\t\t\tcf = \"xl/threadedComments/threadedComment\" + rId + \".\" + wbext;\n\t\t\t\t\tzip_add_file(zip, cf, write_tcmnt_xml(comments, people, opts));\n\t\t\t\t\tct.threadedcomments.push(cf);\n\t\t\t\t\tadd_rels(wsrels, -1, \"../threadedComments/threadedComment\" + rId + \".\" + wbext, RELS.TCMNT);\n\t\t\t\t}\n\n\t\t\t\tcf = \"xl/comments\" + rId + \".\" + wbext;\n\t\t\t\tzip_add_file(zip, cf, write_comments_xml(comments, opts));\n\t\t\t\tct.comments.push(cf);\n\t\t\t\tadd_rels(wsrels, -1, \"../comments\" + rId + \".\" + wbext, RELS.CMNT);\n\t\t\t\tneed_vml = true;\n\t\t\t}\n\t\t\tif(ws['!legacy']) {\n\t\t\t\tif(need_vml) zip_add_file(zip, \"xl/drawings/vmlDrawing\" + (rId) + \".vml\", write_comments_vml(rId, ws['!comments']));\n\t\t\t}\n\t\t\tdelete ws['!comments'];\n\t\t\tdelete ws['!legacy'];\n\t\t}\n\n\t\tif(wsrels['!id'].rId1) zip_add_file(zip, get_rels_path(f), write_rels(wsrels));\n\t}\n\n\tif(opts.Strings != null && opts.Strings.length > 0) {\n\t\tf = \"xl/sharedStrings.\" + wbext;\n\t\tzip_add_file(zip, f, write_sst_xml(opts.Strings, opts));\n\t\tct.strs.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"sharedStrings.\" + wbext, RELS.SST);\n\t}\n\n\tf = \"xl/workbook.\" + wbext;\n\tzip_add_file(zip, f, write_wb_xml(wb, opts));\n\tct.workbooks.push(f);\n\tadd_rels(opts.rels, 1, f, RELS.WB);\n\n\t/* TODO: something more intelligent with themes */\n\n\tf = \"xl/theme/theme1.xml\";\n\tzip_add_file(zip, f, write_theme(wb.Themes, opts));\n\tct.themes.push(f);\n\tadd_rels(opts.wbrels, -1, \"theme/theme1.xml\", RELS.THEME);\n\n\t/* TODO: something more intelligent with styles */\n\n\tf = \"xl/styles.\" + wbext;\n\tzip_add_file(zip, f, write_sty_xml(wb, opts));\n\tct.styles.push(f);\n\tadd_rels(opts.wbrels, -1, \"styles.\" + wbext, RELS.STY);\n\n\tif(wb.vbaraw && vbafmt) {\n\t\tf = \"xl/vbaProject.bin\";\n\t\tzip_add_file(zip, f, wb.vbaraw);\n\t\tct.vba.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"vbaProject.bin\", RELS.VBA);\n\t}\n\n\tf = \"xl/metadata.\" + wbext;\n\tzip_add_file(zip, f, write_xlmeta_xml());\n\tct.metadata.push(f);\n\tadd_rels(opts.wbrels, -1, \"metadata.\" + wbext, RELS.XLMETA);\n\n\tif(people.length > 1) {\n\t\tf = \"xl/persons/person.xml\";\n\t\tzip_add_file(zip, f, write_people_xml(people, opts));\n\t\tct.people.push(f);\n\t\tadd_rels(opts.wbrels, -1, \"persons/person.xml\", RELS.PEOPLE);\n\t}\n\n\tzip_add_file(zip, \"[Content_Types].xml\", write_ct(ct, opts));\n\tzip_add_file(zip, '_rels/.rels', write_rels(opts.rels));\n\tzip_add_file(zip, 'xl/_rels/workbook.' + wbext + '.rels', write_rels(opts.wbrels));\n\n\tdelete opts.revssf; delete opts.ssf;\n\treturn zip;\n}\n\nfunction firstbyte(f/*:RawData*/,o/*:?TypeOpts*/)/*:Array<number>*/ {\n\tvar x = \"\";\n\tswitch((o||{}).type || \"base64\") {\n\t\tcase 'buffer': return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\t\tcase 'base64': x = Base64_decode(f.slice(0,12)); break;\n\t\tcase 'binary': x = f; break;\n\t\tcase 'array':  return [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7]];\n\t\tdefault: throw new Error(\"Unrecognized type \" + (o && o.type || \"undefined\"));\n\t}\n\treturn [x.charCodeAt(0), x.charCodeAt(1), x.charCodeAt(2), x.charCodeAt(3), x.charCodeAt(4), x.charCodeAt(5), x.charCodeAt(6), x.charCodeAt(7)];\n}\n\nfunction read_cfb(cfb/*:CFBContainer*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tif(CFB.find(cfb, \"EncryptedPackage\")) return parse_xlsxcfb(cfb, opts);\n\treturn parse_xlscfb(cfb, opts);\n}\n\nfunction read_zip(data/*:RawData*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tvar zip, d = data;\n\tvar o = opts||{};\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tzip = zip_read(d, o);\n\treturn parse_zip(zip, o);\n}\n\nfunction read_plaintext(data/*:string*/, o/*:ParseOpts*/)/*:Workbook*/ {\n\tvar i = 0;\n\tmain: while(i < data.length) switch(data.charCodeAt(i)) {\n\t\tcase 0x0A: case 0x0D: case 0x20: ++i; break;\n\t\tcase 0x3C: return parse_xlml(data.slice(i),o);\n\t\tdefault: break main;\n\t}\n\treturn PRN.to_workbook(data, o);\n}\n\nfunction read_plaintext_raw(data/*:RawData*/, o/*:ParseOpts*/)/*:Workbook*/ {\n\tvar str = \"\", bytes = firstbyte(data, o);\n\tswitch(o.type) {\n\t\tcase 'base64': str = Base64_decode(data); break;\n\t\tcase 'binary': str = data; break;\n\t\tcase 'buffer': str = data.toString('binary'); break;\n\t\tcase 'array': str = cc2str(data); break;\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\tif(bytes[0] == 0xEF && bytes[1] == 0xBB && bytes[2] == 0xBF) str = utf8read(str);\n\to.type = \"binary\";\n\treturn read_plaintext(str, o);\n}\n\nfunction read_utf16(data/*:RawData*/, o/*:ParseOpts*/)/*:Workbook*/ {\n\tvar d = data;\n\tif(o.type == 'base64') d = Base64_decode(d);\n\td = $cptable.utils.decode(1200, d.slice(2), 'str');\n\to.type = \"binary\";\n\treturn read_plaintext(d, o);\n}\n\nfunction bstrify(data/*:string*/)/*:string*/ {\n\treturn !data.match(/[^\\x00-\\x7F]/) ? data : utf8write(data);\n}\n\nfunction read_prn(data, d, o, str) {\n\tif(str) { o.type = \"string\"; return PRN.to_workbook(data, o); }\n\treturn PRN.to_workbook(d, o);\n}\n\nfunction readSync(data/*:RawData*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\treset_cp();\n\tvar o = opts||{};\n\tif(typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) return readSync(new Uint8Array(data), (o = dup(o), o.type = \"array\", o));\n\tif(typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && !o.type) o.type = typeof Deno !== \"undefined\" ? \"buffer\" : \"array\";\n\tvar d = data, n = [0,0,0,0], str = false;\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\t_ssfopts = {};\n\tif(o.dateNF) _ssfopts.dateNF = o.dateNF;\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(data)) ? \"buffer\" : \"base64\";\n\tif(o.type == \"file\") { o.type = has_buf ? \"buffer\" : \"binary\"; d = read_binary(data); if(typeof Uint8Array !== 'undefined' && !has_buf) o.type = \"array\"; }\n\tif(o.type == \"string\") { str = true; o.type = \"binary\"; o.codepage = 65001; d = bstrify(data); }\n\tif(o.type == 'array' && typeof Uint8Array !== 'undefined' && data instanceof Uint8Array && typeof ArrayBuffer !== 'undefined') {\n\t\t// $FlowIgnore\n\t\tvar ab=new ArrayBuffer(3), vu=new Uint8Array(ab); vu.foo=\"bar\";\n\t\t// $FlowIgnore\n\t\tif(!vu.foo) {o=dup(o); o.type='array'; return readSync(ab2a(d), o);}\n\t}\n\tswitch((n = firstbyte(d, o))[0]) {\n\t\tcase 0xD0: if(n[1] === 0xCF && n[2] === 0x11 && n[3] === 0xE0 && n[4] === 0xA1 && n[5] === 0xB1 && n[6] === 0x1A && n[7] === 0xE1) return read_cfb(CFB.read(d, o), o); break;\n\t\tcase 0x09: if(n[1] <= 0x08) return parse_xlscfb(d, o); break;\n\t\tcase 0x3C: return parse_xlml(d, o);\n\t\tcase 0x49:\n\t\t\tif(n[1] === 0x49 && n[2] === 0x2a && n[3] === 0x00) throw new Error(\"TIFF Image File is not a spreadsheet\");\n\t\t\tif(n[1] === 0x44) return read_wb_ID(d, o);\n\t\t\tbreak;\n\t\tcase 0x54: if(n[1] === 0x41 && n[2] === 0x42 && n[3] === 0x4C) return DIF.to_workbook(d, o); break;\n\t\tcase 0x50: return (n[1] === 0x4B && n[2] < 0x09 && n[3] < 0x09) ? read_zip(d, o) : read_prn(data, d, o, str);\n\t\tcase 0xEF: return n[3] === 0x3C ? parse_xlml(d, o) : read_prn(data, d, o, str);\n\t\tcase 0xFF:\n\t\t\tif(n[1] === 0xFE) { return read_utf16(d, o); }\n\t\t\telse if(n[1] === 0x00 && n[2] === 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\t\t\tbreak;\n\t\tcase 0x00:\n\t\t\tif(n[1] === 0x00) {\n\t\t\t\tif(n[2] >= 0x02 && n[3] === 0x00) return WK_.to_workbook(d, o);\n\t\t\t\tif(n[2] === 0x00 && (n[3] === 0x08 || n[3] === 0x09)) return WK_.to_workbook(d, o);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 0x03: case 0x83: case 0x8B: case 0x8C: return DBF.to_workbook(d, o);\n\t\tcase 0x7B: if(n[1] === 0x5C && n[2] === 0x72 && n[3] === 0x74) return RTF.to_workbook(d, o); break;\n\t\tcase 0x0A: case 0x0D: case 0x20: return read_plaintext_raw(d, o);\n\t\tcase 0x89: if(n[1] === 0x50 && n[2] === 0x4E && n[3] === 0x47) throw new Error(\"PNG Image File is not a spreadsheet\"); break;\n\t}\n\tif(DBF_SUPPORTED_VERSIONS.indexOf(n[0]) > -1 && n[2] <= 12 && n[3] <= 31) return DBF.to_workbook(d, o);\n\treturn read_prn(data, d, o, str);\n}\n\nfunction readFileSync(filename/*:string*/, opts/*:?ParseOpts*/)/*:Workbook*/ {\n\tvar o = opts||{}; o.type = 'file';\n\treturn readSync(filename, o);\n}\nfunction write_cfb_ctr(cfb/*:CFBContainer*/, o/*:WriteOpts*/)/*:any*/ {\n\tswitch(o.type) {\n\t\tcase \"base64\": case \"binary\": break;\n\t\tcase \"buffer\": case \"array\": o.type = \"\"; break;\n\t\tcase \"file\": return write_dl(o.file, CFB.write(cfb, {type:has_buf ? 'buffer' : \"\"}));\n\t\tcase \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\treturn CFB.write(cfb, o);\n}\n\n/*:: declare var encrypt_agile:any; */\nfunction write_zip_type(wb/*:Workbook*/, opts/*:?WriteOpts*/)/*:any*/ {\n\tvar o = dup(opts||{});\n\tvar z = write_zip(wb, o);\n\treturn write_zip_denouement(z, o);\n}\nfunction write_zip_typeXLSX(wb/*:Workbook*/, opts/*:?WriteOpts*/)/*:any*/ {\n\tvar o = dup(opts||{});\n\tvar z = write_zip_xlsx(wb, o);\n\treturn write_zip_denouement(z, o);\n}\nfunction write_zip_denouement(z/*:any*/, o/*:?WriteOpts*/)/*:any*/ {\n\tvar oopts = {};\n\tvar ftype = has_buf ? \"nodebuffer\" : (typeof Uint8Array !== \"undefined\" ? \"array\" : \"string\");\n\tif(o.compression) oopts.compression = 'DEFLATE';\n\tif(o.password) oopts.type = ftype;\n\telse switch(o.type) {\n\t\tcase \"base64\": oopts.type = \"base64\"; break;\n\t\tcase \"binary\": oopts.type = \"string\"; break;\n\t\tcase \"string\": throw new Error(\"'string' output type invalid for '\" + o.bookType + \"' files\");\n\t\tcase \"buffer\":\n\t\tcase \"file\": oopts.type = ftype; break;\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n\tvar out = z.FullPaths ? CFB.write(z, {fileType:\"zip\", type: /*::(*/{\"nodebuffer\": \"buffer\", \"string\": \"binary\"}/*:: :any)*/[oopts.type] || oopts.type, compression: !!o.compression}) : z.generate(oopts);\n\tif(typeof Deno !== \"undefined\") {\n\t\tif(typeof out == \"string\") {\n\t\t\tif(o.type == \"binary\" || o.type == \"base64\") return out;\n\t\t\tout = new Uint8Array(s2ab(out));\n\t\t}\n\t}\n/*jshint -W083 */\n\tif(o.password && typeof encrypt_agile !== 'undefined') return write_cfb_ctr(encrypt_agile(out, o.password), o); // eslint-disable-line no-undef\n/*jshint +W083 */\n\tif(o.type === \"file\") return write_dl(o.file, out);\n\treturn o.type == \"string\" ? utf8read(/*::(*/out/*:: :any)*/) : out;\n}\n\nfunction write_cfb_type(wb/*:Workbook*/, opts/*:?WriteOpts*/)/*:any*/ {\n\tvar o = opts||{};\n\tvar cfb/*:CFBContainer*/ = write_xlscfb(wb, o);\n\treturn write_cfb_ctr(cfb, o);\n}\n\nfunction write_string_type(out/*:string*/, opts/*:WriteOpts*/, bom/*:?string*/)/*:any*/ {\n\tif(!bom) bom = \"\";\n\tvar o = bom + out;\n\tswitch(opts.type) {\n\t\tcase \"base64\": return Base64_encode(utf8write(o));\n\t\tcase \"binary\": return utf8write(o);\n\t\tcase \"string\": return out;\n\t\tcase \"file\": return write_dl(opts.file, o, 'utf8');\n\t\tcase \"buffer\": {\n\t\t\tif(has_buf) return Buffer_from(o, 'utf8');\n\t\t\telse if(typeof TextEncoder !== \"undefined\") return new TextEncoder().encode(o);\n\t\t\telse return write_string_type(o, {type:'binary'}).split(\"\").map(function(c) { return c.charCodeAt(0); });\n\t\t}\n\t}\n\tthrow new Error(\"Unrecognized type \" + opts.type);\n}\n\nfunction write_stxt_type(out/*:string*/, opts/*:WriteOpts*/)/*:any*/ {\n\tswitch(opts.type) {\n\t\tcase \"base64\": return Base64_encode(out);\n\t\tcase \"binary\": return out;\n\t\tcase \"string\": return out; /* override in sheet_to_txt */\n\t\tcase \"file\": return write_dl(opts.file, out, 'binary');\n\t\tcase \"buffer\": {\n\t\t\tif(has_buf) return Buffer_from(out, 'binary');\n\t\t\telse return out.split(\"\").map(function(c) { return c.charCodeAt(0); });\n\t\t}\n\t}\n\tthrow new Error(\"Unrecognized type \" + opts.type);\n}\n\n/* TODO: test consistency */\nfunction write_binary_type(out, opts/*:WriteOpts*/)/*:any*/ {\n\tswitch(opts.type) {\n\t\tcase \"string\":\n\t\tcase \"base64\":\n\t\tcase \"binary\":\n\t\t\tvar bstr = \"\";\n\t\t\t// $FlowIgnore\n\t\t\tfor(var i = 0; i < out.length; ++i) bstr += String.fromCharCode(out[i]);\n\t\t\treturn opts.type == 'base64' ? Base64_encode(bstr) : opts.type == 'string' ? utf8read(bstr) : bstr;\n\t\tcase \"file\": return write_dl(opts.file, out);\n\t\tcase \"buffer\": return out;\n\t\tdefault: throw new Error(\"Unrecognized type \" + opts.type);\n\t}\n}\n\nfunction writeSyncXLSX(wb/*:Workbook*/, opts/*:?WriteOpts*/) {\n\treset_cp();\n\tcheck_wb(wb);\n\tvar o = dup(opts||{});\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\tif(o.type == \"array\") { o.type = \"binary\"; var out/*:string*/ = (writeSyncXLSX(wb, o)/*:any*/); o.type = \"array\"; return s2ab(out); }\n\treturn write_zip_typeXLSX(wb, o);\n}\n\nfunction writeSync(wb/*:Workbook*/, opts/*:?WriteOpts*/) {\n\treset_cp();\n\tcheck_wb(wb);\n\tvar o = dup(opts||{});\n\tif(o.cellStyles) { o.cellNF = true; o.sheetStubs = true; }\n\tif(o.type == \"array\") { o.type = \"binary\"; var out/*:string*/ = (writeSync(wb, o)/*:any*/); o.type = \"array\"; return s2ab(out); }\n\tvar idx = 0;\n\tif(o.sheet) {\n\t\tif(typeof o.sheet == \"number\") idx = o.sheet;\n\t\telse idx = wb.SheetNames.indexOf(o.sheet);\n\t\tif(!wb.SheetNames[idx]) throw new Error(\"Sheet not found: \" + o.sheet + \" : \" + (typeof o.sheet));\n\t}\n\tswitch(o.bookType || 'xlsb') {\n\t\tcase 'xml':\n\t\tcase 'xlml': return write_string_type(write_xlml(wb, o), o);\n\t\tcase 'slk':\n\t\tcase 'sylk': return write_string_type(SYLK.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'htm':\n\t\tcase 'html': return write_string_type(sheet_to_html(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'txt': return write_stxt_type(sheet_to_txt(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'csv': return write_string_type(sheet_to_csv(wb.Sheets[wb.SheetNames[idx]], o), o, \"\\ufeff\");\n\t\tcase 'dif': return write_string_type(DIF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'dbf': return write_binary_type(DBF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'prn': return write_string_type(PRN.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'rtf': return write_string_type(RTF.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'eth': return write_string_type(ETH.from_sheet(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'fods': return write_string_type(write_ods(wb, o), o);\n\t\tcase 'wk1': return write_binary_type(WK_.sheet_to_wk1(wb.Sheets[wb.SheetNames[idx]], o), o);\n\t\tcase 'wk3': return write_binary_type(WK_.book_to_wk3(wb, o), o);\n\t\tcase 'biff2': if(!o.biff) o.biff = 2; /* falls through */\n\t\tcase 'biff3': if(!o.biff) o.biff = 3; /* falls through */\n\t\tcase 'biff4': if(!o.biff) o.biff = 4; return write_binary_type(write_biff_buf(wb, o), o);\n\t\tcase 'biff5': if(!o.biff) o.biff = 5; /* falls through */\n\t\tcase 'biff8':\n\t\tcase 'xla':\n\t\tcase 'xls': if(!o.biff) o.biff = 8; return write_cfb_type(wb, o);\n\t\tcase 'xlsx':\n\t\tcase 'xlsm':\n\t\tcase 'xlam':\n\t\tcase 'xlsb':\n\t\tcase 'numbers':\n\t\tcase 'ods': return write_zip_type(wb, o);\n\t\tdefault: throw new Error (\"Unrecognized bookType |\" + o.bookType + \"|\");\n\t}\n}\n\nfunction resolve_book_type(o/*:WriteFileOpts*/) {\n\tif(o.bookType) return;\n\tvar _BT = {\n\t\t\"xls\": \"biff8\",\n\t\t\"htm\": \"html\",\n\t\t\"slk\": \"sylk\",\n\t\t\"socialcalc\": \"eth\",\n\t\t\"Sh33tJS\": \"WTF\"\n\t};\n\tvar ext = o.file.slice(o.file.lastIndexOf(\".\")).toLowerCase();\n\tif(ext.match(/^\\.[a-z]+$/)) o.bookType = ext.slice(1);\n\to.bookType = _BT[o.bookType] || o.bookType;\n}\n\nfunction writeFileSync(wb/*:Workbook*/, filename/*:string*/, opts/*:?WriteFileOpts*/) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\treturn writeSync(wb, o);\n}\n\nfunction writeFileSyncXLSX(wb/*:Workbook*/, filename/*:string*/, opts/*:?WriteFileOpts*/) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\treturn writeSyncXLSX(wb, o);\n}\n\n\nfunction writeFileAsync(filename/*:string*/, wb/*:Workbook*/, opts/*:?WriteFileOpts*/, cb/*:?(e?:ErrnoError)=>void*/) {\n\tvar o = opts||{}; o.type = 'file';\n\to.file = filename;\n\tresolve_book_type(o);\n\to.type = 'buffer';\n\tvar _cb = cb; if(!(_cb instanceof Function)) _cb = (opts/*:any*/);\n\treturn _fs.writeFile(filename, writeSync(wb, o), _cb);\n}\n/*::\ntype MJRObject = {\n\trow: any;\n\tisempty: boolean;\n};\n*/\nfunction make_json_row(sheet/*:Worksheet*/, r/*:Range*/, R/*:number*/, cols/*:Array<string>*/, header/*:number*/, hdr/*:Array<any>*/, dense/*:boolean*/, o/*:Sheet2JSONOpts*/)/*:MJRObject*/ {\n\tvar rr = encode_row(R);\n\tvar defval = o.defval, raw = o.raw || !Object.prototype.hasOwnProperty.call(o, \"raw\");\n\tvar isempty = true;\n\tvar row/*:any*/ = (header === 1) ? [] : {};\n\tif(header !== 1) {\n\t\tif(Object.defineProperty) try { Object.defineProperty(row, '__rowNum__', {value:R, enumerable:false}); } catch(e) { row.__rowNum__ = R; }\n\t\telse row.__rowNum__ = R;\n\t}\n\tif(!dense || sheet[R]) for (var C = r.s.c; C <= r.e.c; ++C) {\n\t\tvar val = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\t\tif(val === undefined || val.t === undefined) {\n\t\t\tif(defval === undefined) continue;\n\t\t\tif(hdr[C] != null) { row[hdr[C]] = defval; }\n\t\t\tcontinue;\n\t\t}\n\t\tvar v = val.v;\n\t\tswitch(val.t){\n\t\t\tcase 'z': if(v == null) break; continue;\n\t\t\tcase 'e': v = (v == 0 ? null : void 0); break;\n\t\t\tcase 's': case 'd': case 'b': case 'n': break;\n\t\t\tdefault: throw new Error('unrecognized type ' + val.t);\n\t\t}\n\t\tif(hdr[C] != null) {\n\t\t\tif(v == null) {\n\t\t\t\tif(val.t == \"e\" && v === null) row[hdr[C]] = null;\n\t\t\t\telse if(defval !== undefined) row[hdr[C]] = defval;\n\t\t\t\telse if(raw && v === null) row[hdr[C]] = null;\n\t\t\t\telse continue;\n\t\t\t} else {\n\t\t\t\trow[hdr[C]] = raw && (val.t !== \"n\" || (val.t === \"n\" && o.rawNumbers !== false)) ? v : format_cell(val,v,o);\n\t\t\t}\n\t\t\tif(v != null) isempty = false;\n\t\t}\n\t}\n\treturn { row: row, isempty: isempty };\n}\n\n\nfunction sheet_to_json(sheet/*:Worksheet*/, opts/*:?Sheet2JSONOpts*/) {\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\tvar val = {t:'n',v:0}, header = 0, offset = 1, hdr/*:Array<any>*/ = [], v=0, vv=\"\";\n\tvar r = {s:{r:0,c:0},e:{r:0,c:0}};\n\tvar o = opts || {};\n\tvar range = o.range != null ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\telse if(o.header == null) header = 0;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols/*:Array<string>*/ = [];\n\tvar out/*:Array<any>*/ = [];\n\tvar outi = 0, counter = 0;\n\tvar dense = Array.isArray(sheet);\n\tvar R = r.s.r, C = 0;\n\tvar header_cnt = {};\n\tif(dense && !sheet[R]) sheet[R] = [];\n\tvar colinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tif(((colinfo[C]||{}).hidden)) continue;\n\t\tcols[C] = encode_col(C);\n\t\tval = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C - r.s.c; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val == null) val = {w: \"__EMPTY\", t: \"s\"};\n\t\t\t\tvv = v = format_cell(val, null, o);\n\t\t\t\tcounter = header_cnt[v] || 0;\n\t\t\t\tif(!counter) header_cnt[v] = 1;\n\t\t\t\telse {\n\t\t\t\t\tdo { vv = v + \"_\" + (counter++); } while(header_cnt[vv]); header_cnt[v] = counter;\n\t\t\t\t\theader_cnt[vv] = 1;\n\t\t\t\t}\n\t\t\t\thdr[C] = vv;\n\t\t}\n\t}\n\tfor (R = r.s.r + offset; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R]||{}).hidden) continue;\n\t\tvar row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\n\t\tif((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) out[outi++] = row.row;\n\t}\n\tout.length = outi;\n\treturn out;\n}\n\nvar qreg = /\"/g;\nfunction make_csv_row(sheet/*:Worksheet*/, r/*:Range*/, R/*:number*/, cols/*:Array<string>*/, fs/*:number*/, rs/*:number*/, FS/*:string*/, o/*:Sheet2CSVOpts*/)/*:?string*/ {\n\tvar isempty = true;\n\tvar row/*:Array<string>*/ = [], txt = \"\", rr = encode_row(R);\n\tfor(var C = r.s.c; C <= r.e.c; ++C) {\n\t\tif (!cols[C]) continue;\n\t\tvar val = o.dense ? (sheet[R]||[])[C]: sheet[cols[C] + rr];\n\t\tif(val == null) txt = \"\";\n\t\telse if(val.v != null) {\n\t\t\tisempty = false;\n\t\t\ttxt = ''+(o.rawNumbers && val.t == \"n\" ? val.v : format_cell(val, null, o));\n\t\t\tfor(var i = 0, cc = 0; i !== txt.length; ++i) if((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34 || o.forceQuotes) {txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\"; break; }\n\t\t\tif(txt == \"ID\") txt = '\"ID\"';\n\t\t} else if(val.f != null && !val.F) {\n\t\t\tisempty = false;\n\t\t\ttxt = '=' + val.f; if(txt.indexOf(\",\") >= 0) txt = '\"' + txt.replace(qreg, '\"\"') + '\"';\n\t\t} else txt = \"\";\n\t\t/* NOTE: Excel CSV does not support array formulae */\n\t\trow.push(txt);\n\t}\n\tif(o.blankrows === false && isempty) return null;\n\treturn row.join(FS);\n}\n\nfunction sheet_to_csv(sheet/*:Worksheet*/, opts/*:?Sheet2CSVOpts*/)/*:string*/ {\n\tvar out/*:Array<string>*/ = [];\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) return \"\";\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar endregex = new RegExp((FS==\"|\" ? \"\\\\|\" : FS)+\"+$\");\n\tvar row = \"\", cols/*:Array<string>*/ = [];\n\to.dense = Array.isArray(sheet);\n\tvar colinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\n\tvar w = 0;\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\tif ((rowinfo[R]||{}).hidden) continue;\n\t\trow = make_csv_row(sheet, r, R, cols, fs, rs, FS, o);\n\t\tif(row == null) { continue; }\n\t\tif(o.strip) row = row.replace(endregex,\"\");\n\t\tif(row || (o.blankrows !== false)) out.push((w++ ? RS : \"\") + row);\n\t}\n\tdelete o.dense;\n\treturn out.join(\"\");\n}\n\nfunction sheet_to_txt(sheet/*:Worksheet*/, opts/*:?Sheet2CSVOpts*/) {\n\tif(!opts) opts = {}; opts.FS = \"\\t\"; opts.RS = \"\\n\";\n\tvar s = sheet_to_csv(sheet, opts);\n\tif(typeof $cptable == 'undefined' || opts.type == 'string') return s;\n\tvar o = $cptable.utils.encode(1200, s, 'str');\n\treturn String.fromCharCode(255) + String.fromCharCode(254) + o;\n}\n\nfunction sheet_to_formulae(sheet/*:Worksheet*/)/*:Array<string>*/ {\n\tvar y = \"\", x, val=\"\";\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\tvar r = safe_decode_range(sheet['!ref']), rr = \"\", cols/*:Array<string>*/ = [], C;\n\tvar cmds/*:Array<string>*/ = [];\n\tvar dense = Array.isArray(sheet);\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\ty = cols[C] + rr;\n\t\t\tx = dense ? (sheet[R]||[])[C] : sheet[y];\n\t\t\tval = \"\";\n\t\t\tif(x === undefined) continue;\n\t\t\telse if(x.F != null) {\n\t\t\t\ty = x.F;\n\t\t\t\tif(!x.f) continue;\n\t\t\t\tval = x.f;\n\t\t\t\tif(y.indexOf(\":\") == -1) y = y + \":\" + y;\n\t\t\t}\n\t\t\tif(x.f != null) val = x.f;\n\t\t\telse if(x.t == 'z') continue;\n\t\t\telse if(x.t == 'n' && x.v != null) val = \"\" + x.v;\n\t\t\telse if(x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";\n\t\t\telse if(x.w !== undefined) val = \"'\" + x.w;\n\t\t\telse if(x.v === undefined) continue;\n\t\t\telse if(x.t == 's') val = \"'\" + x.v;\n\t\t\telse val = \"\"+x.v;\n\t\t\tcmds[cmds.length] = y + \"=\" + val;\n\t\t}\n\t}\n\treturn cmds;\n}\n\nfunction sheet_add_json(_ws/*:?Worksheet*/, js/*:Array<any>*/, opts)/*:Worksheet*/ {\n\tvar o = opts || {};\n\tvar offset = +!o.skipHeader;\n\tvar ws/*:Worksheet*/ = _ws || ({}/*:any*/);\n\tvar _R = 0, _C = 0;\n\tif(ws && o.origin != null) {\n\t\tif(typeof o.origin == 'number') _R = o.origin;\n\t\telse {\n\t\t\tvar _origin/*:CellAddress*/ = typeof o.origin == \"string\" ? decode_cell(o.origin) : o.origin;\n\t\t\t_R = _origin.r; _C = _origin.c;\n\t\t}\n\t}\n\tvar cell/*:Cell*/;\n\tvar range/*:Range*/ = ({s: {c:0, r:0}, e: {c:_C, r:_R + js.length - 1 + offset}}/*:any*/);\n\tif(ws['!ref']) {\n\t\tvar _range = safe_decode_range(ws['!ref']);\n\t\trange.e.c = Math.max(range.e.c, _range.e.c);\n\t\trange.e.r = Math.max(range.e.r, _range.e.r);\n\t\tif(_R == -1) { _R = _range.e.r + 1; range.e.r = _R + js.length - 1 + offset; }\n\t} else {\n\t\tif(_R == -1) { _R = 0; range.e.r = js.length - 1 + offset; }\n\t}\n\tvar hdr/*:Array<string>*/ = o.header || [], C = 0;\n\n\tjs.forEach(function (JS, R/*:number*/) {\n\t\tkeys(JS).forEach(function(k) {\n\t\t\tif((C=hdr.indexOf(k)) == -1) hdr[C=hdr.length] = k;\n\t\t\tvar v = JS[k];\n\t\t\tvar t = 'z';\n\t\t\tvar z = \"\";\n\t\t\tvar ref = encode_cell({c:_C + C,r:_R + R + offset});\n\t\t\tcell = ws_get_cell_stub(ws, ref);\n\t\t\tif(v && typeof v === 'object' && !(v instanceof Date)){\n\t\t\t\tws[ref] = v;\n\t\t\t} else {\n\t\t\t\tif(typeof v == 'number') t = 'n';\n\t\t\t\telse if(typeof v == 'boolean') t = 'b';\n\t\t\t\telse if(typeof v == 'string') t = 's';\n\t\t\t\telse if(v instanceof Date) {\n\t\t\t\t\tt = 'd';\n\t\t\t\t\tif(!o.cellDates) { t = 'n'; v = datenum(v); }\n\t\t\t\t\tz = (o.dateNF || table_fmt[14]);\n\t\t\t\t}\n\t\t\t\telse if(v === null && o.nullError) { t = 'e'; v = 0; }\n\t\t\t\tif(!cell) ws[ref] = cell = ({t:t, v:v}/*:any*/);\n\t\t\t\telse {\n\t\t\t\t\tcell.t = t; cell.v = v;\n\t\t\t\t\tdelete cell.w; delete cell.R;\n\t\t\t\t\tif(z) cell.z = z;\n\t\t\t\t}\n\t\t\t\tif(z) cell.z = z;\n\t\t\t}\n\t\t});\n\t});\n\trange.e.c = Math.max(range.e.c, _C + hdr.length - 1);\n\tvar __R = encode_row(_R);\n\tif(offset) for(C = 0; C < hdr.length; ++C) ws[encode_col(C + _C) + __R] = {t:'s', v:hdr[C]};\n\tws['!ref'] = encode_range(range);\n\treturn ws;\n}\nfunction json_to_sheet(js/*:Array<any>*/, opts)/*:Worksheet*/ { return sheet_add_json(null, js, opts); }\n\n/* get cell, creating a stub if necessary */\nfunction ws_get_cell_stub(ws/*:Worksheet*/, R, C/*:?number*/)/*:Cell*/ {\n\t/* A1 cell address */\n\tif(typeof R == \"string\") {\n\t\t/* dense */\n\t\tif(Array.isArray(ws)) {\n\t\t\tvar RC = decode_cell(R);\n\t\t\tif(!ws[RC.r]) ws[RC.r] = [];\n\t\t\treturn ws[RC.r][RC.c] || (ws[RC.r][RC.c] = {t:'z'});\n\t\t}\n\t\treturn ws[R] || (ws[R] = {t:'z'});\n\t}\n\t/* cell address object */\n\tif(typeof R != \"number\") return ws_get_cell_stub(ws, encode_cell(R));\n\t/* R and C are 0-based indices */\n\treturn ws_get_cell_stub(ws, encode_cell({r:R,c:C||0}));\n}\n\n/* find sheet index for given name / validate index */\nfunction wb_sheet_idx(wb/*:Workbook*/, sh/*:number|string*/) {\n\tif(typeof sh == \"number\") {\n\t\tif(sh >= 0 && wb.SheetNames.length > sh) return sh;\n\t\tthrow new Error(\"Cannot find sheet # \" + sh);\n\t} else if(typeof sh == \"string\") {\n\t\tvar idx = wb.SheetNames.indexOf(sh);\n\t\tif(idx > -1) return idx;\n\t\tthrow new Error(\"Cannot find sheet name |\" + sh + \"|\");\n\t} else throw new Error(\"Cannot find sheet |\" + sh + \"|\");\n}\n\n/* simple blank workbook object */\nfunction book_new()/*:Workbook*/ {\n\treturn { SheetNames: [], Sheets: {} };\n}\n\n/* add a worksheet to the end of a given workbook */\nfunction book_append_sheet(wb/*:Workbook*/, ws/*:Worksheet*/, name/*:?string*/, roll/*:?boolean*/)/*:string*/ {\n\tvar i = 1;\n\tif(!name) for(; i <= 0xFFFF; ++i, name = undefined) if(wb.SheetNames.indexOf(name = \"Sheet\" + i) == -1) break;\n\tif(!name || wb.SheetNames.length >= 0xFFFF) throw new Error(\"Too many worksheets\");\n\tif(roll && wb.SheetNames.indexOf(name) >= 0) {\n\t\tvar m = name.match(/(^.*?)(\\d+)$/);\n\t\ti = m && +m[2] || 0;\n\t\tvar root = m && m[1] || name;\n\t\tfor(++i; i <= 0xFFFF; ++i) if(wb.SheetNames.indexOf(name = root + i) == -1) break;\n\t}\n\tcheck_ws_name(name);\n\tif(wb.SheetNames.indexOf(name) >= 0) throw new Error(\"Worksheet with name |\" + name + \"| already exists!\");\n\n\twb.SheetNames.push(name);\n\twb.Sheets[name] = ws;\n\treturn name;\n}\n\n/* set sheet visibility (visible/hidden/very hidden) */\nfunction book_set_sheet_visibility(wb/*:Workbook*/, sh/*:number|string*/, vis/*:number*/) {\n\tif(!wb.Workbook) wb.Workbook = {};\n\tif(!wb.Workbook.Sheets) wb.Workbook.Sheets = [];\n\n\tvar idx = wb_sheet_idx(wb, sh);\n\t// $FlowIgnore\n\tif(!wb.Workbook.Sheets[idx]) wb.Workbook.Sheets[idx] = {};\n\n\tswitch(vis) {\n\t\tcase 0: case 1: case 2: break;\n\t\tdefault: throw new Error(\"Bad sheet visibility setting \" + vis);\n\t}\n\t// $FlowIgnore\n\twb.Workbook.Sheets[idx].Hidden = vis;\n}\n\n/* set number format */\nfunction cell_set_number_format(cell/*:Cell*/, fmt/*:string|number*/) {\n\tcell.z = fmt;\n\treturn cell;\n}\n\n/* set cell hyperlink */\nfunction cell_set_hyperlink(cell/*:Cell*/, target/*:string*/, tooltip/*:?string*/) {\n\tif(!target) {\n\t\tdelete cell.l;\n\t} else {\n\t\tcell.l = ({ Target: target }/*:Hyperlink*/);\n\t\tif(tooltip) cell.l.Tooltip = tooltip;\n\t}\n\treturn cell;\n}\nfunction cell_set_internal_link(cell/*:Cell*/, range/*:string*/, tooltip/*:?string*/) { return cell_set_hyperlink(cell, \"#\" + range, tooltip); }\n\n/* add to cell comments */\nfunction cell_add_comment(cell/*:Cell*/, text/*:string*/, author/*:?string*/) {\n\tif(!cell.c) cell.c = [];\n\tcell.c.push({t:text, a:author||\"SheetJS\"});\n}\n\n/* set array formula and flush related cells */\nfunction sheet_set_array_formula(ws/*:Worksheet*/, range, formula/*:string*/, dynamic/*:boolean*/) {\n\tvar rng = typeof range != \"string\" ? range : safe_decode_range(range);\n\tvar rngstr = typeof range == \"string\" ? range : encode_range(range);\n\tfor(var R = rng.s.r; R <= rng.e.r; ++R) for(var C = rng.s.c; C <= rng.e.c; ++C) {\n\t\tvar cell = ws_get_cell_stub(ws, R, C);\n\t\tcell.t = 'n';\n\t\tcell.F = rngstr;\n\t\tdelete cell.v;\n\t\tif(R == rng.s.r && C == rng.s.c) {\n\t\t\tcell.f = formula;\n\t\t\tif(dynamic) cell.D = true;\n\t\t}\n\t}\n\treturn ws;\n}\n\nvar utils/*:any*/ = {\n\tencode_col: encode_col,\n\tencode_row: encode_row,\n\tencode_cell: encode_cell,\n\tencode_range: encode_range,\n\tdecode_col: decode_col,\n\tdecode_row: decode_row,\n\tsplit_cell: split_cell,\n\tdecode_cell: decode_cell,\n\tdecode_range: decode_range,\n\tformat_cell: format_cell,\n\tsheet_add_aoa: sheet_add_aoa,\n\tsheet_add_json: sheet_add_json,\n\tsheet_add_dom: sheet_add_dom,\n\taoa_to_sheet: aoa_to_sheet,\n\tjson_to_sheet: json_to_sheet,\n\ttable_to_sheet: parse_dom_table,\n\ttable_to_book: table_to_book,\n\tsheet_to_csv: sheet_to_csv,\n\tsheet_to_txt: sheet_to_txt,\n\tsheet_to_json: sheet_to_json,\n\tsheet_to_html: sheet_to_html,\n\tsheet_to_formulae: sheet_to_formulae,\n\tsheet_to_row_object_array: sheet_to_json,\n\tsheet_get_cell: ws_get_cell_stub,\n\tbook_new: book_new,\n\tbook_append_sheet: book_append_sheet,\n\tbook_set_sheet_visibility: book_set_sheet_visibility,\n\tcell_set_number_format: cell_set_number_format,\n\tcell_set_hyperlink: cell_set_hyperlink,\n\tcell_set_internal_link: cell_set_internal_link,\n\tcell_add_comment: cell_add_comment,\n\tsheet_set_array_formula: sheet_set_array_formula,\n\tconsts: {\n\t\tSHEET_VISIBLE: 0,\n\t\tSHEET_HIDDEN: 1,\n\t\tSHEET_VERY_HIDDEN: 2\n\t}\n};\n\nvar _Readable;\nfunction set_readable(R) { _Readable = R; }\n\nfunction write_csv_stream(sheet/*:Worksheet*/, opts/*:?Sheet2CSVOpts*/) {\n\tvar stream = _Readable();\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar endregex = new RegExp((FS==\"|\" ? \"\\\\|\" : FS)+\"+$\");\n\tvar row/*:?string*/ = \"\", cols/*:Array<string>*/ = [];\n\to.dense = Array.isArray(sheet);\n\tvar colinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo/*:Array<RowInfo>*/ = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(var C = r.s.c; C <= r.e.c; ++C) if (!((colinfo[C]||{}).hidden)) cols[C] = encode_col(C);\n\tvar R = r.s.r;\n\tvar BOM = false, w = 0;\n\tstream._read = function() {\n\t\tif(!BOM) { BOM = true; return stream.push(\"\\uFEFF\"); }\n\t\twhile(R <= r.e.r) {\n\t\t\t++R;\n\t\t\tif ((rowinfo[R-1]||{}).hidden) continue;\n\t\t\trow = make_csv_row(sheet, r, R-1, cols, fs, rs, FS, o);\n\t\t\tif(row != null) {\n\t\t\t\tif(o.strip) row = row.replace(endregex,\"\");\n\t\t\t\tif(row || (o.blankrows !== false)) return stream.push((w++ ? RS : \"\") + row);\n\t\t\t}\n\t\t}\n\t\treturn stream.push(null);\n\t};\n\treturn stream;\n}\n\nfunction write_html_stream(ws/*:Worksheet*/, opts/*:?Sheet2HTMLOpts*/) {\n\tvar stream = _Readable();\n\n\tvar o = opts || {};\n\tvar header = o.header != null ? o.header : HTML_BEGIN;\n\tvar footer = o.footer != null ? o.footer : HTML_END;\n\tstream.push(header);\n\tvar r = decode_range(ws['!ref']);\n\to.dense = Array.isArray(ws);\n\tstream.push(make_html_preamble(ws, r, o));\n\tvar R = r.s.r;\n\tvar end = false;\n\tstream._read = function() {\n\t\tif(R > r.e.r) {\n\t\t\tif(!end) { end = true; stream.push(\"</table>\" + footer); }\n\t\t\treturn stream.push(null);\n\t\t}\n\t\twhile(R <= r.e.r) {\n\t\t\tstream.push(make_html_row(ws, r, R, o));\n\t\t\t++R;\n\t\t\tbreak;\n\t\t}\n\t};\n\treturn stream;\n}\n\nfunction write_json_stream(sheet/*:Worksheet*/, opts/*:?Sheet2CSVOpts*/) {\n\tvar stream = _Readable({objectMode:true});\n\n\tif(sheet == null || sheet[\"!ref\"] == null) { stream.push(null); return stream; }\n\tvar val = {t:'n',v:0}, header = 0, offset = 1, hdr/*:Array<any>*/ = [], v=0, vv=\"\";\n\tvar r = {s:{r:0,c:0},e:{r:0,c:0}};\n\tvar o = opts || {};\n\tvar range = o.range != null ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols/*:Array<string>*/ = [];\n\tvar counter = 0;\n\tvar dense = Array.isArray(sheet);\n\tvar R = r.s.r, C = 0;\n\tvar header_cnt = {};\n\tif(dense && !sheet[R]) sheet[R] = [];\n\tvar colinfo/*:Array<ColInfo>*/ = o.skipHidden && sheet[\"!cols\"] || [];\n\tvar rowinfo/*:Array<RowInfo>*/ = o.skipHidden && sheet[\"!rows\"] || [];\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tif(((colinfo[C]||{}).hidden)) continue;\n\t\tcols[C] = encode_col(C);\n\t\tval = dense ? sheet[R][C] : sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C - r.s.c; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val == null) val = {w: \"__EMPTY\", t: \"s\"};\n\t\t\t\tvv = v = format_cell(val, null, o);\n\t\t\t\tcounter = header_cnt[v] || 0;\n\t\t\t\tif(!counter) header_cnt[v] = 1;\n\t\t\t\telse {\n\t\t\t\t\tdo { vv = v + \"_\" + (counter++); } while(header_cnt[vv]); header_cnt[v] = counter;\n\t\t\t\t\theader_cnt[vv] = 1;\n\t\t\t\t}\n\t\t\t\thdr[C] = vv;\n\t\t}\n\t}\n\tR = r.s.r + offset;\n\tstream._read = function() {\n\t\twhile(R <= r.e.r) {\n\t\t\tif ((rowinfo[R-1]||{}).hidden) continue;\n\t\t\tvar row = make_json_row(sheet, r, R, cols, header, hdr, dense, o);\n\t\t\t++R;\n\t\t\tif((row.isempty === false) || (header === 1 ? o.blankrows !== false : !!o.blankrows)) {\n\t\t\t\tstream.push(row.row);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\treturn stream.push(null);\n\t};\n\treturn stream;\n}\n\nvar __stream = {\n\tto_json: write_json_stream,\n\tto_html: write_html_stream,\n\tto_csv: write_csv_stream,\n  set_readable: set_readable\n};\nexport const version = XLSX.version;\nexport {\n\tparse_xlscfb,\n\tparse_zip,\n\treadSync as read,\n\treadFileSync as readFile,\n\treadFileSync,\n\twriteSync as write,\n\twriteFileSync as writeFile,\n\twriteFileSync,\n\twriteFileAsync,\n\twriteSyncXLSX as writeXLSX,\n\twriteFileSyncXLSX as writeFileXLSX,\n\tutils,\n\t__stream as stream,\n\tSSF,\n\tCFB\n};\n","<template>\n  <div class=\"file-reader\" v-if=\"!getSheetData\">\n    <label class=\"file\">\n      <input\n        type=\"file\"\n        ref=\"file\"\n        name=\"file\"\n        @change=\"fileOnChange\"\n        accept=\".xls,.xlsx\"\n        aria-label=\"File browser example\"\n      />\n      <span class=\"file-custom\"></span>\n    </label>\n  </div>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\n\nimport { read, utils } from 'xlsx'\nimport { normalizeSheetJSON } from '@/helpers'\n\nexport default {\n  name: 'AppFileReader',\n\n  data() {\n    return {\n      fileReader: new FileReader(),\n    }\n  },\n\n  created() {\n    this.fileReader.addEventListener('loadend', this.handleFileLoad)\n  },\n\n  computed: {\n    ...mapGetters({\n      getSheetData: 'getSheetData',\n    }),\n  },\n\n  methods: {\n    ...mapActions({\n      setSheetData: 'setSheetData',\n      changeErrorMsg: 'changeErrorMsg',\n    }),\n\n    fileOnChange(event) {\n      this.fileReader.readAsBinaryString(event.target.files[0])\n    },\n    handleFileLoad(event) {\n      try {\n        const fileData = event.target.result\n        const workBook = read(fileData, { type: 'binary' })\n        const firstSheetName = Object.keys(workBook.Sheets)[0]\n        const mainSheet = utils.sheet_to_json(workBook.Sheets[firstSheetName])\n\n        this.setSheetData(normalizeSheetJSON(mainSheet))\n      } catch (error) {\n        this.changeErrorMsg({\n          title: 'Sheet load error',\n          description: 'Check instruction and load correct sheet with correct fields',\n        })\n        this.$refs.file.value = ''\n      }\n    },\n  },\n}\n</script>\n\n<style>\n.file {\n  position: relative;\n  display: inline-block;\n  cursor: pointer;\n  height: 2.5rem;\n}\n.file input {\n  min-width: 14rem;\n  margin: 0;\n  filter: alpha(opacity=0);\n  opacity: 0;\n}\n.file-custom {\n  position: absolute;\n  top: 0;\n  right: 0;\n  left: 0;\n  z-index: 5;\n  height: 2.5rem;\n  padding: 0.5rem 1rem;\n  line-height: 1.5;\n  color: #555;\n  background-color: #fff;\n  border: 0.075rem solid #ddd;\n  border-radius: 0.25rem;\n  box-shadow: inset 0 0.2rem 0.4rem rgba(0, 0, 0, 0.05);\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.file-custom:after {\n  content: 'Choose file...';\n}\n.file-custom:before {\n  position: absolute;\n  top: -0.075rem;\n  right: -0.075rem;\n  bottom: -0.075rem;\n  z-index: 6;\n  display: block;\n  content: 'Browse';\n  padding: 0.5rem 1rem;\n  line-height: 1.5;\n  color: #555;\n  background-color: #eee;\n  border: 0.075rem solid #ddd;\n  border-radius: 0 0.25rem 0.25rem 0;\n}\n</style>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AppFileReader.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./AppFileReader.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AppFileReader.vue?vue&type=template&id=62078156&\"\nimport script from \"./AppFileReader.vue?vue&type=script&lang=js&\"\nexport * from \"./AppFileReader.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AppFileReader.vue?vue&type=style&index=0&id=62078156&prod&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"result__wrap\"},[_c('div',{staticClass:\"result__header-btn\"},[_c('button',{staticClass:\"simple-btn result__header-btn-clc\",attrs:{\"disabled\":!_vm.checkCommodities},on:{\"click\":_vm.calculateResult}},[_c('img',{attrs:{\"src\":require(\"@/assets/calculator.svg\")}}),_c('span',[_vm._v(\"Calculate\")])])]),(_vm.resultData.length)?_c('div',{staticClass:\"result__data\"},[_c('h2',{staticClass:\"result__data-title\"},[_vm._v(\"Final result:\")]),_c('div',{staticClass:\"result__data-wrapp\"},_vm._l((_vm.resultData),function(item,index){return _c('ResultDataElem',{key:`data-elem-${index}`,attrs:{\"itemName\":item,\"itemValue\":_vm.getSingleCalculatedIngredient(item)}})}),1),_c('div',{staticClass:\"result__data-btns\"},[_c('button',{staticClass:\"result__data-download\",on:{\"click\":_vm.download}},[_c('img',{staticClass:\"bounce\",attrs:{\"src\":require(\"@/assets/angles-down-solid.svg\")}}),_c('span',[_vm._v(\"Download\")])])])]):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"result__data-elem\"},[_c('span',{staticClass:\"result__data-elem-name\"},[_vm._v(_vm._s(_vm.itemName)+\" :\")]),_c('span',{staticClass:\"result__data-elem-value\"},[_vm._v(_vm._s(_vm.itemValue))])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"result__data-elem\">\n    <span class=\"result__data-elem-name\">{{ itemName }} :</span>\n    <span class=\"result__data-elem-value\">{{ itemValue }}</span>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ResultDataElem',\n\n  props: {\n    itemName: {\n      type: String,\n      required: true,\n    },\n\n    itemValue: {\n      type: Number,\n      required: true,\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/scss/colors.scss';\n\n.result {\n  &__data-elem {\n    max-width: 300px;\n    margin: 10px auto;\n    display: flex;\n    justify-content: space-between;\n  }\n\n  &__data-elem-name {\n    border-bottom: 1px solid $dark_4;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ResultDataElem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ResultDataElem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ResultDataElem.vue?vue&type=template&id=49db6552&\"\nimport script from \"./ResultDataElem.vue?vue&type=script&lang=js&\"\nexport * from \"./ResultDataElem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ResultDataElem.vue?vue&type=style&index=0&id=49db6552&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"result__wrap\">\n    <div class=\"result__header-btn\">\n      <button class=\"simple-btn result__header-btn-clc\" :disabled=\"!checkCommodities\" @click=\"calculateResult\">\n        <img src=\"@/assets/calculator.svg\" />\n        <span>Calculate</span>\n      </button>\n    </div>\n    <div class=\"result__data\" v-if=\"resultData.length\">\n      <h2 class=\"result__data-title\">Final result:</h2>\n      <div class=\"result__data-wrapp\">\n        <ResultDataElem\n          v-for=\"(item, index) in resultData\"\n          :key=\"`data-elem-${index}`\"\n          :itemName=\"item\"\n          :itemValue=\"getSingleCalculatedIngredient(item)\"\n        />\n      </div>\n\n      <div class=\"result__data-btns\">\n        <button class=\"result__data-download\" @click=\"download\">\n          <img class=\"bounce\" src=\"@/assets/angles-down-solid.svg\" />\n          <span>Download</span>\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nimport { utils, writeFile } from 'xlsx'\nimport ResultDataElem from '@/components/FinalBlock/ResultDataElem.vue'\nimport { normalizeJSONforDownload } from '@/helpers/transformers'\n\nexport default {\n  name: 'FinalBlock',\n  components: {\n    ResultDataElem,\n  },\n\n  data() {\n    return {\n      fileName: 'ingredients',\n      fileExtension: {\n        xlsx: 'xlsx',\n      },\n    }\n  },\n\n  computed: {\n    ...mapGetters({\n      getCalculationElements: 'getCalculationElements',\n      getCalculatedIngredients: 'getCalculatedIngredients',\n      getSingleCalculatedIngredient: 'getSingleCalculatedIngredient',\n    }),\n\n    checkCommodities() {\n      return this.getCalculationElements.length\n    },\n\n    resultData() {\n      return Object.keys(this.getCalculatedIngredients)\n    },\n  },\n\n  methods: {\n    ...mapActions({\n      calculateResult: 'calculateResult',\n      resetStore: 'resetStore',\n    }),\n\n    download() {\n      const data = normalizeJSONforDownload(this.getCalculatedIngredients)\n      const workSheet = utils.json_to_sheet(data)\n      const workBook = utils.book_new()\n\n      utils.book_append_sheet(workBook, workSheet, this.fileName)\n      const fullFileName = `${this.fileName}.${this.fileExtension.xlsx}`\n      writeFile(workBook, fullFileName)\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/scss/buttons.scss';\n@import '@/scss/colors.scss';\n\n.result {\n  &__header-btn {\n    margin: 15px 25px;\n    display: flex;\n    justify-content: center;\n\n    &-clc {\n      display: flex;\n      align-items: center;\n\n      img {\n        margin-right: 10px;\n      }\n    }\n  }\n\n  &__data-wrapp {\n    margin-bottom: 40px;\n  }\n\n  &__data-download {\n    margin: 0 auto;\n    padding: 10px 15px;\n    display: flex;\n    align-items: center;\n    border-radius: 15px;\n    color: $active;\n    background-color: $active_2;\n\n    img {\n      width: 20px;\n      height: 20px;\n      margin-right: 5px;\n    }\n  }\n}\n\n.bounce {\n  animation: bounce 2s ease infinite;\n}\n@keyframes bounce {\n  0%,\n  20%,\n  50%,\n  80%,\n  100% {\n    transform: translateY(5px);\n  }\n  40% {\n    transform: translateY(-20px);\n  }\n  60% {\n    transform: translateY(-15px);\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FinalBlock.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./FinalBlock.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FinalBlock.vue?vue&type=template&id=76bd4cbe&\"\nimport script from \"./FinalBlock.vue?vue&type=script&lang=js&\"\nexport * from \"./FinalBlock.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FinalBlock.vue?vue&type=style&index=0&id=76bd4cbe&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"switchers\"},[_c('div',{staticClass:\"switchers__chart\"},[_c('span',{staticClass:\"switchers__chart__title\"},[_vm._v(\"Chart module:\")]),_c('label',{staticClass:\"switch\"},[_c('input',{attrs:{\"type\":\"checkbox\"},domProps:{\"checked\":_vm.getChartSwitcher},on:{\"click\":_vm.toggleChartSwitcher}}),_c('span',{staticClass:\"slider round\"})])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"switchers\">\n    <div class=\"switchers__chart\">\n      <span class=\"switchers__chart__title\">Chart module:</span>\n      <label class=\"switch\">\n        <input type=\"checkbox\" :checked=\"getChartSwitcher\" @click=\"toggleChartSwitcher\" />\n        <span class=\"slider round\"></span>\n      </label>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\nexport default {\n  name: 'Switchers',\n\n  computed: {\n    ...mapGetters({\n      getChartSwitcher: 'getChartSwitcher',\n    }),\n  },\n\n  methods: {\n    ...mapActions({\n      toggleChartSwitcher: 'toggleChartSwitcher',\n    }),\n  },\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/scss/colors.scss';\n\n.switch {\n  position: relative;\n  display: inline-block;\n  width: 50px;\n  height: 28px;\n}\n\n/* Hide default HTML checkbox */\n.switch input {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n/* The slider */\n.slider {\n  position: absolute;\n  cursor: pointer;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: $dark_1;\n  -webkit-transition: 0.4s;\n  transition: 0.4s;\n}\n\n.slider:before {\n  position: absolute;\n  content: '';\n  height: 20px;\n  width: 20px;\n  left: 4px;\n  bottom: 4px;\n  background-color: white;\n  -webkit-transition: 0.4s;\n  transition: 0.4s;\n}\n\ninput:checked + .slider {\n  background-color: $active;\n}\n\ninput:focus + .slider {\n  box-shadow: 0 0 1px $active;\n}\n\ninput:checked + .slider:before {\n  -webkit-transform: translateX(22px);\n  -ms-transform: translateX(22px);\n  transform: translateX(22px);\n}\n\n.slider.round {\n  border-radius: 30px;\n}\n\n.slider.round:before {\n  border-radius: 50%;\n}\n\n.switchers__chart {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  &__title {\n    margin-right: 10px;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Switchers.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Switchers.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Switchers.vue?vue&type=template&id=d03ed27e&\"\nimport script from \"./Switchers.vue?vue&type=script&lang=js&\"\nexport * from \"./Switchers.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Switchers.vue?vue&type=style&index=0&id=d03ed27e&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"calc-block\"},[(!_vm.quantityCalculationElements)?_c('h2',[_vm._v(\"For calculating need add commodities\")]):_c('h2',[_vm._v(\"Calculate ingredients\")]),(_vm.quantityCalculationElements)?_c('div',{staticClass:\"calc-block__cards\"},_vm._l((_vm.getCalculationElements),function(item,index){return _c('CalculationCard',{key:`calc-block__card-${index}`,attrs:{\"calculationItem\":item}})}),1):_vm._e()])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"calc-card\"},[_c('div',{staticClass:\"calc-card__remove\",attrs:{\"title\":\"Remove product\"},on:{\"click\":_vm.remove}},[_c('img',{attrs:{\"alt\":\"trash icon\",\"src\":require(\"@/assets/trash-solid.svg\")}})]),_c('h5',{staticClass:\"calc-card__info\"},[_c('span',{staticClass:\"calc-card__info-name\"},[_vm._v(\" \"+_vm._s(_vm.calculationItem.name))]),_c('span',{staticClass:\"calc-card__info-size\"},[_vm._v(\" \"+_vm._s(_vm.calculationItem.size)+\" size\")])]),(_vm.getChartSwitcher)?_c('div',{staticClass:\"calc-card__graph\"},[_c('canvas',{ref:\"chart\",staticClass:\"calc-card__graph-wrapper\"})]):_c('ul',{staticClass:\"calc-card__ingredients\"},_vm._l((_vm.getFormulaItemsName),function(ingredient,index){return _c('li',{key:`ingredient-${index}`,staticClass:\"calc-card__ingredient\"},[_c('span',[_vm._v(_vm._s(ingredient)+\" :\")]),_c('span',[_vm._v(_vm._s(_vm.getIngredients[ingredient]))])])}),0),_c('div',{staticClass:\"calc-card__counter counter\"},[_c('span',{staticClass:\"counter__decrement\",class:{ disable: _vm.disableDecrement },on:{\"click\":function($event){return _vm.changeCount(-1)}}},[_vm._v(\"\")]),_c('input',{directives:[{name:\"model\",rawName:\"v-model.lazy\",value:(_vm.count),expression:\"count\",modifiers:{\"lazy\":true}}],staticClass:\"counter__input\",attrs:{\"type\":\"number\",\"min\":\"1\",\"step\":\"1\"},domProps:{\"value\":(_vm.count)},on:{\"change\":[function($event){_vm.count=$event.target.value},_vm.handleChange]}}),_c('span',{staticClass:\"counter__increment\",on:{\"click\":function($event){return _vm.changeCount(1)}}},[_vm._v(\"+\")])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","/**\n * @namespace Chart.helpers\n */\n\nimport type {AnyObject} from '../../types/basic';\nimport type {ActiveDataPoint, ChartEvent} from '../../types';\n\n/**\n * An empty function that can be used, for example, for optional callback.\n */\nexport function noop() {\n  /* noop */\n}\n\n/**\n * Returns a unique id, sequentially generated from a global variable.\n */\nexport const uid = (() => {\n  let id = 0;\n  return () => id++;\n})();\n\n/**\n * Returns true if `value` is neither null nor undefined, else returns false.\n * @param value - The value to test.\n * @since 2.7.0\n */\nexport function isNullOrUndef(value: unknown): value is null | undefined {\n  return value === null || typeof value === 'undefined';\n}\n\n/**\n * Returns true if `value` is an array (including typed arrays), else returns false.\n * @param value - The value to test.\n * @function\n */\nexport function isArray<T = unknown>(value: unknown): value is T[] {\n  if (Array.isArray && Array.isArray(value)) {\n    return true;\n  }\n  const type = Object.prototype.toString.call(value);\n  if (type.slice(0, 7) === '[object' && type.slice(-6) === 'Array]') {\n    return true;\n  }\n  return false;\n}\n\n/**\n * Returns true if `value` is an object (excluding null), else returns false.\n * @param value - The value to test.\n * @since 2.7.0\n */\nexport function isObject(value: unknown): value is AnyObject {\n  return value !== null && Object.prototype.toString.call(value) === '[object Object]';\n}\n\n/**\n * Returns true if `value` is a finite number, else returns false\n * @param value  - The value to test.\n */\nfunction isNumberFinite(value: unknown): value is number {\n  return (typeof value === 'number' || value instanceof Number) && isFinite(+value);\n}\nexport {\n  isNumberFinite as isFinite,\n};\n\n/**\n * Returns `value` if finite, else returns `defaultValue`.\n * @param value - The value to return if defined.\n * @param defaultValue - The value to return if `value` is not finite.\n */\nexport function finiteOrDefault(value: unknown, defaultValue: number) {\n  return isNumberFinite(value) ? value : defaultValue;\n}\n\n/**\n * Returns `value` if defined, else returns `defaultValue`.\n * @param value - The value to return if defined.\n * @param defaultValue - The value to return if `value` is undefined.\n */\nexport function valueOrDefault<T>(value: T | undefined, defaultValue: T) {\n  return typeof value === 'undefined' ? defaultValue : value;\n}\n\nexport const toPercentage = (value: number | string, dimension: number) =>\n  typeof value === 'string' && value.endsWith('%') ?\n    parseFloat(value) / 100\n    : +value / dimension;\n\nexport const toDimension = (value: number | string, dimension: number) =>\n  typeof value === 'string' && value.endsWith('%') ?\n    parseFloat(value) / 100 * dimension\n    : +value;\n\n/**\n * Calls `fn` with the given `args` in the scope defined by `thisArg` and returns the\n * value returned by `fn`. If `fn` is not a function, this method returns undefined.\n * @param fn - The function to call.\n * @param args - The arguments with which `fn` should be called.\n * @param [thisArg] - The value of `this` provided for the call to `fn`.\n */\nexport function callback<T extends (this: TA, ...restArgs: unknown[]) => R, TA, R>(\n  fn: T | undefined,\n  args: unknown[],\n  thisArg?: TA\n): R | undefined {\n  if (fn && typeof fn.call === 'function') {\n    return fn.apply(thisArg, args);\n  }\n}\n\n/**\n * Note(SB) for performance sake, this method should only be used when loopable type\n * is unknown or in none intensive code (not called often and small loopable). Else\n * it's preferable to use a regular for() loop and save extra function calls.\n * @param loopable - The object or array to be iterated.\n * @param fn - The function to call for each item.\n * @param [thisArg] - The value of `this` provided for the call to `fn`.\n * @param [reverse] - If true, iterates backward on the loopable.\n */\nexport function each<T, TA>(\n  loopable: Record<string, T>,\n  fn: (this: TA, v: T, i: string) => void,\n  thisArg?: TA,\n  reverse?: boolean\n): void;\nexport function each<T, TA>(\n  loopable: T[],\n  fn: (this: TA, v: T, i: number) => void,\n  thisArg?: TA,\n  reverse?: boolean\n): void;\nexport function each<T, TA>(\n  loopable: T[] | Record<string, T>,\n  fn: (this: TA, v: T, i: any) => void,\n  thisArg?: TA,\n  reverse?: boolean\n) {\n  let i: number, len: number, keys: string[];\n  if (isArray(loopable)) {\n    len = loopable.length;\n    if (reverse) {\n      for (i = len - 1; i >= 0; i--) {\n        fn.call(thisArg, loopable[i], i);\n      }\n    } else {\n      for (i = 0; i < len; i++) {\n        fn.call(thisArg, loopable[i], i);\n      }\n    }\n  } else if (isObject(loopable)) {\n    keys = Object.keys(loopable);\n    len = keys.length;\n    for (i = 0; i < len; i++) {\n      fn.call(thisArg, loopable[keys[i]], keys[i]);\n    }\n  }\n}\n\n/**\n * Returns true if the `a0` and `a1` arrays have the same content, else returns false.\n * @param a0 - The array to compare\n * @param a1 - The array to compare\n * @private\n */\nexport function _elementsEqual(a0: ActiveDataPoint[], a1: ActiveDataPoint[]) {\n  let i: number, ilen: number, v0: ActiveDataPoint, v1: ActiveDataPoint;\n\n  if (!a0 || !a1 || a0.length !== a1.length) {\n    return false;\n  }\n\n  for (i = 0, ilen = a0.length; i < ilen; ++i) {\n    v0 = a0[i];\n    v1 = a1[i];\n\n    if (v0.datasetIndex !== v1.datasetIndex || v0.index !== v1.index) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Returns a deep copy of `source` without keeping references on objects and arrays.\n * @param source - The value to clone.\n */\nexport function clone<T>(source: T): T {\n  if (isArray(source)) {\n    return source.map(clone) as unknown as T;\n  }\n\n  if (isObject(source)) {\n    const target = Object.create(null);\n    const keys = Object.keys(source);\n    const klen = keys.length;\n    let k = 0;\n\n    for (; k < klen; ++k) {\n      target[keys[k]] = clone(source[keys[k]]);\n    }\n\n    return target;\n  }\n\n  return source;\n}\n\nfunction isValidKey(key: string) {\n  return ['__proto__', 'prototype', 'constructor'].indexOf(key) === -1;\n}\n\n/**\n * The default merger when Chart.helpers.merge is called without merger option.\n * Note(SB): also used by mergeConfig and mergeScaleConfig as fallback.\n * @private\n */\nexport function _merger(key: string, target: AnyObject, source: AnyObject, options: AnyObject) {\n  if (!isValidKey(key)) {\n    return;\n  }\n\n  const tval = target[key];\n  const sval = source[key];\n\n  if (isObject(tval) && isObject(sval)) {\n    // eslint-disable-next-line @typescript-eslint/no-use-before-define\n    merge(tval, sval, options);\n  } else {\n    target[key] = clone(sval);\n  }\n}\n\nexport interface MergeOptions {\n  merger?: (key: string, target: AnyObject, source: AnyObject, options?: AnyObject) => void;\n}\n\n/**\n * Recursively deep copies `source` properties into `target` with the given `options`.\n * IMPORTANT: `target` is not cloned and will be updated with `source` properties.\n * @param target - The target object in which all sources are merged into.\n * @param source - Object(s) to merge into `target`.\n * @param [options] - Merging options:\n * @param [options.merger] - The merge method (key, target, source, options)\n * @returns The `target` object.\n */\nexport function merge<T>(target: T, source: [], options?: MergeOptions): T;\nexport function merge<T, S1>(target: T, source: S1, options?: MergeOptions): T & S1;\nexport function merge<T, S1>(target: T, source: [S1], options?: MergeOptions): T & S1;\nexport function merge<T, S1, S2>(target: T, source: [S1, S2], options?: MergeOptions): T & S1 & S2;\nexport function merge<T, S1, S2, S3>(target: T, source: [S1, S2, S3], options?: MergeOptions): T & S1 & S2 & S3;\nexport function merge<T, S1, S2, S3, S4>(\n  target: T,\n  source: [S1, S2, S3, S4],\n  options?: MergeOptions\n): T & S1 & S2 & S3 & S4;\nexport function merge<T>(target: T, source: AnyObject[], options?: MergeOptions): AnyObject;\nexport function merge<T>(target: T, source: AnyObject[], options?: MergeOptions): AnyObject {\n  const sources = isArray(source) ? source : [source];\n  const ilen = sources.length;\n\n  if (!isObject(target)) {\n    return target as AnyObject;\n  }\n\n  options = options || {};\n  const merger = options.merger || _merger;\n  let current: AnyObject;\n\n  for (let i = 0; i < ilen; ++i) {\n    current = sources[i];\n    if (!isObject(current)) {\n      continue;\n    }\n\n    const keys = Object.keys(current);\n    for (let k = 0, klen = keys.length; k < klen; ++k) {\n      merger(keys[k], target, current, options as AnyObject);\n    }\n  }\n\n  return target;\n}\n\n/**\n * Recursively deep copies `source` properties into `target` *only* if not defined in target.\n * IMPORTANT: `target` is not cloned and will be updated with `source` properties.\n * @param target - The target object in which all sources are merged into.\n * @param source - Object(s) to merge into `target`.\n * @returns The `target` object.\n */\nexport function mergeIf<T>(target: T, source: []): T;\nexport function mergeIf<T, S1>(target: T, source: S1): T & S1;\nexport function mergeIf<T, S1>(target: T, source: [S1]): T & S1;\nexport function mergeIf<T, S1, S2>(target: T, source: [S1, S2]): T & S1 & S2;\nexport function mergeIf<T, S1, S2, S3>(target: T, source: [S1, S2, S3]): T & S1 & S2 & S3;\nexport function mergeIf<T, S1, S2, S3, S4>(target: T, source: [S1, S2, S3, S4]): T & S1 & S2 & S3 & S4;\nexport function mergeIf<T>(target: T, source: AnyObject[]): AnyObject;\nexport function mergeIf<T>(target: T, source: AnyObject[]): AnyObject {\n  // eslint-disable-next-line @typescript-eslint/no-use-before-define\n  return merge<T>(target, source, {merger: _mergerIf});\n}\n\n/**\n * Merges source[key] in target[key] only if target[key] is undefined.\n * @private\n */\nexport function _mergerIf(key: string, target: AnyObject, source: AnyObject) {\n  if (!isValidKey(key)) {\n    return;\n  }\n\n  const tval = target[key];\n  const sval = source[key];\n\n  if (isObject(tval) && isObject(sval)) {\n    mergeIf(tval, sval);\n  } else if (!Object.prototype.hasOwnProperty.call(target, key)) {\n    target[key] = clone(sval);\n  }\n}\n\n/**\n * @private\n */\nexport function _deprecated(scope: string, value: unknown, previous: string, current: string) {\n  if (value !== undefined) {\n    console.warn(scope + ': \"' + previous +\n      '\" is deprecated. Please use \"' + current + '\" instead');\n  }\n}\n\n// resolveObjectKey resolver cache\nconst keyResolvers = {\n  // Chart.helpers.core resolveObjectKey should resolve empty key to root object\n  '': v => v,\n  // default resolvers\n  x: o => o.x,\n  y: o => o.y\n};\n\n/**\n * @private\n */\nexport function _splitKey(key: string) {\n  const parts = key.split('.');\n  const keys: string[] = [];\n  let tmp = '';\n  for (const part of parts) {\n    tmp += part;\n    if (tmp.endsWith('\\\\')) {\n      tmp = tmp.slice(0, -1) + '.';\n    } else {\n      keys.push(tmp);\n      tmp = '';\n    }\n  }\n  return keys;\n}\n\nfunction _getKeyResolver(key: string) {\n  const keys = _splitKey(key);\n  return obj => {\n    for (const k of keys) {\n      if (k === '') {\n        // For backward compatibility:\n        // Chart.helpers.core resolveObjectKey should break at empty key\n        break;\n      }\n      obj = obj && obj[k];\n    }\n    return obj;\n  };\n}\n\nexport function resolveObjectKey(obj: AnyObject, key: string): AnyObject {\n  const resolver = keyResolvers[key] || (keyResolvers[key] = _getKeyResolver(key));\n  return resolver(obj);\n}\n\n/**\n * @private\n */\nexport function _capitalize(str: string) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n\nexport const defined = (value: unknown) => typeof value !== 'undefined';\n\nexport const isFunction = (value: unknown): value is (...args: any[]) => any => typeof value === 'function';\n\n// Adapted from https://stackoverflow.com/questions/31128855/comparing-ecma6-sets-for-equality#31129384\nexport const setsEqual = <T>(a: Set<T>, b: Set<T>) => {\n  if (a.size !== b.size) {\n    return false;\n  }\n\n  for (const item of a) {\n    if (!b.has(item)) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\n/**\n * @param e - The event\n * @private\n */\nexport function _isClickEvent(e: ChartEvent) {\n  return e.type === 'mouseup' || e.type === 'click' || e.type === 'contextmenu';\n}\n","import type {Point} from '../../types/geometric';\nimport {isFinite as isFiniteNumber} from './helpers.core';\n\n/**\n * @alias Chart.helpers.math\n * @namespace\n */\n\nexport const PI = Math.PI;\nexport const TAU = 2 * PI;\nexport const PITAU = TAU + PI;\nexport const INFINITY = Number.POSITIVE_INFINITY;\nexport const RAD_PER_DEG = PI / 180;\nexport const HALF_PI = PI / 2;\nexport const QUARTER_PI = PI / 4;\nexport const TWO_THIRDS_PI = PI * 2 / 3;\n\nexport const log10 = Math.log10;\nexport const sign = Math.sign;\n\nexport function almostEquals(x: number, y: number, epsilon: number) {\n  return Math.abs(x - y) < epsilon;\n}\n\n/**\n * Implementation of the nice number algorithm used in determining where axis labels will go\n */\nexport function niceNum(range: number) {\n  const roundedRange = Math.round(range);\n  range = almostEquals(range, roundedRange, range / 1000) ? roundedRange : range;\n  const niceRange = Math.pow(10, Math.floor(log10(range)));\n  const fraction = range / niceRange;\n  const niceFraction = fraction <= 1 ? 1 : fraction <= 2 ? 2 : fraction <= 5 ? 5 : 10;\n  return niceFraction * niceRange;\n}\n\n/**\n * Returns an array of factors sorted from 1 to sqrt(value)\n * @private\n */\nexport function _factorize(value: number) {\n  const result: number[] = [];\n  const sqrt = Math.sqrt(value);\n  let i: number;\n\n  for (i = 1; i < sqrt; i++) {\n    if (value % i === 0) {\n      result.push(i);\n      result.push(value / i);\n    }\n  }\n  if (sqrt === (sqrt | 0)) { // if value is a square number\n    result.push(sqrt);\n  }\n\n  result.sort((a, b) => a - b).pop();\n  return result;\n}\n\nexport function isNumber(n: unknown): n is number {\n  return !isNaN(parseFloat(n as string)) && isFinite(n as number);\n}\n\nexport function almostWhole(x: number, epsilon: number) {\n  const rounded = Math.round(x);\n  return ((rounded - epsilon) <= x) && ((rounded + epsilon) >= x);\n}\n\n/**\n * @private\n */\nexport function _setMinAndMaxByKey(\n  array: Record<string, number>[],\n  target: { min: number, max: number },\n  property: string\n) {\n  let i: number, ilen: number, value: number;\n\n  for (i = 0, ilen = array.length; i < ilen; i++) {\n    value = array[i][property];\n    if (!isNaN(value)) {\n      target.min = Math.min(target.min, value);\n      target.max = Math.max(target.max, value);\n    }\n  }\n}\n\nexport function toRadians(degrees: number) {\n  return degrees * (PI / 180);\n}\n\nexport function toDegrees(radians: number) {\n  return radians * (180 / PI);\n}\n\n/**\n * Returns the number of decimal places\n * i.e. the number of digits after the decimal point, of the value of this Number.\n * @param x - A number.\n * @returns The number of decimal places.\n * @private\n */\nexport function _decimalPlaces(x: number) {\n  if (!isFiniteNumber(x)) {\n    return;\n  }\n  let e = 1;\n  let p = 0;\n  while (Math.round(x * e) / e !== x) {\n    e *= 10;\n    p++;\n  }\n  return p;\n}\n\n// Gets the angle from vertical upright to the point about a centre.\nexport function getAngleFromPoint(\n  centrePoint: Point,\n  anglePoint: Point\n) {\n  const distanceFromXCenter = anglePoint.x - centrePoint.x;\n  const distanceFromYCenter = anglePoint.y - centrePoint.y;\n  const radialDistanceFromCenter = Math.sqrt(distanceFromXCenter * distanceFromXCenter + distanceFromYCenter * distanceFromYCenter);\n\n  let angle = Math.atan2(distanceFromYCenter, distanceFromXCenter);\n\n  if (angle < (-0.5 * PI)) {\n    angle += TAU; // make sure the returned angle is in the range of (-PI/2, 3PI/2]\n  }\n\n  return {\n    angle,\n    distance: radialDistanceFromCenter\n  };\n}\n\nexport function distanceBetweenPoints(pt1: Point, pt2: Point) {\n  return Math.sqrt(Math.pow(pt2.x - pt1.x, 2) + Math.pow(pt2.y - pt1.y, 2));\n}\n\n/**\n * Shortest distance between angles, in either direction.\n * @private\n */\nexport function _angleDiff(a: number, b: number) {\n  return (a - b + PITAU) % TAU - PI;\n}\n\n/**\n * Normalize angle to be between 0 and 2*PI\n * @private\n */\nexport function _normalizeAngle(a: number) {\n  return (a % TAU + TAU) % TAU;\n}\n\n/**\n * @private\n */\nexport function _angleBetween(angle: number, start: number, end: number, sameAngleIsFullCircle?: boolean) {\n  const a = _normalizeAngle(angle);\n  const s = _normalizeAngle(start);\n  const e = _normalizeAngle(end);\n  const angleToStart = _normalizeAngle(s - a);\n  const angleToEnd = _normalizeAngle(e - a);\n  const startToAngle = _normalizeAngle(a - s);\n  const endToAngle = _normalizeAngle(a - e);\n  return a === s || a === e || (sameAngleIsFullCircle && s === e)\n    || (angleToStart > angleToEnd && startToAngle < endToAngle);\n}\n\n/**\n * Limit `value` between `min` and `max`\n * @param value\n * @param min\n * @param max\n * @private\n */\nexport function _limitValue(value: number, min: number, max: number) {\n  return Math.max(min, Math.min(max, value));\n}\n\n/**\n * @param {number} value\n * @private\n */\nexport function _int16Range(value: number) {\n  return _limitValue(value, -32768, 32767);\n}\n\n/**\n * @param value\n * @param start\n * @param end\n * @param [epsilon]\n * @private\n */\nexport function _isBetween(value: number, start: number, end: number, epsilon = 1e-6) {\n  return value >= Math.min(start, end) - epsilon && value <= Math.max(start, end) + epsilon;\n}\n","import {_capitalize} from './helpers.core';\n\n/**\n * Binary search\n * @param table - the table search. must be sorted!\n * @param value - value to find\n * @param cmp\n * @private\n */\nexport function _lookup(\n  table: number[],\n  value: number,\n  cmp?: (value: number) => boolean\n): {lo: number, hi: number};\nexport function _lookup<T>(\n  table: T[],\n  value: number,\n  cmp: (value: number) => boolean\n): {lo: number, hi: number};\nexport function _lookup(\n  table: unknown[],\n  value: number,\n  cmp?: (value: number) => boolean\n) {\n  cmp = cmp || ((index) => table[index] < value);\n  let hi = table.length - 1;\n  let lo = 0;\n  let mid: number;\n\n  while (hi - lo > 1) {\n    mid = (lo + hi) >> 1;\n    if (cmp(mid)) {\n      lo = mid;\n    } else {\n      hi = mid;\n    }\n  }\n\n  return {lo, hi};\n}\n\n/**\n * Binary search\n * @param table - the table search. must be sorted!\n * @param key - property name for the value in each entry\n * @param value - value to find\n * @param last - lookup last index\n * @private\n */\nexport const _lookupByKey = (\n  table: Record<string, number>[],\n  key: string,\n  value: number,\n  last?: boolean\n) =>\n  _lookup(table, value, last\n    ? index => {\n      const ti = table[index][key];\n      return ti < value || ti === value && table[index + 1][key] === value;\n    }\n    : index => table[index][key] < value);\n\n/**\n * Reverse binary search\n * @param table - the table search. must be sorted!\n * @param key - property name for the value in each entry\n * @param value - value to find\n * @private\n */\nexport const _rlookupByKey = (\n  table: Record<string, number>[],\n  key: string,\n  value: number\n) =>\n  _lookup(table, value, index => table[index][key] >= value);\n\n/**\n * Return subset of `values` between `min` and `max` inclusive.\n * Values are assumed to be in sorted order.\n * @param values - sorted array of values\n * @param min - min value\n * @param max - max value\n */\nexport function _filterBetween(values: number[], min: number, max: number) {\n  let start = 0;\n  let end = values.length;\n\n  while (start < end && values[start] < min) {\n    start++;\n  }\n  while (end > start && values[end - 1] > max) {\n    end--;\n  }\n\n  return start > 0 || end < values.length\n    ? values.slice(start, end)\n    : values;\n}\n\nconst arrayEvents = ['push', 'pop', 'shift', 'splice', 'unshift'] as const;\n\nexport interface ArrayListener<T> {\n  _onDataPush?(...item: T[]): void;\n  _onDataPop?(): void;\n  _onDataShift?(): void;\n  _onDataSplice?(index: number, deleteCount: number, ...items: T[]): void;\n  _onDataUnshift?(...item: T[]): void;\n}\n\n/**\n * Hooks the array methods that add or remove values ('push', pop', 'shift', 'splice',\n * 'unshift') and notify the listener AFTER the array has been altered. Listeners are\n * called on the '_onData*' callbacks (e.g. _onDataPush, etc.) with same arguments.\n */\nexport function listenArrayEvents<T>(array: T[], listener: ArrayListener<T>): void;\nexport function listenArrayEvents(array, listener) {\n  if (array._chartjs) {\n    array._chartjs.listeners.push(listener);\n    return;\n  }\n\n  Object.defineProperty(array, '_chartjs', {\n    configurable: true,\n    enumerable: false,\n    value: {\n      listeners: [listener]\n    }\n  });\n\n  arrayEvents.forEach((key) => {\n    const method = '_onData' + _capitalize(key);\n    const base = array[key];\n\n    Object.defineProperty(array, key, {\n      configurable: true,\n      enumerable: false,\n      value(...args) {\n        const res = base.apply(this, args);\n\n        array._chartjs.listeners.forEach((object) => {\n          if (typeof object[method] === 'function') {\n            object[method](...args);\n          }\n        });\n\n        return res;\n      }\n    });\n  });\n}\n\n\n/**\n * Removes the given array event listener and cleanup extra attached properties (such as\n * the _chartjs stub and overridden methods) if array doesn't have any more listeners.\n */\nexport function unlistenArrayEvents<T>(array: T[], listener: ArrayListener<T>): void;\nexport function unlistenArrayEvents(array, listener) {\n  const stub = array._chartjs;\n  if (!stub) {\n    return;\n  }\n\n  const listeners = stub.listeners;\n  const index = listeners.indexOf(listener);\n  if (index !== -1) {\n    listeners.splice(index, 1);\n  }\n\n  if (listeners.length > 0) {\n    return;\n  }\n\n  arrayEvents.forEach((key) => {\n    delete array[key];\n  });\n\n  delete array._chartjs;\n}\n\n/**\n * @param items\n */\nexport function _arrayUnique<T>(items: T[]) {\n  const set = new Set<T>();\n  let i: number, ilen: number;\n\n  for (i = 0, ilen = items.length; i < ilen; ++i) {\n    set.add(items[i]);\n  }\n\n  if (set.size === ilen) {\n    return items;\n  }\n\n  return Array.from(set);\n}\n","import {type ChartMeta, type PointElement} from '../../types';\n\nimport {_limitValue} from './helpers.math';\nimport {_lookupByKey} from './helpers.collection';\n\nexport function fontString(pixelSize: number, fontStyle: string, fontFamily: string) {\n  return fontStyle + ' ' + pixelSize + 'px ' + fontFamily;\n}\n\n/**\n* Request animation polyfill\n*/\nexport const requestAnimFrame = (function() {\n  if (typeof window === 'undefined') {\n    return function(callback) {\n      return callback();\n    };\n  }\n  return window.requestAnimationFrame;\n}());\n\n/**\n * Throttles calling `fn` once per animation frame\n * Latest arguments are used on the actual call\n */\nexport function throttled<TArgs extends Array<any>>(\n  fn: (...args: TArgs) => void,\n  thisArg: any,\n) {\n  let ticking = false;\n\n  return function(...args: TArgs) {\n    if (!ticking) {\n      ticking = true;\n      requestAnimFrame.call(window, () => {\n        ticking = false;\n        fn.apply(thisArg, args);\n      });\n    }\n  };\n}\n\n/**\n * Debounces calling `fn` for `delay` ms\n */\nexport function debounce<TArgs extends Array<any>>(fn: (...args: TArgs) => void, delay: number) {\n  let timeout;\n  return function(...args: TArgs) {\n    if (delay) {\n      clearTimeout(timeout);\n      timeout = setTimeout(fn, delay, args);\n    } else {\n      fn.apply<any, TArgs, void>(this, args);\n    }\n    return delay;\n  };\n}\n\n/**\n * Converts 'start' to 'left', 'end' to 'right' and others to 'center'\n * @private\n */\nexport const _toLeftRightCenter = (align: 'start' | 'end' | 'center') => align === 'start' ? 'left' : align === 'end' ? 'right' : 'center';\n\n/**\n * Returns `start`, `end` or `(start + end) / 2` depending on `align`. Defaults to `center`\n * @private\n */\nexport const _alignStartEnd = (align: 'start' | 'end' | 'center', start: number, end: number) => align === 'start' ? start : align === 'end' ? end : (start + end) / 2;\n\n/**\n * Returns `left`, `right` or `(left + right) / 2` depending on `align`. Defaults to `left`\n * @private\n */\nexport const _textX = (align: 'left' | 'right' | 'center', left: number, right: number, rtl: boolean) => {\n  const check = rtl ? 'left' : 'right';\n  return align === check ? right : align === 'center' ? (left + right) / 2 : left;\n};\n\n/**\n * Return start and count of visible points.\n * @private\n */\nexport function _getStartAndCountOfVisiblePoints(meta: ChartMeta<'line' | 'scatter'>, points: PointElement[], animationsDisabled: boolean) {\n  const pointCount = points.length;\n\n  let start = 0;\n  let count = pointCount;\n\n  if (meta._sorted) {\n    const {iScale, _parsed} = meta;\n    const axis = iScale.axis;\n    const {min, max, minDefined, maxDefined} = iScale.getUserBounds();\n\n    if (minDefined) {\n      start = _limitValue(Math.min(\n        // @ts-expect-error Need to type _parsed\n        _lookupByKey(_parsed, iScale.axis, min).lo,\n        // @ts-expect-error Need to fix types on _lookupByKey\n        animationsDisabled ? pointCount : _lookupByKey(points, axis, iScale.getPixelForValue(min)).lo),\n      0, pointCount - 1);\n    }\n    if (maxDefined) {\n      count = _limitValue(Math.max(\n        // @ts-expect-error Need to type _parsed\n        _lookupByKey(_parsed, iScale.axis, max, true).hi + 1,\n        // @ts-expect-error Need to fix types on _lookupByKey\n        animationsDisabled ? 0 : _lookupByKey(points, axis, iScale.getPixelForValue(max), true).hi + 1),\n      start, pointCount) - start;\n    } else {\n      count = pointCount - start;\n    }\n  }\n\n  return {start, count};\n}\n\n/**\n * Checks if the scale ranges have changed.\n * @param {object} meta - dataset meta.\n * @returns {boolean}\n * @private\n */\nexport function _scaleRangesChanged(meta) {\n  const {xScale, yScale, _scaleRanges} = meta;\n  const newRanges = {\n    xmin: xScale.min,\n    xmax: xScale.max,\n    ymin: yScale.min,\n    ymax: yScale.max\n  };\n  if (!_scaleRanges) {\n    meta._scaleRanges = newRanges;\n    return true;\n  }\n  const changed = _scaleRanges.xmin !== xScale.min\n\t\t|| _scaleRanges.xmax !== xScale.max\n\t\t|| _scaleRanges.ymin !== yScale.min\n\t\t|| _scaleRanges.ymax !== yScale.max;\n\n  Object.assign(_scaleRanges, newRanges);\n  return changed;\n}\n","import {PI, TAU, HALF_PI} from './helpers.math';\n\nconst atEdge = (t: number) => t === 0 || t === 1;\nconst elasticIn = (t: number, s: number, p: number) => -(Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * TAU / p));\nconst elasticOut = (t: number, s: number, p: number) => Math.pow(2, -10 * t) * Math.sin((t - s) * TAU / p) + 1;\n\n/**\n * Easing functions adapted from Robert Penner's easing equations.\n * @namespace Chart.helpers.easing.effects\n * @see http://www.robertpenner.com/easing/\n */\nconst effects = {\n  linear: (t: number) => t,\n\n  easeInQuad: (t: number) => t * t,\n\n  easeOutQuad: (t: number) => -t * (t - 2),\n\n  easeInOutQuad: (t: number) => ((t /= 0.5) < 1)\n    ? 0.5 * t * t\n    : -0.5 * ((--t) * (t - 2) - 1),\n\n  easeInCubic: (t: number) => t * t * t,\n\n  easeOutCubic: (t: number) => (t -= 1) * t * t + 1,\n\n  easeInOutCubic: (t: number) => ((t /= 0.5) < 1)\n    ? 0.5 * t * t * t\n    : 0.5 * ((t -= 2) * t * t + 2),\n\n  easeInQuart: (t: number) => t * t * t * t,\n\n  easeOutQuart: (t: number) => -((t -= 1) * t * t * t - 1),\n\n  easeInOutQuart: (t: number) => ((t /= 0.5) < 1)\n    ? 0.5 * t * t * t * t\n    : -0.5 * ((t -= 2) * t * t * t - 2),\n\n  easeInQuint: (t: number) => t * t * t * t * t,\n\n  easeOutQuint: (t: number) => (t -= 1) * t * t * t * t + 1,\n\n  easeInOutQuint: (t: number) => ((t /= 0.5) < 1)\n    ? 0.5 * t * t * t * t * t\n    : 0.5 * ((t -= 2) * t * t * t * t + 2),\n\n  easeInSine: (t: number) => -Math.cos(t * HALF_PI) + 1,\n\n  easeOutSine: (t: number) => Math.sin(t * HALF_PI),\n\n  easeInOutSine: (t: number) => -0.5 * (Math.cos(PI * t) - 1),\n\n  easeInExpo: (t: number) => (t === 0) ? 0 : Math.pow(2, 10 * (t - 1)),\n\n  easeOutExpo: (t: number) => (t === 1) ? 1 : -Math.pow(2, -10 * t) + 1,\n\n  easeInOutExpo: (t: number) => atEdge(t) ? t : t < 0.5\n    ? 0.5 * Math.pow(2, 10 * (t * 2 - 1))\n    : 0.5 * (-Math.pow(2, -10 * (t * 2 - 1)) + 2),\n\n  easeInCirc: (t: number) => (t >= 1) ? t : -(Math.sqrt(1 - t * t) - 1),\n\n  easeOutCirc: (t: number) => Math.sqrt(1 - (t -= 1) * t),\n\n  easeInOutCirc: (t: number) => ((t /= 0.5) < 1)\n    ? -0.5 * (Math.sqrt(1 - t * t) - 1)\n    : 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1),\n\n  easeInElastic: (t: number) => atEdge(t) ? t : elasticIn(t, 0.075, 0.3),\n\n  easeOutElastic: (t: number) => atEdge(t) ? t : elasticOut(t, 0.075, 0.3),\n\n  easeInOutElastic(t: number) {\n    const s = 0.1125;\n    const p = 0.45;\n    return atEdge(t) ? t :\n      t < 0.5\n        ? 0.5 * elasticIn(t * 2, s, p)\n        : 0.5 + 0.5 * elasticOut(t * 2 - 1, s, p);\n  },\n\n  easeInBack(t: number) {\n    const s = 1.70158;\n    return t * t * ((s + 1) * t - s);\n  },\n\n  easeOutBack(t: number) {\n    const s = 1.70158;\n    return (t -= 1) * t * ((s + 1) * t + s) + 1;\n  },\n\n  easeInOutBack(t: number) {\n    let s = 1.70158;\n    if ((t /= 0.5) < 1) {\n      return 0.5 * (t * t * (((s *= (1.525)) + 1) * t - s));\n    }\n    return 0.5 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2);\n  },\n\n  easeInBounce: (t: number) => 1 - effects.easeOutBounce(1 - t),\n\n  easeOutBounce(t: number) {\n    const m = 7.5625;\n    const d = 2.75;\n    if (t < (1 / d)) {\n      return m * t * t;\n    }\n    if (t < (2 / d)) {\n      return m * (t -= (1.5 / d)) * t + 0.75;\n    }\n    if (t < (2.5 / d)) {\n      return m * (t -= (2.25 / d)) * t + 0.9375;\n    }\n    return m * (t -= (2.625 / d)) * t + 0.984375;\n  },\n\n  easeInOutBounce: (t: number) => (t < 0.5)\n    ? effects.easeInBounce(t * 2) * 0.5\n    : effects.easeOutBounce(t * 2 - 1) * 0.5 + 0.5,\n} as const;\n\nexport type EasingFunction = keyof typeof effects\n\nexport default effects;\n","/*!\n * @kurkle/color v0.2.1\n * https://github.com/kurkle/color#readme\n * (c) 2022 Jukka Kurkela\n * Released under the MIT License\n */\nfunction round(v) {\n  return v + 0.5 | 0;\n}\nconst lim = (v, l, h) => Math.max(Math.min(v, h), l);\nfunction p2b(v) {\n  return lim(round(v * 2.55), 0, 255);\n}\nfunction b2p(v) {\n  return lim(round(v / 2.55), 0, 100);\n}\nfunction n2b(v) {\n  return lim(round(v * 255), 0, 255);\n}\nfunction b2n(v) {\n  return lim(round(v / 2.55) / 100, 0, 1);\n}\nfunction n2p(v) {\n  return lim(round(v * 100), 0, 100);\n}\n\nconst map$1 = {0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 6, 7: 7, 8: 8, 9: 9, A: 10, B: 11, C: 12, D: 13, E: 14, F: 15, a: 10, b: 11, c: 12, d: 13, e: 14, f: 15};\nconst hex = [...'0123456789ABCDEF'];\nconst h1 = b => hex[b & 0xF];\nconst h2 = b => hex[(b & 0xF0) >> 4] + hex[b & 0xF];\nconst eq = b => ((b & 0xF0) >> 4) === (b & 0xF);\nconst isShort = v => eq(v.r) && eq(v.g) && eq(v.b) && eq(v.a);\nfunction hexParse(str) {\n  var len = str.length;\n  var ret;\n  if (str[0] === '#') {\n    if (len === 4 || len === 5) {\n      ret = {\n        r: 255 & map$1[str[1]] * 17,\n        g: 255 & map$1[str[2]] * 17,\n        b: 255 & map$1[str[3]] * 17,\n        a: len === 5 ? map$1[str[4]] * 17 : 255\n      };\n    } else if (len === 7 || len === 9) {\n      ret = {\n        r: map$1[str[1]] << 4 | map$1[str[2]],\n        g: map$1[str[3]] << 4 | map$1[str[4]],\n        b: map$1[str[5]] << 4 | map$1[str[6]],\n        a: len === 9 ? (map$1[str[7]] << 4 | map$1[str[8]]) : 255\n      };\n    }\n  }\n  return ret;\n}\nconst alpha = (a, f) => a < 255 ? f(a) : '';\nfunction hexString(v) {\n  var f = isShort(v) ? h1 : h2;\n  return v\n    ? '#' + f(v.r) + f(v.g) + f(v.b) + alpha(v.a, f)\n    : undefined;\n}\n\nconst HUE_RE = /^(hsla?|hwb|hsv)\\(\\s*([-+.e\\d]+)(?:deg)?[\\s,]+([-+.e\\d]+)%[\\s,]+([-+.e\\d]+)%(?:[\\s,]+([-+.e\\d]+)(%)?)?\\s*\\)$/;\nfunction hsl2rgbn(h, s, l) {\n  const a = s * Math.min(l, 1 - l);\n  const f = (n, k = (n + h / 30) % 12) => l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);\n  return [f(0), f(8), f(4)];\n}\nfunction hsv2rgbn(h, s, v) {\n  const f = (n, k = (n + h / 60) % 6) => v - v * s * Math.max(Math.min(k, 4 - k, 1), 0);\n  return [f(5), f(3), f(1)];\n}\nfunction hwb2rgbn(h, w, b) {\n  const rgb = hsl2rgbn(h, 1, 0.5);\n  let i;\n  if (w + b > 1) {\n    i = 1 / (w + b);\n    w *= i;\n    b *= i;\n  }\n  for (i = 0; i < 3; i++) {\n    rgb[i] *= 1 - w - b;\n    rgb[i] += w;\n  }\n  return rgb;\n}\nfunction hueValue(r, g, b, d, max) {\n  if (r === max) {\n    return ((g - b) / d) + (g < b ? 6 : 0);\n  }\n  if (g === max) {\n    return (b - r) / d + 2;\n  }\n  return (r - g) / d + 4;\n}\nfunction rgb2hsl(v) {\n  const range = 255;\n  const r = v.r / range;\n  const g = v.g / range;\n  const b = v.b / range;\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n  const l = (max + min) / 2;\n  let h, s, d;\n  if (max !== min) {\n    d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    h = hueValue(r, g, b, d, max);\n    h = h * 60 + 0.5;\n  }\n  return [h | 0, s || 0, l];\n}\nfunction calln(f, a, b, c) {\n  return (\n    Array.isArray(a)\n      ? f(a[0], a[1], a[2])\n      : f(a, b, c)\n  ).map(n2b);\n}\nfunction hsl2rgb(h, s, l) {\n  return calln(hsl2rgbn, h, s, l);\n}\nfunction hwb2rgb(h, w, b) {\n  return calln(hwb2rgbn, h, w, b);\n}\nfunction hsv2rgb(h, s, v) {\n  return calln(hsv2rgbn, h, s, v);\n}\nfunction hue(h) {\n  return (h % 360 + 360) % 360;\n}\nfunction hueParse(str) {\n  const m = HUE_RE.exec(str);\n  let a = 255;\n  let v;\n  if (!m) {\n    return;\n  }\n  if (m[5] !== v) {\n    a = m[6] ? p2b(+m[5]) : n2b(+m[5]);\n  }\n  const h = hue(+m[2]);\n  const p1 = +m[3] / 100;\n  const p2 = +m[4] / 100;\n  if (m[1] === 'hwb') {\n    v = hwb2rgb(h, p1, p2);\n  } else if (m[1] === 'hsv') {\n    v = hsv2rgb(h, p1, p2);\n  } else {\n    v = hsl2rgb(h, p1, p2);\n  }\n  return {\n    r: v[0],\n    g: v[1],\n    b: v[2],\n    a: a\n  };\n}\nfunction rotate(v, deg) {\n  var h = rgb2hsl(v);\n  h[0] = hue(h[0] + deg);\n  h = hsl2rgb(h);\n  v.r = h[0];\n  v.g = h[1];\n  v.b = h[2];\n}\nfunction hslString(v) {\n  if (!v) {\n    return;\n  }\n  const a = rgb2hsl(v);\n  const h = a[0];\n  const s = n2p(a[1]);\n  const l = n2p(a[2]);\n  return v.a < 255\n    ? `hsla(${h}, ${s}%, ${l}%, ${b2n(v.a)})`\n    : `hsl(${h}, ${s}%, ${l}%)`;\n}\n\nconst map = {\n  x: 'dark',\n  Z: 'light',\n  Y: 're',\n  X: 'blu',\n  W: 'gr',\n  V: 'medium',\n  U: 'slate',\n  A: 'ee',\n  T: 'ol',\n  S: 'or',\n  B: 'ra',\n  C: 'lateg',\n  D: 'ights',\n  R: 'in',\n  Q: 'turquois',\n  E: 'hi',\n  P: 'ro',\n  O: 'al',\n  N: 'le',\n  M: 'de',\n  L: 'yello',\n  F: 'en',\n  K: 'ch',\n  G: 'arks',\n  H: 'ea',\n  I: 'ightg',\n  J: 'wh'\n};\nconst names$1 = {\n  OiceXe: 'f0f8ff',\n  antiquewEte: 'faebd7',\n  aqua: 'ffff',\n  aquamarRe: '7fffd4',\n  azuY: 'f0ffff',\n  beige: 'f5f5dc',\n  bisque: 'ffe4c4',\n  black: '0',\n  blanKedOmond: 'ffebcd',\n  Xe: 'ff',\n  XeviTet: '8a2be2',\n  bPwn: 'a52a2a',\n  burlywood: 'deb887',\n  caMtXe: '5f9ea0',\n  KartYuse: '7fff00',\n  KocTate: 'd2691e',\n  cSO: 'ff7f50',\n  cSnflowerXe: '6495ed',\n  cSnsilk: 'fff8dc',\n  crimson: 'dc143c',\n  cyan: 'ffff',\n  xXe: '8b',\n  xcyan: '8b8b',\n  xgTMnPd: 'b8860b',\n  xWay: 'a9a9a9',\n  xgYF: '6400',\n  xgYy: 'a9a9a9',\n  xkhaki: 'bdb76b',\n  xmagFta: '8b008b',\n  xTivegYF: '556b2f',\n  xSange: 'ff8c00',\n  xScEd: '9932cc',\n  xYd: '8b0000',\n  xsOmon: 'e9967a',\n  xsHgYF: '8fbc8f',\n  xUXe: '483d8b',\n  xUWay: '2f4f4f',\n  xUgYy: '2f4f4f',\n  xQe: 'ced1',\n  xviTet: '9400d3',\n  dAppRk: 'ff1493',\n  dApskyXe: 'bfff',\n  dimWay: '696969',\n  dimgYy: '696969',\n  dodgerXe: '1e90ff',\n  fiYbrick: 'b22222',\n  flSOwEte: 'fffaf0',\n  foYstWAn: '228b22',\n  fuKsia: 'ff00ff',\n  gaRsbSo: 'dcdcdc',\n  ghostwEte: 'f8f8ff',\n  gTd: 'ffd700',\n  gTMnPd: 'daa520',\n  Way: '808080',\n  gYF: '8000',\n  gYFLw: 'adff2f',\n  gYy: '808080',\n  honeyMw: 'f0fff0',\n  hotpRk: 'ff69b4',\n  RdianYd: 'cd5c5c',\n  Rdigo: '4b0082',\n  ivSy: 'fffff0',\n  khaki: 'f0e68c',\n  lavFMr: 'e6e6fa',\n  lavFMrXsh: 'fff0f5',\n  lawngYF: '7cfc00',\n  NmoncEffon: 'fffacd',\n  ZXe: 'add8e6',\n  ZcSO: 'f08080',\n  Zcyan: 'e0ffff',\n  ZgTMnPdLw: 'fafad2',\n  ZWay: 'd3d3d3',\n  ZgYF: '90ee90',\n  ZgYy: 'd3d3d3',\n  ZpRk: 'ffb6c1',\n  ZsOmon: 'ffa07a',\n  ZsHgYF: '20b2aa',\n  ZskyXe: '87cefa',\n  ZUWay: '778899',\n  ZUgYy: '778899',\n  ZstAlXe: 'b0c4de',\n  ZLw: 'ffffe0',\n  lime: 'ff00',\n  limegYF: '32cd32',\n  lRF: 'faf0e6',\n  magFta: 'ff00ff',\n  maPon: '800000',\n  VaquamarRe: '66cdaa',\n  VXe: 'cd',\n  VScEd: 'ba55d3',\n  VpurpN: '9370db',\n  VsHgYF: '3cb371',\n  VUXe: '7b68ee',\n  VsprRggYF: 'fa9a',\n  VQe: '48d1cc',\n  VviTetYd: 'c71585',\n  midnightXe: '191970',\n  mRtcYam: 'f5fffa',\n  mistyPse: 'ffe4e1',\n  moccasR: 'ffe4b5',\n  navajowEte: 'ffdead',\n  navy: '80',\n  Tdlace: 'fdf5e6',\n  Tive: '808000',\n  TivedBb: '6b8e23',\n  Sange: 'ffa500',\n  SangeYd: 'ff4500',\n  ScEd: 'da70d6',\n  pOegTMnPd: 'eee8aa',\n  pOegYF: '98fb98',\n  pOeQe: 'afeeee',\n  pOeviTetYd: 'db7093',\n  papayawEp: 'ffefd5',\n  pHKpuff: 'ffdab9',\n  peru: 'cd853f',\n  pRk: 'ffc0cb',\n  plum: 'dda0dd',\n  powMrXe: 'b0e0e6',\n  purpN: '800080',\n  YbeccapurpN: '663399',\n  Yd: 'ff0000',\n  Psybrown: 'bc8f8f',\n  PyOXe: '4169e1',\n  saddNbPwn: '8b4513',\n  sOmon: 'fa8072',\n  sandybPwn: 'f4a460',\n  sHgYF: '2e8b57',\n  sHshell: 'fff5ee',\n  siFna: 'a0522d',\n  silver: 'c0c0c0',\n  skyXe: '87ceeb',\n  UXe: '6a5acd',\n  UWay: '708090',\n  UgYy: '708090',\n  snow: 'fffafa',\n  sprRggYF: 'ff7f',\n  stAlXe: '4682b4',\n  tan: 'd2b48c',\n  teO: '8080',\n  tEstN: 'd8bfd8',\n  tomato: 'ff6347',\n  Qe: '40e0d0',\n  viTet: 'ee82ee',\n  JHt: 'f5deb3',\n  wEte: 'ffffff',\n  wEtesmoke: 'f5f5f5',\n  Lw: 'ffff00',\n  LwgYF: '9acd32'\n};\nfunction unpack() {\n  const unpacked = {};\n  const keys = Object.keys(names$1);\n  const tkeys = Object.keys(map);\n  let i, j, k, ok, nk;\n  for (i = 0; i < keys.length; i++) {\n    ok = nk = keys[i];\n    for (j = 0; j < tkeys.length; j++) {\n      k = tkeys[j];\n      nk = nk.replace(k, map[k]);\n    }\n    k = parseInt(names$1[ok], 16);\n    unpacked[nk] = [k >> 16 & 0xFF, k >> 8 & 0xFF, k & 0xFF];\n  }\n  return unpacked;\n}\n\nlet names;\nfunction nameParse(str) {\n  if (!names) {\n    names = unpack();\n    names.transparent = [0, 0, 0, 0];\n  }\n  const a = names[str.toLowerCase()];\n  return a && {\n    r: a[0],\n    g: a[1],\n    b: a[2],\n    a: a.length === 4 ? a[3] : 255\n  };\n}\n\nconst RGB_RE = /^rgba?\\(\\s*([-+.\\d]+)(%)?[\\s,]+([-+.e\\d]+)(%)?[\\s,]+([-+.e\\d]+)(%)?(?:[\\s,/]+([-+.e\\d]+)(%)?)?\\s*\\)$/;\nfunction rgbParse(str) {\n  const m = RGB_RE.exec(str);\n  let a = 255;\n  let r, g, b;\n  if (!m) {\n    return;\n  }\n  if (m[7] !== r) {\n    const v = +m[7];\n    a = m[8] ? p2b(v) : lim(v * 255, 0, 255);\n  }\n  r = +m[1];\n  g = +m[3];\n  b = +m[5];\n  r = 255 & (m[2] ? p2b(r) : lim(r, 0, 255));\n  g = 255 & (m[4] ? p2b(g) : lim(g, 0, 255));\n  b = 255 & (m[6] ? p2b(b) : lim(b, 0, 255));\n  return {\n    r: r,\n    g: g,\n    b: b,\n    a: a\n  };\n}\nfunction rgbString(v) {\n  return v && (\n    v.a < 255\n      ? `rgba(${v.r}, ${v.g}, ${v.b}, ${b2n(v.a)})`\n      : `rgb(${v.r}, ${v.g}, ${v.b})`\n  );\n}\n\nconst to = v => v <= 0.0031308 ? v * 12.92 : Math.pow(v, 1.0 / 2.4) * 1.055 - 0.055;\nconst from = v => v <= 0.04045 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);\nfunction interpolate(rgb1, rgb2, t) {\n  const r = from(b2n(rgb1.r));\n  const g = from(b2n(rgb1.g));\n  const b = from(b2n(rgb1.b));\n  return {\n    r: n2b(to(r + t * (from(b2n(rgb2.r)) - r))),\n    g: n2b(to(g + t * (from(b2n(rgb2.g)) - g))),\n    b: n2b(to(b + t * (from(b2n(rgb2.b)) - b))),\n    a: rgb1.a + t * (rgb2.a - rgb1.a)\n  };\n}\n\nfunction modHSL(v, i, ratio) {\n  if (v) {\n    let tmp = rgb2hsl(v);\n    tmp[i] = Math.max(0, Math.min(tmp[i] + tmp[i] * ratio, i === 0 ? 360 : 1));\n    tmp = hsl2rgb(tmp);\n    v.r = tmp[0];\n    v.g = tmp[1];\n    v.b = tmp[2];\n  }\n}\nfunction clone(v, proto) {\n  return v ? Object.assign(proto || {}, v) : v;\n}\nfunction fromObject(input) {\n  var v = {r: 0, g: 0, b: 0, a: 255};\n  if (Array.isArray(input)) {\n    if (input.length >= 3) {\n      v = {r: input[0], g: input[1], b: input[2], a: 255};\n      if (input.length > 3) {\n        v.a = n2b(input[3]);\n      }\n    }\n  } else {\n    v = clone(input, {r: 0, g: 0, b: 0, a: 1});\n    v.a = n2b(v.a);\n  }\n  return v;\n}\nfunction functionParse(str) {\n  if (str.charAt(0) === 'r') {\n    return rgbParse(str);\n  }\n  return hueParse(str);\n}\nclass Color {\n  constructor(input) {\n    if (input instanceof Color) {\n      return input;\n    }\n    const type = typeof input;\n    let v;\n    if (type === 'object') {\n      v = fromObject(input);\n    } else if (type === 'string') {\n      v = hexParse(input) || nameParse(input) || functionParse(input);\n    }\n    this._rgb = v;\n    this._valid = !!v;\n  }\n  get valid() {\n    return this._valid;\n  }\n  get rgb() {\n    var v = clone(this._rgb);\n    if (v) {\n      v.a = b2n(v.a);\n    }\n    return v;\n  }\n  set rgb(obj) {\n    this._rgb = fromObject(obj);\n  }\n  rgbString() {\n    return this._valid ? rgbString(this._rgb) : undefined;\n  }\n  hexString() {\n    return this._valid ? hexString(this._rgb) : undefined;\n  }\n  hslString() {\n    return this._valid ? hslString(this._rgb) : undefined;\n  }\n  mix(color, weight) {\n    if (color) {\n      const c1 = this.rgb;\n      const c2 = color.rgb;\n      let w2;\n      const p = weight === w2 ? 0.5 : weight;\n      const w = 2 * p - 1;\n      const a = c1.a - c2.a;\n      const w1 = ((w * a === -1 ? w : (w + a) / (1 + w * a)) + 1) / 2.0;\n      w2 = 1 - w1;\n      c1.r = 0xFF & w1 * c1.r + w2 * c2.r + 0.5;\n      c1.g = 0xFF & w1 * c1.g + w2 * c2.g + 0.5;\n      c1.b = 0xFF & w1 * c1.b + w2 * c2.b + 0.5;\n      c1.a = p * c1.a + (1 - p) * c2.a;\n      this.rgb = c1;\n    }\n    return this;\n  }\n  interpolate(color, t) {\n    if (color) {\n      this._rgb = interpolate(this._rgb, color._rgb, t);\n    }\n    return this;\n  }\n  clone() {\n    return new Color(this.rgb);\n  }\n  alpha(a) {\n    this._rgb.a = n2b(a);\n    return this;\n  }\n  clearer(ratio) {\n    const rgb = this._rgb;\n    rgb.a *= 1 - ratio;\n    return this;\n  }\n  greyscale() {\n    const rgb = this._rgb;\n    const val = round(rgb.r * 0.3 + rgb.g * 0.59 + rgb.b * 0.11);\n    rgb.r = rgb.g = rgb.b = val;\n    return this;\n  }\n  opaquer(ratio) {\n    const rgb = this._rgb;\n    rgb.a *= 1 + ratio;\n    return this;\n  }\n  negate() {\n    const v = this._rgb;\n    v.r = 255 - v.r;\n    v.g = 255 - v.g;\n    v.b = 255 - v.b;\n    return this;\n  }\n  lighten(ratio) {\n    modHSL(this._rgb, 2, ratio);\n    return this;\n  }\n  darken(ratio) {\n    modHSL(this._rgb, 2, -ratio);\n    return this;\n  }\n  saturate(ratio) {\n    modHSL(this._rgb, 1, ratio);\n    return this;\n  }\n  desaturate(ratio) {\n    modHSL(this._rgb, 1, -ratio);\n    return this;\n  }\n  rotate(deg) {\n    rotate(this._rgb, deg);\n    return this;\n  }\n}\n\nfunction index_esm(input) {\n  return new Color(input);\n}\n\nexport { Color, b2n, b2p, index_esm as default, hexParse, hexString, hsl2rgb, hslString, hsv2rgb, hueParse, hwb2rgb, lim, n2b, n2p, nameParse, p2b, rgb2hsl, rgbParse, rgbString, rotate, round };\n","import colorLib, {Color} from '@kurkle/color';\n\nexport function isPatternOrGradient(value: unknown): value is CanvasPattern | CanvasGradient {\n  if (value && typeof value === 'object') {\n    const type = value.toString();\n    return type === '[object CanvasPattern]' || type === '[object CanvasGradient]';\n  }\n\n  return false;\n}\n\nexport function color(value: CanvasGradient): CanvasGradient;\nexport function color(value: CanvasPattern): CanvasPattern;\nexport function color(\n  value:\n  | string\n  | { r: number; g: number; b: number; a: number }\n  | [number, number, number]\n  | [number, number, number, number]\n): Color;\nexport function color(value) {\n  return isPatternOrGradient(value) ? value : colorLib(value);\n}\n\nexport function getHoverColor(value: CanvasGradient): CanvasGradient;\nexport function getHoverColor(value: CanvasPattern): CanvasPattern;\nexport function getHoverColor(value: string): string;\nexport function getHoverColor(value) {\n  return isPatternOrGradient(value)\n    ? value\n    : colorLib(value).saturate(0.5).darken(0.1).hexString();\n}\n","const numbers = ['x', 'y', 'borderWidth', 'radius', 'tension'];\nconst colors = ['color', 'borderColor', 'backgroundColor'];\n\nexport function applyAnimationsDefaults(defaults) {\n  defaults.set('animation', {\n    delay: undefined,\n    duration: 1000,\n    easing: 'easeOutQuart',\n    fn: undefined,\n    from: undefined,\n    loop: undefined,\n    to: undefined,\n    type: undefined,\n  });\n\n  defaults.describe('animation', {\n    _fallback: false,\n    _indexable: false,\n    _scriptable: (name) => name !== 'onProgress' && name !== 'onComplete' && name !== 'fn',\n  });\n\n  defaults.set('animations', {\n    colors: {\n      type: 'color',\n      properties: colors\n    },\n    numbers: {\n      type: 'number',\n      properties: numbers\n    },\n  });\n\n  defaults.describe('animations', {\n    _fallback: 'animation',\n  });\n\n  defaults.set('transitions', {\n    active: {\n      animation: {\n        duration: 400\n      }\n    },\n    resize: {\n      animation: {\n        duration: 0\n      }\n    },\n    show: {\n      animations: {\n        colors: {\n          from: 'transparent'\n        },\n        visible: {\n          type: 'boolean',\n          duration: 0 // show immediately\n        },\n      }\n    },\n    hide: {\n      animations: {\n        colors: {\n          to: 'transparent'\n        },\n        visible: {\n          type: 'boolean',\n          easing: 'linear',\n          fn: v => v | 0 // for keeping the dataset visible all the way through the animation\n        },\n      }\n    }\n  });\n}\n","export function applyLayoutsDefaults(defaults) {\n  defaults.set('layout', {\n    autoPadding: true,\n    padding: {\n      top: 0,\n      right: 0,\n      bottom: 0,\n      left: 0\n    }\n  });\n}\n","\nconst intlCache = new Map<string, Intl.NumberFormat>();\n\nfunction getNumberFormat(locale: string, options?: Intl.NumberFormatOptions) {\n  options = options || {};\n  const cacheKey = locale + JSON.stringify(options);\n  let formatter = intlCache.get(cacheKey);\n  if (!formatter) {\n    formatter = new Intl.NumberFormat(locale, options);\n    intlCache.set(cacheKey, formatter);\n  }\n  return formatter;\n}\n\nexport function formatNumber(num: number, locale: string, options?: Intl.NumberFormatOptions) {\n  return getNumberFormat(locale, options).format(num);\n}\n","import {isArray} from '../helpers/helpers.core';\nimport {formatNumber} from '../helpers/helpers.intl';\nimport {log10} from '../helpers/helpers.math';\n\n/**\n * Namespace to hold formatters for different types of ticks\n * @namespace Chart.Ticks.formatters\n */\nconst formatters = {\n  /**\n   * Formatter for value labels\n   * @method Chart.Ticks.formatters.values\n   * @param value the value to display\n   * @return {string|string[]} the label to display\n   */\n  values(value) {\n    return isArray(value) ? /** @type {string[]} */ (value) : '' + value;\n  },\n\n  /**\n   * Formatter for numeric ticks\n   * @method Chart.Ticks.formatters.numeric\n   * @param tickValue {number} the value to be formatted\n   * @param index {number} the position of the tickValue parameter in the ticks array\n   * @param ticks {object[]} the list of ticks being converted\n   * @return {string} string representation of the tickValue parameter\n   */\n  numeric(tickValue, index, ticks) {\n    if (tickValue === 0) {\n      return '0'; // never show decimal places for 0\n    }\n\n    const locale = this.chart.options.locale;\n    let notation;\n    let delta = tickValue; // This is used when there are less than 2 ticks as the tick interval.\n\n    if (ticks.length > 1) {\n      // all ticks are small or there huge numbers; use scientific notation\n      const maxTick = Math.max(Math.abs(ticks[0].value), Math.abs(ticks[ticks.length - 1].value));\n      if (maxTick < 1e-4 || maxTick > 1e+15) {\n        notation = 'scientific';\n      }\n\n      delta = calculateDelta(tickValue, ticks);\n    }\n\n    const logDelta = log10(Math.abs(delta));\n    const numDecimal = Math.max(Math.min(-1 * Math.floor(logDelta), 20), 0); // toFixed has a max of 20 decimal places\n\n    const options = {notation, minimumFractionDigits: numDecimal, maximumFractionDigits: numDecimal};\n    Object.assign(options, this.options.ticks.format);\n\n    return formatNumber(tickValue, locale, options);\n  },\n\n\n  /**\n   * Formatter for logarithmic ticks\n   * @method Chart.Ticks.formatters.logarithmic\n   * @param tickValue {number} the value to be formatted\n   * @param index {number} the position of the tickValue parameter in the ticks array\n   * @param ticks {object[]} the list of ticks being converted\n   * @return {string} string representation of the tickValue parameter\n   */\n  logarithmic(tickValue, index, ticks) {\n    if (tickValue === 0) {\n      return '0';\n    }\n    const remain = ticks[index].significand || (tickValue / (Math.pow(10, Math.floor(log10(tickValue)))));\n    if ([1, 2, 3, 5, 10, 15].includes(remain) || index > 0.8 * ticks.length) {\n      return formatters.numeric.call(this, tickValue, index, ticks);\n    }\n    return '';\n  }\n\n};\n\n\nfunction calculateDelta(tickValue, ticks) {\n  // Figure out how many digits to show\n  // The space between the first two ticks might be smaller than normal spacing\n  let delta = ticks.length > 3 ? ticks[2].value - ticks[1].value : ticks[1].value - ticks[0].value;\n\n  // If we have a number like 2.5 as the delta, figure out how many decimal places we need\n  if (Math.abs(delta) >= 1 && tickValue !== Math.floor(tickValue)) {\n    // not an integer\n    delta = tickValue - Math.floor(tickValue);\n  }\n  return delta;\n}\n\n/**\n * Namespace to hold static tick generation functions\n * @namespace Chart.Ticks\n */\nexport default {formatters};\n","import Ticks from './core.ticks';\n\nexport function applyScaleDefaults(defaults) {\n  defaults.set('scale', {\n    display: true,\n    offset: false,\n    reverse: false,\n    beginAtZero: false,\n\n    /**\n     * Scale boundary strategy (bypassed by min/max time options)\n     * - `data`: make sure data are fully visible, ticks outside are removed\n     * - `ticks`: make sure ticks are fully visible, data outside are truncated\n     * @see https://github.com/chartjs/Chart.js/pull/4556\n     * @since 3.0.0\n     */\n    bounds: 'ticks',\n\n    /**\n     * Addition grace added to max and reduced from min data value.\n     * @since 3.0.0\n     */\n    grace: 0,\n\n    // grid line settings\n    grid: {\n      display: true,\n      lineWidth: 1,\n      drawOnChartArea: true,\n      drawTicks: true,\n      tickLength: 8,\n      tickWidth: (_ctx, options) => options.lineWidth,\n      tickColor: (_ctx, options) => options.color,\n      offset: false,\n    },\n\n    border: {\n      display: true,\n      dash: [],\n      dashOffset: 0.0,\n      width: 1\n    },\n\n    // scale title\n    title: {\n      // display property\n      display: false,\n\n      // actual label\n      text: '',\n\n      // top/bottom padding\n      padding: {\n        top: 4,\n        bottom: 4\n      }\n    },\n\n    // label settings\n    ticks: {\n      minRotation: 0,\n      maxRotation: 50,\n      mirror: false,\n      textStrokeWidth: 0,\n      textStrokeColor: '',\n      padding: 3,\n      display: true,\n      autoSkip: true,\n      autoSkipPadding: 3,\n      labelOffset: 0,\n      // We pass through arrays to be rendered as multiline labels, we convert Others to strings here.\n      callback: Ticks.formatters.values,\n      minor: {},\n      major: {},\n      align: 'center',\n      crossAlign: 'near',\n\n      showLabelBackdrop: false,\n      backdropColor: 'rgba(255, 255, 255, 0.75)',\n      backdropPadding: 2,\n    }\n  });\n\n  defaults.route('scale.ticks', 'color', '', 'color');\n  defaults.route('scale.grid', 'color', '', 'borderColor');\n  defaults.route('scale.border', 'color', '', 'borderColor');\n  defaults.route('scale.title', 'color', '', 'color');\n\n  defaults.describe('scale', {\n    _fallback: false,\n    _scriptable: (name) => !name.startsWith('before') && !name.startsWith('after') && name !== 'callback' && name !== 'parser',\n    _indexable: (name) => name !== 'borderDash' && name !== 'tickBorderDash' && name !== 'dash',\n  });\n\n  defaults.describe('scales', {\n    _fallback: 'scale',\n  });\n\n  defaults.describe('scale.ticks', {\n    _scriptable: (name) => name !== 'backdropPadding' && name !== 'callback',\n    _indexable: (name) => name !== 'backdropPadding',\n  });\n}\n","import {getHoverColor} from '../helpers/helpers.color';\nimport {isObject, merge, valueOrDefault} from '../helpers/helpers.core';\nimport {applyAnimationsDefaults} from './core.animations.defaults';\nimport {applyLayoutsDefaults} from './core.layouts.defaults';\nimport {applyScaleDefaults} from './core.scale.defaults';\n\nexport const overrides = Object.create(null);\nexport const descriptors = Object.create(null);\n\n/**\n * @param {object} node\n * @param {string} key\n * @return {object}\n */\nfunction getScope(node, key) {\n  if (!key) {\n    return node;\n  }\n  const keys = key.split('.');\n  for (let i = 0, n = keys.length; i < n; ++i) {\n    const k = keys[i];\n    node = node[k] || (node[k] = Object.create(null));\n  }\n  return node;\n}\n\nfunction set(root, scope, values) {\n  if (typeof scope === 'string') {\n    return merge(getScope(root, scope), values);\n  }\n  return merge(getScope(root, ''), scope);\n}\n\n/**\n * Please use the module's default export which provides a singleton instance\n * Note: class is exported for typedoc\n */\nexport class Defaults {\n  constructor(_descriptors, _appliers) {\n    this.animation = undefined;\n    this.backgroundColor = 'rgba(0,0,0,0.1)';\n    this.borderColor = 'rgba(0,0,0,0.1)';\n    this.color = '#666';\n    this.datasets = {};\n    this.devicePixelRatio = (context) => context.chart.platform.getDevicePixelRatio();\n    this.elements = {};\n    this.events = [\n      'mousemove',\n      'mouseout',\n      'click',\n      'touchstart',\n      'touchmove'\n    ];\n    this.font = {\n      family: \"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif\",\n      size: 12,\n      style: 'normal',\n      lineHeight: 1.2,\n      weight: null\n    };\n    this.hover = {};\n    this.hoverBackgroundColor = (ctx, options) => getHoverColor(options.backgroundColor);\n    this.hoverBorderColor = (ctx, options) => getHoverColor(options.borderColor);\n    this.hoverColor = (ctx, options) => getHoverColor(options.color);\n    this.indexAxis = 'x';\n    this.interaction = {\n      mode: 'nearest',\n      intersect: true,\n      includeInvisible: false\n    };\n    this.maintainAspectRatio = true;\n    this.onHover = null;\n    this.onClick = null;\n    this.parsing = true;\n    this.plugins = {};\n    this.responsive = true;\n    this.scale = undefined;\n    this.scales = {};\n    this.showLine = true;\n    this.drawActiveElementsOnTop = true;\n\n    this.describe(_descriptors);\n    this.apply(_appliers);\n  }\n\n  /**\n\t * @param {string|object} scope\n\t * @param {object} [values]\n\t */\n  set(scope, values) {\n    return set(this, scope, values);\n  }\n\n  /**\n\t * @param {string} scope\n\t */\n  get(scope) {\n    return getScope(this, scope);\n  }\n\n  /**\n\t * @param {string|object} scope\n\t * @param {object} [values]\n\t */\n  describe(scope, values) {\n    return set(descriptors, scope, values);\n  }\n\n  override(scope, values) {\n    return set(overrides, scope, values);\n  }\n\n  /**\n\t * Routes the named defaults to fallback to another scope/name.\n\t * This routing is useful when those target values, like defaults.color, are changed runtime.\n\t * If the values would be copied, the runtime change would not take effect. By routing, the\n\t * fallback is evaluated at each access, so its always up to date.\n\t *\n\t * Example:\n\t *\n\t * \tdefaults.route('elements.arc', 'backgroundColor', '', 'color')\n\t *   - reads the backgroundColor from defaults.color when undefined locally\n\t *\n\t * @param {string} scope Scope this route applies to.\n\t * @param {string} name Property name that should be routed to different namespace when not defined here.\n\t * @param {string} targetScope The namespace where those properties should be routed to.\n\t * Empty string ('') is the root of defaults.\n\t * @param {string} targetName The target name in the target scope the property should be routed to.\n\t */\n  route(scope, name, targetScope, targetName) {\n    const scopeObject = getScope(this, scope);\n    const targetScopeObject = getScope(this, targetScope);\n    const privateName = '_' + name;\n\n    Object.defineProperties(scopeObject, {\n      // A private property is defined to hold the actual value, when this property is set in its scope (set in the setter)\n      [privateName]: {\n        value: scopeObject[name],\n        writable: true\n      },\n      // The actual property is defined as getter/setter so we can do the routing when value is not locally set.\n      [name]: {\n        enumerable: true,\n        get() {\n          const local = this[privateName];\n          const target = targetScopeObject[targetName];\n          if (isObject(local)) {\n            return Object.assign({}, target, local);\n          }\n          return valueOrDefault(local, target);\n        },\n        set(value) {\n          this[privateName] = value;\n        }\n      }\n    });\n  }\n\n  apply(appliers) {\n    appliers.forEach((apply) => apply(this));\n  }\n}\n\n// singleton instance\nexport default /* #__PURE__ */ new Defaults({\n  _scriptable: (name) => !name.startsWith('on'),\n  _indexable: (name) => name !== 'events',\n  hover: {\n    _fallback: 'interaction'\n  },\n  interaction: {\n    _scriptable: false,\n    _indexable: false,\n  }\n}, [applyAnimationsDefaults, applyLayoutsDefaults, applyScaleDefaults]);\n","import {isArray, isNullOrUndef} from './helpers.core';\nimport {PI, TAU, HALF_PI, QUARTER_PI, TWO_THIRDS_PI, RAD_PER_DEG} from './helpers.math';\n\n/**\n * Note: typedefs are auto-exported, so use a made-up `canvas` namespace where\n * necessary to avoid duplicates with `export * from './helpers`; see\n * https://github.com/microsoft/TypeScript/issues/46011\n * @typedef { import(\"../core/core.controller\").default } canvas.Chart\n * @typedef { import(\"../../types\").Point } Point\n */\n\n/**\n * @namespace Chart.helpers.canvas\n */\n\n/**\n * Converts the given font object into a CSS font string.\n * @param {object} font - A font object.\n * @return {string|null} The CSS font string. See https://developer.mozilla.org/en-US/docs/Web/CSS/font\n * @private\n */\nexport function toFontString(font) {\n  if (!font || isNullOrUndef(font.size) || isNullOrUndef(font.family)) {\n    return null;\n  }\n\n  return (font.style ? font.style + ' ' : '')\n\t\t+ (font.weight ? font.weight + ' ' : '')\n\t\t+ font.size + 'px '\n\t\t+ font.family;\n}\n\n/**\n * @private\n */\nexport function _measureText(ctx, data, gc, longest, string) {\n  let textWidth = data[string];\n  if (!textWidth) {\n    textWidth = data[string] = ctx.measureText(string).width;\n    gc.push(string);\n  }\n  if (textWidth > longest) {\n    longest = textWidth;\n  }\n  return longest;\n}\n\n/**\n * @private\n */\nexport function _longestText(ctx, font, arrayOfThings, cache) {\n  cache = cache || {};\n  let data = cache.data = cache.data || {};\n  let gc = cache.garbageCollect = cache.garbageCollect || [];\n\n  if (cache.font !== font) {\n    data = cache.data = {};\n    gc = cache.garbageCollect = [];\n    cache.font = font;\n  }\n\n  ctx.save();\n\n  ctx.font = font;\n  let longest = 0;\n  const ilen = arrayOfThings.length;\n  let i, j, jlen, thing, nestedThing;\n  for (i = 0; i < ilen; i++) {\n    thing = arrayOfThings[i];\n\n    // Undefined strings and arrays should not be measured\n    if (thing !== undefined && thing !== null && isArray(thing) !== true) {\n      longest = _measureText(ctx, data, gc, longest, thing);\n    } else if (isArray(thing)) {\n      // if it is an array lets measure each element\n      // to do maybe simplify this function a bit so we can do this more recursively?\n      for (j = 0, jlen = thing.length; j < jlen; j++) {\n        nestedThing = thing[j];\n        // Undefined strings and arrays should not be measured\n        if (nestedThing !== undefined && nestedThing !== null && !isArray(nestedThing)) {\n          longest = _measureText(ctx, data, gc, longest, nestedThing);\n        }\n      }\n    }\n  }\n\n  ctx.restore();\n\n  const gcLen = gc.length / 2;\n  if (gcLen > arrayOfThings.length) {\n    for (i = 0; i < gcLen; i++) {\n      delete data[gc[i]];\n    }\n    gc.splice(0, gcLen);\n  }\n  return longest;\n}\n\n/**\n * Returns the aligned pixel value to avoid anti-aliasing blur\n * @param {canvas.Chart} chart - The chart instance.\n * @param {number} pixel - A pixel value.\n * @param {number} width - The width of the element.\n * @returns {number} The aligned pixel value.\n * @private\n */\nexport function _alignPixel(chart, pixel, width) {\n  const devicePixelRatio = chart.currentDevicePixelRatio;\n  const halfWidth = width !== 0 ? Math.max(width / 2, 0.5) : 0;\n  return Math.round((pixel - halfWidth) * devicePixelRatio) / devicePixelRatio + halfWidth;\n}\n\n/**\n * Clears the entire canvas.\n * @param {HTMLCanvasElement} canvas\n * @param {CanvasRenderingContext2D} [ctx]\n */\nexport function clearCanvas(canvas, ctx) {\n  ctx = ctx || canvas.getContext('2d');\n\n  ctx.save();\n  // canvas.width and canvas.height do not consider the canvas transform,\n  // while clearRect does\n  ctx.resetTransform();\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  ctx.restore();\n}\n\nexport function drawPoint(ctx, options, x, y) {\n  drawPointLegend(ctx, options, x, y, null);\n}\n\nexport function drawPointLegend(ctx, options, x, y, w) {\n  let type, xOffset, yOffset, size, cornerRadius, width, xOffsetW, yOffsetW;\n  const style = options.pointStyle;\n  const rotation = options.rotation;\n  const radius = options.radius;\n  let rad = (rotation || 0) * RAD_PER_DEG;\n\n  if (style && typeof style === 'object') {\n    type = style.toString();\n    if (type === '[object HTMLImageElement]' || type === '[object HTMLCanvasElement]') {\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.rotate(rad);\n      ctx.drawImage(style, -style.width / 2, -style.height / 2, style.width, style.height);\n      ctx.restore();\n      return;\n    }\n  }\n\n  if (isNaN(radius) || radius <= 0) {\n    return;\n  }\n\n  ctx.beginPath();\n\n  switch (style) {\n  // Default includes circle\n  default:\n    if (w) {\n      ctx.ellipse(x, y, w / 2, radius, 0, 0, TAU);\n    } else {\n      ctx.arc(x, y, radius, 0, TAU);\n    }\n    ctx.closePath();\n    break;\n  case 'triangle':\n    width = w ? w / 2 : radius;\n    ctx.moveTo(x + Math.sin(rad) * width, y - Math.cos(rad) * radius);\n    rad += TWO_THIRDS_PI;\n    ctx.lineTo(x + Math.sin(rad) * width, y - Math.cos(rad) * radius);\n    rad += TWO_THIRDS_PI;\n    ctx.lineTo(x + Math.sin(rad) * width, y - Math.cos(rad) * radius);\n    ctx.closePath();\n    break;\n  case 'rectRounded':\n    // NOTE: the rounded rect implementation changed to use `arc` instead of\n    // `quadraticCurveTo` since it generates better results when rect is\n    // almost a circle. 0.516 (instead of 0.5) produces results with visually\n    // closer proportion to the previous impl and it is inscribed in the\n    // circle with `radius`. For more details, see the following PRs:\n    // https://github.com/chartjs/Chart.js/issues/5597\n    // https://github.com/chartjs/Chart.js/issues/5858\n    cornerRadius = radius * 0.516;\n    size = radius - cornerRadius;\n    xOffset = Math.cos(rad + QUARTER_PI) * size;\n    xOffsetW = Math.cos(rad + QUARTER_PI) * (w ? w / 2 - cornerRadius : size);\n    yOffset = Math.sin(rad + QUARTER_PI) * size;\n    yOffsetW = Math.sin(rad + QUARTER_PI) * (w ? w / 2 - cornerRadius : size);\n    ctx.arc(x - xOffsetW, y - yOffset, cornerRadius, rad - PI, rad - HALF_PI);\n    ctx.arc(x + yOffsetW, y - xOffset, cornerRadius, rad - HALF_PI, rad);\n    ctx.arc(x + xOffsetW, y + yOffset, cornerRadius, rad, rad + HALF_PI);\n    ctx.arc(x - yOffsetW, y + xOffset, cornerRadius, rad + HALF_PI, rad + PI);\n    ctx.closePath();\n    break;\n  case 'rect':\n    if (!rotation) {\n      size = Math.SQRT1_2 * radius;\n      width = w ? w / 2 : size;\n      ctx.rect(x - width, y - size, 2 * width, 2 * size);\n      break;\n    }\n    rad += QUARTER_PI;\n    /* falls through */\n  case 'rectRot':\n    xOffsetW = Math.cos(rad) * (w ? w / 2 : radius);\n    xOffset = Math.cos(rad) * radius;\n    yOffset = Math.sin(rad) * radius;\n    yOffsetW = Math.sin(rad) * (w ? w / 2 : radius);\n    ctx.moveTo(x - xOffsetW, y - yOffset);\n    ctx.lineTo(x + yOffsetW, y - xOffset);\n    ctx.lineTo(x + xOffsetW, y + yOffset);\n    ctx.lineTo(x - yOffsetW, y + xOffset);\n    ctx.closePath();\n    break;\n  case 'crossRot':\n    rad += QUARTER_PI;\n    /* falls through */\n  case 'cross':\n    xOffsetW = Math.cos(rad) * (w ? w / 2 : radius);\n    xOffset = Math.cos(rad) * radius;\n    yOffset = Math.sin(rad) * radius;\n    yOffsetW = Math.sin(rad) * (w ? w / 2 : radius);\n    ctx.moveTo(x - xOffsetW, y - yOffset);\n    ctx.lineTo(x + xOffsetW, y + yOffset);\n    ctx.moveTo(x + yOffsetW, y - xOffset);\n    ctx.lineTo(x - yOffsetW, y + xOffset);\n    break;\n  case 'star':\n    xOffsetW = Math.cos(rad) * (w ? w / 2 : radius);\n    xOffset = Math.cos(rad) * radius;\n    yOffset = Math.sin(rad) * radius;\n    yOffsetW = Math.sin(rad) * (w ? w / 2 : radius);\n    ctx.moveTo(x - xOffsetW, y - yOffset);\n    ctx.lineTo(x + xOffsetW, y + yOffset);\n    ctx.moveTo(x + yOffsetW, y - xOffset);\n    ctx.lineTo(x - yOffsetW, y + xOffset);\n    rad += QUARTER_PI;\n    xOffsetW = Math.cos(rad) * (w ? w / 2 : radius);\n    xOffset = Math.cos(rad) * radius;\n    yOffset = Math.sin(rad) * radius;\n    yOffsetW = Math.sin(rad) * (w ? w / 2 : radius);\n    ctx.moveTo(x - xOffsetW, y - yOffset);\n    ctx.lineTo(x + xOffsetW, y + yOffset);\n    ctx.moveTo(x + yOffsetW, y - xOffset);\n    ctx.lineTo(x - yOffsetW, y + xOffset);\n    break;\n  case 'line':\n    xOffset = w ? w / 2 : Math.cos(rad) * radius;\n    yOffset = Math.sin(rad) * radius;\n    ctx.moveTo(x - xOffset, y - yOffset);\n    ctx.lineTo(x + xOffset, y + yOffset);\n    break;\n  case 'dash':\n    ctx.moveTo(x, y);\n    ctx.lineTo(x + Math.cos(rad) * (w ? w / 2 : radius), y + Math.sin(rad) * radius);\n    break;\n  }\n\n  ctx.fill();\n  if (options.borderWidth > 0) {\n    ctx.stroke();\n  }\n}\n\n/**\n * Returns true if the point is inside the rectangle\n * @param {Point} point - The point to test\n * @param {object} area - The rectangle\n * @param {number} [margin] - allowed margin\n * @returns {boolean}\n * @private\n */\nexport function _isPointInArea(point, area, margin) {\n  margin = margin || 0.5; // margin - default is to match rounded decimals\n\n  return !area || (point && point.x > area.left - margin && point.x < area.right + margin &&\n\t\tpoint.y > area.top - margin && point.y < area.bottom + margin);\n}\n\nexport function clipArea(ctx, area) {\n  ctx.save();\n  ctx.beginPath();\n  ctx.rect(area.left, area.top, area.right - area.left, area.bottom - area.top);\n  ctx.clip();\n}\n\nexport function unclipArea(ctx) {\n  ctx.restore();\n}\n\n/**\n * @private\n */\nexport function _steppedLineTo(ctx, previous, target, flip, mode) {\n  if (!previous) {\n    return ctx.lineTo(target.x, target.y);\n  }\n  if (mode === 'middle') {\n    const midpoint = (previous.x + target.x) / 2.0;\n    ctx.lineTo(midpoint, previous.y);\n    ctx.lineTo(midpoint, target.y);\n  } else if (mode === 'after' !== !!flip) {\n    ctx.lineTo(previous.x, target.y);\n  } else {\n    ctx.lineTo(target.x, previous.y);\n  }\n  ctx.lineTo(target.x, target.y);\n}\n\n/**\n * @private\n */\nexport function _bezierCurveTo(ctx, previous, target, flip) {\n  if (!previous) {\n    return ctx.lineTo(target.x, target.y);\n  }\n  ctx.bezierCurveTo(\n    flip ? previous.cp1x : previous.cp2x,\n    flip ? previous.cp1y : previous.cp2y,\n    flip ? target.cp2x : target.cp1x,\n    flip ? target.cp2y : target.cp1y,\n    target.x,\n    target.y);\n}\n\n/**\n * Render text onto the canvas\n */\nexport function renderText(ctx, text, x, y, font, opts = {}) {\n  const lines = isArray(text) ? text : [text];\n  const stroke = opts.strokeWidth > 0 && opts.strokeColor !== '';\n  let i, line;\n\n  ctx.save();\n  ctx.font = font.string;\n  setRenderOpts(ctx, opts);\n\n  for (i = 0; i < lines.length; ++i) {\n    line = lines[i];\n\n    if (opts.backdrop) {\n      drawBackdrop(ctx, opts.backdrop);\n    }\n\n    if (stroke) {\n      if (opts.strokeColor) {\n        ctx.strokeStyle = opts.strokeColor;\n      }\n\n      if (!isNullOrUndef(opts.strokeWidth)) {\n        ctx.lineWidth = opts.strokeWidth;\n      }\n\n      ctx.strokeText(line, x, y, opts.maxWidth);\n    }\n\n    ctx.fillText(line, x, y, opts.maxWidth);\n    decorateText(ctx, x, y, line, opts);\n\n    y += font.lineHeight;\n  }\n\n  ctx.restore();\n}\n\nfunction setRenderOpts(ctx, opts) {\n  if (opts.translation) {\n    ctx.translate(opts.translation[0], opts.translation[1]);\n  }\n\n  if (!isNullOrUndef(opts.rotation)) {\n    ctx.rotate(opts.rotation);\n  }\n\n  if (opts.color) {\n    ctx.fillStyle = opts.color;\n  }\n\n  if (opts.textAlign) {\n    ctx.textAlign = opts.textAlign;\n  }\n\n  if (opts.textBaseline) {\n    ctx.textBaseline = opts.textBaseline;\n  }\n}\n\nfunction decorateText(ctx, x, y, line, opts) {\n  if (opts.strikethrough || opts.underline) {\n    /**\n     * Now that IE11 support has been dropped, we can use more\n     * of the TextMetrics object. The actual bounding boxes\n     * are unflagged in Chrome, Firefox, Edge, and Safari so they\n     * can be safely used.\n     * See https://developer.mozilla.org/en-US/docs/Web/API/TextMetrics#Browser_compatibility\n     */\n    const metrics = ctx.measureText(line);\n    const left = x - metrics.actualBoundingBoxLeft;\n    const right = x + metrics.actualBoundingBoxRight;\n    const top = y - metrics.actualBoundingBoxAscent;\n    const bottom = y + metrics.actualBoundingBoxDescent;\n    const yDecoration = opts.strikethrough ? (top + bottom) / 2 : bottom;\n\n    ctx.strokeStyle = ctx.fillStyle;\n    ctx.beginPath();\n    ctx.lineWidth = opts.decorationWidth || 2;\n    ctx.moveTo(left, yDecoration);\n    ctx.lineTo(right, yDecoration);\n    ctx.stroke();\n  }\n}\n\nfunction drawBackdrop(ctx, opts) {\n  const oldColor = ctx.fillStyle;\n\n  ctx.fillStyle = opts.color;\n  ctx.fillRect(opts.left, opts.top, opts.width, opts.height);\n  ctx.fillStyle = oldColor;\n}\n\n/**\n * Add a path of a rectangle with rounded corners to the current sub-path\n * @param {CanvasRenderingContext2D} ctx Context\n * @param {*} rect Bounding rect\n */\nexport function addRoundedRectPath(ctx, rect) {\n  const {x, y, w, h, radius} = rect;\n\n  // top left arc\n  ctx.arc(x + radius.topLeft, y + radius.topLeft, radius.topLeft, -HALF_PI, PI, true);\n\n  // line from top left to bottom left\n  ctx.lineTo(x, y + h - radius.bottomLeft);\n\n  // bottom left arc\n  ctx.arc(x + radius.bottomLeft, y + h - radius.bottomLeft, radius.bottomLeft, PI, HALF_PI, true);\n\n  // line from bottom left to bottom right\n  ctx.lineTo(x + w - radius.bottomRight, y + h);\n\n  // bottom right arc\n  ctx.arc(x + w - radius.bottomRight, y + h - radius.bottomRight, radius.bottomRight, HALF_PI, 0, true);\n\n  // line from bottom right to top right\n  ctx.lineTo(x + w, y + radius.topRight);\n\n  // top right arc\n  ctx.arc(x + w - radius.topRight, y + radius.topRight, radius.topRight, 0, -HALF_PI, true);\n\n  // line from top right to top left\n  ctx.lineTo(x + radius.topLeft, y);\n}\n","import defaults from '../core/core.defaults';\nimport {isArray, isObject, toDimension, valueOrDefault} from './helpers.core';\nimport {Point, toFontString} from './helpers.canvas';\nimport type {ChartArea, FontSpec} from '../../types';\nimport type {TRBL, TRBLCorners} from '../../types/geometric';\n\nconst LINE_HEIGHT = /^(normal|(\\d+(?:\\.\\d+)?)(px|em|%)?)$/;\nconst FONT_STYLE = /^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;\n\n/**\n * @alias Chart.helpers.options\n * @namespace\n */\n/**\n * Converts the given line height `value` in pixels for a specific font `size`.\n * @param value - The lineHeight to parse (eg. 1.6, '14px', '75%', '1.6em').\n * @param size - The font size (in pixels) used to resolve relative `value`.\n * @returns The effective line height in pixels (size * 1.2 if value is invalid).\n * @see https://developer.mozilla.org/en-US/docs/Web/CSS/line-height\n * @since 2.7.0\n */\nexport function toLineHeight(value: number | string, size: number): number {\n  const matches = ('' + value).match(LINE_HEIGHT);\n  if (!matches || matches[1] === 'normal') {\n    return size * 1.2;\n  }\n\n  value = +matches[2];\n\n  switch (matches[3]) {\n    case 'px':\n      return value;\n    case '%':\n      value /= 100;\n      break;\n    default:\n      break;\n  }\n\n  return size * value;\n}\n\nconst numberOrZero = (v: unknown) => +v || 0;\n\n/**\n * @param value\n * @param props\n */\nexport function _readValueToProps<K extends string>(value: number | Record<K, number>, props: K[]): Record<K, number>;\nexport function _readValueToProps<K extends string, T extends string>(value: number | Record<K & T, number>, props: Record<T, K>): Record<T, number>;\nexport function _readValueToProps(value: number | Record<string, number>, props: string[] | Record<string, string>) {\n  const ret = {};\n  const objProps = isObject(props);\n  const keys = objProps ? Object.keys(props) : props;\n  const read = isObject(value)\n    ? objProps\n      ? prop => valueOrDefault(value[prop], value[props[prop]])\n      : prop => value[prop]\n    : () => value;\n\n  for (const prop of keys) {\n    ret[prop] = numberOrZero(read(prop));\n  }\n  return ret;\n}\n\n/**\n * Converts the given value into a TRBL object.\n * @param value - If a number, set the value to all TRBL component,\n *  else, if an object, use defined properties and sets undefined ones to 0.\n *  x / y are shorthands for same value for left/right and top/bottom.\n * @returns The padding values (top, right, bottom, left)\n * @since 3.0.0\n */\nexport function toTRBL(value: number | TRBL | Point) {\n  return _readValueToProps(value, {top: 'y', right: 'x', bottom: 'y', left: 'x'});\n}\n\n/**\n * Converts the given value into a TRBL corners object (similar with css border-radius).\n * @param value - If a number, set the value to all TRBL corner components,\n *  else, if an object, use defined properties and sets undefined ones to 0.\n * @returns The TRBL corner values (topLeft, topRight, bottomLeft, bottomRight)\n * @since 3.0.0\n */\nexport function toTRBLCorners(value: number | TRBLCorners) {\n  return _readValueToProps(value, ['topLeft', 'topRight', 'bottomLeft', 'bottomRight']);\n}\n\n/**\n * Converts the given value into a padding object with pre-computed width/height.\n * @param value - If a number, set the value to all TRBL component,\n *  else, if an object, use defined properties and sets undefined ones to 0.\n *  x / y are shorthands for same value for left/right and top/bottom.\n * @returns The padding values (top, right, bottom, left, width, height)\n * @since 2.7.0\n */\nexport function toPadding(value?: number | TRBL): ChartArea {\n  const obj = toTRBL(value) as ChartArea;\n\n  obj.width = obj.left + obj.right;\n  obj.height = obj.top + obj.bottom;\n\n  return obj;\n}\n\nexport interface CanvasFontSpec extends FontSpec {\n  string: string;\n}\n\n/**\n * Parses font options and returns the font object.\n * @param options - A object that contains font options to be parsed.\n * @param fallback - A object that contains fallback font options.\n * @return The font object.\n * @private\n */\n\nexport function toFont(options: Partial<FontSpec>, fallback?: Partial<FontSpec>) {\n  options = options || {};\n  fallback = fallback || defaults.font as FontSpec;\n\n  let size = valueOrDefault(options.size, fallback.size);\n\n  if (typeof size === 'string') {\n    size = parseInt(size, 10);\n  }\n  let style = valueOrDefault(options.style, fallback.style);\n  if (style && !('' + style).match(FONT_STYLE)) {\n    console.warn('Invalid font style specified: \"' + style + '\"');\n    style = undefined;\n  }\n\n  const font = {\n    family: valueOrDefault(options.family, fallback.family),\n    lineHeight: toLineHeight(valueOrDefault(options.lineHeight, fallback.lineHeight), size),\n    size,\n    style,\n    weight: valueOrDefault(options.weight, fallback.weight),\n    string: ''\n  };\n\n  font.string = toFontString(font);\n  return font;\n}\n\n/**\n * Evaluates the given `inputs` sequentially and returns the first defined value.\n * @param inputs - An array of values, falling back to the last value.\n * @param context - If defined and the current value is a function, the value\n * is called with `context` as first argument and the result becomes the new input.\n * @param index - If defined and the current value is an array, the value\n * at `index` become the new input.\n * @param info - object to return information about resolution in\n * @param info.cacheable - Will be set to `false` if option is not cacheable.\n * @since 2.7.0\n */\nexport function resolve(inputs: Array<unknown>, context?: object, index?: number, info?: { cacheable: boolean }) {\n  let cacheable = true;\n  let i: number, ilen: number, value: unknown;\n\n  for (i = 0, ilen = inputs.length; i < ilen; ++i) {\n    value = inputs[i];\n    if (value === undefined) {\n      continue;\n    }\n    if (context !== undefined && typeof value === 'function') {\n      value = value(context);\n      cacheable = false;\n    }\n    if (index !== undefined && isArray(value)) {\n      value = value[index % value.length];\n      cacheable = false;\n    }\n    if (value !== undefined) {\n      if (info && !cacheable) {\n        info.cacheable = false;\n      }\n      return value;\n    }\n  }\n}\n\n/**\n * @param minmax\n * @param grace\n * @param beginAtZero\n * @private\n */\nexport function _addGrace(minmax: { min: number; max: number; }, grace: number | string, beginAtZero: boolean) {\n  const {min, max} = minmax;\n  const change = toDimension(grace, (max - min) / 2);\n  const keepZero = (value: number, add: number) => beginAtZero && value === 0 ? 0 : value + add;\n  return {\n    min: keepZero(min, -Math.abs(change)),\n    max: keepZero(max, change)\n  };\n}\n\n/**\n * Create a context inheriting parentContext\n * @param parentContext\n * @param context\n * @returns\n */\nexport function createContext<P extends T, T extends object>(parentContext: P, context: T): P extends null ? T : P & T {\n  return Object.assign(Object.create(parentContext), context);\n}\n","import {defined, isArray, isFunction, isObject, resolveObjectKey, _capitalize} from './helpers.core';\n\n/**\n * Creates a Proxy for resolving raw values for options.\n * @param {object[]} scopes - The option scopes to look for values, in resolution order\n * @param {string[]} [prefixes] - The prefixes for values, in resolution order.\n * @param {object[]} [rootScopes] - The root option scopes\n * @param {string|boolean} [fallback] - Parent scopes fallback\n * @param {function} [getTarget] - callback for getting the target for changed values\n * @returns Proxy\n * @private\n */\nexport function _createResolver(scopes, prefixes = [''], rootScopes = scopes, fallback, getTarget = () => scopes[0]) {\n  if (!defined(fallback)) {\n    fallback = _resolve('_fallback', scopes);\n  }\n  const cache = {\n    [Symbol.toStringTag]: 'Object',\n    _cacheable: true,\n    _scopes: scopes,\n    _rootScopes: rootScopes,\n    _fallback: fallback,\n    _getTarget: getTarget,\n    override: (scope) => _createResolver([scope, ...scopes], prefixes, rootScopes, fallback),\n  };\n  return new Proxy(cache, {\n    /**\n     * A trap for the delete operator.\n     */\n    deleteProperty(target, prop) {\n      delete target[prop]; // remove from cache\n      delete target._keys; // remove cached keys\n      delete scopes[0][prop]; // remove from top level scope\n      return true;\n    },\n\n    /**\n     * A trap for getting property values.\n     */\n    get(target, prop) {\n      return _cached(target, prop,\n        () => _resolveWithPrefixes(prop, prefixes, scopes, target));\n    },\n\n    /**\n     * A trap for Object.getOwnPropertyDescriptor.\n     * Also used by Object.hasOwnProperty.\n     */\n    getOwnPropertyDescriptor(target, prop) {\n      return Reflect.getOwnPropertyDescriptor(target._scopes[0], prop);\n    },\n\n    /**\n     * A trap for Object.getPrototypeOf.\n     */\n    getPrototypeOf() {\n      return Reflect.getPrototypeOf(scopes[0]);\n    },\n\n    /**\n     * A trap for the in operator.\n     */\n    has(target, prop) {\n      return getKeysFromAllScopes(target).includes(prop);\n    },\n\n    /**\n     * A trap for Object.getOwnPropertyNames and Object.getOwnPropertySymbols.\n     */\n    ownKeys(target) {\n      return getKeysFromAllScopes(target);\n    },\n\n    /**\n     * A trap for setting property values.\n     */\n    set(target, prop, value) {\n      const storage = target._storage || (target._storage = getTarget());\n      target[prop] = storage[prop] = value; // set to top level scope + cache\n      delete target._keys; // remove cached keys\n      return true;\n    }\n  });\n}\n\n/**\n * Returns an Proxy for resolving option values with context.\n * @param {object} proxy - The Proxy returned by `_createResolver`\n * @param {object} context - Context object for scriptable/indexable options\n * @param {object} [subProxy] - The proxy provided for scriptable options\n * @param {{scriptable: boolean, indexable: boolean, allKeys?: boolean}} [descriptorDefaults] - Defaults for descriptors\n * @private\n */\nexport function _attachContext(proxy, context, subProxy, descriptorDefaults) {\n  const cache = {\n    _cacheable: false,\n    _proxy: proxy,\n    _context: context,\n    _subProxy: subProxy,\n    _stack: new Set(),\n    _descriptors: _descriptors(proxy, descriptorDefaults),\n    setContext: (ctx) => _attachContext(proxy, ctx, subProxy, descriptorDefaults),\n    override: (scope) => _attachContext(proxy.override(scope), context, subProxy, descriptorDefaults)\n  };\n  return new Proxy(cache, {\n    /**\n     * A trap for the delete operator.\n     */\n    deleteProperty(target, prop) {\n      delete target[prop]; // remove from cache\n      delete proxy[prop]; // remove from proxy\n      return true;\n    },\n\n    /**\n     * A trap for getting property values.\n     */\n    get(target, prop, receiver) {\n      return _cached(target, prop,\n        () => _resolveWithContext(target, prop, receiver));\n    },\n\n    /**\n     * A trap for Object.getOwnPropertyDescriptor.\n     * Also used by Object.hasOwnProperty.\n     */\n    getOwnPropertyDescriptor(target, prop) {\n      return target._descriptors.allKeys\n        ? Reflect.has(proxy, prop) ? {enumerable: true, configurable: true} : undefined\n        : Reflect.getOwnPropertyDescriptor(proxy, prop);\n    },\n\n    /**\n     * A trap for Object.getPrototypeOf.\n     */\n    getPrototypeOf() {\n      return Reflect.getPrototypeOf(proxy);\n    },\n\n    /**\n     * A trap for the in operator.\n     */\n    has(target, prop) {\n      return Reflect.has(proxy, prop);\n    },\n\n    /**\n     * A trap for Object.getOwnPropertyNames and Object.getOwnPropertySymbols.\n     */\n    ownKeys() {\n      return Reflect.ownKeys(proxy);\n    },\n\n    /**\n     * A trap for setting property values.\n     */\n    set(target, prop, value) {\n      proxy[prop] = value; // set to proxy\n      delete target[prop]; // remove from cache\n      return true;\n    }\n  });\n}\n\n/**\n * @private\n */\nexport function _descriptors(proxy, defaults = {scriptable: true, indexable: true}) {\n  const {_scriptable = defaults.scriptable, _indexable = defaults.indexable, _allKeys = defaults.allKeys} = proxy;\n  return {\n    allKeys: _allKeys,\n    scriptable: _scriptable,\n    indexable: _indexable,\n    isScriptable: isFunction(_scriptable) ? _scriptable : () => _scriptable,\n    isIndexable: isFunction(_indexable) ? _indexable : () => _indexable\n  };\n}\n\nconst readKey = (prefix, name) => prefix ? prefix + _capitalize(name) : name;\nconst needsSubResolver = (prop, value) => isObject(value) && prop !== 'adapters' &&\n  (Object.getPrototypeOf(value) === null || value.constructor === Object);\n\nfunction _cached(target, prop, resolve) {\n  if (Object.prototype.hasOwnProperty.call(target, prop)) {\n    return target[prop];\n  }\n\n  const value = resolve();\n  // cache the resolved value\n  target[prop] = value;\n  return value;\n}\n\nfunction _resolveWithContext(target, prop, receiver) {\n  const {_proxy, _context, _subProxy, _descriptors: descriptors} = target;\n  let value = _proxy[prop]; // resolve from proxy\n\n  // resolve with context\n  if (isFunction(value) && descriptors.isScriptable(prop)) {\n    value = _resolveScriptable(prop, value, target, receiver);\n  }\n  if (isArray(value) && value.length) {\n    value = _resolveArray(prop, value, target, descriptors.isIndexable);\n  }\n  if (needsSubResolver(prop, value)) {\n    // if the resolved value is an object, create a sub resolver for it\n    value = _attachContext(value, _context, _subProxy && _subProxy[prop], descriptors);\n  }\n  return value;\n}\n\nfunction _resolveScriptable(prop, value, target, receiver) {\n  const {_proxy, _context, _subProxy, _stack} = target;\n  if (_stack.has(prop)) {\n    // @ts-ignore\n    throw new Error('Recursion detected: ' + Array.from(_stack).join('->') + '->' + prop);\n  }\n  _stack.add(prop);\n  value = value(_context, _subProxy || receiver);\n  _stack.delete(prop);\n  if (needsSubResolver(prop, value)) {\n    // When scriptable option returns an object, create a resolver on that.\n    value = createSubResolver(_proxy._scopes, _proxy, prop, value);\n  }\n  return value;\n}\n\nfunction _resolveArray(prop, value, target, isIndexable) {\n  const {_proxy, _context, _subProxy, _descriptors: descriptors} = target;\n\n  if (defined(_context.index) && isIndexable(prop)) {\n    value = value[_context.index % value.length];\n  } else if (isObject(value[0])) {\n    // Array of objects, return array or resolvers\n    const arr = value;\n    const scopes = _proxy._scopes.filter(s => s !== arr);\n    value = [];\n    for (const item of arr) {\n      const resolver = createSubResolver(scopes, _proxy, prop, item);\n      value.push(_attachContext(resolver, _context, _subProxy && _subProxy[prop], descriptors));\n    }\n  }\n  return value;\n}\n\nfunction resolveFallback(fallback, prop, value) {\n  return isFunction(fallback) ? fallback(prop, value) : fallback;\n}\n\nconst getScope = (key, parent) => key === true ? parent\n  : typeof key === 'string' ? resolveObjectKey(parent, key) : undefined;\n\nfunction addScopes(set, parentScopes, key, parentFallback, value) {\n  for (const parent of parentScopes) {\n    const scope = getScope(key, parent);\n    if (scope) {\n      set.add(scope);\n      const fallback = resolveFallback(scope._fallback, key, value);\n      if (defined(fallback) && fallback !== key && fallback !== parentFallback) {\n        // When we reach the descriptor that defines a new _fallback, return that.\n        // The fallback will resume to that new scope.\n        return fallback;\n      }\n    } else if (scope === false && defined(parentFallback) && key !== parentFallback) {\n      // Fallback to `false` results to `false`, when falling back to different key.\n      // For example `interaction` from `hover` or `plugins.tooltip` and `animation` from `animations`\n      return null;\n    }\n  }\n  return false;\n}\n\nfunction createSubResolver(parentScopes, resolver, prop, value) {\n  const rootScopes = resolver._rootScopes;\n  const fallback = resolveFallback(resolver._fallback, prop, value);\n  const allScopes = [...parentScopes, ...rootScopes];\n  const set = new Set();\n  set.add(value);\n  let key = addScopesFromKey(set, allScopes, prop, fallback || prop, value);\n  if (key === null) {\n    return false;\n  }\n  if (defined(fallback) && fallback !== prop) {\n    key = addScopesFromKey(set, allScopes, fallback, key, value);\n    if (key === null) {\n      return false;\n    }\n  }\n  return _createResolver(Array.from(set), [''], rootScopes, fallback,\n    () => subGetTarget(resolver, prop, value));\n}\n\nfunction addScopesFromKey(set, allScopes, key, fallback, item) {\n  while (key) {\n    key = addScopes(set, allScopes, key, fallback, item);\n  }\n  return key;\n}\n\nfunction subGetTarget(resolver, prop, value) {\n  const parent = resolver._getTarget();\n  if (!(prop in parent)) {\n    parent[prop] = {};\n  }\n  const target = parent[prop];\n  if (isArray(target) && isObject(value)) {\n    // For array of objects, the object is used to store updated values\n    return value;\n  }\n  return target || {};\n}\n\nfunction _resolveWithPrefixes(prop, prefixes, scopes, proxy) {\n  let value;\n  for (const prefix of prefixes) {\n    value = _resolve(readKey(prefix, prop), scopes);\n    if (defined(value)) {\n      return needsSubResolver(prop, value)\n        ? createSubResolver(scopes, proxy, prop, value)\n        : value;\n    }\n  }\n}\n\nfunction _resolve(key, scopes) {\n  for (const scope of scopes) {\n    if (!scope) {\n      continue;\n    }\n    const value = scope[key];\n    if (defined(value)) {\n      return value;\n    }\n  }\n}\n\nfunction getKeysFromAllScopes(target) {\n  let keys = target._keys;\n  if (!keys) {\n    keys = target._keys = resolveKeysFromAllScopes(target._scopes);\n  }\n  return keys;\n}\n\nfunction resolveKeysFromAllScopes(scopes) {\n  const set = new Set();\n  for (const scope of scopes) {\n    for (const key of Object.keys(scope).filter(k => !k.startsWith('_'))) {\n      set.add(key);\n    }\n  }\n  return Array.from(set);\n}\n\nexport function _parseObjectDataRadialScale(meta, data, start, count) {\n  const {iScale} = meta;\n  const {key = 'r'} = this._parsing;\n  const parsed = new Array(count);\n  let i, ilen, index, item;\n\n  for (i = 0, ilen = count; i < ilen; ++i) {\n    index = i + start;\n    item = data[index];\n    parsed[i] = {\n      r: iScale.parse(resolveObjectKey(item, key), index)\n    };\n  }\n  return parsed;\n}\n","import {almostEquals, distanceBetweenPoints, sign} from './helpers.math';\nimport {_isPointInArea} from './helpers.canvas';\nimport {ChartArea} from '../../types';\n\nexport interface SplinePoint {\n  x: number;\n  y: number;\n  skip?: boolean;\n\n  // Both Bezier and monotone interpolations have these fields\n  // but they are added in different spots\n  cp1x?: number;\n  cp1y?: number;\n  cp2x?: number;\n  cp2y?: number;\n}\n\nconst EPSILON = Number.EPSILON || 1e-14;\n\ntype OptionalSplinePoint = SplinePoint | false\nconst getPoint = (points: SplinePoint[], i: number): OptionalSplinePoint => i < points.length && !points[i].skip && points[i];\nconst getValueAxis = (indexAxis: 'x' | 'y') => indexAxis === 'x' ? 'y' : 'x';\n\nexport function splineCurve(\n  firstPoint: SplinePoint,\n  middlePoint: SplinePoint,\n  afterPoint: SplinePoint,\n  t: number\n): {\n    previous: SplinePoint\n    next: SplinePoint\n  } {\n  // Props to Rob Spencer at scaled innovation for his post on splining between points\n  // http://scaledinnovation.com/analytics/splines/aboutSplines.html\n\n  // This function must also respect \"skipped\" points\n\n  const previous = firstPoint.skip ? middlePoint : firstPoint;\n  const current = middlePoint;\n  const next = afterPoint.skip ? middlePoint : afterPoint;\n  const d01 = distanceBetweenPoints(current, previous);\n  const d12 = distanceBetweenPoints(next, current);\n\n  let s01 = d01 / (d01 + d12);\n  let s12 = d12 / (d01 + d12);\n\n  // If all points are the same, s01 & s02 will be inf\n  s01 = isNaN(s01) ? 0 : s01;\n  s12 = isNaN(s12) ? 0 : s12;\n\n  const fa = t * s01; // scaling factor for triangle Ta\n  const fb = t * s12;\n\n  return {\n    previous: {\n      x: current.x - fa * (next.x - previous.x),\n      y: current.y - fa * (next.y - previous.y)\n    },\n    next: {\n      x: current.x + fb * (next.x - previous.x),\n      y: current.y + fb * (next.y - previous.y)\n    }\n  };\n}\n\n/**\n * Adjust tangents to ensure monotonic properties\n */\nfunction monotoneAdjust(points: SplinePoint[], deltaK: number[], mK: number[]) {\n  const pointsLen = points.length;\n\n  let alphaK: number, betaK: number, tauK: number, squaredMagnitude: number, pointCurrent: OptionalSplinePoint;\n  let pointAfter = getPoint(points, 0);\n  for (let i = 0; i < pointsLen - 1; ++i) {\n    pointCurrent = pointAfter;\n    pointAfter = getPoint(points, i + 1);\n    if (!pointCurrent || !pointAfter) {\n      continue;\n    }\n\n    if (almostEquals(deltaK[i], 0, EPSILON)) {\n      mK[i] = mK[i + 1] = 0;\n      continue;\n    }\n\n    alphaK = mK[i] / deltaK[i];\n    betaK = mK[i + 1] / deltaK[i];\n    squaredMagnitude = Math.pow(alphaK, 2) + Math.pow(betaK, 2);\n    if (squaredMagnitude <= 9) {\n      continue;\n    }\n\n    tauK = 3 / Math.sqrt(squaredMagnitude);\n    mK[i] = alphaK * tauK * deltaK[i];\n    mK[i + 1] = betaK * tauK * deltaK[i];\n  }\n}\n\nfunction monotoneCompute(points: SplinePoint[], mK: number[], indexAxis: 'x' | 'y' = 'x') {\n  const valueAxis = getValueAxis(indexAxis);\n  const pointsLen = points.length;\n  let delta: number, pointBefore: OptionalSplinePoint, pointCurrent: OptionalSplinePoint;\n  let pointAfter = getPoint(points, 0);\n\n  for (let i = 0; i < pointsLen; ++i) {\n    pointBefore = pointCurrent;\n    pointCurrent = pointAfter;\n    pointAfter = getPoint(points, i + 1);\n    if (!pointCurrent) {\n      continue;\n    }\n\n    const iPixel = pointCurrent[indexAxis];\n    const vPixel = pointCurrent[valueAxis];\n    if (pointBefore) {\n      delta = (iPixel - pointBefore[indexAxis]) / 3;\n      pointCurrent[`cp1${indexAxis}`] = iPixel - delta;\n      pointCurrent[`cp1${valueAxis}`] = vPixel - delta * mK[i];\n    }\n    if (pointAfter) {\n      delta = (pointAfter[indexAxis] - iPixel) / 3;\n      pointCurrent[`cp2${indexAxis}`] = iPixel + delta;\n      pointCurrent[`cp2${valueAxis}`] = vPixel + delta * mK[i];\n    }\n  }\n}\n\n/**\n * This function calculates Bzier control points in a similar way than |splineCurve|,\n * but preserves monotonicity of the provided data and ensures no local extremums are added\n * between the dataset discrete points due to the interpolation.\n * See : https://en.wikipedia.org/wiki/Monotone_cubic_interpolation\n */\nexport function splineCurveMonotone(points: SplinePoint[], indexAxis: 'x' | 'y' = 'x') {\n  const valueAxis = getValueAxis(indexAxis);\n  const pointsLen = points.length;\n  const deltaK: number[] = Array(pointsLen).fill(0);\n  const mK: number[] = Array(pointsLen);\n\n  // Calculate slopes (deltaK) and initialize tangents (mK)\n  let i, pointBefore: OptionalSplinePoint, pointCurrent: OptionalSplinePoint;\n  let pointAfter = getPoint(points, 0);\n\n  for (i = 0; i < pointsLen; ++i) {\n    pointBefore = pointCurrent;\n    pointCurrent = pointAfter;\n    pointAfter = getPoint(points, i + 1);\n    if (!pointCurrent) {\n      continue;\n    }\n\n    if (pointAfter) {\n      const slopeDelta = pointAfter[indexAxis] - pointCurrent[indexAxis];\n\n      // In the case of two points that appear at the same x pixel, slopeDeltaX is 0\n      deltaK[i] = slopeDelta !== 0 ? (pointAfter[valueAxis] - pointCurrent[valueAxis]) / slopeDelta : 0;\n    }\n    mK[i] = !pointBefore ? deltaK[i]\n      : !pointAfter ? deltaK[i - 1]\n        : (sign(deltaK[i - 1]) !== sign(deltaK[i])) ? 0\n          : (deltaK[i - 1] + deltaK[i]) / 2;\n  }\n\n  monotoneAdjust(points, deltaK, mK);\n\n  monotoneCompute(points, mK, indexAxis);\n}\n\nfunction capControlPoint(pt: number, min: number, max: number) {\n  return Math.max(Math.min(pt, max), min);\n}\n\nfunction capBezierPoints(points: SplinePoint[], area: ChartArea) {\n  let i, ilen, point, inArea, inAreaPrev;\n  let inAreaNext = _isPointInArea(points[0], area);\n  for (i = 0, ilen = points.length; i < ilen; ++i) {\n    inAreaPrev = inArea;\n    inArea = inAreaNext;\n    inAreaNext = i < ilen - 1 && _isPointInArea(points[i + 1], area);\n    if (!inArea) {\n      continue;\n    }\n    point = points[i];\n    if (inAreaPrev) {\n      point.cp1x = capControlPoint(point.cp1x, area.left, area.right);\n      point.cp1y = capControlPoint(point.cp1y, area.top, area.bottom);\n    }\n    if (inAreaNext) {\n      point.cp2x = capControlPoint(point.cp2x, area.left, area.right);\n      point.cp2y = capControlPoint(point.cp2y, area.top, area.bottom);\n    }\n  }\n}\n\n/**\n * @private\n */\nexport function _updateBezierControlPoints(\n  points: SplinePoint[],\n  options,\n  area: ChartArea,\n  loop: boolean,\n  indexAxis: 'x' | 'y'\n) {\n  let i: number, ilen: number, point: SplinePoint, controlPoints: ReturnType<typeof splineCurve>;\n\n  // Only consider points that are drawn in case the spanGaps option is used\n  if (options.spanGaps) {\n    points = points.filter((pt) => !pt.skip);\n  }\n\n  if (options.cubicInterpolationMode === 'monotone') {\n    splineCurveMonotone(points, indexAxis);\n  } else {\n    let prev = loop ? points[points.length - 1] : points[0];\n    for (i = 0, ilen = points.length; i < ilen; ++i) {\n      point = points[i];\n      controlPoints = splineCurve(\n        prev,\n        point,\n        points[Math.min(i + 1, ilen - (loop ? 0 : 1)) % ilen],\n        options.tension\n      );\n      point.cp1x = controlPoints.previous.x;\n      point.cp1y = controlPoints.previous.y;\n      point.cp2x = controlPoints.next.x;\n      point.cp2y = controlPoints.next.y;\n      prev = point;\n    }\n  }\n\n  if (options.capBezierPoints) {\n    capBezierPoints(points, area);\n  }\n}\n","import {ChartArea, Scale} from '../../types';\nimport Chart from '../core/core.controller';\nimport {ChartEvent} from '../types';\nimport {INFINITY} from './helpers.math';\n\n/**\n * Note: typedefs are auto-exported, so use a made-up `dom` namespace where\n * necessary to avoid duplicates with `export * from './helpers`; see\n * https://github.com/microsoft/TypeScript/issues/46011\n * @typedef { import(\"../core/core.controller\").default } dom.Chart\n * @typedef { import('../../types').ChartEvent } ChartEvent\n */\n\n/**\n * @private\n */\nexport function _isDomSupported(): boolean {\n  return typeof window !== 'undefined' && typeof document !== 'undefined';\n}\n\n/**\n * @private\n */\nexport function _getParentNode(domNode: HTMLCanvasElement): HTMLCanvasElement {\n  let parent = domNode.parentNode;\n  if (parent && parent.toString() === '[object ShadowRoot]') {\n    parent = (parent as ShadowRoot).host;\n  }\n  return parent as HTMLCanvasElement;\n}\n\n/**\n * convert max-width/max-height values that may be percentages into a number\n * @private\n */\n\nfunction parseMaxStyle(styleValue: string | number, node: HTMLElement, parentProperty: string) {\n  let valueInPixels: number;\n  if (typeof styleValue === 'string') {\n    valueInPixels = parseInt(styleValue, 10);\n\n    if (styleValue.indexOf('%') !== -1) {\n      // percentage * size in dimension\n      valueInPixels = (valueInPixels / 100) * node.parentNode[parentProperty];\n    }\n  } else {\n    valueInPixels = styleValue;\n  }\n\n  return valueInPixels;\n}\n\nconst getComputedStyle = (element: HTMLElement): CSSStyleDeclaration =>\n  element.ownerDocument.defaultView.getComputedStyle(element, null);\n\nexport function getStyle(el: HTMLElement, property: string): string {\n  return getComputedStyle(el).getPropertyValue(property);\n}\n\nconst positions = ['top', 'right', 'bottom', 'left'];\nfunction getPositionedStyle(styles: CSSStyleDeclaration, style: string, suffix?: string): ChartArea {\n  const result = {} as ChartArea;\n  suffix = suffix ? '-' + suffix : '';\n  for (let i = 0; i < 4; i++) {\n    const pos = positions[i];\n    result[pos] = parseFloat(styles[style + '-' + pos + suffix]) || 0;\n  }\n  result.width = result.left + result.right;\n  result.height = result.top + result.bottom;\n  return result;\n}\n\nconst useOffsetPos = (x: number, y: number, target: HTMLElement | EventTarget) =>\n  (x > 0 || y > 0) && (!target || !(target as HTMLElement).shadowRoot);\n\n/**\n * @param e\n * @param canvas\n * @returns Canvas position\n */\nfunction getCanvasPosition(\n  e: Event | TouchEvent | MouseEvent,\n  canvas: HTMLCanvasElement\n): {\n    x: number;\n    y: number;\n    box: boolean;\n  } {\n  const touches = (e as TouchEvent).touches;\n  const source = (touches && touches.length ? touches[0] : e) as MouseEvent;\n  const {offsetX, offsetY} = source as MouseEvent;\n  let box = false;\n  let x, y;\n  if (useOffsetPos(offsetX, offsetY, e.target)) {\n    x = offsetX;\n    y = offsetY;\n  } else {\n    const rect = canvas.getBoundingClientRect();\n    x = source.clientX - rect.left;\n    y = source.clientY - rect.top;\n    box = true;\n  }\n  return {x, y, box};\n}\n\n/**\n * Gets an event's x, y coordinates, relative to the chart area\n * @param event\n * @param chart\n * @returns x and y coordinates of the event\n */\n\nexport function getRelativePosition(\n  event: Event | ChartEvent | TouchEvent | MouseEvent,\n  chart: Chart\n): { x: number; y: number } {\n  if ('native' in event) {\n    return event;\n  }\n\n  const {canvas, currentDevicePixelRatio} = chart;\n  const style = getComputedStyle(canvas);\n  const borderBox = style.boxSizing === 'border-box';\n  const paddings = getPositionedStyle(style, 'padding');\n  const borders = getPositionedStyle(style, 'border', 'width');\n  const {x, y, box} = getCanvasPosition(event, canvas);\n  const xOffset = paddings.left + (box && borders.left);\n  const yOffset = paddings.top + (box && borders.top);\n\n  let {width, height} = chart;\n  if (borderBox) {\n    width -= paddings.width + borders.width;\n    height -= paddings.height + borders.height;\n  }\n  return {\n    x: Math.round((x - xOffset) / width * canvas.width / currentDevicePixelRatio),\n    y: Math.round((y - yOffset) / height * canvas.height / currentDevicePixelRatio)\n  };\n}\n\nfunction getContainerSize(canvas: HTMLCanvasElement, width: number, height: number): Partial<Scale> {\n  let maxWidth: number, maxHeight: number;\n\n  if (width === undefined || height === undefined) {\n    const container = _getParentNode(canvas);\n    if (!container) {\n      width = canvas.clientWidth;\n      height = canvas.clientHeight;\n    } else {\n      const rect = container.getBoundingClientRect(); // this is the border box of the container\n      const containerStyle = getComputedStyle(container);\n      const containerBorder = getPositionedStyle(containerStyle, 'border', 'width');\n      const containerPadding = getPositionedStyle(containerStyle, 'padding');\n      width = rect.width - containerPadding.width - containerBorder.width;\n      height = rect.height - containerPadding.height - containerBorder.height;\n      maxWidth = parseMaxStyle(containerStyle.maxWidth, container, 'clientWidth');\n      maxHeight = parseMaxStyle(containerStyle.maxHeight, container, 'clientHeight');\n    }\n  }\n  return {\n    width,\n    height,\n    maxWidth: maxWidth || INFINITY,\n    maxHeight: maxHeight || INFINITY\n  };\n}\n\nconst round1 = (v: number) => Math.round(v * 10) / 10;\n\n// eslint-disable-next-line complexity\nexport function getMaximumSize(\n  canvas: HTMLCanvasElement,\n  bbWidth?: number,\n  bbHeight?: number,\n  aspectRatio?: number\n): { width: number; height: number } {\n  const style = getComputedStyle(canvas);\n  const margins = getPositionedStyle(style, 'margin');\n  const maxWidth = parseMaxStyle(style.maxWidth, canvas, 'clientWidth') || INFINITY;\n  const maxHeight = parseMaxStyle(style.maxHeight, canvas, 'clientHeight') || INFINITY;\n  const containerSize = getContainerSize(canvas, bbWidth, bbHeight);\n  let {width, height} = containerSize;\n\n  if (style.boxSizing === 'content-box') {\n    const borders = getPositionedStyle(style, 'border', 'width');\n    const paddings = getPositionedStyle(style, 'padding');\n    width -= paddings.width + borders.width;\n    height -= paddings.height + borders.height;\n  }\n  width = Math.max(0, width - margins.width);\n  height = Math.max(0, aspectRatio ? Math.floor(width / aspectRatio) : height - margins.height);\n  width = round1(Math.min(width, maxWidth, containerSize.maxWidth));\n  height = round1(Math.min(height, maxHeight, containerSize.maxHeight));\n  if (width && !height) {\n    // https://github.com/chartjs/Chart.js/issues/4659\n    // If the canvas has width, but no height, default to aspectRatio of 2 (canvas default)\n    height = round1(width / 2);\n  }\n\n  const maintainHeight = bbWidth !== undefined || bbHeight !== undefined;\n\n  if (maintainHeight && aspectRatio && containerSize.height && height > containerSize.height) {\n    height = containerSize.height;\n    width = round1(Math.floor(height * aspectRatio));\n  }\n\n  return {width, height};\n}\n\n/**\n * @param chart\n * @param forceRatio\n * @param forceStyle\n * @returns True if the canvas context size or transformation has changed.\n */\nexport function retinaScale(\n  chart: Chart,\n  forceRatio: number,\n  forceStyle?: boolean\n): boolean | void {\n  const pixelRatio = forceRatio || 1;\n  const deviceHeight = Math.floor(chart.height * pixelRatio);\n  const deviceWidth = Math.floor(chart.width * pixelRatio);\n\n  chart.height = deviceHeight / pixelRatio;\n  chart.width = deviceWidth / pixelRatio;\n\n  const canvas = chart.canvas;\n\n  // If no style has been set on the canvas, the render size is used as display size,\n  // making the chart visually bigger, so let's enforce it to the \"correct\" values.\n  // See https://github.com/chartjs/Chart.js/issues/3575\n  if (canvas.style && (forceStyle || (!canvas.style.height && !canvas.style.width))) {\n    canvas.style.height = `${chart.height}px`;\n    canvas.style.width = `${chart.width}px`;\n  }\n\n  if (chart.currentDevicePixelRatio !== pixelRatio\n      || canvas.height !== deviceHeight\n      || canvas.width !== deviceWidth) {\n    chart.currentDevicePixelRatio = pixelRatio;\n    canvas.height = deviceHeight;\n    canvas.width = deviceWidth;\n    chart.ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n    return true;\n  }\n  return false;\n}\n\n/**\n * Detects support for options object argument in addEventListener.\n * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Safely_detecting_option_support\n * @private\n */\nexport const supportsEventListenerOptions = (function() {\n  let passiveSupported = false;\n  try {\n    const options = {\n      get passive() { // This function will be called when the browser attempts to access the passive property.\n        passiveSupported = true;\n        return false;\n      }\n    } as EventListenerOptions;\n\n    window.addEventListener('test', null, options);\n    window.removeEventListener('test', null, options);\n  } catch (e) {\n    // continue regardless of error\n  }\n  return passiveSupported;\n}());\n\n/**\n * The \"used\" size is the final value of a dimension property after all calculations have\n * been performed. This method uses the computed style of `element` but returns undefined\n * if the computed style is not expressed in pixels. That can happen in some cases where\n * `element` has a size relative to its parent and this last one is not yet displayed,\n * for example because of `display: none` on a parent node.\n * @see https://developer.mozilla.org/en-US/docs/Web/CSS/used_value\n * @returns Size in pixels or undefined if unknown.\n */\n\nexport function readUsedSize(\n  element: HTMLElement,\n  property: 'width' | 'height'\n): number | undefined {\n  const value = getStyle(element, property);\n  const matches = value && value.match(/^(\\d+)(\\.\\d+)?px$/);\n  return matches ? +matches[1] : undefined;\n}\n","import type {Point} from '../../types/geometric';\nimport type {SplinePoint} from './helpers.curve';\n\n/**\n * @private\n */\nexport function _pointInLine(p1: Point, p2: Point, t: number, mode?) { // eslint-disable-line @typescript-eslint/no-unused-vars\n  return {\n    x: p1.x + t * (p2.x - p1.x),\n    y: p1.y + t * (p2.y - p1.y)\n  };\n}\n\n/**\n * @private\n */\nexport function _steppedInterpolation(\n  p1: Point,\n  p2: Point,\n  t: number, mode: 'middle' | 'after' | unknown\n) {\n  return {\n    x: p1.x + t * (p2.x - p1.x),\n    y: mode === 'middle' ? t < 0.5 ? p1.y : p2.y\n      : mode === 'after' ? t < 1 ? p1.y : p2.y\n        : t > 0 ? p2.y : p1.y\n  };\n}\n\n/**\n * @private\n */\nexport function _bezierInterpolation(p1: SplinePoint, p2: SplinePoint, t: number, mode?) { // eslint-disable-line @typescript-eslint/no-unused-vars\n  const cp1 = {x: p1.cp2x, y: p1.cp2y};\n  const cp2 = {x: p2.cp1x, y: p2.cp1y};\n  const a = _pointInLine(p1, cp1, t);\n  const b = _pointInLine(cp1, cp2, t);\n  const c = _pointInLine(cp2, p2, t);\n  const d = _pointInLine(a, b, t);\n  const e = _pointInLine(b, c, t);\n  return _pointInLine(d, e, t);\n}\n","export interface RTLAdapter {\n  x(x: number): number;\n  setWidth(w: number): void;\n  textAlign(align: 'center' | 'left' | 'right'): 'center' | 'left' | 'right';\n  xPlus(x: number, value: number): number;\n  leftForLtr(x: number, itemWidth: number): number;\n}\n\nconst getRightToLeftAdapter = function(rectX: number, width: number): RTLAdapter {\n  return {\n    x(x) {\n      return rectX + rectX + width - x;\n    },\n    setWidth(w) {\n      width = w;\n    },\n    textAlign(align) {\n      if (align === 'center') {\n        return align;\n      }\n      return align === 'right' ? 'left' : 'right';\n    },\n    xPlus(x, value) {\n      return x - value;\n    },\n    leftForLtr(x, itemWidth) {\n      return x - itemWidth;\n    },\n  };\n};\n\nconst getLeftToRightAdapter = function(): RTLAdapter {\n  return {\n    x(x) {\n      return x;\n    },\n    setWidth(w) { // eslint-disable-line no-unused-vars\n    },\n    textAlign(align) {\n      return align;\n    },\n    xPlus(x, value) {\n      return x + value;\n    },\n    leftForLtr(x, _itemWidth) { // eslint-disable-line @typescript-eslint/no-unused-vars\n      return x;\n    },\n  };\n};\n\nexport function getRtlAdapter(rtl: boolean, rectX: number, width: number) {\n  return rtl ? getRightToLeftAdapter(rectX, width) : getLeftToRightAdapter();\n}\n\nexport function overrideTextDirection(ctx: CanvasRenderingContext2D, direction: 'ltr' | 'rtl') {\n  let style: CSSStyleDeclaration, original: [string, string];\n  if (direction === 'ltr' || direction === 'rtl') {\n    style = ctx.canvas.style;\n    original = [\n      style.getPropertyValue('direction'),\n      style.getPropertyPriority('direction'),\n    ];\n\n    style.setProperty('direction', direction, 'important');\n    (ctx as { prevTextDirection?: [string, string] }).prevTextDirection = original;\n  }\n}\n\nexport function restoreTextDirection(ctx: CanvasRenderingContext2D, original?: [string, string]) {\n  if (original !== undefined) {\n    delete (ctx as { prevTextDirection?: [string, string] }).prevTextDirection;\n    ctx.canvas.style.setProperty('direction', original[0], original[1]);\n  }\n}\n","import {_angleBetween, _angleDiff, _isBetween, _normalizeAngle} from './helpers.math';\nimport {createContext} from './helpers.options';\n\n/**\n * @typedef { import(\"../elements/element.line\").default } LineElement\n * @typedef { import(\"../elements/element.point\").default } PointElement\n * @typedef {{start: number, end: number, loop: boolean, style?: any}} Segment\n */\n\nfunction propertyFn(property) {\n  if (property === 'angle') {\n    return {\n      between: _angleBetween,\n      compare: _angleDiff,\n      normalize: _normalizeAngle,\n    };\n  }\n  return {\n    between: _isBetween,\n    compare: (a, b) => a - b,\n    normalize: x => x\n  };\n}\n\nfunction normalizeSegment({start, end, count, loop, style}) {\n  return {\n    start: start % count,\n    end: end % count,\n    loop: loop && (end - start + 1) % count === 0,\n    style\n  };\n}\n\nfunction getSegment(segment, points, bounds) {\n  const {property, start: startBound, end: endBound} = bounds;\n  const {between, normalize} = propertyFn(property);\n  const count = points.length;\n  // eslint-disable-next-line prefer-const\n  let {start, end, loop} = segment;\n  let i, ilen;\n\n  if (loop) {\n    start += count;\n    end += count;\n    for (i = 0, ilen = count; i < ilen; ++i) {\n      if (!between(normalize(points[start % count][property]), startBound, endBound)) {\n        break;\n      }\n      start--;\n      end--;\n    }\n    start %= count;\n    end %= count;\n  }\n\n  if (end < start) {\n    end += count;\n  }\n  return {start, end, loop, style: segment.style};\n}\n\n/**\n * Returns the sub-segment(s) of a line segment that fall in the given bounds\n * @param {object} segment\n * @param {number} segment.start - start index of the segment, referring the points array\n * @param {number} segment.end - end index of the segment, referring the points array\n * @param {boolean} segment.loop - indicates that the segment is a loop\n * @param {object} [segment.style] - segment style\n * @param {PointElement[]} points - the points that this segment refers to\n * @param {object} [bounds]\n * @param {string} bounds.property - the property of a `PointElement` we are bounding. `x`, `y` or `angle`.\n * @param {number} bounds.start - start value of the property\n * @param {number} bounds.end - end value of the property\n * @private\n **/\nexport function _boundSegment(segment, points, bounds) {\n  if (!bounds) {\n    return [segment];\n  }\n\n  const {property, start: startBound, end: endBound} = bounds;\n  const count = points.length;\n  const {compare, between, normalize} = propertyFn(property);\n  const {start, end, loop, style} = getSegment(segment, points, bounds);\n\n  const result = [];\n  let inside = false;\n  let subStart = null;\n  let value, point, prevValue;\n\n  const startIsBefore = () => between(startBound, prevValue, value) && compare(startBound, prevValue) !== 0;\n  const endIsBefore = () => compare(endBound, value) === 0 || between(endBound, prevValue, value);\n  const shouldStart = () => inside || startIsBefore();\n  const shouldStop = () => !inside || endIsBefore();\n\n  for (let i = start, prev = start; i <= end; ++i) {\n    point = points[i % count];\n\n    if (point.skip) {\n      continue;\n    }\n\n    value = normalize(point[property]);\n\n    if (value === prevValue) {\n      continue;\n    }\n\n    inside = between(value, startBound, endBound);\n\n    if (subStart === null && shouldStart()) {\n      subStart = compare(value, startBound) === 0 ? i : prev;\n    }\n\n    if (subStart !== null && shouldStop()) {\n      result.push(normalizeSegment({start: subStart, end: i, loop, count, style}));\n      subStart = null;\n    }\n    prev = i;\n    prevValue = value;\n  }\n\n  if (subStart !== null) {\n    result.push(normalizeSegment({start: subStart, end, loop, count, style}));\n  }\n\n  return result;\n}\n\n\n/**\n * Returns the segments of the line that are inside given bounds\n * @param {LineElement} line\n * @param {object} [bounds]\n * @param {string} bounds.property - the property we are bounding with. `x`, `y` or `angle`.\n * @param {number} bounds.start - start value of the `property`\n * @param {number} bounds.end - end value of the `property`\n * @private\n */\nexport function _boundSegments(line, bounds) {\n  const result = [];\n  const segments = line.segments;\n\n  for (let i = 0; i < segments.length; i++) {\n    const sub = _boundSegment(segments[i], line.points, bounds);\n    if (sub.length) {\n      result.push(...sub);\n    }\n  }\n  return result;\n}\n\n/**\n * Find start and end index of a line.\n */\nfunction findStartAndEnd(points, count, loop, spanGaps) {\n  let start = 0;\n  let end = count - 1;\n\n  if (loop && !spanGaps) {\n    // loop and not spanning gaps, first find a gap to start from\n    while (start < count && !points[start].skip) {\n      start++;\n    }\n  }\n\n  // find first non skipped point (after the first gap possibly)\n  while (start < count && points[start].skip) {\n    start++;\n  }\n\n  // if we looped to count, start needs to be 0\n  start %= count;\n\n  if (loop) {\n    // loop will go past count, if start > 0\n    end += start;\n  }\n\n  while (end > start && points[end % count].skip) {\n    end--;\n  }\n\n  // end could be more than count, normalize\n  end %= count;\n\n  return {start, end};\n}\n\n/**\n * Compute solid segments from Points, when spanGaps === false\n * @param {PointElement[]} points - the points\n * @param {number} start - start index\n * @param {number} max - max index (can go past count on a loop)\n * @param {boolean} loop - boolean indicating that this would be a loop if no gaps are found\n */\nfunction solidSegments(points, start, max, loop) {\n  const count = points.length;\n  const result = [];\n  let last = start;\n  let prev = points[start];\n  let end;\n\n  for (end = start + 1; end <= max; ++end) {\n    const cur = points[end % count];\n    if (cur.skip || cur.stop) {\n      if (!prev.skip) {\n        loop = false;\n        result.push({start: start % count, end: (end - 1) % count, loop});\n        // @ts-ignore\n        start = last = cur.stop ? end : null;\n      }\n    } else {\n      last = end;\n      if (prev.skip) {\n        start = end;\n      }\n    }\n    prev = cur;\n  }\n\n  if (last !== null) {\n    result.push({start: start % count, end: last % count, loop});\n  }\n\n  return result;\n}\n\n/**\n * Compute the continuous segments that define the whole line\n * There can be skipped points within a segment, if spanGaps is true.\n * @param {LineElement} line\n * @param {object} [segmentOptions]\n * @return {Segment[]}\n * @private\n */\nexport function _computeSegments(line, segmentOptions) {\n  const points = line.points;\n  const spanGaps = line.options.spanGaps;\n  const count = points.length;\n\n  if (!count) {\n    return [];\n  }\n\n  const loop = !!line._loop;\n  const {start, end} = findStartAndEnd(points, count, loop, spanGaps);\n\n  if (spanGaps === true) {\n    return splitByStyles(line, [{start, end, loop}], points, segmentOptions);\n  }\n\n  const max = end < start ? end + count : end;\n  const completeLoop = !!line._fullLoop && start === 0 && end === count - 1;\n  return splitByStyles(line, solidSegments(points, start, max, completeLoop), points, segmentOptions);\n}\n\n/**\n * @param {Segment[]} segments\n * @param {PointElement[]} points\n * @param {object} [segmentOptions]\n * @return {Segment[]}\n */\nfunction splitByStyles(line, segments, points, segmentOptions) {\n  if (!segmentOptions || !segmentOptions.setContext || !points) {\n    return segments;\n  }\n  return doSplitByStyles(line, segments, points, segmentOptions);\n}\n\n/**\n * @param {LineElement} line\n * @param {Segment[]} segments\n * @param {PointElement[]} points\n * @param {object} [segmentOptions]\n * @return {Segment[]}\n */\nfunction doSplitByStyles(line, segments, points, segmentOptions) {\n  const chartContext = line._chart.getContext();\n  const baseStyle = readStyle(line.options);\n  const {_datasetIndex: datasetIndex, options: {spanGaps}} = line;\n  const count = points.length;\n  const result = [];\n  let prevStyle = baseStyle;\n  let start = segments[0].start;\n  let i = start;\n\n  function addStyle(s, e, l, st) {\n    const dir = spanGaps ? -1 : 1;\n    if (s === e) {\n      return;\n    }\n    // Style can not start/end on a skipped point, adjust indices accordingly\n    s += count;\n    while (points[s % count].skip) {\n      s -= dir;\n    }\n    while (points[e % count].skip) {\n      e += dir;\n    }\n    if (s % count !== e % count) {\n      result.push({start: s % count, end: e % count, loop: l, style: st});\n      prevStyle = st;\n      start = e % count;\n    }\n  }\n\n  for (const segment of segments) {\n    start = spanGaps ? start : segment.start;\n    let prev = points[start % count];\n    let style;\n    for (i = start + 1; i <= segment.end; i++) {\n      const pt = points[i % count];\n      style = readStyle(segmentOptions.setContext(createContext(chartContext, {\n        type: 'segment',\n        p0: prev,\n        p1: pt,\n        p0DataIndex: (i - 1) % count,\n        p1DataIndex: i % count,\n        datasetIndex\n      })));\n      if (styleChanged(style, prevStyle)) {\n        addStyle(start, i - 1, segment.loop, prevStyle);\n      }\n      prev = pt;\n      prevStyle = style;\n    }\n    if (start < i - 1) {\n      addStyle(start, i - 1, segment.loop, prevStyle);\n    }\n  }\n\n  return result;\n}\n\nfunction readStyle(options) {\n  return {\n    backgroundColor: options.backgroundColor,\n    borderCapStyle: options.borderCapStyle,\n    borderDash: options.borderDash,\n    borderDashOffset: options.borderDashOffset,\n    borderJoinStyle: options.borderJoinStyle,\n    borderWidth: options.borderWidth,\n    borderColor: options.borderColor\n  };\n}\n\nfunction styleChanged(style, prevStyle) {\n  return prevStyle && JSON.stringify(style) !== JSON.stringify(prevStyle);\n}\n","import {requestAnimFrame} from '../helpers/helpers.extras';\n\n/**\n * @typedef { import(\"./core.animation\").default } Animation\n * @typedef { import(\"./core.controller\").default } Chart\n */\n\n/**\n * Please use the module's default export which provides a singleton instance\n * Note: class is export for typedoc\n */\nexport class Animator {\n  constructor() {\n    this._request = null;\n    this._charts = new Map();\n    this._running = false;\n    this._lastDate = undefined;\n  }\n\n  /**\n\t * @private\n\t */\n  _notify(chart, anims, date, type) {\n    const callbacks = anims.listeners[type];\n    const numSteps = anims.duration;\n\n    callbacks.forEach(fn => fn({\n      chart,\n      initial: anims.initial,\n      numSteps,\n      currentStep: Math.min(date - anims.start, numSteps)\n    }));\n  }\n\n  /**\n\t * @private\n\t */\n  _refresh() {\n    if (this._request) {\n      return;\n    }\n    this._running = true;\n\n    this._request = requestAnimFrame.call(window, () => {\n      this._update();\n      this._request = null;\n\n      if (this._running) {\n        this._refresh();\n      }\n    });\n  }\n\n  /**\n\t * @private\n\t */\n  _update(date = Date.now()) {\n    let remaining = 0;\n\n    this._charts.forEach((anims, chart) => {\n      if (!anims.running || !anims.items.length) {\n        return;\n      }\n      const items = anims.items;\n      let i = items.length - 1;\n      let draw = false;\n      let item;\n\n      for (; i >= 0; --i) {\n        item = items[i];\n\n        if (item._active) {\n          if (item._total > anims.duration) {\n            // if the animation has been updated and its duration prolonged,\n            // update to total duration of current animations run (for progress event)\n            anims.duration = item._total;\n          }\n          item.tick(date);\n          draw = true;\n        } else {\n          // Remove the item by replacing it with last item and removing the last\n          // A lot faster than splice.\n          items[i] = items[items.length - 1];\n          items.pop();\n        }\n      }\n\n      if (draw) {\n        chart.draw();\n        this._notify(chart, anims, date, 'progress');\n      }\n\n      if (!items.length) {\n        anims.running = false;\n        this._notify(chart, anims, date, 'complete');\n        anims.initial = false;\n      }\n\n      remaining += items.length;\n    });\n\n    this._lastDate = date;\n\n    if (remaining === 0) {\n      this._running = false;\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _getAnims(chart) {\n    const charts = this._charts;\n    let anims = charts.get(chart);\n    if (!anims) {\n      anims = {\n        running: false,\n        initial: true,\n        items: [],\n        listeners: {\n          complete: [],\n          progress: []\n        }\n      };\n      charts.set(chart, anims);\n    }\n    return anims;\n  }\n\n  /**\n\t * @param {Chart} chart\n\t * @param {string} event - event name\n\t * @param {Function} cb - callback\n\t */\n  listen(chart, event, cb) {\n    this._getAnims(chart).listeners[event].push(cb);\n  }\n\n  /**\n\t * Add animations\n\t * @param {Chart} chart\n\t * @param {Animation[]} items - animations\n\t */\n  add(chart, items) {\n    if (!items || !items.length) {\n      return;\n    }\n    this._getAnims(chart).items.push(...items);\n  }\n\n  /**\n\t * Counts number of active animations for the chart\n\t * @param {Chart} chart\n\t */\n  has(chart) {\n    return this._getAnims(chart).items.length > 0;\n  }\n\n  /**\n\t * Start animating (all charts)\n\t * @param {Chart} chart\n\t */\n  start(chart) {\n    const anims = this._charts.get(chart);\n    if (!anims) {\n      return;\n    }\n    anims.running = true;\n    anims.start = Date.now();\n    anims.duration = anims.items.reduce((acc, cur) => Math.max(acc, cur._duration), 0);\n    this._refresh();\n  }\n\n  running(chart) {\n    if (!this._running) {\n      return false;\n    }\n    const anims = this._charts.get(chart);\n    if (!anims || !anims.running || !anims.items.length) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n\t * Stop all animations for the chart\n\t * @param {Chart} chart\n\t */\n  stop(chart) {\n    const anims = this._charts.get(chart);\n    if (!anims || !anims.items.length) {\n      return;\n    }\n    const items = anims.items;\n    let i = items.length - 1;\n\n    for (; i >= 0; --i) {\n      items[i].cancel();\n    }\n    anims.items = [];\n    this._notify(chart, anims, Date.now(), 'complete');\n  }\n\n  /**\n\t * Remove chart from Animator\n\t * @param {Chart} chart\n\t */\n  remove(chart) {\n    return this._charts.delete(chart);\n  }\n}\n\n// singleton instance\nexport default /* #__PURE__ */ new Animator();\n","import effects from '../helpers/helpers.easing';\nimport {resolve} from '../helpers/helpers.options';\nimport {color as helpersColor} from '../helpers/helpers.color';\n\nconst transparent = 'transparent';\nconst interpolators = {\n  boolean(from, to, factor) {\n    return factor > 0.5 ? to : from;\n  },\n  /**\n   * @param {string} from\n   * @param {string} to\n   * @param {number} factor\n   */\n  color(from, to, factor) {\n    const c0 = helpersColor(from || transparent);\n    const c1 = c0.valid && helpersColor(to || transparent);\n    return c1 && c1.valid\n      ? c1.mix(c0, factor).hexString()\n      : to;\n  },\n  number(from, to, factor) {\n    return from + (to - from) * factor;\n  }\n};\n\nexport default class Animation {\n  constructor(cfg, target, prop, to) {\n    const currentValue = target[prop];\n\n    to = resolve([cfg.to, to, currentValue, cfg.from]);\n    const from = resolve([cfg.from, currentValue, to]);\n\n    this._active = true;\n    this._fn = cfg.fn || interpolators[cfg.type || typeof from];\n    this._easing = effects[cfg.easing] || effects.linear;\n    this._start = Math.floor(Date.now() + (cfg.delay || 0));\n    this._duration = this._total = Math.floor(cfg.duration);\n    this._loop = !!cfg.loop;\n    this._target = target;\n    this._prop = prop;\n    this._from = from;\n    this._to = to;\n    this._promises = undefined;\n  }\n\n  active() {\n    return this._active;\n  }\n\n  update(cfg, to, date) {\n    if (this._active) {\n      this._notify(false);\n\n      const currentValue = this._target[this._prop];\n      const elapsed = date - this._start;\n      const remain = this._duration - elapsed;\n      this._start = date;\n      this._duration = Math.floor(Math.max(remain, cfg.duration));\n      this._total += elapsed;\n      this._loop = !!cfg.loop;\n      this._to = resolve([cfg.to, to, currentValue, cfg.from]);\n      this._from = resolve([cfg.from, currentValue, to]);\n    }\n  }\n\n  cancel() {\n    if (this._active) {\n      // update current evaluated value, for smoother animations\n      this.tick(Date.now());\n      this._active = false;\n      this._notify(false);\n    }\n  }\n\n  tick(date) {\n    const elapsed = date - this._start;\n    const duration = this._duration;\n    const prop = this._prop;\n    const from = this._from;\n    const loop = this._loop;\n    const to = this._to;\n    let factor;\n\n    this._active = from !== to && (loop || (elapsed < duration));\n\n    if (!this._active) {\n      this._target[prop] = to;\n      this._notify(true);\n      return;\n    }\n\n    if (elapsed < 0) {\n      this._target[prop] = from;\n      return;\n    }\n\n    factor = (elapsed / duration) % 2;\n    factor = loop && factor > 1 ? 2 - factor : factor;\n    factor = this._easing(Math.min(1, Math.max(0, factor)));\n\n    this._target[prop] = this._fn(from, to, factor);\n  }\n\n  wait() {\n    const promises = this._promises || (this._promises = []);\n    return new Promise((res, rej) => {\n      promises.push({res, rej});\n    });\n  }\n\n  _notify(resolved) {\n    const method = resolved ? 'res' : 'rej';\n    const promises = this._promises || [];\n    for (let i = 0; i < promises.length; i++) {\n      promises[i][method]();\n    }\n  }\n}\n","import animator from './core.animator';\nimport Animation from './core.animation';\nimport defaults from './core.defaults';\nimport {isArray, isObject} from '../helpers/helpers.core';\n\nexport default class Animations {\n  constructor(chart, config) {\n    this._chart = chart;\n    this._properties = new Map();\n    this.configure(config);\n  }\n\n  configure(config) {\n    if (!isObject(config)) {\n      return;\n    }\n\n    const animationOptions = Object.keys(defaults.animation);\n    const animatedProps = this._properties;\n\n    Object.getOwnPropertyNames(config).forEach(key => {\n      const cfg = config[key];\n      if (!isObject(cfg)) {\n        return;\n      }\n      const resolved = {};\n      for (const option of animationOptions) {\n        resolved[option] = cfg[option];\n      }\n\n      (isArray(cfg.properties) && cfg.properties || [key]).forEach((prop) => {\n        if (prop === key || !animatedProps.has(prop)) {\n          animatedProps.set(prop, resolved);\n        }\n      });\n    });\n  }\n\n  /**\n\t * Utility to handle animation of `options`.\n\t * @private\n\t */\n  _animateOptions(target, values) {\n    const newOptions = values.options;\n    const options = resolveTargetOptions(target, newOptions);\n    if (!options) {\n      return [];\n    }\n\n    const animations = this._createAnimations(options, newOptions);\n    if (newOptions.$shared) {\n      // Going to shared options:\n      // After all animations are done, assign the shared options object to the element\n      // So any new updates to the shared options are observed\n      awaitAll(target.options.$animations, newOptions).then(() => {\n        target.options = newOptions;\n      }, () => {\n        // rejected, noop\n      });\n    }\n\n    return animations;\n  }\n\n  /**\n\t * @private\n\t */\n  _createAnimations(target, values) {\n    const animatedProps = this._properties;\n    const animations = [];\n    const running = target.$animations || (target.$animations = {});\n    const props = Object.keys(values);\n    const date = Date.now();\n    let i;\n\n    for (i = props.length - 1; i >= 0; --i) {\n      const prop = props[i];\n      if (prop.charAt(0) === '$') {\n        continue;\n      }\n\n      if (prop === 'options') {\n        animations.push(...this._animateOptions(target, values));\n        continue;\n      }\n      const value = values[prop];\n      let animation = running[prop];\n      const cfg = animatedProps.get(prop);\n\n      if (animation) {\n        if (cfg && animation.active()) {\n          // There is an existing active animation, let's update that\n          animation.update(cfg, value, date);\n          continue;\n        } else {\n          animation.cancel();\n        }\n      }\n      if (!cfg || !cfg.duration) {\n        // not animated, set directly to new value\n        target[prop] = value;\n        continue;\n      }\n\n      running[prop] = animation = new Animation(cfg, target, prop, value);\n      animations.push(animation);\n    }\n    return animations;\n  }\n\n\n  /**\n\t * Update `target` properties to new values, using configured animations\n\t * @param {object} target - object to update\n\t * @param {object} values - new target properties\n\t * @returns {boolean|undefined} - `true` if animations were started\n\t **/\n  update(target, values) {\n    if (this._properties.size === 0) {\n      // Nothing is animated, just apply the new values.\n      Object.assign(target, values);\n      return;\n    }\n\n    const animations = this._createAnimations(target, values);\n\n    if (animations.length) {\n      animator.add(this._chart, animations);\n      return true;\n    }\n  }\n}\n\nfunction awaitAll(animations, properties) {\n  const running = [];\n  const keys = Object.keys(properties);\n  for (let i = 0; i < keys.length; i++) {\n    const anim = animations[keys[i]];\n    if (anim && anim.active()) {\n      running.push(anim.wait());\n    }\n  }\n  // @ts-ignore\n  return Promise.all(running);\n}\n\nfunction resolveTargetOptions(target, newOptions) {\n  if (!newOptions) {\n    return;\n  }\n  let options = target.options;\n  if (!options) {\n    target.options = newOptions;\n    return;\n  }\n  if (options.$shared) {\n    // Going from shared options to distinct one:\n    // Create new options object containing the old shared values and start updating that.\n    target.options = options = Object.assign({}, options, {$shared: false, $animations: {}});\n  }\n  return options;\n}\n","import Animations from './core.animations';\nimport defaults from './core.defaults';\nimport {isArray, isFinite, isObject, valueOrDefault, resolveObjectKey, defined} from '../helpers/helpers.core';\nimport {listenArrayEvents, unlistenArrayEvents} from '../helpers/helpers.collection';\nimport {createContext, sign} from '../helpers';\n\n/**\n * @typedef { import(\"./core.controller\").default } Chart\n * @typedef { import(\"./core.scale\").default } Scale\n */\n\nfunction scaleClip(scale, allowedOverflow) {\n  const opts = scale && scale.options || {};\n  const reverse = opts.reverse;\n  const min = opts.min === undefined ? allowedOverflow : 0;\n  const max = opts.max === undefined ? allowedOverflow : 0;\n  return {\n    start: reverse ? max : min,\n    end: reverse ? min : max\n  };\n}\n\nfunction defaultClip(xScale, yScale, allowedOverflow) {\n  if (allowedOverflow === false) {\n    return false;\n  }\n  const x = scaleClip(xScale, allowedOverflow);\n  const y = scaleClip(yScale, allowedOverflow);\n\n  return {\n    top: y.end,\n    right: x.end,\n    bottom: y.start,\n    left: x.start\n  };\n}\n\nfunction toClip(value) {\n  let t, r, b, l;\n\n  if (isObject(value)) {\n    t = value.top;\n    r = value.right;\n    b = value.bottom;\n    l = value.left;\n  } else {\n    t = r = b = l = value;\n  }\n\n  return {\n    top: t,\n    right: r,\n    bottom: b,\n    left: l,\n    disabled: value === false\n  };\n}\n\nfunction getSortedDatasetIndices(chart, filterVisible) {\n  const keys = [];\n  const metasets = chart._getSortedDatasetMetas(filterVisible);\n  let i, ilen;\n\n  for (i = 0, ilen = metasets.length; i < ilen; ++i) {\n    keys.push(metasets[i].index);\n  }\n  return keys;\n}\n\nfunction applyStack(stack, value, dsIndex, options = {}) {\n  const keys = stack.keys;\n  const singleMode = options.mode === 'single';\n  let i, ilen, datasetIndex, otherValue;\n\n  if (value === null) {\n    return;\n  }\n\n  for (i = 0, ilen = keys.length; i < ilen; ++i) {\n    datasetIndex = +keys[i];\n    if (datasetIndex === dsIndex) {\n      if (options.all) {\n        continue;\n      }\n      break;\n    }\n    otherValue = stack.values[datasetIndex];\n    if (isFinite(otherValue) && (singleMode || (value === 0 || sign(value) === sign(otherValue)))) {\n      value += otherValue;\n    }\n  }\n  return value;\n}\n\nfunction convertObjectDataToArray(data) {\n  const keys = Object.keys(data);\n  const adata = new Array(keys.length);\n  let i, ilen, key;\n  for (i = 0, ilen = keys.length; i < ilen; ++i) {\n    key = keys[i];\n    adata[i] = {\n      x: key,\n      y: data[key]\n    };\n  }\n  return adata;\n}\n\nfunction isStacked(scale, meta) {\n  const stacked = scale && scale.options.stacked;\n  return stacked || (stacked === undefined && meta.stack !== undefined);\n}\n\nfunction getStackKey(indexScale, valueScale, meta) {\n  return `${indexScale.id}.${valueScale.id}.${meta.stack || meta.type}`;\n}\n\nfunction getUserBounds(scale) {\n  const {min, max, minDefined, maxDefined} = scale.getUserBounds();\n  return {\n    min: minDefined ? min : Number.NEGATIVE_INFINITY,\n    max: maxDefined ? max : Number.POSITIVE_INFINITY\n  };\n}\n\nfunction getOrCreateStack(stacks, stackKey, indexValue) {\n  const subStack = stacks[stackKey] || (stacks[stackKey] = {});\n  return subStack[indexValue] || (subStack[indexValue] = {});\n}\n\nfunction getLastIndexInStack(stack, vScale, positive, type) {\n  for (const meta of vScale.getMatchingVisibleMetas(type).reverse()) {\n    const value = stack[meta.index];\n    if ((positive && value > 0) || (!positive && value < 0)) {\n      return meta.index;\n    }\n  }\n\n  return null;\n}\n\nfunction updateStacks(controller, parsed) {\n  const {chart, _cachedMeta: meta} = controller;\n  const stacks = chart._stacks || (chart._stacks = {}); // map structure is {stackKey: {datasetIndex: value}}\n  const {iScale, vScale, index: datasetIndex} = meta;\n  const iAxis = iScale.axis;\n  const vAxis = vScale.axis;\n  const key = getStackKey(iScale, vScale, meta);\n  const ilen = parsed.length;\n  let stack;\n\n  for (let i = 0; i < ilen; ++i) {\n    const item = parsed[i];\n    const {[iAxis]: index, [vAxis]: value} = item;\n    const itemStacks = item._stacks || (item._stacks = {});\n    stack = itemStacks[vAxis] = getOrCreateStack(stacks, key, index);\n    stack[datasetIndex] = value;\n\n    stack._top = getLastIndexInStack(stack, vScale, true, meta.type);\n    stack._bottom = getLastIndexInStack(stack, vScale, false, meta.type);\n  }\n}\n\nfunction getFirstScaleId(chart, axis) {\n  const scales = chart.scales;\n  return Object.keys(scales).filter(key => scales[key].axis === axis).shift();\n}\n\nfunction createDatasetContext(parent, index) {\n  return createContext(parent,\n    {\n      active: false,\n      dataset: undefined,\n      datasetIndex: index,\n      index,\n      mode: 'default',\n      type: 'dataset'\n    }\n  );\n}\n\nfunction createDataContext(parent, index, element) {\n  return createContext(parent, {\n    active: false,\n    dataIndex: index,\n    parsed: undefined,\n    raw: undefined,\n    element,\n    index,\n    mode: 'default',\n    type: 'data'\n  });\n}\n\nfunction clearStacks(meta, items) {\n  // Not using meta.index here, because it might be already updated if the dataset changed location\n  const datasetIndex = meta.controller.index;\n  const axis = meta.vScale && meta.vScale.axis;\n  if (!axis) {\n    return;\n  }\n\n  items = items || meta._parsed;\n  for (const parsed of items) {\n    const stacks = parsed._stacks;\n    if (!stacks || stacks[axis] === undefined || stacks[axis][datasetIndex] === undefined) {\n      return;\n    }\n    delete stacks[axis][datasetIndex];\n  }\n}\n\nconst isDirectUpdateMode = (mode) => mode === 'reset' || mode === 'none';\nconst cloneIfNotShared = (cached, shared) => shared ? cached : Object.assign({}, cached);\nconst createStack = (canStack, meta, chart) => canStack && !meta.hidden && meta._stacked\n  && {keys: getSortedDatasetIndices(chart, true), values: null};\n\nexport default class DatasetController {\n\n  /**\n   * @type {any}\n   */\n  static defaults = {};\n\n  /**\n   * Element type used to generate a meta dataset (e.g. Chart.element.LineElement).\n   */\n  static datasetElementType = null;\n\n  /**\n   * Element type used to generate a meta data (e.g. Chart.element.PointElement).\n   */\n  static dataElementType = null;\n\n  /**\n\t * @param {Chart} chart\n\t * @param {number} datasetIndex\n\t */\n  constructor(chart, datasetIndex) {\n    this.chart = chart;\n    this._ctx = chart.ctx;\n    this.index = datasetIndex;\n    this._cachedDataOpts = {};\n    this._cachedMeta = this.getMeta();\n    this._type = this._cachedMeta.type;\n    this.options = undefined;\n    /** @type {boolean | object} */\n    this._parsing = false;\n    this._data = undefined;\n    this._objectData = undefined;\n    this._sharedOptions = undefined;\n    this._drawStart = undefined;\n    this._drawCount = undefined;\n    this.enableOptionSharing = false;\n    this.supportsDecimation = false;\n    this.$context = undefined;\n    this._syncList = [];\n    this.datasetElementType = new.target.datasetElementType;\n    this.dataElementType = new.target.dataElementType;\n\n    this.initialize();\n  }\n\n  initialize() {\n    const meta = this._cachedMeta;\n    this.configure();\n    this.linkScales();\n    meta._stacked = isStacked(meta.vScale, meta);\n    this.addElements();\n\n    if (this.options.fill && !this.chart.isPluginEnabled('filler')) {\n      console.warn(\"Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options\");\n    }\n  }\n\n  updateIndex(datasetIndex) {\n    if (this.index !== datasetIndex) {\n      clearStacks(this._cachedMeta);\n    }\n    this.index = datasetIndex;\n  }\n\n  linkScales() {\n    const chart = this.chart;\n    const meta = this._cachedMeta;\n    const dataset = this.getDataset();\n\n    const chooseId = (axis, x, y, r) => axis === 'x' ? x : axis === 'r' ? r : y;\n\n    const xid = meta.xAxisID = valueOrDefault(dataset.xAxisID, getFirstScaleId(chart, 'x'));\n    const yid = meta.yAxisID = valueOrDefault(dataset.yAxisID, getFirstScaleId(chart, 'y'));\n    const rid = meta.rAxisID = valueOrDefault(dataset.rAxisID, getFirstScaleId(chart, 'r'));\n    const indexAxis = meta.indexAxis;\n    const iid = meta.iAxisID = chooseId(indexAxis, xid, yid, rid);\n    const vid = meta.vAxisID = chooseId(indexAxis, yid, xid, rid);\n    meta.xScale = this.getScaleForId(xid);\n    meta.yScale = this.getScaleForId(yid);\n    meta.rScale = this.getScaleForId(rid);\n    meta.iScale = this.getScaleForId(iid);\n    meta.vScale = this.getScaleForId(vid);\n  }\n\n  getDataset() {\n    return this.chart.data.datasets[this.index];\n  }\n\n  getMeta() {\n    return this.chart.getDatasetMeta(this.index);\n  }\n\n  /**\n\t * @param {string} scaleID\n\t * @return {Scale}\n\t */\n  getScaleForId(scaleID) {\n    return this.chart.scales[scaleID];\n  }\n\n  /**\n\t * @private\n\t */\n  _getOtherScale(scale) {\n    const meta = this._cachedMeta;\n    return scale === meta.iScale\n      ? meta.vScale\n      : meta.iScale;\n  }\n\n  reset() {\n    this._update('reset');\n  }\n\n  /**\n\t * @private\n\t */\n  _destroy() {\n    const meta = this._cachedMeta;\n    if (this._data) {\n      unlistenArrayEvents(this._data, this);\n    }\n    if (meta._stacked) {\n      clearStacks(meta);\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _dataCheck() {\n    const dataset = this.getDataset();\n    const data = dataset.data || (dataset.data = []);\n    const _data = this._data;\n\n    // In order to correctly handle data addition/deletion animation (an thus simulate\n    // real-time charts), we need to monitor these data modifications and synchronize\n    // the internal meta data accordingly.\n\n    if (isObject(data)) {\n      this._data = convertObjectDataToArray(data);\n    } else if (_data !== data) {\n      if (_data) {\n        // This case happens when the user replaced the data array instance.\n        unlistenArrayEvents(_data, this);\n        // Discard old parsed data and stacks\n        const meta = this._cachedMeta;\n        clearStacks(meta);\n        meta._parsed = [];\n      }\n      if (data && Object.isExtensible(data)) {\n        listenArrayEvents(data, this);\n      }\n      this._syncList = [];\n      this._data = data;\n    }\n  }\n\n  addElements() {\n    const meta = this._cachedMeta;\n\n    this._dataCheck();\n\n    if (this.datasetElementType) {\n      meta.dataset = new this.datasetElementType();\n    }\n  }\n\n  buildOrUpdateElements(resetNewElements) {\n    const meta = this._cachedMeta;\n    const dataset = this.getDataset();\n    let stackChanged = false;\n\n    this._dataCheck();\n\n    // make sure cached _stacked status is current\n    const oldStacked = meta._stacked;\n    meta._stacked = isStacked(meta.vScale, meta);\n\n    // detect change in stack option\n    if (meta.stack !== dataset.stack) {\n      stackChanged = true;\n      // remove values from old stack\n      clearStacks(meta);\n      meta.stack = dataset.stack;\n    }\n\n    // Re-sync meta data in case the user replaced the data array or if we missed\n    // any updates and so make sure that we handle number of datapoints changing.\n    this._resyncElements(resetNewElements);\n\n    // if stack changed, update stack values for the whole dataset\n    if (stackChanged || oldStacked !== meta._stacked) {\n      updateStacks(this, meta._parsed);\n    }\n  }\n\n  /**\n\t * Merges user-supplied and default dataset-level options\n\t * @private\n\t */\n  configure() {\n    const config = this.chart.config;\n    const scopeKeys = config.datasetScopeKeys(this._type);\n    const scopes = config.getOptionScopes(this.getDataset(), scopeKeys, true);\n    this.options = config.createResolver(scopes, this.getContext());\n    this._parsing = this.options.parsing;\n    this._cachedDataOpts = {};\n  }\n\n  /**\n\t * @param {number} start\n\t * @param {number} count\n\t */\n  parse(start, count) {\n    const {_cachedMeta: meta, _data: data} = this;\n    const {iScale, _stacked} = meta;\n    const iAxis = iScale.axis;\n\n    let sorted = start === 0 && count === data.length ? true : meta._sorted;\n    let prev = start > 0 && meta._parsed[start - 1];\n    let i, cur, parsed;\n\n    if (this._parsing === false) {\n      meta._parsed = data;\n      meta._sorted = true;\n      parsed = data;\n    } else {\n      if (isArray(data[start])) {\n        parsed = this.parseArrayData(meta, data, start, count);\n      } else if (isObject(data[start])) {\n        parsed = this.parseObjectData(meta, data, start, count);\n      } else {\n        parsed = this.parsePrimitiveData(meta, data, start, count);\n      }\n\n      const isNotInOrderComparedToPrev = () => cur[iAxis] === null || (prev && cur[iAxis] < prev[iAxis]);\n      for (i = 0; i < count; ++i) {\n        meta._parsed[i + start] = cur = parsed[i];\n        if (sorted) {\n          if (isNotInOrderComparedToPrev()) {\n            sorted = false;\n          }\n          prev = cur;\n        }\n      }\n      meta._sorted = sorted;\n    }\n\n    if (_stacked) {\n      updateStacks(this, parsed);\n    }\n  }\n\n  /**\n\t * Parse array of primitive values\n\t * @param {object} meta - dataset meta\n\t * @param {array} data - data array. Example [1,3,4]\n\t * @param {number} start - start index\n\t * @param {number} count - number of items to parse\n\t * @returns {object} parsed item - item containing index and a parsed value\n\t * for each scale id.\n\t * Example: {xScale0: 0, yScale0: 1}\n\t * @protected\n\t */\n  parsePrimitiveData(meta, data, start, count) {\n    const {iScale, vScale} = meta;\n    const iAxis = iScale.axis;\n    const vAxis = vScale.axis;\n    const labels = iScale.getLabels();\n    const singleScale = iScale === vScale;\n    const parsed = new Array(count);\n    let i, ilen, index;\n\n    for (i = 0, ilen = count; i < ilen; ++i) {\n      index = i + start;\n      parsed[i] = {\n        [iAxis]: singleScale || iScale.parse(labels[index], index),\n        [vAxis]: vScale.parse(data[index], index)\n      };\n    }\n    return parsed;\n  }\n\n  /**\n\t * Parse array of arrays\n\t * @param {object} meta - dataset meta\n\t * @param {array} data - data array. Example [[1,2],[3,4]]\n\t * @param {number} start - start index\n\t * @param {number} count - number of items to parse\n\t * @returns {object} parsed item - item containing index and a parsed value\n\t * for each scale id.\n\t * Example: {x: 0, y: 1}\n\t * @protected\n\t */\n  parseArrayData(meta, data, start, count) {\n    const {xScale, yScale} = meta;\n    const parsed = new Array(count);\n    let i, ilen, index, item;\n\n    for (i = 0, ilen = count; i < ilen; ++i) {\n      index = i + start;\n      item = data[index];\n      parsed[i] = {\n        x: xScale.parse(item[0], index),\n        y: yScale.parse(item[1], index)\n      };\n    }\n    return parsed;\n  }\n\n  /**\n\t * Parse array of objects\n\t * @param {object} meta - dataset meta\n\t * @param {array} data - data array. Example [{x:1, y:5}, {x:2, y:10}]\n\t * @param {number} start - start index\n\t * @param {number} count - number of items to parse\n\t * @returns {object} parsed item - item containing index and a parsed value\n\t * for each scale id. _custom is optional\n\t * Example: {xScale0: 0, yScale0: 1, _custom: {r: 10, foo: 'bar'}}\n\t * @protected\n\t */\n  parseObjectData(meta, data, start, count) {\n    const {xScale, yScale} = meta;\n    const {xAxisKey = 'x', yAxisKey = 'y'} = this._parsing;\n    const parsed = new Array(count);\n    let i, ilen, index, item;\n\n    for (i = 0, ilen = count; i < ilen; ++i) {\n      index = i + start;\n      item = data[index];\n      parsed[i] = {\n        x: xScale.parse(resolveObjectKey(item, xAxisKey), index),\n        y: yScale.parse(resolveObjectKey(item, yAxisKey), index)\n      };\n    }\n    return parsed;\n  }\n\n  /**\n\t * @protected\n\t */\n  getParsed(index) {\n    return this._cachedMeta._parsed[index];\n  }\n\n  /**\n\t * @protected\n\t */\n  getDataElement(index) {\n    return this._cachedMeta.data[index];\n  }\n\n  /**\n\t * @protected\n\t */\n  applyStack(scale, parsed, mode) {\n    const chart = this.chart;\n    const meta = this._cachedMeta;\n    const value = parsed[scale.axis];\n    const stack = {\n      keys: getSortedDatasetIndices(chart, true),\n      values: parsed._stacks[scale.axis]\n    };\n    return applyStack(stack, value, meta.index, {mode});\n  }\n\n  /**\n\t * @protected\n\t */\n  updateRangeFromParsed(range, scale, parsed, stack) {\n    const parsedValue = parsed[scale.axis];\n    let value = parsedValue === null ? NaN : parsedValue;\n    const values = stack && parsed._stacks[scale.axis];\n    if (stack && values) {\n      stack.values = values;\n      value = applyStack(stack, parsedValue, this._cachedMeta.index);\n    }\n    range.min = Math.min(range.min, value);\n    range.max = Math.max(range.max, value);\n  }\n\n  /**\n\t * @protected\n\t */\n  getMinMax(scale, canStack) {\n    const meta = this._cachedMeta;\n    const _parsed = meta._parsed;\n    const sorted = meta._sorted && scale === meta.iScale;\n    const ilen = _parsed.length;\n    const otherScale = this._getOtherScale(scale);\n    const stack = createStack(canStack, meta, this.chart);\n    const range = {min: Number.POSITIVE_INFINITY, max: Number.NEGATIVE_INFINITY};\n    const {min: otherMin, max: otherMax} = getUserBounds(otherScale);\n    let i, parsed;\n\n    function _skip() {\n      parsed = _parsed[i];\n      const otherValue = parsed[otherScale.axis];\n      return !isFinite(parsed[scale.axis]) || otherMin > otherValue || otherMax < otherValue;\n    }\n\n    for (i = 0; i < ilen; ++i) {\n      if (_skip()) {\n        continue;\n      }\n      this.updateRangeFromParsed(range, scale, parsed, stack);\n      if (sorted) {\n        // if the data is sorted, we don't need to check further from this end of array\n        break;\n      }\n    }\n    if (sorted) {\n      // in the sorted case, find first non-skipped value from other end of array\n      for (i = ilen - 1; i >= 0; --i) {\n        if (_skip()) {\n          continue;\n        }\n        this.updateRangeFromParsed(range, scale, parsed, stack);\n        break;\n      }\n    }\n    return range;\n  }\n\n  getAllParsedValues(scale) {\n    const parsed = this._cachedMeta._parsed;\n    const values = [];\n    let i, ilen, value;\n\n    for (i = 0, ilen = parsed.length; i < ilen; ++i) {\n      value = parsed[i][scale.axis];\n      if (isFinite(value)) {\n        values.push(value);\n      }\n    }\n    return values;\n  }\n\n  /**\n\t * @return {number|boolean}\n\t * @protected\n\t */\n  getMaxOverflow() {\n    return false;\n  }\n\n  /**\n\t * @protected\n\t */\n  getLabelAndValue(index) {\n    const meta = this._cachedMeta;\n    const iScale = meta.iScale;\n    const vScale = meta.vScale;\n    const parsed = this.getParsed(index);\n    return {\n      label: iScale ? '' + iScale.getLabelForValue(parsed[iScale.axis]) : '',\n      value: vScale ? '' + vScale.getLabelForValue(parsed[vScale.axis]) : ''\n    };\n  }\n\n  /**\n\t * @private\n\t */\n  _update(mode) {\n    const meta = this._cachedMeta;\n    this.update(mode || 'default');\n    meta._clip = toClip(valueOrDefault(this.options.clip, defaultClip(meta.xScale, meta.yScale, this.getMaxOverflow())));\n  }\n\n  /**\n\t * @param {string} mode\n\t */\n  update(mode) {} // eslint-disable-line no-unused-vars\n\n  draw() {\n    const ctx = this._ctx;\n    const chart = this.chart;\n    const meta = this._cachedMeta;\n    const elements = meta.data || [];\n    const area = chart.chartArea;\n    const active = [];\n    const start = this._drawStart || 0;\n    const count = this._drawCount || (elements.length - start);\n    const drawActiveElementsOnTop = this.options.drawActiveElementsOnTop;\n    let i;\n\n    if (meta.dataset) {\n      meta.dataset.draw(ctx, area, start, count);\n    }\n\n    for (i = start; i < start + count; ++i) {\n      const element = elements[i];\n      if (element.hidden) {\n        continue;\n      }\n      if (element.active && drawActiveElementsOnTop) {\n        active.push(element);\n      } else {\n        element.draw(ctx, area);\n      }\n    }\n\n    for (i = 0; i < active.length; ++i) {\n      active[i].draw(ctx, area);\n    }\n  }\n\n  /**\n\t * Returns a set of predefined style properties that should be used to represent the dataset\n\t * or the data if the index is specified\n\t * @param {number} index - data index\n\t * @param {boolean} [active] - true if hover\n\t * @return {object} style object\n\t */\n  getStyle(index, active) {\n    const mode = active ? 'active' : 'default';\n    return index === undefined && this._cachedMeta.dataset\n      ? this.resolveDatasetElementOptions(mode)\n      : this.resolveDataElementOptions(index || 0, mode);\n  }\n\n  /**\n\t * @protected\n\t */\n  getContext(index, active, mode) {\n    const dataset = this.getDataset();\n    let context;\n    if (index >= 0 && index < this._cachedMeta.data.length) {\n      const element = this._cachedMeta.data[index];\n      context = element.$context ||\n        (element.$context = createDataContext(this.getContext(), index, element));\n      context.parsed = this.getParsed(index);\n      context.raw = dataset.data[index];\n      context.index = context.dataIndex = index;\n    } else {\n      context = this.$context ||\n        (this.$context = createDatasetContext(this.chart.getContext(), this.index));\n      context.dataset = dataset;\n      context.index = context.datasetIndex = this.index;\n    }\n\n    context.active = !!active;\n    context.mode = mode;\n    return context;\n  }\n\n  /**\n\t * @param {string} [mode]\n\t * @protected\n\t */\n  resolveDatasetElementOptions(mode) {\n    return this._resolveElementOptions(this.datasetElementType.id, mode);\n  }\n\n  /**\n\t * @param {number} index\n\t * @param {string} [mode]\n\t * @protected\n\t */\n  resolveDataElementOptions(index, mode) {\n    return this._resolveElementOptions(this.dataElementType.id, mode, index);\n  }\n\n  /**\n\t * @private\n\t */\n  _resolveElementOptions(elementType, mode = 'default', index) {\n    const active = mode === 'active';\n    const cache = this._cachedDataOpts;\n    const cacheKey = elementType + '-' + mode;\n    const cached = cache[cacheKey];\n    const sharing = this.enableOptionSharing && defined(index);\n    if (cached) {\n      return cloneIfNotShared(cached, sharing);\n    }\n    const config = this.chart.config;\n    const scopeKeys = config.datasetElementScopeKeys(this._type, elementType);\n    const prefixes = active ? [`${elementType}Hover`, 'hover', elementType, ''] : [elementType, ''];\n    const scopes = config.getOptionScopes(this.getDataset(), scopeKeys);\n    const names = Object.keys(defaults.elements[elementType]);\n    // context is provided as a function, and is called only if needed,\n    // so we don't create a context for each element if not needed.\n    const context = () => this.getContext(index, active);\n    const values = config.resolveNamedOptions(scopes, names, context, prefixes);\n\n    if (values.$shared) {\n      // `$shared` indicates this set of options can be shared between multiple elements.\n      // Sharing is used to reduce number of properties to change during animation.\n      values.$shared = sharing;\n\n      // We cache options by `mode`, which can be 'active' for example. This enables us\n      // to have the 'active' element options and 'default' options to switch between\n      // when interacting.\n      cache[cacheKey] = Object.freeze(cloneIfNotShared(values, sharing));\n    }\n\n    return values;\n  }\n\n\n  /**\n\t * @private\n\t */\n  _resolveAnimations(index, transition, active) {\n    const chart = this.chart;\n    const cache = this._cachedDataOpts;\n    const cacheKey = `animation-${transition}`;\n    const cached = cache[cacheKey];\n    if (cached) {\n      return cached;\n    }\n    let options;\n    if (chart.options.animation !== false) {\n      const config = this.chart.config;\n      const scopeKeys = config.datasetAnimationScopeKeys(this._type, transition);\n      const scopes = config.getOptionScopes(this.getDataset(), scopeKeys);\n      options = config.createResolver(scopes, this.getContext(index, active, transition));\n    }\n    const animations = new Animations(chart, options && options.animations);\n    if (options && options._cacheable) {\n      cache[cacheKey] = Object.freeze(animations);\n    }\n    return animations;\n  }\n\n  /**\n\t * Utility for getting the options object shared between elements\n\t * @protected\n\t */\n  getSharedOptions(options) {\n    if (!options.$shared) {\n      return;\n    }\n    return this._sharedOptions || (this._sharedOptions = Object.assign({}, options));\n  }\n\n  /**\n\t * Utility for determining if `options` should be included in the updated properties\n\t * @protected\n\t */\n  includeOptions(mode, sharedOptions) {\n    return !sharedOptions || isDirectUpdateMode(mode) || this.chart._animationsDisabled;\n  }\n\n  /**\n   * @todo v4, rename to getSharedOptions and remove excess functions\n   */\n  _getSharedOptions(start, mode) {\n    const firstOpts = this.resolveDataElementOptions(start, mode);\n    const previouslySharedOptions = this._sharedOptions;\n    const sharedOptions = this.getSharedOptions(firstOpts);\n    const includeOptions = this.includeOptions(mode, sharedOptions) || (sharedOptions !== previouslySharedOptions);\n    this.updateSharedOptions(sharedOptions, mode, firstOpts);\n    return {sharedOptions, includeOptions};\n  }\n\n  /**\n\t * Utility for updating an element with new properties, using animations when appropriate.\n\t * @protected\n\t */\n  updateElement(element, index, properties, mode) {\n    if (isDirectUpdateMode(mode)) {\n      Object.assign(element, properties);\n    } else {\n      this._resolveAnimations(index, mode).update(element, properties);\n    }\n  }\n\n  /**\n\t * Utility to animate the shared options, that are potentially affecting multiple elements.\n\t * @protected\n\t */\n  updateSharedOptions(sharedOptions, mode, newOptions) {\n    if (sharedOptions && !isDirectUpdateMode(mode)) {\n      this._resolveAnimations(undefined, mode).update(sharedOptions, newOptions);\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _setStyle(element, index, mode, active) {\n    element.active = active;\n    const options = this.getStyle(index, active);\n    this._resolveAnimations(index, mode, active).update(element, {\n      // When going from active to inactive, we need to update to the shared options.\n      // This way the once hovered element will end up with the same original shared options instance, after animation.\n      options: (!active && this.getSharedOptions(options)) || options\n    });\n  }\n\n  removeHoverStyle(element, datasetIndex, index) {\n    this._setStyle(element, index, 'active', false);\n  }\n\n  setHoverStyle(element, datasetIndex, index) {\n    this._setStyle(element, index, 'active', true);\n  }\n\n  /**\n\t * @private\n\t */\n  _removeDatasetHoverStyle() {\n    const element = this._cachedMeta.dataset;\n\n    if (element) {\n      this._setStyle(element, undefined, 'active', false);\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _setDatasetHoverStyle() {\n    const element = this._cachedMeta.dataset;\n\n    if (element) {\n      this._setStyle(element, undefined, 'active', true);\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _resyncElements(resetNewElements) {\n    const data = this._data;\n    const elements = this._cachedMeta.data;\n\n    // Apply changes detected through array listeners\n    for (const [method, arg1, arg2] of this._syncList) {\n      this[method](arg1, arg2);\n    }\n    this._syncList = [];\n\n    const numMeta = elements.length;\n    const numData = data.length;\n    const count = Math.min(numData, numMeta);\n\n    if (count) {\n      // TODO: It is not optimal to always parse the old data\n      // This is done because we are not detecting direct assignments:\n      // chart.data.datasets[0].data[5] = 10;\n      // chart.data.datasets[0].data[5].y = 10;\n      this.parse(0, count);\n    }\n\n    if (numData > numMeta) {\n      this._insertElements(numMeta, numData - numMeta, resetNewElements);\n    } else if (numData < numMeta) {\n      this._removeElements(numData, numMeta - numData);\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _insertElements(start, count, resetNewElements = true) {\n    const meta = this._cachedMeta;\n    const data = meta.data;\n    const end = start + count;\n    let i;\n\n    const move = (arr) => {\n      arr.length += count;\n      for (i = arr.length - 1; i >= end; i--) {\n        arr[i] = arr[i - count];\n      }\n    };\n    move(data);\n\n    for (i = start; i < end; ++i) {\n      data[i] = new this.dataElementType();\n    }\n\n    if (this._parsing) {\n      move(meta._parsed);\n    }\n    this.parse(start, count);\n\n    if (resetNewElements) {\n      this.updateElements(data, start, count, 'reset');\n    }\n  }\n\n  updateElements(element, start, count, mode) {} // eslint-disable-line no-unused-vars\n\n  /**\n\t * @private\n\t */\n  _removeElements(start, count) {\n    const meta = this._cachedMeta;\n    if (this._parsing) {\n      const removed = meta._parsed.splice(start, count);\n      if (meta._stacked) {\n        clearStacks(meta, removed);\n      }\n    }\n    meta.data.splice(start, count);\n  }\n\n  /**\n\t * @private\n   */\n  _sync(args) {\n    if (this._parsing) {\n      this._syncList.push(args);\n    } else {\n      const [method, arg1, arg2] = args;\n      this[method](arg1, arg2);\n    }\n    this.chart._dataChanges.push([this.index, ...args]);\n  }\n\n  _onDataPush() {\n    const count = arguments.length;\n    this._sync(['_insertElements', this.getDataset().data.length - count, count]);\n  }\n\n  _onDataPop() {\n    this._sync(['_removeElements', this._cachedMeta.data.length - 1, 1]);\n  }\n\n  _onDataShift() {\n    this._sync(['_removeElements', 0, 1]);\n  }\n\n  _onDataSplice(start, count) {\n    if (count) {\n      this._sync(['_removeElements', start, count]);\n    }\n    const newCount = arguments.length - 2;\n    if (newCount) {\n      this._sync(['_insertElements', start, newCount]);\n    }\n  }\n\n  _onDataUnshift() {\n    this._sync(['_insertElements', 0, arguments.length]);\n  }\n}\n","import DatasetController from '../core/core.datasetController';\nimport {\n  _arrayUnique, isArray, isNullOrUndef,\n  valueOrDefault, resolveObjectKey, sign, defined\n} from '../helpers';\n\nfunction getAllScaleValues(scale, type) {\n  if (!scale._cache.$bar) {\n    const visibleMetas = scale.getMatchingVisibleMetas(type);\n    let values = [];\n\n    for (let i = 0, ilen = visibleMetas.length; i < ilen; i++) {\n      values = values.concat(visibleMetas[i].controller.getAllParsedValues(scale));\n    }\n    scale._cache.$bar = _arrayUnique(values.sort((a, b) => a - b));\n  }\n  return scale._cache.$bar;\n}\n\n/**\n * Computes the \"optimal\" sample size to maintain bars equally sized while preventing overlap.\n * @private\n */\nfunction computeMinSampleSize(meta) {\n  const scale = meta.iScale;\n  const values = getAllScaleValues(scale, meta.type);\n  let min = scale._length;\n  let i, ilen, curr, prev;\n  const updateMinAndPrev = () => {\n    if (curr === 32767 || curr === -32768) {\n      // Ignore truncated pixels\n      return;\n    }\n    if (defined(prev)) {\n      // curr - prev === 0 is ignored\n      min = Math.min(min, Math.abs(curr - prev) || min);\n    }\n    prev = curr;\n  };\n\n  for (i = 0, ilen = values.length; i < ilen; ++i) {\n    curr = scale.getPixelForValue(values[i]);\n    updateMinAndPrev();\n  }\n\n  prev = undefined;\n  for (i = 0, ilen = scale.ticks.length; i < ilen; ++i) {\n    curr = scale.getPixelForTick(i);\n    updateMinAndPrev();\n  }\n\n  return min;\n}\n\n/**\n * Computes an \"ideal\" category based on the absolute bar thickness or, if undefined or null,\n * uses the smallest interval (see computeMinSampleSize) that prevents bar overlapping. This\n * mode currently always generates bars equally sized (until we introduce scriptable options?).\n * @private\n */\nfunction computeFitCategoryTraits(index, ruler, options, stackCount) {\n  const thickness = options.barThickness;\n  let size, ratio;\n\n  if (isNullOrUndef(thickness)) {\n    size = ruler.min * options.categoryPercentage;\n    ratio = options.barPercentage;\n  } else {\n    // When bar thickness is enforced, category and bar percentages are ignored.\n    // Note(SB): we could add support for relative bar thickness (e.g. barThickness: '50%')\n    // and deprecate barPercentage since this value is ignored when thickness is absolute.\n    size = thickness * stackCount;\n    ratio = 1;\n  }\n\n  return {\n    chunk: size / stackCount,\n    ratio,\n    start: ruler.pixels[index] - (size / 2)\n  };\n}\n\n/**\n * Computes an \"optimal\" category that globally arranges bars side by side (no gap when\n * percentage options are 1), based on the previous and following categories. This mode\n * generates bars with different widths when data are not evenly spaced.\n * @private\n */\nfunction computeFlexCategoryTraits(index, ruler, options, stackCount) {\n  const pixels = ruler.pixels;\n  const curr = pixels[index];\n  let prev = index > 0 ? pixels[index - 1] : null;\n  let next = index < pixels.length - 1 ? pixels[index + 1] : null;\n  const percent = options.categoryPercentage;\n\n  if (prev === null) {\n    // first data: its size is double based on the next point or,\n    // if it's also the last data, we use the scale size.\n    prev = curr - (next === null ? ruler.end - ruler.start : next - curr);\n  }\n\n  if (next === null) {\n    // last data: its size is also double based on the previous point.\n    next = curr + curr - prev;\n  }\n\n  const start = curr - (curr - Math.min(prev, next)) / 2 * percent;\n  const size = Math.abs(next - prev) / 2 * percent;\n\n  return {\n    chunk: size / stackCount,\n    ratio: options.barPercentage,\n    start\n  };\n}\n\nfunction parseFloatBar(entry, item, vScale, i) {\n  const startValue = vScale.parse(entry[0], i);\n  const endValue = vScale.parse(entry[1], i);\n  const min = Math.min(startValue, endValue);\n  const max = Math.max(startValue, endValue);\n  let barStart = min;\n  let barEnd = max;\n\n  if (Math.abs(min) > Math.abs(max)) {\n    barStart = max;\n    barEnd = min;\n  }\n\n  // Store `barEnd` (furthest away from origin) as parsed value,\n  // to make stacking straight forward\n  item[vScale.axis] = barEnd;\n\n  item._custom = {\n    barStart,\n    barEnd,\n    start: startValue,\n    end: endValue,\n    min,\n    max\n  };\n}\n\nfunction parseValue(entry, item, vScale, i) {\n  if (isArray(entry)) {\n    parseFloatBar(entry, item, vScale, i);\n  } else {\n    item[vScale.axis] = vScale.parse(entry, i);\n  }\n  return item;\n}\n\nfunction parseArrayOrPrimitive(meta, data, start, count) {\n  const iScale = meta.iScale;\n  const vScale = meta.vScale;\n  const labels = iScale.getLabels();\n  const singleScale = iScale === vScale;\n  const parsed = [];\n  let i, ilen, item, entry;\n\n  for (i = start, ilen = start + count; i < ilen; ++i) {\n    entry = data[i];\n    item = {};\n    item[iScale.axis] = singleScale || iScale.parse(labels[i], i);\n    parsed.push(parseValue(entry, item, vScale, i));\n  }\n  return parsed;\n}\n\nfunction isFloatBar(custom) {\n  return custom && custom.barStart !== undefined && custom.barEnd !== undefined;\n}\n\nfunction barSign(size, vScale, actualBase) {\n  if (size !== 0) {\n    return sign(size);\n  }\n  return (vScale.isHorizontal() ? 1 : -1) * (vScale.min >= actualBase ? 1 : -1);\n}\n\nfunction borderProps(properties) {\n  let reverse, start, end, top, bottom;\n  if (properties.horizontal) {\n    reverse = properties.base > properties.x;\n    start = 'left';\n    end = 'right';\n  } else {\n    reverse = properties.base < properties.y;\n    start = 'bottom';\n    end = 'top';\n  }\n  if (reverse) {\n    top = 'end';\n    bottom = 'start';\n  } else {\n    top = 'start';\n    bottom = 'end';\n  }\n  return {start, end, reverse, top, bottom};\n}\n\nfunction setBorderSkipped(properties, options, stack, index) {\n  let edge = options.borderSkipped;\n  const res = {};\n\n  if (!edge) {\n    properties.borderSkipped = res;\n    return;\n  }\n\n  if (edge === true) {\n    properties.borderSkipped = {top: true, right: true, bottom: true, left: true};\n    return;\n  }\n\n  const {start, end, reverse, top, bottom} = borderProps(properties);\n\n  if (edge === 'middle' && stack) {\n    properties.enableBorderRadius = true;\n    if ((stack._top || 0) === index) {\n      edge = top;\n    } else if ((stack._bottom || 0) === index) {\n      edge = bottom;\n    } else {\n      res[parseEdge(bottom, start, end, reverse)] = true;\n      edge = top;\n    }\n  }\n\n  res[parseEdge(edge, start, end, reverse)] = true;\n  properties.borderSkipped = res;\n}\n\nfunction parseEdge(edge, a, b, reverse) {\n  if (reverse) {\n    edge = swap(edge, a, b);\n    edge = startEnd(edge, b, a);\n  } else {\n    edge = startEnd(edge, a, b);\n  }\n  return edge;\n}\n\nfunction swap(orig, v1, v2) {\n  return orig === v1 ? v2 : orig === v2 ? v1 : orig;\n}\n\nfunction startEnd(v, start, end) {\n  return v === 'start' ? start : v === 'end' ? end : v;\n}\n\nfunction setInflateAmount(properties, {inflateAmount}, ratio) {\n  properties.inflateAmount = inflateAmount === 'auto'\n    ? ratio === 1 ? 0.33 : 0\n    : inflateAmount;\n}\n\nexport default class BarController extends DatasetController {\n\n  static id = 'bar';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    datasetElementType: false,\n    dataElementType: 'bar',\n\n    categoryPercentage: 0.8,\n    barPercentage: 0.9,\n    grouped: true,\n\n    animations: {\n      numbers: {\n        type: 'number',\n        properties: ['x', 'y', 'base', 'width', 'height']\n      }\n    }\n  };\n\n  /**\n   * @type {any}\n   */\n  static overrides = {\n    scales: {\n      _index_: {\n        type: 'category',\n        offset: true,\n        grid: {\n          offset: true\n        }\n      },\n      _value_: {\n        type: 'linear',\n        beginAtZero: true,\n      }\n    }\n  };\n\n\n  /**\n\t * Overriding primitive data parsing since we support mixed primitive/array\n\t * data for float bars\n\t * @protected\n\t */\n  parsePrimitiveData(meta, data, start, count) {\n    return parseArrayOrPrimitive(meta, data, start, count);\n  }\n\n  /**\n\t * Overriding array data parsing since we support mixed primitive/array\n\t * data for float bars\n\t * @protected\n\t */\n  parseArrayData(meta, data, start, count) {\n    return parseArrayOrPrimitive(meta, data, start, count);\n  }\n\n  /**\n\t * Overriding object data parsing since we support mixed primitive/array\n\t * value-scale data for float bars\n\t * @protected\n\t */\n  parseObjectData(meta, data, start, count) {\n    const {iScale, vScale} = meta;\n    const {xAxisKey = 'x', yAxisKey = 'y'} = this._parsing;\n    const iAxisKey = iScale.axis === 'x' ? xAxisKey : yAxisKey;\n    const vAxisKey = vScale.axis === 'x' ? xAxisKey : yAxisKey;\n    const parsed = [];\n    let i, ilen, item, obj;\n    for (i = start, ilen = start + count; i < ilen; ++i) {\n      obj = data[i];\n      item = {};\n      item[iScale.axis] = iScale.parse(resolveObjectKey(obj, iAxisKey), i);\n      parsed.push(parseValue(resolveObjectKey(obj, vAxisKey), item, vScale, i));\n    }\n    return parsed;\n  }\n\n  /**\n\t * @protected\n\t */\n  updateRangeFromParsed(range, scale, parsed, stack) {\n    super.updateRangeFromParsed(range, scale, parsed, stack);\n    const custom = parsed._custom;\n    if (custom && scale === this._cachedMeta.vScale) {\n      // float bar: only one end of the bar is considered by `super`\n      range.min = Math.min(range.min, custom.min);\n      range.max = Math.max(range.max, custom.max);\n    }\n  }\n\n  /**\n\t * @return {number|boolean}\n\t * @protected\n\t */\n  getMaxOverflow() {\n    return 0;\n  }\n\n  /**\n\t * @protected\n\t */\n  getLabelAndValue(index) {\n    const meta = this._cachedMeta;\n    const {iScale, vScale} = meta;\n    const parsed = this.getParsed(index);\n    const custom = parsed._custom;\n    const value = isFloatBar(custom)\n      ? '[' + custom.start + ', ' + custom.end + ']'\n      : '' + vScale.getLabelForValue(parsed[vScale.axis]);\n\n    return {\n      label: '' + iScale.getLabelForValue(parsed[iScale.axis]),\n      value\n    };\n  }\n\n  initialize() {\n    this.enableOptionSharing = true;\n\n    super.initialize();\n\n    const meta = this._cachedMeta;\n    meta.stack = this.getDataset().stack;\n  }\n\n  update(mode) {\n    const meta = this._cachedMeta;\n    this.updateElements(meta.data, 0, meta.data.length, mode);\n  }\n\n  updateElements(bars, start, count, mode) {\n    const reset = mode === 'reset';\n    const {index, _cachedMeta: {vScale}} = this;\n    const base = vScale.getBasePixel();\n    const horizontal = vScale.isHorizontal();\n    const ruler = this._getRuler();\n    const {sharedOptions, includeOptions} = this._getSharedOptions(start, mode);\n\n    for (let i = start; i < start + count; i++) {\n      const parsed = this.getParsed(i);\n      const vpixels = reset || isNullOrUndef(parsed[vScale.axis]) ? {base, head: base} : this._calculateBarValuePixels(i);\n      const ipixels = this._calculateBarIndexPixels(i, ruler);\n      const stack = (parsed._stacks || {})[vScale.axis];\n\n      const properties = {\n        horizontal,\n        base: vpixels.base,\n        enableBorderRadius: !stack || isFloatBar(parsed._custom) || (index === stack._top || index === stack._bottom),\n        x: horizontal ? vpixels.head : ipixels.center,\n        y: horizontal ? ipixels.center : vpixels.head,\n        height: horizontal ? ipixels.size : Math.abs(vpixels.size),\n        width: horizontal ? Math.abs(vpixels.size) : ipixels.size\n      };\n\n      if (includeOptions) {\n        properties.options = sharedOptions || this.resolveDataElementOptions(i, bars[i].active ? 'active' : mode);\n      }\n      const options = properties.options || bars[i].options;\n      setBorderSkipped(properties, options, stack, index);\n      setInflateAmount(properties, options, ruler.ratio);\n      this.updateElement(bars[i], i, properties, mode);\n    }\n  }\n\n  /**\n\t * Returns the stacks based on groups and bar visibility.\n\t * @param {number} [last] - The dataset index\n\t * @param {number} [dataIndex] - The data index of the ruler\n\t * @returns {string[]} The list of stack IDs\n\t * @private\n\t */\n  _getStacks(last, dataIndex) {\n    const {iScale} = this._cachedMeta;\n    const metasets = iScale.getMatchingVisibleMetas(this._type)\n      .filter(meta => meta.controller.options.grouped);\n    const stacked = iScale.options.stacked;\n    const stacks = [];\n\n    const skipNull = (meta) => {\n      const parsed = meta.controller.getParsed(dataIndex);\n      const val = parsed && parsed[meta.vScale.axis];\n\n      if (isNullOrUndef(val) || isNaN(val)) {\n        return true;\n      }\n    };\n\n    for (const meta of metasets) {\n      if (dataIndex !== undefined && skipNull(meta)) {\n        continue;\n      }\n\n      // stacked   | meta.stack\n      //           | found | not found | undefined\n      // false     |   x   |     x     |     x\n      // true      |       |     x     |\n      // undefined |       |     x     |     x\n      if (stacked === false || stacks.indexOf(meta.stack) === -1 ||\n\t\t\t\t(stacked === undefined && meta.stack === undefined)) {\n        stacks.push(meta.stack);\n      }\n      if (meta.index === last) {\n        break;\n      }\n    }\n\n    // No stacks? that means there is no visible data. Let's still initialize an `undefined`\n    // stack where possible invisible bars will be located.\n    // https://github.com/chartjs/Chart.js/issues/6368\n    if (!stacks.length) {\n      stacks.push(undefined);\n    }\n\n    return stacks;\n  }\n\n  /**\n\t * Returns the effective number of stacks based on groups and bar visibility.\n\t * @private\n\t */\n  _getStackCount(index) {\n    return this._getStacks(undefined, index).length;\n  }\n\n  /**\n\t * Returns the stack index for the given dataset based on groups and bar visibility.\n\t * @param {number} [datasetIndex] - The dataset index\n\t * @param {string} [name] - The stack name to find\n   * @param {number} [dataIndex]\n\t * @returns {number} The stack index\n\t * @private\n\t */\n  _getStackIndex(datasetIndex, name, dataIndex) {\n    const stacks = this._getStacks(datasetIndex, dataIndex);\n    const index = (name !== undefined)\n      ? stacks.indexOf(name)\n      : -1; // indexOf returns -1 if element is not present\n\n    return (index === -1)\n      ? stacks.length - 1\n      : index;\n  }\n\n  /**\n\t * @private\n\t */\n  _getRuler() {\n    const opts = this.options;\n    const meta = this._cachedMeta;\n    const iScale = meta.iScale;\n    const pixels = [];\n    let i, ilen;\n\n    for (i = 0, ilen = meta.data.length; i < ilen; ++i) {\n      pixels.push(iScale.getPixelForValue(this.getParsed(i)[iScale.axis], i));\n    }\n\n    const barThickness = opts.barThickness;\n    const min = barThickness || computeMinSampleSize(meta);\n\n    return {\n      min,\n      pixels,\n      start: iScale._startPixel,\n      end: iScale._endPixel,\n      stackCount: this._getStackCount(),\n      scale: iScale,\n      grouped: opts.grouped,\n      // bar thickness ratio used for non-grouped bars\n      ratio: barThickness ? 1 : opts.categoryPercentage * opts.barPercentage\n    };\n  }\n\n  /**\n\t * Note: pixel values are not clamped to the scale area.\n\t * @private\n\t */\n  _calculateBarValuePixels(index) {\n    const {_cachedMeta: {vScale, _stacked}, options: {base: baseValue, minBarLength}} = this;\n    const actualBase = baseValue || 0;\n    const parsed = this.getParsed(index);\n    const custom = parsed._custom;\n    const floating = isFloatBar(custom);\n    let value = parsed[vScale.axis];\n    let start = 0;\n    let length = _stacked ? this.applyStack(vScale, parsed, _stacked) : value;\n    let head, size;\n\n    if (length !== value) {\n      start = length - value;\n      length = value;\n    }\n\n    if (floating) {\n      value = custom.barStart;\n      length = custom.barEnd - custom.barStart;\n      // bars crossing origin are not stacked\n      if (value !== 0 && sign(value) !== sign(custom.barEnd)) {\n        start = 0;\n      }\n      start += value;\n    }\n\n    const startValue = !isNullOrUndef(baseValue) && !floating ? baseValue : start;\n    let base = vScale.getPixelForValue(startValue);\n\n    if (this.chart.getDataVisibility(index)) {\n      head = vScale.getPixelForValue(start + length);\n    } else {\n      // When not visible, no height\n      head = base;\n    }\n\n    size = head - base;\n\n    if (Math.abs(size) < minBarLength) {\n      size = barSign(size, vScale, actualBase) * minBarLength;\n      if (value === actualBase) {\n        base -= size / 2;\n      }\n      const startPixel = vScale.getPixelForDecimal(0);\n      const endPixel = vScale.getPixelForDecimal(1);\n      const min = Math.min(startPixel, endPixel);\n      const max = Math.max(startPixel, endPixel);\n      base = Math.max(Math.min(base, max), min);\n      head = base + size;\n    }\n\n    if (base === vScale.getPixelForValue(actualBase)) {\n      const halfGrid = sign(size) * vScale.getLineWidthForValue(actualBase) / 2;\n      base += halfGrid;\n      size -= halfGrid;\n    }\n\n    return {\n      size,\n      base,\n      head,\n      center: head + size / 2\n    };\n  }\n\n  /**\n\t * @private\n\t */\n  _calculateBarIndexPixels(index, ruler) {\n    const scale = ruler.scale;\n    const options = this.options;\n    const skipNull = options.skipNull;\n    const maxBarThickness = valueOrDefault(options.maxBarThickness, Infinity);\n    let center, size;\n    if (ruler.grouped) {\n      const stackCount = skipNull ? this._getStackCount(index) : ruler.stackCount;\n      const range = options.barThickness === 'flex'\n        ? computeFlexCategoryTraits(index, ruler, options, stackCount)\n        : computeFitCategoryTraits(index, ruler, options, stackCount);\n\n      const stackIndex = this._getStackIndex(this.index, this._cachedMeta.stack, skipNull ? index : undefined);\n      center = range.start + (range.chunk * stackIndex) + (range.chunk / 2);\n      size = Math.min(maxBarThickness, range.chunk * range.ratio);\n    } else {\n      // For non-grouped bar charts, exact pixel values are used\n      center = scale.getPixelForValue(this.getParsed(index)[scale.axis], index);\n      size = Math.min(maxBarThickness, ruler.min * ruler.ratio);\n    }\n\n    return {\n      base: center - size / 2,\n      head: center + size / 2,\n      center,\n      size\n    };\n  }\n\n  draw() {\n    const meta = this._cachedMeta;\n    const vScale = meta.vScale;\n    const rects = meta.data;\n    const ilen = rects.length;\n    let i = 0;\n\n    for (; i < ilen; ++i) {\n      if (this.getParsed(i)[vScale.axis] !== null) {\n        rects[i].draw(this._ctx);\n      }\n    }\n  }\n\n}\n","import DatasetController from '../core/core.datasetController';\nimport {valueOrDefault} from '../helpers/helpers.core';\n\nexport default class BubbleController extends DatasetController {\n\n  static id = 'bubble';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    datasetElementType: false,\n    dataElementType: 'point',\n\n    animations: {\n      numbers: {\n        type: 'number',\n        properties: ['x', 'y', 'borderWidth', 'radius']\n      }\n    }\n  };\n\n  /**\n   * @type {any}\n   */\n  static overrides = {\n    scales: {\n      x: {\n        type: 'linear'\n      },\n      y: {\n        type: 'linear'\n      }\n    }\n  };\n\n  initialize() {\n    this.enableOptionSharing = true;\n    super.initialize();\n  }\n\n  /**\n\t * Parse array of primitive values\n\t * @protected\n\t */\n  parsePrimitiveData(meta, data, start, count) {\n    const parsed = super.parsePrimitiveData(meta, data, start, count);\n    for (let i = 0; i < parsed.length; i++) {\n      parsed[i]._custom = this.resolveDataElementOptions(i + start).radius;\n    }\n    return parsed;\n  }\n\n  /**\n\t * Parse array of arrays\n\t * @protected\n\t */\n  parseArrayData(meta, data, start, count) {\n    const parsed = super.parseArrayData(meta, data, start, count);\n    for (let i = 0; i < parsed.length; i++) {\n      const item = data[start + i];\n      parsed[i]._custom = valueOrDefault(item[2], this.resolveDataElementOptions(i + start).radius);\n    }\n    return parsed;\n  }\n\n  /**\n\t * Parse array of objects\n\t * @protected\n\t */\n  parseObjectData(meta, data, start, count) {\n    const parsed = super.parseObjectData(meta, data, start, count);\n    for (let i = 0; i < parsed.length; i++) {\n      const item = data[start + i];\n      parsed[i]._custom = valueOrDefault(item && item.r && +item.r, this.resolveDataElementOptions(i + start).radius);\n    }\n    return parsed;\n  }\n\n  /**\n\t * @protected\n\t */\n  getMaxOverflow() {\n    const data = this._cachedMeta.data;\n\n    let max = 0;\n    for (let i = data.length - 1; i >= 0; --i) {\n      max = Math.max(max, data[i].size(this.resolveDataElementOptions(i)) / 2);\n    }\n    return max > 0 && max;\n  }\n\n  /**\n\t * @protected\n\t */\n  getLabelAndValue(index) {\n    const meta = this._cachedMeta;\n    const labels = this.chart.data.labels || [];\n    const {xScale, yScale} = meta;\n    const parsed = this.getParsed(index);\n    const x = xScale.getLabelForValue(parsed.x);\n    const y = yScale.getLabelForValue(parsed.y);\n    const r = parsed._custom;\n\n    return {\n      label: labels[index] || '',\n      value: '(' + x + ', ' + y + (r ? ', ' + r : '') + ')'\n    };\n  }\n\n  update(mode) {\n    const points = this._cachedMeta.data;\n\n    // Update Points\n    this.updateElements(points, 0, points.length, mode);\n  }\n\n  updateElements(points, start, count, mode) {\n    const reset = mode === 'reset';\n    const {iScale, vScale} = this._cachedMeta;\n    const {sharedOptions, includeOptions} = this._getSharedOptions(start, mode);\n    const iAxis = iScale.axis;\n    const vAxis = vScale.axis;\n\n    for (let i = start; i < start + count; i++) {\n      const point = points[i];\n      const parsed = !reset && this.getParsed(i);\n      const properties = {};\n      const iPixel = properties[iAxis] = reset ? iScale.getPixelForDecimal(0.5) : iScale.getPixelForValue(parsed[iAxis]);\n      const vPixel = properties[vAxis] = reset ? vScale.getBasePixel() : vScale.getPixelForValue(parsed[vAxis]);\n\n      properties.skip = isNaN(iPixel) || isNaN(vPixel);\n\n      if (includeOptions) {\n        properties.options = sharedOptions || this.resolveDataElementOptions(i, point.active ? 'active' : mode);\n\n        if (reset) {\n          properties.options.radius = 0;\n        }\n      }\n\n      this.updateElement(point, i, properties, mode);\n    }\n  }\n\n  /**\n\t * @param {number} index\n\t * @param {string} [mode]\n\t * @protected\n\t */\n  resolveDataElementOptions(index, mode) {\n    const parsed = this.getParsed(index);\n    let values = super.resolveDataElementOptions(index, mode);\n\n    // In case values were cached (and thus frozen), we need to clone the values\n    if (values.$shared) {\n      values = Object.assign({}, values, {$shared: false});\n    }\n\n    // Custom radius resolution\n    const radius = values.radius;\n    if (mode !== 'active') {\n      values.radius = 0;\n    }\n    values.radius += valueOrDefault(parsed && parsed._custom, radius);\n\n    return values;\n  }\n}\n","import DatasetController from '../core/core.datasetController';\nimport {isObject, resolveObjectKey, toPercentage, toDimension, valueOrDefault} from '../helpers/helpers.core';\nimport {formatNumber} from '../helpers/helpers.intl';\nimport {toRadians, PI, TAU, HALF_PI, _angleBetween} from '../helpers/helpers.math';\n\n/**\n * @typedef { import(\"../core/core.controller\").default } Chart\n */\n\nfunction getRatioAndOffset(rotation, circumference, cutout) {\n  let ratioX = 1;\n  let ratioY = 1;\n  let offsetX = 0;\n  let offsetY = 0;\n  // If the chart's circumference isn't a full circle, calculate size as a ratio of the width/height of the arc\n  if (circumference < TAU) {\n    const startAngle = rotation;\n    const endAngle = startAngle + circumference;\n    const startX = Math.cos(startAngle);\n    const startY = Math.sin(startAngle);\n    const endX = Math.cos(endAngle);\n    const endY = Math.sin(endAngle);\n    const calcMax = (angle, a, b) => _angleBetween(angle, startAngle, endAngle, true) ? 1 : Math.max(a, a * cutout, b, b * cutout);\n    const calcMin = (angle, a, b) => _angleBetween(angle, startAngle, endAngle, true) ? -1 : Math.min(a, a * cutout, b, b * cutout);\n    const maxX = calcMax(0, startX, endX);\n    const maxY = calcMax(HALF_PI, startY, endY);\n    const minX = calcMin(PI, startX, endX);\n    const minY = calcMin(PI + HALF_PI, startY, endY);\n    ratioX = (maxX - minX) / 2;\n    ratioY = (maxY - minY) / 2;\n    offsetX = -(maxX + minX) / 2;\n    offsetY = -(maxY + minY) / 2;\n  }\n  return {ratioX, ratioY, offsetX, offsetY};\n}\n\nexport default class DoughnutController extends DatasetController {\n\n  static id = 'doughnut';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    datasetElementType: false,\n    dataElementType: 'arc',\n    animation: {\n      // Boolean - Whether we animate the rotation of the Doughnut\n      animateRotate: true,\n      // Boolean - Whether we animate scaling the Doughnut from the centre\n      animateScale: false\n    },\n    animations: {\n      numbers: {\n        type: 'number',\n        properties: ['circumference', 'endAngle', 'innerRadius', 'outerRadius', 'startAngle', 'x', 'y', 'offset', 'borderWidth', 'spacing']\n      },\n    },\n    // The percentage of the chart that we cut out of the middle.\n    cutout: '50%',\n\n    // The rotation of the chart, where the first data arc begins.\n    rotation: 0,\n\n    // The total circumference of the chart.\n    circumference: 360,\n\n    // The outr radius of the chart\n    radius: '100%',\n\n    // Spacing between arcs\n    spacing: 0,\n\n    indexAxis: 'r',\n  };\n\n  static descriptors = {\n    _scriptable: (name) => name !== 'spacing',\n    _indexable: (name) => name !== 'spacing',\n  };\n\n  /**\n   * @type {any}\n   */\n  static overrides = {\n    aspectRatio: 1,\n\n    // Need to override these to give a nice default\n    plugins: {\n      legend: {\n        labels: {\n          generateLabels(chart) {\n            const data = chart.data;\n            if (data.labels.length && data.datasets.length) {\n              const {labels: {pointStyle, color}} = chart.legend.options;\n\n              return data.labels.map((label, i) => {\n                const meta = chart.getDatasetMeta(0);\n                const style = meta.controller.getStyle(i);\n\n                return {\n                  text: label,\n                  fillStyle: style.backgroundColor,\n                  strokeStyle: style.borderColor,\n                  fontColor: color,\n                  lineWidth: style.borderWidth,\n                  pointStyle: pointStyle,\n                  hidden: !chart.getDataVisibility(i),\n\n                  // Extra data used for toggling the correct item\n                  index: i\n                };\n              });\n            }\n            return [];\n          }\n        },\n\n        onClick(e, legendItem, legend) {\n          legend.chart.toggleDataVisibility(legendItem.index);\n          legend.chart.update();\n        }\n      }\n    }\n  };\n\n  constructor(chart, datasetIndex) {\n    super(chart, datasetIndex);\n\n    this.enableOptionSharing = true;\n    this.innerRadius = undefined;\n    this.outerRadius = undefined;\n    this.offsetX = undefined;\n    this.offsetY = undefined;\n  }\n\n  linkScales() {}\n\n  /**\n\t * Override data parsing, since we are not using scales\n\t */\n  parse(start, count) {\n    const data = this.getDataset().data;\n    const meta = this._cachedMeta;\n\n    if (this._parsing === false) {\n      meta._parsed = data;\n    } else {\n      let getter = (i) => +data[i];\n\n      if (isObject(data[start])) {\n        const {key = 'value'} = this._parsing;\n        getter = (i) => +resolveObjectKey(data[i], key);\n      }\n\n      let i, ilen;\n      for (i = start, ilen = start + count; i < ilen; ++i) {\n        meta._parsed[i] = getter(i);\n      }\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _getRotation() {\n    return toRadians(this.options.rotation - 90);\n  }\n\n  /**\n\t * @private\n\t */\n  _getCircumference() {\n    return toRadians(this.options.circumference);\n  }\n\n  /**\n\t * Get the maximal rotation & circumference extents\n\t * across all visible datasets.\n\t */\n  _getRotationExtents() {\n    let min = TAU;\n    let max = -TAU;\n\n    for (let i = 0; i < this.chart.data.datasets.length; ++i) {\n      if (this.chart.isDatasetVisible(i) && this.chart.getDatasetMeta(i).type === this._type) {\n        const controller = this.chart.getDatasetMeta(i).controller;\n        const rotation = controller._getRotation();\n        const circumference = controller._getCircumference();\n\n        min = Math.min(min, rotation);\n        max = Math.max(max, rotation + circumference);\n      }\n    }\n\n    return {\n      rotation: min,\n      circumference: max - min,\n    };\n  }\n\n  /**\n\t * @param {string} mode\n\t */\n  update(mode) {\n    const chart = this.chart;\n    const {chartArea} = chart;\n    const meta = this._cachedMeta;\n    const arcs = meta.data;\n    const spacing = this.getMaxBorderWidth() + this.getMaxOffset(arcs) + this.options.spacing;\n    const maxSize = Math.max((Math.min(chartArea.width, chartArea.height) - spacing) / 2, 0);\n    const cutout = Math.min(toPercentage(this.options.cutout, maxSize), 1);\n    const chartWeight = this._getRingWeight(this.index);\n\n    // Compute the maximal rotation & circumference limits.\n    // If we only consider our dataset, this can cause problems when two datasets\n    // are both less than a circle with different rotations (starting angles)\n    const {circumference, rotation} = this._getRotationExtents();\n    const {ratioX, ratioY, offsetX, offsetY} = getRatioAndOffset(rotation, circumference, cutout);\n    const maxWidth = (chartArea.width - spacing) / ratioX;\n    const maxHeight = (chartArea.height - spacing) / ratioY;\n    const maxRadius = Math.max(Math.min(maxWidth, maxHeight) / 2, 0);\n    const outerRadius = toDimension(this.options.radius, maxRadius);\n    const innerRadius = Math.max(outerRadius * cutout, 0);\n    const radiusLength = (outerRadius - innerRadius) / this._getVisibleDatasetWeightTotal();\n    this.offsetX = offsetX * outerRadius;\n    this.offsetY = offsetY * outerRadius;\n\n    meta.total = this.calculateTotal();\n\n    this.outerRadius = outerRadius - radiusLength * this._getRingWeightOffset(this.index);\n    this.innerRadius = Math.max(this.outerRadius - radiusLength * chartWeight, 0);\n\n    this.updateElements(arcs, 0, arcs.length, mode);\n  }\n\n  /**\n   * @private\n   */\n  _circumference(i, reset) {\n    const opts = this.options;\n    const meta = this._cachedMeta;\n    const circumference = this._getCircumference();\n    if ((reset && opts.animation.animateRotate) || !this.chart.getDataVisibility(i) || meta._parsed[i] === null || meta.data[i].hidden) {\n      return 0;\n    }\n    return this.calculateCircumference(meta._parsed[i] * circumference / TAU);\n  }\n\n  updateElements(arcs, start, count, mode) {\n    const reset = mode === 'reset';\n    const chart = this.chart;\n    const chartArea = chart.chartArea;\n    const opts = chart.options;\n    const animationOpts = opts.animation;\n    const centerX = (chartArea.left + chartArea.right) / 2;\n    const centerY = (chartArea.top + chartArea.bottom) / 2;\n    const animateScale = reset && animationOpts.animateScale;\n    const innerRadius = animateScale ? 0 : this.innerRadius;\n    const outerRadius = animateScale ? 0 : this.outerRadius;\n    const {sharedOptions, includeOptions} = this._getSharedOptions(start, mode);\n    let startAngle = this._getRotation();\n    let i;\n\n    for (i = 0; i < start; ++i) {\n      startAngle += this._circumference(i, reset);\n    }\n\n    for (i = start; i < start + count; ++i) {\n      const circumference = this._circumference(i, reset);\n      const arc = arcs[i];\n      const properties = {\n        x: centerX + this.offsetX,\n        y: centerY + this.offsetY,\n        startAngle,\n        endAngle: startAngle + circumference,\n        circumference,\n        outerRadius,\n        innerRadius\n      };\n      if (includeOptions) {\n        properties.options = sharedOptions || this.resolveDataElementOptions(i, arc.active ? 'active' : mode);\n      }\n      startAngle += circumference;\n\n      this.updateElement(arc, i, properties, mode);\n    }\n  }\n\n  calculateTotal() {\n    const meta = this._cachedMeta;\n    const metaData = meta.data;\n    let total = 0;\n    let i;\n\n    for (i = 0; i < metaData.length; i++) {\n      const value = meta._parsed[i];\n      if (value !== null && !isNaN(value) && this.chart.getDataVisibility(i) && !metaData[i].hidden) {\n        total += Math.abs(value);\n      }\n    }\n\n    return total;\n  }\n\n  calculateCircumference(value) {\n    const total = this._cachedMeta.total;\n    if (total > 0 && !isNaN(value)) {\n      return TAU * (Math.abs(value) / total);\n    }\n    return 0;\n  }\n\n  getLabelAndValue(index) {\n    const meta = this._cachedMeta;\n    const chart = this.chart;\n    const labels = chart.data.labels || [];\n    const value = formatNumber(meta._parsed[index], chart.options.locale);\n\n    return {\n      label: labels[index] || '',\n      value,\n    };\n  }\n\n  getMaxBorderWidth(arcs) {\n    let max = 0;\n    const chart = this.chart;\n    let i, ilen, meta, controller, options;\n\n    if (!arcs) {\n      // Find the outmost visible dataset\n      for (i = 0, ilen = chart.data.datasets.length; i < ilen; ++i) {\n        if (chart.isDatasetVisible(i)) {\n          meta = chart.getDatasetMeta(i);\n          arcs = meta.data;\n          controller = meta.controller;\n          break;\n        }\n      }\n    }\n\n    if (!arcs) {\n      return 0;\n    }\n\n    for (i = 0, ilen = arcs.length; i < ilen; ++i) {\n      options = controller.resolveDataElementOptions(i);\n      if (options.borderAlign !== 'inner') {\n        max = Math.max(max, options.borderWidth || 0, options.hoverBorderWidth || 0);\n      }\n    }\n    return max;\n  }\n\n  getMaxOffset(arcs) {\n    let max = 0;\n\n    for (let i = 0, ilen = arcs.length; i < ilen; ++i) {\n      const options = this.resolveDataElementOptions(i);\n      max = Math.max(max, options.offset || 0, options.hoverOffset || 0);\n    }\n    return max;\n  }\n\n  /**\n\t * Get radius length offset of the dataset in relation to the visible datasets weights. This allows determining the inner and outer radius correctly\n\t * @private\n\t */\n  _getRingWeightOffset(datasetIndex) {\n    let ringWeightOffset = 0;\n\n    for (let i = 0; i < datasetIndex; ++i) {\n      if (this.chart.isDatasetVisible(i)) {\n        ringWeightOffset += this._getRingWeight(i);\n      }\n    }\n\n    return ringWeightOffset;\n  }\n\n  /**\n\t * @private\n\t */\n  _getRingWeight(datasetIndex) {\n    return Math.max(valueOrDefault(this.chart.data.datasets[datasetIndex].weight, 1), 0);\n  }\n\n  /**\n\t * Returns the sum of all visible data set weights.\n\t * @private\n\t */\n  _getVisibleDatasetWeightTotal() {\n    return this._getRingWeightOffset(this.chart.data.datasets.length) || 1;\n  }\n}\n","import DatasetController from '../core/core.datasetController';\nimport {isNullOrUndef} from '../helpers';\nimport {isNumber} from '../helpers/helpers.math';\nimport {_getStartAndCountOfVisiblePoints, _scaleRangesChanged} from '../helpers/helpers.extras';\n\nexport default class LineController extends DatasetController {\n\n  static id = 'line';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    datasetElementType: 'line',\n    dataElementType: 'point',\n\n    showLine: true,\n    spanGaps: false,\n  };\n\n  /**\n   * @type {any}\n   */\n  static overrides = {\n    scales: {\n      _index_: {\n        type: 'category',\n      },\n      _value_: {\n        type: 'linear',\n      },\n    }\n  };\n\n  initialize() {\n    this.enableOptionSharing = true;\n    this.supportsDecimation = true;\n    super.initialize();\n  }\n\n  update(mode) {\n    const meta = this._cachedMeta;\n    const {dataset: line, data: points = [], _dataset} = meta;\n    // @ts-ignore\n    const animationsDisabled = this.chart._animationsDisabled;\n    let {start, count} = _getStartAndCountOfVisiblePoints(meta, points, animationsDisabled);\n\n    this._drawStart = start;\n    this._drawCount = count;\n\n    if (_scaleRangesChanged(meta)) {\n      start = 0;\n      count = points.length;\n    }\n\n    // Update Line\n    line._chart = this.chart;\n    line._datasetIndex = this.index;\n    line._decimated = !!_dataset._decimated;\n    line.points = points;\n\n    const options = this.resolveDatasetElementOptions(mode);\n    if (!this.options.showLine) {\n      options.borderWidth = 0;\n    }\n    options.segment = this.options.segment;\n    this.updateElement(line, undefined, {\n      animated: !animationsDisabled,\n      options\n    }, mode);\n\n    // Update Points\n    this.updateElements(points, start, count, mode);\n  }\n\n  updateElements(points, start, count, mode) {\n    const reset = mode === 'reset';\n    const {iScale, vScale, _stacked, _dataset} = this._cachedMeta;\n    const {sharedOptions, includeOptions} = this._getSharedOptions(start, mode);\n    const iAxis = iScale.axis;\n    const vAxis = vScale.axis;\n    const {spanGaps, segment} = this.options;\n    const maxGapLength = isNumber(spanGaps) ? spanGaps : Number.POSITIVE_INFINITY;\n    const directUpdate = this.chart._animationsDisabled || reset || mode === 'none';\n    const end = start + count;\n    const pointsCount = points.length;\n    let prevParsed = start > 0 && this.getParsed(start - 1);\n\n    for (let i = 0; i < pointsCount; ++i) {\n      const point = points[i];\n      const properties = directUpdate ? point : {};\n\n      if (i < start || i >= end) {\n        properties.skip = true;\n        continue;\n      }\n\n      const parsed = this.getParsed(i);\n      const nullData = isNullOrUndef(parsed[vAxis]);\n      const iPixel = properties[iAxis] = iScale.getPixelForValue(parsed[iAxis], i);\n      const vPixel = properties[vAxis] = reset || nullData ? vScale.getBasePixel() : vScale.getPixelForValue(_stacked ? this.applyStack(vScale, parsed, _stacked) : parsed[vAxis], i);\n\n      properties.skip = isNaN(iPixel) || isNaN(vPixel) || nullData;\n      properties.stop = i > 0 && (Math.abs(parsed[iAxis] - prevParsed[iAxis])) > maxGapLength;\n      if (segment) {\n        properties.parsed = parsed;\n        properties.raw = _dataset.data[i];\n      }\n\n      if (includeOptions) {\n        properties.options = sharedOptions || this.resolveDataElementOptions(i, point.active ? 'active' : mode);\n      }\n\n      if (!directUpdate) {\n        this.updateElement(point, i, properties, mode);\n      }\n\n      prevParsed = parsed;\n    }\n  }\n\n  /**\n\t * @protected\n\t */\n  getMaxOverflow() {\n    const meta = this._cachedMeta;\n    const dataset = meta.dataset;\n    const border = dataset.options && dataset.options.borderWidth || 0;\n    const data = meta.data || [];\n    if (!data.length) {\n      return border;\n    }\n    const firstPoint = data[0].size(this.resolveDataElementOptions(0));\n    const lastPoint = data[data.length - 1].size(this.resolveDataElementOptions(data.length - 1));\n    return Math.max(border, firstPoint, lastPoint) / 2;\n  }\n\n  draw() {\n    const meta = this._cachedMeta;\n    meta.dataset.updateControlPoints(this.chart.chartArea, meta.iScale.axis);\n    super.draw();\n  }\n}\n","import DatasetController from '../core/core.datasetController';\nimport {toRadians, PI, formatNumber, _parseObjectDataRadialScale} from '../helpers/index';\n\nexport default class PolarAreaController extends DatasetController {\n\n  static id = 'polarArea';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    dataElementType: 'arc',\n    animation: {\n      animateRotate: true,\n      animateScale: true\n    },\n    animations: {\n      numbers: {\n        type: 'number',\n        properties: ['x', 'y', 'startAngle', 'endAngle', 'innerRadius', 'outerRadius']\n      },\n    },\n    indexAxis: 'r',\n    startAngle: 0,\n  };\n\n  /**\n   * @type {any}\n   */\n  static overrides = {\n    aspectRatio: 1,\n\n    plugins: {\n      legend: {\n        labels: {\n          generateLabels(chart) {\n            const data = chart.data;\n            if (data.labels.length && data.datasets.length) {\n              const {labels: {pointStyle, color}} = chart.legend.options;\n\n              return data.labels.map((label, i) => {\n                const meta = chart.getDatasetMeta(0);\n                const style = meta.controller.getStyle(i);\n\n                return {\n                  text: label,\n                  fillStyle: style.backgroundColor,\n                  strokeStyle: style.borderColor,\n                  fontColor: color,\n                  lineWidth: style.borderWidth,\n                  pointStyle: pointStyle,\n                  hidden: !chart.getDataVisibility(i),\n\n                  // Extra data used for toggling the correct item\n                  index: i\n                };\n              });\n            }\n            return [];\n          }\n        },\n\n        onClick(e, legendItem, legend) {\n          legend.chart.toggleDataVisibility(legendItem.index);\n          legend.chart.update();\n        }\n      }\n    },\n\n    scales: {\n      r: {\n        type: 'radialLinear',\n        angleLines: {\n          display: false\n        },\n        beginAtZero: true,\n        grid: {\n          circular: true\n        },\n        pointLabels: {\n          display: false\n        },\n        startAngle: 0\n      }\n    }\n  };\n\n  constructor(chart, datasetIndex) {\n    super(chart, datasetIndex);\n\n    this.innerRadius = undefined;\n    this.outerRadius = undefined;\n  }\n\n  getLabelAndValue(index) {\n    const meta = this._cachedMeta;\n    const chart = this.chart;\n    const labels = chart.data.labels || [];\n    const value = formatNumber(meta._parsed[index].r, chart.options.locale);\n\n    return {\n      label: labels[index] || '',\n      value,\n    };\n  }\n\n  parseObjectData(meta, data, start, count) {\n    return _parseObjectDataRadialScale.bind(this)(meta, data, start, count);\n  }\n\n  update(mode) {\n    const arcs = this._cachedMeta.data;\n\n    this._updateRadius();\n    this.updateElements(arcs, 0, arcs.length, mode);\n  }\n\n  /**\n   * @protected\n   */\n  getMinMax() {\n    const meta = this._cachedMeta;\n    const range = {min: Number.POSITIVE_INFINITY, max: Number.NEGATIVE_INFINITY};\n\n    meta.data.forEach((element, index) => {\n      const parsed = this.getParsed(index).r;\n\n      if (!isNaN(parsed) && this.chart.getDataVisibility(index)) {\n        if (parsed < range.min) {\n          range.min = parsed;\n        }\n\n        if (parsed > range.max) {\n          range.max = parsed;\n        }\n      }\n    });\n\n    return range;\n  }\n\n  /**\n\t * @private\n\t */\n  _updateRadius() {\n    const chart = this.chart;\n    const chartArea = chart.chartArea;\n    const opts = chart.options;\n    const minSize = Math.min(chartArea.right - chartArea.left, chartArea.bottom - chartArea.top);\n\n    const outerRadius = Math.max(minSize / 2, 0);\n    const innerRadius = Math.max(opts.cutoutPercentage ? (outerRadius / 100) * (opts.cutoutPercentage) : 1, 0);\n    const radiusLength = (outerRadius - innerRadius) / chart.getVisibleDatasetCount();\n\n    this.outerRadius = outerRadius - (radiusLength * this.index);\n    this.innerRadius = this.outerRadius - radiusLength;\n  }\n\n  updateElements(arcs, start, count, mode) {\n    const reset = mode === 'reset';\n    const chart = this.chart;\n    const opts = chart.options;\n    const animationOpts = opts.animation;\n    const scale = this._cachedMeta.rScale;\n    const centerX = scale.xCenter;\n    const centerY = scale.yCenter;\n    const datasetStartAngle = scale.getIndexAngle(0) - 0.5 * PI;\n    let angle = datasetStartAngle;\n    let i;\n\n    const defaultAngle = 360 / this.countVisibleElements();\n\n    for (i = 0; i < start; ++i) {\n      angle += this._computeAngle(i, mode, defaultAngle);\n    }\n    for (i = start; i < start + count; i++) {\n      const arc = arcs[i];\n      let startAngle = angle;\n      let endAngle = angle + this._computeAngle(i, mode, defaultAngle);\n      let outerRadius = chart.getDataVisibility(i) ? scale.getDistanceFromCenterForValue(this.getParsed(i).r) : 0;\n      angle = endAngle;\n\n      if (reset) {\n        if (animationOpts.animateScale) {\n          outerRadius = 0;\n        }\n        if (animationOpts.animateRotate) {\n          startAngle = endAngle = datasetStartAngle;\n        }\n      }\n\n      const properties = {\n        x: centerX,\n        y: centerY,\n        innerRadius: 0,\n        outerRadius,\n        startAngle,\n        endAngle,\n        options: this.resolveDataElementOptions(i, arc.active ? 'active' : mode)\n      };\n\n      this.updateElement(arc, i, properties, mode);\n    }\n  }\n\n  countVisibleElements() {\n    const meta = this._cachedMeta;\n    let count = 0;\n\n    meta.data.forEach((element, index) => {\n      if (!isNaN(this.getParsed(index).r) && this.chart.getDataVisibility(index)) {\n        count++;\n      }\n    });\n\n    return count;\n  }\n\n  /**\n\t * @private\n\t */\n  _computeAngle(index, mode, defaultAngle) {\n    return this.chart.getDataVisibility(index)\n      ? toRadians(this.resolveDataElementOptions(index, mode).angle || defaultAngle)\n      : 0;\n  }\n}\n","import DoughnutController from './controller.doughnut';\n\n// Pie charts are Doughnut chart with different defaults\nexport default class PieController extends DoughnutController {\n\n  static id = 'pie';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    // The percentage of the chart that we cut out of the middle.\n    cutout: 0,\n\n    // The rotation of the chart, where the first data arc begins.\n    rotation: 0,\n\n    // The total circumference of the chart.\n    circumference: 360,\n\n    // The outr radius of the chart\n    radius: '100%'\n  };\n}\n","import DatasetController from '../core/core.datasetController';\nimport {_parseObjectDataRadialScale} from '../helpers/index';\n\nexport default class RadarController extends DatasetController {\n\n  static id = 'radar';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    datasetElementType: 'line',\n    dataElementType: 'point',\n    indexAxis: 'r',\n    showLine: true,\n    elements: {\n      line: {\n        fill: 'start'\n      }\n    },\n  };\n\n  /**\n   * @type {any}\n   */\n  static overrides = {\n    aspectRatio: 1,\n\n    scales: {\n      r: {\n        type: 'radialLinear',\n      }\n    }\n  };\n\n  /**\n\t * @protected\n\t */\n  getLabelAndValue(index) {\n    const vScale = this._cachedMeta.vScale;\n    const parsed = this.getParsed(index);\n\n    return {\n      label: vScale.getLabels()[index],\n      value: '' + vScale.getLabelForValue(parsed[vScale.axis])\n    };\n  }\n\n  parseObjectData(meta, data, start, count) {\n    return _parseObjectDataRadialScale.bind(this)(meta, data, start, count);\n  }\n\n  update(mode) {\n    const meta = this._cachedMeta;\n    const line = meta.dataset;\n    const points = meta.data || [];\n    const labels = meta.iScale.getLabels();\n\n    // Update Line\n    line.points = points;\n    // In resize mode only point locations change, so no need to set the points or options.\n    if (mode !== 'resize') {\n      const options = this.resolveDatasetElementOptions(mode);\n      if (!this.options.showLine) {\n        options.borderWidth = 0;\n      }\n\n      const properties = {\n        _loop: true,\n        _fullLoop: labels.length === points.length,\n        options\n      };\n\n      this.updateElement(line, undefined, properties, mode);\n    }\n\n    // Update Points\n    this.updateElements(points, 0, points.length, mode);\n  }\n\n  updateElements(points, start, count, mode) {\n    const scale = this._cachedMeta.rScale;\n    const reset = mode === 'reset';\n\n    for (let i = start; i < start + count; i++) {\n      const point = points[i];\n      const options = this.resolveDataElementOptions(i, point.active ? 'active' : mode);\n      const pointPosition = scale.getPointPositionForValue(i, this.getParsed(i).r);\n\n      const x = reset ? scale.xCenter : pointPosition.x;\n      const y = reset ? scale.yCenter : pointPosition.y;\n\n      const properties = {\n        x,\n        y,\n        angle: pointPosition.angle,\n        skip: isNaN(x) || isNaN(y),\n        options\n      };\n\n      this.updateElement(point, i, properties, mode);\n    }\n  }\n}\n","import DatasetController from '../core/core.datasetController';\nimport {isNullOrUndef} from '../helpers';\nimport {isNumber} from '../helpers/helpers.math';\nimport {_getStartAndCountOfVisiblePoints, _scaleRangesChanged} from '../helpers/helpers.extras';\n\nexport default class ScatterController extends DatasetController {\n\n  static id = 'scatter';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    datasetElementType: false,\n    dataElementType: 'point',\n    showLine: false,\n    fill: false\n  };\n\n  /**\n   * @type {any}\n   */\n  static overrides = {\n\n    interaction: {\n      mode: 'point'\n    },\n\n    scales: {\n      x: {\n        type: 'linear'\n      },\n      y: {\n        type: 'linear'\n      }\n    }\n  };\n\n  /**\n\t * @protected\n\t */\n  getLabelAndValue(index) {\n    const meta = this._cachedMeta;\n    const labels = this.chart.data.labels || [];\n    const {xScale, yScale} = meta;\n    const parsed = this.getParsed(index);\n    const x = xScale.getLabelForValue(parsed.x);\n    const y = yScale.getLabelForValue(parsed.y);\n\n    return {\n      label: labels[index] || '',\n      value: '(' + x + ', ' + y + ')'\n    };\n  }\n\n  update(mode) {\n    const meta = this._cachedMeta;\n    const {data: points = []} = meta;\n    // @ts-ignore\n    const animationsDisabled = this.chart._animationsDisabled;\n    let {start, count} = _getStartAndCountOfVisiblePoints(meta, points, animationsDisabled);\n\n    this._drawStart = start;\n    this._drawCount = count;\n\n    if (_scaleRangesChanged(meta)) {\n      start = 0;\n      count = points.length;\n    }\n\n    if (this.options.showLine) {\n\n      const {dataset: line, _dataset} = meta;\n\n      // Update Line\n      line._chart = this.chart;\n      line._datasetIndex = this.index;\n      line._decimated = !!_dataset._decimated;\n      line.points = points;\n\n      const options = this.resolveDatasetElementOptions(mode);\n      options.segment = this.options.segment;\n      this.updateElement(line, undefined, {\n        animated: !animationsDisabled,\n        options\n      }, mode);\n    }\n\n    // Update Points\n    this.updateElements(points, start, count, mode);\n  }\n\n  addElements() {\n    const {showLine} = this.options;\n\n    if (!this.datasetElementType && showLine) {\n      this.datasetElementType = this.chart.registry.getElement('line');\n    }\n\n    super.addElements();\n  }\n\n  updateElements(points, start, count, mode) {\n    const reset = mode === 'reset';\n    const {iScale, vScale, _stacked, _dataset} = this._cachedMeta;\n    const firstOpts = this.resolveDataElementOptions(start, mode);\n    const sharedOptions = this.getSharedOptions(firstOpts);\n    const includeOptions = this.includeOptions(mode, sharedOptions);\n    const iAxis = iScale.axis;\n    const vAxis = vScale.axis;\n    const {spanGaps, segment} = this.options;\n    const maxGapLength = isNumber(spanGaps) ? spanGaps : Number.POSITIVE_INFINITY;\n    const directUpdate = this.chart._animationsDisabled || reset || mode === 'none';\n    let prevParsed = start > 0 && this.getParsed(start - 1);\n\n    for (let i = start; i < start + count; ++i) {\n      const point = points[i];\n      const parsed = this.getParsed(i);\n      const properties = directUpdate ? point : {};\n      const nullData = isNullOrUndef(parsed[vAxis]);\n      const iPixel = properties[iAxis] = iScale.getPixelForValue(parsed[iAxis], i);\n      const vPixel = properties[vAxis] = reset || nullData ? vScale.getBasePixel() : vScale.getPixelForValue(_stacked ? this.applyStack(vScale, parsed, _stacked) : parsed[vAxis], i);\n\n      properties.skip = isNaN(iPixel) || isNaN(vPixel) || nullData;\n      properties.stop = i > 0 && (Math.abs(parsed[iAxis] - prevParsed[iAxis])) > maxGapLength;\n      if (segment) {\n        properties.parsed = parsed;\n        properties.raw = _dataset.data[i];\n      }\n\n      if (includeOptions) {\n        properties.options = sharedOptions || this.resolveDataElementOptions(i, point.active ? 'active' : mode);\n      }\n\n      if (!directUpdate) {\n        this.updateElement(point, i, properties, mode);\n      }\n\n      prevParsed = parsed;\n    }\n\n    this.updateSharedOptions(sharedOptions, mode, firstOpts);\n  }\n\n  /**\n\t * @protected\n\t */\n  getMaxOverflow() {\n    const meta = this._cachedMeta;\n    const data = meta.data || [];\n\n    if (!this.options.showLine) {\n      let max = 0;\n      for (let i = data.length - 1; i >= 0; --i) {\n        max = Math.max(max, data[i].size(this.resolveDataElementOptions(i)) / 2);\n      }\n      return max > 0 && max;\n    }\n\n    const dataset = meta.dataset;\n    const border = dataset.options && dataset.options.borderWidth || 0;\n\n    if (!data.length) {\n      return border;\n    }\n\n    const firstPoint = data[0].size(this.resolveDataElementOptions(0));\n    const lastPoint = data[data.length - 1].size(this.resolveDataElementOptions(data.length - 1));\n    return Math.max(border, firstPoint, lastPoint) / 2;\n  }\n}\n","/**\n * @namespace Chart._adapters\n * @since 2.8.0\n * @private\n */\n\nimport type {AnyObject} from '../../types/basic';\nimport type {ChartOptions} from '../../types';\n\nexport type TimeUnit = 'millisecond' | 'second' | 'minute' | 'hour' | 'day' | 'week' | 'month' | 'quarter' | 'year';\n\nexport interface DateAdapter<T extends AnyObject = AnyObject> {\n  readonly options: T;\n  /**\n   * Will called with chart options after adapter creation.\n   */\n  init(this: DateAdapter<T>, chartOptions: ChartOptions): void;\n  /**\n   * Returns a map of time formats for the supported formatting units defined\n   * in Unit as well as 'datetime' representing a detailed date/time string.\n   */\n  formats(this: DateAdapter<T>): Record<string, string>;\n  /**\n   * Parses the given `value` and return the associated timestamp.\n   * @param value - the value to parse (usually comes from the data)\n   * @param [format] - the expected data format\n   */\n  parse(this: DateAdapter<T>, value: unknown, format?: TimeUnit): number | null;\n  /**\n   * Returns the formatted date in the specified `format` for a given `timestamp`.\n   * @param timestamp - the timestamp to format\n   * @param format - the date/time token\n   */\n  format(this: DateAdapter<T>, timestamp: number, format: TimeUnit): string;\n  /**\n   * Adds the specified `amount` of `unit` to the given `timestamp`.\n   * @param timestamp - the input timestamp\n   * @param amount - the amount to add\n   * @param unit - the unit as string\n   */\n  add(this: DateAdapter<T>, timestamp: number, amount: number, unit: TimeUnit): number;\n  /**\n   * Returns the number of `unit` between the given timestamps.\n   * @param a - the input timestamp (reference)\n   * @param b - the timestamp to subtract\n   * @param unit - the unit as string\n   */\n  diff(this: DateAdapter<T>, a: number, b: number, unit: TimeUnit): number;\n  /**\n   * Returns start of `unit` for the given `timestamp`.\n   * @param timestamp - the input timestamp\n   * @param unit - the unit as string\n   * @param [weekday] - the ISO day of the week with 1 being Monday\n   * and 7 being Sunday (only needed if param *unit* is `isoWeek`).\n   */\n  startOf(this: DateAdapter<T>, timestamp: number, unit: TimeUnit | 'isoWeek', weekday?: number): number;\n  /**\n   * Returns end of `unit` for the given `timestamp`.\n   * @param timestamp - the input timestamp\n   * @param unit - the unit as string\n   */\n  endOf(this: DateAdapter<T>, timestamp: number, unit: TimeUnit | 'isoWeek'): number;\n}\n\nfunction abstract<T = void>(): T {\n  throw new Error('This method is not implemented: Check that a complete date adapter is provided.');\n}\n\n/**\n * Date adapter (current used by the time scale)\n * @namespace Chart._adapters._date\n * @memberof Chart._adapters\n * @private\n */\nclass DateAdapterBase implements DateAdapter {\n\n  /**\n   * Override default date adapter methods.\n   * Accepts type parameter to define options type.\n   * @example\n   * Chart._adapters._date.override<{myAdapterOption: string}>({\n   *   init() {\n   *     console.log(this.options.myAdapterOption);\n   *   }\n   * })\n   */\n  static override<T extends AnyObject = AnyObject>(\n    members: Partial<Omit<DateAdapter<T>, 'options'>>\n  ) {\n    Object.assign(DateAdapterBase.prototype, members);\n  }\n\n  readonly options: AnyObject;\n\n  constructor(options: AnyObject) {\n    this.options = options || {};\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  init() {}\n\n  formats(): Record<string, string> {\n    return abstract();\n  }\n\n  parse(): number | null {\n    return abstract();\n  }\n\n  format(): string {\n    return abstract();\n  }\n\n  add(): number {\n    return abstract();\n  }\n\n  diff(): number {\n    return abstract();\n  }\n\n  startOf(): number {\n    return abstract();\n  }\n\n  endOf(): number {\n    return abstract();\n  }\n}\n\nexport default {\n  _date: DateAdapterBase\n};\n","import {_lookupByKey, _rlookupByKey} from '../helpers/helpers.collection';\nimport {getRelativePosition} from '../helpers/helpers.dom';\nimport {_angleBetween, getAngleFromPoint} from '../helpers/helpers.math';\nimport {_isPointInArea} from '../helpers';\n\n/**\n * @typedef { import(\"./core.controller\").default } Chart\n * @typedef { import(\"../../types\").ChartEvent } ChartEvent\n * @typedef {{axis?: string, intersect?: boolean, includeInvisible?: boolean}} InteractionOptions\n * @typedef {{datasetIndex: number, index: number, element: import(\"./core.element\").default}} InteractionItem\n * @typedef { import(\"../../types\").Point } Point\n */\n\n/**\n * Helper function to do binary search when possible\n * @param {object} metaset - the dataset meta\n * @param {string} axis - the axis mode. x|y|xy|r\n * @param {number} value - the value to find\n * @param {boolean} [intersect] - should the element intersect\n * @returns {{lo:number, hi:number}} indices to search data array between\n */\nfunction binarySearch(metaset, axis, value, intersect) {\n  const {controller, data, _sorted} = metaset;\n  const iScale = controller._cachedMeta.iScale;\n  if (iScale && axis === iScale.axis && axis !== 'r' && _sorted && data.length) {\n    const lookupMethod = iScale._reversePixels ? _rlookupByKey : _lookupByKey;\n    if (!intersect) {\n      return lookupMethod(data, axis, value);\n    } else if (controller._sharedOptions) {\n      // _sharedOptions indicates that each element has equal options -> equal proportions\n      // So we can do a ranged binary search based on the range of first element and\n      // be confident to get the full range of indices that can intersect with the value.\n      const el = data[0];\n      const range = typeof el.getRange === 'function' && el.getRange(axis);\n      if (range) {\n        const start = lookupMethod(data, axis, value - range);\n        const end = lookupMethod(data, axis, value + range);\n        return {lo: start.lo, hi: end.hi};\n      }\n    }\n  }\n  // Default to all elements, when binary search can not be used.\n  return {lo: 0, hi: data.length - 1};\n}\n\n/**\n * Helper function to select candidate elements for interaction\n * @param {Chart} chart - the chart\n * @param {string} axis - the axis mode. x|y|xy|r\n * @param {Point} position - the point to be nearest to, in relative coordinates\n * @param {function} handler - the callback to execute for each visible item\n * @param {boolean} [intersect] - consider intersecting items\n */\nfunction evaluateInteractionItems(chart, axis, position, handler, intersect) {\n  const metasets = chart.getSortedVisibleDatasetMetas();\n  const value = position[axis];\n  for (let i = 0, ilen = metasets.length; i < ilen; ++i) {\n    const {index, data} = metasets[i];\n    const {lo, hi} = binarySearch(metasets[i], axis, value, intersect);\n    for (let j = lo; j <= hi; ++j) {\n      const element = data[j];\n      if (!element.skip) {\n        handler(element, index, j);\n      }\n    }\n  }\n}\n\n/**\n * Get a distance metric function for two points based on the\n * axis mode setting\n * @param {string} axis - the axis mode. x|y|xy|r\n */\nfunction getDistanceMetricForAxis(axis) {\n  const useX = axis.indexOf('x') !== -1;\n  const useY = axis.indexOf('y') !== -1;\n\n  return function(pt1, pt2) {\n    const deltaX = useX ? Math.abs(pt1.x - pt2.x) : 0;\n    const deltaY = useY ? Math.abs(pt1.y - pt2.y) : 0;\n    return Math.sqrt(Math.pow(deltaX, 2) + Math.pow(deltaY, 2));\n  };\n}\n\n/**\n * Helper function to get the items that intersect the event position\n * @param {Chart} chart - the chart\n * @param {Point} position - the point to be nearest to, in relative coordinates\n * @param {string} axis - the axis mode. x|y|xy|r\n * @param {boolean} [useFinalPosition] - use the element's animation target instead of current position\n * @param {boolean} [includeInvisible] - include invisible points that are outside of the chart area\n * @return {InteractionItem[]} the nearest items\n */\nfunction getIntersectItems(chart, position, axis, useFinalPosition, includeInvisible) {\n  const items = [];\n\n  if (!includeInvisible && !chart.isPointInArea(position)) {\n    return items;\n  }\n\n  const evaluationFunc = function(element, datasetIndex, index) {\n    if (!includeInvisible && !_isPointInArea(element, chart.chartArea, 0)) {\n      return;\n    }\n    if (element.inRange(position.x, position.y, useFinalPosition)) {\n      items.push({element, datasetIndex, index});\n    }\n  };\n\n  evaluateInteractionItems(chart, axis, position, evaluationFunc, true);\n  return items;\n}\n\n/**\n * Helper function to get the items nearest to the event position for a radial chart\n * @param {Chart} chart - the chart to look at elements from\n * @param {Point} position - the point to be nearest to, in relative coordinates\n * @param {string} axis - the axes along which to measure distance\n * @param {boolean} [useFinalPosition] - use the element's animation target instead of current position\n * @return {InteractionItem[]} the nearest items\n */\nfunction getNearestRadialItems(chart, position, axis, useFinalPosition) {\n  let items = [];\n\n  function evaluationFunc(element, datasetIndex, index) {\n    const {startAngle, endAngle} = element.getProps(['startAngle', 'endAngle'], useFinalPosition);\n    const {angle} = getAngleFromPoint(element, {x: position.x, y: position.y});\n\n    if (_angleBetween(angle, startAngle, endAngle)) {\n      items.push({element, datasetIndex, index});\n    }\n  }\n\n  evaluateInteractionItems(chart, axis, position, evaluationFunc);\n  return items;\n}\n\n/**\n * Helper function to get the items nearest to the event position for a cartesian chart\n * @param {Chart} chart - the chart to look at elements from\n * @param {Point} position - the point to be nearest to, in relative coordinates\n * @param {string} axis - the axes along which to measure distance\n * @param {boolean} [intersect] - if true, only consider items that intersect the position\n * @param {boolean} [useFinalPosition] - use the element's animation target instead of current position\n * @param {boolean} [includeInvisible] - include invisible points that are outside of the chart area\n * @return {InteractionItem[]} the nearest items\n */\nfunction getNearestCartesianItems(chart, position, axis, intersect, useFinalPosition, includeInvisible) {\n  let items = [];\n  const distanceMetric = getDistanceMetricForAxis(axis);\n  let minDistance = Number.POSITIVE_INFINITY;\n\n  function evaluationFunc(element, datasetIndex, index) {\n    const inRange = element.inRange(position.x, position.y, useFinalPosition);\n    if (intersect && !inRange) {\n      return;\n    }\n\n    const center = element.getCenterPoint(useFinalPosition);\n    const pointInArea = !!includeInvisible || chart.isPointInArea(center);\n    if (!pointInArea && !inRange) {\n      return;\n    }\n\n    const distance = distanceMetric(position, center);\n    if (distance < minDistance) {\n      items = [{element, datasetIndex, index}];\n      minDistance = distance;\n    } else if (distance === minDistance) {\n      // Can have multiple items at the same distance in which case we sort by size\n      items.push({element, datasetIndex, index});\n    }\n  }\n\n  evaluateInteractionItems(chart, axis, position, evaluationFunc);\n  return items;\n}\n\n/**\n * Helper function to get the items nearest to the event position considering all visible items in the chart\n * @param {Chart} chart - the chart to look at elements from\n * @param {Point} position - the point to be nearest to, in relative coordinates\n * @param {string} axis - the axes along which to measure distance\n * @param {boolean} [intersect] - if true, only consider items that intersect the position\n * @param {boolean} [useFinalPosition] - use the element's animation target instead of current position\n * @param {boolean} [includeInvisible] - include invisible points that are outside of the chart area\n * @return {InteractionItem[]} the nearest items\n */\nfunction getNearestItems(chart, position, axis, intersect, useFinalPosition, includeInvisible) {\n  if (!includeInvisible && !chart.isPointInArea(position)) {\n    return [];\n  }\n\n  return axis === 'r' && !intersect\n    ? getNearestRadialItems(chart, position, axis, useFinalPosition)\n    : getNearestCartesianItems(chart, position, axis, intersect, useFinalPosition, includeInvisible);\n}\n\n/**\n * Helper function to get the items matching along the given X or Y axis\n * @param {Chart} chart - the chart to look at elements from\n * @param {Point} position - the point to be nearest to, in relative coordinates\n * @param {string} axis - the axis to match\n * @param {boolean} [intersect] - if true, only consider items that intersect the position\n * @param {boolean} [useFinalPosition] - use the element's animation target instead of current position\n * @return {InteractionItem[]} the nearest items\n */\nfunction getAxisItems(chart, position, axis, intersect, useFinalPosition) {\n  const items = [];\n  const rangeMethod = axis === 'x' ? 'inXRange' : 'inYRange';\n  let intersectsItem = false;\n\n  evaluateInteractionItems(chart, axis, position, (element, datasetIndex, index) => {\n    if (element[rangeMethod](position[axis], useFinalPosition)) {\n      items.push({element, datasetIndex, index});\n      intersectsItem = intersectsItem || element.inRange(position.x, position.y, useFinalPosition);\n    }\n  });\n\n  // If we want to trigger on an intersect and we don't have any items\n  // that intersect the position, return nothing\n  if (intersect && !intersectsItem) {\n    return [];\n  }\n  return items;\n}\n\n/**\n * Contains interaction related functions\n * @namespace Chart.Interaction\n */\nexport default {\n  // Part of the public API to facilitate developers creating their own modes\n  evaluateInteractionItems,\n\n  // Helper function for different modes\n  modes: {\n    /**\n\t\t * Returns items at the same index. If the options.intersect parameter is true, we only return items if we intersect something\n\t\t * If the options.intersect mode is false, we find the nearest item and return the items at the same index as that item\n\t\t * @function Chart.Interaction.modes.index\n\t\t * @since v2.4.0\n\t\t * @param {Chart} chart - the chart we are returning items from\n\t\t * @param {Event} e - the event we are find things at\n\t\t * @param {InteractionOptions} options - options to use\n\t\t * @param {boolean} [useFinalPosition] - use final element position (animation target)\n\t\t * @return {InteractionItem[]} - items that are found\n\t\t */\n    index(chart, e, options, useFinalPosition) {\n      const position = getRelativePosition(e, chart);\n      // Default axis for index mode is 'x' to match old behaviour\n      const axis = options.axis || 'x';\n      const includeInvisible = options.includeInvisible || false;\n      const items = options.intersect\n        ? getIntersectItems(chart, position, axis, useFinalPosition, includeInvisible)\n        : getNearestItems(chart, position, axis, false, useFinalPosition, includeInvisible);\n      const elements = [];\n\n      if (!items.length) {\n        return [];\n      }\n\n      chart.getSortedVisibleDatasetMetas().forEach((meta) => {\n        const index = items[0].index;\n        const element = meta.data[index];\n\n        // don't count items that are skipped (null data)\n        if (element && !element.skip) {\n          elements.push({element, datasetIndex: meta.index, index});\n        }\n      });\n\n      return elements;\n    },\n\n    /**\n\t\t * Returns items in the same dataset. If the options.intersect parameter is true, we only return items if we intersect something\n\t\t * If the options.intersect is false, we find the nearest item and return the items in that dataset\n\t\t * @function Chart.Interaction.modes.dataset\n\t\t * @param {Chart} chart - the chart we are returning items from\n\t\t * @param {Event} e - the event we are find things at\n\t\t * @param {InteractionOptions} options - options to use\n\t\t * @param {boolean} [useFinalPosition] - use final element position (animation target)\n\t\t * @return {InteractionItem[]} - items that are found\n\t\t */\n    dataset(chart, e, options, useFinalPosition) {\n      const position = getRelativePosition(e, chart);\n      const axis = options.axis || 'xy';\n      const includeInvisible = options.includeInvisible || false;\n      let items = options.intersect\n        ? getIntersectItems(chart, position, axis, useFinalPosition, includeInvisible) :\n        getNearestItems(chart, position, axis, false, useFinalPosition, includeInvisible);\n\n      if (items.length > 0) {\n        const datasetIndex = items[0].datasetIndex;\n        const data = chart.getDatasetMeta(datasetIndex).data;\n        items = [];\n        for (let i = 0; i < data.length; ++i) {\n          items.push({element: data[i], datasetIndex, index: i});\n        }\n      }\n\n      return items;\n    },\n\n    /**\n\t\t * Point mode returns all elements that hit test based on the event position\n\t\t * of the event\n\t\t * @function Chart.Interaction.modes.intersect\n\t\t * @param {Chart} chart - the chart we are returning items from\n\t\t * @param {Event} e - the event we are find things at\n\t\t * @param {InteractionOptions} options - options to use\n\t\t * @param {boolean} [useFinalPosition] - use final element position (animation target)\n\t\t * @return {InteractionItem[]} - items that are found\n\t\t */\n    point(chart, e, options, useFinalPosition) {\n      const position = getRelativePosition(e, chart);\n      const axis = options.axis || 'xy';\n      const includeInvisible = options.includeInvisible || false;\n      return getIntersectItems(chart, position, axis, useFinalPosition, includeInvisible);\n    },\n\n    /**\n\t\t * nearest mode returns the element closest to the point\n\t\t * @function Chart.Interaction.modes.intersect\n\t\t * @param {Chart} chart - the chart we are returning items from\n\t\t * @param {Event} e - the event we are find things at\n\t\t * @param {InteractionOptions} options - options to use\n\t\t * @param {boolean} [useFinalPosition] - use final element position (animation target)\n\t\t * @return {InteractionItem[]} - items that are found\n\t\t */\n    nearest(chart, e, options, useFinalPosition) {\n      const position = getRelativePosition(e, chart);\n      const axis = options.axis || 'xy';\n      const includeInvisible = options.includeInvisible || false;\n      return getNearestItems(chart, position, axis, options.intersect, useFinalPosition, includeInvisible);\n    },\n\n    /**\n\t\t * x mode returns the elements that hit-test at the current x coordinate\n\t\t * @function Chart.Interaction.modes.x\n\t\t * @param {Chart} chart - the chart we are returning items from\n\t\t * @param {Event} e - the event we are find things at\n\t\t * @param {InteractionOptions} options - options to use\n\t\t * @param {boolean} [useFinalPosition] - use final element position (animation target)\n\t\t * @return {InteractionItem[]} - items that are found\n\t\t */\n    x(chart, e, options, useFinalPosition) {\n      const position = getRelativePosition(e, chart);\n      return getAxisItems(chart, position, 'x', options.intersect, useFinalPosition);\n    },\n\n    /**\n\t\t * y mode returns the elements that hit-test at the current y coordinate\n\t\t * @function Chart.Interaction.modes.y\n\t\t * @param {Chart} chart - the chart we are returning items from\n\t\t * @param {Event} e - the event we are find things at\n\t\t * @param {InteractionOptions} options - options to use\n\t\t * @param {boolean} [useFinalPosition] - use final element position (animation target)\n\t\t * @return {InteractionItem[]} - items that are found\n\t\t */\n    y(chart, e, options, useFinalPosition) {\n      const position = getRelativePosition(e, chart);\n      return getAxisItems(chart, position, 'y', options.intersect, useFinalPosition);\n    }\n  }\n};\n","import {defined, each, isObject} from '../helpers/helpers.core';\nimport {toPadding} from '../helpers/helpers.options';\n\n/**\n * @typedef { import(\"./core.controller\").default } Chart\n */\n\nconst STATIC_POSITIONS = ['left', 'top', 'right', 'bottom'];\n\nfunction filterByPosition(array, position) {\n  return array.filter(v => v.pos === position);\n}\n\nfunction filterDynamicPositionByAxis(array, axis) {\n  return array.filter(v => STATIC_POSITIONS.indexOf(v.pos) === -1 && v.box.axis === axis);\n}\n\nfunction sortByWeight(array, reverse) {\n  return array.sort((a, b) => {\n    const v0 = reverse ? b : a;\n    const v1 = reverse ? a : b;\n    return v0.weight === v1.weight ?\n      v0.index - v1.index :\n      v0.weight - v1.weight;\n  });\n}\n\nfunction wrapBoxes(boxes) {\n  const layoutBoxes = [];\n  let i, ilen, box, pos, stack, stackWeight;\n\n  for (i = 0, ilen = (boxes || []).length; i < ilen; ++i) {\n    box = boxes[i];\n    ({position: pos, options: {stack, stackWeight = 1}} = box);\n    layoutBoxes.push({\n      index: i,\n      box,\n      pos,\n      horizontal: box.isHorizontal(),\n      weight: box.weight,\n      stack: stack && (pos + stack),\n      stackWeight\n    });\n  }\n  return layoutBoxes;\n}\n\nfunction buildStacks(layouts) {\n  const stacks = {};\n  for (const wrap of layouts) {\n    const {stack, pos, stackWeight} = wrap;\n    if (!stack || !STATIC_POSITIONS.includes(pos)) {\n      continue;\n    }\n    const _stack = stacks[stack] || (stacks[stack] = {count: 0, placed: 0, weight: 0, size: 0});\n    _stack.count++;\n    _stack.weight += stackWeight;\n  }\n  return stacks;\n}\n\n/**\n * store dimensions used instead of available chartArea in fitBoxes\n **/\nfunction setLayoutDims(layouts, params) {\n  const stacks = buildStacks(layouts);\n  const {vBoxMaxWidth, hBoxMaxHeight} = params;\n  let i, ilen, layout;\n  for (i = 0, ilen = layouts.length; i < ilen; ++i) {\n    layout = layouts[i];\n    const {fullSize} = layout.box;\n    const stack = stacks[layout.stack];\n    const factor = stack && layout.stackWeight / stack.weight;\n    if (layout.horizontal) {\n      layout.width = factor ? factor * vBoxMaxWidth : fullSize && params.availableWidth;\n      layout.height = hBoxMaxHeight;\n    } else {\n      layout.width = vBoxMaxWidth;\n      layout.height = factor ? factor * hBoxMaxHeight : fullSize && params.availableHeight;\n    }\n  }\n  return stacks;\n}\n\nfunction buildLayoutBoxes(boxes) {\n  const layoutBoxes = wrapBoxes(boxes);\n  const fullSize = sortByWeight(layoutBoxes.filter(wrap => wrap.box.fullSize), true);\n  const left = sortByWeight(filterByPosition(layoutBoxes, 'left'), true);\n  const right = sortByWeight(filterByPosition(layoutBoxes, 'right'));\n  const top = sortByWeight(filterByPosition(layoutBoxes, 'top'), true);\n  const bottom = sortByWeight(filterByPosition(layoutBoxes, 'bottom'));\n  const centerHorizontal = filterDynamicPositionByAxis(layoutBoxes, 'x');\n  const centerVertical = filterDynamicPositionByAxis(layoutBoxes, 'y');\n\n  return {\n    fullSize,\n    leftAndTop: left.concat(top),\n    rightAndBottom: right.concat(centerVertical).concat(bottom).concat(centerHorizontal),\n    chartArea: filterByPosition(layoutBoxes, 'chartArea'),\n    vertical: left.concat(right).concat(centerVertical),\n    horizontal: top.concat(bottom).concat(centerHorizontal)\n  };\n}\n\nfunction getCombinedMax(maxPadding, chartArea, a, b) {\n  return Math.max(maxPadding[a], chartArea[a]) + Math.max(maxPadding[b], chartArea[b]);\n}\n\nfunction updateMaxPadding(maxPadding, boxPadding) {\n  maxPadding.top = Math.max(maxPadding.top, boxPadding.top);\n  maxPadding.left = Math.max(maxPadding.left, boxPadding.left);\n  maxPadding.bottom = Math.max(maxPadding.bottom, boxPadding.bottom);\n  maxPadding.right = Math.max(maxPadding.right, boxPadding.right);\n}\n\nfunction updateDims(chartArea, params, layout, stacks) {\n  const {pos, box} = layout;\n  const maxPadding = chartArea.maxPadding;\n\n  // dynamically placed boxes size is not considered\n  if (!isObject(pos)) {\n    if (layout.size) {\n      // this layout was already counted for, lets first reduce old size\n      chartArea[pos] -= layout.size;\n    }\n    const stack = stacks[layout.stack] || {size: 0, count: 1};\n    stack.size = Math.max(stack.size, layout.horizontal ? box.height : box.width);\n    layout.size = stack.size / stack.count;\n    chartArea[pos] += layout.size;\n  }\n\n  if (box.getPadding) {\n    updateMaxPadding(maxPadding, box.getPadding());\n  }\n\n  const newWidth = Math.max(0, params.outerWidth - getCombinedMax(maxPadding, chartArea, 'left', 'right'));\n  const newHeight = Math.max(0, params.outerHeight - getCombinedMax(maxPadding, chartArea, 'top', 'bottom'));\n  const widthChanged = newWidth !== chartArea.w;\n  const heightChanged = newHeight !== chartArea.h;\n  chartArea.w = newWidth;\n  chartArea.h = newHeight;\n\n  // return booleans on the changes per direction\n  return layout.horizontal\n    ? {same: widthChanged, other: heightChanged}\n    : {same: heightChanged, other: widthChanged};\n}\n\nfunction handleMaxPadding(chartArea) {\n  const maxPadding = chartArea.maxPadding;\n\n  function updatePos(pos) {\n    const change = Math.max(maxPadding[pos] - chartArea[pos], 0);\n    chartArea[pos] += change;\n    return change;\n  }\n  chartArea.y += updatePos('top');\n  chartArea.x += updatePos('left');\n  updatePos('right');\n  updatePos('bottom');\n}\n\nfunction getMargins(horizontal, chartArea) {\n  const maxPadding = chartArea.maxPadding;\n\n  function marginForPositions(positions) {\n    const margin = {left: 0, top: 0, right: 0, bottom: 0};\n    positions.forEach((pos) => {\n      margin[pos] = Math.max(chartArea[pos], maxPadding[pos]);\n    });\n    return margin;\n  }\n\n  return horizontal\n    ? marginForPositions(['left', 'right'])\n    : marginForPositions(['top', 'bottom']);\n}\n\nfunction fitBoxes(boxes, chartArea, params, stacks) {\n  const refitBoxes = [];\n  let i, ilen, layout, box, refit, changed;\n\n  for (i = 0, ilen = boxes.length, refit = 0; i < ilen; ++i) {\n    layout = boxes[i];\n    box = layout.box;\n\n    box.update(\n      layout.width || chartArea.w,\n      layout.height || chartArea.h,\n      getMargins(layout.horizontal, chartArea)\n    );\n    const {same, other} = updateDims(chartArea, params, layout, stacks);\n\n    // Dimensions changed and there were non full width boxes before this\n    // -> we have to refit those\n    refit |= same && refitBoxes.length;\n\n    // Chart area changed in the opposite direction\n    changed = changed || other;\n\n    if (!box.fullSize) { // fullSize boxes don't need to be re-fitted in any case\n      refitBoxes.push(layout);\n    }\n  }\n\n  return refit && fitBoxes(refitBoxes, chartArea, params, stacks) || changed;\n}\n\nfunction setBoxDims(box, left, top, width, height) {\n  box.top = top;\n  box.left = left;\n  box.right = left + width;\n  box.bottom = top + height;\n  box.width = width;\n  box.height = height;\n}\n\nfunction placeBoxes(boxes, chartArea, params, stacks) {\n  const userPadding = params.padding;\n  let {x, y} = chartArea;\n\n  for (const layout of boxes) {\n    const box = layout.box;\n    const stack = stacks[layout.stack] || {count: 1, placed: 0, weight: 1};\n    const weight = (layout.stackWeight / stack.weight) || 1;\n    if (layout.horizontal) {\n      const width = chartArea.w * weight;\n      const height = stack.size || box.height;\n      if (defined(stack.start)) {\n        y = stack.start;\n      }\n      if (box.fullSize) {\n        setBoxDims(box, userPadding.left, y, params.outerWidth - userPadding.right - userPadding.left, height);\n      } else {\n        setBoxDims(box, chartArea.left + stack.placed, y, width, height);\n      }\n      stack.start = y;\n      stack.placed += width;\n      y = box.bottom;\n    } else {\n      const height = chartArea.h * weight;\n      const width = stack.size || box.width;\n      if (defined(stack.start)) {\n        x = stack.start;\n      }\n      if (box.fullSize) {\n        setBoxDims(box, x, userPadding.top, width, params.outerHeight - userPadding.bottom - userPadding.top);\n      } else {\n        setBoxDims(box, x, chartArea.top + stack.placed, width, height);\n      }\n      stack.start = x;\n      stack.placed += height;\n      x = box.right;\n    }\n  }\n\n  chartArea.x = x;\n  chartArea.y = y;\n}\n\n/**\n * @interface LayoutItem\n * @typedef {object} LayoutItem\n * @prop {string} position - The position of the item in the chart layout. Possible values are\n * 'left', 'top', 'right', 'bottom', and 'chartArea'\n * @prop {number} weight - The weight used to sort the item. Higher weights are further away from the chart area\n * @prop {boolean} fullSize - if true, and the item is horizontal, then push vertical boxes down\n * @prop {function} isHorizontal - returns true if the layout item is horizontal (ie. top or bottom)\n * @prop {function} update - Takes two parameters: width and height. Returns size of item\n * @prop {function} draw - Draws the element\n * @prop {function} [getPadding] -  Returns an object with padding on the edges\n * @prop {number} width - Width of item. Must be valid after update()\n * @prop {number} height - Height of item. Must be valid after update()\n * @prop {number} left - Left edge of the item. Set by layout system and cannot be used in update\n * @prop {number} top - Top edge of the item. Set by layout system and cannot be used in update\n * @prop {number} right - Right edge of the item. Set by layout system and cannot be used in update\n * @prop {number} bottom - Bottom edge of the item. Set by layout system and cannot be used in update\n */\n\n// The layout service is very self explanatory.  It's responsible for the layout within a chart.\n// Scales, Legends and Plugins all rely on the layout service and can easily register to be placed anywhere they need\n// It is this service's responsibility of carrying out that layout.\nexport default {\n\n  /**\n\t * Register a box to a chart.\n\t * A box is simply a reference to an object that requires layout. eg. Scales, Legend, Title.\n\t * @param {Chart} chart - the chart to use\n\t * @param {LayoutItem} item - the item to add to be laid out\n\t */\n  addBox(chart, item) {\n    if (!chart.boxes) {\n      chart.boxes = [];\n    }\n\n    // initialize item with default values\n    item.fullSize = item.fullSize || false;\n    item.position = item.position || 'top';\n    item.weight = item.weight || 0;\n    // @ts-ignore\n    item._layers = item._layers || function() {\n      return [{\n        z: 0,\n        draw(chartArea) {\n          item.draw(chartArea);\n        }\n      }];\n    };\n\n    chart.boxes.push(item);\n  },\n\n  /**\n\t * Remove a layoutItem from a chart\n\t * @param {Chart} chart - the chart to remove the box from\n\t * @param {LayoutItem} layoutItem - the item to remove from the layout\n\t */\n  removeBox(chart, layoutItem) {\n    const index = chart.boxes ? chart.boxes.indexOf(layoutItem) : -1;\n    if (index !== -1) {\n      chart.boxes.splice(index, 1);\n    }\n  },\n\n  /**\n\t * Sets (or updates) options on the given `item`.\n\t * @param {Chart} chart - the chart in which the item lives (or will be added to)\n\t * @param {LayoutItem} item - the item to configure with the given options\n\t * @param {object} options - the new item options.\n\t */\n  configure(chart, item, options) {\n    item.fullSize = options.fullSize;\n    item.position = options.position;\n    item.weight = options.weight;\n  },\n\n  /**\n\t * Fits boxes of the given chart into the given size by having each box measure itself\n\t * then running a fitting algorithm\n\t * @param {Chart} chart - the chart\n\t * @param {number} width - the width to fit into\n\t * @param {number} height - the height to fit into\n   * @param {number} minPadding - minimum padding required for each side of chart area\n\t */\n  update(chart, width, height, minPadding) {\n    if (!chart) {\n      return;\n    }\n\n    const padding = toPadding(chart.options.layout.padding);\n    const availableWidth = Math.max(width - padding.width, 0);\n    const availableHeight = Math.max(height - padding.height, 0);\n    const boxes = buildLayoutBoxes(chart.boxes);\n    const verticalBoxes = boxes.vertical;\n    const horizontalBoxes = boxes.horizontal;\n\n    // Before any changes are made, notify boxes that an update is about to being\n    // This is used to clear any cached data (e.g. scale limits)\n    each(chart.boxes, box => {\n      if (typeof box.beforeLayout === 'function') {\n        box.beforeLayout();\n      }\n    });\n\n    // Essentially we now have any number of boxes on each of the 4 sides.\n    // Our canvas looks like the following.\n    // The areas L1 and L2 are the left axes. R1 is the right axis, T1 is the top axis and\n    // B1 is the bottom axis\n    // There are also 4 quadrant-like locations (left to right instead of clockwise) reserved for chart overlays\n    // These locations are single-box locations only, when trying to register a chartArea location that is already taken,\n    // an error will be thrown.\n    //\n    // |----------------------------------------------------|\n    // |                  T1 (Full Width)                   |\n    // |----------------------------------------------------|\n    // |    |    |                 T2                  |    |\n    // |    |----|-------------------------------------|----|\n    // |    |    | C1 |                           | C2 |    |\n    // |    |    |----|                           |----|    |\n    // |    |    |                                     |    |\n    // | L1 | L2 |           ChartArea (C0)            | R1 |\n    // |    |    |                                     |    |\n    // |    |    |----|                           |----|    |\n    // |    |    | C3 |                           | C4 |    |\n    // |    |----|-------------------------------------|----|\n    // |    |    |                 B1                  |    |\n    // |----------------------------------------------------|\n    // |                  B2 (Full Width)                   |\n    // |----------------------------------------------------|\n    //\n\n    const visibleVerticalBoxCount = verticalBoxes.reduce((total, wrap) =>\n      wrap.box.options && wrap.box.options.display === false ? total : total + 1, 0) || 1;\n\n    const params = Object.freeze({\n      outerWidth: width,\n      outerHeight: height,\n      padding,\n      availableWidth,\n      availableHeight,\n      vBoxMaxWidth: availableWidth / 2 / visibleVerticalBoxCount,\n      hBoxMaxHeight: availableHeight / 2\n    });\n    const maxPadding = Object.assign({}, padding);\n    updateMaxPadding(maxPadding, toPadding(minPadding));\n    const chartArea = Object.assign({\n      maxPadding,\n      w: availableWidth,\n      h: availableHeight,\n      x: padding.left,\n      y: padding.top\n    }, padding);\n\n    const stacks = setLayoutDims(verticalBoxes.concat(horizontalBoxes), params);\n\n    // First fit the fullSize boxes, to reduce probability of re-fitting.\n    fitBoxes(boxes.fullSize, chartArea, params, stacks);\n\n    // Then fit vertical boxes\n    fitBoxes(verticalBoxes, chartArea, params, stacks);\n\n    // Then fit horizontal boxes\n    if (fitBoxes(horizontalBoxes, chartArea, params, stacks)) {\n      // if the area changed, re-fit vertical boxes\n      fitBoxes(verticalBoxes, chartArea, params, stacks);\n    }\n\n    handleMaxPadding(chartArea);\n\n    // Finally place the boxes to correct coordinates\n    placeBoxes(boxes.leftAndTop, chartArea, params, stacks);\n\n    // Move to opposite side of chart\n    chartArea.x += chartArea.w;\n    chartArea.y += chartArea.h;\n\n    placeBoxes(boxes.rightAndBottom, chartArea, params, stacks);\n\n    chart.chartArea = {\n      left: chartArea.left,\n      top: chartArea.top,\n      right: chartArea.left + chartArea.w,\n      bottom: chartArea.top + chartArea.h,\n      height: chartArea.h,\n      width: chartArea.w,\n    };\n\n    // Finally update boxes in chartArea (radial scale for example)\n    each(boxes.chartArea, (layout) => {\n      const box = layout.box;\n      Object.assign(box, chart.chartArea);\n      box.update(chartArea.w, chartArea.h, {left: 0, top: 0, right: 0, bottom: 0});\n    });\n  }\n};\n","\n/**\n * @typedef { import(\"../core/core.controller\").default } Chart\n */\n\n/**\n * Abstract class that allows abstracting platform dependencies away from the chart.\n */\nexport default class BasePlatform {\n  /**\n\t * Called at chart construction time, returns a context2d instance implementing\n\t * the [W3C Canvas 2D Context API standard]{@link https://www.w3.org/TR/2dcontext/}.\n\t * @param {HTMLCanvasElement} canvas - The canvas from which to acquire context (platform specific)\n\t * @param {number} [aspectRatio] - The chart options\n\t */\n  acquireContext(canvas, aspectRatio) {} // eslint-disable-line no-unused-vars\n\n  /**\n\t * Called at chart destruction time, releases any resources associated to the context\n\t * previously returned by the acquireContext() method.\n\t * @param {CanvasRenderingContext2D} context - The context2d instance\n\t * @returns {boolean} true if the method succeeded, else false\n\t */\n  releaseContext(context) { // eslint-disable-line no-unused-vars\n    return false;\n  }\n\n  /**\n\t * Registers the specified listener on the given chart.\n\t * @param {Chart} chart - Chart from which to listen for event\n\t * @param {string} type - The ({@link ChartEvent}) type to listen for\n\t * @param {function} listener - Receives a notification (an object that implements\n\t * the {@link ChartEvent} interface) when an event of the specified type occurs.\n\t */\n  addEventListener(chart, type, listener) {} // eslint-disable-line no-unused-vars\n\n  /**\n\t * Removes the specified listener previously registered with addEventListener.\n\t * @param {Chart} chart - Chart from which to remove the listener\n\t * @param {string} type - The ({@link ChartEvent}) type to remove\n\t * @param {function} listener - The listener function to remove from the event target.\n\t */\n  removeEventListener(chart, type, listener) {} // eslint-disable-line no-unused-vars\n\n  /**\n\t * @returns {number} the current devicePixelRatio of the device this platform is connected to.\n\t */\n  getDevicePixelRatio() {\n    return 1;\n  }\n\n  /**\n\t * Returns the maximum size in pixels of given canvas element.\n\t * @param {HTMLCanvasElement} element\n\t * @param {number} [width] - content width of parent element\n\t * @param {number} [height] - content height of parent element\n\t * @param {number} [aspectRatio] - aspect ratio to maintain\n\t */\n  getMaximumSize(element, width, height, aspectRatio) {\n    width = Math.max(0, width || element.width);\n    height = height || element.height;\n    return {\n      width,\n      height: Math.max(0, aspectRatio ? Math.floor(width / aspectRatio) : height)\n    };\n  }\n\n  /**\n\t * @param {HTMLCanvasElement} canvas\n\t * @returns {boolean} true if the canvas is attached to the platform, false if not.\n\t */\n  isAttached(canvas) { // eslint-disable-line no-unused-vars\n    return true;\n  }\n\n  /**\n   * Updates config with platform specific requirements\n   * @param {import(\"../core/core.config\").default} config\n   */\n  updateConfig(config) { // eslint-disable-line no-unused-vars\n    // no-op\n  }\n}\n","/**\n * Platform fallback implementation (minimal).\n * @see https://github.com/chartjs/Chart.js/pull/4591#issuecomment-319575939\n */\n\nimport BasePlatform from './platform.base';\n\n/**\n * Platform class for charts without access to the DOM or to many element properties\n * This platform is used by default for any chart passed an OffscreenCanvas.\n * @extends BasePlatform\n */\nexport default class BasicPlatform extends BasePlatform {\n  acquireContext(item) {\n    // To prevent canvas fingerprinting, some add-ons undefine the getContext\n    // method, for example: https://github.com/kkapsner/CanvasBlocker\n    // https://github.com/chartjs/Chart.js/issues/2807\n    return item && item.getContext && item.getContext('2d') || null;\n  }\n  updateConfig(config) {\n    config.options.animation = false;\n  }\n}\n","/**\n * Chart.Platform implementation for targeting a web browser\n */\n\nimport BasePlatform from './platform.base';\nimport {_getParentNode, getRelativePosition, supportsEventListenerOptions, readUsedSize, getMaximumSize} from '../helpers/helpers.dom';\nimport {throttled} from '../helpers/helpers.extras';\nimport {isNullOrUndef} from '../helpers/helpers.core';\n\n/**\n * @typedef { import(\"../core/core.controller\").default } Chart\n */\n\nconst EXPANDO_KEY = '$chartjs';\n\n/**\n * DOM event types -> Chart.js event types.\n * Note: only events with different types are mapped.\n * @see https://developer.mozilla.org/en-US/docs/Web/Events\n */\nconst EVENT_TYPES = {\n  touchstart: 'mousedown',\n  touchmove: 'mousemove',\n  touchend: 'mouseup',\n  pointerenter: 'mouseenter',\n  pointerdown: 'mousedown',\n  pointermove: 'mousemove',\n  pointerup: 'mouseup',\n  pointerleave: 'mouseout',\n  pointerout: 'mouseout'\n};\n\nconst isNullOrEmpty = value => value === null || value === '';\n/**\n * Initializes the canvas style and render size without modifying the canvas display size,\n * since responsiveness is handled by the controller.resize() method. The config is used\n * to determine the aspect ratio to apply in case no explicit height has been specified.\n * @param {HTMLCanvasElement} canvas\n * @param {number} [aspectRatio]\n */\nfunction initCanvas(canvas, aspectRatio) {\n  const style = canvas.style;\n\n  // NOTE(SB) canvas.getAttribute('width') !== canvas.width: in the first case it\n  // returns null or '' if no explicit value has been set to the canvas attribute.\n  const renderHeight = canvas.getAttribute('height');\n  const renderWidth = canvas.getAttribute('width');\n\n  // Chart.js modifies some canvas values that we want to restore on destroy\n  canvas[EXPANDO_KEY] = {\n    initial: {\n      height: renderHeight,\n      width: renderWidth,\n      style: {\n        display: style.display,\n        height: style.height,\n        width: style.width\n      }\n    }\n  };\n\n  // Force canvas to display as block to avoid extra space caused by inline\n  // elements, which would interfere with the responsive resize process.\n  // https://github.com/chartjs/Chart.js/issues/2538\n  style.display = style.display || 'block';\n  // Include possible borders in the size\n  style.boxSizing = style.boxSizing || 'border-box';\n\n  if (isNullOrEmpty(renderWidth)) {\n    const displayWidth = readUsedSize(canvas, 'width');\n    if (displayWidth !== undefined) {\n      canvas.width = displayWidth;\n    }\n  }\n\n  if (isNullOrEmpty(renderHeight)) {\n    if (canvas.style.height === '') {\n      // If no explicit render height and style height, let's apply the aspect ratio,\n      // which one can be specified by the user but also by charts as default option\n      // (i.e. options.aspectRatio). If not specified, use canvas aspect ratio of 2.\n      canvas.height = canvas.width / (aspectRatio || 2);\n    } else {\n      const displayHeight = readUsedSize(canvas, 'height');\n      if (displayHeight !== undefined) {\n        canvas.height = displayHeight;\n      }\n    }\n  }\n\n  return canvas;\n}\n\n// Default passive to true as expected by Chrome for 'touchstart' and 'touchend' events.\n// https://github.com/chartjs/Chart.js/issues/4287\nconst eventListenerOptions = supportsEventListenerOptions ? {passive: true} : false;\n\nfunction addListener(node, type, listener) {\n  node.addEventListener(type, listener, eventListenerOptions);\n}\n\nfunction removeListener(chart, type, listener) {\n  chart.canvas.removeEventListener(type, listener, eventListenerOptions);\n}\n\nfunction fromNativeEvent(event, chart) {\n  const type = EVENT_TYPES[event.type] || event.type;\n  const {x, y} = getRelativePosition(event, chart);\n  return {\n    type,\n    chart,\n    native: event,\n    x: x !== undefined ? x : null,\n    y: y !== undefined ? y : null,\n  };\n}\n\nfunction nodeListContains(nodeList, canvas) {\n  for (const node of nodeList) {\n    if (node === canvas || node.contains(canvas)) {\n      return true;\n    }\n  }\n}\n\nfunction createAttachObserver(chart, type, listener) {\n  const canvas = chart.canvas;\n  const observer = new MutationObserver(entries => {\n    let trigger = false;\n    for (const entry of entries) {\n      trigger = trigger || nodeListContains(entry.addedNodes, canvas);\n      trigger = trigger && !nodeListContains(entry.removedNodes, canvas);\n    }\n    if (trigger) {\n      listener();\n    }\n  });\n  observer.observe(document, {childList: true, subtree: true});\n  return observer;\n}\n\nfunction createDetachObserver(chart, type, listener) {\n  const canvas = chart.canvas;\n  const observer = new MutationObserver(entries => {\n    let trigger = false;\n    for (const entry of entries) {\n      trigger = trigger || nodeListContains(entry.removedNodes, canvas);\n      trigger = trigger && !nodeListContains(entry.addedNodes, canvas);\n    }\n    if (trigger) {\n      listener();\n    }\n  });\n  observer.observe(document, {childList: true, subtree: true});\n  return observer;\n}\n\nconst drpListeningCharts = new Map();\nlet oldDevicePixelRatio = 0;\n\nfunction onWindowResize() {\n  const dpr = window.devicePixelRatio;\n  if (dpr === oldDevicePixelRatio) {\n    return;\n  }\n  oldDevicePixelRatio = dpr;\n  drpListeningCharts.forEach((resize, chart) => {\n    if (chart.currentDevicePixelRatio !== dpr) {\n      resize();\n    }\n  });\n}\n\nfunction listenDevicePixelRatioChanges(chart, resize) {\n  if (!drpListeningCharts.size) {\n    window.addEventListener('resize', onWindowResize);\n  }\n  drpListeningCharts.set(chart, resize);\n}\n\nfunction unlistenDevicePixelRatioChanges(chart) {\n  drpListeningCharts.delete(chart);\n  if (!drpListeningCharts.size) {\n    window.removeEventListener('resize', onWindowResize);\n  }\n}\n\nfunction createResizeObserver(chart, type, listener) {\n  const canvas = chart.canvas;\n  const container = canvas && _getParentNode(canvas);\n  if (!container) {\n    return;\n  }\n  const resize = throttled((width, height) => {\n    const w = container.clientWidth;\n    listener(width, height);\n    if (w < container.clientWidth) {\n      // If the container size shrank during chart resize, let's assume\n      // scrollbar appeared. So we resize again with the scrollbar visible -\n      // effectively making chart smaller and the scrollbar hidden again.\n      // Because we are inside `throttled`, and currently `ticking`, scroll\n      // events are ignored during this whole 2 resize process.\n      // If we assumed wrong and something else happened, we are resizing\n      // twice in a frame (potential performance issue)\n      listener();\n    }\n  }, window);\n\n  // @ts-ignore until https://github.com/microsoft/TypeScript/issues/37861 implemented\n  const observer = new ResizeObserver(entries => {\n    const entry = entries[0];\n    const width = entry.contentRect.width;\n    const height = entry.contentRect.height;\n    // When its container's display is set to 'none' the callback will be called with a\n    // size of (0, 0), which will cause the chart to lose its original height, so skip\n    // resizing in such case.\n    if (width === 0 && height === 0) {\n      return;\n    }\n    resize(width, height);\n  });\n  observer.observe(container);\n  listenDevicePixelRatioChanges(chart, resize);\n\n  return observer;\n}\n\nfunction releaseObserver(chart, type, observer) {\n  if (observer) {\n    observer.disconnect();\n  }\n  if (type === 'resize') {\n    unlistenDevicePixelRatioChanges(chart);\n  }\n}\n\nfunction createProxyAndListen(chart, type, listener) {\n  const canvas = chart.canvas;\n  const proxy = throttled((event) => {\n    // This case can occur if the chart is destroyed while waiting\n    // for the throttled function to occur. We prevent crashes by checking\n    // for a destroyed chart\n    if (chart.ctx !== null) {\n      listener(fromNativeEvent(event, chart));\n    }\n  }, chart);\n\n  addListener(canvas, type, proxy);\n\n  return proxy;\n}\n\n/**\n * Platform class for charts that can access the DOM and global window/document properties\n * @extends BasePlatform\n */\nexport default class DomPlatform extends BasePlatform {\n\n  /**\n\t * @param {HTMLCanvasElement} canvas\n\t * @param {number} [aspectRatio]\n\t * @return {CanvasRenderingContext2D|null}\n\t */\n  acquireContext(canvas, aspectRatio) {\n    // To prevent canvas fingerprinting, some add-ons undefine the getContext\n    // method, for example: https://github.com/kkapsner/CanvasBlocker\n    // https://github.com/chartjs/Chart.js/issues/2807\n    const context = canvas && canvas.getContext && canvas.getContext('2d');\n\n    // `instanceof HTMLCanvasElement/CanvasRenderingContext2D` fails when the canvas is\n    // inside an iframe or when running in a protected environment. We could guess the\n    // types from their toString() value but let's keep things flexible and assume it's\n    // a sufficient condition if the canvas has a context2D which has canvas as `canvas`.\n    // https://github.com/chartjs/Chart.js/issues/3887\n    // https://github.com/chartjs/Chart.js/issues/4102\n    // https://github.com/chartjs/Chart.js/issues/4152\n    if (context && context.canvas === canvas) {\n      // Load platform resources on first chart creation, to make it possible to\n      // import the library before setting platform options.\n      initCanvas(canvas, aspectRatio);\n      return context;\n    }\n\n    return null;\n  }\n\n  /**\n\t * @param {CanvasRenderingContext2D} context\n\t */\n  releaseContext(context) {\n    const canvas = context.canvas;\n    if (!canvas[EXPANDO_KEY]) {\n      return false;\n    }\n\n    const initial = canvas[EXPANDO_KEY].initial;\n    ['height', 'width'].forEach((prop) => {\n      const value = initial[prop];\n      if (isNullOrUndef(value)) {\n        canvas.removeAttribute(prop);\n      } else {\n        canvas.setAttribute(prop, value);\n      }\n    });\n\n    const style = initial.style || {};\n    Object.keys(style).forEach((key) => {\n      canvas.style[key] = style[key];\n    });\n\n    // The canvas render size might have been changed (and thus the state stack discarded),\n    // we can't use save() and restore() to restore the initial state. So make sure that at\n    // least the canvas context is reset to the default state by setting the canvas width.\n    // https://www.w3.org/TR/2011/WD-html5-20110525/the-canvas-element.html\n    // eslint-disable-next-line no-self-assign\n    canvas.width = canvas.width;\n\n    delete canvas[EXPANDO_KEY];\n    return true;\n  }\n\n  /**\n\t *\n\t * @param {Chart} chart\n\t * @param {string} type\n\t * @param {function} listener\n\t */\n  addEventListener(chart, type, listener) {\n    // Can have only one listener per type, so make sure previous is removed\n    this.removeEventListener(chart, type);\n\n    const proxies = chart.$proxies || (chart.$proxies = {});\n    const handlers = {\n      attach: createAttachObserver,\n      detach: createDetachObserver,\n      resize: createResizeObserver\n    };\n    const handler = handlers[type] || createProxyAndListen;\n    proxies[type] = handler(chart, type, listener);\n  }\n\n\n  /**\n\t * @param {Chart} chart\n\t * @param {string} type\n\t */\n  removeEventListener(chart, type) {\n    const proxies = chart.$proxies || (chart.$proxies = {});\n    const proxy = proxies[type];\n\n    if (!proxy) {\n      return;\n    }\n\n    const handlers = {\n      attach: releaseObserver,\n      detach: releaseObserver,\n      resize: releaseObserver\n    };\n    const handler = handlers[type] || removeListener;\n    handler(chart, type, proxy);\n    proxies[type] = undefined;\n  }\n\n  getDevicePixelRatio() {\n    return window.devicePixelRatio;\n  }\n\n  /**\n\t * @param {HTMLCanvasElement} canvas\n\t * @param {number} [width] - content width of parent element\n\t * @param {number} [height] - content height of parent element\n\t * @param {number} [aspectRatio] - aspect ratio to maintain\n\t */\n  getMaximumSize(canvas, width, height, aspectRatio) {\n    return getMaximumSize(canvas, width, height, aspectRatio);\n  }\n\n  /**\n\t * @param {HTMLCanvasElement} canvas\n\t */\n  isAttached(canvas) {\n    const container = _getParentNode(canvas);\n    return !!(container && container.isConnected);\n  }\n}\n","import {_isDomSupported} from '../helpers';\nimport BasePlatform from './platform.base';\nimport BasicPlatform from './platform.basic';\nimport DomPlatform from './platform.dom';\n\nexport function _detectPlatform(canvas) {\n  if (!_isDomSupported() || (typeof OffscreenCanvas !== 'undefined' && canvas instanceof OffscreenCanvas)) {\n    return BasicPlatform;\n  }\n  return DomPlatform;\n}\n\nexport {BasePlatform, BasicPlatform, DomPlatform};\n","import type {AnyObject} from '../../types/basic';\nimport type {Point} from '../../types/geometric';\nimport type {Animation} from '../../types/animation';\nimport {isNumber} from '../helpers/helpers.math';\n\nexport default class Element<T = AnyObject, O = AnyObject> {\n\n  static defaults = {};\n  static defaultRoutes = undefined;\n\n  x: number;\n  y: number;\n  active = false;\n  options: O;\n  $animations: Record<keyof T, Animation>;\n\n  tooltipPosition(useFinalPosition: boolean): Point {\n    const {x, y} = this.getProps(['x', 'y'], useFinalPosition);\n    return {x, y} as Point;\n  }\n\n  hasValue() {\n    return isNumber(this.x) && isNumber(this.y);\n  }\n\n  /**\n   * Gets the current or final value of each prop. Can return extra properties (whole object).\n   * @param props - properties to get\n   * @param [final] - get the final value (animation target)\n   */\n  getProps<P extends (keyof T)[]>(props: P, final?: boolean): Pick<T, P[number]>;\n  getProps<P extends string>(props: P[], final?: boolean): Partial<Record<P, unknown>>;\n  getProps(props: string[], final?: boolean): Partial<Record<string, unknown>> {\n    const anims = this.$animations;\n    if (!final || !anims) {\n      // let's not create an object, if not needed\n      return this as Record<string, unknown>;\n    }\n    const ret: Record<string, unknown> = {};\n    props.forEach((prop) => {\n      ret[prop] = anims[prop] && anims[prop].active() ? anims[prop]._to : this[prop as string];\n    });\n    return ret;\n  }\n}\n","import {isNullOrUndef, valueOrDefault} from '../helpers/helpers.core';\nimport {_factorize} from '../helpers/helpers.math';\n\n\n/**\n * @typedef { import(\"./core.controller\").default } Chart\n * @typedef {{value:number | string, label?:string, major?:boolean, $context?:any}} Tick\n */\n\n/**\n * Returns a subset of ticks to be plotted to avoid overlapping labels.\n * @param {import('./core.scale').default} scale\n * @param {Tick[]} ticks\n * @return {Tick[]}\n * @private\n */\nexport function autoSkip(scale, ticks) {\n  const tickOpts = scale.options.ticks;\n  const determinedMaxTicks = determineMaxTicks(scale);\n  const ticksLimit = Math.min(tickOpts.maxTicksLimit || determinedMaxTicks, determinedMaxTicks);\n  const majorIndices = tickOpts.major.enabled ? getMajorIndices(ticks) : [];\n  const numMajorIndices = majorIndices.length;\n  const first = majorIndices[0];\n  const last = majorIndices[numMajorIndices - 1];\n  const newTicks = [];\n\n  // If there are too many major ticks to display them all\n  if (numMajorIndices > ticksLimit) {\n    skipMajors(ticks, newTicks, majorIndices, numMajorIndices / ticksLimit);\n    return newTicks;\n  }\n\n  const spacing = calculateSpacing(majorIndices, ticks, ticksLimit);\n\n  if (numMajorIndices > 0) {\n    let i, ilen;\n    const avgMajorSpacing = numMajorIndices > 1 ? Math.round((last - first) / (numMajorIndices - 1)) : null;\n    skip(ticks, newTicks, spacing, isNullOrUndef(avgMajorSpacing) ? 0 : first - avgMajorSpacing, first);\n    for (i = 0, ilen = numMajorIndices - 1; i < ilen; i++) {\n      skip(ticks, newTicks, spacing, majorIndices[i], majorIndices[i + 1]);\n    }\n    skip(ticks, newTicks, spacing, last, isNullOrUndef(avgMajorSpacing) ? ticks.length : last + avgMajorSpacing);\n    return newTicks;\n  }\n  skip(ticks, newTicks, spacing);\n  return newTicks;\n}\n\nfunction determineMaxTicks(scale) {\n  const offset = scale.options.offset;\n  const tickLength = scale._tickSize();\n  const maxScale = scale._length / tickLength + (offset ? 0 : 1);\n  const maxChart = scale._maxLength / tickLength;\n  return Math.floor(Math.min(maxScale, maxChart));\n}\n\n/**\n * @param {number[]} majorIndices\n * @param {Tick[]} ticks\n * @param {number} ticksLimit\n */\nfunction calculateSpacing(majorIndices, ticks, ticksLimit) {\n  const evenMajorSpacing = getEvenSpacing(majorIndices);\n  const spacing = ticks.length / ticksLimit;\n\n  // If the major ticks are evenly spaced apart, place the minor ticks\n  // so that they divide the major ticks into even chunks\n  if (!evenMajorSpacing) {\n    return Math.max(spacing, 1);\n  }\n\n  const factors = _factorize(evenMajorSpacing);\n  for (let i = 0, ilen = factors.length - 1; i < ilen; i++) {\n    const factor = factors[i];\n    if (factor > spacing) {\n      return factor;\n    }\n  }\n  return Math.max(spacing, 1);\n}\n\n/**\n * @param {Tick[]} ticks\n */\nfunction getMajorIndices(ticks) {\n  const result = [];\n  let i, ilen;\n  for (i = 0, ilen = ticks.length; i < ilen; i++) {\n    if (ticks[i].major) {\n      result.push(i);\n    }\n  }\n  return result;\n}\n\n/**\n * @param {Tick[]} ticks\n * @param {Tick[]} newTicks\n * @param {number[]} majorIndices\n * @param {number} spacing\n */\nfunction skipMajors(ticks, newTicks, majorIndices, spacing) {\n  let count = 0;\n  let next = majorIndices[0];\n  let i;\n\n  spacing = Math.ceil(spacing);\n  for (i = 0; i < ticks.length; i++) {\n    if (i === next) {\n      newTicks.push(ticks[i]);\n      count++;\n      next = majorIndices[count * spacing];\n    }\n  }\n}\n\n/**\n * @param {Tick[]} ticks\n * @param {Tick[]} newTicks\n * @param {number} spacing\n * @param {number} [majorStart]\n * @param {number} [majorEnd]\n */\nfunction skip(ticks, newTicks, spacing, majorStart, majorEnd) {\n  const start = valueOrDefault(majorStart, 0);\n  const end = Math.min(valueOrDefault(majorEnd, ticks.length), ticks.length);\n  let count = 0;\n  let length, i, next;\n\n  spacing = Math.ceil(spacing);\n  if (majorEnd) {\n    length = majorEnd - majorStart;\n    spacing = length / Math.floor(length / spacing);\n  }\n\n  next = start;\n\n  while (next < 0) {\n    count++;\n    next = Math.round(start + count * spacing);\n  }\n\n  for (i = Math.max(start, 0); i < end; i++) {\n    if (i === next) {\n      newTicks.push(ticks[i]);\n      count++;\n      next = Math.round(start + count * spacing);\n    }\n  }\n}\n\n\n/**\n * @param {number[]} arr\n */\nfunction getEvenSpacing(arr) {\n  const len = arr.length;\n  let i, diff;\n\n  if (len < 2) {\n    return false;\n  }\n\n  for (diff = arr[0], i = 1; i < len; ++i) {\n    if (arr[i] - arr[i - 1] !== diff) {\n      return false;\n    }\n  }\n  return diff;\n}\n","import Element from './core.element';\nimport {_alignPixel, _measureText, renderText, clipArea, unclipArea} from '../helpers/helpers.canvas';\nimport {callback as call, each, finiteOrDefault, isArray, isFinite, isNullOrUndef, isObject, valueOrDefault} from '../helpers/helpers.core';\nimport {toDegrees, toRadians, _int16Range, _limitValue, HALF_PI} from '../helpers/helpers.math';\nimport {_alignStartEnd, _toLeftRightCenter} from '../helpers/helpers.extras';\nimport {createContext, toFont, toPadding, _addGrace} from '../helpers/helpers.options';\nimport {autoSkip} from './core.scale.autoskip';\n\nconst reverseAlign = (align) => align === 'left' ? 'right' : align === 'right' ? 'left' : align;\nconst offsetFromEdge = (scale, edge, offset) => edge === 'top' || edge === 'left' ? scale[edge] + offset : scale[edge] - offset;\n\n/**\n * @typedef { import(\"./core.controller\").default } Chart\n * @typedef {{value:number | string, label?:string, major?:boolean, $context?:any}} Tick\n */\n\n/**\n * Returns a new array containing numItems from arr\n * @param {any[]} arr\n * @param {number} numItems\n */\nfunction sample(arr, numItems) {\n  const result = [];\n  const increment = arr.length / numItems;\n  const len = arr.length;\n  let i = 0;\n\n  for (; i < len; i += increment) {\n    result.push(arr[Math.floor(i)]);\n  }\n  return result;\n}\n\n/**\n * @param {Scale} scale\n * @param {number} index\n * @param {boolean} offsetGridLines\n */\nfunction getPixelForGridLine(scale, index, offsetGridLines) {\n  const length = scale.ticks.length;\n  const validIndex = Math.min(index, length - 1);\n  const start = scale._startPixel;\n  const end = scale._endPixel;\n  const epsilon = 1e-6; // 1e-6 is margin in pixels for accumulated error.\n  let lineValue = scale.getPixelForTick(validIndex);\n  let offset;\n\n  if (offsetGridLines) {\n    if (length === 1) {\n      offset = Math.max(lineValue - start, end - lineValue);\n    } else if (index === 0) {\n      offset = (scale.getPixelForTick(1) - lineValue) / 2;\n    } else {\n      offset = (lineValue - scale.getPixelForTick(validIndex - 1)) / 2;\n    }\n    lineValue += validIndex < index ? offset : -offset;\n\n    // Return undefined if the pixel is out of the range\n    if (lineValue < start - epsilon || lineValue > end + epsilon) {\n      return;\n    }\n  }\n  return lineValue;\n}\n\n/**\n * @param {object} caches\n * @param {number} length\n */\nfunction garbageCollect(caches, length) {\n  each(caches, (cache) => {\n    const gc = cache.gc;\n    const gcLen = gc.length / 2;\n    let i;\n    if (gcLen > length) {\n      for (i = 0; i < gcLen; ++i) {\n        delete cache.data[gc[i]];\n      }\n      gc.splice(0, gcLen);\n    }\n  });\n}\n\n/**\n * @param {object} options\n */\nfunction getTickMarkLength(options) {\n  return options.drawTicks ? options.tickLength : 0;\n}\n\n/**\n * @param {object} options\n */\nfunction getTitleHeight(options, fallback) {\n  if (!options.display) {\n    return 0;\n  }\n\n  const font = toFont(options.font, fallback);\n  const padding = toPadding(options.padding);\n  const lines = isArray(options.text) ? options.text.length : 1;\n\n  return (lines * font.lineHeight) + padding.height;\n}\n\nfunction createScaleContext(parent, scale) {\n  return createContext(parent, {\n    scale,\n    type: 'scale'\n  });\n}\n\nfunction createTickContext(parent, index, tick) {\n  return createContext(parent, {\n    tick,\n    index,\n    type: 'tick'\n  });\n}\n\nfunction titleAlign(align, position, reverse) {\n  let ret = _toLeftRightCenter(align);\n  if ((reverse && position !== 'right') || (!reverse && position === 'right')) {\n    ret = reverseAlign(ret);\n  }\n  return ret;\n}\n\nfunction titleArgs(scale, offset, position, align) {\n  const {top, left, bottom, right, chart} = scale;\n  const {chartArea, scales} = chart;\n  let rotation = 0;\n  let maxWidth, titleX, titleY;\n  const height = bottom - top;\n  const width = right - left;\n\n  if (scale.isHorizontal()) {\n    titleX = _alignStartEnd(align, left, right);\n\n    if (isObject(position)) {\n      const positionAxisID = Object.keys(position)[0];\n      const value = position[positionAxisID];\n      titleY = scales[positionAxisID].getPixelForValue(value) + height - offset;\n    } else if (position === 'center') {\n      titleY = (chartArea.bottom + chartArea.top) / 2 + height - offset;\n    } else {\n      titleY = offsetFromEdge(scale, position, offset);\n    }\n    maxWidth = right - left;\n  } else {\n    if (isObject(position)) {\n      const positionAxisID = Object.keys(position)[0];\n      const value = position[positionAxisID];\n      titleX = scales[positionAxisID].getPixelForValue(value) - width + offset;\n    } else if (position === 'center') {\n      titleX = (chartArea.left + chartArea.right) / 2 - width + offset;\n    } else {\n      titleX = offsetFromEdge(scale, position, offset);\n    }\n    titleY = _alignStartEnd(align, bottom, top);\n    rotation = position === 'left' ? -HALF_PI : HALF_PI;\n  }\n  return {titleX, titleY, maxWidth, rotation};\n}\n\nexport default class Scale extends Element {\n\n  // eslint-disable-next-line max-statements\n  constructor(cfg) {\n    super();\n\n    /** @type {string} */\n    this.id = cfg.id;\n    /** @type {string} */\n    this.type = cfg.type;\n    /** @type {any} */\n    this.options = undefined;\n    /** @type {CanvasRenderingContext2D} */\n    this.ctx = cfg.ctx;\n    /** @type {Chart} */\n    this.chart = cfg.chart;\n\n    // implements box\n    /** @type {number} */\n    this.top = undefined;\n    /** @type {number} */\n    this.bottom = undefined;\n    /** @type {number} */\n    this.left = undefined;\n    /** @type {number} */\n    this.right = undefined;\n    /** @type {number} */\n    this.width = undefined;\n    /** @type {number} */\n    this.height = undefined;\n    this._margins = {\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0\n    };\n    /** @type {number} */\n    this.maxWidth = undefined;\n    /** @type {number} */\n    this.maxHeight = undefined;\n    /** @type {number} */\n    this.paddingTop = undefined;\n    /** @type {number} */\n    this.paddingBottom = undefined;\n    /** @type {number} */\n    this.paddingLeft = undefined;\n    /** @type {number} */\n    this.paddingRight = undefined;\n\n    // scale-specific properties\n    /** @type {string=} */\n    this.axis = undefined;\n    /** @type {number=} */\n    this.labelRotation = undefined;\n    this.min = undefined;\n    this.max = undefined;\n    this._range = undefined;\n    /** @type {Tick[]} */\n    this.ticks = [];\n    /** @type {object[]|null} */\n    this._gridLineItems = null;\n    /** @type {object[]|null} */\n    this._labelItems = null;\n    /** @type {object|null} */\n    this._labelSizes = null;\n    this._length = 0;\n    this._maxLength = 0;\n    this._longestTextCache = {};\n    /** @type {number} */\n    this._startPixel = undefined;\n    /** @type {number} */\n    this._endPixel = undefined;\n    this._reversePixels = false;\n    this._userMax = undefined;\n    this._userMin = undefined;\n    this._suggestedMax = undefined;\n    this._suggestedMin = undefined;\n    this._ticksLength = 0;\n    this._borderValue = 0;\n    this._cache = {};\n    this._dataLimitsCached = false;\n    this.$context = undefined;\n  }\n\n  /**\n\t * @param {any} options\n\t * @since 3.0\n\t */\n  init(options) {\n    this.options = options.setContext(this.getContext());\n\n    this.axis = options.axis;\n\n    // parse min/max value, so we can properly determine min/max for other scales\n    this._userMin = this.parse(options.min);\n    this._userMax = this.parse(options.max);\n    this._suggestedMin = this.parse(options.suggestedMin);\n    this._suggestedMax = this.parse(options.suggestedMax);\n  }\n\n  /**\n\t * Parse a supported input value to internal representation.\n\t * @param {*} raw\n\t * @param {number} [index]\n\t * @since 3.0\n\t */\n  parse(raw, index) { // eslint-disable-line no-unused-vars\n    return raw;\n  }\n\n  /**\n\t * @return {{min: number, max: number, minDefined: boolean, maxDefined: boolean}}\n\t * @protected\n\t * @since 3.0\n\t */\n  getUserBounds() {\n    let {_userMin, _userMax, _suggestedMin, _suggestedMax} = this;\n    _userMin = finiteOrDefault(_userMin, Number.POSITIVE_INFINITY);\n    _userMax = finiteOrDefault(_userMax, Number.NEGATIVE_INFINITY);\n    _suggestedMin = finiteOrDefault(_suggestedMin, Number.POSITIVE_INFINITY);\n    _suggestedMax = finiteOrDefault(_suggestedMax, Number.NEGATIVE_INFINITY);\n    return {\n      min: finiteOrDefault(_userMin, _suggestedMin),\n      max: finiteOrDefault(_userMax, _suggestedMax),\n      minDefined: isFinite(_userMin),\n      maxDefined: isFinite(_userMax)\n    };\n  }\n\n  /**\n\t * @param {boolean} canStack\n\t * @return {{min: number, max: number}}\n\t * @protected\n\t * @since 3.0\n\t */\n  getMinMax(canStack) {\n    // eslint-disable-next-line prefer-const\n    let {min, max, minDefined, maxDefined} = this.getUserBounds();\n    let range;\n\n    if (minDefined && maxDefined) {\n      return {min, max};\n    }\n\n    const metas = this.getMatchingVisibleMetas();\n    for (let i = 0, ilen = metas.length; i < ilen; ++i) {\n      range = metas[i].controller.getMinMax(this, canStack);\n      if (!minDefined) {\n        min = Math.min(min, range.min);\n      }\n      if (!maxDefined) {\n        max = Math.max(max, range.max);\n      }\n    }\n\n    // Make sure min <= max when only min or max is defined by user and the data is outside that range\n    min = maxDefined && min > max ? max : min;\n    max = minDefined && min > max ? min : max;\n\n    return {\n      min: finiteOrDefault(min, finiteOrDefault(max, min)),\n      max: finiteOrDefault(max, finiteOrDefault(min, max))\n    };\n  }\n\n  /**\n\t * Get the padding needed for the scale\n\t * @return {{top: number, left: number, bottom: number, right: number}} the necessary padding\n\t * @private\n\t */\n  getPadding() {\n    return {\n      left: this.paddingLeft || 0,\n      top: this.paddingTop || 0,\n      right: this.paddingRight || 0,\n      bottom: this.paddingBottom || 0\n    };\n  }\n\n  /**\n\t * Returns the scale tick objects\n\t * @return {Tick[]}\n\t * @since 2.7\n\t */\n  getTicks() {\n    return this.ticks;\n  }\n\n  /**\n\t * @return {string[]}\n\t */\n  getLabels() {\n    const data = this.chart.data;\n    return this.options.labels || (this.isHorizontal() ? data.xLabels : data.yLabels) || data.labels || [];\n  }\n\n  // When a new layout is created, reset the data limits cache\n  beforeLayout() {\n    this._cache = {};\n    this._dataLimitsCached = false;\n  }\n\n  // These methods are ordered by lifecycle. Utilities then follow.\n  // Any function defined here is inherited by all scale types.\n  // Any function can be extended by the scale type\n\n  beforeUpdate() {\n    call(this.options.beforeUpdate, [this]);\n  }\n\n  /**\n\t * @param {number} maxWidth - the max width in pixels\n\t * @param {number} maxHeight - the max height in pixels\n\t * @param {{top: number, left: number, bottom: number, right: number}} margins - the space between the edge of the other scales and edge of the chart\n\t *   This space comes from two sources:\n\t *     - padding - space that's required to show the labels at the edges of the scale\n\t *     - thickness of scales or legends in another orientation\n\t */\n  update(maxWidth, maxHeight, margins) {\n    const {beginAtZero, grace, ticks: tickOpts} = this.options;\n    const sampleSize = tickOpts.sampleSize;\n\n    // Update Lifecycle - Probably don't want to ever extend or overwrite this function ;)\n    this.beforeUpdate();\n\n    // Absorb the master measurements\n    this.maxWidth = maxWidth;\n    this.maxHeight = maxHeight;\n    this._margins = margins = Object.assign({\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0\n    }, margins);\n\n    this.ticks = null;\n    this._labelSizes = null;\n    this._gridLineItems = null;\n    this._labelItems = null;\n\n    // Dimensions\n    this.beforeSetDimensions();\n    this.setDimensions();\n    this.afterSetDimensions();\n\n    this._maxLength = this.isHorizontal()\n      ? this.width + margins.left + margins.right\n      : this.height + margins.top + margins.bottom;\n\n    // Data min/max\n    if (!this._dataLimitsCached) {\n      this.beforeDataLimits();\n      this.determineDataLimits();\n      this.afterDataLimits();\n      this._range = _addGrace(this, grace, beginAtZero);\n      this._dataLimitsCached = true;\n    }\n\n    this.beforeBuildTicks();\n\n    this.ticks = this.buildTicks() || [];\n\n    // Allow modification of ticks in callback.\n    this.afterBuildTicks();\n\n    // Compute tick rotation and fit using a sampled subset of labels\n    // We generally don't need to compute the size of every single label for determining scale size\n    const samplingEnabled = sampleSize < this.ticks.length;\n    this._convertTicksToLabels(samplingEnabled ? sample(this.ticks, sampleSize) : this.ticks);\n\n    // configure is called twice, once here, once from core.controller.updateLayout.\n    // Here we haven't been positioned yet, but dimensions are correct.\n    // Variables set in configure are needed for calculateLabelRotation, and\n    // it's ok that coordinates are not correct there, only dimensions matter.\n    this.configure();\n\n    // Tick Rotation\n    this.beforeCalculateLabelRotation();\n    this.calculateLabelRotation(); // Preconditions: number of ticks and sizes of largest labels must be calculated beforehand\n    this.afterCalculateLabelRotation();\n\n    // Auto-skip\n    if (tickOpts.display && (tickOpts.autoSkip || tickOpts.source === 'auto')) {\n      this.ticks = autoSkip(this, this.ticks);\n      this._labelSizes = null;\n      this.afterAutoSkip();\n    }\n\n    if (samplingEnabled) {\n      // Generate labels using all non-skipped ticks\n      this._convertTicksToLabels(this.ticks);\n    }\n\n    this.beforeFit();\n    this.fit(); // Preconditions: label rotation and label sizes must be calculated beforehand\n    this.afterFit();\n\n    // IMPORTANT: after this point, we consider that `this.ticks` will NEVER change!\n\n    this.afterUpdate();\n  }\n\n  /**\n\t * @protected\n\t */\n  configure() {\n    let reversePixels = this.options.reverse;\n    let startPixel, endPixel;\n\n    if (this.isHorizontal()) {\n      startPixel = this.left;\n      endPixel = this.right;\n    } else {\n      startPixel = this.top;\n      endPixel = this.bottom;\n      // by default vertical scales are from bottom to top, so pixels are reversed\n      reversePixels = !reversePixels;\n    }\n    this._startPixel = startPixel;\n    this._endPixel = endPixel;\n    this._reversePixels = reversePixels;\n    this._length = endPixel - startPixel;\n    this._alignToPixels = this.options.alignToPixels;\n  }\n\n  afterUpdate() {\n    call(this.options.afterUpdate, [this]);\n  }\n\n  //\n\n  beforeSetDimensions() {\n    call(this.options.beforeSetDimensions, [this]);\n  }\n  setDimensions() {\n    // Set the unconstrained dimension before label rotation\n    if (this.isHorizontal()) {\n      // Reset position before calculating rotation\n      this.width = this.maxWidth;\n      this.left = 0;\n      this.right = this.width;\n    } else {\n      this.height = this.maxHeight;\n\n      // Reset position before calculating rotation\n      this.top = 0;\n      this.bottom = this.height;\n    }\n\n    // Reset padding\n    this.paddingLeft = 0;\n    this.paddingTop = 0;\n    this.paddingRight = 0;\n    this.paddingBottom = 0;\n  }\n  afterSetDimensions() {\n    call(this.options.afterSetDimensions, [this]);\n  }\n\n  _callHooks(name) {\n    this.chart.notifyPlugins(name, this.getContext());\n    call(this.options[name], [this]);\n  }\n\n  // Data limits\n  beforeDataLimits() {\n    this._callHooks('beforeDataLimits');\n  }\n  determineDataLimits() {}\n  afterDataLimits() {\n    this._callHooks('afterDataLimits');\n  }\n\n  //\n  beforeBuildTicks() {\n    this._callHooks('beforeBuildTicks');\n  }\n  /**\n\t * @return {object[]} the ticks\n\t */\n  buildTicks() {\n    return [];\n  }\n  afterBuildTicks() {\n    this._callHooks('afterBuildTicks');\n  }\n\n  beforeTickToLabelConversion() {\n    call(this.options.beforeTickToLabelConversion, [this]);\n  }\n  /**\n\t * Convert ticks to label strings\n\t * @param {Tick[]} ticks\n\t */\n  generateTickLabels(ticks) {\n    const tickOpts = this.options.ticks;\n    let i, ilen, tick;\n    for (i = 0, ilen = ticks.length; i < ilen; i++) {\n      tick = ticks[i];\n      tick.label = call(tickOpts.callback, [tick.value, i, ticks], this);\n    }\n  }\n  afterTickToLabelConversion() {\n    call(this.options.afterTickToLabelConversion, [this]);\n  }\n\n  //\n\n  beforeCalculateLabelRotation() {\n    call(this.options.beforeCalculateLabelRotation, [this]);\n  }\n  calculateLabelRotation() {\n    const options = this.options;\n    const tickOpts = options.ticks;\n    const numTicks = this.ticks.length;\n    const minRotation = tickOpts.minRotation || 0;\n    const maxRotation = tickOpts.maxRotation;\n    let labelRotation = minRotation;\n    let tickWidth, maxHeight, maxLabelDiagonal;\n\n    if (!this._isVisible() || !tickOpts.display || minRotation >= maxRotation || numTicks <= 1 || !this.isHorizontal()) {\n      this.labelRotation = minRotation;\n      return;\n    }\n\n    const labelSizes = this._getLabelSizes();\n    const maxLabelWidth = labelSizes.widest.width;\n    const maxLabelHeight = labelSizes.highest.height;\n\n    // Estimate the width of each grid based on the canvas width, the maximum\n    // label width and the number of tick intervals\n    const maxWidth = _limitValue(this.chart.width - maxLabelWidth, 0, this.maxWidth);\n    tickWidth = options.offset ? this.maxWidth / numTicks : maxWidth / (numTicks - 1);\n\n    // Allow 3 pixels x2 padding either side for label readability\n    if (maxLabelWidth + 6 > tickWidth) {\n      tickWidth = maxWidth / (numTicks - (options.offset ? 0.5 : 1));\n      maxHeight = this.maxHeight - getTickMarkLength(options.grid)\n\t\t\t\t- tickOpts.padding - getTitleHeight(options.title, this.chart.options.font);\n      maxLabelDiagonal = Math.sqrt(maxLabelWidth * maxLabelWidth + maxLabelHeight * maxLabelHeight);\n      labelRotation = toDegrees(Math.min(\n        Math.asin(_limitValue((labelSizes.highest.height + 6) / tickWidth, -1, 1)),\n        Math.asin(_limitValue(maxHeight / maxLabelDiagonal, -1, 1)) - Math.asin(_limitValue(maxLabelHeight / maxLabelDiagonal, -1, 1))\n      ));\n      labelRotation = Math.max(minRotation, Math.min(maxRotation, labelRotation));\n    }\n\n    this.labelRotation = labelRotation;\n  }\n  afterCalculateLabelRotation() {\n    call(this.options.afterCalculateLabelRotation, [this]);\n  }\n  afterAutoSkip() {}\n\n  //\n\n  beforeFit() {\n    call(this.options.beforeFit, [this]);\n  }\n  fit() {\n    // Reset\n    const minSize = {\n      width: 0,\n      height: 0\n    };\n\n    const {chart, options: {ticks: tickOpts, title: titleOpts, grid: gridOpts}} = this;\n    const display = this._isVisible();\n    const isHorizontal = this.isHorizontal();\n\n    if (display) {\n      const titleHeight = getTitleHeight(titleOpts, chart.options.font);\n      if (isHorizontal) {\n        minSize.width = this.maxWidth;\n        minSize.height = getTickMarkLength(gridOpts) + titleHeight;\n      } else {\n        minSize.height = this.maxHeight; // fill all the height\n        minSize.width = getTickMarkLength(gridOpts) + titleHeight;\n      }\n\n      // Don't bother fitting the ticks if we are not showing the labels\n      if (tickOpts.display && this.ticks.length) {\n        const {first, last, widest, highest} = this._getLabelSizes();\n        const tickPadding = tickOpts.padding * 2;\n        const angleRadians = toRadians(this.labelRotation);\n        const cos = Math.cos(angleRadians);\n        const sin = Math.sin(angleRadians);\n\n        if (isHorizontal) {\n        // A horizontal axis is more constrained by the height.\n          const labelHeight = tickOpts.mirror ? 0 : sin * widest.width + cos * highest.height;\n          minSize.height = Math.min(this.maxHeight, minSize.height + labelHeight + tickPadding);\n        } else {\n        // A vertical axis is more constrained by the width. Labels are the\n        // dominant factor here, so get that length first and account for padding\n          const labelWidth = tickOpts.mirror ? 0 : cos * widest.width + sin * highest.height;\n\n          minSize.width = Math.min(this.maxWidth, minSize.width + labelWidth + tickPadding);\n        }\n        this._calculatePadding(first, last, sin, cos);\n      }\n    }\n\n    this._handleMargins();\n\n    if (isHorizontal) {\n      this.width = this._length = chart.width - this._margins.left - this._margins.right;\n      this.height = minSize.height;\n    } else {\n      this.width = minSize.width;\n      this.height = this._length = chart.height - this._margins.top - this._margins.bottom;\n    }\n  }\n\n  _calculatePadding(first, last, sin, cos) {\n    const {ticks: {align, padding}, position} = this.options;\n    const isRotated = this.labelRotation !== 0;\n    const labelsBelowTicks = position !== 'top' && this.axis === 'x';\n\n    if (this.isHorizontal()) {\n      const offsetLeft = this.getPixelForTick(0) - this.left;\n      const offsetRight = this.right - this.getPixelForTick(this.ticks.length - 1);\n      let paddingLeft = 0;\n      let paddingRight = 0;\n\n      // Ensure that our ticks are always inside the canvas. When rotated, ticks are right aligned\n      // which means that the right padding is dominated by the font height\n      if (isRotated) {\n        if (labelsBelowTicks) {\n          paddingLeft = cos * first.width;\n          paddingRight = sin * last.height;\n        } else {\n          paddingLeft = sin * first.height;\n          paddingRight = cos * last.width;\n        }\n      } else if (align === 'start') {\n        paddingRight = last.width;\n      } else if (align === 'end') {\n        paddingLeft = first.width;\n      } else if (align !== 'inner') {\n        paddingLeft = first.width / 2;\n        paddingRight = last.width / 2;\n      }\n\n      // Adjust padding taking into account changes in offsets\n      this.paddingLeft = Math.max((paddingLeft - offsetLeft + padding) * this.width / (this.width - offsetLeft), 0);\n      this.paddingRight = Math.max((paddingRight - offsetRight + padding) * this.width / (this.width - offsetRight), 0);\n    } else {\n      let paddingTop = last.height / 2;\n      let paddingBottom = first.height / 2;\n\n      if (align === 'start') {\n        paddingTop = 0;\n        paddingBottom = first.height;\n      } else if (align === 'end') {\n        paddingTop = last.height;\n        paddingBottom = 0;\n      }\n\n      this.paddingTop = paddingTop + padding;\n      this.paddingBottom = paddingBottom + padding;\n    }\n  }\n\n  /**\n\t * Handle margins and padding interactions\n\t * @private\n\t */\n  _handleMargins() {\n    if (this._margins) {\n      this._margins.left = Math.max(this.paddingLeft, this._margins.left);\n      this._margins.top = Math.max(this.paddingTop, this._margins.top);\n      this._margins.right = Math.max(this.paddingRight, this._margins.right);\n      this._margins.bottom = Math.max(this.paddingBottom, this._margins.bottom);\n    }\n  }\n\n  afterFit() {\n    call(this.options.afterFit, [this]);\n  }\n\n  // Shared Methods\n  /**\n\t * @return {boolean}\n\t */\n  isHorizontal() {\n    const {axis, position} = this.options;\n    return position === 'top' || position === 'bottom' || axis === 'x';\n  }\n  /**\n\t * @return {boolean}\n\t */\n  isFullSize() {\n    return this.options.fullSize;\n  }\n\n  /**\n\t * @param {Tick[]} ticks\n\t * @private\n\t */\n  _convertTicksToLabels(ticks) {\n    this.beforeTickToLabelConversion();\n\n    this.generateTickLabels(ticks);\n\n    // Ticks should be skipped when callback returns null or undef, so lets remove those.\n    let i, ilen;\n    for (i = 0, ilen = ticks.length; i < ilen; i++) {\n      if (isNullOrUndef(ticks[i].label)) {\n        ticks.splice(i, 1);\n        ilen--;\n        i--;\n      }\n    }\n\n    this.afterTickToLabelConversion();\n  }\n\n  /**\n\t * @return {{ first: object, last: object, widest: object, highest: object, widths: Array, heights: array }}\n\t * @private\n\t */\n  _getLabelSizes() {\n    let labelSizes = this._labelSizes;\n\n    if (!labelSizes) {\n      const sampleSize = this.options.ticks.sampleSize;\n      let ticks = this.ticks;\n      if (sampleSize < ticks.length) {\n        ticks = sample(ticks, sampleSize);\n      }\n\n      this._labelSizes = labelSizes = this._computeLabelSizes(ticks, ticks.length);\n    }\n\n    return labelSizes;\n  }\n\n  /**\n\t * Returns {width, height, offset} objects for the first, last, widest, highest tick\n\t * labels where offset indicates the anchor point offset from the top in pixels.\n\t * @return {{ first: object, last: object, widest: object, highest: object, widths: Array, heights: array }}\n\t * @private\n\t */\n  _computeLabelSizes(ticks, length) {\n    const {ctx, _longestTextCache: caches} = this;\n    const widths = [];\n    const heights = [];\n    let widestLabelSize = 0;\n    let highestLabelSize = 0;\n    let i, j, jlen, label, tickFont, fontString, cache, lineHeight, width, height, nestedLabel;\n\n    for (i = 0; i < length; ++i) {\n      label = ticks[i].label;\n      tickFont = this._resolveTickFontOptions(i);\n      ctx.font = fontString = tickFont.string;\n      cache = caches[fontString] = caches[fontString] || {data: {}, gc: []};\n      lineHeight = tickFont.lineHeight;\n      width = height = 0;\n      // Undefined labels and arrays should not be measured\n      if (!isNullOrUndef(label) && !isArray(label)) {\n        width = _measureText(ctx, cache.data, cache.gc, width, label);\n        height = lineHeight;\n      } else if (isArray(label)) {\n        // if it is an array let's measure each element\n        for (j = 0, jlen = label.length; j < jlen; ++j) {\n          nestedLabel = label[j];\n          // Undefined labels and arrays should not be measured\n          if (!isNullOrUndef(nestedLabel) && !isArray(nestedLabel)) {\n            width = _measureText(ctx, cache.data, cache.gc, width, nestedLabel);\n            height += lineHeight;\n          }\n        }\n      }\n      widths.push(width);\n      heights.push(height);\n      widestLabelSize = Math.max(width, widestLabelSize);\n      highestLabelSize = Math.max(height, highestLabelSize);\n    }\n    garbageCollect(caches, length);\n\n    const widest = widths.indexOf(widestLabelSize);\n    const highest = heights.indexOf(highestLabelSize);\n\n    const valueAt = (idx) => ({width: widths[idx] || 0, height: heights[idx] || 0});\n\n    return {\n      first: valueAt(0),\n      last: valueAt(length - 1),\n      widest: valueAt(widest),\n      highest: valueAt(highest),\n      widths,\n      heights,\n    };\n  }\n\n  /**\n\t * Used to get the label to display in the tooltip for the given value\n\t * @param {*} value\n\t * @return {string}\n\t */\n  getLabelForValue(value) {\n    return value;\n  }\n\n  /**\n\t * Returns the location of the given data point. Value can either be an index or a numerical value\n\t * The coordinate (0, 0) is at the upper-left corner of the canvas\n\t * @param {*} value\n\t * @param {number} [index]\n\t * @return {number}\n\t */\n  getPixelForValue(value, index) { // eslint-disable-line no-unused-vars\n    return NaN;\n  }\n\n  /**\n\t * Used to get the data value from a given pixel. This is the inverse of getPixelForValue\n\t * The coordinate (0, 0) is at the upper-left corner of the canvas\n\t * @param {number} pixel\n\t * @return {*}\n\t */\n  getValueForPixel(pixel) {} // eslint-disable-line no-unused-vars\n\n  /**\n\t * Returns the location of the tick at the given index\n\t * The coordinate (0, 0) is at the upper-left corner of the canvas\n\t * @param {number} index\n\t * @return {number}\n\t */\n  getPixelForTick(index) {\n    const ticks = this.ticks;\n    if (index < 0 || index > ticks.length - 1) {\n      return null;\n    }\n    return this.getPixelForValue(ticks[index].value);\n  }\n\n  /**\n\t * Utility for getting the pixel location of a percentage of scale\n\t * The coordinate (0, 0) is at the upper-left corner of the canvas\n\t * @param {number} decimal\n\t * @return {number}\n\t */\n  getPixelForDecimal(decimal) {\n    if (this._reversePixels) {\n      decimal = 1 - decimal;\n    }\n\n    const pixel = this._startPixel + decimal * this._length;\n    return _int16Range(this._alignToPixels ? _alignPixel(this.chart, pixel, 0) : pixel);\n  }\n\n  /**\n\t * @param {number} pixel\n\t * @return {number}\n\t */\n  getDecimalForPixel(pixel) {\n    const decimal = (pixel - this._startPixel) / this._length;\n    return this._reversePixels ? 1 - decimal : decimal;\n  }\n\n  /**\n\t * Returns the pixel for the minimum chart value\n\t * The coordinate (0, 0) is at the upper-left corner of the canvas\n\t * @return {number}\n\t */\n  getBasePixel() {\n    return this.getPixelForValue(this.getBaseValue());\n  }\n\n  /**\n\t * @return {number}\n\t */\n  getBaseValue() {\n    const {min, max} = this;\n\n    return min < 0 && max < 0 ? max :\n      min > 0 && max > 0 ? min :\n      0;\n  }\n\n  /**\n\t * @protected\n\t */\n  getContext(index) {\n    const ticks = this.ticks || [];\n\n    if (index >= 0 && index < ticks.length) {\n      const tick = ticks[index];\n      return tick.$context ||\n\t\t\t\t(tick.$context = createTickContext(this.getContext(), index, tick));\n    }\n    return this.$context ||\n\t\t\t(this.$context = createScaleContext(this.chart.getContext(), this));\n  }\n\n  /**\n\t * @return {number}\n\t * @private\n\t */\n  _tickSize() {\n    const optionTicks = this.options.ticks;\n\n    // Calculate space needed by label in axis direction.\n    const rot = toRadians(this.labelRotation);\n    const cos = Math.abs(Math.cos(rot));\n    const sin = Math.abs(Math.sin(rot));\n\n    const labelSizes = this._getLabelSizes();\n    const padding = optionTicks.autoSkipPadding || 0;\n    const w = labelSizes ? labelSizes.widest.width + padding : 0;\n    const h = labelSizes ? labelSizes.highest.height + padding : 0;\n\n    // Calculate space needed for 1 tick in axis direction.\n    return this.isHorizontal()\n      ? h * cos > w * sin ? w / cos : h / sin\n      : h * sin < w * cos ? h / cos : w / sin;\n  }\n\n  /**\n\t * @return {boolean}\n\t * @private\n\t */\n  _isVisible() {\n    const display = this.options.display;\n\n    if (display !== 'auto') {\n      return !!display;\n    }\n\n    return this.getMatchingVisibleMetas().length > 0;\n  }\n\n  /**\n\t * @private\n\t */\n  _computeGridLineItems(chartArea) {\n    const axis = this.axis;\n    const chart = this.chart;\n    const options = this.options;\n    const {grid, position, border} = options;\n    const offset = grid.offset;\n    const isHorizontal = this.isHorizontal();\n    const ticks = this.ticks;\n    const ticksLength = ticks.length + (offset ? 1 : 0);\n    const tl = getTickMarkLength(grid);\n    const items = [];\n\n    const borderOpts = border.setContext(this.getContext());\n    const axisWidth = borderOpts.display ? borderOpts.width : 0;\n    const axisHalfWidth = axisWidth / 2;\n    const alignBorderValue = function(pixel) {\n      return _alignPixel(chart, pixel, axisWidth);\n    };\n    let borderValue, i, lineValue, alignedLineValue;\n    let tx1, ty1, tx2, ty2, x1, y1, x2, y2;\n\n    if (position === 'top') {\n      borderValue = alignBorderValue(this.bottom);\n      ty1 = this.bottom - tl;\n      ty2 = borderValue - axisHalfWidth;\n      y1 = alignBorderValue(chartArea.top) + axisHalfWidth;\n      y2 = chartArea.bottom;\n    } else if (position === 'bottom') {\n      borderValue = alignBorderValue(this.top);\n      y1 = chartArea.top;\n      y2 = alignBorderValue(chartArea.bottom) - axisHalfWidth;\n      ty1 = borderValue + axisHalfWidth;\n      ty2 = this.top + tl;\n    } else if (position === 'left') {\n      borderValue = alignBorderValue(this.right);\n      tx1 = this.right - tl;\n      tx2 = borderValue - axisHalfWidth;\n      x1 = alignBorderValue(chartArea.left) + axisHalfWidth;\n      x2 = chartArea.right;\n    } else if (position === 'right') {\n      borderValue = alignBorderValue(this.left);\n      x1 = chartArea.left;\n      x2 = alignBorderValue(chartArea.right) - axisHalfWidth;\n      tx1 = borderValue + axisHalfWidth;\n      tx2 = this.left + tl;\n    } else if (axis === 'x') {\n      if (position === 'center') {\n        borderValue = alignBorderValue((chartArea.top + chartArea.bottom) / 2 + 0.5);\n      } else if (isObject(position)) {\n        const positionAxisID = Object.keys(position)[0];\n        const value = position[positionAxisID];\n        borderValue = alignBorderValue(this.chart.scales[positionAxisID].getPixelForValue(value));\n      }\n\n      y1 = chartArea.top;\n      y2 = chartArea.bottom;\n      ty1 = borderValue + axisHalfWidth;\n      ty2 = ty1 + tl;\n    } else if (axis === 'y') {\n      if (position === 'center') {\n        borderValue = alignBorderValue((chartArea.left + chartArea.right) / 2);\n      } else if (isObject(position)) {\n        const positionAxisID = Object.keys(position)[0];\n        const value = position[positionAxisID];\n        borderValue = alignBorderValue(this.chart.scales[positionAxisID].getPixelForValue(value));\n      }\n\n      tx1 = borderValue - axisHalfWidth;\n      tx2 = tx1 - tl;\n      x1 = chartArea.left;\n      x2 = chartArea.right;\n    }\n\n    const limit = valueOrDefault(options.ticks.maxTicksLimit, ticksLength);\n    const step = Math.max(1, Math.ceil(ticksLength / limit));\n    for (i = 0; i < ticksLength; i += step) {\n      const context = this.getContext(i);\n      const optsAtIndex = grid.setContext(context);\n      const optsAtIndexBorder = border.setContext(context);\n\n      const lineWidth = optsAtIndex.lineWidth;\n      const lineColor = optsAtIndex.color;\n      const borderDash = optsAtIndexBorder.dash || [];\n      const borderDashOffset = optsAtIndexBorder.dashOffset;\n\n      const tickWidth = optsAtIndex.tickWidth;\n      const tickColor = optsAtIndex.tickColor;\n      const tickBorderDash = optsAtIndex.tickBorderDash || [];\n      const tickBorderDashOffset = optsAtIndex.tickBorderDashOffset;\n\n      lineValue = getPixelForGridLine(this, i, offset);\n\n      // Skip if the pixel is out of the range\n      if (lineValue === undefined) {\n        continue;\n      }\n\n      alignedLineValue = _alignPixel(chart, lineValue, lineWidth);\n\n      if (isHorizontal) {\n        tx1 = tx2 = x1 = x2 = alignedLineValue;\n      } else {\n        ty1 = ty2 = y1 = y2 = alignedLineValue;\n      }\n\n      items.push({\n        tx1,\n        ty1,\n        tx2,\n        ty2,\n        x1,\n        y1,\n        x2,\n        y2,\n        width: lineWidth,\n        color: lineColor,\n        borderDash,\n        borderDashOffset,\n        tickWidth,\n        tickColor,\n        tickBorderDash,\n        tickBorderDashOffset,\n      });\n    }\n\n    this._ticksLength = ticksLength;\n    this._borderValue = borderValue;\n\n    return items;\n  }\n\n  /**\n\t * @private\n\t */\n  _computeLabelItems(chartArea) {\n    const axis = this.axis;\n    const options = this.options;\n    const {position, ticks: optionTicks} = options;\n    const isHorizontal = this.isHorizontal();\n    const ticks = this.ticks;\n    const {align, crossAlign, padding, mirror} = optionTicks;\n    const tl = getTickMarkLength(options.grid);\n    const tickAndPadding = tl + padding;\n    const hTickAndPadding = mirror ? -padding : tickAndPadding;\n    const rotation = -toRadians(this.labelRotation);\n    const items = [];\n    let i, ilen, tick, label, x, y, textAlign, pixel, font, lineHeight, lineCount, textOffset;\n    let textBaseline = 'middle';\n\n    if (position === 'top') {\n      y = this.bottom - hTickAndPadding;\n      textAlign = this._getXAxisLabelAlignment();\n    } else if (position === 'bottom') {\n      y = this.top + hTickAndPadding;\n      textAlign = this._getXAxisLabelAlignment();\n    } else if (position === 'left') {\n      const ret = this._getYAxisLabelAlignment(tl);\n      textAlign = ret.textAlign;\n      x = ret.x;\n    } else if (position === 'right') {\n      const ret = this._getYAxisLabelAlignment(tl);\n      textAlign = ret.textAlign;\n      x = ret.x;\n    } else if (axis === 'x') {\n      if (position === 'center') {\n        y = ((chartArea.top + chartArea.bottom) / 2) + tickAndPadding;\n      } else if (isObject(position)) {\n        const positionAxisID = Object.keys(position)[0];\n        const value = position[positionAxisID];\n        y = this.chart.scales[positionAxisID].getPixelForValue(value) + tickAndPadding;\n      }\n      textAlign = this._getXAxisLabelAlignment();\n    } else if (axis === 'y') {\n      if (position === 'center') {\n        x = ((chartArea.left + chartArea.right) / 2) - tickAndPadding;\n      } else if (isObject(position)) {\n        const positionAxisID = Object.keys(position)[0];\n        const value = position[positionAxisID];\n        x = this.chart.scales[positionAxisID].getPixelForValue(value);\n      }\n      textAlign = this._getYAxisLabelAlignment(tl).textAlign;\n    }\n\n    if (axis === 'y') {\n      if (align === 'start') {\n        textBaseline = 'top';\n      } else if (align === 'end') {\n        textBaseline = 'bottom';\n      }\n    }\n\n    const labelSizes = this._getLabelSizes();\n    for (i = 0, ilen = ticks.length; i < ilen; ++i) {\n      tick = ticks[i];\n      label = tick.label;\n\n      const optsAtIndex = optionTicks.setContext(this.getContext(i));\n      pixel = this.getPixelForTick(i) + optionTicks.labelOffset;\n      font = this._resolveTickFontOptions(i);\n      lineHeight = font.lineHeight;\n      lineCount = isArray(label) ? label.length : 1;\n      const halfCount = lineCount / 2;\n      const color = optsAtIndex.color;\n      const strokeColor = optsAtIndex.textStrokeColor;\n      const strokeWidth = optsAtIndex.textStrokeWidth;\n      let tickTextAlign = textAlign;\n\n      if (isHorizontal) {\n        x = pixel;\n\n        if (textAlign === 'inner') {\n          if (i === ilen - 1) {\n            tickTextAlign = !this.options.reverse ? 'right' : 'left';\n          } else if (i === 0) {\n            tickTextAlign = !this.options.reverse ? 'left' : 'right';\n          } else {\n            tickTextAlign = 'center';\n          }\n        }\n\n        if (position === 'top') {\n          if (crossAlign === 'near' || rotation !== 0) {\n            textOffset = -lineCount * lineHeight + lineHeight / 2;\n          } else if (crossAlign === 'center') {\n            textOffset = -labelSizes.highest.height / 2 - halfCount * lineHeight + lineHeight;\n          } else {\n            textOffset = -labelSizes.highest.height + lineHeight / 2;\n          }\n        } else {\n          // eslint-disable-next-line no-lonely-if\n          if (crossAlign === 'near' || rotation !== 0) {\n            textOffset = lineHeight / 2;\n          } else if (crossAlign === 'center') {\n            textOffset = labelSizes.highest.height / 2 - halfCount * lineHeight;\n          } else {\n            textOffset = labelSizes.highest.height - lineCount * lineHeight;\n          }\n        }\n        if (mirror) {\n          textOffset *= -1;\n        }\n        if (rotation !== 0 && !optsAtIndex.showLabelBackdrop) {\n          x += (lineHeight / 2) * Math.sin(rotation);\n        }\n      } else {\n        y = pixel;\n        textOffset = (1 - lineCount) * lineHeight / 2;\n      }\n\n      let backdrop;\n\n      if (optsAtIndex.showLabelBackdrop) {\n        const labelPadding = toPadding(optsAtIndex.backdropPadding);\n        const height = labelSizes.heights[i];\n        const width = labelSizes.widths[i];\n\n        let top = textOffset - labelPadding.top;\n        let left = 0 - labelPadding.left;\n\n        switch (textBaseline) {\n        case 'middle':\n          top -= height / 2;\n          break;\n        case 'bottom':\n          top -= height;\n          break;\n        default:\n          break;\n        }\n\n        switch (textAlign) {\n        case 'center':\n          left -= width / 2;\n          break;\n        case 'right':\n          left -= width;\n          break;\n        default:\n          break;\n        }\n\n        backdrop = {\n          left,\n          top,\n          width: width + labelPadding.width,\n          height: height + labelPadding.height,\n\n          color: optsAtIndex.backdropColor,\n        };\n      }\n\n      items.push({\n        rotation,\n        label,\n        font,\n        color,\n        strokeColor,\n        strokeWidth,\n        textOffset,\n        textAlign: tickTextAlign,\n        textBaseline,\n        translation: [x, y],\n        backdrop,\n      });\n    }\n\n    return items;\n  }\n\n  _getXAxisLabelAlignment() {\n    const {position, ticks} = this.options;\n    const rotation = -toRadians(this.labelRotation);\n\n    if (rotation) {\n      return position === 'top' ? 'left' : 'right';\n    }\n\n    let align = 'center';\n\n    if (ticks.align === 'start') {\n      align = 'left';\n    } else if (ticks.align === 'end') {\n      align = 'right';\n    } else if (ticks.align === 'inner') {\n      align = 'inner';\n    }\n\n    return align;\n  }\n\n  _getYAxisLabelAlignment(tl) {\n    const {position, ticks: {crossAlign, mirror, padding}} = this.options;\n    const labelSizes = this._getLabelSizes();\n    const tickAndPadding = tl + padding;\n    const widest = labelSizes.widest.width;\n\n    let textAlign;\n    let x;\n\n    if (position === 'left') {\n      if (mirror) {\n        x = this.right + padding;\n\n        if (crossAlign === 'near') {\n          textAlign = 'left';\n        } else if (crossAlign === 'center') {\n          textAlign = 'center';\n          x += (widest / 2);\n        } else {\n          textAlign = 'right';\n          x += widest;\n        }\n      } else {\n        x = this.right - tickAndPadding;\n\n        if (crossAlign === 'near') {\n          textAlign = 'right';\n        } else if (crossAlign === 'center') {\n          textAlign = 'center';\n          x -= (widest / 2);\n        } else {\n          textAlign = 'left';\n          x = this.left;\n        }\n      }\n    } else if (position === 'right') {\n      if (mirror) {\n        x = this.left + padding;\n\n        if (crossAlign === 'near') {\n          textAlign = 'right';\n        } else if (crossAlign === 'center') {\n          textAlign = 'center';\n          x -= (widest / 2);\n        } else {\n          textAlign = 'left';\n          x -= widest;\n        }\n      } else {\n        x = this.left + tickAndPadding;\n\n        if (crossAlign === 'near') {\n          textAlign = 'left';\n        } else if (crossAlign === 'center') {\n          textAlign = 'center';\n          x += widest / 2;\n        } else {\n          textAlign = 'right';\n          x = this.right;\n        }\n      }\n    } else {\n      textAlign = 'right';\n    }\n\n    return {textAlign, x};\n  }\n\n  /**\n\t * @private\n\t */\n  _computeLabelArea() {\n    if (this.options.ticks.mirror) {\n      return;\n    }\n\n    const chart = this.chart;\n    const position = this.options.position;\n\n    if (position === 'left' || position === 'right') {\n      return {top: 0, left: this.left, bottom: chart.height, right: this.right};\n    } if (position === 'top' || position === 'bottom') {\n      return {top: this.top, left: 0, bottom: this.bottom, right: chart.width};\n    }\n  }\n\n  /**\n   * @protected\n   */\n  drawBackground() {\n    const {ctx, options: {backgroundColor}, left, top, width, height} = this;\n    if (backgroundColor) {\n      ctx.save();\n      ctx.fillStyle = backgroundColor;\n      ctx.fillRect(left, top, width, height);\n      ctx.restore();\n    }\n  }\n\n  getLineWidthForValue(value) {\n    const grid = this.options.grid;\n    if (!this._isVisible() || !grid.display) {\n      return 0;\n    }\n    const ticks = this.ticks;\n    const index = ticks.findIndex(t => t.value === value);\n    if (index >= 0) {\n      const opts = grid.setContext(this.getContext(index));\n      return opts.lineWidth;\n    }\n    return 0;\n  }\n\n  /**\n\t * @protected\n\t */\n  drawGrid(chartArea) {\n    const grid = this.options.grid;\n    const ctx = this.ctx;\n    const items = this._gridLineItems || (this._gridLineItems = this._computeGridLineItems(chartArea));\n    let i, ilen;\n\n    const drawLine = (p1, p2, style) => {\n      if (!style.width || !style.color) {\n        return;\n      }\n      ctx.save();\n      ctx.lineWidth = style.width;\n      ctx.strokeStyle = style.color;\n      ctx.setLineDash(style.borderDash || []);\n      ctx.lineDashOffset = style.borderDashOffset;\n\n      ctx.beginPath();\n      ctx.moveTo(p1.x, p1.y);\n      ctx.lineTo(p2.x, p2.y);\n      ctx.stroke();\n      ctx.restore();\n    };\n\n    if (grid.display) {\n      for (i = 0, ilen = items.length; i < ilen; ++i) {\n        const item = items[i];\n\n        if (grid.drawOnChartArea) {\n          drawLine(\n            {x: item.x1, y: item.y1},\n            {x: item.x2, y: item.y2},\n            item\n          );\n        }\n\n        if (grid.drawTicks) {\n          drawLine(\n            {x: item.tx1, y: item.ty1},\n            {x: item.tx2, y: item.ty2},\n            {\n              color: item.tickColor,\n              width: item.tickWidth,\n              borderDash: item.tickBorderDash,\n              borderDashOffset: item.tickBorderDashOffset\n            }\n          );\n        }\n      }\n    }\n  }\n\n  /**\n\t * @protected\n\t */\n  drawBorder() {\n    const {chart, ctx, options: {border, grid}} = this;\n    const borderOpts = border.setContext(this.getContext());\n    const axisWidth = border.display ? borderOpts.width : 0;\n    if (!axisWidth) {\n      return;\n    }\n    const lastLineWidth = grid.setContext(this.getContext(0)).lineWidth;\n    const borderValue = this._borderValue;\n    let x1, x2, y1, y2;\n\n    if (this.isHorizontal()) {\n      x1 = _alignPixel(chart, this.left, axisWidth) - axisWidth / 2;\n      x2 = _alignPixel(chart, this.right, lastLineWidth) + lastLineWidth / 2;\n      y1 = y2 = borderValue;\n    } else {\n      y1 = _alignPixel(chart, this.top, axisWidth) - axisWidth / 2;\n      y2 = _alignPixel(chart, this.bottom, lastLineWidth) + lastLineWidth / 2;\n      x1 = x2 = borderValue;\n    }\n    ctx.save();\n    ctx.lineWidth = borderOpts.width;\n    ctx.strokeStyle = borderOpts.color;\n\n    ctx.beginPath();\n    ctx.moveTo(x1, y1);\n    ctx.lineTo(x2, y2);\n    ctx.stroke();\n\n    ctx.restore();\n  }\n\n  /**\n\t * @protected\n\t */\n  drawLabels(chartArea) {\n    const optionTicks = this.options.ticks;\n\n    if (!optionTicks.display) {\n      return;\n    }\n\n    const ctx = this.ctx;\n\n    const area = this._computeLabelArea();\n    if (area) {\n      clipArea(ctx, area);\n    }\n\n    const items = this._labelItems || (this._labelItems = this._computeLabelItems(chartArea));\n    let i, ilen;\n\n    for (i = 0, ilen = items.length; i < ilen; ++i) {\n      const item = items[i];\n      const tickFont = item.font;\n      const label = item.label;\n\n      let y = item.textOffset;\n      renderText(ctx, label, 0, y, tickFont, item);\n    }\n\n    if (area) {\n      unclipArea(ctx);\n    }\n  }\n\n  /**\n\t * @protected\n\t */\n  drawTitle() {\n    const {ctx, options: {position, title, reverse}} = this;\n\n    if (!title.display) {\n      return;\n    }\n\n    const font = toFont(title.font);\n    const padding = toPadding(title.padding);\n    const align = title.align;\n    let offset = font.lineHeight / 2;\n\n    if (position === 'bottom' || position === 'center' || isObject(position)) {\n      offset += padding.bottom;\n      if (isArray(title.text)) {\n        offset += font.lineHeight * (title.text.length - 1);\n      }\n    } else {\n      offset += padding.top;\n    }\n\n    const {titleX, titleY, maxWidth, rotation} = titleArgs(this, offset, position, align);\n\n    renderText(ctx, title.text, 0, 0, font, {\n      color: title.color,\n      maxWidth,\n      rotation,\n      textAlign: titleAlign(align, position, reverse),\n      textBaseline: 'middle',\n      translation: [titleX, titleY],\n    });\n  }\n\n  draw(chartArea) {\n    if (!this._isVisible()) {\n      return;\n    }\n\n    this.drawBackground();\n    this.drawGrid(chartArea);\n    this.drawBorder();\n    this.drawTitle();\n    this.drawLabels(chartArea);\n  }\n\n  /**\n\t * @return {object[]}\n\t * @private\n\t */\n  _layers() {\n    const opts = this.options;\n    const tz = opts.ticks && opts.ticks.z || 0;\n    const gz = valueOrDefault(opts.grid && opts.grid.z, -1);\n    const bz = valueOrDefault(opts.border && opts.border.z, 0);\n\n    if (!this._isVisible() || this.draw !== Scale.prototype.draw) {\n      // backward compatibility: draw has been overridden by custom scale\n      return [{\n        z: tz,\n        draw: (chartArea) => {\n          this.draw(chartArea);\n        }\n      }];\n    }\n\n    return [{\n      z: gz,\n      draw: (chartArea) => {\n        this.drawBackground();\n        this.drawGrid(chartArea);\n        this.drawTitle();\n      }\n    }, {\n      z: bz,\n      draw: () => {\n        this.drawBorder();\n      }\n    }, {\n      z: tz,\n      draw: (chartArea) => {\n        this.drawLabels(chartArea);\n      }\n    }];\n  }\n\n  /**\n\t * Returns visible dataset metas that are attached to this scale\n\t * @param {string} [type] - if specified, also filter by dataset type\n\t * @return {object[]}\n\t */\n  getMatchingVisibleMetas(type) {\n    const metas = this.chart.getSortedVisibleDatasetMetas();\n    const axisID = this.axis + 'AxisID';\n    const result = [];\n    let i, ilen;\n\n    for (i = 0, ilen = metas.length; i < ilen; ++i) {\n      const meta = metas[i];\n      if (meta[axisID] === this.id && (!type || meta.type === type)) {\n        result.push(meta);\n      }\n    }\n    return result;\n  }\n\n  /**\n\t * @param {number} index\n\t * @return {object}\n\t * @protected\n \t */\n  _resolveTickFontOptions(index) {\n    const opts = this.options.ticks.setContext(this.getContext(index));\n    return toFont(opts.font);\n  }\n\n  /**\n   * @protected\n   */\n  _maxDigits() {\n    const fontSize = this._resolveTickFontOptions(0).lineHeight;\n    return (this.isHorizontal() ? this.width : this.height) / fontSize;\n  }\n}\n","import {merge} from '../helpers';\nimport defaults, {overrides} from './core.defaults';\n\n/**\n * @typedef {{id: string, defaults: any, overrides?: any, defaultRoutes: any}} IChartComponent\n */\n\nexport default class TypedRegistry {\n  constructor(type, scope, override) {\n    this.type = type;\n    this.scope = scope;\n    this.override = override;\n    this.items = Object.create(null);\n  }\n\n  isForType(type) {\n    return Object.prototype.isPrototypeOf.call(this.type.prototype, type.prototype);\n  }\n\n  /**\n\t * @param {IChartComponent} item\n\t * @returns {string} The scope where items defaults were registered to.\n\t */\n  register(item) {\n    const proto = Object.getPrototypeOf(item);\n    let parentScope;\n\n    if (isIChartComponent(proto)) {\n      // Make sure the parent is registered and note the scope where its defaults are.\n      parentScope = this.register(proto);\n    }\n\n    const items = this.items;\n    const id = item.id;\n    const scope = this.scope + '.' + id;\n\n    if (!id) {\n      throw new Error('class does not have id: ' + item);\n    }\n\n    if (id in items) {\n      // already registered\n      return scope;\n    }\n\n    items[id] = item;\n    registerDefaults(item, scope, parentScope);\n    if (this.override) {\n      defaults.override(item.id, item.overrides);\n    }\n\n    return scope;\n  }\n\n  /**\n\t * @param {string} id\n\t * @returns {object?}\n\t */\n  get(id) {\n    return this.items[id];\n  }\n\n  /**\n\t * @param {IChartComponent} item\n\t */\n  unregister(item) {\n    const items = this.items;\n    const id = item.id;\n    const scope = this.scope;\n\n    if (id in items) {\n      delete items[id];\n    }\n\n    if (scope && id in defaults[scope]) {\n      delete defaults[scope][id];\n      if (this.override) {\n        delete overrides[id];\n      }\n    }\n  }\n}\n\nfunction registerDefaults(item, scope, parentScope) {\n  // Inherit the parent's defaults and keep existing defaults\n  const itemDefaults = merge(Object.create(null), [\n    parentScope ? defaults.get(parentScope) : {},\n    defaults.get(scope),\n    item.defaults\n  ]);\n\n  defaults.set(scope, itemDefaults);\n\n  if (item.defaultRoutes) {\n    routeDefaults(scope, item.defaultRoutes);\n  }\n\n  if (item.descriptors) {\n    defaults.describe(scope, item.descriptors);\n  }\n}\n\nfunction routeDefaults(scope, routes) {\n  Object.keys(routes).forEach(property => {\n    const propertyParts = property.split('.');\n    const sourceName = propertyParts.pop();\n    const sourceScope = [scope].concat(propertyParts).join('.');\n    const parts = routes[property].split('.');\n    const targetName = parts.pop();\n    const targetScope = parts.join('.');\n    defaults.route(sourceScope, sourceName, targetScope, targetName);\n  });\n}\n\nfunction isIChartComponent(proto) {\n  return 'id' in proto && 'defaults' in proto;\n}\n","import DatasetController from './core.datasetController';\nimport Element from './core.element';\nimport Scale from './core.scale';\nimport TypedRegistry from './core.typedRegistry';\nimport {each, callback as call, _capitalize} from '../helpers/helpers.core';\n\n/**\n * Please use the module's default export which provides a singleton instance\n * Note: class is exported for typedoc\n */\nexport class Registry {\n  constructor() {\n    this.controllers = new TypedRegistry(DatasetController, 'datasets', true);\n    this.elements = new TypedRegistry(Element, 'elements');\n    this.plugins = new TypedRegistry(Object, 'plugins');\n    this.scales = new TypedRegistry(Scale, 'scales');\n    // Order is important, Scale has Element in prototype chain,\n    // so Scales must be before Elements. Plugins are a fallback, so not listed here.\n    this._typedRegistries = [this.controllers, this.scales, this.elements];\n  }\n\n  /**\n\t * @param  {...any} args\n\t */\n  add(...args) {\n    this._each('register', args);\n  }\n\n  remove(...args) {\n    this._each('unregister', args);\n  }\n\n  /**\n\t * @param  {...typeof DatasetController} args\n\t */\n  addControllers(...args) {\n    this._each('register', args, this.controllers);\n  }\n\n  /**\n\t * @param  {...typeof Element} args\n\t */\n  addElements(...args) {\n    this._each('register', args, this.elements);\n  }\n\n  /**\n\t * @param  {...any} args\n\t */\n  addPlugins(...args) {\n    this._each('register', args, this.plugins);\n  }\n\n  /**\n\t * @param  {...typeof Scale} args\n\t */\n  addScales(...args) {\n    this._each('register', args, this.scales);\n  }\n\n  /**\n\t * @param {string} id\n\t * @returns {typeof DatasetController}\n\t */\n  getController(id) {\n    return this._get(id, this.controllers, 'controller');\n  }\n\n  /**\n\t * @param {string} id\n\t * @returns {typeof Element}\n\t */\n  getElement(id) {\n    return this._get(id, this.elements, 'element');\n  }\n\n  /**\n\t * @param {string} id\n\t * @returns {object}\n\t */\n  getPlugin(id) {\n    return this._get(id, this.plugins, 'plugin');\n  }\n\n  /**\n\t * @param {string} id\n\t * @returns {typeof Scale}\n\t */\n  getScale(id) {\n    return this._get(id, this.scales, 'scale');\n  }\n\n  /**\n\t * @param  {...typeof DatasetController} args\n\t */\n  removeControllers(...args) {\n    this._each('unregister', args, this.controllers);\n  }\n\n  /**\n\t * @param  {...typeof Element} args\n\t */\n  removeElements(...args) {\n    this._each('unregister', args, this.elements);\n  }\n\n  /**\n\t * @param  {...any} args\n\t */\n  removePlugins(...args) {\n    this._each('unregister', args, this.plugins);\n  }\n\n  /**\n\t * @param  {...typeof Scale} args\n\t */\n  removeScales(...args) {\n    this._each('unregister', args, this.scales);\n  }\n\n  /**\n\t * @private\n\t */\n  _each(method, args, typedRegistry) {\n    [...args].forEach(arg => {\n      const reg = typedRegistry || this._getRegistryForType(arg);\n      if (typedRegistry || reg.isForType(arg) || (reg === this.plugins && arg.id)) {\n        this._exec(method, reg, arg);\n      } else {\n        // Handle loopable args\n        // Use case:\n        //  import * as plugins from './plugins';\n        //  Chart.register(plugins);\n        each(arg, item => {\n          // If there are mixed types in the loopable, make sure those are\n          // registered in correct registry\n          // Use case: (treemap exporting controller, elements etc)\n          //  import * as treemap from 'chartjs-chart-treemap';\n          //  Chart.register(treemap);\n\n          const itemReg = typedRegistry || this._getRegistryForType(item);\n          this._exec(method, itemReg, item);\n        });\n      }\n    });\n  }\n\n  /**\n\t * @private\n\t */\n  _exec(method, registry, component) {\n    const camelMethod = _capitalize(method);\n    call(component['before' + camelMethod], [], component); // beforeRegister / beforeUnregister\n    registry[method](component);\n    call(component['after' + camelMethod], [], component); // afterRegister / afterUnregister\n  }\n\n  /**\n\t * @private\n\t */\n  _getRegistryForType(type) {\n    for (let i = 0; i < this._typedRegistries.length; i++) {\n      const reg = this._typedRegistries[i];\n      if (reg.isForType(type)) {\n        return reg;\n      }\n    }\n    // plugins is the fallback registry\n    return this.plugins;\n  }\n\n  /**\n\t * @private\n\t */\n  _get(id, typedRegistry, type) {\n    const item = typedRegistry.get(id);\n    if (item === undefined) {\n      throw new Error('\"' + id + '\" is not a registered ' + type + '.');\n    }\n    return item;\n  }\n\n}\n\n// singleton instance\nexport default /* #__PURE__ */ new Registry();\n","import registry from './core.registry';\nimport {callback as callCallback, isNullOrUndef, valueOrDefault} from '../helpers/helpers.core';\n\n/**\n * @typedef { import(\"./core.controller\").default } Chart\n * @typedef { import(\"../../types\").ChartEvent } ChartEvent\n * @typedef { import(\"../plugins/plugin.tooltip\").default } Tooltip\n */\n\n/**\n * @callback filterCallback\n * @param {{plugin: object, options: object}} value\n * @param {number} [index]\n * @param {array} [array]\n * @param {object} [thisArg]\n * @return {boolean}\n */\n\n\nexport default class PluginService {\n  constructor() {\n    this._init = [];\n  }\n\n  /**\n\t * Calls enabled plugins for `chart` on the specified hook and with the given args.\n\t * This method immediately returns as soon as a plugin explicitly returns false. The\n\t * returned value can be used, for instance, to interrupt the current action.\n\t * @param {Chart} chart - The chart instance for which plugins should be called.\n\t * @param {string} hook - The name of the plugin method to call (e.g. 'beforeUpdate').\n\t * @param {object} [args] - Extra arguments to apply to the hook call.\n   * @param {filterCallback} [filter] - Filtering function for limiting which plugins are notified\n\t * @returns {boolean} false if any of the plugins return false, else returns true.\n\t */\n  notify(chart, hook, args, filter) {\n    if (hook === 'beforeInit') {\n      this._init = this._createDescriptors(chart, true);\n      this._notify(this._init, chart, 'install');\n    }\n\n    const descriptors = filter ? this._descriptors(chart).filter(filter) : this._descriptors(chart);\n    const result = this._notify(descriptors, chart, hook, args);\n\n    if (hook === 'afterDestroy') {\n      this._notify(descriptors, chart, 'stop');\n      this._notify(this._init, chart, 'uninstall');\n    }\n    return result;\n  }\n\n  /**\n\t * @private\n\t */\n  _notify(descriptors, chart, hook, args) {\n    args = args || {};\n    for (const descriptor of descriptors) {\n      const plugin = descriptor.plugin;\n      const method = plugin[hook];\n      const params = [chart, args, descriptor.options];\n      if (callCallback(method, params, plugin) === false && args.cancelable) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  invalidate() {\n    // When plugins are registered, there is the possibility of a double\n    // invalidate situation. In this case, we only want to invalidate once.\n    // If we invalidate multiple times, the `_oldCache` is lost and all of the\n    // plugins are restarted without being correctly stopped.\n    // See https://github.com/chartjs/Chart.js/issues/8147\n    if (!isNullOrUndef(this._cache)) {\n      this._oldCache = this._cache;\n      this._cache = undefined;\n    }\n  }\n\n  /**\n\t * @param {Chart} chart\n\t * @private\n\t */\n  _descriptors(chart) {\n    if (this._cache) {\n      return this._cache;\n    }\n\n    const descriptors = this._cache = this._createDescriptors(chart);\n\n    this._notifyStateChanges(chart);\n\n    return descriptors;\n  }\n\n  _createDescriptors(chart, all) {\n    const config = chart && chart.config;\n    const options = valueOrDefault(config.options && config.options.plugins, {});\n    const plugins = allPlugins(config);\n    // options === false => all plugins are disabled\n    return options === false && !all ? [] : createDescriptors(chart, plugins, options, all);\n  }\n\n  /**\n\t * @param {Chart} chart\n\t * @private\n\t */\n  _notifyStateChanges(chart) {\n    const previousDescriptors = this._oldCache || [];\n    const descriptors = this._cache;\n    const diff = (a, b) => a.filter(x => !b.some(y => x.plugin.id === y.plugin.id));\n    this._notify(diff(previousDescriptors, descriptors), chart, 'stop');\n    this._notify(diff(descriptors, previousDescriptors), chart, 'start');\n  }\n}\n\n/**\n * @param {import(\"./core.config\").default} config\n */\nfunction allPlugins(config) {\n  const localIds = {};\n  const plugins = [];\n  const keys = Object.keys(registry.plugins.items);\n  for (let i = 0; i < keys.length; i++) {\n    plugins.push(registry.getPlugin(keys[i]));\n  }\n\n  const local = config.plugins || [];\n  for (let i = 0; i < local.length; i++) {\n    const plugin = local[i];\n\n    if (plugins.indexOf(plugin) === -1) {\n      plugins.push(plugin);\n      localIds[plugin.id] = true;\n    }\n  }\n\n  return {plugins, localIds};\n}\n\nfunction getOpts(options, all) {\n  if (!all && options === false) {\n    return null;\n  }\n  if (options === true) {\n    return {};\n  }\n  return options;\n}\n\nfunction createDescriptors(chart, {plugins, localIds}, options, all) {\n  const result = [];\n  const context = chart.getContext();\n\n  for (const plugin of plugins) {\n    const id = plugin.id;\n    const opts = getOpts(options[id], all);\n    if (opts === null) {\n      continue;\n    }\n    result.push({\n      plugin,\n      options: pluginOpts(chart.config, {plugin, local: localIds[id]}, opts, context)\n    });\n  }\n\n  return result;\n}\n\nfunction pluginOpts(config, {plugin, local}, opts, context) {\n  const keys = config.pluginScopeKeys(plugin);\n  const scopes = config.getOptionScopes(opts, keys);\n  if (local && plugin.defaults) {\n    // make sure plugin defaults are in scopes for local (not registered) plugins\n    scopes.push(plugin.defaults);\n  }\n  return config.createResolver(scopes, context, [''], {\n    // These are just defaults that plugins can override\n    scriptable: false,\n    indexable: false,\n    allKeys: true\n  });\n}\n","import defaults, {overrides, descriptors} from './core.defaults';\nimport {mergeIf, resolveObjectKey, isArray, isFunction, valueOrDefault, isObject} from '../helpers/helpers.core';\nimport {_attachContext, _createResolver, _descriptors} from '../helpers/helpers.config';\n\nexport function getIndexAxis(type, options) {\n  const datasetDefaults = defaults.datasets[type] || {};\n  const datasetOptions = (options.datasets || {})[type] || {};\n  return datasetOptions.indexAxis || options.indexAxis || datasetDefaults.indexAxis || 'x';\n}\n\nfunction getAxisFromDefaultScaleID(id, indexAxis) {\n  let axis = id;\n  if (id === '_index_') {\n    axis = indexAxis;\n  } else if (id === '_value_') {\n    axis = indexAxis === 'x' ? 'y' : 'x';\n  }\n  return axis;\n}\n\nfunction getDefaultScaleIDFromAxis(axis, indexAxis) {\n  return axis === indexAxis ? '_index_' : '_value_';\n}\n\nfunction axisFromPosition(position) {\n  if (position === 'top' || position === 'bottom') {\n    return 'x';\n  }\n  if (position === 'left' || position === 'right') {\n    return 'y';\n  }\n}\n\nexport function determineAxis(id, scaleOptions) {\n  if (id === 'x' || id === 'y' || id === 'r') {\n    return id;\n  }\n\n  id = scaleOptions.axis\n    || axisFromPosition(scaleOptions.position)\n    || id.length > 1 && determineAxis(id[0].toLowerCase(), scaleOptions);\n\n  if (id) {\n    return id;\n  }\n\n  throw new Error(`Cannot determine type of '${name}' axis. Please provide 'axis' or 'position' option.`);\n}\n\nfunction mergeScaleConfig(config, options) {\n  const chartDefaults = overrides[config.type] || {scales: {}};\n  const configScales = options.scales || {};\n  const chartIndexAxis = getIndexAxis(config.type, options);\n  const scales = Object.create(null);\n\n  // First figure out first scale id's per axis.\n  Object.keys(configScales).forEach(id => {\n    const scaleConf = configScales[id];\n    if (!isObject(scaleConf)) {\n      return console.error(`Invalid scale configuration for scale: ${id}`);\n    }\n    if (scaleConf._proxy) {\n      return console.warn(`Ignoring resolver passed as options for scale: ${id}`);\n    }\n    const axis = determineAxis(id, scaleConf);\n    const defaultId = getDefaultScaleIDFromAxis(axis, chartIndexAxis);\n    const defaultScaleOptions = chartDefaults.scales || {};\n    scales[id] = mergeIf(Object.create(null), [{axis}, scaleConf, defaultScaleOptions[axis], defaultScaleOptions[defaultId]]);\n  });\n\n  // Then merge dataset defaults to scale configs\n  config.data.datasets.forEach(dataset => {\n    const type = dataset.type || config.type;\n    const indexAxis = dataset.indexAxis || getIndexAxis(type, options);\n    const datasetDefaults = overrides[type] || {};\n    const defaultScaleOptions = datasetDefaults.scales || {};\n    Object.keys(defaultScaleOptions).forEach(defaultID => {\n      const axis = getAxisFromDefaultScaleID(defaultID, indexAxis);\n      const id = dataset[axis + 'AxisID'] || axis;\n      scales[id] = scales[id] || Object.create(null);\n      mergeIf(scales[id], [{axis}, configScales[id], defaultScaleOptions[defaultID]]);\n    });\n  });\n\n  // apply scale defaults, if not overridden by dataset defaults\n  Object.keys(scales).forEach(key => {\n    const scale = scales[key];\n    mergeIf(scale, [defaults.scales[scale.type], defaults.scale]);\n  });\n\n  return scales;\n}\n\nfunction initOptions(config) {\n  const options = config.options || (config.options = {});\n\n  options.plugins = valueOrDefault(options.plugins, {});\n  options.scales = mergeScaleConfig(config, options);\n}\n\nfunction initData(data) {\n  data = data || {};\n  data.datasets = data.datasets || [];\n  data.labels = data.labels || [];\n  return data;\n}\n\nfunction initConfig(config) {\n  config = config || {};\n  config.data = initData(config.data);\n\n  initOptions(config);\n\n  return config;\n}\n\nconst keyCache = new Map();\nconst keysCached = new Set();\n\nfunction cachedKeys(cacheKey, generate) {\n  let keys = keyCache.get(cacheKey);\n  if (!keys) {\n    keys = generate();\n    keyCache.set(cacheKey, keys);\n    keysCached.add(keys);\n  }\n  return keys;\n}\n\nconst addIfFound = (set, obj, key) => {\n  const opts = resolveObjectKey(obj, key);\n  if (opts !== undefined) {\n    set.add(opts);\n  }\n};\n\nexport default class Config {\n  constructor(config) {\n    this._config = initConfig(config);\n    this._scopeCache = new Map();\n    this._resolverCache = new Map();\n  }\n\n  get platform() {\n    return this._config.platform;\n  }\n\n  get type() {\n    return this._config.type;\n  }\n\n  set type(type) {\n    this._config.type = type;\n  }\n\n  get data() {\n    return this._config.data;\n  }\n\n  set data(data) {\n    this._config.data = initData(data);\n  }\n\n  get options() {\n    return this._config.options;\n  }\n\n  set options(options) {\n    this._config.options = options;\n  }\n\n  get plugins() {\n    return this._config.plugins;\n  }\n\n  update() {\n    const config = this._config;\n    this.clearCache();\n    initOptions(config);\n  }\n\n  clearCache() {\n    this._scopeCache.clear();\n    this._resolverCache.clear();\n  }\n\n  /**\n   * Returns the option scope keys for resolving dataset options.\n   * These keys do not include the dataset itself, because it is not under options.\n   * @param {string} datasetType\n   * @return {string[][]}\n   */\n  datasetScopeKeys(datasetType) {\n    return cachedKeys(datasetType,\n      () => [[\n        `datasets.${datasetType}`,\n        ''\n      ]]);\n  }\n\n  /**\n   * Returns the option scope keys for resolving dataset animation options.\n   * These keys do not include the dataset itself, because it is not under options.\n   * @param {string} datasetType\n   * @param {string} transition\n   * @return {string[][]}\n   */\n  datasetAnimationScopeKeys(datasetType, transition) {\n    return cachedKeys(`${datasetType}.transition.${transition}`,\n      () => [\n        [\n          `datasets.${datasetType}.transitions.${transition}`,\n          `transitions.${transition}`,\n        ],\n        // The following are used for looking up the `animations` and `animation` keys\n        [\n          `datasets.${datasetType}`,\n          ''\n        ]\n      ]);\n  }\n\n  /**\n   * Returns the options scope keys for resolving element options that belong\n   * to an dataset. These keys do not include the dataset itself, because it\n   * is not under options.\n   * @param {string} datasetType\n   * @param {string} elementType\n   * @return {string[][]}\n   */\n  datasetElementScopeKeys(datasetType, elementType) {\n    return cachedKeys(`${datasetType}-${elementType}`,\n      () => [[\n        `datasets.${datasetType}.elements.${elementType}`,\n        `datasets.${datasetType}`,\n        `elements.${elementType}`,\n        ''\n      ]]);\n  }\n\n  /**\n   * Returns the options scope keys for resolving plugin options.\n   * @param {{id: string, additionalOptionScopes?: string[]}} plugin\n   * @return {string[][]}\n   */\n  pluginScopeKeys(plugin) {\n    const id = plugin.id;\n    const type = this.type;\n    return cachedKeys(`${type}-plugin-${id}`,\n      () => [[\n        `plugins.${id}`,\n        ...plugin.additionalOptionScopes || [],\n      ]]);\n  }\n\n  /**\n   * @private\n   */\n  _cachedScopes(mainScope, resetCache) {\n    const _scopeCache = this._scopeCache;\n    let cache = _scopeCache.get(mainScope);\n    if (!cache || resetCache) {\n      cache = new Map();\n      _scopeCache.set(mainScope, cache);\n    }\n    return cache;\n  }\n\n  /**\n   * Resolves the objects from options and defaults for option value resolution.\n   * @param {object} mainScope - The main scope object for options\n   * @param {string[][]} keyLists - The arrays of keys in resolution order\n   * @param {boolean} [resetCache] - reset the cache for this mainScope\n   */\n  getOptionScopes(mainScope, keyLists, resetCache) {\n    const {options, type} = this;\n    const cache = this._cachedScopes(mainScope, resetCache);\n    const cached = cache.get(keyLists);\n    if (cached) {\n      return cached;\n    }\n\n    const scopes = new Set();\n\n    keyLists.forEach(keys => {\n      if (mainScope) {\n        scopes.add(mainScope);\n        keys.forEach(key => addIfFound(scopes, mainScope, key));\n      }\n      keys.forEach(key => addIfFound(scopes, options, key));\n      keys.forEach(key => addIfFound(scopes, overrides[type] || {}, key));\n      keys.forEach(key => addIfFound(scopes, defaults, key));\n      keys.forEach(key => addIfFound(scopes, descriptors, key));\n    });\n\n    const array = Array.from(scopes);\n    if (array.length === 0) {\n      array.push(Object.create(null));\n    }\n    if (keysCached.has(keyLists)) {\n      cache.set(keyLists, array);\n    }\n    return array;\n  }\n\n  /**\n   * Returns the option scopes for resolving chart options\n   * @return {object[]}\n   */\n  chartOptionScopes() {\n    const {options, type} = this;\n\n    return [\n      options,\n      overrides[type] || {},\n      defaults.datasets[type] || {}, // https://github.com/chartjs/Chart.js/issues/8531\n      {type},\n      defaults,\n      descriptors\n    ];\n  }\n\n  /**\n   * @param {object[]} scopes\n   * @param {string[]} names\n   * @param {function|object} context\n   * @param {string[]} [prefixes]\n   * @return {object}\n   */\n  resolveNamedOptions(scopes, names, context, prefixes = ['']) {\n    const result = {$shared: true};\n    const {resolver, subPrefixes} = getResolver(this._resolverCache, scopes, prefixes);\n    let options = resolver;\n    if (needContext(resolver, names)) {\n      result.$shared = false;\n      context = isFunction(context) ? context() : context;\n      // subResolver is passed to scriptable options. It should not resolve to hover options.\n      const subResolver = this.createResolver(scopes, context, subPrefixes);\n      options = _attachContext(resolver, context, subResolver);\n    }\n\n    for (const prop of names) {\n      result[prop] = options[prop];\n    }\n    return result;\n  }\n\n  /**\n   * @param {object[]} scopes\n   * @param {object} [context]\n   * @param {string[]} [prefixes]\n   * @param {{scriptable: boolean, indexable: boolean, allKeys?: boolean}} [descriptorDefaults]\n   */\n  createResolver(scopes, context, prefixes = [''], descriptorDefaults) {\n    const {resolver} = getResolver(this._resolverCache, scopes, prefixes);\n    return isObject(context)\n      ? _attachContext(resolver, context, undefined, descriptorDefaults)\n      : resolver;\n  }\n}\n\nfunction getResolver(resolverCache, scopes, prefixes) {\n  let cache = resolverCache.get(scopes);\n  if (!cache) {\n    cache = new Map();\n    resolverCache.set(scopes, cache);\n  }\n  const cacheKey = prefixes.join();\n  let cached = cache.get(cacheKey);\n  if (!cached) {\n    const resolver = _createResolver(scopes, prefixes);\n    cached = {\n      resolver,\n      subPrefixes: prefixes.filter(p => !p.toLowerCase().includes('hover'))\n    };\n    cache.set(cacheKey, cached);\n  }\n  return cached;\n}\n\nconst hasFunction = value => isObject(value)\n  && Object.getOwnPropertyNames(value).reduce((acc, key) => acc || isFunction(value[key]), false);\n\nfunction needContext(proxy, names) {\n  const {isScriptable, isIndexable} = _descriptors(proxy);\n\n  for (const prop of names) {\n    const scriptable = isScriptable(prop);\n    const indexable = isIndexable(prop);\n    const value = (indexable || scriptable) && proxy[prop];\n    if ((scriptable && (isFunction(value) || hasFunction(value)))\n      || (indexable && isArray(value))) {\n      return true;\n    }\n  }\n  return false;\n}\n","import animator from './core.animator';\nimport defaults, {overrides} from './core.defaults';\nimport Interaction from './core.interaction';\nimport layouts from './core.layouts';\nimport {_detectPlatform} from '../platform';\nimport PluginService from './core.plugins';\nimport registry from './core.registry';\nimport Config, {determineAxis, getIndexAxis} from './core.config';\nimport {retinaScale, _isDomSupported} from '../helpers/helpers.dom';\nimport {each, callback as callCallback, uid, valueOrDefault, _elementsEqual, isNullOrUndef, setsEqual, defined, isFunction, _isClickEvent} from '../helpers/helpers.core';\nimport {clearCanvas, clipArea, createContext, unclipArea, _isPointInArea} from '../helpers';\n// @ts-ignore\nimport {version} from '../../package.json';\nimport {debounce} from '../helpers/helpers.extras';\n\n/**\n * @typedef { import('../../types').ChartEvent } ChartEvent\n * @typedef { import(\"../../types\").Point } Point\n */\n\nconst KNOWN_POSITIONS = ['top', 'bottom', 'left', 'right', 'chartArea'];\nfunction positionIsHorizontal(position, axis) {\n  return position === 'top' || position === 'bottom' || (KNOWN_POSITIONS.indexOf(position) === -1 && axis === 'x');\n}\n\nfunction compare2Level(l1, l2) {\n  return function(a, b) {\n    return a[l1] === b[l1]\n      ? a[l2] - b[l2]\n      : a[l1] - b[l1];\n  };\n}\n\nfunction onAnimationsComplete(context) {\n  const chart = context.chart;\n  const animationOptions = chart.options.animation;\n\n  chart.notifyPlugins('afterRender');\n  callCallback(animationOptions && animationOptions.onComplete, [context], chart);\n}\n\nfunction onAnimationProgress(context) {\n  const chart = context.chart;\n  const animationOptions = chart.options.animation;\n  callCallback(animationOptions && animationOptions.onProgress, [context], chart);\n}\n\n/**\n * Chart.js can take a string id of a canvas element, a 2d context, or a canvas element itself.\n * Attempt to unwrap the item passed into the chart constructor so that it is a canvas element (if possible).\n */\nfunction getCanvas(item) {\n  if (_isDomSupported() && typeof item === 'string') {\n    item = document.getElementById(item);\n  } else if (item && item.length) {\n    // Support for array based queries (such as jQuery)\n    item = item[0];\n  }\n\n  if (item && item.canvas) {\n    // Support for any object associated to a canvas (including a context2d)\n    item = item.canvas;\n  }\n  return item;\n}\n\nconst instances = {};\nconst getChart = (key) => {\n  const canvas = getCanvas(key);\n  return Object.values(instances).filter((c) => c.canvas === canvas).pop();\n};\n\nfunction moveNumericKeys(obj, start, move) {\n  const keys = Object.keys(obj);\n  for (const key of keys) {\n    const intKey = +key;\n    if (intKey >= start) {\n      const value = obj[key];\n      delete obj[key];\n      if (move > 0 || intKey > start) {\n        obj[intKey + move] = value;\n      }\n    }\n  }\n}\n\n/**\n * @param {ChartEvent} e\n * @param {ChartEvent|null} lastEvent\n * @param {boolean} inChartArea\n * @param {boolean} isClick\n * @returns {ChartEvent|null}\n */\nfunction determineLastEvent(e, lastEvent, inChartArea, isClick) {\n  if (!inChartArea || e.type === 'mouseout') {\n    return null;\n  }\n  if (isClick) {\n    return lastEvent;\n  }\n  return e;\n}\n\nfunction getDatasetArea(meta) {\n  const {xScale, yScale} = meta;\n  if (xScale && yScale) {\n    return {\n      left: xScale.left,\n      right: xScale.right,\n      top: yScale.top,\n      bottom: yScale.bottom\n    };\n  }\n}\n\nclass Chart {\n\n  static defaults = defaults;\n  static instances = instances;\n  static overrides = overrides;\n  static registry = registry;\n  static version = version;\n  static getChart = getChart;\n\n  static register(...items) {\n    registry.add(...items);\n    invalidatePlugins();\n  }\n\n  static unregister(...items) {\n    registry.remove(...items);\n    invalidatePlugins();\n  }\n\n  // eslint-disable-next-line max-statements\n  constructor(item, userConfig) {\n    const config = this.config = new Config(userConfig);\n    const initialCanvas = getCanvas(item);\n    const existingChart = getChart(initialCanvas);\n    if (existingChart) {\n      throw new Error(\n        'Canvas is already in use. Chart with ID \\'' + existingChart.id + '\\'' +\n\t\t\t\t' must be destroyed before the canvas with ID \\'' + existingChart.canvas.id + '\\' can be reused.'\n      );\n    }\n\n    const options = config.createResolver(config.chartOptionScopes(), this.getContext());\n\n    this.platform = new (config.platform || _detectPlatform(initialCanvas))();\n    this.platform.updateConfig(config);\n\n    const context = this.platform.acquireContext(initialCanvas, options.aspectRatio);\n    const canvas = context && context.canvas;\n    const height = canvas && canvas.height;\n    const width = canvas && canvas.width;\n\n    this.id = uid();\n    this.ctx = context;\n    this.canvas = canvas;\n    this.width = width;\n    this.height = height;\n    this._options = options;\n    // Store the previously used aspect ratio to determine if a resize\n    // is needed during updates. Do this after _options is set since\n    // aspectRatio uses a getter\n    this._aspectRatio = this.aspectRatio;\n    this._layers = [];\n    this._metasets = [];\n    this._stacks = undefined;\n    this.boxes = [];\n    this.currentDevicePixelRatio = undefined;\n    this.chartArea = undefined;\n    this._active = [];\n    this._lastEvent = undefined;\n    this._listeners = {};\n    /** @type {?{attach?: function, detach?: function, resize?: function}} */\n    this._responsiveListeners = undefined;\n    this._sortedMetasets = [];\n    this.scales = {};\n    this._plugins = new PluginService();\n    this.$proxies = {};\n    this._hiddenIndices = {};\n    this.attached = false;\n    this._animationsDisabled = undefined;\n    this.$context = undefined;\n    this._doResize = debounce(mode => this.update(mode), options.resizeDelay || 0);\n    this._dataChanges = [];\n\n    // Add the chart instance to the global namespace\n    instances[this.id] = this;\n\n    if (!context || !canvas) {\n      // The given item is not a compatible context2d element, let's return before finalizing\n      // the chart initialization but after setting basic chart / controller properties that\n      // can help to figure out that the chart is not valid (e.g chart.canvas !== null);\n      // https://github.com/chartjs/Chart.js/issues/2807\n      console.error(\"Failed to create chart: can't acquire context from the given item\");\n      return;\n    }\n\n    animator.listen(this, 'complete', onAnimationsComplete);\n    animator.listen(this, 'progress', onAnimationProgress);\n\n    this._initialize();\n    if (this.attached) {\n      this.update();\n    }\n  }\n\n  get aspectRatio() {\n    const {options: {aspectRatio, maintainAspectRatio}, width, height, _aspectRatio} = this;\n    if (!isNullOrUndef(aspectRatio)) {\n      // If aspectRatio is defined in options, use that.\n      return aspectRatio;\n    }\n\n    if (maintainAspectRatio && _aspectRatio) {\n      // If maintainAspectRatio is truthly and we had previously determined _aspectRatio, use that\n      return _aspectRatio;\n    }\n\n    // Calculate\n    return height ? width / height : null;\n  }\n\n  get data() {\n    return this.config.data;\n  }\n\n  set data(data) {\n    this.config.data = data;\n  }\n\n  get options() {\n    return this._options;\n  }\n\n  set options(options) {\n    this.config.options = options;\n  }\n\n  get registry() {\n    return registry;\n  }\n\n  /**\n\t * @private\n\t */\n  _initialize() {\n    // Before init plugin notification\n    this.notifyPlugins('beforeInit');\n\n    if (this.options.responsive) {\n      this.resize();\n    } else {\n      retinaScale(this, this.options.devicePixelRatio);\n    }\n\n    this.bindEvents();\n\n    // After init plugin notification\n    this.notifyPlugins('afterInit');\n\n    return this;\n  }\n\n  clear() {\n    clearCanvas(this.canvas, this.ctx);\n    return this;\n  }\n\n  stop() {\n    animator.stop(this);\n    return this;\n  }\n\n  /**\n\t * Resize the chart to its container or to explicit dimensions.\n\t * @param {number} [width]\n\t * @param {number} [height]\n\t */\n  resize(width, height) {\n    if (!animator.running(this)) {\n      this._resize(width, height);\n    } else {\n      this._resizeBeforeDraw = {width, height};\n    }\n  }\n\n  _resize(width, height) {\n    const options = this.options;\n    const canvas = this.canvas;\n    const aspectRatio = options.maintainAspectRatio && this.aspectRatio;\n    const newSize = this.platform.getMaximumSize(canvas, width, height, aspectRatio);\n    const newRatio = options.devicePixelRatio || this.platform.getDevicePixelRatio();\n    const mode = this.width ? 'resize' : 'attach';\n\n    this.width = newSize.width;\n    this.height = newSize.height;\n    this._aspectRatio = this.aspectRatio;\n    if (!retinaScale(this, newRatio, true)) {\n      return;\n    }\n\n    this.notifyPlugins('resize', {size: newSize});\n\n    callCallback(options.onResize, [this, newSize], this);\n\n    if (this.attached) {\n      if (this._doResize(mode)) {\n        // The resize update is delayed, only draw without updating.\n        this.render();\n      }\n    }\n  }\n\n  ensureScalesHaveIDs() {\n    const options = this.options;\n    const scalesOptions = options.scales || {};\n\n    each(scalesOptions, (axisOptions, axisID) => {\n      axisOptions.id = axisID;\n    });\n  }\n\n  /**\n\t * Builds a map of scale ID to scale object for future lookup.\n\t */\n  buildOrUpdateScales() {\n    const options = this.options;\n    const scaleOpts = options.scales;\n    const scales = this.scales;\n    const updated = Object.keys(scales).reduce((obj, id) => {\n      obj[id] = false;\n      return obj;\n    }, {});\n    let items = [];\n\n    if (scaleOpts) {\n      items = items.concat(\n        Object.keys(scaleOpts).map((id) => {\n          const scaleOptions = scaleOpts[id];\n          const axis = determineAxis(id, scaleOptions);\n          const isRadial = axis === 'r';\n          const isHorizontal = axis === 'x';\n          return {\n            options: scaleOptions,\n            dposition: isRadial ? 'chartArea' : isHorizontal ? 'bottom' : 'left',\n            dtype: isRadial ? 'radialLinear' : isHorizontal ? 'category' : 'linear'\n          };\n        })\n      );\n    }\n\n    each(items, (item) => {\n      const scaleOptions = item.options;\n      const id = scaleOptions.id;\n      const axis = determineAxis(id, scaleOptions);\n      const scaleType = valueOrDefault(scaleOptions.type, item.dtype);\n\n      if (scaleOptions.position === undefined || positionIsHorizontal(scaleOptions.position, axis) !== positionIsHorizontal(item.dposition)) {\n        scaleOptions.position = item.dposition;\n      }\n\n      updated[id] = true;\n      let scale = null;\n      if (id in scales && scales[id].type === scaleType) {\n        scale = scales[id];\n      } else {\n        const scaleClass = registry.getScale(scaleType);\n        scale = new scaleClass({\n          id,\n          type: scaleType,\n          ctx: this.ctx,\n          chart: this\n        });\n        scales[scale.id] = scale;\n      }\n\n      scale.init(scaleOptions, options);\n    });\n    // clear up discarded scales\n    each(updated, (hasUpdated, id) => {\n      if (!hasUpdated) {\n        delete scales[id];\n      }\n    });\n\n    each(scales, (scale) => {\n      layouts.configure(this, scale, scale.options);\n      layouts.addBox(this, scale);\n    });\n  }\n\n  /**\n\t * @private\n\t */\n  _updateMetasets() {\n    const metasets = this._metasets;\n    const numData = this.data.datasets.length;\n    const numMeta = metasets.length;\n\n    metasets.sort((a, b) => a.index - b.index);\n    if (numMeta > numData) {\n      for (let i = numData; i < numMeta; ++i) {\n        this._destroyDatasetMeta(i);\n      }\n      metasets.splice(numData, numMeta - numData);\n    }\n    this._sortedMetasets = metasets.slice(0).sort(compare2Level('order', 'index'));\n  }\n\n  /**\n\t * @private\n\t */\n  _removeUnreferencedMetasets() {\n    const {_metasets: metasets, data: {datasets}} = this;\n    if (metasets.length > datasets.length) {\n      delete this._stacks;\n    }\n    metasets.forEach((meta, index) => {\n      if (datasets.filter(x => x === meta._dataset).length === 0) {\n        this._destroyDatasetMeta(index);\n      }\n    });\n  }\n\n  buildOrUpdateControllers() {\n    const newControllers = [];\n    const datasets = this.data.datasets;\n    let i, ilen;\n\n    this._removeUnreferencedMetasets();\n\n    for (i = 0, ilen = datasets.length; i < ilen; i++) {\n      const dataset = datasets[i];\n      let meta = this.getDatasetMeta(i);\n      const type = dataset.type || this.config.type;\n\n      if (meta.type && meta.type !== type) {\n        this._destroyDatasetMeta(i);\n        meta = this.getDatasetMeta(i);\n      }\n      meta.type = type;\n      meta.indexAxis = dataset.indexAxis || getIndexAxis(type, this.options);\n      meta.order = dataset.order || 0;\n      meta.index = i;\n      meta.label = '' + dataset.label;\n      meta.visible = this.isDatasetVisible(i);\n\n      if (meta.controller) {\n        meta.controller.updateIndex(i);\n        meta.controller.linkScales();\n      } else {\n        const ControllerClass = registry.getController(type);\n        const {datasetElementType, dataElementType} = defaults.datasets[type];\n        Object.assign(ControllerClass, {\n          dataElementType: registry.getElement(dataElementType),\n          datasetElementType: datasetElementType && registry.getElement(datasetElementType)\n        });\n        meta.controller = new ControllerClass(this, i);\n        newControllers.push(meta.controller);\n      }\n    }\n\n    this._updateMetasets();\n    return newControllers;\n  }\n\n  /**\n\t * Reset the elements of all datasets\n\t * @private\n\t */\n  _resetElements() {\n    each(this.data.datasets, (dataset, datasetIndex) => {\n      this.getDatasetMeta(datasetIndex).controller.reset();\n    }, this);\n  }\n\n  /**\n\t* Resets the chart back to its state before the initial animation\n\t*/\n  reset() {\n    this._resetElements();\n    this.notifyPlugins('reset');\n  }\n\n  update(mode) {\n    const config = this.config;\n\n    config.update();\n    const options = this._options = config.createResolver(config.chartOptionScopes(), this.getContext());\n    const animsDisabled = this._animationsDisabled = !options.animation;\n\n    this._updateScales();\n    this._checkEventBindings();\n    this._updateHiddenIndices();\n\n    // plugins options references might have change, let's invalidate the cache\n    // https://github.com/chartjs/Chart.js/issues/5111#issuecomment-355934167\n    this._plugins.invalidate();\n\n    if (this.notifyPlugins('beforeUpdate', {mode, cancelable: true}) === false) {\n      return;\n    }\n\n    // Make sure dataset controllers are updated and new controllers are reset\n    const newControllers = this.buildOrUpdateControllers();\n\n    this.notifyPlugins('beforeElementsUpdate');\n\n    // Make sure all dataset controllers have correct meta data counts\n    let minPadding = 0;\n    for (let i = 0, ilen = this.data.datasets.length; i < ilen; i++) {\n      const {controller} = this.getDatasetMeta(i);\n      const reset = !animsDisabled && newControllers.indexOf(controller) === -1;\n      // New controllers will be reset after the layout pass, so we only want to modify\n      // elements added to new datasets\n      controller.buildOrUpdateElements(reset);\n      minPadding = Math.max(+controller.getMaxOverflow(), minPadding);\n    }\n    minPadding = this._minPadding = options.layout.autoPadding ? minPadding : 0;\n    this._updateLayout(minPadding);\n\n    // Only reset the controllers if we have animations\n    if (!animsDisabled) {\n      // Can only reset the new controllers after the scales have been updated\n      // Reset is done to get the starting point for the initial animation\n      each(newControllers, (controller) => {\n        controller.reset();\n      });\n    }\n\n    this._updateDatasets(mode);\n\n    // Do this before render so that any plugins that need final scale updates can use it\n    this.notifyPlugins('afterUpdate', {mode});\n\n    this._layers.sort(compare2Level('z', '_idx'));\n\n    // Replay last event from before update, or set hover styles on active elements\n    const {_active, _lastEvent} = this;\n    if (_lastEvent) {\n      this._eventHandler(_lastEvent, true);\n    } else if (_active.length) {\n      this._updateHoverStyles(_active, _active, true);\n    }\n\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  _updateScales() {\n    each(this.scales, (scale) => {\n      layouts.removeBox(this, scale);\n    });\n\n    this.ensureScalesHaveIDs();\n    this.buildOrUpdateScales();\n  }\n\n  /**\n   * @private\n   */\n  _checkEventBindings() {\n    const options = this.options;\n    const existingEvents = new Set(Object.keys(this._listeners));\n    const newEvents = new Set(options.events);\n\n    if (!setsEqual(existingEvents, newEvents) || !!this._responsiveListeners !== options.responsive) {\n      // The configured events have changed. Rebind.\n      this.unbindEvents();\n      this.bindEvents();\n    }\n  }\n\n  /**\n   * @private\n   */\n  _updateHiddenIndices() {\n    const {_hiddenIndices} = this;\n    const changes = this._getUniformDataChanges() || [];\n    for (const {method, start, count} of changes) {\n      const move = method === '_removeElements' ? -count : count;\n      moveNumericKeys(_hiddenIndices, start, move);\n    }\n  }\n\n  /**\n   * @private\n   */\n  _getUniformDataChanges() {\n    const _dataChanges = this._dataChanges;\n    if (!_dataChanges || !_dataChanges.length) {\n      return;\n    }\n\n    this._dataChanges = [];\n    const datasetCount = this.data.datasets.length;\n    const makeSet = (idx) => new Set(\n      _dataChanges\n        .filter(c => c[0] === idx)\n        .map((c, i) => i + ',' + c.splice(1).join(','))\n    );\n\n    const changeSet = makeSet(0);\n    for (let i = 1; i < datasetCount; i++) {\n      if (!setsEqual(changeSet, makeSet(i))) {\n        return;\n      }\n    }\n    return Array.from(changeSet)\n      .map(c => c.split(','))\n      .map(a => ({method: a[1], start: +a[2], count: +a[3]}));\n  }\n\n  /**\n\t * Updates the chart layout unless a plugin returns `false` to the `beforeLayout`\n\t * hook, in which case, plugins will not be called on `afterLayout`.\n\t * @private\n\t */\n  _updateLayout(minPadding) {\n    if (this.notifyPlugins('beforeLayout', {cancelable: true}) === false) {\n      return;\n    }\n\n    layouts.update(this, this.width, this.height, minPadding);\n\n    const area = this.chartArea;\n    const noArea = area.width <= 0 || area.height <= 0;\n\n    this._layers = [];\n    each(this.boxes, (box) => {\n      if (noArea && box.position === 'chartArea') {\n        // Skip drawing and configuring chartArea boxes when chartArea is zero or negative\n        return;\n      }\n\n      // configure is called twice, once in core.scale.update and once here.\n      // Here the boxes are fully updated and at their final positions.\n      if (box.configure) {\n        box.configure();\n      }\n      this._layers.push(...box._layers());\n    }, this);\n\n    this._layers.forEach((item, index) => {\n      item._idx = index;\n    });\n\n    this.notifyPlugins('afterLayout');\n  }\n\n  /**\n\t * Updates all datasets unless a plugin returns `false` to the `beforeDatasetsUpdate`\n\t * hook, in which case, plugins will not be called on `afterDatasetsUpdate`.\n\t * @private\n\t */\n  _updateDatasets(mode) {\n    if (this.notifyPlugins('beforeDatasetsUpdate', {mode, cancelable: true}) === false) {\n      return;\n    }\n\n    for (let i = 0, ilen = this.data.datasets.length; i < ilen; ++i) {\n      this.getDatasetMeta(i).controller.configure();\n    }\n\n    for (let i = 0, ilen = this.data.datasets.length; i < ilen; ++i) {\n      this._updateDataset(i, isFunction(mode) ? mode({datasetIndex: i}) : mode);\n    }\n\n    this.notifyPlugins('afterDatasetsUpdate', {mode});\n  }\n\n  /**\n\t * Updates dataset at index unless a plugin returns `false` to the `beforeDatasetUpdate`\n\t * hook, in which case, plugins will not be called on `afterDatasetUpdate`.\n\t * @private\n\t */\n  _updateDataset(index, mode) {\n    const meta = this.getDatasetMeta(index);\n    const args = {meta, index, mode, cancelable: true};\n\n    if (this.notifyPlugins('beforeDatasetUpdate', args) === false) {\n      return;\n    }\n\n    meta.controller._update(mode);\n\n    args.cancelable = false;\n    this.notifyPlugins('afterDatasetUpdate', args);\n  }\n\n  render() {\n    if (this.notifyPlugins('beforeRender', {cancelable: true}) === false) {\n      return;\n    }\n\n    if (animator.has(this)) {\n      if (this.attached && !animator.running(this)) {\n        animator.start(this);\n      }\n    } else {\n      this.draw();\n      onAnimationsComplete({chart: this});\n    }\n  }\n\n  draw() {\n    let i;\n    if (this._resizeBeforeDraw) {\n      const {width, height} = this._resizeBeforeDraw;\n      this._resize(width, height);\n      this._resizeBeforeDraw = null;\n    }\n    this.clear();\n\n    if (this.width <= 0 || this.height <= 0) {\n      return;\n    }\n\n    if (this.notifyPlugins('beforeDraw', {cancelable: true}) === false) {\n      return;\n    }\n\n    // Because of plugin hooks (before/afterDatasetsDraw), datasets can't\n    // currently be part of layers. Instead, we draw\n    // layers <= 0 before(default, backward compat), and the rest after\n    const layers = this._layers;\n    for (i = 0; i < layers.length && layers[i].z <= 0; ++i) {\n      layers[i].draw(this.chartArea);\n    }\n\n    this._drawDatasets();\n\n    // Rest of layers\n    for (; i < layers.length; ++i) {\n      layers[i].draw(this.chartArea);\n    }\n\n    this.notifyPlugins('afterDraw');\n  }\n\n  /**\n\t * @private\n\t */\n  _getSortedDatasetMetas(filterVisible) {\n    const metasets = this._sortedMetasets;\n    const result = [];\n    let i, ilen;\n\n    for (i = 0, ilen = metasets.length; i < ilen; ++i) {\n      const meta = metasets[i];\n      if (!filterVisible || meta.visible) {\n        result.push(meta);\n      }\n    }\n\n    return result;\n  }\n\n  /**\n\t * Gets the visible dataset metas in drawing order\n\t * @return {object[]}\n\t */\n  getSortedVisibleDatasetMetas() {\n    return this._getSortedDatasetMetas(true);\n  }\n\n  /**\n\t * Draws all datasets unless a plugin returns `false` to the `beforeDatasetsDraw`\n\t * hook, in which case, plugins will not be called on `afterDatasetsDraw`.\n\t * @private\n\t */\n  _drawDatasets() {\n    if (this.notifyPlugins('beforeDatasetsDraw', {cancelable: true}) === false) {\n      return;\n    }\n\n    const metasets = this.getSortedVisibleDatasetMetas();\n    for (let i = metasets.length - 1; i >= 0; --i) {\n      this._drawDataset(metasets[i]);\n    }\n\n    this.notifyPlugins('afterDatasetsDraw');\n  }\n\n  /**\n\t * Draws dataset at index unless a plugin returns `false` to the `beforeDatasetDraw`\n\t * hook, in which case, plugins will not be called on `afterDatasetDraw`.\n\t * @private\n\t */\n  _drawDataset(meta) {\n    const ctx = this.ctx;\n    const clip = meta._clip;\n    const useClip = !clip.disabled;\n    const area = getDatasetArea(meta) || this.chartArea;\n    const args = {\n      meta,\n      index: meta.index,\n      cancelable: true\n    };\n\n    if (this.notifyPlugins('beforeDatasetDraw', args) === false) {\n      return;\n    }\n\n    if (useClip) {\n      clipArea(ctx, {\n        left: clip.left === false ? 0 : area.left - clip.left,\n        right: clip.right === false ? this.width : area.right + clip.right,\n        top: clip.top === false ? 0 : area.top - clip.top,\n        bottom: clip.bottom === false ? this.height : area.bottom + clip.bottom\n      });\n    }\n\n    meta.controller.draw();\n\n    if (useClip) {\n      unclipArea(ctx);\n    }\n\n    args.cancelable = false;\n    this.notifyPlugins('afterDatasetDraw', args);\n  }\n\n  /**\n   * Checks whether the given point is in the chart area.\n   * @param {Point} point - in relative coordinates (see, e.g., getRelativePosition)\n   * @returns {boolean}\n   */\n  isPointInArea(point) {\n    return _isPointInArea(point, this.chartArea, this._minPadding);\n  }\n\n  getElementsAtEventForMode(e, mode, options, useFinalPosition) {\n    const method = Interaction.modes[mode];\n    if (typeof method === 'function') {\n      return method(this, e, options, useFinalPosition);\n    }\n\n    return [];\n  }\n\n  getDatasetMeta(datasetIndex) {\n    const dataset = this.data.datasets[datasetIndex];\n    const metasets = this._metasets;\n    let meta = metasets.filter(x => x && x._dataset === dataset).pop();\n\n    if (!meta) {\n      meta = {\n        type: null,\n        data: [],\n        dataset: null,\n        controller: null,\n        hidden: null,\t\t\t// See isDatasetVisible() comment\n        xAxisID: null,\n        yAxisID: null,\n        order: dataset && dataset.order || 0,\n        index: datasetIndex,\n        _dataset: dataset,\n        _parsed: [],\n        _sorted: false\n      };\n      metasets.push(meta);\n    }\n\n    return meta;\n  }\n\n  getContext() {\n    return this.$context || (this.$context = createContext(null, {chart: this, type: 'chart'}));\n  }\n\n  getVisibleDatasetCount() {\n    return this.getSortedVisibleDatasetMetas().length;\n  }\n\n  isDatasetVisible(datasetIndex) {\n    const dataset = this.data.datasets[datasetIndex];\n    if (!dataset) {\n      return false;\n    }\n\n    const meta = this.getDatasetMeta(datasetIndex);\n\n    // meta.hidden is a per chart dataset hidden flag override with 3 states: if true or false,\n    // the dataset.hidden value is ignored, else if null, the dataset hidden state is returned.\n    return typeof meta.hidden === 'boolean' ? !meta.hidden : !dataset.hidden;\n  }\n\n  setDatasetVisibility(datasetIndex, visible) {\n    const meta = this.getDatasetMeta(datasetIndex);\n    meta.hidden = !visible;\n  }\n\n  toggleDataVisibility(index) {\n    this._hiddenIndices[index] = !this._hiddenIndices[index];\n  }\n\n  getDataVisibility(index) {\n    return !this._hiddenIndices[index];\n  }\n\n  /**\n\t * @private\n\t */\n  _updateVisibility(datasetIndex, dataIndex, visible) {\n    const mode = visible ? 'show' : 'hide';\n    const meta = this.getDatasetMeta(datasetIndex);\n    const anims = meta.controller._resolveAnimations(undefined, mode);\n\n    if (defined(dataIndex)) {\n      meta.data[dataIndex].hidden = !visible;\n      this.update();\n    } else {\n      this.setDatasetVisibility(datasetIndex, visible);\n      // Animate visible state, so hide animation can be seen. This could be handled better if update / updateDataset returned a Promise.\n      anims.update(meta, {visible});\n      this.update((ctx) => ctx.datasetIndex === datasetIndex ? mode : undefined);\n    }\n  }\n\n  hide(datasetIndex, dataIndex) {\n    this._updateVisibility(datasetIndex, dataIndex, false);\n  }\n\n  show(datasetIndex, dataIndex) {\n    this._updateVisibility(datasetIndex, dataIndex, true);\n  }\n\n  /**\n\t * @private\n\t */\n  _destroyDatasetMeta(datasetIndex) {\n    const meta = this._metasets[datasetIndex];\n    if (meta && meta.controller) {\n      meta.controller._destroy();\n    }\n    delete this._metasets[datasetIndex];\n  }\n\n  _stop() {\n    let i, ilen;\n    this.stop();\n    animator.remove(this);\n\n    for (i = 0, ilen = this.data.datasets.length; i < ilen; ++i) {\n      this._destroyDatasetMeta(i);\n    }\n  }\n\n  destroy() {\n    this.notifyPlugins('beforeDestroy');\n    const {canvas, ctx} = this;\n\n    this._stop();\n    this.config.clearCache();\n\n    if (canvas) {\n      this.unbindEvents();\n      clearCanvas(canvas, ctx);\n      this.platform.releaseContext(ctx);\n      this.canvas = null;\n      this.ctx = null;\n    }\n\n    delete instances[this.id];\n\n    this.notifyPlugins('afterDestroy');\n  }\n\n  toBase64Image(...args) {\n    return this.canvas.toDataURL(...args);\n  }\n\n  /**\n\t * @private\n\t */\n  bindEvents() {\n    this.bindUserEvents();\n    if (this.options.responsive) {\n      this.bindResponsiveEvents();\n    } else {\n      this.attached = true;\n    }\n  }\n\n  /**\n   * @private\n   */\n  bindUserEvents() {\n    const listeners = this._listeners;\n    const platform = this.platform;\n\n    const _add = (type, listener) => {\n      platform.addEventListener(this, type, listener);\n      listeners[type] = listener;\n    };\n\n    const listener = (e, x, y) => {\n      e.offsetX = x;\n      e.offsetY = y;\n      this._eventHandler(e);\n    };\n\n    each(this.options.events, (type) => _add(type, listener));\n  }\n\n  /**\n   * @private\n   */\n  bindResponsiveEvents() {\n    if (!this._responsiveListeners) {\n      this._responsiveListeners = {};\n    }\n    const listeners = this._responsiveListeners;\n    const platform = this.platform;\n\n    const _add = (type, listener) => {\n      platform.addEventListener(this, type, listener);\n      listeners[type] = listener;\n    };\n    const _remove = (type, listener) => {\n      if (listeners[type]) {\n        platform.removeEventListener(this, type, listener);\n        delete listeners[type];\n      }\n    };\n\n    const listener = (width, height) => {\n      if (this.canvas) {\n        this.resize(width, height);\n      }\n    };\n\n    let detached; // eslint-disable-line prefer-const\n    const attached = () => {\n      _remove('attach', attached);\n\n      this.attached = true;\n      this.resize();\n\n      _add('resize', listener);\n      _add('detach', detached);\n    };\n\n    detached = () => {\n      this.attached = false;\n\n      _remove('resize', listener);\n\n      // Stop animating and remove metasets, so when re-attached, the animations start from beginning.\n      this._stop();\n      this._resize(0, 0);\n\n      _add('attach', attached);\n    };\n\n    if (platform.isAttached(this.canvas)) {\n      attached();\n    } else {\n      detached();\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  unbindEvents() {\n    each(this._listeners, (listener, type) => {\n      this.platform.removeEventListener(this, type, listener);\n    });\n    this._listeners = {};\n\n    each(this._responsiveListeners, (listener, type) => {\n      this.platform.removeEventListener(this, type, listener);\n    });\n    this._responsiveListeners = undefined;\n  }\n\n  updateHoverStyle(items, mode, enabled) {\n    const prefix = enabled ? 'set' : 'remove';\n    let meta, item, i, ilen;\n\n    if (mode === 'dataset') {\n      meta = this.getDatasetMeta(items[0].datasetIndex);\n      meta.controller['_' + prefix + 'DatasetHoverStyle']();\n    }\n\n    for (i = 0, ilen = items.length; i < ilen; ++i) {\n      item = items[i];\n      const controller = item && this.getDatasetMeta(item.datasetIndex).controller;\n      if (controller) {\n        controller[prefix + 'HoverStyle'](item.element, item.datasetIndex, item.index);\n      }\n    }\n  }\n\n  /**\n\t * Get active (hovered) elements\n\t * @returns array\n\t */\n  getActiveElements() {\n    return this._active || [];\n  }\n\n  /**\n\t * Set active (hovered) elements\n\t * @param {array} activeElements New active data points\n\t */\n  setActiveElements(activeElements) {\n    const lastActive = this._active || [];\n    const active = activeElements.map(({datasetIndex, index}) => {\n      const meta = this.getDatasetMeta(datasetIndex);\n      if (!meta) {\n        throw new Error('No dataset found at index ' + datasetIndex);\n      }\n\n      return {\n        datasetIndex,\n        element: meta.data[index],\n        index,\n      };\n    });\n    const changed = !_elementsEqual(active, lastActive);\n\n    if (changed) {\n      this._active = active;\n      // Make sure we don't use the previous mouse event to override the active elements in update.\n      this._lastEvent = null;\n      this._updateHoverStyles(active, lastActive);\n    }\n  }\n\n  /**\n\t * Calls enabled plugins on the specified hook and with the given args.\n\t * This method immediately returns as soon as a plugin explicitly returns false. The\n\t * returned value can be used, for instance, to interrupt the current action.\n\t * @param {string} hook - The name of the plugin method to call (e.g. 'beforeUpdate').\n\t * @param {Object} [args] - Extra arguments to apply to the hook call.\n   * @param {import('./core.plugins').filterCallback} [filter] - Filtering function for limiting which plugins are notified\n\t * @returns {boolean} false if any of the plugins return false, else returns true.\n\t */\n  notifyPlugins(hook, args, filter) {\n    return this._plugins.notify(this, hook, args, filter);\n  }\n\n  /**\n   * Check if a plugin with the specific ID is registered and enabled\n   * @param {string} pluginId - The ID of the plugin of which to check if it is enabled\n   * @returns {boolean}\n   */\n  isPluginEnabled(pluginId) {\n    return this._plugins._cache.filter(p => p.plugin.id === pluginId).length === 1;\n  }\n\n  /**\n\t * @private\n\t */\n  _updateHoverStyles(active, lastActive, replay) {\n    const hoverOptions = this.options.hover;\n    const diff = (a, b) => a.filter(x => !b.some(y => x.datasetIndex === y.datasetIndex && x.index === y.index));\n    const deactivated = diff(lastActive, active);\n    const activated = replay ? active : diff(active, lastActive);\n\n    if (deactivated.length) {\n      this.updateHoverStyle(deactivated, hoverOptions.mode, false);\n    }\n\n    if (activated.length && hoverOptions.mode) {\n      this.updateHoverStyle(activated, hoverOptions.mode, true);\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _eventHandler(e, replay) {\n    const args = {\n      event: e,\n      replay,\n      cancelable: true,\n      inChartArea: this.isPointInArea(e)\n    };\n    const eventFilter = (plugin) => (plugin.options.events || this.options.events).includes(e.native.type);\n\n    if (this.notifyPlugins('beforeEvent', args, eventFilter) === false) {\n      return;\n    }\n\n    const changed = this._handleEvent(e, replay, args.inChartArea);\n\n    args.cancelable = false;\n    this.notifyPlugins('afterEvent', args, eventFilter);\n\n    if (changed || args.changed) {\n      this.render();\n    }\n\n    return this;\n  }\n\n  /**\n\t * Handle an event\n\t * @param {ChartEvent} e the event to handle\n\t * @param {boolean} [replay] - true if the event was replayed by `update`\n   * @param {boolean} [inChartArea] - true if the event is inside chartArea\n\t * @return {boolean} true if the chart needs to re-render\n\t * @private\n\t */\n  _handleEvent(e, replay, inChartArea) {\n    const {_active: lastActive = [], options} = this;\n\n    // If the event is replayed from `update`, we should evaluate with the final positions.\n    //\n    // The `replay`:\n    // It's the last event (excluding click) that has occurred before `update`.\n    // So mouse has not moved. It's also over the chart, because there is a `replay`.\n    //\n    // The why:\n    // If animations are active, the elements haven't moved yet compared to state before update.\n    // But if they will, we are activating the elements that would be active, if this check\n    // was done after the animations have completed. => \"final positions\".\n    // If there is no animations, the \"final\" and \"current\" positions are equal.\n    // This is done so we do not have to evaluate the active elements each animation frame\n    // - it would be expensive.\n    const useFinalPosition = replay;\n    const active = this._getActiveElements(e, lastActive, inChartArea, useFinalPosition);\n    const isClick = _isClickEvent(e);\n    const lastEvent = determineLastEvent(e, this._lastEvent, inChartArea, isClick);\n\n    if (inChartArea) {\n      // Set _lastEvent to null while we are processing the event handlers.\n      // This prevents recursion if the handler calls chart.update()\n      this._lastEvent = null;\n\n      // Invoke onHover hook\n      callCallback(options.onHover, [e, active, this], this);\n\n      if (isClick) {\n        callCallback(options.onClick, [e, active, this], this);\n      }\n    }\n\n    const changed = !_elementsEqual(active, lastActive);\n    if (changed || replay) {\n      this._active = active;\n      this._updateHoverStyles(active, lastActive, replay);\n    }\n\n    this._lastEvent = lastEvent;\n\n    return changed;\n  }\n\n  /**\n   * @param {ChartEvent} e - The event\n   * @param {import('../../types').ActiveElement[]} lastActive - Previously active elements\n   * @param {boolean} inChartArea - Is the envent inside chartArea\n   * @param {boolean} useFinalPosition - Should the evaluation be done with current or final (after animation) element positions\n   * @returns {import('../../types').ActiveElement[]} - The active elements\n   * @pravate\n   */\n  _getActiveElements(e, lastActive, inChartArea, useFinalPosition) {\n    if (e.type === 'mouseout') {\n      return [];\n    }\n\n    if (!inChartArea) {\n      // Let user control the active elements outside chartArea. Eg. using Legend.\n      return lastActive;\n    }\n\n    const hoverOptions = this.options.hover;\n    return this.getElementsAtEventForMode(e, hoverOptions.mode, hoverOptions, useFinalPosition);\n  }\n}\n\n// @ts-ignore\nfunction invalidatePlugins() {\n  return each(Chart.instances, (chart) => chart._plugins.invalidate());\n}\n\nexport default Chart;\n","import Element from '../core/core.element';\nimport {_angleBetween, getAngleFromPoint, TAU, HALF_PI, valueOrDefault} from '../helpers/index';\nimport {PI, _isBetween, _limitValue} from '../helpers/helpers.math';\nimport {_readValueToProps} from '../helpers/helpers.options';\nimport type {ArcOptions, Point} from '../../types';\n\n\nfunction clipArc(ctx: CanvasRenderingContext2D, element: ArcElement, endAngle: number) {\n  const {startAngle, pixelMargin, x, y, outerRadius, innerRadius} = element;\n  let angleMargin = pixelMargin / outerRadius;\n\n  // Draw an inner border by clipping the arc and drawing a double-width border\n  // Enlarge the clipping arc by 0.33 pixels to eliminate glitches between borders\n  ctx.beginPath();\n  ctx.arc(x, y, outerRadius, startAngle - angleMargin, endAngle + angleMargin);\n  if (innerRadius > pixelMargin) {\n    angleMargin = pixelMargin / innerRadius;\n    ctx.arc(x, y, innerRadius, endAngle + angleMargin, startAngle - angleMargin, true);\n  } else {\n    ctx.arc(x, y, pixelMargin, endAngle + HALF_PI, startAngle - HALF_PI);\n  }\n  ctx.closePath();\n  ctx.clip();\n}\n\nfunction toRadiusCorners(value) {\n  return _readValueToProps(value, ['outerStart', 'outerEnd', 'innerStart', 'innerEnd']);\n}\n\n/**\n * Parse border radius from the provided options\n */\nfunction parseBorderRadius(arc: ArcElement, innerRadius: number, outerRadius: number, angleDelta: number) {\n  const o = toRadiusCorners(arc.options.borderRadius);\n  const halfThickness = (outerRadius - innerRadius) / 2;\n  const innerLimit = Math.min(halfThickness, angleDelta * innerRadius / 2);\n\n  // Outer limits are complicated. We want to compute the available angular distance at\n  // a radius of outerRadius - borderRadius because for small angular distances, this term limits.\n  // We compute at r = outerRadius - borderRadius because this circle defines the center of the border corners.\n  //\n  // If the borderRadius is large, that value can become negative.\n  // This causes the outer borders to lose their radius entirely, which is rather unexpected. To solve that, if borderRadius > outerRadius\n  // we know that the thickness term will dominate and compute the limits at that point\n  const computeOuterLimit = (val) => {\n    const outerArcLimit = (outerRadius - Math.min(halfThickness, val)) * angleDelta / 2;\n    return _limitValue(val, 0, Math.min(halfThickness, outerArcLimit));\n  };\n\n  return {\n    outerStart: computeOuterLimit(o.outerStart),\n    outerEnd: computeOuterLimit(o.outerEnd),\n    innerStart: _limitValue(o.innerStart, 0, innerLimit),\n    innerEnd: _limitValue(o.innerEnd, 0, innerLimit),\n  };\n}\n\n/**\n * Convert (r, ) to (x, y)\n */\nfunction rThetaToXY(r: number, theta: number, x: number, y: number) {\n  return {\n    x: x + r * Math.cos(theta),\n    y: y + r * Math.sin(theta),\n  };\n}\n\n\n/**\n * Path the arc, respecting border radius by separating into left and right halves.\n *\n *   Start      End\n *\n *    1--->a--->2    Outer\n *   /           \\\n *   8           3\n *   |           |\n *   |           |\n *   7           4\n *   \\           /\n *    6<---b<---5    Inner\n */\nfunction pathArc(\n  ctx: CanvasRenderingContext2D,\n  element: ArcElement,\n  offset: number,\n  spacing: number,\n  end: number,\n  circular: boolean,\n) {\n  const {x, y, startAngle: start, pixelMargin, innerRadius: innerR} = element;\n\n  const outerRadius = Math.max(element.outerRadius + spacing + offset - pixelMargin, 0);\n  const innerRadius = innerR > 0 ? innerR + spacing + offset + pixelMargin : 0;\n\n  let spacingOffset = 0;\n  const alpha = end - start;\n\n  if (spacing) {\n    // When spacing is present, it is the same for all items\n    // So we adjust the start and end angle of the arc such that\n    // the distance is the same as it would be without the spacing\n    const noSpacingInnerRadius = innerR > 0 ? innerR - spacing : 0;\n    const noSpacingOuterRadius = outerRadius > 0 ? outerRadius - spacing : 0;\n    const avNogSpacingRadius = (noSpacingInnerRadius + noSpacingOuterRadius) / 2;\n    const adjustedAngle = avNogSpacingRadius !== 0 ? (alpha * avNogSpacingRadius) / (avNogSpacingRadius + spacing) : alpha;\n    spacingOffset = (alpha - adjustedAngle) / 2;\n  }\n\n  const beta = Math.max(0.001, alpha * outerRadius - offset / PI) / outerRadius;\n  const angleOffset = (alpha - beta) / 2;\n  const startAngle = start + angleOffset + spacingOffset;\n  const endAngle = end - angleOffset - spacingOffset;\n  const {outerStart, outerEnd, innerStart, innerEnd} = parseBorderRadius(element, innerRadius, outerRadius, endAngle - startAngle);\n\n  const outerStartAdjustedRadius = outerRadius - outerStart;\n  const outerEndAdjustedRadius = outerRadius - outerEnd;\n  const outerStartAdjustedAngle = startAngle + outerStart / outerStartAdjustedRadius;\n  const outerEndAdjustedAngle = endAngle - outerEnd / outerEndAdjustedRadius;\n\n  const innerStartAdjustedRadius = innerRadius + innerStart;\n  const innerEndAdjustedRadius = innerRadius + innerEnd;\n  const innerStartAdjustedAngle = startAngle + innerStart / innerStartAdjustedRadius;\n  const innerEndAdjustedAngle = endAngle - innerEnd / innerEndAdjustedRadius;\n\n  ctx.beginPath();\n\n  if (circular) {\n    // The first arc segments from point 1 to point a to point 2\n    const outerMidAdjustedAngle = (outerStartAdjustedAngle + outerEndAdjustedAngle) / 2;\n    ctx.arc(x, y, outerRadius, outerStartAdjustedAngle, outerMidAdjustedAngle);\n    ctx.arc(x, y, outerRadius, outerMidAdjustedAngle, outerEndAdjustedAngle);\n\n    // The corner segment from point 2 to point 3\n    if (outerEnd > 0) {\n      const pCenter = rThetaToXY(outerEndAdjustedRadius, outerEndAdjustedAngle, x, y);\n      ctx.arc(pCenter.x, pCenter.y, outerEnd, outerEndAdjustedAngle, endAngle + HALF_PI);\n    }\n\n    // The line from point 3 to point 4\n    const p4 = rThetaToXY(innerEndAdjustedRadius, endAngle, x, y);\n    ctx.lineTo(p4.x, p4.y);\n\n    // The corner segment from point 4 to point 5\n    if (innerEnd > 0) {\n      const pCenter = rThetaToXY(innerEndAdjustedRadius, innerEndAdjustedAngle, x, y);\n      ctx.arc(pCenter.x, pCenter.y, innerEnd, endAngle + HALF_PI, innerEndAdjustedAngle + Math.PI);\n    }\n\n    // The inner arc from point 5 to point b to point 6\n    const innerMidAdjustedAngle = ((endAngle - (innerEnd / innerRadius)) + (startAngle + (innerStart / innerRadius))) / 2;\n    ctx.arc(x, y, innerRadius, endAngle - (innerEnd / innerRadius), innerMidAdjustedAngle, true);\n    ctx.arc(x, y, innerRadius, innerMidAdjustedAngle, startAngle + (innerStart / innerRadius), true);\n\n    // The corner segment from point 6 to point 7\n    if (innerStart > 0) {\n      const pCenter = rThetaToXY(innerStartAdjustedRadius, innerStartAdjustedAngle, x, y);\n      ctx.arc(pCenter.x, pCenter.y, innerStart, innerStartAdjustedAngle + Math.PI, startAngle - HALF_PI);\n    }\n\n    // The line from point 7 to point 8\n    const p8 = rThetaToXY(outerStartAdjustedRadius, startAngle, x, y);\n    ctx.lineTo(p8.x, p8.y);\n\n    // The corner segment from point 8 to point 1\n    if (outerStart > 0) {\n      const pCenter = rThetaToXY(outerStartAdjustedRadius, outerStartAdjustedAngle, x, y);\n      ctx.arc(pCenter.x, pCenter.y, outerStart, startAngle - HALF_PI, outerStartAdjustedAngle);\n    }\n  } else {\n    ctx.moveTo(x, y);\n\n    const outerStartX = Math.cos(outerStartAdjustedAngle) * outerRadius + x;\n    const outerStartY = Math.sin(outerStartAdjustedAngle) * outerRadius + y;\n    ctx.lineTo(outerStartX, outerStartY);\n\n    const outerEndX = Math.cos(outerEndAdjustedAngle) * outerRadius + x;\n    const outerEndY = Math.sin(outerEndAdjustedAngle) * outerRadius + y;\n    ctx.lineTo(outerEndX, outerEndY);\n  }\n\n  ctx.closePath();\n}\n\nfunction drawArc(\n  ctx: CanvasRenderingContext2D,\n  element: ArcElement,\n  offset: number,\n  spacing: number,\n  circular: boolean,\n) {\n  const {fullCircles, startAngle, circumference} = element;\n  let endAngle = element.endAngle;\n  if (fullCircles) {\n    pathArc(ctx, element, offset, spacing, endAngle, circular);\n    for (let i = 0; i < fullCircles; ++i) {\n      ctx.fill();\n    }\n    if (!isNaN(circumference)) {\n      endAngle = startAngle + (circumference % TAU || TAU);\n    }\n  }\n  pathArc(ctx, element, offset, spacing, endAngle, circular);\n  ctx.fill();\n  return endAngle;\n}\n\nfunction drawBorder(\n  ctx: CanvasRenderingContext2D,\n  element: ArcElement,\n  offset: number,\n  spacing: number,\n  circular: boolean,\n) {\n  const {fullCircles, startAngle, circumference, options} = element;\n  const {borderWidth, borderJoinStyle} = options;\n  const inner = options.borderAlign === 'inner';\n\n  if (!borderWidth) {\n    return;\n  }\n\n  if (inner) {\n    ctx.lineWidth = borderWidth * 2;\n    ctx.lineJoin = borderJoinStyle || 'round';\n  } else {\n    ctx.lineWidth = borderWidth;\n    ctx.lineJoin = borderJoinStyle || 'bevel';\n  }\n\n  let endAngle = element.endAngle;\n  if (fullCircles) {\n    pathArc(ctx, element, offset, spacing, endAngle, circular);\n    for (let i = 0; i < fullCircles; ++i) {\n      ctx.stroke();\n    }\n    if (!isNaN(circumference)) {\n      endAngle = startAngle + (circumference % TAU || TAU);\n    }\n  }\n\n  if (inner) {\n    clipArc(ctx, element, endAngle);\n  }\n\n  if (!fullCircles) {\n    pathArc(ctx, element, offset, spacing, endAngle, circular);\n    ctx.stroke();\n  }\n}\n\nexport interface ArcProps extends Point {\n  startAngle: number;\n  endAngle: number;\n  innerRadius: number;\n  outerRadius: number;\n  circumference: number;\n}\n\nexport default class ArcElement extends Element<ArcProps, ArcOptions> {\n\n  static id = 'arc';\n\n  static defaults = {\n    borderAlign: 'center',\n    borderColor: '#fff',\n    borderJoinStyle: undefined,\n    borderRadius: 0,\n    borderWidth: 2,\n    offset: 0,\n    spacing: 0,\n    angle: undefined,\n    circular: true,\n  };\n\n  static defaultRoutes = {\n    backgroundColor: 'backgroundColor'\n  };\n\n  circumference: number;\n  endAngle: number;\n  fullCircles: number;\n  innerRadius: number;\n  outerRadius: number;\n  pixelMargin: number;\n  startAngle: number;\n\n  constructor(cfg) {\n    super();\n\n    this.options = undefined;\n    this.circumference = undefined;\n    this.startAngle = undefined;\n    this.endAngle = undefined;\n    this.innerRadius = undefined;\n    this.outerRadius = undefined;\n    this.pixelMargin = 0;\n    this.fullCircles = 0;\n\n    if (cfg) {\n      Object.assign(this, cfg);\n    }\n  }\n\n  inRange(chartX: number, chartY: number, useFinalPosition: boolean) {\n    const point = this.getProps(['x', 'y'], useFinalPosition);\n    const {angle, distance} = getAngleFromPoint(point, {x: chartX, y: chartY});\n    const {startAngle, endAngle, innerRadius, outerRadius, circumference} = this.getProps([\n      'startAngle',\n      'endAngle',\n      'innerRadius',\n      'outerRadius',\n      'circumference'\n    ], useFinalPosition);\n    const rAdjust = this.options.spacing / 2;\n    const _circumference = valueOrDefault(circumference, endAngle - startAngle);\n    const betweenAngles = _circumference >= TAU || _angleBetween(angle, startAngle, endAngle);\n    const withinRadius = _isBetween(distance, innerRadius + rAdjust, outerRadius + rAdjust);\n\n    return (betweenAngles && withinRadius);\n  }\n\n  getCenterPoint(useFinalPosition: boolean) {\n    const {x, y, startAngle, endAngle, innerRadius, outerRadius} = this.getProps([\n      'x',\n      'y',\n      'startAngle',\n      'endAngle',\n      'innerRadius',\n      'outerRadius',\n      'circumference',\n    ], useFinalPosition);\n    const {offset, spacing} = this.options;\n    const halfAngle = (startAngle + endAngle) / 2;\n    const halfRadius = (innerRadius + outerRadius + spacing + offset) / 2;\n    return {\n      x: x + Math.cos(halfAngle) * halfRadius,\n      y: y + Math.sin(halfAngle) * halfRadius\n    };\n  }\n\n  tooltipPosition(useFinalPosition: boolean) {\n    return this.getCenterPoint(useFinalPosition);\n  }\n\n  draw(ctx: CanvasRenderingContext2D) {\n    const {options, circumference} = this;\n    const offset = (options.offset || 0) / 4;\n    const spacing = (options.spacing || 0) / 2;\n    const circular = options.circular;\n    this.pixelMargin = (options.borderAlign === 'inner') ? 0.33 : 0;\n    this.fullCircles = circumference > TAU ? Math.floor(circumference / TAU) : 0;\n\n    if (circumference === 0 || this.innerRadius < 0 || this.outerRadius < 0) {\n      return;\n    }\n\n    ctx.save();\n\n    const halfAngle = (this.startAngle + this.endAngle) / 2;\n    ctx.translate(Math.cos(halfAngle) * offset, Math.sin(halfAngle) * offset);\n    const fix = 1 - Math.sin(Math.min(PI, circumference || 0));\n    const radiusOffset = offset * fix;\n\n    ctx.fillStyle = options.backgroundColor;\n    ctx.strokeStyle = options.borderColor;\n\n    drawArc(ctx, this, radiusOffset, spacing, circular);\n    drawBorder(ctx, this, radiusOffset, spacing, circular);\n\n    ctx.restore();\n  }\n}\n","import Element from '../core/core.element';\nimport {_bezierInterpolation, _pointInLine, _steppedInterpolation} from '../helpers/helpers.interpolation';\nimport {_computeSegments, _boundSegments} from '../helpers/helpers.segment';\nimport {_steppedLineTo, _bezierCurveTo} from '../helpers/helpers.canvas';\nimport {_updateBezierControlPoints} from '../helpers/helpers.curve';\nimport {valueOrDefault} from '../helpers';\n\n/**\n * @typedef { import(\"./element.point\").default } PointElement\n */\n\nfunction setStyle(ctx, options, style = options) {\n  ctx.lineCap = valueOrDefault(style.borderCapStyle, options.borderCapStyle);\n  ctx.setLineDash(valueOrDefault(style.borderDash, options.borderDash));\n  ctx.lineDashOffset = valueOrDefault(style.borderDashOffset, options.borderDashOffset);\n  ctx.lineJoin = valueOrDefault(style.borderJoinStyle, options.borderJoinStyle);\n  ctx.lineWidth = valueOrDefault(style.borderWidth, options.borderWidth);\n  ctx.strokeStyle = valueOrDefault(style.borderColor, options.borderColor);\n}\n\nfunction lineTo(ctx, previous, target) {\n  ctx.lineTo(target.x, target.y);\n}\n\nfunction getLineMethod(options) {\n  if (options.stepped) {\n    return _steppedLineTo;\n  }\n\n  if (options.tension || options.cubicInterpolationMode === 'monotone') {\n    return _bezierCurveTo;\n  }\n\n  return lineTo;\n}\n\nfunction pathVars(points, segment, params = {}) {\n  const count = points.length;\n  const {start: paramsStart = 0, end: paramsEnd = count - 1} = params;\n  const {start: segmentStart, end: segmentEnd} = segment;\n  const start = Math.max(paramsStart, segmentStart);\n  const end = Math.min(paramsEnd, segmentEnd);\n  const outside = paramsStart < segmentStart && paramsEnd < segmentStart || paramsStart > segmentEnd && paramsEnd > segmentEnd;\n\n  return {\n    count,\n    start,\n    loop: segment.loop,\n    ilen: end < start && !outside ? count + end - start : end - start\n  };\n}\n\n/**\n * Create path from points, grouping by truncated x-coordinate\n * Points need to be in order by x-coordinate for this to work efficiently\n * @param {CanvasRenderingContext2D|Path2D} ctx - Context\n * @param {LineElement} line\n * @param {object} segment\n * @param {number} segment.start - start index of the segment, referring the points array\n * @param {number} segment.end - end index of the segment, referring the points array\n * @param {boolean} segment.loop - indicates that the segment is a loop\n * @param {object} params\n * @param {boolean} params.move - move to starting point (vs line to it)\n * @param {boolean} params.reverse - path the segment from end to start\n * @param {number} params.start - limit segment to points starting from `start` index\n * @param {number} params.end - limit segment to points ending at `start` + `count` index\n */\nfunction pathSegment(ctx, line, segment, params) {\n  const {points, options} = line;\n  const {count, start, loop, ilen} = pathVars(points, segment, params);\n  const lineMethod = getLineMethod(options);\n  // eslint-disable-next-line prefer-const\n  let {move = true, reverse} = params || {};\n  let i, point, prev;\n\n  for (i = 0; i <= ilen; ++i) {\n    point = points[(start + (reverse ? ilen - i : i)) % count];\n\n    if (point.skip) {\n      // If there is a skipped point inside a segment, spanGaps must be true\n      continue;\n    } else if (move) {\n      ctx.moveTo(point.x, point.y);\n      move = false;\n    } else {\n      lineMethod(ctx, prev, point, reverse, options.stepped);\n    }\n\n    prev = point;\n  }\n\n  if (loop) {\n    point = points[(start + (reverse ? ilen : 0)) % count];\n    lineMethod(ctx, prev, point, reverse, options.stepped);\n  }\n\n  return !!loop;\n}\n\n/**\n * Create path from points, grouping by truncated x-coordinate\n * Points need to be in order by x-coordinate for this to work efficiently\n * @param {CanvasRenderingContext2D|Path2D} ctx - Context\n * @param {LineElement} line\n * @param {object} segment\n * @param {number} segment.start - start index of the segment, referring the points array\n * @param {number} segment.end - end index of the segment, referring the points array\n * @param {boolean} segment.loop - indicates that the segment is a loop\n * @param {object} params\n * @param {boolean} params.move - move to starting point (vs line to it)\n * @param {boolean} params.reverse - path the segment from end to start\n * @param {number} params.start - limit segment to points starting from `start` index\n * @param {number} params.end - limit segment to points ending at `start` + `count` index\n */\nfunction fastPathSegment(ctx, line, segment, params) {\n  const points = line.points;\n  const {count, start, ilen} = pathVars(points, segment, params);\n  const {move = true, reverse} = params || {};\n  let avgX = 0;\n  let countX = 0;\n  let i, point, prevX, minY, maxY, lastY;\n\n  const pointIndex = (index) => (start + (reverse ? ilen - index : index)) % count;\n  const drawX = () => {\n    if (minY !== maxY) {\n      // Draw line to maxY and minY, using the average x-coordinate\n      ctx.lineTo(avgX, maxY);\n      ctx.lineTo(avgX, minY);\n      // Line to y-value of last point in group. So the line continues\n      // from correct position. Not using move, to have solid path.\n      ctx.lineTo(avgX, lastY);\n    }\n  };\n\n  if (move) {\n    point = points[pointIndex(0)];\n    ctx.moveTo(point.x, point.y);\n  }\n\n  for (i = 0; i <= ilen; ++i) {\n    point = points[pointIndex(i)];\n\n    if (point.skip) {\n      // If there is a skipped point inside a segment, spanGaps must be true\n      continue;\n    }\n\n    const x = point.x;\n    const y = point.y;\n    const truncX = x | 0; // truncated x-coordinate\n\n    if (truncX === prevX) {\n      // Determine `minY` / `maxY` and `avgX` while we stay within same x-position\n      if (y < minY) {\n        minY = y;\n      } else if (y > maxY) {\n        maxY = y;\n      }\n      // For first point in group, countX is `0`, so average will be `x` / 1.\n      avgX = (countX * avgX + x) / ++countX;\n    } else {\n      drawX();\n      // Draw line to next x-position, using the first (or only)\n      // y-value in that group\n      ctx.lineTo(x, y);\n\n      prevX = truncX;\n      countX = 0;\n      minY = maxY = y;\n    }\n    // Keep track of the last y-value in group\n    lastY = y;\n  }\n  drawX();\n}\n\n/**\n * @param {LineElement} line - the line\n * @returns {function}\n * @private\n */\nfunction _getSegmentMethod(line) {\n  const opts = line.options;\n  const borderDash = opts.borderDash && opts.borderDash.length;\n  const useFastPath = !line._decimated && !line._loop && !opts.tension && opts.cubicInterpolationMode !== 'monotone' && !opts.stepped && !borderDash;\n  return useFastPath ? fastPathSegment : pathSegment;\n}\n\n/**\n * @private\n */\nfunction _getInterpolationMethod(options) {\n  if (options.stepped) {\n    return _steppedInterpolation;\n  }\n\n  if (options.tension || options.cubicInterpolationMode === 'monotone') {\n    return _bezierInterpolation;\n  }\n\n  return _pointInLine;\n}\n\nfunction strokePathWithCache(ctx, line, start, count) {\n  let path = line._path;\n  if (!path) {\n    path = line._path = new Path2D();\n    if (line.path(path, start, count)) {\n      path.closePath();\n    }\n  }\n  setStyle(ctx, line.options);\n  ctx.stroke(path);\n}\n\nfunction strokePathDirect(ctx, line, start, count) {\n  const {segments, options} = line;\n  const segmentMethod = _getSegmentMethod(line);\n\n  for (const segment of segments) {\n    setStyle(ctx, options, segment.style);\n    ctx.beginPath();\n    if (segmentMethod(ctx, line, segment, {start, end: start + count - 1})) {\n      ctx.closePath();\n    }\n    ctx.stroke();\n  }\n}\n\nconst usePath2D = typeof Path2D === 'function';\n\nfunction draw(ctx, line, start, count) {\n  if (usePath2D && !line.options.segment) {\n    strokePathWithCache(ctx, line, start, count);\n  } else {\n    strokePathDirect(ctx, line, start, count);\n  }\n}\n\nexport default class LineElement extends Element {\n\n  static id = 'line';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    borderCapStyle: 'butt',\n    borderDash: [],\n    borderDashOffset: 0,\n    borderJoinStyle: 'miter',\n    borderWidth: 3,\n    capBezierPoints: true,\n    cubicInterpolationMode: 'default',\n    fill: false,\n    spanGaps: false,\n    stepped: false,\n    tension: 0,\n  };\n\n  /**\n   * @type {any}\n   */\n  static defaultRoutes = {\n    backgroundColor: 'backgroundColor',\n    borderColor: 'borderColor'\n  };\n\n\n  static descriptors = {\n    _scriptable: true,\n    _indexable: (name) => name !== 'borderDash' && name !== 'fill',\n  };\n\n\n  constructor(cfg) {\n    super();\n\n    this.animated = true;\n    this.options = undefined;\n    this._chart = undefined;\n    this._loop = undefined;\n    this._fullLoop = undefined;\n    this._path = undefined;\n    this._points = undefined;\n    this._segments = undefined;\n    this._decimated = false;\n    this._pointsUpdated = false;\n    this._datasetIndex = undefined;\n\n    if (cfg) {\n      Object.assign(this, cfg);\n    }\n  }\n\n  updateControlPoints(chartArea, indexAxis) {\n    const options = this.options;\n    if ((options.tension || options.cubicInterpolationMode === 'monotone') && !options.stepped && !this._pointsUpdated) {\n      const loop = options.spanGaps ? this._loop : this._fullLoop;\n      _updateBezierControlPoints(this._points, options, chartArea, loop, indexAxis);\n      this._pointsUpdated = true;\n    }\n  }\n\n  set points(points) {\n    this._points = points;\n    delete this._segments;\n    delete this._path;\n    this._pointsUpdated = false;\n  }\n\n  get points() {\n    return this._points;\n  }\n\n  get segments() {\n    return this._segments || (this._segments = _computeSegments(this, this.options.segment));\n  }\n\n  /**\n\t * First non-skipped point on this line\n\t * @returns {PointElement|undefined}\n\t */\n  first() {\n    const segments = this.segments;\n    const points = this.points;\n    return segments.length && points[segments[0].start];\n  }\n\n  /**\n\t * Last non-skipped point on this line\n\t * @returns {PointElement|undefined}\n\t */\n  last() {\n    const segments = this.segments;\n    const points = this.points;\n    const count = segments.length;\n    return count && points[segments[count - 1].end];\n  }\n\n  /**\n\t * Interpolate a point in this line at the same value on `property` as\n\t * the reference `point` provided\n\t * @param {PointElement} point - the reference point\n\t * @param {string} property - the property to match on\n\t * @returns {PointElement|undefined}\n\t */\n  interpolate(point, property) {\n    const options = this.options;\n    const value = point[property];\n    const points = this.points;\n    const segments = _boundSegments(this, {property, start: value, end: value});\n\n    if (!segments.length) {\n      return;\n    }\n\n    const result = [];\n    const _interpolate = _getInterpolationMethod(options);\n    let i, ilen;\n    for (i = 0, ilen = segments.length; i < ilen; ++i) {\n      const {start, end} = segments[i];\n      const p1 = points[start];\n      const p2 = points[end];\n      if (p1 === p2) {\n        result.push(p1);\n        continue;\n      }\n      const t = Math.abs((value - p1[property]) / (p2[property] - p1[property]));\n      const interpolated = _interpolate(p1, p2, t, options.stepped);\n      interpolated[property] = point[property];\n      result.push(interpolated);\n    }\n    return result.length === 1 ? result[0] : result;\n  }\n\n  /**\n\t * Append a segment of this line to current path.\n\t * @param {CanvasRenderingContext2D} ctx\n\t * @param {object} segment\n\t * @param {number} segment.start - start index of the segment, referring the points array\n \t * @param {number} segment.end - end index of the segment, referring the points array\n \t * @param {boolean} segment.loop - indicates that the segment is a loop\n\t * @param {object} params\n\t * @param {boolean} params.move - move to starting point (vs line to it)\n\t * @param {boolean} params.reverse - path the segment from end to start\n\t * @param {number} params.start - limit segment to points starting from `start` index\n\t * @param {number} params.end - limit segment to points ending at `start` + `count` index\n\t * @returns {undefined|boolean} - true if the segment is a full loop (path should be closed)\n\t */\n  pathSegment(ctx, segment, params) {\n    const segmentMethod = _getSegmentMethod(this);\n    return segmentMethod(ctx, this, segment, params);\n  }\n\n  /**\n\t * Append all segments of this line to current path.\n\t * @param {CanvasRenderingContext2D|Path2D} ctx\n\t * @param {number} [start]\n\t * @param {number} [count]\n\t * @returns {undefined|boolean} - true if line is a full loop (path should be closed)\n\t */\n  path(ctx, start, count) {\n    const segments = this.segments;\n    const segmentMethod = _getSegmentMethod(this);\n    let loop = this._loop;\n\n    start = start || 0;\n    count = count || (this.points.length - start);\n\n    for (const segment of segments) {\n      loop &= segmentMethod(ctx, this, segment, {start, end: start + count - 1});\n    }\n    return !!loop;\n  }\n\n  /**\n\t * Draw\n\t * @param {CanvasRenderingContext2D} ctx\n\t * @param {object} chartArea\n\t * @param {number} [start]\n\t * @param {number} [count]\n\t */\n  draw(ctx, chartArea, start, count) {\n    const options = this.options || {};\n    const points = this.points || [];\n\n    if (points.length && options.borderWidth) {\n      ctx.save();\n\n      draw(ctx, this, start, count);\n\n      ctx.restore();\n    }\n\n    if (this.animated) {\n      // When line is animated, the control points and path are not cached.\n      this._pointsUpdated = false;\n      this._path = undefined;\n    }\n  }\n}\n","import Element from '../core/core.element';\nimport {drawPoint, _isPointInArea} from '../helpers/helpers.canvas';\nimport {\n  type CartesianParsedData,\n  type ChartArea,\n  type Point,\n  type PointHoverOptions,\n  type PointOptions,\n} from '../../types';\n\nfunction inRange(el: PointElement, pos: number, axis: 'x' | 'y', useFinalPosition?: boolean) {\n  const options = el.options;\n  const {[axis]: value} = el.getProps([axis], useFinalPosition);\n\n  return (Math.abs(pos - value) < options.radius + options.hitRadius);\n}\n\nexport type PointProps = Point\n\nexport default class PointElement extends Element<PointProps, PointOptions & PointHoverOptions> {\n\n  static id = 'point';\n\n  parsed: CartesianParsedData;\n  skip?: boolean;\n  stop?: boolean;\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    borderWidth: 1,\n    hitRadius: 1,\n    hoverBorderWidth: 1,\n    hoverRadius: 4,\n    pointStyle: 'circle',\n    radius: 3,\n    rotation: 0\n  };\n\n  /**\n   * @type {any}\n   */\n  static defaultRoutes = {\n    backgroundColor: 'backgroundColor',\n    borderColor: 'borderColor'\n  };\n\n  constructor(cfg) {\n    super();\n\n    this.options = undefined;\n    this.parsed = undefined;\n    this.skip = undefined;\n    this.stop = undefined;\n\n    if (cfg) {\n      Object.assign(this, cfg);\n    }\n  }\n\n  inRange(mouseX: number, mouseY: number, useFinalPosition?: boolean) {\n    const options = this.options;\n    const {x, y} = this.getProps(['x', 'y'], useFinalPosition);\n    return ((Math.pow(mouseX - x, 2) + Math.pow(mouseY - y, 2)) < Math.pow(options.hitRadius + options.radius, 2));\n  }\n\n  inXRange(mouseX: number, useFinalPosition?: boolean) {\n    return inRange(this, mouseX, 'x', useFinalPosition);\n  }\n\n  inYRange(mouseY: number, useFinalPosition?: boolean) {\n    return inRange(this, mouseY, 'y', useFinalPosition);\n  }\n\n  getCenterPoint(useFinalPosition?: boolean) {\n    const {x, y} = this.getProps(['x', 'y'], useFinalPosition);\n    return {x, y};\n  }\n\n  size(options?: Partial<PointOptions & PointHoverOptions>) {\n    options = options || this.options || {};\n    let radius = options.radius || 0;\n    radius = Math.max(radius, radius && options.hoverRadius || 0);\n    const borderWidth = radius && options.borderWidth || 0;\n    return (radius + borderWidth) * 2;\n  }\n\n  draw(ctx: CanvasRenderingContext2D, area: ChartArea) {\n    const options = this.options;\n\n    if (this.skip || options.radius < 0.1 || !_isPointInArea(this, area, this.size(options) / 2)) {\n      return;\n    }\n\n    ctx.strokeStyle = options.borderColor;\n    ctx.lineWidth = options.borderWidth;\n    ctx.fillStyle = options.backgroundColor;\n    drawPoint(ctx, options, this.x, this.y);\n  }\n\n  getRange() {\n    const options = this.options || {};\n    // @ts-expect-error Fallbacks should never be hit in practice\n    return options.radius + options.hitRadius;\n  }\n}\n","import Element from '../core/core.element';\nimport {isObject, _isBetween, _limitValue} from '../helpers';\nimport {addRoundedRectPath} from '../helpers/helpers.canvas';\nimport {toTRBL, toTRBLCorners} from '../helpers/helpers.options';\n\n/** @typedef {{ x: number, y: number, base: number, horizontal: boolean, width: number, height: number }} BarProps */\n\n/**\n * Helper function to get the bounds of the bar regardless of the orientation\n * @param {BarElement} bar the bar\n * @param {boolean} [useFinalPosition]\n * @return {object} bounds of the bar\n * @private\n */\nfunction getBarBounds(bar, useFinalPosition) {\n  const {x, y, base, width, height} = /** @type {BarProps} */ (bar.getProps(['x', 'y', 'base', 'width', 'height'], useFinalPosition));\n\n  let left, right, top, bottom, half;\n\n  if (bar.horizontal) {\n    half = height / 2;\n    left = Math.min(x, base);\n    right = Math.max(x, base);\n    top = y - half;\n    bottom = y + half;\n  } else {\n    half = width / 2;\n    left = x - half;\n    right = x + half;\n    top = Math.min(y, base);\n    bottom = Math.max(y, base);\n  }\n\n  return {left, top, right, bottom};\n}\n\nfunction skipOrLimit(skip, value, min, max) {\n  return skip ? 0 : _limitValue(value, min, max);\n}\n\nfunction parseBorderWidth(bar, maxW, maxH) {\n  const value = bar.options.borderWidth;\n  const skip = bar.borderSkipped;\n  const o = toTRBL(value);\n\n  return {\n    t: skipOrLimit(skip.top, o.top, 0, maxH),\n    r: skipOrLimit(skip.right, o.right, 0, maxW),\n    b: skipOrLimit(skip.bottom, o.bottom, 0, maxH),\n    l: skipOrLimit(skip.left, o.left, 0, maxW)\n  };\n}\n\nfunction parseBorderRadius(bar, maxW, maxH) {\n  const {enableBorderRadius} = bar.getProps(['enableBorderRadius']);\n  const value = bar.options.borderRadius;\n  const o = toTRBLCorners(value);\n  const maxR = Math.min(maxW, maxH);\n  const skip = bar.borderSkipped;\n\n  // If the value is an object, assume the user knows what they are doing\n  // and apply as directed.\n  const enableBorder = enableBorderRadius || isObject(value);\n\n  return {\n    topLeft: skipOrLimit(!enableBorder || skip.top || skip.left, o.topLeft, 0, maxR),\n    topRight: skipOrLimit(!enableBorder || skip.top || skip.right, o.topRight, 0, maxR),\n    bottomLeft: skipOrLimit(!enableBorder || skip.bottom || skip.left, o.bottomLeft, 0, maxR),\n    bottomRight: skipOrLimit(!enableBorder || skip.bottom || skip.right, o.bottomRight, 0, maxR)\n  };\n}\n\nfunction boundingRects(bar) {\n  const bounds = getBarBounds(bar);\n  const width = bounds.right - bounds.left;\n  const height = bounds.bottom - bounds.top;\n  const border = parseBorderWidth(bar, width / 2, height / 2);\n  const radius = parseBorderRadius(bar, width / 2, height / 2);\n\n  return {\n    outer: {\n      x: bounds.left,\n      y: bounds.top,\n      w: width,\n      h: height,\n      radius\n    },\n    inner: {\n      x: bounds.left + border.l,\n      y: bounds.top + border.t,\n      w: width - border.l - border.r,\n      h: height - border.t - border.b,\n      radius: {\n        topLeft: Math.max(0, radius.topLeft - Math.max(border.t, border.l)),\n        topRight: Math.max(0, radius.topRight - Math.max(border.t, border.r)),\n        bottomLeft: Math.max(0, radius.bottomLeft - Math.max(border.b, border.l)),\n        bottomRight: Math.max(0, radius.bottomRight - Math.max(border.b, border.r)),\n      }\n    }\n  };\n}\n\nfunction inRange(bar, x, y, useFinalPosition) {\n  const skipX = x === null;\n  const skipY = y === null;\n  const skipBoth = skipX && skipY;\n  const bounds = bar && !skipBoth && getBarBounds(bar, useFinalPosition);\n\n  return bounds\n\t\t&& (skipX || _isBetween(x, bounds.left, bounds.right))\n\t\t&& (skipY || _isBetween(y, bounds.top, bounds.bottom));\n}\n\nfunction hasRadius(radius) {\n  return radius.topLeft || radius.topRight || radius.bottomLeft || radius.bottomRight;\n}\n\n/**\n * Add a path of a rectangle to the current sub-path\n * @param {CanvasRenderingContext2D} ctx Context\n * @param {*} rect Bounding rect\n */\nfunction addNormalRectPath(ctx, rect) {\n  ctx.rect(rect.x, rect.y, rect.w, rect.h);\n}\n\nfunction inflateRect(rect, amount, refRect = {}) {\n  const x = rect.x !== refRect.x ? -amount : 0;\n  const y = rect.y !== refRect.y ? -amount : 0;\n  const w = (rect.x + rect.w !== refRect.x + refRect.w ? amount : 0) - x;\n  const h = (rect.y + rect.h !== refRect.y + refRect.h ? amount : 0) - y;\n  return {\n    x: rect.x + x,\n    y: rect.y + y,\n    w: rect.w + w,\n    h: rect.h + h,\n    radius: rect.radius\n  };\n}\n\nexport default class BarElement extends Element {\n\n  static id = 'bar';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    borderSkipped: 'start',\n    borderWidth: 0,\n    borderRadius: 0,\n    inflateAmount: 'auto',\n    pointStyle: undefined\n  };\n\n  /**\n   * @type {any}\n   */\n  static defaultRoutes = {\n    backgroundColor: 'backgroundColor',\n    borderColor: 'borderColor'\n  };\n\n  constructor(cfg) {\n    super();\n\n    this.options = undefined;\n    this.horizontal = undefined;\n    this.base = undefined;\n    this.width = undefined;\n    this.height = undefined;\n    this.inflateAmount = undefined;\n\n    if (cfg) {\n      Object.assign(this, cfg);\n    }\n  }\n\n  draw(ctx) {\n    const {inflateAmount, options: {borderColor, backgroundColor}} = this;\n    const {inner, outer} = boundingRects(this);\n    const addRectPath = hasRadius(outer.radius) ? addRoundedRectPath : addNormalRectPath;\n\n    ctx.save();\n\n    if (outer.w !== inner.w || outer.h !== inner.h) {\n      ctx.beginPath();\n      addRectPath(ctx, inflateRect(outer, inflateAmount, inner));\n      ctx.clip();\n      addRectPath(ctx, inflateRect(inner, -inflateAmount, outer));\n      ctx.fillStyle = borderColor;\n      ctx.fill('evenodd');\n    }\n\n    ctx.beginPath();\n    addRectPath(ctx, inflateRect(inner, inflateAmount));\n    ctx.fillStyle = backgroundColor;\n    ctx.fill();\n\n    ctx.restore();\n  }\n\n  inRange(mouseX, mouseY, useFinalPosition) {\n    return inRange(this, mouseX, mouseY, useFinalPosition);\n  }\n\n  inXRange(mouseX, useFinalPosition) {\n    return inRange(this, mouseX, null, useFinalPosition);\n  }\n\n  inYRange(mouseY, useFinalPosition) {\n    return inRange(this, null, mouseY, useFinalPosition);\n  }\n\n  getCenterPoint(useFinalPosition) {\n    const {x, y, base, horizontal} = /** @type {BarProps} */ (this.getProps(['x', 'y', 'base', 'horizontal'], useFinalPosition));\n    return {\n      x: horizontal ? (x + base) / 2 : x,\n      y: horizontal ? y : (y + base) / 2\n    };\n  }\n\n  getRange(axis) {\n    return axis === 'x' ? this.width / 2 : this.height / 2;\n  }\n}\n","import type {Chart, ChartConfiguration, ChartDataset} from '../types';\n\nexport interface ColorsPluginOptions {\n  enabled?: boolean;\n}\n\ntype DatasetColorizer = (dataset: ChartDataset, i: number) => void;\n\ninterface ColorsDescriptor {\n  backgroundColor?: unknown;\n  borderColor?: unknown;\n}\n\nconst BORDER_COLORS = [\n  'rgb(54, 162, 235)', // blue\n  'rgb(255, 99, 132)', // red\n  'rgb(255, 159, 64)', // orange\n  'rgb(255, 205, 86)', // yellow\n  'rgb(75, 192, 192)', // green\n  'rgb(153, 102, 255)', // purple\n  'rgb(201, 203, 207)' // grey\n];\n\n// Border colors with 50% transparency\nconst BACKGROUND_COLORS = /* #__PURE__ */ BORDER_COLORS.map(color => color.replace('rgb(', 'rgba(').replace(')', ', 0.5)'));\n\nfunction getBorderColor(i: number) {\n  return BORDER_COLORS[i % BORDER_COLORS.length];\n}\n\nfunction getBackgroundColor(i: number) {\n  return BACKGROUND_COLORS[i % BACKGROUND_COLORS.length];\n}\n\nfunction createDefaultDatasetColorizer() {\n  return (dataset: ChartDataset, i: number) => {\n    dataset.borderColor = getBorderColor(i);\n    dataset.backgroundColor = getBackgroundColor(i);\n  };\n}\n\nfunction createDoughnutDatasetColorizer() {\n  let i = 0;\n\n  return (dataset: ChartDataset) => {\n    dataset.backgroundColor = dataset.data.map(() => getBorderColor(i++));\n  };\n}\n\nfunction createPolarAreaDatasetColorizer() {\n  let i = 0;\n\n  return (dataset: ChartDataset) => {\n    dataset.backgroundColor = dataset.data.map(() => getBackgroundColor(i++));\n  };\n}\n\nfunction getColorizer(type: string) {\n  if (type === 'doughnut' || type === 'pie') {\n    return createDoughnutDatasetColorizer();\n  } else if (type === 'polarArea') {\n    return createPolarAreaDatasetColorizer();\n  }\n  return createDefaultDatasetColorizer();\n}\n\nfunction containsColorsDefinitions(\n  descriptors: ColorsDescriptor[] | Record<string, ColorsDescriptor>\n) {\n  let k: number | string;\n\n  for (k in descriptors) {\n    if (descriptors[k].borderColor || descriptors[k].backgroundColor) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport default {\n  id: 'colors',\n\n  defaults: {\n    enabled: true,\n  },\n\n  beforeLayout(chart: Chart, _args, options: ColorsPluginOptions) {\n    if (!options.enabled) {\n      return;\n    }\n\n    const {\n      type,\n      options: {elements},\n      data: {datasets}\n    } = chart.config as ChartConfiguration;\n\n    if (containsColorsDefinitions(datasets) || elements && containsColorsDefinitions(elements)) {\n      return;\n    }\n\n    const colorizer: DatasetColorizer = getColorizer(type);\n    datasets.forEach(colorizer);\n  }\n};\n","import {_limitValue, _lookupByKey, isNullOrUndef, resolve} from '../helpers';\n\nfunction lttbDecimation(data, start, count, availableWidth, options) {\n  /**\n   * Implementation of the Largest Triangle Three Buckets algorithm.\n   *\n   * This implementation is based on the original implementation by Sveinn Steinarsson\n   * in https://github.com/sveinn-steinarsson/flot-downsample/blob/master/jquery.flot.downsample.js\n   *\n   * The original implementation is MIT licensed.\n   */\n  const samples = options.samples || availableWidth;\n  // There are less points than the threshold, returning the whole array\n  if (samples >= count) {\n    return data.slice(start, start + count);\n  }\n\n  const decimated = [];\n\n  const bucketWidth = (count - 2) / (samples - 2);\n  let sampledIndex = 0;\n  const endIndex = start + count - 1;\n  // Starting from offset\n  let a = start;\n  let i, maxAreaPoint, maxArea, area, nextA;\n\n  decimated[sampledIndex++] = data[a];\n\n  for (i = 0; i < samples - 2; i++) {\n    let avgX = 0;\n    let avgY = 0;\n    let j;\n\n    // Adding offset\n    const avgRangeStart = Math.floor((i + 1) * bucketWidth) + 1 + start;\n    const avgRangeEnd = Math.min(Math.floor((i + 2) * bucketWidth) + 1, count) + start;\n    const avgRangeLength = avgRangeEnd - avgRangeStart;\n\n    for (j = avgRangeStart; j < avgRangeEnd; j++) {\n      avgX += data[j].x;\n      avgY += data[j].y;\n    }\n\n    avgX /= avgRangeLength;\n    avgY /= avgRangeLength;\n\n    // Adding offset\n    const rangeOffs = Math.floor(i * bucketWidth) + 1 + start;\n    const rangeTo = Math.min(Math.floor((i + 1) * bucketWidth) + 1, count) + start;\n    const {x: pointAx, y: pointAy} = data[a];\n\n    // Note that this is changed from the original algorithm which initializes these\n    // values to 1. The reason for this change is that if the area is small, nextA\n    // would never be set and thus a crash would occur in the next loop as `a` would become\n    // `undefined`. Since the area is always positive, but could be 0 in the case of a flat trace,\n    // initializing with a negative number is the correct solution.\n    maxArea = area = -1;\n\n    for (j = rangeOffs; j < rangeTo; j++) {\n      area = 0.5 * Math.abs(\n        (pointAx - avgX) * (data[j].y - pointAy) -\n        (pointAx - data[j].x) * (avgY - pointAy)\n      );\n\n      if (area > maxArea) {\n        maxArea = area;\n        maxAreaPoint = data[j];\n        nextA = j;\n      }\n    }\n\n    decimated[sampledIndex++] = maxAreaPoint;\n    a = nextA;\n  }\n\n  // Include the last point\n  decimated[sampledIndex++] = data[endIndex];\n\n  return decimated;\n}\n\nfunction minMaxDecimation(data, start, count, availableWidth) {\n  let avgX = 0;\n  let countX = 0;\n  let i, point, x, y, prevX, minIndex, maxIndex, startIndex, minY, maxY;\n  const decimated = [];\n  const endIndex = start + count - 1;\n\n  const xMin = data[start].x;\n  const xMax = data[endIndex].x;\n  const dx = xMax - xMin;\n\n  for (i = start; i < start + count; ++i) {\n    point = data[i];\n    x = (point.x - xMin) / dx * availableWidth;\n    y = point.y;\n    const truncX = x | 0;\n\n    if (truncX === prevX) {\n      // Determine `minY` / `maxY` and `avgX` while we stay within same x-position\n      if (y < minY) {\n        minY = y;\n        minIndex = i;\n      } else if (y > maxY) {\n        maxY = y;\n        maxIndex = i;\n      }\n      // For first point in group, countX is `0`, so average will be `x` / 1.\n      // Use point.x here because we're computing the average data `x` value\n      avgX = (countX * avgX + point.x) / ++countX;\n    } else {\n      // Push up to 4 points, 3 for the last interval and the first point for this interval\n      const lastIndex = i - 1;\n\n      if (!isNullOrUndef(minIndex) && !isNullOrUndef(maxIndex)) {\n        // The interval is defined by 4 points: start, min, max, end.\n        // The starting point is already considered at this point, so we need to determine which\n        // of the other points to add. We need to sort these points to ensure the decimated data\n        // is still sorted and then ensure there are no duplicates.\n        const intermediateIndex1 = Math.min(minIndex, maxIndex);\n        const intermediateIndex2 = Math.max(minIndex, maxIndex);\n\n        if (intermediateIndex1 !== startIndex && intermediateIndex1 !== lastIndex) {\n          decimated.push({\n            ...data[intermediateIndex1],\n            x: avgX,\n          });\n        }\n        if (intermediateIndex2 !== startIndex && intermediateIndex2 !== lastIndex) {\n          decimated.push({\n            ...data[intermediateIndex2],\n            x: avgX\n          });\n        }\n      }\n\n      // lastIndex === startIndex will occur when a range has only 1 point which could\n      // happen with very uneven data\n      if (i > 0 && lastIndex !== startIndex) {\n        // Last point in the previous interval\n        decimated.push(data[lastIndex]);\n      }\n\n      // Start of the new interval\n      decimated.push(point);\n      prevX = truncX;\n      countX = 0;\n      minY = maxY = y;\n      minIndex = maxIndex = startIndex = i;\n    }\n  }\n\n  return decimated;\n}\n\nfunction cleanDecimatedDataset(dataset) {\n  if (dataset._decimated) {\n    const data = dataset._data;\n    delete dataset._decimated;\n    delete dataset._data;\n    Object.defineProperty(dataset, 'data', {value: data});\n  }\n}\n\nfunction cleanDecimatedData(chart) {\n  chart.data.datasets.forEach((dataset) => {\n    cleanDecimatedDataset(dataset);\n  });\n}\n\nfunction getStartAndCountOfVisiblePointsSimplified(meta, points) {\n  const pointCount = points.length;\n\n  let start = 0;\n  let count;\n\n  const {iScale} = meta;\n  const {min, max, minDefined, maxDefined} = iScale.getUserBounds();\n\n  if (minDefined) {\n    start = _limitValue(_lookupByKey(points, iScale.axis, min).lo, 0, pointCount - 1);\n  }\n  if (maxDefined) {\n    count = _limitValue(_lookupByKey(points, iScale.axis, max).hi + 1, start, pointCount) - start;\n  } else {\n    count = pointCount - start;\n  }\n\n  return {start, count};\n}\n\nexport default {\n  id: 'decimation',\n\n  defaults: {\n    algorithm: 'min-max',\n    enabled: false,\n  },\n\n  beforeElementsUpdate: (chart, args, options) => {\n    if (!options.enabled) {\n      // The decimation plugin may have been previously enabled. Need to remove old `dataset._data` handlers\n      cleanDecimatedData(chart);\n      return;\n    }\n\n    // Assume the entire chart is available to show a few more points than needed\n    const availableWidth = chart.width;\n\n    chart.data.datasets.forEach((dataset, datasetIndex) => {\n      const {_data, indexAxis} = dataset;\n      const meta = chart.getDatasetMeta(datasetIndex);\n      const data = _data || dataset.data;\n\n      if (resolve([indexAxis, chart.options.indexAxis]) === 'y') {\n        // Decimation is only supported for lines that have an X indexAxis\n        return;\n      }\n\n      if (!meta.controller.supportsDecimation) {\n        // Only line datasets are supported\n        return;\n      }\n\n      const xAxis = chart.scales[meta.xAxisID];\n      if (xAxis.type !== 'linear' && xAxis.type !== 'time') {\n        // Only linear interpolation is supported\n        return;\n      }\n\n      if (chart.options.parsing) {\n        // Plugin only supports data that does not need parsing\n        return;\n      }\n\n      let {start, count} = getStartAndCountOfVisiblePointsSimplified(meta, data);\n      const threshold = options.threshold || 4 * availableWidth;\n      if (count <= threshold) {\n        // No decimation is required until we are above this threshold\n        cleanDecimatedDataset(dataset);\n        return;\n      }\n\n      if (isNullOrUndef(_data)) {\n        // First time we are seeing this dataset\n        // We override the 'data' property with a setter that stores the\n        // raw data in _data, but reads the decimated data from _decimated\n        dataset._data = data;\n        delete dataset.data;\n        Object.defineProperty(dataset, 'data', {\n          configurable: true,\n          enumerable: true,\n          get: function() {\n            return this._decimated;\n          },\n          set: function(d) {\n            this._data = d;\n          }\n        });\n      }\n\n      // Point the chart to the decimated data\n      let decimated;\n      switch (options.algorithm) {\n      case 'lttb':\n        decimated = lttbDecimation(data, start, count, availableWidth, options);\n        break;\n      case 'min-max':\n        decimated = minMaxDecimation(data, start, count, availableWidth);\n        break;\n      default:\n        throw new Error(`Unsupported decimation algorithm '${options.algorithm}'`);\n      }\n\n      dataset._decimated = decimated;\n    });\n  },\n\n  destroy(chart) {\n    cleanDecimatedData(chart);\n  }\n};\n","import {_boundSegment, _boundSegments, _normalizeAngle} from '../../helpers';\n\nexport function _segments(line, target, property) {\n  const segments = line.segments;\n  const points = line.points;\n  const tpoints = target.points;\n  const parts = [];\n\n  for (const segment of segments) {\n    let {start, end} = segment;\n    end = _findSegmentEnd(start, end, points);\n\n    const bounds = _getBounds(property, points[start], points[end], segment.loop);\n\n    if (!target.segments) {\n      // Special case for boundary not supporting `segments` (simpleArc)\n      // Bounds are provided as `target` for partial circle, or undefined for full circle\n      parts.push({\n        source: segment,\n        target: bounds,\n        start: points[start],\n        end: points[end]\n      });\n      continue;\n    }\n\n    // Get all segments from `target` that intersect the bounds of current segment of `line`\n    const targetSegments = _boundSegments(target, bounds);\n\n    for (const tgt of targetSegments) {\n      const subBounds = _getBounds(property, tpoints[tgt.start], tpoints[tgt.end], tgt.loop);\n      const fillSources = _boundSegment(segment, points, subBounds);\n\n      for (const fillSource of fillSources) {\n        parts.push({\n          source: fillSource,\n          target: tgt,\n          start: {\n            [property]: _getEdge(bounds, subBounds, 'start', Math.max)\n          },\n          end: {\n            [property]: _getEdge(bounds, subBounds, 'end', Math.min)\n          }\n        });\n      }\n    }\n  }\n  return parts;\n}\n\nexport function _getBounds(property, first, last, loop) {\n  if (loop) {\n    return;\n  }\n  let start = first[property];\n  let end = last[property];\n\n  if (property === 'angle') {\n    start = _normalizeAngle(start);\n    end = _normalizeAngle(end);\n  }\n  return {property, start, end};\n}\n\nexport function _pointsFromSegments(boundary, line) {\n  const {x = null, y = null} = boundary || {};\n  const linePoints = line.points;\n  const points = [];\n  line.segments.forEach(({start, end}) => {\n    end = _findSegmentEnd(start, end, linePoints);\n    const first = linePoints[start];\n    const last = linePoints[end];\n    if (y !== null) {\n      points.push({x: first.x, y});\n      points.push({x: last.x, y});\n    } else if (x !== null) {\n      points.push({x, y: first.y});\n      points.push({x, y: last.y});\n    }\n  });\n  return points;\n}\n\nexport function _findSegmentEnd(start, end, points) {\n  for (;end > start; end--) {\n    const point = points[end];\n    if (!isNaN(point.x) && !isNaN(point.y)) {\n      break;\n    }\n  }\n  return end;\n}\n\nfunction _getEdge(a, b, prop, fn) {\n  if (a && b) {\n    return fn(a[prop], b[prop]);\n  }\n  return a ? a[prop] : b ? b[prop] : 0;\n}\n","/**\n * @typedef { import('../../core/core.controller').default } Chart\n * @typedef { import('../../core/core.scale').default } Scale\n * @typedef { import('../../elements/element.point').default } PointElement\n */\n\nimport {LineElement} from '../../elements';\nimport {isArray} from '../../helpers';\nimport {_pointsFromSegments} from './filler.segment';\n\n/**\n * @param {PointElement[] | { x: number; y: number; }} boundary\n * @param {LineElement} line\n * @return {LineElement?}\n */\nexport function _createBoundaryLine(boundary, line) {\n  let points = [];\n  let _loop = false;\n\n  if (isArray(boundary)) {\n    _loop = true;\n    // @ts-ignore\n    points = boundary;\n  } else {\n    points = _pointsFromSegments(boundary, line);\n  }\n\n  return points.length ? new LineElement({\n    points,\n    options: {tension: 0},\n    _loop,\n    _fullLoop: _loop\n  }) : null;\n}\n\nexport function _shouldApplyFill(source) {\n  return source && source.fill !== false;\n}\n","import {isObject, isFinite, valueOrDefault} from '../../helpers/helpers.core';\n\n/**\n * @typedef { import('../../core/core.scale').default } Scale\n * @typedef { import('../../elements/element.line').default } LineElement\n * @typedef { import('../../../types').FillTarget } FillTarget\n * @typedef { import('../../../types').ComplexFillTarget } ComplexFillTarget\n */\n\nexport function _resolveTarget(sources, index, propagate) {\n  const source = sources[index];\n  let fill = source.fill;\n  const visited = [index];\n  let target;\n\n  if (!propagate) {\n    return fill;\n  }\n\n  while (fill !== false && visited.indexOf(fill) === -1) {\n    if (!isFinite(fill)) {\n      return fill;\n    }\n\n    target = sources[fill];\n    if (!target) {\n      return false;\n    }\n\n    if (target.visible) {\n      return fill;\n    }\n\n    visited.push(fill);\n    fill = target.fill;\n  }\n\n  return false;\n}\n\n/**\n * @param {LineElement} line\n * @param {number} index\n * @param {number} count\n */\nexport function _decodeFill(line, index, count) {\n  /** @type {string | {value: number}} */\n  const fill = parseFillOption(line);\n\n  if (isObject(fill)) {\n    return isNaN(fill.value) ? false : fill;\n  }\n\n  let target = parseFloat(fill);\n\n  if (isFinite(target) && Math.floor(target) === target) {\n    return decodeTargetIndex(fill[0], index, target, count);\n  }\n\n  return ['origin', 'start', 'end', 'stack', 'shape'].indexOf(fill) >= 0 && fill;\n}\n\nfunction decodeTargetIndex(firstCh, index, target, count) {\n  if (firstCh === '-' || firstCh === '+') {\n    target = index + target;\n  }\n\n  if (target === index || target < 0 || target >= count) {\n    return false;\n  }\n\n  return target;\n}\n\n/**\n * @param {FillTarget | ComplexFillTarget} fill\n * @param {Scale} scale\n * @returns {number | null}\n */\nexport function _getTargetPixel(fill, scale) {\n  let pixel = null;\n  if (fill === 'start') {\n    pixel = scale.bottom;\n  } else if (fill === 'end') {\n    pixel = scale.top;\n  } else if (isObject(fill)) {\n    // @ts-ignore\n    pixel = scale.getPixelForValue(fill.value);\n  } else if (scale.getBasePixel) {\n    pixel = scale.getBasePixel();\n  }\n  return pixel;\n}\n\n/**\n * @param {FillTarget | ComplexFillTarget} fill\n * @param {Scale} scale\n * @param {number} startValue\n * @returns {number | undefined}\n */\nexport function _getTargetValue(fill, scale, startValue) {\n  let value;\n\n  if (fill === 'start') {\n    value = startValue;\n  } else if (fill === 'end') {\n    value = scale.options.reverse ? scale.min : scale.max;\n  } else if (isObject(fill)) {\n    // @ts-ignore\n    value = fill.value;\n  } else {\n    value = scale.getBaseValue();\n  }\n  return value;\n}\n\n/**\n * @param {LineElement} line\n */\nfunction parseFillOption(line) {\n  const options = line.options;\n  const fillOption = options.fill;\n  let fill = valueOrDefault(fillOption && fillOption.target, fillOption);\n\n  if (fill === undefined) {\n    fill = !!options.backgroundColor;\n  }\n\n  if (fill === false || fill === null) {\n    return false;\n  }\n\n  if (fill === true) {\n    return 'origin';\n  }\n  return fill;\n}\n","/**\n * @typedef { import('../../core/core.controller').default } Chart\n * @typedef { import('../../core/core.scale').default } Scale\n * @typedef { import('../../elements/element.point').default } PointElement\n */\n\nimport {LineElement} from '../../elements';\nimport {_isBetween} from '../../helpers';\nimport {_createBoundaryLine} from './filler.helper';\n\n/**\n * @param {{ chart: Chart; scale: Scale; index: number; line: LineElement; }} source\n * @return {LineElement}\n */\nexport function _buildStackLine(source) {\n  const {scale, index, line} = source;\n  const points = [];\n  const segments = line.segments;\n  const sourcePoints = line.points;\n  const linesBelow = getLinesBelow(scale, index);\n  linesBelow.push(_createBoundaryLine({x: null, y: scale.bottom}, line));\n\n  for (let i = 0; i < segments.length; i++) {\n    const segment = segments[i];\n    for (let j = segment.start; j <= segment.end; j++) {\n      addPointsBelow(points, sourcePoints[j], linesBelow);\n    }\n  }\n  return new LineElement({points, options: {}});\n}\n\n/**\n * @param {Scale} scale\n * @param {number} index\n * @return {LineElement[]}\n */\nfunction getLinesBelow(scale, index) {\n  const below = [];\n  const metas = scale.getMatchingVisibleMetas('line');\n\n  for (let i = 0; i < metas.length; i++) {\n    const meta = metas[i];\n    if (meta.index === index) {\n      break;\n    }\n    if (!meta.hidden) {\n      below.unshift(meta.dataset);\n    }\n  }\n  return below;\n}\n\n/**\n * @param {PointElement[]} points\n * @param {PointElement} sourcePoint\n * @param {LineElement[]} linesBelow\n */\nfunction addPointsBelow(points, sourcePoint, linesBelow) {\n  const postponed = [];\n  for (let j = 0; j < linesBelow.length; j++) {\n    const line = linesBelow[j];\n    const {first, last, point} = findPoint(line, sourcePoint, 'x');\n\n    if (!point || (first && last)) {\n      continue;\n    }\n    if (first) {\n      // First point of an segment -> need to add another point before this,\n      // from next line below.\n      postponed.unshift(point);\n    } else {\n      points.push(point);\n      if (!last) {\n        // In the middle of an segment, no need to add more points.\n        break;\n      }\n    }\n  }\n  points.push(...postponed);\n}\n\n/**\n * @param {LineElement} line\n * @param {PointElement} sourcePoint\n * @param {string} property\n * @returns {{point?: PointElement, first?: boolean, last?: boolean}}\n */\nfunction findPoint(line, sourcePoint, property) {\n  const point = line.interpolate(sourcePoint, property);\n  if (!point) {\n    return {};\n  }\n\n  const pointValue = point[property];\n  const segments = line.segments;\n  const linePoints = line.points;\n  let first = false;\n  let last = false;\n  for (let i = 0; i < segments.length; i++) {\n    const segment = segments[i];\n    const firstValue = linePoints[segment.start][property];\n    const lastValue = linePoints[segment.end][property];\n    if (_isBetween(pointValue, firstValue, lastValue)) {\n      first = pointValue === firstValue;\n      last = pointValue === lastValue;\n      break;\n    }\n  }\n  return {first, last, point};\n}\n","import {TAU} from '../../helpers';\n\n// TODO: use elements.ArcElement instead\nexport class simpleArc {\n  constructor(opts) {\n    this.x = opts.x;\n    this.y = opts.y;\n    this.radius = opts.radius;\n  }\n\n  pathSegment(ctx, bounds, opts) {\n    const {x, y, radius} = this;\n    bounds = bounds || {start: 0, end: TAU};\n    ctx.arc(x, y, radius, bounds.end, bounds.start, true);\n    return !opts.bounds;\n  }\n\n  interpolate(point) {\n    const {x, y, radius} = this;\n    const angle = point.angle;\n    return {\n      x: x + Math.cos(angle) * radius,\n      y: y + Math.sin(angle) * radius,\n      angle\n    };\n  }\n}\n","import {isFinite} from '../../helpers';\nimport {_createBoundaryLine} from './filler.helper';\nimport {_getTargetPixel, _getTargetValue} from './filler.options';\nimport {_buildStackLine} from './filler.target.stack';\nimport {simpleArc} from './simpleArc';\n\n/**\n * @typedef { import('../../core/core.controller').default } Chart\n * @typedef { import('../../core/core.scale').default } Scale\n * @typedef { import('../../elements/element.point').default } PointElement\n */\n\nexport function _getTarget(source) {\n  const {chart, fill, line} = source;\n\n  if (isFinite(fill)) {\n    return getLineByIndex(chart, fill);\n  }\n\n  if (fill === 'stack') {\n    return _buildStackLine(source);\n  }\n\n  if (fill === 'shape') {\n    return true;\n  }\n\n  const boundary = computeBoundary(source);\n\n  if (boundary instanceof simpleArc) {\n    return boundary;\n  }\n\n  return _createBoundaryLine(boundary, line);\n}\n\n/**\n * @param {Chart} chart\n * @param {number} index\n */\nfunction getLineByIndex(chart, index) {\n  const meta = chart.getDatasetMeta(index);\n  const visible = meta && chart.isDatasetVisible(index);\n  return visible ? meta.dataset : null;\n}\n\nfunction computeBoundary(source) {\n  const scale = source.scale || {};\n\n  if (scale.getPointPositionForValue) {\n    return computeCircularBoundary(source);\n  }\n  return computeLinearBoundary(source);\n}\n\n\nfunction computeLinearBoundary(source) {\n  const {scale = {}, fill} = source;\n  const pixel = _getTargetPixel(fill, scale);\n\n  if (isFinite(pixel)) {\n    const horizontal = scale.isHorizontal();\n\n    return {\n      x: horizontal ? pixel : null,\n      y: horizontal ? null : pixel\n    };\n  }\n\n  return null;\n}\n\nfunction computeCircularBoundary(source) {\n  const {scale, fill} = source;\n  const options = scale.options;\n  const length = scale.getLabels().length;\n  const start = options.reverse ? scale.max : scale.min;\n  const value = _getTargetValue(fill, scale, start);\n  const target = [];\n\n  if (options.grid.circular) {\n    const center = scale.getPointPositionForValue(0, start);\n    return new simpleArc({\n      x: center.x,\n      y: center.y,\n      radius: scale.getDistanceFromCenterForValue(value)\n    });\n  }\n\n  for (let i = 0; i < length; ++i) {\n    target.push(scale.getPointPositionForValue(i, value));\n  }\n  return target;\n}\n\n","import {clipArea, unclipArea} from '../../helpers';\nimport {_findSegmentEnd, _getBounds, _segments} from './filler.segment';\nimport {_getTarget} from './filler.target';\n\nexport function _drawfill(ctx, source, area) {\n  const target = _getTarget(source);\n  const {line, scale, axis} = source;\n  const lineOpts = line.options;\n  const fillOption = lineOpts.fill;\n  const color = lineOpts.backgroundColor;\n  const {above = color, below = color} = fillOption || {};\n  if (target && line.points.length) {\n    clipArea(ctx, area);\n    doFill(ctx, {line, target, above, below, area, scale, axis});\n    unclipArea(ctx);\n  }\n}\n\nfunction doFill(ctx, cfg) {\n  const {line, target, above, below, area, scale} = cfg;\n  const property = line._loop ? 'angle' : cfg.axis;\n\n  ctx.save();\n\n  if (property === 'x' && below !== above) {\n    clipVertical(ctx, target, area.top);\n    fill(ctx, {line, target, color: above, scale, property});\n    ctx.restore();\n    ctx.save();\n    clipVertical(ctx, target, area.bottom);\n  }\n  fill(ctx, {line, target, color: below, scale, property});\n\n  ctx.restore();\n}\n\nfunction clipVertical(ctx, target, clipY) {\n  const {segments, points} = target;\n  let first = true;\n  let lineLoop = false;\n\n  ctx.beginPath();\n  for (const segment of segments) {\n    const {start, end} = segment;\n    const firstPoint = points[start];\n    const lastPoint = points[_findSegmentEnd(start, end, points)];\n    if (first) {\n      ctx.moveTo(firstPoint.x, firstPoint.y);\n      first = false;\n    } else {\n      ctx.lineTo(firstPoint.x, clipY);\n      ctx.lineTo(firstPoint.x, firstPoint.y);\n    }\n    lineLoop = !!target.pathSegment(ctx, segment, {move: lineLoop});\n    if (lineLoop) {\n      ctx.closePath();\n    } else {\n      ctx.lineTo(lastPoint.x, clipY);\n    }\n  }\n\n  ctx.lineTo(target.first().x, clipY);\n  ctx.closePath();\n  ctx.clip();\n}\n\nfunction fill(ctx, cfg) {\n  const {line, target, property, color, scale} = cfg;\n  const segments = _segments(line, target, property);\n\n  for (const {source: src, target: tgt, start, end} of segments) {\n    const {style: {backgroundColor = color} = {}} = src;\n    const notShape = target !== true;\n\n    ctx.save();\n    ctx.fillStyle = backgroundColor;\n\n    clipBounds(ctx, scale, notShape && _getBounds(property, start, end));\n\n    ctx.beginPath();\n\n    const lineLoop = !!line.pathSegment(ctx, src);\n\n    let loop;\n    if (notShape) {\n      if (lineLoop) {\n        ctx.closePath();\n      } else {\n        interpolatedLineTo(ctx, target, end, property);\n      }\n\n      const targetLoop = !!target.pathSegment(ctx, tgt, {move: lineLoop, reverse: true});\n      loop = lineLoop && targetLoop;\n      if (!loop) {\n        interpolatedLineTo(ctx, target, start, property);\n      }\n    }\n\n    ctx.closePath();\n    ctx.fill(loop ? 'evenodd' : 'nonzero');\n\n    ctx.restore();\n  }\n}\n\nfunction clipBounds(ctx, scale, bounds) {\n  const {top, bottom} = scale.chart.chartArea;\n  const {property, start, end} = bounds || {};\n  if (property === 'x') {\n    ctx.beginPath();\n    ctx.rect(start, top, end - start, bottom - top);\n    ctx.clip();\n  }\n}\n\nfunction interpolatedLineTo(ctx, target, point, property) {\n  const interpolatedPoint = target.interpolate(point, property);\n  if (interpolatedPoint) {\n    ctx.lineTo(interpolatedPoint.x, interpolatedPoint.y);\n  }\n}\n\n","/**\n * Plugin based on discussion from the following Chart.js issues:\n * @see https://github.com/chartjs/Chart.js/issues/2380#issuecomment-279961569\n * @see https://github.com/chartjs/Chart.js/issues/2440#issuecomment-256461897\n */\n\nimport LineElement from '../../elements/element.line';\nimport {_drawfill} from './filler.drawing';\nimport {_shouldApplyFill} from './filler.helper';\nimport {_decodeFill, _resolveTarget} from './filler.options';\n\nexport default {\n  id: 'filler',\n\n  afterDatasetsUpdate(chart, _args, options) {\n    const count = (chart.data.datasets || []).length;\n    const sources = [];\n    let meta, i, line, source;\n\n    for (i = 0; i < count; ++i) {\n      meta = chart.getDatasetMeta(i);\n      line = meta.dataset;\n      source = null;\n\n      if (line && line.options && line instanceof LineElement) {\n        source = {\n          visible: chart.isDatasetVisible(i),\n          index: i,\n          fill: _decodeFill(line, i, count),\n          chart,\n          axis: meta.controller.options.indexAxis,\n          scale: meta.vScale,\n          line,\n        };\n      }\n\n      meta.$filler = source;\n      sources.push(source);\n    }\n\n    for (i = 0; i < count; ++i) {\n      source = sources[i];\n      if (!source || source.fill === false) {\n        continue;\n      }\n\n      source.fill = _resolveTarget(sources, i, options.propagate);\n    }\n  },\n\n  beforeDraw(chart, _args, options) {\n    const draw = options.drawTime === 'beforeDraw';\n    const metasets = chart.getSortedVisibleDatasetMetas();\n    const area = chart.chartArea;\n    for (let i = metasets.length - 1; i >= 0; --i) {\n      const source = metasets[i].$filler;\n      if (!source) {\n        continue;\n      }\n\n      source.line.updateControlPoints(area, source.axis);\n      if (draw && source.fill) {\n        _drawfill(chart.ctx, source, area);\n      }\n    }\n  },\n\n  beforeDatasetsDraw(chart, _args, options) {\n    if (options.drawTime !== 'beforeDatasetsDraw') {\n      return;\n    }\n\n    const metasets = chart.getSortedVisibleDatasetMetas();\n    for (let i = metasets.length - 1; i >= 0; --i) {\n      const source = metasets[i].$filler;\n\n      if (_shouldApplyFill(source)) {\n        _drawfill(chart.ctx, source, chart.chartArea);\n      }\n    }\n  },\n\n  beforeDatasetDraw(chart, args, options) {\n    const source = args.meta.$filler;\n\n    if (!_shouldApplyFill(source) || options.drawTime !== 'beforeDatasetDraw') {\n      return;\n    }\n\n    _drawfill(chart.ctx, source, chart.chartArea);\n  },\n\n  defaults: {\n    propagate: true,\n    drawTime: 'beforeDatasetDraw'\n  }\n};\n","import defaults from '../core/core.defaults';\nimport Element from '../core/core.element';\nimport layouts from '../core/core.layouts';\nimport {addRoundedRectPath, drawPointLegend, renderText} from '../helpers/helpers.canvas';\nimport {\n  _isBetween,\n  callback as call,\n  clipArea,\n  getRtlAdapter,\n  overrideTextDirection,\n  restoreTextDirection,\n  toFont,\n  toPadding,\n  unclipArea,\n  valueOrDefault,\n} from '../helpers/index';\nimport {_alignStartEnd, _textX, _toLeftRightCenter} from '../helpers/helpers.extras';\nimport {toTRBLCorners} from '../helpers/helpers.options';\n\n/**\n * @typedef { import(\"../../types\").ChartEvent } ChartEvent\n */\n\nconst getBoxSize = (labelOpts, fontSize) => {\n  let {boxHeight = fontSize, boxWidth = fontSize} = labelOpts;\n\n  if (labelOpts.usePointStyle) {\n    boxHeight = Math.min(boxHeight, fontSize);\n    boxWidth = labelOpts.pointStyleWidth || Math.min(boxWidth, fontSize);\n  }\n\n  return {\n    boxWidth,\n    boxHeight,\n    itemHeight: Math.max(fontSize, boxHeight)\n  };\n};\n\nconst itemsEqual = (a, b) => a !== null && b !== null && a.datasetIndex === b.datasetIndex && a.index === b.index;\n\nexport class Legend extends Element {\n\n  /**\n\t * @param {{ ctx: any; options: any; chart: any; }} config\n\t */\n  constructor(config) {\n    super();\n\n    this._added = false;\n\n    // Contains hit boxes for each dataset (in dataset order)\n    this.legendHitBoxes = [];\n\n    /**\n \t\t * @private\n \t\t */\n    this._hoveredItem = null;\n\n    // Are we in doughnut mode which has a different data type\n    this.doughnutMode = false;\n\n    this.chart = config.chart;\n    this.options = config.options;\n    this.ctx = config.ctx;\n    this.legendItems = undefined;\n    this.columnSizes = undefined;\n    this.lineWidths = undefined;\n    this.maxHeight = undefined;\n    this.maxWidth = undefined;\n    this.top = undefined;\n    this.bottom = undefined;\n    this.left = undefined;\n    this.right = undefined;\n    this.height = undefined;\n    this.width = undefined;\n    this._margins = undefined;\n    this.position = undefined;\n    this.weight = undefined;\n    this.fullSize = undefined;\n  }\n\n  update(maxWidth, maxHeight, margins) {\n    this.maxWidth = maxWidth;\n    this.maxHeight = maxHeight;\n    this._margins = margins;\n\n    this.setDimensions();\n    this.buildLabels();\n    this.fit();\n  }\n\n  setDimensions() {\n    if (this.isHorizontal()) {\n      this.width = this.maxWidth;\n      this.left = this._margins.left;\n      this.right = this.width;\n    } else {\n      this.height = this.maxHeight;\n      this.top = this._margins.top;\n      this.bottom = this.height;\n    }\n  }\n\n  buildLabels() {\n    const labelOpts = this.options.labels || {};\n    let legendItems = call(labelOpts.generateLabels, [this.chart], this) || [];\n\n    if (labelOpts.filter) {\n      legendItems = legendItems.filter((item) => labelOpts.filter(item, this.chart.data));\n    }\n\n    if (labelOpts.sort) {\n      legendItems = legendItems.sort((a, b) => labelOpts.sort(a, b, this.chart.data));\n    }\n\n    if (this.options.reverse) {\n      legendItems.reverse();\n    }\n\n    this.legendItems = legendItems;\n  }\n\n  fit() {\n    const {options, ctx} = this;\n\n    // The legend may not be displayed for a variety of reasons including\n    // the fact that the defaults got set to `false`.\n    // When the legend is not displayed, there are no guarantees that the options\n    // are correctly formatted so we need to bail out as early as possible.\n    if (!options.display) {\n      this.width = this.height = 0;\n      return;\n    }\n\n    const labelOpts = options.labels;\n    const labelFont = toFont(labelOpts.font);\n    const fontSize = labelFont.size;\n    const titleHeight = this._computeTitleHeight();\n    const {boxWidth, itemHeight} = getBoxSize(labelOpts, fontSize);\n\n    let width, height;\n\n    ctx.font = labelFont.string;\n\n    if (this.isHorizontal()) {\n      width = this.maxWidth; // fill all the width\n      height = this._fitRows(titleHeight, fontSize, boxWidth, itemHeight) + 10;\n    } else {\n      height = this.maxHeight; // fill all the height\n      width = this._fitCols(titleHeight, labelFont, boxWidth, itemHeight) + 10;\n    }\n\n    this.width = Math.min(width, options.maxWidth || this.maxWidth);\n    this.height = Math.min(height, options.maxHeight || this.maxHeight);\n  }\n\n  /**\n\t * @private\n\t */\n  _fitRows(titleHeight, fontSize, boxWidth, itemHeight) {\n    const {ctx, maxWidth, options: {labels: {padding}}} = this;\n    const hitboxes = this.legendHitBoxes = [];\n    // Width of each line of legend boxes. Labels wrap onto multiple lines when there are too many to fit on one\n    const lineWidths = this.lineWidths = [0];\n    const lineHeight = itemHeight + padding;\n    let totalHeight = titleHeight;\n\n    ctx.textAlign = 'left';\n    ctx.textBaseline = 'middle';\n\n    let row = -1;\n    let top = -lineHeight;\n    this.legendItems.forEach((legendItem, i) => {\n      const itemWidth = boxWidth + (fontSize / 2) + ctx.measureText(legendItem.text).width;\n\n      if (i === 0 || lineWidths[lineWidths.length - 1] + itemWidth + 2 * padding > maxWidth) {\n        totalHeight += lineHeight;\n        lineWidths[lineWidths.length - (i > 0 ? 0 : 1)] = 0;\n        top += lineHeight;\n        row++;\n      }\n\n      hitboxes[i] = {left: 0, top, row, width: itemWidth, height: itemHeight};\n\n      lineWidths[lineWidths.length - 1] += itemWidth + padding;\n    });\n\n    return totalHeight;\n  }\n\n  _fitCols(titleHeight, labelFont, boxWidth, _itemHeight) {\n    const {ctx, maxHeight, options: {labels: {padding}}} = this;\n    const hitboxes = this.legendHitBoxes = [];\n    const columnSizes = this.columnSizes = [];\n    const heightLimit = maxHeight - titleHeight;\n\n    let totalWidth = padding;\n    let currentColWidth = 0;\n    let currentColHeight = 0;\n\n    let left = 0;\n    let col = 0;\n\n    this.legendItems.forEach((legendItem, i) => {\n      const {itemWidth, itemHeight} = calculateItemSize(boxWidth, labelFont, ctx, legendItem, _itemHeight);\n\n      // If too tall, go to new column\n      if (i > 0 && currentColHeight + itemHeight + 2 * padding > heightLimit) {\n        totalWidth += currentColWidth + padding;\n        columnSizes.push({width: currentColWidth, height: currentColHeight}); // previous column size\n        left += currentColWidth + padding;\n        col++;\n        currentColWidth = currentColHeight = 0;\n      }\n\n      // Store the hitbox width and height here. Final position will be updated in `draw`\n      hitboxes[i] = {left, top: currentColHeight, col, width: itemWidth, height: itemHeight};\n\n      // Get max width\n      currentColWidth = Math.max(currentColWidth, itemWidth);\n      currentColHeight += itemHeight + padding;\n    });\n\n    totalWidth += currentColWidth;\n    columnSizes.push({width: currentColWidth, height: currentColHeight}); // previous column size\n\n    return totalWidth;\n  }\n\n  adjustHitBoxes() {\n    if (!this.options.display) {\n      return;\n    }\n    const titleHeight = this._computeTitleHeight();\n    const {legendHitBoxes: hitboxes, options: {align, labels: {padding}, rtl}} = this;\n    const rtlHelper = getRtlAdapter(rtl, this.left, this.width);\n    if (this.isHorizontal()) {\n      let row = 0;\n      let left = _alignStartEnd(align, this.left + padding, this.right - this.lineWidths[row]);\n      for (const hitbox of hitboxes) {\n        if (row !== hitbox.row) {\n          row = hitbox.row;\n          left = _alignStartEnd(align, this.left + padding, this.right - this.lineWidths[row]);\n        }\n        hitbox.top += this.top + titleHeight + padding;\n        hitbox.left = rtlHelper.leftForLtr(rtlHelper.x(left), hitbox.width);\n        left += hitbox.width + padding;\n      }\n    } else {\n      let col = 0;\n      let top = _alignStartEnd(align, this.top + titleHeight + padding, this.bottom - this.columnSizes[col].height);\n      for (const hitbox of hitboxes) {\n        if (hitbox.col !== col) {\n          col = hitbox.col;\n          top = _alignStartEnd(align, this.top + titleHeight + padding, this.bottom - this.columnSizes[col].height);\n        }\n        hitbox.top = top;\n        hitbox.left += this.left + padding;\n        hitbox.left = rtlHelper.leftForLtr(rtlHelper.x(hitbox.left), hitbox.width);\n        top += hitbox.height + padding;\n      }\n    }\n  }\n\n  isHorizontal() {\n    return this.options.position === 'top' || this.options.position === 'bottom';\n  }\n\n  draw() {\n    if (this.options.display) {\n      const ctx = this.ctx;\n      clipArea(ctx, this);\n\n      this._draw();\n\n      unclipArea(ctx);\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _draw() {\n    const {options: opts, columnSizes, lineWidths, ctx} = this;\n    const {align, labels: labelOpts} = opts;\n    const defaultColor = defaults.color;\n    const rtlHelper = getRtlAdapter(opts.rtl, this.left, this.width);\n    const labelFont = toFont(labelOpts.font);\n    const {padding} = labelOpts;\n    const fontSize = labelFont.size;\n    const halfFontSize = fontSize / 2;\n    let cursor;\n\n    this.drawTitle();\n\n    // Canvas setup\n    ctx.textAlign = rtlHelper.textAlign('left');\n    ctx.textBaseline = 'middle';\n    ctx.lineWidth = 0.5;\n    ctx.font = labelFont.string;\n\n    const {boxWidth, boxHeight, itemHeight} = getBoxSize(labelOpts, fontSize);\n\n    // current position\n    const drawLegendBox = function(x, y, legendItem) {\n      if (isNaN(boxWidth) || boxWidth <= 0 || isNaN(boxHeight) || boxHeight < 0) {\n        return;\n      }\n\n      // Set the ctx for the box\n      ctx.save();\n\n      const lineWidth = valueOrDefault(legendItem.lineWidth, 1);\n      ctx.fillStyle = valueOrDefault(legendItem.fillStyle, defaultColor);\n      ctx.lineCap = valueOrDefault(legendItem.lineCap, 'butt');\n      ctx.lineDashOffset = valueOrDefault(legendItem.lineDashOffset, 0);\n      ctx.lineJoin = valueOrDefault(legendItem.lineJoin, 'miter');\n      ctx.lineWidth = lineWidth;\n      ctx.strokeStyle = valueOrDefault(legendItem.strokeStyle, defaultColor);\n\n      ctx.setLineDash(valueOrDefault(legendItem.lineDash, []));\n\n      if (labelOpts.usePointStyle) {\n        // Recalculate x and y for drawPoint() because its expecting\n        // x and y to be center of figure (instead of top left)\n        const drawOptions = {\n          radius: boxHeight * Math.SQRT2 / 2,\n          pointStyle: legendItem.pointStyle,\n          rotation: legendItem.rotation,\n          borderWidth: lineWidth\n        };\n        const centerX = rtlHelper.xPlus(x, boxWidth / 2);\n        const centerY = y + halfFontSize;\n\n        // Draw pointStyle as legend symbol\n        drawPointLegend(ctx, drawOptions, centerX, centerY, labelOpts.pointStyleWidth && boxWidth);\n      } else {\n        // Draw box as legend symbol\n        // Adjust position when boxHeight < fontSize (want it centered)\n        const yBoxTop = y + Math.max((fontSize - boxHeight) / 2, 0);\n        const xBoxLeft = rtlHelper.leftForLtr(x, boxWidth);\n        const borderRadius = toTRBLCorners(legendItem.borderRadius);\n\n        ctx.beginPath();\n\n        if (Object.values(borderRadius).some(v => v !== 0)) {\n          addRoundedRectPath(ctx, {\n            x: xBoxLeft,\n            y: yBoxTop,\n            w: boxWidth,\n            h: boxHeight,\n            radius: borderRadius,\n          });\n        } else {\n          ctx.rect(xBoxLeft, yBoxTop, boxWidth, boxHeight);\n        }\n\n        ctx.fill();\n        if (lineWidth !== 0) {\n          ctx.stroke();\n        }\n      }\n\n      ctx.restore();\n    };\n\n    const fillText = function(x, y, legendItem) {\n      renderText(ctx, legendItem.text, x, y + (itemHeight / 2), labelFont, {\n        strikethrough: legendItem.hidden,\n        textAlign: rtlHelper.textAlign(legendItem.textAlign)\n      });\n    };\n\n    // Horizontal\n    const isHorizontal = this.isHorizontal();\n    const titleHeight = this._computeTitleHeight();\n    if (isHorizontal) {\n      cursor = {\n        x: _alignStartEnd(align, this.left + padding, this.right - lineWidths[0]),\n        y: this.top + padding + titleHeight,\n        line: 0\n      };\n    } else {\n      cursor = {\n        x: this.left + padding,\n        y: _alignStartEnd(align, this.top + titleHeight + padding, this.bottom - columnSizes[0].height),\n        line: 0\n      };\n    }\n\n    overrideTextDirection(this.ctx, opts.textDirection);\n\n    const lineHeight = itemHeight + padding;\n    this.legendItems.forEach((legendItem, i) => {\n      ctx.strokeStyle = legendItem.fontColor; // for strikethrough effect\n      ctx.fillStyle = legendItem.fontColor; // render in correct colour\n\n      const textWidth = ctx.measureText(legendItem.text).width;\n      const textAlign = rtlHelper.textAlign(legendItem.textAlign || (legendItem.textAlign = labelOpts.textAlign));\n      const width = boxWidth + halfFontSize + textWidth;\n      let x = cursor.x;\n      let y = cursor.y;\n\n      rtlHelper.setWidth(this.width);\n\n      if (isHorizontal) {\n        if (i > 0 && x + width + padding > this.right) {\n          y = cursor.y += lineHeight;\n          cursor.line++;\n          x = cursor.x = _alignStartEnd(align, this.left + padding, this.right - lineWidths[cursor.line]);\n        }\n      } else if (i > 0 && y + lineHeight > this.bottom) {\n        x = cursor.x = x + columnSizes[cursor.line].width + padding;\n        cursor.line++;\n        y = cursor.y = _alignStartEnd(align, this.top + titleHeight + padding, this.bottom - columnSizes[cursor.line].height);\n      }\n\n      const realX = rtlHelper.x(x);\n\n      drawLegendBox(realX, y, legendItem);\n\n      x = _textX(textAlign, x + boxWidth + halfFontSize, isHorizontal ? x + width : this.right, opts.rtl);\n\n      // Fill the actual label\n      fillText(rtlHelper.x(x), y, legendItem);\n\n      if (isHorizontal) {\n        cursor.x += width + padding;\n      } else if (typeof legendItem.text !== 'string') {\n        const fontLineHeight = labelFont.lineHeight;\n        cursor.y += calculateLegendItemHeight(legendItem, fontLineHeight);\n      } else {\n        cursor.y += lineHeight;\n      }\n    });\n\n    restoreTextDirection(this.ctx, opts.textDirection);\n  }\n\n  /**\n\t * @protected\n\t */\n  drawTitle() {\n    const opts = this.options;\n    const titleOpts = opts.title;\n    const titleFont = toFont(titleOpts.font);\n    const titlePadding = toPadding(titleOpts.padding);\n\n    if (!titleOpts.display) {\n      return;\n    }\n\n    const rtlHelper = getRtlAdapter(opts.rtl, this.left, this.width);\n    const ctx = this.ctx;\n    const position = titleOpts.position;\n    const halfFontSize = titleFont.size / 2;\n    const topPaddingPlusHalfFontSize = titlePadding.top + halfFontSize;\n    let y;\n\n    // These defaults are used when the legend is vertical.\n    // When horizontal, they are computed below.\n    let left = this.left;\n    let maxWidth = this.width;\n\n    if (this.isHorizontal()) {\n      // Move left / right so that the title is above the legend lines\n      maxWidth = Math.max(...this.lineWidths);\n      y = this.top + topPaddingPlusHalfFontSize;\n      left = _alignStartEnd(opts.align, left, this.right - maxWidth);\n    } else {\n      // Move down so that the title is above the legend stack in every alignment\n      const maxHeight = this.columnSizes.reduce((acc, size) => Math.max(acc, size.height), 0);\n      y = topPaddingPlusHalfFontSize + _alignStartEnd(opts.align, this.top, this.bottom - maxHeight - opts.labels.padding - this._computeTitleHeight());\n    }\n\n    // Now that we know the left edge of the inner legend box, compute the correct\n    // X coordinate from the title alignment\n    const x = _alignStartEnd(position, left, left + maxWidth);\n\n    // Canvas setup\n    ctx.textAlign = rtlHelper.textAlign(_toLeftRightCenter(position));\n    ctx.textBaseline = 'middle';\n    ctx.strokeStyle = titleOpts.color;\n    ctx.fillStyle = titleOpts.color;\n    ctx.font = titleFont.string;\n\n    renderText(ctx, titleOpts.text, x, y, titleFont);\n  }\n\n  /**\n\t * @private\n\t */\n  _computeTitleHeight() {\n    const titleOpts = this.options.title;\n    const titleFont = toFont(titleOpts.font);\n    const titlePadding = toPadding(titleOpts.padding);\n    return titleOpts.display ? titleFont.lineHeight + titlePadding.height : 0;\n  }\n\n  /**\n\t * @private\n\t */\n  _getLegendItemAt(x, y) {\n    let i, hitBox, lh;\n\n    if (_isBetween(x, this.left, this.right)\n      && _isBetween(y, this.top, this.bottom)) {\n      // See if we are touching one of the dataset boxes\n      lh = this.legendHitBoxes;\n      for (i = 0; i < lh.length; ++i) {\n        hitBox = lh[i];\n\n        if (_isBetween(x, hitBox.left, hitBox.left + hitBox.width)\n          && _isBetween(y, hitBox.top, hitBox.top + hitBox.height)) {\n          // Touching an element\n          return this.legendItems[i];\n        }\n      }\n    }\n\n    return null;\n  }\n\n  /**\n\t * Handle an event\n\t * @param {ChartEvent} e - The event to handle\n\t */\n  handleEvent(e) {\n    const opts = this.options;\n    if (!isListened(e.type, opts)) {\n      return;\n    }\n\n    // Chart event already has relative position in it\n    const hoveredItem = this._getLegendItemAt(e.x, e.y);\n\n    if (e.type === 'mousemove' || e.type === 'mouseout') {\n      const previous = this._hoveredItem;\n      const sameItem = itemsEqual(previous, hoveredItem);\n      if (previous && !sameItem) {\n        call(opts.onLeave, [e, previous, this], this);\n      }\n\n      this._hoveredItem = hoveredItem;\n\n      if (hoveredItem && !sameItem) {\n        call(opts.onHover, [e, hoveredItem, this], this);\n      }\n    } else if (hoveredItem) {\n      call(opts.onClick, [e, hoveredItem, this], this);\n    }\n  }\n}\n\nfunction calculateItemSize(boxWidth, labelFont, ctx, legendItem, _itemHeight) {\n  const itemWidth = calculateItemWidth(legendItem, boxWidth, labelFont, ctx);\n  const itemHeight = calculateItemHeight(_itemHeight, legendItem, labelFont.lineHeight);\n  return {itemWidth, itemHeight};\n}\n\nfunction calculateItemWidth(legendItem, boxWidth, labelFont, ctx) {\n  let legendItemText = legendItem.text;\n  if (legendItemText && typeof legendItemText !== 'string') {\n    legendItemText = legendItemText.reduce((a, b) => a.length > b.length ? a : b);\n  }\n  return boxWidth + (labelFont.size / 2) + ctx.measureText(legendItemText).width;\n}\n\nfunction calculateItemHeight(_itemHeight, legendItem, fontLineHeight) {\n  let itemHeight = _itemHeight;\n  if (typeof legendItem.text !== 'string') {\n    itemHeight = calculateLegendItemHeight(legendItem, fontLineHeight);\n  }\n  return itemHeight;\n}\n\nfunction calculateLegendItemHeight(legendItem, fontLineHeight) {\n  const labelHeight = legendItem.text ? legendItem.text.length + 0.5 : 0;\n  return fontLineHeight * labelHeight;\n}\n\nfunction isListened(type, opts) {\n  if ((type === 'mousemove' || type === 'mouseout') && (opts.onHover || opts.onLeave)) {\n    return true;\n  }\n  if (opts.onClick && (type === 'click' || type === 'mouseup')) {\n    return true;\n  }\n  return false;\n}\n\nexport default {\n  id: 'legend',\n\n  /**\n\t * For tests\n\t * @private\n\t */\n  _element: Legend,\n\n  start(chart, _args, options) {\n    const legend = chart.legend = new Legend({ctx: chart.ctx, options, chart});\n    layouts.configure(chart, legend, options);\n    layouts.addBox(chart, legend);\n  },\n\n  stop(chart) {\n    layouts.removeBox(chart, chart.legend);\n    delete chart.legend;\n  },\n\n  // During the beforeUpdate step, the layout configuration needs to run\n  // This ensures that if the legend position changes (via an option update)\n  // the layout system respects the change. See https://github.com/chartjs/Chart.js/issues/7527\n  beforeUpdate(chart, _args, options) {\n    const legend = chart.legend;\n    layouts.configure(chart, legend, options);\n    legend.options = options;\n  },\n\n  // The labels need to be built after datasets are updated to ensure that colors\n  // and other styling are correct. See https://github.com/chartjs/Chart.js/issues/6968\n  afterUpdate(chart) {\n    const legend = chart.legend;\n    legend.buildLabels();\n    legend.adjustHitBoxes();\n  },\n\n\n  afterEvent(chart, args) {\n    if (!args.replay) {\n      chart.legend.handleEvent(args.event);\n    }\n  },\n\n  defaults: {\n    display: true,\n    position: 'top',\n    align: 'center',\n    fullSize: true,\n    reverse: false,\n    weight: 1000,\n\n    // a callback that will handle\n    onClick(e, legendItem, legend) {\n      const index = legendItem.datasetIndex;\n      const ci = legend.chart;\n      if (ci.isDatasetVisible(index)) {\n        ci.hide(index);\n        legendItem.hidden = true;\n      } else {\n        ci.show(index);\n        legendItem.hidden = false;\n      }\n    },\n\n    onHover: null,\n    onLeave: null,\n\n    labels: {\n      color: (ctx) => ctx.chart.options.color,\n      boxWidth: 40,\n      padding: 10,\n      // Generates labels shown in the legend\n      // Valid properties to return:\n      // text : text to display\n      // fillStyle : fill of coloured box\n      // strokeStyle: stroke of coloured box\n      // hidden : if this legend item refers to a hidden item\n      // lineCap : cap style for line\n      // lineDash\n      // lineDashOffset :\n      // lineJoin :\n      // lineWidth :\n      generateLabels(chart) {\n        const datasets = chart.data.datasets;\n        const {labels: {usePointStyle, pointStyle, textAlign, color, useBorderRadius, borderRadius}} = chart.legend.options;\n\n        return chart._getSortedDatasetMetas().map((meta) => {\n          const style = meta.controller.getStyle(usePointStyle ? 0 : undefined);\n          const borderWidth = toPadding(style.borderWidth);\n\n          return {\n            text: datasets[meta.index].label,\n            fillStyle: style.backgroundColor,\n            fontColor: color,\n            hidden: !meta.visible,\n            lineCap: style.borderCapStyle,\n            lineDash: style.borderDash,\n            lineDashOffset: style.borderDashOffset,\n            lineJoin: style.borderJoinStyle,\n            lineWidth: (borderWidth.width + borderWidth.height) / 4,\n            strokeStyle: style.borderColor,\n            pointStyle: pointStyle || style.pointStyle,\n            rotation: style.rotation,\n            textAlign: textAlign || style.textAlign,\n            borderRadius: useBorderRadius && (borderRadius || style.borderRadius),\n\n            // Below is extra data used for toggling the datasets\n            datasetIndex: meta.index\n          };\n        }, this);\n      }\n    },\n\n    title: {\n      color: (ctx) => ctx.chart.options.color,\n      display: false,\n      position: 'center',\n      text: '',\n    }\n  },\n\n  descriptors: {\n    _scriptable: (name) => !name.startsWith('on'),\n    labels: {\n      _scriptable: (name) => !['generateLabels', 'filter', 'sort'].includes(name),\n    }\n  },\n};\n","import Element from '../core/core.element';\nimport layouts from '../core/core.layouts';\nimport {PI, isArray, toPadding, toFont} from '../helpers';\nimport {_toLeftRightCenter, _alignStartEnd} from '../helpers/helpers.extras';\nimport {renderText} from '../helpers/helpers.canvas';\n\nexport class Title extends Element {\n  /**\n\t * @param {{ ctx: any; options: any; chart: any; }} config\n\t */\n  constructor(config) {\n    super();\n\n    this.chart = config.chart;\n    this.options = config.options;\n    this.ctx = config.ctx;\n    this._padding = undefined;\n    this.top = undefined;\n    this.bottom = undefined;\n    this.left = undefined;\n    this.right = undefined;\n    this.width = undefined;\n    this.height = undefined;\n    this.position = undefined;\n    this.weight = undefined;\n    this.fullSize = undefined;\n  }\n\n  update(maxWidth, maxHeight) {\n    const opts = this.options;\n\n    this.left = 0;\n    this.top = 0;\n\n    if (!opts.display) {\n      this.width = this.height = this.right = this.bottom = 0;\n      return;\n    }\n\n    this.width = this.right = maxWidth;\n    this.height = this.bottom = maxHeight;\n\n    const lineCount = isArray(opts.text) ? opts.text.length : 1;\n    this._padding = toPadding(opts.padding);\n    const textSize = lineCount * toFont(opts.font).lineHeight + this._padding.height;\n\n    if (this.isHorizontal()) {\n      this.height = textSize;\n    } else {\n      this.width = textSize;\n    }\n  }\n\n  isHorizontal() {\n    const pos = this.options.position;\n    return pos === 'top' || pos === 'bottom';\n  }\n\n  _drawArgs(offset) {\n    const {top, left, bottom, right, options} = this;\n    const align = options.align;\n    let rotation = 0;\n    let maxWidth, titleX, titleY;\n\n    if (this.isHorizontal()) {\n      titleX = _alignStartEnd(align, left, right);\n      titleY = top + offset;\n      maxWidth = right - left;\n    } else {\n      if (options.position === 'left') {\n        titleX = left + offset;\n        titleY = _alignStartEnd(align, bottom, top);\n        rotation = PI * -0.5;\n      } else {\n        titleX = right - offset;\n        titleY = _alignStartEnd(align, top, bottom);\n        rotation = PI * 0.5;\n      }\n      maxWidth = bottom - top;\n    }\n    return {titleX, titleY, maxWidth, rotation};\n  }\n\n  draw() {\n    const ctx = this.ctx;\n    const opts = this.options;\n\n    if (!opts.display) {\n      return;\n    }\n\n    const fontOpts = toFont(opts.font);\n    const lineHeight = fontOpts.lineHeight;\n    const offset = lineHeight / 2 + this._padding.top;\n    const {titleX, titleY, maxWidth, rotation} = this._drawArgs(offset);\n\n    renderText(ctx, opts.text, 0, 0, fontOpts, {\n      color: opts.color,\n      maxWidth,\n      rotation,\n      textAlign: _toLeftRightCenter(opts.align),\n      textBaseline: 'middle',\n      translation: [titleX, titleY],\n    });\n  }\n}\n\nfunction createTitle(chart, titleOpts) {\n  const title = new Title({\n    ctx: chart.ctx,\n    options: titleOpts,\n    chart\n  });\n\n  layouts.configure(chart, title, titleOpts);\n  layouts.addBox(chart, title);\n  chart.titleBlock = title;\n}\n\nexport default {\n  id: 'title',\n\n  /**\n\t * For tests\n\t * @private\n\t */\n  _element: Title,\n\n  start(chart, _args, options) {\n    createTitle(chart, options);\n  },\n\n  stop(chart) {\n    const titleBlock = chart.titleBlock;\n    layouts.removeBox(chart, titleBlock);\n    delete chart.titleBlock;\n  },\n\n  beforeUpdate(chart, _args, options) {\n    const title = chart.titleBlock;\n    layouts.configure(chart, title, options);\n    title.options = options;\n  },\n\n  defaults: {\n    align: 'center',\n    display: false,\n    font: {\n      weight: 'bold',\n    },\n    fullSize: true,\n    padding: 10,\n    position: 'top',\n    text: '',\n    weight: 2000         // by default greater than legend (1000) to be above\n  },\n\n  defaultRoutes: {\n    color: 'color'\n  },\n\n  descriptors: {\n    _scriptable: true,\n    _indexable: false,\n  },\n};\n","import {Title} from './plugin.title';\nimport layouts from '../core/core.layouts';\n\nconst map = new WeakMap();\n\nexport default {\n  id: 'subtitle',\n\n  start(chart, _args, options) {\n    const title = new Title({\n      ctx: chart.ctx,\n      options,\n      chart\n    });\n\n    layouts.configure(chart, title, options);\n    layouts.addBox(chart, title);\n    map.set(chart, title);\n  },\n\n  stop(chart) {\n    layouts.removeBox(chart, map.get(chart));\n    map.delete(chart);\n  },\n\n  beforeUpdate(chart, _args, options) {\n    const title = map.get(chart);\n    layouts.configure(chart, title, options);\n    title.options = options;\n  },\n\n  defaults: {\n    align: 'center',\n    display: false,\n    font: {\n      weight: 'normal',\n    },\n    fullSize: true,\n    padding: 0,\n    position: 'top',\n    text: '',\n    weight: 1500         // by default greater than legend (1000) and smaller than title (2000)\n  },\n\n  defaultRoutes: {\n    color: 'color'\n  },\n\n  descriptors: {\n    _scriptable: true,\n    _indexable: false,\n  },\n};\n","import Animations from '../core/core.animations';\nimport Element from '../core/core.element';\nimport {addRoundedRectPath} from '../helpers/helpers.canvas';\nimport {each, noop, isNullOrUndef, isArray, _elementsEqual, isObject} from '../helpers/helpers.core';\nimport {toFont, toPadding, toTRBLCorners} from '../helpers/helpers.options';\nimport {getRtlAdapter, overrideTextDirection, restoreTextDirection} from '../helpers/helpers.rtl';\nimport {distanceBetweenPoints, _limitValue} from '../helpers/helpers.math';\nimport {createContext, drawPoint} from '../helpers';\n\n/**\n * @typedef { import(\"../platform/platform.base\").Chart } Chart\n * @typedef { import(\"../../types\").ChartEvent } ChartEvent\n * @typedef { import(\"../../types\").ActiveElement } ActiveElement\n * @typedef { import(\"../core/core.interaction\").InteractionItem } InteractionItem\n */\n\nconst positioners = {\n  /**\n\t * Average mode places the tooltip at the average position of the elements shown\n\t */\n  average(items) {\n    if (!items.length) {\n      return false;\n    }\n\n    let i, len;\n    let x = 0;\n    let y = 0;\n    let count = 0;\n\n    for (i = 0, len = items.length; i < len; ++i) {\n      const el = items[i].element;\n      if (el && el.hasValue()) {\n        const pos = el.tooltipPosition();\n        x += pos.x;\n        y += pos.y;\n        ++count;\n      }\n    }\n\n    return {\n      x: x / count,\n      y: y / count\n    };\n  },\n\n  /**\n\t * Gets the tooltip position nearest of the item nearest to the event position\n\t */\n  nearest(items, eventPosition) {\n    if (!items.length) {\n      return false;\n    }\n\n    let x = eventPosition.x;\n    let y = eventPosition.y;\n    let minDistance = Number.POSITIVE_INFINITY;\n    let i, len, nearestElement;\n\n    for (i = 0, len = items.length; i < len; ++i) {\n      const el = items[i].element;\n      if (el && el.hasValue()) {\n        const center = el.getCenterPoint();\n        const d = distanceBetweenPoints(eventPosition, center);\n\n        if (d < minDistance) {\n          minDistance = d;\n          nearestElement = el;\n        }\n      }\n    }\n\n    if (nearestElement) {\n      const tp = nearestElement.tooltipPosition();\n      x = tp.x;\n      y = tp.y;\n    }\n\n    return {\n      x,\n      y\n    };\n  }\n};\n\n// Helper to push or concat based on if the 2nd parameter is an array or not\nfunction pushOrConcat(base, toPush) {\n  if (toPush) {\n    if (isArray(toPush)) {\n      // base = base.concat(toPush);\n      Array.prototype.push.apply(base, toPush);\n    } else {\n      base.push(toPush);\n    }\n  }\n\n  return base;\n}\n\n/**\n * Returns array of strings split by newline\n * @param {*} str - The value to split by newline.\n * @returns {string|string[]} value if newline present - Returned from String split() method\n * @function\n */\nfunction splitNewlines(str) {\n  if ((typeof str === 'string' || str instanceof String) && str.indexOf('\\n') > -1) {\n    return str.split('\\n');\n  }\n  return str;\n}\n\n\n/**\n * Private helper to create a tooltip item model\n * @param {Chart} chart\n * @param {ActiveElement} item - {element, index, datasetIndex} to create the tooltip item for\n * @return new tooltip item\n */\nfunction createTooltipItem(chart, item) {\n  const {element, datasetIndex, index} = item;\n  const controller = chart.getDatasetMeta(datasetIndex).controller;\n  const {label, value} = controller.getLabelAndValue(index);\n\n  return {\n    chart,\n    label,\n    parsed: controller.getParsed(index),\n    raw: chart.data.datasets[datasetIndex].data[index],\n    formattedValue: value,\n    dataset: controller.getDataset(),\n    dataIndex: index,\n    datasetIndex,\n    element\n  };\n}\n\n/**\n * Get the size of the tooltip\n */\nfunction getTooltipSize(tooltip, options) {\n  const ctx = tooltip.chart.ctx;\n  const {body, footer, title} = tooltip;\n  const {boxWidth, boxHeight} = options;\n  const bodyFont = toFont(options.bodyFont);\n  const titleFont = toFont(options.titleFont);\n  const footerFont = toFont(options.footerFont);\n  const titleLineCount = title.length;\n  const footerLineCount = footer.length;\n  const bodyLineItemCount = body.length;\n\n  const padding = toPadding(options.padding);\n  let height = padding.height;\n  let width = 0;\n\n  // Count of all lines in the body\n  let combinedBodyLength = body.reduce((count, bodyItem) => count + bodyItem.before.length + bodyItem.lines.length + bodyItem.after.length, 0);\n  combinedBodyLength += tooltip.beforeBody.length + tooltip.afterBody.length;\n\n  if (titleLineCount) {\n    height += titleLineCount * titleFont.lineHeight\n\t\t\t+ (titleLineCount - 1) * options.titleSpacing\n\t\t\t+ options.titleMarginBottom;\n  }\n  if (combinedBodyLength) {\n    // Body lines may include some extra height depending on boxHeight\n    const bodyLineHeight = options.displayColors ? Math.max(boxHeight, bodyFont.lineHeight) : bodyFont.lineHeight;\n    height += bodyLineItemCount * bodyLineHeight\n\t\t\t+ (combinedBodyLength - bodyLineItemCount) * bodyFont.lineHeight\n\t\t\t+ (combinedBodyLength - 1) * options.bodySpacing;\n  }\n  if (footerLineCount) {\n    height += options.footerMarginTop\n\t\t\t+ footerLineCount * footerFont.lineHeight\n\t\t\t+ (footerLineCount - 1) * options.footerSpacing;\n  }\n\n  // Title width\n  let widthPadding = 0;\n  const maxLineWidth = function(line) {\n    width = Math.max(width, ctx.measureText(line).width + widthPadding);\n  };\n\n  ctx.save();\n\n  ctx.font = titleFont.string;\n  each(tooltip.title, maxLineWidth);\n\n  // Body width\n  ctx.font = bodyFont.string;\n  each(tooltip.beforeBody.concat(tooltip.afterBody), maxLineWidth);\n\n  // Body lines may include some extra width due to the color box\n  widthPadding = options.displayColors ? (boxWidth + 2 + options.boxPadding) : 0;\n  each(body, (bodyItem) => {\n    each(bodyItem.before, maxLineWidth);\n    each(bodyItem.lines, maxLineWidth);\n    each(bodyItem.after, maxLineWidth);\n  });\n\n  // Reset back to 0\n  widthPadding = 0;\n\n  // Footer width\n  ctx.font = footerFont.string;\n  each(tooltip.footer, maxLineWidth);\n\n  ctx.restore();\n\n  // Add padding\n  width += padding.width;\n\n  return {width, height};\n}\n\nfunction determineYAlign(chart, size) {\n  const {y, height} = size;\n\n  if (y < height / 2) {\n    return 'top';\n  } else if (y > (chart.height - height / 2)) {\n    return 'bottom';\n  }\n  return 'center';\n}\n\nfunction doesNotFitWithAlign(xAlign, chart, options, size) {\n  const {x, width} = size;\n  const caret = options.caretSize + options.caretPadding;\n  if (xAlign === 'left' && x + width + caret > chart.width) {\n    return true;\n  }\n\n  if (xAlign === 'right' && x - width - caret < 0) {\n    return true;\n  }\n}\n\nfunction determineXAlign(chart, options, size, yAlign) {\n  const {x, width} = size;\n  const {width: chartWidth, chartArea: {left, right}} = chart;\n  let xAlign = 'center';\n\n  if (yAlign === 'center') {\n    xAlign = x <= (left + right) / 2 ? 'left' : 'right';\n  } else if (x <= width / 2) {\n    xAlign = 'left';\n  } else if (x >= chartWidth - width / 2) {\n    xAlign = 'right';\n  }\n\n  if (doesNotFitWithAlign(xAlign, chart, options, size)) {\n    xAlign = 'center';\n  }\n\n  return xAlign;\n}\n\n/**\n * Helper to get the alignment of a tooltip given the size\n */\nfunction determineAlignment(chart, options, size) {\n  const yAlign = size.yAlign || options.yAlign || determineYAlign(chart, size);\n\n  return {\n    xAlign: size.xAlign || options.xAlign || determineXAlign(chart, options, size, yAlign),\n    yAlign\n  };\n}\n\nfunction alignX(size, xAlign) {\n  let {x, width} = size;\n  if (xAlign === 'right') {\n    x -= width;\n  } else if (xAlign === 'center') {\n    x -= (width / 2);\n  }\n  return x;\n}\n\nfunction alignY(size, yAlign, paddingAndSize) {\n  // eslint-disable-next-line prefer-const\n  let {y, height} = size;\n  if (yAlign === 'top') {\n    y += paddingAndSize;\n  } else if (yAlign === 'bottom') {\n    y -= height + paddingAndSize;\n  } else {\n    y -= (height / 2);\n  }\n  return y;\n}\n\n/**\n * Helper to get the location a tooltip needs to be placed at given the initial position (via the vm) and the size and alignment\n */\nfunction getBackgroundPoint(options, size, alignment, chart) {\n  const {caretSize, caretPadding, cornerRadius} = options;\n  const {xAlign, yAlign} = alignment;\n  const paddingAndSize = caretSize + caretPadding;\n  const {topLeft, topRight, bottomLeft, bottomRight} = toTRBLCorners(cornerRadius);\n\n  let x = alignX(size, xAlign);\n  const y = alignY(size, yAlign, paddingAndSize);\n\n  if (yAlign === 'center') {\n    if (xAlign === 'left') {\n      x += paddingAndSize;\n    } else if (xAlign === 'right') {\n      x -= paddingAndSize;\n    }\n  } else if (xAlign === 'left') {\n    x -= Math.max(topLeft, bottomLeft) + caretSize;\n  } else if (xAlign === 'right') {\n    x += Math.max(topRight, bottomRight) + caretSize;\n  }\n\n  return {\n    x: _limitValue(x, 0, chart.width - size.width),\n    y: _limitValue(y, 0, chart.height - size.height)\n  };\n}\n\nfunction getAlignedX(tooltip, align, options) {\n  const padding = toPadding(options.padding);\n\n  return align === 'center'\n    ? tooltip.x + tooltip.width / 2\n    : align === 'right'\n      ? tooltip.x + tooltip.width - padding.right\n      : tooltip.x + padding.left;\n}\n\n/**\n * Helper to build before and after body lines\n */\nfunction getBeforeAfterBodyLines(callback) {\n  return pushOrConcat([], splitNewlines(callback));\n}\n\nfunction createTooltipContext(parent, tooltip, tooltipItems) {\n  return createContext(parent, {\n    tooltip,\n    tooltipItems,\n    type: 'tooltip'\n  });\n}\n\nfunction overrideCallbacks(callbacks, context) {\n  const override = context && context.dataset && context.dataset.tooltip && context.dataset.tooltip.callbacks;\n  return override ? callbacks.override(override) : callbacks;\n}\n\nconst defaultCallbacks = {\n  // Args are: (tooltipItems, data)\n  beforeTitle: noop,\n  title(tooltipItems) {\n    if (tooltipItems.length > 0) {\n      const item = tooltipItems[0];\n      const labels = item.chart.data.labels;\n      const labelCount = labels ? labels.length : 0;\n\n      if (this && this.options && this.options.mode === 'dataset') {\n        return item.dataset.label || '';\n      } else if (item.label) {\n        return item.label;\n      } else if (labelCount > 0 && item.dataIndex < labelCount) {\n        return labels[item.dataIndex];\n      }\n    }\n\n    return '';\n  },\n  afterTitle: noop,\n\n  // Args are: (tooltipItems, data)\n  beforeBody: noop,\n\n  // Args are: (tooltipItem, data)\n  beforeLabel: noop,\n  label(tooltipItem) {\n    if (this && this.options && this.options.mode === 'dataset') {\n      return tooltipItem.label + ': ' + tooltipItem.formattedValue || tooltipItem.formattedValue;\n    }\n\n    let label = tooltipItem.dataset.label || '';\n\n    if (label) {\n      label += ': ';\n    }\n    const value = tooltipItem.formattedValue;\n    if (!isNullOrUndef(value)) {\n      label += value;\n    }\n    return label;\n  },\n  labelColor(tooltipItem) {\n    const meta = tooltipItem.chart.getDatasetMeta(tooltipItem.datasetIndex);\n    const options = meta.controller.getStyle(tooltipItem.dataIndex);\n    return {\n      borderColor: options.borderColor,\n      backgroundColor: options.backgroundColor,\n      borderWidth: options.borderWidth,\n      borderDash: options.borderDash,\n      borderDashOffset: options.borderDashOffset,\n      borderRadius: 0,\n    };\n  },\n  labelTextColor() {\n    return this.options.bodyColor;\n  },\n  labelPointStyle(tooltipItem) {\n    const meta = tooltipItem.chart.getDatasetMeta(tooltipItem.datasetIndex);\n    const options = meta.controller.getStyle(tooltipItem.dataIndex);\n    return {\n      pointStyle: options.pointStyle,\n      rotation: options.rotation,\n    };\n  },\n  afterLabel: noop,\n\n  // Args are: (tooltipItems, data)\n  afterBody: noop,\n\n  // Args are: (tooltipItems, data)\n  beforeFooter: noop,\n  footer: noop,\n  afterFooter: noop\n};\n\n/**\n * Invoke callback from object with context and arguments.\n * If callback returns `undefined`, then will be invoked default callback.\n * @param {Record<keyof typeof defaultCallbacks, Function>} callbacks\n * @param {keyof typeof defaultCallbacks} name\n * @param {*} ctx\n * @param {*} arg\n * @returns {any}\n */\nfunction invokeCallbackWithFallback(callbacks, name, ctx, arg) {\n  const result = callbacks[name].call(ctx, arg);\n\n  if (typeof result === 'undefined') {\n    return defaultCallbacks[name].call(ctx, arg);\n  }\n\n  return result;\n}\n\nexport class Tooltip extends Element {\n\n  /**\n   * @namespace Chart.Tooltip.positioners\n   */\n  static positioners = positioners;\n\n  constructor(config) {\n    super();\n\n    this.opacity = 0;\n    this._active = [];\n    this._eventPosition = undefined;\n    this._size = undefined;\n    this._cachedAnimations = undefined;\n    this._tooltipItems = [];\n    this.$animations = undefined;\n    this.$context = undefined;\n    this.chart = config.chart;\n    this.options = config.options;\n    this.dataPoints = undefined;\n    this.title = undefined;\n    this.beforeBody = undefined;\n    this.body = undefined;\n    this.afterBody = undefined;\n    this.footer = undefined;\n    this.xAlign = undefined;\n    this.yAlign = undefined;\n    this.x = undefined;\n    this.y = undefined;\n    this.height = undefined;\n    this.width = undefined;\n    this.caretX = undefined;\n    this.caretY = undefined;\n    // TODO: V4, make this private, rename to `_labelStyles`, and combine with `labelPointStyles`\n    // and `labelTextColors` to create a single variable\n    this.labelColors = undefined;\n    this.labelPointStyles = undefined;\n    this.labelTextColors = undefined;\n  }\n\n  initialize(options) {\n    this.options = options;\n    this._cachedAnimations = undefined;\n    this.$context = undefined;\n  }\n\n  /**\n\t * @private\n\t */\n  _resolveAnimations() {\n    const cached = this._cachedAnimations;\n\n    if (cached) {\n      return cached;\n    }\n\n    const chart = this.chart;\n    const options = this.options.setContext(this.getContext());\n    const opts = options.enabled && chart.options.animation && options.animations;\n    const animations = new Animations(this.chart, opts);\n    if (opts._cacheable) {\n      this._cachedAnimations = Object.freeze(animations);\n    }\n\n    return animations;\n  }\n\n  /**\n\t * @protected\n\t */\n  getContext() {\n    return this.$context ||\n\t\t\t(this.$context = createTooltipContext(this.chart.getContext(), this, this._tooltipItems));\n  }\n\n  getTitle(context, options) {\n    const {callbacks} = options;\n\n    const beforeTitle = invokeCallbackWithFallback(callbacks, 'beforeTitle', this, context);\n    const title = invokeCallbackWithFallback(callbacks, 'title', this, context);\n    const afterTitle = invokeCallbackWithFallback(callbacks, 'afterTitle', this, context);\n\n    let lines = [];\n    lines = pushOrConcat(lines, splitNewlines(beforeTitle));\n    lines = pushOrConcat(lines, splitNewlines(title));\n    lines = pushOrConcat(lines, splitNewlines(afterTitle));\n\n    return lines;\n  }\n\n  getBeforeBody(tooltipItems, options) {\n    return getBeforeAfterBodyLines(\n      invokeCallbackWithFallback(options.callbacks, 'beforeBody', this, tooltipItems)\n    );\n  }\n\n  getBody(tooltipItems, options) {\n    const {callbacks} = options;\n    const bodyItems = [];\n\n    each(tooltipItems, (context) => {\n      const bodyItem = {\n        before: [],\n        lines: [],\n        after: []\n      };\n      const scoped = overrideCallbacks(callbacks, context);\n      pushOrConcat(bodyItem.before, splitNewlines(invokeCallbackWithFallback(scoped, 'beforeLabel', this, context)));\n      pushOrConcat(bodyItem.lines, invokeCallbackWithFallback(scoped, 'label', this, context));\n      pushOrConcat(bodyItem.after, splitNewlines(invokeCallbackWithFallback(scoped, 'afterLabel', this, context)));\n\n      bodyItems.push(bodyItem);\n    });\n\n    return bodyItems;\n  }\n\n  getAfterBody(tooltipItems, options) {\n    return getBeforeAfterBodyLines(\n      invokeCallbackWithFallback(options.callbacks, 'afterBody', this, tooltipItems)\n    );\n  }\n\n  // Get the footer and beforeFooter and afterFooter lines\n  getFooter(tooltipItems, options) {\n    const {callbacks} = options;\n\n    const beforeFooter = invokeCallbackWithFallback(callbacks, 'beforeFooter', this, tooltipItems);\n    const footer = invokeCallbackWithFallback(callbacks, 'footer', this, tooltipItems);\n    const afterFooter = invokeCallbackWithFallback(callbacks, 'afterFooter', this, tooltipItems);\n\n    let lines = [];\n    lines = pushOrConcat(lines, splitNewlines(beforeFooter));\n    lines = pushOrConcat(lines, splitNewlines(footer));\n    lines = pushOrConcat(lines, splitNewlines(afterFooter));\n\n    return lines;\n  }\n\n  /**\n\t * @private\n\t */\n  _createItems(options) {\n    const active = this._active;\n    const data = this.chart.data;\n    const labelColors = [];\n    const labelPointStyles = [];\n    const labelTextColors = [];\n    let tooltipItems = [];\n    let i, len;\n\n    for (i = 0, len = active.length; i < len; ++i) {\n      tooltipItems.push(createTooltipItem(this.chart, active[i]));\n    }\n\n    // If the user provided a filter function, use it to modify the tooltip items\n    if (options.filter) {\n      tooltipItems = tooltipItems.filter((element, index, array) => options.filter(element, index, array, data));\n    }\n\n    // If the user provided a sorting function, use it to modify the tooltip items\n    if (options.itemSort) {\n      tooltipItems = tooltipItems.sort((a, b) => options.itemSort(a, b, data));\n    }\n\n    // Determine colors for boxes\n    each(tooltipItems, (context) => {\n      const scoped = overrideCallbacks(options.callbacks, context);\n      labelColors.push(invokeCallbackWithFallback(scoped, 'labelColor', this, context));\n      labelPointStyles.push(invokeCallbackWithFallback(scoped, 'labelPointStyle', this, context));\n      labelTextColors.push(invokeCallbackWithFallback(scoped, 'labelTextColor', this, context));\n    });\n\n    this.labelColors = labelColors;\n    this.labelPointStyles = labelPointStyles;\n    this.labelTextColors = labelTextColors;\n    this.dataPoints = tooltipItems;\n    return tooltipItems;\n  }\n\n  update(changed, replay) {\n    const options = this.options.setContext(this.getContext());\n    const active = this._active;\n    let properties;\n    let tooltipItems = [];\n\n    if (!active.length) {\n      if (this.opacity !== 0) {\n        properties = {\n          opacity: 0\n        };\n      }\n    } else {\n      const position = positioners[options.position].call(this, active, this._eventPosition);\n      tooltipItems = this._createItems(options);\n\n      this.title = this.getTitle(tooltipItems, options);\n      this.beforeBody = this.getBeforeBody(tooltipItems, options);\n      this.body = this.getBody(tooltipItems, options);\n      this.afterBody = this.getAfterBody(tooltipItems, options);\n      this.footer = this.getFooter(tooltipItems, options);\n\n      const size = this._size = getTooltipSize(this, options);\n      const positionAndSize = Object.assign({}, position, size);\n      const alignment = determineAlignment(this.chart, options, positionAndSize);\n      const backgroundPoint = getBackgroundPoint(options, positionAndSize, alignment, this.chart);\n\n      this.xAlign = alignment.xAlign;\n      this.yAlign = alignment.yAlign;\n\n      properties = {\n        opacity: 1,\n        x: backgroundPoint.x,\n        y: backgroundPoint.y,\n        width: size.width,\n        height: size.height,\n        caretX: position.x,\n        caretY: position.y\n      };\n    }\n\n    this._tooltipItems = tooltipItems;\n    this.$context = undefined;\n\n    if (properties) {\n      this._resolveAnimations().update(this, properties);\n    }\n\n    if (changed && options.external) {\n      options.external.call(this, {chart: this.chart, tooltip: this, replay});\n    }\n  }\n\n  drawCaret(tooltipPoint, ctx, size, options) {\n    const caretPosition = this.getCaretPosition(tooltipPoint, size, options);\n\n    ctx.lineTo(caretPosition.x1, caretPosition.y1);\n    ctx.lineTo(caretPosition.x2, caretPosition.y2);\n    ctx.lineTo(caretPosition.x3, caretPosition.y3);\n  }\n\n  getCaretPosition(tooltipPoint, size, options) {\n    const {xAlign, yAlign} = this;\n    const {caretSize, cornerRadius} = options;\n    const {topLeft, topRight, bottomLeft, bottomRight} = toTRBLCorners(cornerRadius);\n    const {x: ptX, y: ptY} = tooltipPoint;\n    const {width, height} = size;\n    let x1, x2, x3, y1, y2, y3;\n\n    if (yAlign === 'center') {\n      y2 = ptY + (height / 2);\n\n      if (xAlign === 'left') {\n        x1 = ptX;\n        x2 = x1 - caretSize;\n\n        // Left draws bottom -> top, this y1 is on the bottom\n        y1 = y2 + caretSize;\n        y3 = y2 - caretSize;\n      } else {\n        x1 = ptX + width;\n        x2 = x1 + caretSize;\n\n        // Right draws top -> bottom, thus y1 is on the top\n        y1 = y2 - caretSize;\n        y3 = y2 + caretSize;\n      }\n\n      x3 = x1;\n    } else {\n      if (xAlign === 'left') {\n        x2 = ptX + Math.max(topLeft, bottomLeft) + (caretSize);\n      } else if (xAlign === 'right') {\n        x2 = ptX + width - Math.max(topRight, bottomRight) - caretSize;\n      } else {\n        x2 = this.caretX;\n      }\n\n      if (yAlign === 'top') {\n        y1 = ptY;\n        y2 = y1 - caretSize;\n\n        // Top draws left -> right, thus x1 is on the left\n        x1 = x2 - caretSize;\n        x3 = x2 + caretSize;\n      } else {\n        y1 = ptY + height;\n        y2 = y1 + caretSize;\n\n        // Bottom draws right -> left, thus x1 is on the right\n        x1 = x2 + caretSize;\n        x3 = x2 - caretSize;\n      }\n      y3 = y1;\n    }\n    return {x1, x2, x3, y1, y2, y3};\n  }\n\n  drawTitle(pt, ctx, options) {\n    const title = this.title;\n    const length = title.length;\n    let titleFont, titleSpacing, i;\n\n    if (length) {\n      const rtlHelper = getRtlAdapter(options.rtl, this.x, this.width);\n\n      pt.x = getAlignedX(this, options.titleAlign, options);\n\n      ctx.textAlign = rtlHelper.textAlign(options.titleAlign);\n      ctx.textBaseline = 'middle';\n\n      titleFont = toFont(options.titleFont);\n      titleSpacing = options.titleSpacing;\n\n      ctx.fillStyle = options.titleColor;\n      ctx.font = titleFont.string;\n\n      for (i = 0; i < length; ++i) {\n        ctx.fillText(title[i], rtlHelper.x(pt.x), pt.y + titleFont.lineHeight / 2);\n        pt.y += titleFont.lineHeight + titleSpacing; // Line Height and spacing\n\n        if (i + 1 === length) {\n          pt.y += options.titleMarginBottom - titleSpacing; // If Last, add margin, remove spacing\n        }\n      }\n    }\n  }\n\n  /**\n\t * @private\n\t */\n  _drawColorBox(ctx, pt, i, rtlHelper, options) {\n    const labelColors = this.labelColors[i];\n    const labelPointStyle = this.labelPointStyles[i];\n    const {boxHeight, boxWidth, boxPadding} = options;\n    const bodyFont = toFont(options.bodyFont);\n    const colorX = getAlignedX(this, 'left', options);\n    const rtlColorX = rtlHelper.x(colorX);\n    const yOffSet = boxHeight < bodyFont.lineHeight ? (bodyFont.lineHeight - boxHeight) / 2 : 0;\n    const colorY = pt.y + yOffSet;\n\n    if (options.usePointStyle) {\n      const drawOptions = {\n        radius: Math.min(boxWidth, boxHeight) / 2, // fit the circle in the box\n        pointStyle: labelPointStyle.pointStyle,\n        rotation: labelPointStyle.rotation,\n        borderWidth: 1\n      };\n      // Recalculate x and y for drawPoint() because its expecting\n      // x and y to be center of figure (instead of top left)\n      const centerX = rtlHelper.leftForLtr(rtlColorX, boxWidth) + boxWidth / 2;\n      const centerY = colorY + boxHeight / 2;\n\n      // Fill the point with white so that colours merge nicely if the opacity is < 1\n      ctx.strokeStyle = options.multiKeyBackground;\n      ctx.fillStyle = options.multiKeyBackground;\n      drawPoint(ctx, drawOptions, centerX, centerY);\n\n      // Draw the point\n      ctx.strokeStyle = labelColors.borderColor;\n      ctx.fillStyle = labelColors.backgroundColor;\n      drawPoint(ctx, drawOptions, centerX, centerY);\n    } else {\n      // Border\n      ctx.lineWidth = isObject(labelColors.borderWidth) ? Math.max(...Object.values(labelColors.borderWidth)) : (labelColors.borderWidth || 1); // TODO, v4 remove fallback\n      ctx.strokeStyle = labelColors.borderColor;\n      ctx.setLineDash(labelColors.borderDash || []);\n      ctx.lineDashOffset = labelColors.borderDashOffset || 0;\n\n      // Fill a white rect so that colours merge nicely if the opacity is < 1\n      const outerX = rtlHelper.leftForLtr(rtlColorX, boxWidth - boxPadding);\n      const innerX = rtlHelper.leftForLtr(rtlHelper.xPlus(rtlColorX, 1), boxWidth - boxPadding - 2);\n      const borderRadius = toTRBLCorners(labelColors.borderRadius);\n\n      if (Object.values(borderRadius).some(v => v !== 0)) {\n        ctx.beginPath();\n        ctx.fillStyle = options.multiKeyBackground;\n        addRoundedRectPath(ctx, {\n          x: outerX,\n          y: colorY,\n          w: boxWidth,\n          h: boxHeight,\n          radius: borderRadius,\n        });\n        ctx.fill();\n        ctx.stroke();\n\n        // Inner square\n        ctx.fillStyle = labelColors.backgroundColor;\n        ctx.beginPath();\n        addRoundedRectPath(ctx, {\n          x: innerX,\n          y: colorY + 1,\n          w: boxWidth - 2,\n          h: boxHeight - 2,\n          radius: borderRadius,\n        });\n        ctx.fill();\n      } else {\n        // Normal rect\n        ctx.fillStyle = options.multiKeyBackground;\n        ctx.fillRect(outerX, colorY, boxWidth, boxHeight);\n        ctx.strokeRect(outerX, colorY, boxWidth, boxHeight);\n        // Inner square\n        ctx.fillStyle = labelColors.backgroundColor;\n        ctx.fillRect(innerX, colorY + 1, boxWidth - 2, boxHeight - 2);\n      }\n    }\n\n    // restore fillStyle\n    ctx.fillStyle = this.labelTextColors[i];\n  }\n\n  drawBody(pt, ctx, options) {\n    const {body} = this;\n    const {bodySpacing, bodyAlign, displayColors, boxHeight, boxWidth, boxPadding} = options;\n    const bodyFont = toFont(options.bodyFont);\n    let bodyLineHeight = bodyFont.lineHeight;\n    let xLinePadding = 0;\n\n    const rtlHelper = getRtlAdapter(options.rtl, this.x, this.width);\n\n    const fillLineOfText = function(line) {\n      ctx.fillText(line, rtlHelper.x(pt.x + xLinePadding), pt.y + bodyLineHeight / 2);\n      pt.y += bodyLineHeight + bodySpacing;\n    };\n\n    const bodyAlignForCalculation = rtlHelper.textAlign(bodyAlign);\n    let bodyItem, textColor, lines, i, j, ilen, jlen;\n\n    ctx.textAlign = bodyAlign;\n    ctx.textBaseline = 'middle';\n    ctx.font = bodyFont.string;\n\n    pt.x = getAlignedX(this, bodyAlignForCalculation, options);\n\n    // Before body lines\n    ctx.fillStyle = options.bodyColor;\n    each(this.beforeBody, fillLineOfText);\n\n    xLinePadding = displayColors && bodyAlignForCalculation !== 'right'\n      ? bodyAlign === 'center' ? (boxWidth / 2 + boxPadding) : (boxWidth + 2 + boxPadding)\n      : 0;\n\n    // Draw body lines now\n    for (i = 0, ilen = body.length; i < ilen; ++i) {\n      bodyItem = body[i];\n      textColor = this.labelTextColors[i];\n\n      ctx.fillStyle = textColor;\n      each(bodyItem.before, fillLineOfText);\n\n      lines = bodyItem.lines;\n      // Draw Legend-like boxes if needed\n      if (displayColors && lines.length) {\n        this._drawColorBox(ctx, pt, i, rtlHelper, options);\n        bodyLineHeight = Math.max(bodyFont.lineHeight, boxHeight);\n      }\n\n      for (j = 0, jlen = lines.length; j < jlen; ++j) {\n        fillLineOfText(lines[j]);\n        // Reset for any lines that don't include colorbox\n        bodyLineHeight = bodyFont.lineHeight;\n      }\n\n      each(bodyItem.after, fillLineOfText);\n    }\n\n    // Reset back to 0 for after body\n    xLinePadding = 0;\n    bodyLineHeight = bodyFont.lineHeight;\n\n    // After body lines\n    each(this.afterBody, fillLineOfText);\n    pt.y -= bodySpacing; // Remove last body spacing\n  }\n\n  drawFooter(pt, ctx, options) {\n    const footer = this.footer;\n    const length = footer.length;\n    let footerFont, i;\n\n    if (length) {\n      const rtlHelper = getRtlAdapter(options.rtl, this.x, this.width);\n\n      pt.x = getAlignedX(this, options.footerAlign, options);\n      pt.y += options.footerMarginTop;\n\n      ctx.textAlign = rtlHelper.textAlign(options.footerAlign);\n      ctx.textBaseline = 'middle';\n\n      footerFont = toFont(options.footerFont);\n\n      ctx.fillStyle = options.footerColor;\n      ctx.font = footerFont.string;\n\n      for (i = 0; i < length; ++i) {\n        ctx.fillText(footer[i], rtlHelper.x(pt.x), pt.y + footerFont.lineHeight / 2);\n        pt.y += footerFont.lineHeight + options.footerSpacing;\n      }\n    }\n  }\n\n  drawBackground(pt, ctx, tooltipSize, options) {\n    const {xAlign, yAlign} = this;\n    const {x, y} = pt;\n    const {width, height} = tooltipSize;\n    const {topLeft, topRight, bottomLeft, bottomRight} = toTRBLCorners(options.cornerRadius);\n\n    ctx.fillStyle = options.backgroundColor;\n    ctx.strokeStyle = options.borderColor;\n    ctx.lineWidth = options.borderWidth;\n\n    ctx.beginPath();\n    ctx.moveTo(x + topLeft, y);\n    if (yAlign === 'top') {\n      this.drawCaret(pt, ctx, tooltipSize, options);\n    }\n    ctx.lineTo(x + width - topRight, y);\n    ctx.quadraticCurveTo(x + width, y, x + width, y + topRight);\n    if (yAlign === 'center' && xAlign === 'right') {\n      this.drawCaret(pt, ctx, tooltipSize, options);\n    }\n    ctx.lineTo(x + width, y + height - bottomRight);\n    ctx.quadraticCurveTo(x + width, y + height, x + width - bottomRight, y + height);\n    if (yAlign === 'bottom') {\n      this.drawCaret(pt, ctx, tooltipSize, options);\n    }\n    ctx.lineTo(x + bottomLeft, y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - bottomLeft);\n    if (yAlign === 'center' && xAlign === 'left') {\n      this.drawCaret(pt, ctx, tooltipSize, options);\n    }\n    ctx.lineTo(x, y + topLeft);\n    ctx.quadraticCurveTo(x, y, x + topLeft, y);\n    ctx.closePath();\n\n    ctx.fill();\n\n    if (options.borderWidth > 0) {\n      ctx.stroke();\n    }\n  }\n\n  /**\n\t * Update x/y animation targets when _active elements are animating too\n\t * @private\n\t */\n  _updateAnimationTarget(options) {\n    const chart = this.chart;\n    const anims = this.$animations;\n    const animX = anims && anims.x;\n    const animY = anims && anims.y;\n    if (animX || animY) {\n      const position = positioners[options.position].call(this, this._active, this._eventPosition);\n      if (!position) {\n        return;\n      }\n      const size = this._size = getTooltipSize(this, options);\n      const positionAndSize = Object.assign({}, position, this._size);\n      const alignment = determineAlignment(chart, options, positionAndSize);\n      const point = getBackgroundPoint(options, positionAndSize, alignment, chart);\n      if (animX._to !== point.x || animY._to !== point.y) {\n        this.xAlign = alignment.xAlign;\n        this.yAlign = alignment.yAlign;\n        this.width = size.width;\n        this.height = size.height;\n        this.caretX = position.x;\n        this.caretY = position.y;\n        this._resolveAnimations().update(this, point);\n      }\n    }\n  }\n\n  /**\n   * Determine if the tooltip will draw anything\n   * @returns {boolean} True if the tooltip will render\n   */\n  _willRender() {\n    return !!this.opacity;\n  }\n\n  draw(ctx) {\n    const options = this.options.setContext(this.getContext());\n    let opacity = this.opacity;\n\n    if (!opacity) {\n      return;\n    }\n\n    this._updateAnimationTarget(options);\n\n    const tooltipSize = {\n      width: this.width,\n      height: this.height\n    };\n    const pt = {\n      x: this.x,\n      y: this.y\n    };\n\n    // IE11/Edge does not like very small opacities, so snap to 0\n    opacity = Math.abs(opacity) < 1e-3 ? 0 : opacity;\n\n    const padding = toPadding(options.padding);\n\n    // Truthy/falsey value for empty tooltip\n    const hasTooltipContent = this.title.length || this.beforeBody.length || this.body.length || this.afterBody.length || this.footer.length;\n\n    if (options.enabled && hasTooltipContent) {\n      ctx.save();\n      ctx.globalAlpha = opacity;\n\n      // Draw Background\n      this.drawBackground(pt, ctx, tooltipSize, options);\n\n      overrideTextDirection(ctx, options.textDirection);\n\n      pt.y += padding.top;\n\n      // Titles\n      this.drawTitle(pt, ctx, options);\n\n      // Body\n      this.drawBody(pt, ctx, options);\n\n      // Footer\n      this.drawFooter(pt, ctx, options);\n\n      restoreTextDirection(ctx, options.textDirection);\n\n      ctx.restore();\n    }\n  }\n\n  /**\n\t * Get active elements in the tooltip\n\t * @returns {Array} Array of elements that are active in the tooltip\n\t */\n  getActiveElements() {\n    return this._active || [];\n  }\n\n  /**\n\t * Set active elements in the tooltip\n\t * @param {array} activeElements Array of active datasetIndex/index pairs.\n\t * @param {object} eventPosition Synthetic event position used in positioning\n\t */\n  setActiveElements(activeElements, eventPosition) {\n    const lastActive = this._active;\n    const active = activeElements.map(({datasetIndex, index}) => {\n      const meta = this.chart.getDatasetMeta(datasetIndex);\n\n      if (!meta) {\n        throw new Error('Cannot find a dataset at index ' + datasetIndex);\n      }\n\n      return {\n        datasetIndex,\n        element: meta.data[index],\n        index,\n      };\n    });\n    const changed = !_elementsEqual(lastActive, active);\n    const positionChanged = this._positionChanged(active, eventPosition);\n\n    if (changed || positionChanged) {\n      this._active = active;\n      this._eventPosition = eventPosition;\n      this._ignoreReplayEvents = true;\n      this.update(true);\n    }\n  }\n\n  /**\n\t * Handle an event\n\t * @param {ChartEvent} e - The event to handle\n\t * @param {boolean} [replay] - This is a replayed event (from update)\n\t * @param {boolean} [inChartArea] - The event is inside chartArea\n\t * @returns {boolean} true if the tooltip changed\n\t */\n  handleEvent(e, replay, inChartArea = true) {\n    if (replay && this._ignoreReplayEvents) {\n      return false;\n    }\n    this._ignoreReplayEvents = false;\n\n    const options = this.options;\n    const lastActive = this._active || [];\n    const active = this._getActiveElements(e, lastActive, replay, inChartArea);\n\n    // When there are multiple items shown, but the tooltip position is nearest mode\n    // an update may need to be made because our position may have changed even though\n    // the items are the same as before.\n    const positionChanged = this._positionChanged(active, e);\n\n    // Remember Last Actives\n    const changed = replay || !_elementsEqual(active, lastActive) || positionChanged;\n\n    // Only handle target event on tooltip change\n    if (changed) {\n      this._active = active;\n\n      if (options.enabled || options.external) {\n        this._eventPosition = {\n          x: e.x,\n          y: e.y\n        };\n\n        this.update(true, replay);\n      }\n    }\n\n    return changed;\n  }\n\n  /**\n\t * Helper for determining the active elements for event\n\t * @param {ChartEvent} e - The event to handle\n\t * @param {InteractionItem[]} lastActive - Previously active elements\n\t * @param {boolean} [replay] - This is a replayed event (from update)\n\t * @param {boolean} [inChartArea] - The event is inside chartArea\n\t * @returns {InteractionItem[]} - Active elements\n\t * @private\n\t */\n  _getActiveElements(e, lastActive, replay, inChartArea) {\n    const options = this.options;\n\n    if (e.type === 'mouseout') {\n      return [];\n    }\n\n    if (!inChartArea) {\n      // Let user control the active elements outside chartArea. Eg. using Legend.\n      return lastActive;\n    }\n\n    // Find Active Elements for tooltips\n    const active = this.chart.getElementsAtEventForMode(e, options.mode, options, replay);\n\n    if (options.reverse) {\n      active.reverse();\n    }\n\n    return active;\n  }\n\n  /**\n\t * Determine if the active elements + event combination changes the\n\t * tooltip position\n\t * @param {array} active - Active elements\n\t * @param {ChartEvent} e - Event that triggered the position change\n\t * @returns {boolean} True if the position has changed\n\t */\n  _positionChanged(active, e) {\n    const {caretX, caretY, options} = this;\n    const position = positioners[options.position].call(this, active, e);\n    return position !== false && (caretX !== position.x || caretY !== position.y);\n  }\n}\n\nexport default {\n  id: 'tooltip',\n  _element: Tooltip,\n  positioners,\n\n  afterInit(chart, _args, options) {\n    if (options) {\n      chart.tooltip = new Tooltip({chart, options});\n    }\n  },\n\n  beforeUpdate(chart, _args, options) {\n    if (chart.tooltip) {\n      chart.tooltip.initialize(options);\n    }\n  },\n\n  reset(chart, _args, options) {\n    if (chart.tooltip) {\n      chart.tooltip.initialize(options);\n    }\n  },\n\n  afterDraw(chart) {\n    const tooltip = chart.tooltip;\n\n    if (tooltip && tooltip._willRender()) {\n      const args = {\n        tooltip\n      };\n\n      if (chart.notifyPlugins('beforeTooltipDraw', {...args, cancelable: true}) === false) {\n        return;\n      }\n\n      tooltip.draw(chart.ctx);\n\n      chart.notifyPlugins('afterTooltipDraw', args);\n    }\n  },\n\n  afterEvent(chart, args) {\n    if (chart.tooltip) {\n      // If the event is replayed from `update`, we should evaluate with the final positions.\n      const useFinalPosition = args.replay;\n      if (chart.tooltip.handleEvent(args.event, useFinalPosition, args.inChartArea)) {\n        // notify chart about the change, so it will render\n        args.changed = true;\n      }\n    }\n  },\n\n  defaults: {\n    enabled: true,\n    external: null,\n    position: 'average',\n    backgroundColor: 'rgba(0,0,0,0.8)',\n    titleColor: '#fff',\n    titleFont: {\n      weight: 'bold',\n    },\n    titleSpacing: 2,\n    titleMarginBottom: 6,\n    titleAlign: 'left',\n    bodyColor: '#fff',\n    bodySpacing: 2,\n    bodyFont: {\n    },\n    bodyAlign: 'left',\n    footerColor: '#fff',\n    footerSpacing: 2,\n    footerMarginTop: 6,\n    footerFont: {\n      weight: 'bold',\n    },\n    footerAlign: 'left',\n    padding: 6,\n    caretPadding: 2,\n    caretSize: 5,\n    cornerRadius: 6,\n    boxHeight: (ctx, opts) => opts.bodyFont.size,\n    boxWidth: (ctx, opts) => opts.bodyFont.size,\n    multiKeyBackground: '#fff',\n    displayColors: true,\n    boxPadding: 0,\n    borderColor: 'rgba(0,0,0,0)',\n    borderWidth: 0,\n    animation: {\n      duration: 400,\n      easing: 'easeOutQuart',\n    },\n    animations: {\n      numbers: {\n        type: 'number',\n        properties: ['x', 'y', 'width', 'height', 'caretX', 'caretY'],\n      },\n      opacity: {\n        easing: 'linear',\n        duration: 200\n      }\n    },\n    callbacks: defaultCallbacks\n  },\n\n  defaultRoutes: {\n    bodyFont: 'font',\n    footerFont: 'font',\n    titleFont: 'font'\n  },\n\n  descriptors: {\n    _scriptable: (name) => name !== 'filter' && name !== 'itemSort' && name !== 'external',\n    _indexable: false,\n    callbacks: {\n      _scriptable: false,\n      _indexable: false,\n    },\n    animation: {\n      _fallback: false\n    },\n    animations: {\n      _fallback: 'animation'\n    }\n  },\n\n  // Resolve additionally from `interaction` options and defaults.\n  additionalOptionScopes: ['interaction']\n};\n","import Scale from '../core/core.scale';\nimport {isNullOrUndef, valueOrDefault, _limitValue} from '../helpers';\n\nconst addIfString = (labels, raw, index, addedLabels) => {\n  if (typeof raw === 'string') {\n    index = labels.push(raw) - 1;\n    addedLabels.unshift({index, label: raw});\n  } else if (isNaN(raw)) {\n    index = null;\n  }\n  return index;\n};\n\nfunction findOrAddLabel(labels, raw, index, addedLabels) {\n  const first = labels.indexOf(raw);\n  if (first === -1) {\n    return addIfString(labels, raw, index, addedLabels);\n  }\n  const last = labels.lastIndexOf(raw);\n  return first !== last ? index : first;\n}\n\nconst validIndex = (index, max) => index === null ? null : _limitValue(Math.round(index), 0, max);\n\nfunction _getLabelForValue(value) {\n  const labels = this.getLabels();\n\n  if (value >= 0 && value < labels.length) {\n    return labels[value];\n  }\n  return value;\n}\n\nexport default class CategoryScale extends Scale {\n\n  static id = 'category';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    ticks: {\n      callback: _getLabelForValue\n    }\n  };\n\n  constructor(cfg) {\n    super(cfg);\n\n    /** @type {number} */\n    this._startValue = undefined;\n    this._valueRange = 0;\n    this._addedLabels = [];\n  }\n\n  init(scaleOptions) {\n    const added = this._addedLabels;\n    if (added.length) {\n      const labels = this.getLabels();\n      for (const {index, label} of added) {\n        if (labels[index] === label) {\n          labels.splice(index, 1);\n        }\n      }\n      this._addedLabels = [];\n    }\n    super.init(scaleOptions);\n  }\n\n  parse(raw, index) {\n    if (isNullOrUndef(raw)) {\n      return null;\n    }\n    const labels = this.getLabels();\n    index = isFinite(index) && labels[index] === raw ? index\n      : findOrAddLabel(labels, raw, valueOrDefault(index, raw), this._addedLabels);\n    return validIndex(index, labels.length - 1);\n  }\n\n  determineDataLimits() {\n    const {minDefined, maxDefined} = this.getUserBounds();\n    let {min, max} = this.getMinMax(true);\n\n    if (this.options.bounds === 'ticks') {\n      if (!minDefined) {\n        min = 0;\n      }\n      if (!maxDefined) {\n        max = this.getLabels().length - 1;\n      }\n    }\n\n    this.min = min;\n    this.max = max;\n  }\n\n  buildTicks() {\n    const min = this.min;\n    const max = this.max;\n    const offset = this.options.offset;\n    const ticks = [];\n    let labels = this.getLabels();\n\n    // If we are viewing some subset of labels, slice the original array\n    labels = (min === 0 && max === labels.length - 1) ? labels : labels.slice(min, max + 1);\n\n    this._valueRange = Math.max(labels.length - (offset ? 0 : 1), 1);\n    this._startValue = this.min - (offset ? 0.5 : 0);\n\n    for (let value = min; value <= max; value++) {\n      ticks.push({value});\n    }\n    return ticks;\n  }\n\n  getLabelForValue(value) {\n    return _getLabelForValue.call(this, value);\n  }\n\n  /**\n\t * @protected\n\t */\n  configure() {\n    super.configure();\n\n    if (!this.isHorizontal()) {\n      // For backward compatibility, vertical category scale reverse is inverted.\n      this._reversePixels = !this._reversePixels;\n    }\n  }\n\n  // Used to get data value locations. Value can either be an index or a numerical value\n  getPixelForValue(value) {\n    if (typeof value !== 'number') {\n      value = this.parse(value);\n    }\n\n    return value === null ? NaN : this.getPixelForDecimal((value - this._startValue) / this._valueRange);\n  }\n\n  // Must override base implementation because it calls getPixelForValue\n  // and category scale can have duplicate values\n  getPixelForTick(index) {\n    const ticks = this.ticks;\n    if (index < 0 || index > ticks.length - 1) {\n      return null;\n    }\n    return this.getPixelForValue(ticks[index].value);\n  }\n\n  getValueForPixel(pixel) {\n    return Math.round(this._startValue + this.getDecimalForPixel(pixel) * this._valueRange);\n  }\n\n  getBasePixel() {\n    return this.bottom;\n  }\n}\n","import {isNullOrUndef} from '../helpers/helpers.core';\nimport {almostEquals, almostWhole, niceNum, _decimalPlaces, _setMinAndMaxByKey, sign, toRadians} from '../helpers/helpers.math';\nimport Scale from '../core/core.scale';\nimport {formatNumber} from '../helpers/helpers.intl';\n\n/**\n * Generate a set of linear ticks for an axis\n * 1. If generationOptions.min, generationOptions.max, and generationOptions.step are defined:\n *    if (max - min) / step is an integer, ticks are generated as [min, min + step, ..., max]\n *    Note that the generationOptions.maxCount setting is respected in this scenario\n *\n * 2. If generationOptions.min, generationOptions.max, and generationOptions.count is defined\n *    spacing = (max - min) / count\n *    Ticks are generated as [min, min + spacing, ..., max]\n *\n * 3. If generationOptions.count is defined\n *    spacing = (niceMax - niceMin) / count\n *\n * 4. Compute optimal spacing of ticks using niceNum algorithm\n *\n * @param generationOptions the options used to generate the ticks\n * @param dataRange the range of the data\n * @returns {object[]} array of tick objects\n */\nfunction generateTicks(generationOptions, dataRange) {\n  const ticks = [];\n  // To get a \"nice\" value for the tick spacing, we will use the appropriately named\n  // \"nice number\" algorithm. See https://stackoverflow.com/questions/8506881/nice-label-algorithm-for-charts-with-minimum-ticks\n  // for details.\n\n  const MIN_SPACING = 1e-14;\n  const {bounds, step, min, max, precision, count, maxTicks, maxDigits, includeBounds} = generationOptions;\n  const unit = step || 1;\n  const maxSpaces = maxTicks - 1;\n  const {min: rmin, max: rmax} = dataRange;\n  const minDefined = !isNullOrUndef(min);\n  const maxDefined = !isNullOrUndef(max);\n  const countDefined = !isNullOrUndef(count);\n  const minSpacing = (rmax - rmin) / (maxDigits + 1);\n  let spacing = niceNum((rmax - rmin) / maxSpaces / unit) * unit;\n  let factor, niceMin, niceMax, numSpaces;\n\n  // Beyond MIN_SPACING floating point numbers being to lose precision\n  // such that we can't do the math necessary to generate ticks\n  if (spacing < MIN_SPACING && !minDefined && !maxDefined) {\n    return [{value: rmin}, {value: rmax}];\n  }\n\n  numSpaces = Math.ceil(rmax / spacing) - Math.floor(rmin / spacing);\n  if (numSpaces > maxSpaces) {\n    // If the calculated num of spaces exceeds maxNumSpaces, recalculate it\n    spacing = niceNum(numSpaces * spacing / maxSpaces / unit) * unit;\n  }\n\n  if (!isNullOrUndef(precision)) {\n    // If the user specified a precision, round to that number of decimal places\n    factor = Math.pow(10, precision);\n    spacing = Math.ceil(spacing * factor) / factor;\n  }\n\n  if (bounds === 'ticks') {\n    niceMin = Math.floor(rmin / spacing) * spacing;\n    niceMax = Math.ceil(rmax / spacing) * spacing;\n  } else {\n    niceMin = rmin;\n    niceMax = rmax;\n  }\n\n  if (minDefined && maxDefined && step && almostWhole((max - min) / step, spacing / 1000)) {\n    // Case 1: If min, max and stepSize are set and they make an evenly spaced scale use it.\n    // spacing = step;\n    // numSpaces = (max - min) / spacing;\n    // Note that we round here to handle the case where almostWhole translated an FP error\n    numSpaces = Math.round(Math.min((max - min) / spacing, maxTicks));\n    spacing = (max - min) / numSpaces;\n    niceMin = min;\n    niceMax = max;\n  } else if (countDefined) {\n    // Cases 2 & 3, we have a count specified. Handle optional user defined edges to the range.\n    // Sometimes these are no-ops, but it makes the code a lot clearer\n    // and when a user defined range is specified, we want the correct ticks\n    niceMin = minDefined ? min : niceMin;\n    niceMax = maxDefined ? max : niceMax;\n    numSpaces = count - 1;\n    spacing = (niceMax - niceMin) / numSpaces;\n  } else {\n    // Case 4\n    numSpaces = (niceMax - niceMin) / spacing;\n\n    // If very close to our rounded value, use it.\n    if (almostEquals(numSpaces, Math.round(numSpaces), spacing / 1000)) {\n      numSpaces = Math.round(numSpaces);\n    } else {\n      numSpaces = Math.ceil(numSpaces);\n    }\n  }\n\n  // The spacing will have changed in cases 1, 2, and 3 so the factor cannot be computed\n  // until this point\n  const decimalPlaces = Math.max(\n    _decimalPlaces(spacing),\n    _decimalPlaces(niceMin)\n  );\n  factor = Math.pow(10, isNullOrUndef(precision) ? decimalPlaces : precision);\n  niceMin = Math.round(niceMin * factor) / factor;\n  niceMax = Math.round(niceMax * factor) / factor;\n\n  let j = 0;\n  if (minDefined) {\n    if (includeBounds && niceMin !== min) {\n      ticks.push({value: min});\n\n      if (niceMin < min) {\n        j++; // Skip niceMin\n      }\n      // If the next nice tick is close to min, skip it\n      if (almostEquals(Math.round((niceMin + j * spacing) * factor) / factor, min, relativeLabelSize(min, minSpacing, generationOptions))) {\n        j++;\n      }\n    } else if (niceMin < min) {\n      j++;\n    }\n  }\n\n  for (; j < numSpaces; ++j) {\n    ticks.push({value: Math.round((niceMin + j * spacing) * factor) / factor});\n  }\n\n  if (maxDefined && includeBounds && niceMax !== max) {\n    // If the previous tick is too close to max, replace it with max, else add max\n    if (ticks.length && almostEquals(ticks[ticks.length - 1].value, max, relativeLabelSize(max, minSpacing, generationOptions))) {\n      ticks[ticks.length - 1].value = max;\n    } else {\n      ticks.push({value: max});\n    }\n  } else if (!maxDefined || niceMax === max) {\n    ticks.push({value: niceMax});\n  }\n\n  return ticks;\n}\n\nfunction relativeLabelSize(value, minSpacing, {horizontal, minRotation}) {\n  const rad = toRadians(minRotation);\n  const ratio = (horizontal ? Math.sin(rad) : Math.cos(rad)) || 0.001;\n  const length = 0.75 * minSpacing * ('' + value).length;\n  return Math.min(minSpacing / ratio, length);\n}\n\nexport default class LinearScaleBase extends Scale {\n\n  constructor(cfg) {\n    super(cfg);\n\n    /** @type {number} */\n    this.start = undefined;\n    /** @type {number} */\n    this.end = undefined;\n    /** @type {number} */\n    this._startValue = undefined;\n    /** @type {number} */\n    this._endValue = undefined;\n    this._valueRange = 0;\n  }\n\n  parse(raw, index) { // eslint-disable-line no-unused-vars\n    if (isNullOrUndef(raw)) {\n      return null;\n    }\n    if ((typeof raw === 'number' || raw instanceof Number) && !isFinite(+raw)) {\n      return null;\n    }\n\n    return +raw;\n  }\n\n  handleTickRangeOptions() {\n    const {beginAtZero} = this.options;\n    const {minDefined, maxDefined} = this.getUserBounds();\n    let {min, max} = this;\n\n    const setMin = v => (min = minDefined ? min : v);\n    const setMax = v => (max = maxDefined ? max : v);\n\n    if (beginAtZero) {\n      const minSign = sign(min);\n      const maxSign = sign(max);\n\n      if (minSign < 0 && maxSign < 0) {\n        setMax(0);\n      } else if (minSign > 0 && maxSign > 0) {\n        setMin(0);\n      }\n    }\n\n    if (min === max) {\n      let offset = max === 0 ? 1 : Math.abs(max * 0.05);\n\n      setMax(max + offset);\n\n      if (!beginAtZero) {\n        setMin(min - offset);\n      }\n    }\n    this.min = min;\n    this.max = max;\n  }\n\n  getTickLimit() {\n    const tickOpts = this.options.ticks;\n    // eslint-disable-next-line prefer-const\n    let {maxTicksLimit, stepSize} = tickOpts;\n    let maxTicks;\n\n    if (stepSize) {\n      maxTicks = Math.ceil(this.max / stepSize) - Math.floor(this.min / stepSize) + 1;\n      if (maxTicks > 1000) {\n        console.warn(`scales.${this.id}.ticks.stepSize: ${stepSize} would result generating up to ${maxTicks} ticks. Limiting to 1000.`);\n        maxTicks = 1000;\n      }\n    } else {\n      maxTicks = this.computeTickLimit();\n      maxTicksLimit = maxTicksLimit || 11;\n    }\n\n    if (maxTicksLimit) {\n      maxTicks = Math.min(maxTicksLimit, maxTicks);\n    }\n\n    return maxTicks;\n  }\n\n  /**\n\t * @protected\n\t */\n  computeTickLimit() {\n    return Number.POSITIVE_INFINITY;\n  }\n\n  buildTicks() {\n    const opts = this.options;\n    const tickOpts = opts.ticks;\n\n    // Figure out what the max number of ticks we can support it is based on the size of\n    // the axis area. For now, we say that the minimum tick spacing in pixels must be 40\n    // We also limit the maximum number of ticks to 11 which gives a nice 10 squares on\n    // the graph. Make sure we always have at least 2 ticks\n    let maxTicks = this.getTickLimit();\n    maxTicks = Math.max(2, maxTicks);\n\n    const numericGeneratorOptions = {\n      maxTicks,\n      bounds: opts.bounds,\n      min: opts.min,\n      max: opts.max,\n      precision: tickOpts.precision,\n      step: tickOpts.stepSize,\n      count: tickOpts.count,\n      maxDigits: this._maxDigits(),\n      horizontal: this.isHorizontal(),\n      minRotation: tickOpts.minRotation || 0,\n      includeBounds: tickOpts.includeBounds !== false\n    };\n    const dataRange = this._range || this;\n    const ticks = generateTicks(numericGeneratorOptions, dataRange);\n\n    // At this point, we need to update our max and min given the tick values,\n    // since we probably have expanded the range of the scale\n    if (opts.bounds === 'ticks') {\n      _setMinAndMaxByKey(ticks, this, 'value');\n    }\n\n    if (opts.reverse) {\n      ticks.reverse();\n\n      this.start = this.max;\n      this.end = this.min;\n    } else {\n      this.start = this.min;\n      this.end = this.max;\n    }\n\n    return ticks;\n  }\n\n  /**\n\t * @protected\n\t */\n  configure() {\n    const ticks = this.ticks;\n    let start = this.min;\n    let end = this.max;\n\n    super.configure();\n\n    if (this.options.offset && ticks.length) {\n      const offset = (end - start) / Math.max(ticks.length - 1, 1) / 2;\n      start -= offset;\n      end += offset;\n    }\n    this._startValue = start;\n    this._endValue = end;\n    this._valueRange = end - start;\n  }\n\n  getLabelForValue(value) {\n    return formatNumber(value, this.chart.options.locale, this.options.ticks.format);\n  }\n}\n","import {isFinite} from '../helpers/helpers.core';\nimport LinearScaleBase from './scale.linearbase';\nimport Ticks from '../core/core.ticks';\nimport {toRadians} from '../helpers';\n\nexport default class LinearScale extends LinearScaleBase {\n\n  static id = 'linear';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    ticks: {\n      callback: Ticks.formatters.numeric\n    }\n  };\n\n\n  determineDataLimits() {\n    const {min, max} = this.getMinMax(true);\n\n    this.min = isFinite(min) ? min : 0;\n    this.max = isFinite(max) ? max : 1;\n\n    // Common base implementation to handle min, max, beginAtZero\n    this.handleTickRangeOptions();\n  }\n\n  /**\n\t * Returns the maximum number of ticks based on the scale dimension\n\t * @protected\n \t */\n  computeTickLimit() {\n    const horizontal = this.isHorizontal();\n    const length = horizontal ? this.width : this.height;\n    const minRotation = toRadians(this.options.ticks.minRotation);\n    const ratio = (horizontal ? Math.sin(minRotation) : Math.cos(minRotation)) || 0.001;\n    const tickFont = this._resolveTickFontOptions(0);\n    return Math.ceil(length / Math.min(40, tickFont.lineHeight / ratio));\n  }\n\n  // Utils\n  getPixelForValue(value) {\n    return value === null ? NaN : this.getPixelForDecimal((value - this._startValue) / this._valueRange);\n  }\n\n  getValueForPixel(pixel) {\n    return this._startValue + this.getDecimalForPixel(pixel) * this._valueRange;\n  }\n}\n","import {finiteOrDefault, isFinite} from '../helpers/helpers.core';\nimport {formatNumber} from '../helpers/helpers.intl';\nimport {_setMinAndMaxByKey, log10} from '../helpers/helpers.math';\nimport Scale from '../core/core.scale';\nimport LinearScaleBase from './scale.linearbase';\nimport Ticks from '../core/core.ticks';\n\nconst log10Floor = v => Math.floor(log10(v));\nconst changeExponent = (v, m) => Math.pow(10, log10Floor(v) + m);\n\nfunction isMajor(tickVal) {\n  const remain = tickVal / (Math.pow(10, log10Floor(tickVal)));\n  return remain === 1;\n}\n\nfunction steps(min, max, rangeExp) {\n  const rangeStep = Math.pow(10, rangeExp);\n  const start = Math.floor(min / rangeStep);\n  const end = Math.ceil(max / rangeStep);\n  return end - start;\n}\n\nfunction startExp(min, max) {\n  const range = max - min;\n  let rangeExp = log10Floor(range);\n  while (steps(min, max, rangeExp) > 10) {\n    rangeExp++;\n  }\n  while (steps(min, max, rangeExp) < 10) {\n    rangeExp--;\n  }\n  return Math.min(rangeExp, log10Floor(min));\n}\n\n\n/**\n * Generate a set of logarithmic ticks\n * @param generationOptions the options used to generate the ticks\n * @param dataRange the range of the data\n * @returns {object[]} array of tick objects\n */\nfunction generateTicks(generationOptions, {min, max}) {\n  min = finiteOrDefault(generationOptions.min, min);\n  const ticks = [];\n  const minExp = log10Floor(min);\n  let exp = startExp(min, max);\n  let precision = exp < 0 ? Math.pow(10, Math.abs(exp)) : 1;\n  const stepSize = Math.pow(10, exp);\n  const base = minExp > exp ? Math.pow(10, minExp) : 0;\n  const start = Math.round((min - base) * precision) / precision;\n  const offset = Math.floor((min - base) / stepSize / 10) * stepSize * 10;\n  let significand = Math.floor((start - offset) / Math.pow(10, exp));\n  let value = finiteOrDefault(generationOptions.min, Math.round((base + offset + significand * Math.pow(10, exp)) * precision) / precision);\n  while (value < max) {\n    ticks.push({value, major: isMajor(value), significand});\n    if (significand >= 10) {\n      significand = significand < 15 ? 15 : 20;\n    } else {\n      significand++;\n    }\n    if (significand >= 20) {\n      exp++;\n      significand = 2;\n      precision = exp >= 0 ? 1 : precision;\n    }\n    value = Math.round((base + offset + significand * Math.pow(10, exp)) * precision) / precision;\n  }\n  const lastTick = finiteOrDefault(generationOptions.max, value);\n  ticks.push({value: lastTick, major: isMajor(lastTick), significand});\n\n  return ticks;\n}\n\nexport default class LogarithmicScale extends Scale {\n\n  static id = 'logarithmic';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    ticks: {\n      callback: Ticks.formatters.logarithmic,\n      major: {\n        enabled: true\n      }\n    }\n  };\n\n\n  constructor(cfg) {\n    super(cfg);\n\n    /** @type {number} */\n    this.start = undefined;\n    /** @type {number} */\n    this.end = undefined;\n    /** @type {number} */\n    this._startValue = undefined;\n    this._valueRange = 0;\n  }\n\n  parse(raw, index) {\n    const value = LinearScaleBase.prototype.parse.apply(this, [raw, index]);\n    if (value === 0) {\n      this._zero = true;\n      return undefined;\n    }\n    return isFinite(value) && value > 0 ? value : null;\n  }\n\n  determineDataLimits() {\n    const {min, max} = this.getMinMax(true);\n\n    this.min = isFinite(min) ? Math.max(0, min) : null;\n    this.max = isFinite(max) ? Math.max(0, max) : null;\n\n    if (this.options.beginAtZero) {\n      this._zero = true;\n    }\n\n    // if data has `0` in it or `beginAtZero` is true, min (non zero) value is at bottom\n    // of scale, and it does not equal suggestedMin, lower the min bound by one exp.\n    if (this._zero && this.min !== this._suggestedMin && !isFinite(this._userMin)) {\n      this.min = min === changeExponent(this.min, 0) ? changeExponent(this.min, -1) : changeExponent(this.min, 0);\n    }\n\n    this.handleTickRangeOptions();\n  }\n\n  handleTickRangeOptions() {\n    const {minDefined, maxDefined} = this.getUserBounds();\n    let min = this.min;\n    let max = this.max;\n\n    const setMin = v => (min = minDefined ? min : v);\n    const setMax = v => (max = maxDefined ? max : v);\n\n    if (min === max) {\n      if (min <= 0) { // includes null\n        setMin(1);\n        setMax(10);\n      } else {\n        setMin(changeExponent(min, -1));\n        setMax(changeExponent(max, +1));\n      }\n    }\n    if (min <= 0) {\n      setMin(changeExponent(max, -1));\n    }\n    if (max <= 0) {\n\n      setMax(changeExponent(min, +1));\n    }\n\n    this.min = min;\n    this.max = max;\n  }\n\n  buildTicks() {\n    const opts = this.options;\n\n    const generationOptions = {\n      min: this._userMin,\n      max: this._userMax\n    };\n    const ticks = generateTicks(generationOptions, this);\n\n    // At this point, we need to update our max and min given the tick values,\n    // since we probably have expanded the range of the scale\n    if (opts.bounds === 'ticks') {\n      _setMinAndMaxByKey(ticks, this, 'value');\n    }\n\n    if (opts.reverse) {\n      ticks.reverse();\n\n      this.start = this.max;\n      this.end = this.min;\n    } else {\n      this.start = this.min;\n      this.end = this.max;\n    }\n\n    return ticks;\n  }\n\n  /**\n\t * @param {number} value\n\t * @return {string}\n\t */\n  getLabelForValue(value) {\n    return value === undefined\n      ? '0'\n      : formatNumber(value, this.chart.options.locale, this.options.ticks.format);\n  }\n\n  /**\n\t * @protected\n\t */\n  configure() {\n    const start = this.min;\n\n    super.configure();\n\n    this._startValue = log10(start);\n    this._valueRange = log10(this.max) - log10(start);\n  }\n\n  getPixelForValue(value) {\n    if (value === undefined || value === 0) {\n      value = this.min;\n    }\n    if (value === null || isNaN(value)) {\n      return NaN;\n    }\n    return this.getPixelForDecimal(value === this.min\n      ? 0\n      : (log10(value) - this._startValue) / this._valueRange);\n  }\n\n  getValueForPixel(pixel) {\n    const decimal = this.getDecimalForPixel(pixel);\n    return Math.pow(10, this._startValue + decimal * this._valueRange);\n  }\n}\n","import defaults from '../core/core.defaults';\nimport {_longestText, addRoundedRectPath, renderText} from '../helpers/helpers.canvas';\nimport {HALF_PI, TAU, toDegrees, toRadians, _normalizeAngle, PI} from '../helpers/helpers.math';\nimport LinearScaleBase from './scale.linearbase';\nimport Ticks from '../core/core.ticks';\nimport {valueOrDefault, isArray, isFinite, callback as callCallback, isNullOrUndef} from '../helpers/helpers.core';\nimport {createContext, toFont, toPadding, toTRBLCorners} from '../helpers/helpers.options';\n\nfunction getTickBackdropHeight(opts) {\n  const tickOpts = opts.ticks;\n\n  if (tickOpts.display && opts.display) {\n    const padding = toPadding(tickOpts.backdropPadding);\n    return valueOrDefault(tickOpts.font && tickOpts.font.size, defaults.font.size) + padding.height;\n  }\n  return 0;\n}\n\nfunction measureLabelSize(ctx, font, label) {\n  label = isArray(label) ? label : [label];\n  return {\n    w: _longestText(ctx, font.string, label),\n    h: label.length * font.lineHeight\n  };\n}\n\nfunction determineLimits(angle, pos, size, min, max) {\n  if (angle === min || angle === max) {\n    return {\n      start: pos - (size / 2),\n      end: pos + (size / 2)\n    };\n  } else if (angle < min || angle > max) {\n    return {\n      start: pos - size,\n      end: pos\n    };\n  }\n\n  return {\n    start: pos,\n    end: pos + size\n  };\n}\n\n/**\n * Helper function to fit a radial linear scale with point labels\n */\nfunction fitWithPointLabels(scale) {\n\n  // Right, this is really confusing and there is a lot of maths going on here\n  // The gist of the problem is here: https://gist.github.com/nnnick/696cc9c55f4b0beb8fe9\n  //\n  // Reaction: https://dl.dropboxusercontent.com/u/34601363/toomuchscience.gif\n  //\n  // Solution:\n  //\n  // We assume the radius of the polygon is half the size of the canvas at first\n  // at each index we check if the text overlaps.\n  //\n  // Where it does, we store that angle and that index.\n  //\n  // After finding the largest index and angle we calculate how much we need to remove\n  // from the shape radius to move the point inwards by that x.\n  //\n  // We average the left and right distances to get the maximum shape radius that can fit in the box\n  // along with labels.\n  //\n  // Once we have that, we can find the centre point for the chart, by taking the x text protrusion\n  // on each side, removing that from the size, halving it and adding the left x protrusion width.\n  //\n  // This will mean we have a shape fitted to the canvas, as large as it can be with the labels\n  // and position it in the most space efficient manner\n  //\n  // https://dl.dropboxusercontent.com/u/34601363/yeahscience.gif\n\n  // Get maximum radius of the polygon. Either half the height (minus the text width) or half the width.\n  // Use this to calculate the offset + change. - Make sure L/R protrusion is at least 0 to stop issues with centre points\n  const orig = {\n    l: scale.left + scale._padding.left,\n    r: scale.right - scale._padding.right,\n    t: scale.top + scale._padding.top,\n    b: scale.bottom - scale._padding.bottom\n  };\n  const limits = Object.assign({}, orig);\n  const labelSizes = [];\n  const padding = [];\n  const valueCount = scale._pointLabels.length;\n  const pointLabelOpts = scale.options.pointLabels;\n  const additionalAngle = pointLabelOpts.centerPointLabels ? PI / valueCount : 0;\n\n  for (let i = 0; i < valueCount; i++) {\n    const opts = pointLabelOpts.setContext(scale.getPointLabelContext(i));\n    padding[i] = opts.padding;\n    const pointPosition = scale.getPointPosition(i, scale.drawingArea + padding[i], additionalAngle);\n    const plFont = toFont(opts.font);\n    const textSize = measureLabelSize(scale.ctx, plFont, scale._pointLabels[i]);\n    labelSizes[i] = textSize;\n\n    const angleRadians = _normalizeAngle(scale.getIndexAngle(i) + additionalAngle);\n    const angle = Math.round(toDegrees(angleRadians));\n    const hLimits = determineLimits(angle, pointPosition.x, textSize.w, 0, 180);\n    const vLimits = determineLimits(angle, pointPosition.y, textSize.h, 90, 270);\n    updateLimits(limits, orig, angleRadians, hLimits, vLimits);\n  }\n\n  scale.setCenterPoint(\n    orig.l - limits.l,\n    limits.r - orig.r,\n    orig.t - limits.t,\n    limits.b - orig.b\n  );\n\n  // Now that text size is determined, compute the full positions\n  scale._pointLabelItems = buildPointLabelItems(scale, labelSizes, padding);\n}\n\nfunction updateLimits(limits, orig, angle, hLimits, vLimits) {\n  const sin = Math.abs(Math.sin(angle));\n  const cos = Math.abs(Math.cos(angle));\n  let x = 0;\n  let y = 0;\n  if (hLimits.start < orig.l) {\n    x = (orig.l - hLimits.start) / sin;\n    limits.l = Math.min(limits.l, orig.l - x);\n  } else if (hLimits.end > orig.r) {\n    x = (hLimits.end - orig.r) / sin;\n    limits.r = Math.max(limits.r, orig.r + x);\n  }\n  if (vLimits.start < orig.t) {\n    y = (orig.t - vLimits.start) / cos;\n    limits.t = Math.min(limits.t, orig.t - y);\n  } else if (vLimits.end > orig.b) {\n    y = (vLimits.end - orig.b) / cos;\n    limits.b = Math.max(limits.b, orig.b + y);\n  }\n}\n\nfunction buildPointLabelItems(scale, labelSizes, padding) {\n  const items = [];\n  const valueCount = scale._pointLabels.length;\n  const opts = scale.options;\n  const extra = getTickBackdropHeight(opts) / 2;\n  const outerDistance = scale.drawingArea;\n  const additionalAngle = opts.pointLabels.centerPointLabels ? PI / valueCount : 0;\n\n  for (let i = 0; i < valueCount; i++) {\n    const pointLabelPosition = scale.getPointPosition(i, outerDistance + extra + padding[i], additionalAngle);\n    const angle = Math.round(toDegrees(_normalizeAngle(pointLabelPosition.angle + HALF_PI)));\n    const size = labelSizes[i];\n    const y = yForAngle(pointLabelPosition.y, size.h, angle);\n    const textAlign = getTextAlignForAngle(angle);\n    const left = leftForTextAlign(pointLabelPosition.x, size.w, textAlign);\n\n    items.push({\n      // Text position\n      x: pointLabelPosition.x,\n      y,\n\n      // Text rendering data\n      textAlign,\n\n      // Bounding box\n      left,\n      top: y,\n      right: left + size.w,\n      bottom: y + size.h\n    });\n  }\n  return items;\n}\n\nfunction getTextAlignForAngle(angle) {\n  if (angle === 0 || angle === 180) {\n    return 'center';\n  } else if (angle < 180) {\n    return 'left';\n  }\n\n  return 'right';\n}\n\nfunction leftForTextAlign(x, w, align) {\n  if (align === 'right') {\n    x -= w;\n  } else if (align === 'center') {\n    x -= (w / 2);\n  }\n  return x;\n}\n\nfunction yForAngle(y, h, angle) {\n  if (angle === 90 || angle === 270) {\n    y -= (h / 2);\n  } else if (angle > 270 || angle < 90) {\n    y -= h;\n  }\n  return y;\n}\n\nfunction drawPointLabels(scale, labelCount) {\n  const {ctx, options: {pointLabels}} = scale;\n\n  for (let i = labelCount - 1; i >= 0; i--) {\n    const optsAtIndex = pointLabels.setContext(scale.getPointLabelContext(i));\n    const plFont = toFont(optsAtIndex.font);\n    const {x, y, textAlign, left, top, right, bottom} = scale._pointLabelItems[i];\n    const {backdropColor} = optsAtIndex;\n\n    if (!isNullOrUndef(backdropColor)) {\n      const borderRadius = toTRBLCorners(optsAtIndex.borderRadius);\n      const padding = toPadding(optsAtIndex.backdropPadding);\n      ctx.fillStyle = backdropColor;\n\n      const backdropLeft = left - padding.left;\n      const backdropTop = top - padding.top;\n      const backdropWidth = right - left + padding.width;\n      const backdropHeight = bottom - top + padding.height;\n\n      if (Object.values(borderRadius).some(v => v !== 0)) {\n        ctx.beginPath();\n        addRoundedRectPath(ctx, {\n          x: backdropLeft,\n          y: backdropTop,\n          w: backdropWidth,\n          h: backdropHeight,\n          radius: borderRadius,\n        });\n        ctx.fill();\n      } else {\n        ctx.fillRect(backdropLeft, backdropTop, backdropWidth, backdropHeight);\n      }\n    }\n\n    renderText(\n      ctx,\n      scale._pointLabels[i],\n      x,\n      y + (plFont.lineHeight / 2),\n      plFont,\n      {\n        color: optsAtIndex.color,\n        textAlign: textAlign,\n        textBaseline: 'middle'\n      }\n    );\n  }\n}\n\nfunction pathRadiusLine(scale, radius, circular, labelCount) {\n  const {ctx} = scale;\n  if (circular) {\n    // Draw circular arcs between the points\n    ctx.arc(scale.xCenter, scale.yCenter, radius, 0, TAU);\n  } else {\n    // Draw straight lines connecting each index\n    let pointPosition = scale.getPointPosition(0, radius);\n    ctx.moveTo(pointPosition.x, pointPosition.y);\n\n    for (let i = 1; i < labelCount; i++) {\n      pointPosition = scale.getPointPosition(i, radius);\n      ctx.lineTo(pointPosition.x, pointPosition.y);\n    }\n  }\n}\n\nfunction drawRadiusLine(scale, gridLineOpts, radius, labelCount, borderOpts) {\n  const ctx = scale.ctx;\n  const circular = gridLineOpts.circular;\n\n  const {color, lineWidth} = gridLineOpts;\n\n  if ((!circular && !labelCount) || !color || !lineWidth || radius < 0) {\n    return;\n  }\n\n  ctx.save();\n  ctx.strokeStyle = color;\n  ctx.lineWidth = lineWidth;\n  ctx.setLineDash(borderOpts.dash);\n  ctx.lineDashOffset = borderOpts.dashOffset;\n\n  ctx.beginPath();\n  pathRadiusLine(scale, radius, circular, labelCount);\n  ctx.closePath();\n  ctx.stroke();\n  ctx.restore();\n}\n\nfunction createPointLabelContext(parent, index, label) {\n  return createContext(parent, {\n    label,\n    index,\n    type: 'pointLabel'\n  });\n}\n\nexport default class RadialLinearScale extends LinearScaleBase {\n\n  static id = 'radialLinear';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    display: true,\n\n    // Boolean - Whether to animate scaling the chart from the centre\n    animate: true,\n    position: 'chartArea',\n\n    angleLines: {\n      display: true,\n      lineWidth: 1,\n      borderDash: [],\n      borderDashOffset: 0.0\n    },\n\n    grid: {\n      circular: false\n    },\n\n    startAngle: 0,\n\n    // label settings\n    ticks: {\n      // Boolean - Show a backdrop to the scale label\n      showLabelBackdrop: true,\n\n      callback: Ticks.formatters.numeric\n    },\n\n    pointLabels: {\n      backdropColor: undefined,\n\n      // Number - The backdrop padding above & below the label in pixels\n      backdropPadding: 2,\n\n      // Boolean - if true, show point labels\n      display: true,\n\n      // Number - Point label font size in pixels\n      font: {\n        size: 10\n      },\n\n      // Function - Used to convert point labels\n      callback(label) {\n        return label;\n      },\n\n      // Number - Additionl padding between scale and pointLabel\n      padding: 5,\n\n      // Boolean - if true, center point labels to slices in polar chart\n      centerPointLabels: false\n    }\n  };\n\n  static defaultRoutes = {\n    'angleLines.color': 'borderColor',\n    'pointLabels.color': 'color',\n    'ticks.color': 'color'\n  };\n\n  static descriptors = {\n    angleLines: {\n      _fallback: 'grid'\n    }\n  };\n\n  constructor(cfg) {\n    super(cfg);\n\n    /** @type {number} */\n    this.xCenter = undefined;\n    /** @type {number} */\n    this.yCenter = undefined;\n    /** @type {number} */\n    this.drawingArea = undefined;\n    /** @type {string[]} */\n    this._pointLabels = [];\n    this._pointLabelItems = [];\n  }\n\n  setDimensions() {\n    // Set the unconstrained dimension before label rotation\n    const padding = this._padding = toPadding(getTickBackdropHeight(this.options) / 2);\n    const w = this.width = this.maxWidth - padding.width;\n    const h = this.height = this.maxHeight - padding.height;\n    this.xCenter = Math.floor(this.left + w / 2 + padding.left);\n    this.yCenter = Math.floor(this.top + h / 2 + padding.top);\n    this.drawingArea = Math.floor(Math.min(w, h) / 2);\n  }\n\n  determineDataLimits() {\n    const {min, max} = this.getMinMax(false);\n\n    this.min = isFinite(min) && !isNaN(min) ? min : 0;\n    this.max = isFinite(max) && !isNaN(max) ? max : 0;\n\n    // Common base implementation to handle min, max, beginAtZero\n    this.handleTickRangeOptions();\n  }\n\n  /**\n\t * Returns the maximum number of ticks based on the scale dimension\n\t * @protected\n\t */\n  computeTickLimit() {\n    return Math.ceil(this.drawingArea / getTickBackdropHeight(this.options));\n  }\n\n  generateTickLabels(ticks) {\n    LinearScaleBase.prototype.generateTickLabels.call(this, ticks);\n\n    // Point labels\n    this._pointLabels = this.getLabels()\n      .map((value, index) => {\n        const label = callCallback(this.options.pointLabels.callback, [value, index], this);\n        return label || label === 0 ? label : '';\n      })\n      .filter((v, i) => this.chart.getDataVisibility(i));\n  }\n\n  fit() {\n    const opts = this.options;\n\n    if (opts.display && opts.pointLabels.display) {\n      fitWithPointLabels(this);\n    } else {\n      this.setCenterPoint(0, 0, 0, 0);\n    }\n  }\n\n  setCenterPoint(leftMovement, rightMovement, topMovement, bottomMovement) {\n    this.xCenter += Math.floor((leftMovement - rightMovement) / 2);\n    this.yCenter += Math.floor((topMovement - bottomMovement) / 2);\n    this.drawingArea -= Math.min(this.drawingArea / 2, Math.max(leftMovement, rightMovement, topMovement, bottomMovement));\n  }\n\n  getIndexAngle(index) {\n    const angleMultiplier = TAU / (this._pointLabels.length || 1);\n    const startAngle = this.options.startAngle || 0;\n\n    return _normalizeAngle(index * angleMultiplier + toRadians(startAngle));\n  }\n\n  getDistanceFromCenterForValue(value) {\n    if (isNullOrUndef(value)) {\n      return NaN;\n    }\n\n    // Take into account half font size + the yPadding of the top value\n    const scalingFactor = this.drawingArea / (this.max - this.min);\n    if (this.options.reverse) {\n      return (this.max - value) * scalingFactor;\n    }\n    return (value - this.min) * scalingFactor;\n  }\n\n  getValueForDistanceFromCenter(distance) {\n    if (isNullOrUndef(distance)) {\n      return NaN;\n    }\n\n    const scaledDistance = distance / (this.drawingArea / (this.max - this.min));\n    return this.options.reverse ? this.max - scaledDistance : this.min + scaledDistance;\n  }\n\n  getPointLabelContext(index) {\n    const pointLabels = this._pointLabels || [];\n\n    if (index >= 0 && index < pointLabels.length) {\n      const pointLabel = pointLabels[index];\n      return createPointLabelContext(this.getContext(), index, pointLabel);\n    }\n  }\n\n  getPointPosition(index, distanceFromCenter, additionalAngle = 0) {\n    const angle = this.getIndexAngle(index) - HALF_PI + additionalAngle;\n    return {\n      x: Math.cos(angle) * distanceFromCenter + this.xCenter,\n      y: Math.sin(angle) * distanceFromCenter + this.yCenter,\n      angle\n    };\n  }\n\n  getPointPositionForValue(index, value) {\n    return this.getPointPosition(index, this.getDistanceFromCenterForValue(value));\n  }\n\n  getBasePosition(index) {\n    return this.getPointPositionForValue(index || 0, this.getBaseValue());\n  }\n\n  getPointLabelPosition(index) {\n    const {left, top, right, bottom} = this._pointLabelItems[index];\n    return {\n      left,\n      top,\n      right,\n      bottom,\n    };\n  }\n\n  /**\n\t * @protected\n\t */\n  drawBackground() {\n    const {backgroundColor, grid: {circular}} = this.options;\n    if (backgroundColor) {\n      const ctx = this.ctx;\n      ctx.save();\n      ctx.beginPath();\n      pathRadiusLine(this, this.getDistanceFromCenterForValue(this._endValue), circular, this._pointLabels.length);\n      ctx.closePath();\n      ctx.fillStyle = backgroundColor;\n      ctx.fill();\n      ctx.restore();\n    }\n  }\n\n  /**\n\t * @protected\n\t */\n  drawGrid() {\n    const ctx = this.ctx;\n    const opts = this.options;\n    const {angleLines, grid, border} = opts;\n    const labelCount = this._pointLabels.length;\n\n    let i, offset, position;\n\n    if (opts.pointLabels.display) {\n      drawPointLabels(this, labelCount);\n    }\n\n    if (grid.display) {\n      this.ticks.forEach((tick, index) => {\n        if (index !== 0) {\n          offset = this.getDistanceFromCenterForValue(tick.value);\n          const context = this.getContext(index);\n          const optsAtIndex = grid.setContext(context);\n          const optsAtIndexBorder = border.setContext(context);\n\n          drawRadiusLine(this, optsAtIndex, offset, labelCount, optsAtIndexBorder);\n        }\n      });\n    }\n\n    if (angleLines.display) {\n      ctx.save();\n\n      for (i = labelCount - 1; i >= 0; i--) {\n        const optsAtIndex = angleLines.setContext(this.getPointLabelContext(i));\n        const {color, lineWidth} = optsAtIndex;\n\n        if (!lineWidth || !color) {\n          continue;\n        }\n\n        ctx.lineWidth = lineWidth;\n        ctx.strokeStyle = color;\n\n        ctx.setLineDash(optsAtIndex.borderDash);\n        ctx.lineDashOffset = optsAtIndex.borderDashOffset;\n\n        offset = this.getDistanceFromCenterForValue(opts.ticks.reverse ? this.min : this.max);\n        position = this.getPointPosition(i, offset);\n        ctx.beginPath();\n        ctx.moveTo(this.xCenter, this.yCenter);\n        ctx.lineTo(position.x, position.y);\n        ctx.stroke();\n      }\n\n      ctx.restore();\n    }\n  }\n\n  /**\n\t * @protected\n\t */\n  drawBorder() {}\n\n  /**\n\t * @protected\n\t */\n  drawLabels() {\n    const ctx = this.ctx;\n    const opts = this.options;\n    const tickOpts = opts.ticks;\n\n    if (!tickOpts.display) {\n      return;\n    }\n\n    const startAngle = this.getIndexAngle(0);\n    let offset, width;\n\n    ctx.save();\n    ctx.translate(this.xCenter, this.yCenter);\n    ctx.rotate(startAngle);\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n\n    this.ticks.forEach((tick, index) => {\n      if (index === 0 && !opts.reverse) {\n        return;\n      }\n\n      const optsAtIndex = tickOpts.setContext(this.getContext(index));\n      const tickFont = toFont(optsAtIndex.font);\n      offset = this.getDistanceFromCenterForValue(this.ticks[index].value);\n\n      if (optsAtIndex.showLabelBackdrop) {\n        ctx.font = tickFont.string;\n        width = ctx.measureText(tick.label).width;\n        ctx.fillStyle = optsAtIndex.backdropColor;\n\n        const padding = toPadding(optsAtIndex.backdropPadding);\n        ctx.fillRect(\n          -width / 2 - padding.left,\n          -offset - tickFont.size / 2 - padding.top,\n          width + padding.width,\n          tickFont.size + padding.height\n        );\n      }\n\n      renderText(ctx, tick.label, 0, -offset, tickFont, {\n        color: optsAtIndex.color,\n      });\n    });\n\n    ctx.restore();\n  }\n\n  /**\n\t * @protected\n\t */\n  drawTitle() {}\n}\n","import adapters from '../core/core.adapters';\nimport {callback as call, isFinite, isNullOrUndef, mergeIf, valueOrDefault} from '../helpers/helpers.core';\nimport {toRadians, isNumber, _limitValue} from '../helpers/helpers.math';\nimport Scale from '../core/core.scale';\nimport {_arrayUnique, _filterBetween, _lookup} from '../helpers/helpers.collection';\n\n/**\n * @typedef { import(\"../core/core.adapters\").TimeUnit } Unit\n * @typedef {{common: boolean, size: number, steps?: number}} Interval\n * @typedef { import(\"../core/core.adapters\").DateAdapter } DateAdapter\n */\n\n/**\n * @type {Object<Unit, Interval>}\n */\nconst INTERVALS = {\n  millisecond: {common: true, size: 1, steps: 1000},\n  second: {common: true, size: 1000, steps: 60},\n  minute: {common: true, size: 60000, steps: 60},\n  hour: {common: true, size: 3600000, steps: 24},\n  day: {common: true, size: 86400000, steps: 30},\n  week: {common: false, size: 604800000, steps: 4},\n  month: {common: true, size: 2.628e9, steps: 12},\n  quarter: {common: false, size: 7.884e9, steps: 4},\n  year: {common: true, size: 3.154e10}\n};\n\n/**\n * @type {Unit[]}\n */\nconst UNITS = /** @type Unit[] */ /* #__PURE__ */ (Object.keys(INTERVALS));\n\n/**\n * @param {number} a\n * @param {number} b\n */\nfunction sorter(a, b) {\n  return a - b;\n}\n\n/**\n * @param {TimeScale} scale\n * @param {*} input\n * @return {number}\n */\nfunction parse(scale, input) {\n  if (isNullOrUndef(input)) {\n    return null;\n  }\n\n  const adapter = scale._adapter;\n  const {parser, round, isoWeekday} = scale._parseOpts;\n  let value = input;\n\n  if (typeof parser === 'function') {\n    value = parser(value);\n  }\n\n  // Only parse if its not a timestamp already\n  if (!isFinite(value)) {\n    value = typeof parser === 'string'\n      ? adapter.parse(value, /** @type {Unit} */ (parser))\n      : adapter.parse(value);\n  }\n\n  if (value === null) {\n    return null;\n  }\n\n  if (round) {\n    value = round === 'week' && (isNumber(isoWeekday) || isoWeekday === true)\n      ? adapter.startOf(value, 'isoWeek', isoWeekday)\n      : adapter.startOf(value, round);\n  }\n\n  return +value;\n}\n\n/**\n * Figures out what unit results in an appropriate number of auto-generated ticks\n * @param {Unit} minUnit\n * @param {number} min\n * @param {number} max\n * @param {number} capacity\n * @return {object}\n */\nfunction determineUnitForAutoTicks(minUnit, min, max, capacity) {\n  const ilen = UNITS.length;\n\n  for (let i = UNITS.indexOf(minUnit); i < ilen - 1; ++i) {\n    const interval = INTERVALS[UNITS[i]];\n    const factor = interval.steps ? interval.steps : Number.MAX_SAFE_INTEGER;\n\n    if (interval.common && Math.ceil((max - min) / (factor * interval.size)) <= capacity) {\n      return UNITS[i];\n    }\n  }\n\n  return UNITS[ilen - 1];\n}\n\n/**\n * Figures out what unit to format a set of ticks with\n * @param {TimeScale} scale\n * @param {number} numTicks\n * @param {Unit} minUnit\n * @param {number} min\n * @param {number} max\n * @return {Unit}\n */\nfunction determineUnitForFormatting(scale, numTicks, minUnit, min, max) {\n  for (let i = UNITS.length - 1; i >= UNITS.indexOf(minUnit); i--) {\n    const unit = UNITS[i];\n    if (INTERVALS[unit].common && scale._adapter.diff(max, min, unit) >= numTicks - 1) {\n      return unit;\n    }\n  }\n\n  return UNITS[minUnit ? UNITS.indexOf(minUnit) : 0];\n}\n\n/**\n * @param {Unit} unit\n * @return {object}\n */\nfunction determineMajorUnit(unit) {\n  for (let i = UNITS.indexOf(unit) + 1, ilen = UNITS.length; i < ilen; ++i) {\n    if (INTERVALS[UNITS[i]].common) {\n      return UNITS[i];\n    }\n  }\n}\n\n/**\n * @param {object} ticks\n * @param {number} time\n * @param {number[]} [timestamps] - if defined, snap to these timestamps\n */\nfunction addTick(ticks, time, timestamps) {\n  if (!timestamps) {\n    ticks[time] = true;\n  } else if (timestamps.length) {\n    const {lo, hi} = _lookup(timestamps, time);\n    const timestamp = timestamps[lo] >= time ? timestamps[lo] : timestamps[hi];\n    ticks[timestamp] = true;\n  }\n}\n\n/**\n * @param {TimeScale} scale\n * @param {object[]} ticks\n * @param {object} map\n * @param {Unit} majorUnit\n * @return {object[]}\n */\nfunction setMajorTicks(scale, ticks, map, majorUnit) {\n  const adapter = scale._adapter;\n  const first = +adapter.startOf(ticks[0].value, majorUnit);\n  const last = ticks[ticks.length - 1].value;\n  let major, index;\n\n  for (major = first; major <= last; major = +adapter.add(major, 1, majorUnit)) {\n    index = map[major];\n    if (index >= 0) {\n      ticks[index].major = true;\n    }\n  }\n  return ticks;\n}\n\n/**\n * @param {TimeScale} scale\n * @param {number[]} values\n * @param {Unit|undefined} [majorUnit]\n * @return {object[]}\n */\nfunction ticksFromTimestamps(scale, values, majorUnit) {\n  const ticks = [];\n  /** @type {Object<number,object>} */\n  const map = {};\n  const ilen = values.length;\n  let i, value;\n\n  for (i = 0; i < ilen; ++i) {\n    value = values[i];\n    map[value] = i;\n\n    ticks.push({\n      value,\n      major: false\n    });\n  }\n\n  // We set the major ticks separately from the above loop because calling startOf for every tick\n  // is expensive when there is a large number of ticks\n  return (ilen === 0 || !majorUnit) ? ticks : setMajorTicks(scale, ticks, map, majorUnit);\n}\n\nexport default class TimeScale extends Scale {\n\n  static id = 'time';\n\n  /**\n   * @type {any}\n   */\n  static defaults = {\n    /**\n     * Scale boundary strategy (bypassed by min/max time options)\n     * - `data`: make sure data are fully visible, ticks outside are removed\n     * - `ticks`: make sure ticks are fully visible, data outside are truncated\n     * @see https://github.com/chartjs/Chart.js/pull/4556\n     * @since 2.7.0\n     */\n    bounds: 'data',\n\n    adapters: {},\n    time: {\n      parser: false, // false == a pattern string from or a custom callback that converts its argument to a timestamp\n      unit: false, // false == automatic or override with week, month, year, etc.\n      round: false, // none, or override with week, month, year, etc.\n      isoWeekday: false, // override week start day\n      minUnit: 'millisecond',\n      displayFormats: {}\n    },\n    ticks: {\n      /**\n       * Ticks generation input values:\n       * - 'auto': generates \"optimal\" ticks based on scale size and time options.\n       * - 'data': generates ticks from data (including labels from data {t|x|y} objects).\n       * - 'labels': generates ticks from user given `data.labels` values ONLY.\n       * @see https://github.com/chartjs/Chart.js/pull/4507\n       * @since 2.7.0\n       */\n      source: 'auto',\n\n      callback: false,\n\n      major: {\n        enabled: false\n      }\n    }\n  };\n\n  /**\n\t * @param {object} props\n\t */\n  constructor(props) {\n    super(props);\n\n    /** @type {{data: number[], labels: number[], all: number[]}} */\n    this._cache = {\n      data: [],\n      labels: [],\n      all: []\n    };\n\n    /** @type {Unit} */\n    this._unit = 'day';\n    /** @type {Unit=} */\n    this._majorUnit = undefined;\n    this._offsets = {};\n    this._normalized = false;\n    this._parseOpts = undefined;\n  }\n\n  init(scaleOpts, opts = {}) {\n    const time = scaleOpts.time || (scaleOpts.time = {});\n    /** @type {DateAdapter} */\n    const adapter = this._adapter = new adapters._date(scaleOpts.adapters.date);\n\n    adapter.init(opts);\n\n    // Backward compatibility: before introducing adapter, `displayFormats` was\n    // supposed to contain *all* unit/string pairs but this can't be resolved\n    // when loading the scale (adapters are loaded afterward), so let's populate\n    // missing formats on update\n    mergeIf(time.displayFormats, adapter.formats());\n\n    this._parseOpts = {\n      parser: time.parser,\n      round: time.round,\n      isoWeekday: time.isoWeekday\n    };\n\n    super.init(scaleOpts);\n\n    this._normalized = opts.normalized;\n  }\n\n  /**\n\t * @param {*} raw\n\t * @param {number?} [index]\n\t * @return {number}\n\t */\n  parse(raw, index) { // eslint-disable-line no-unused-vars\n    if (raw === undefined) {\n      return null;\n    }\n    return parse(this, raw);\n  }\n\n  beforeLayout() {\n    super.beforeLayout();\n    this._cache = {\n      data: [],\n      labels: [],\n      all: []\n    };\n  }\n\n  determineDataLimits() {\n    const options = this.options;\n    const adapter = this._adapter;\n    const unit = options.time.unit || 'day';\n    // eslint-disable-next-line prefer-const\n    let {min, max, minDefined, maxDefined} = this.getUserBounds();\n\n    /**\n\t\t * @param {object} bounds\n\t\t */\n    function _applyBounds(bounds) {\n      if (!minDefined && !isNaN(bounds.min)) {\n        min = Math.min(min, bounds.min);\n      }\n      if (!maxDefined && !isNaN(bounds.max)) {\n        max = Math.max(max, bounds.max);\n      }\n    }\n\n    // If we have user provided `min` and `max` labels / data bounds can be ignored\n    if (!minDefined || !maxDefined) {\n      // Labels are always considered, when user did not force bounds\n      _applyBounds(this._getLabelBounds());\n\n      // If `bounds` is `'ticks'` and `ticks.source` is `'labels'`,\n      // data bounds are ignored (and don't need to be determined)\n      if (options.bounds !== 'ticks' || options.ticks.source !== 'labels') {\n        _applyBounds(this.getMinMax(false));\n      }\n    }\n\n    min = isFinite(min) && !isNaN(min) ? min : +adapter.startOf(Date.now(), unit);\n    max = isFinite(max) && !isNaN(max) ? max : +adapter.endOf(Date.now(), unit) + 1;\n\n    // Make sure that max is strictly higher than min (required by the timeseries lookup table)\n    this.min = Math.min(min, max - 1);\n    this.max = Math.max(min + 1, max);\n  }\n\n  /**\n\t * @private\n\t */\n  _getLabelBounds() {\n    const arr = this.getLabelTimestamps();\n    let min = Number.POSITIVE_INFINITY;\n    let max = Number.NEGATIVE_INFINITY;\n\n    if (arr.length) {\n      min = arr[0];\n      max = arr[arr.length - 1];\n    }\n    return {min, max};\n  }\n\n  /**\n\t * @return {object[]}\n\t */\n  buildTicks() {\n    const options = this.options;\n    const timeOpts = options.time;\n    const tickOpts = options.ticks;\n    const timestamps = tickOpts.source === 'labels' ? this.getLabelTimestamps() : this._generate();\n\n    if (options.bounds === 'ticks' && timestamps.length) {\n      this.min = this._userMin || timestamps[0];\n      this.max = this._userMax || timestamps[timestamps.length - 1];\n    }\n\n    const min = this.min;\n    const max = this.max;\n\n    const ticks = _filterBetween(timestamps, min, max);\n\n    // PRIVATE\n    // determineUnitForFormatting relies on the number of ticks so we don't use it when\n    // autoSkip is enabled because we don't yet know what the final number of ticks will be\n    this._unit = timeOpts.unit || (tickOpts.autoSkip\n      ? determineUnitForAutoTicks(timeOpts.minUnit, this.min, this.max, this._getLabelCapacity(min))\n      : determineUnitForFormatting(this, ticks.length, timeOpts.minUnit, this.min, this.max));\n    this._majorUnit = !tickOpts.major.enabled || this._unit === 'year' ? undefined\n      : determineMajorUnit(this._unit);\n    this.initOffsets(timestamps);\n\n    if (options.reverse) {\n      ticks.reverse();\n    }\n\n    return ticksFromTimestamps(this, ticks, this._majorUnit);\n  }\n\n  afterAutoSkip() {\n    // Offsets for bar charts need to be handled with the auto skipped\n    // ticks. Once ticks have been skipped, we re-compute the offsets.\n    if (this.options.offsetAfterAutoskip) {\n      this.initOffsets(this.ticks.map(tick => +tick.value));\n    }\n  }\n\n  /**\n\t * Returns the start and end offsets from edges in the form of {start, end}\n\t * where each value is a relative width to the scale and ranges between 0 and 1.\n\t * They add extra margins on the both sides by scaling down the original scale.\n\t * Offsets are added when the `offset` option is true.\n\t * @param {number[]} timestamps\n\t * @protected\n\t */\n  initOffsets(timestamps = []) {\n    let start = 0;\n    let end = 0;\n    let first, last;\n\n    if (this.options.offset && timestamps.length) {\n      first = this.getDecimalForValue(timestamps[0]);\n      if (timestamps.length === 1) {\n        start = 1 - first;\n      } else {\n        start = (this.getDecimalForValue(timestamps[1]) - first) / 2;\n      }\n      last = this.getDecimalForValue(timestamps[timestamps.length - 1]);\n      if (timestamps.length === 1) {\n        end = last;\n      } else {\n        end = (last - this.getDecimalForValue(timestamps[timestamps.length - 2])) / 2;\n      }\n    }\n    const limit = timestamps.length < 3 ? 0.5 : 0.25;\n    start = _limitValue(start, 0, limit);\n    end = _limitValue(end, 0, limit);\n\n    this._offsets = {start, end, factor: 1 / (start + 1 + end)};\n  }\n\n  /**\n\t * Generates a maximum of `capacity` timestamps between min and max, rounded to the\n\t * `minor` unit using the given scale time `options`.\n\t * Important: this method can return ticks outside the min and max range, it's the\n\t * responsibility of the calling code to clamp values if needed.\n\t * @private\n\t */\n  _generate() {\n    const adapter = this._adapter;\n    const min = this.min;\n    const max = this.max;\n    const options = this.options;\n    const timeOpts = options.time;\n    // @ts-ignore\n    const minor = timeOpts.unit || determineUnitForAutoTicks(timeOpts.minUnit, min, max, this._getLabelCapacity(min));\n    const stepSize = valueOrDefault(options.ticks.stepSize, 1);\n    const weekday = minor === 'week' ? timeOpts.isoWeekday : false;\n    const hasWeekday = isNumber(weekday) || weekday === true;\n    const ticks = {};\n    let first = min;\n    let time, count;\n\n    // For 'week' unit, handle the first day of week option\n    if (hasWeekday) {\n      first = +adapter.startOf(first, 'isoWeek', weekday);\n    }\n\n    // Align first ticks on unit\n    first = +adapter.startOf(first, hasWeekday ? 'day' : minor);\n\n    // Prevent browser from freezing in case user options request millions of milliseconds\n    if (adapter.diff(max, min, minor) > 100000 * stepSize) {\n      throw new Error(min + ' and ' + max + ' are too far apart with stepSize of ' + stepSize + ' ' + minor);\n    }\n\n    const timestamps = options.ticks.source === 'data' && this.getDataTimestamps();\n    for (time = first, count = 0; time < max; time = +adapter.add(time, stepSize, minor), count++) {\n      addTick(ticks, time, timestamps);\n    }\n\n    if (time === max || options.bounds === 'ticks' || count === 1) {\n      addTick(ticks, time, timestamps);\n    }\n\n    // @ts-ignore\n    return Object.keys(ticks).sort((a, b) => a - b).map(x => +x);\n  }\n\n  /**\n\t * @param {number} value\n\t * @return {string}\n\t */\n  getLabelForValue(value) {\n    const adapter = this._adapter;\n    const timeOpts = this.options.time;\n\n    if (timeOpts.tooltipFormat) {\n      return adapter.format(value, timeOpts.tooltipFormat);\n    }\n    return adapter.format(value, timeOpts.displayFormats.datetime);\n  }\n\n  /**\n\t * Function to format an individual tick mark\n\t * @param {number} time\n\t * @param {number} index\n\t * @param {object[]} ticks\n\t * @param {string|undefined} [format]\n\t * @return {string}\n\t * @private\n\t */\n  _tickFormatFunction(time, index, ticks, format) {\n    const options = this.options;\n    const formatter = options.ticks.callback;\n\n    if (formatter) {\n      return call(formatter, [time, index, ticks], this);\n    }\n\n    const formats = options.time.displayFormats;\n    const unit = this._unit;\n    const majorUnit = this._majorUnit;\n    const minorFormat = unit && formats[unit];\n    const majorFormat = majorUnit && formats[majorUnit];\n    const tick = ticks[index];\n    const major = majorUnit && majorFormat && tick && tick.major;\n\n    return this._adapter.format(time, format || (major ? majorFormat : minorFormat));\n  }\n\n  /**\n\t * @param {object[]} ticks\n\t */\n  generateTickLabels(ticks) {\n    let i, ilen, tick;\n\n    for (i = 0, ilen = ticks.length; i < ilen; ++i) {\n      tick = ticks[i];\n      tick.label = this._tickFormatFunction(tick.value, i, ticks);\n    }\n  }\n\n  /**\n\t * @param {number} value - Milliseconds since epoch (1 January 1970 00:00:00 UTC)\n\t * @return {number}\n\t */\n  getDecimalForValue(value) {\n    return value === null ? NaN : (value - this.min) / (this.max - this.min);\n  }\n\n  /**\n\t * @param {number} value - Milliseconds since epoch (1 January 1970 00:00:00 UTC)\n\t * @return {number}\n\t */\n  getPixelForValue(value) {\n    const offsets = this._offsets;\n    const pos = this.getDecimalForValue(value);\n    return this.getPixelForDecimal((offsets.start + pos) * offsets.factor);\n  }\n\n  /**\n\t * @param {number} pixel\n\t * @return {number}\n\t */\n  getValueForPixel(pixel) {\n    const offsets = this._offsets;\n    const pos = this.getDecimalForPixel(pixel) / offsets.factor - offsets.end;\n    return this.min + pos * (this.max - this.min);\n  }\n\n  /**\n\t * @param {string} label\n\t * @return {{w:number, h:number}}\n\t * @private\n\t */\n  _getLabelSize(label) {\n    const ticksOpts = this.options.ticks;\n    const tickLabelWidth = this.ctx.measureText(label).width;\n    const angle = toRadians(this.isHorizontal() ? ticksOpts.maxRotation : ticksOpts.minRotation);\n    const cosRotation = Math.cos(angle);\n    const sinRotation = Math.sin(angle);\n    const tickFontSize = this._resolveTickFontOptions(0).size;\n\n    return {\n      w: (tickLabelWidth * cosRotation) + (tickFontSize * sinRotation),\n      h: (tickLabelWidth * sinRotation) + (tickFontSize * cosRotation)\n    };\n  }\n\n  /**\n\t * @param {number} exampleTime\n\t * @return {number}\n\t * @private\n\t */\n  _getLabelCapacity(exampleTime) {\n    const timeOpts = this.options.time;\n    const displayFormats = timeOpts.displayFormats;\n\n    // pick the longest format (milliseconds) for guestimation\n    const format = displayFormats[timeOpts.unit] || displayFormats.millisecond;\n    const exampleLabel = this._tickFormatFunction(exampleTime, 0, ticksFromTimestamps(this, [exampleTime], this._majorUnit), format);\n    const size = this._getLabelSize(exampleLabel);\n    // subtract 1 - if offset then there's one less label than tick\n    // if not offset then one half label padding is added to each end leaving room for one less label\n    const capacity = Math.floor(this.isHorizontal() ? this.width / size.w : this.height / size.h) - 1;\n    return capacity > 0 ? capacity : 1;\n  }\n\n  /**\n\t * @protected\n\t */\n  getDataTimestamps() {\n    let timestamps = this._cache.data || [];\n    let i, ilen;\n\n    if (timestamps.length) {\n      return timestamps;\n    }\n\n    const metas = this.getMatchingVisibleMetas();\n\n    if (this._normalized && metas.length) {\n      return (this._cache.data = metas[0].controller.getAllParsedValues(this));\n    }\n\n    for (i = 0, ilen = metas.length; i < ilen; ++i) {\n      timestamps = timestamps.concat(metas[i].controller.getAllParsedValues(this));\n    }\n\n    return (this._cache.data = this.normalize(timestamps));\n  }\n\n  /**\n\t * @protected\n\t */\n  getLabelTimestamps() {\n    const timestamps = this._cache.labels || [];\n    let i, ilen;\n\n    if (timestamps.length) {\n      return timestamps;\n    }\n\n    const labels = this.getLabels();\n    for (i = 0, ilen = labels.length; i < ilen; ++i) {\n      timestamps.push(parse(this, labels[i]));\n    }\n\n    return (this._cache.labels = this._normalized ? timestamps : this.normalize(timestamps));\n  }\n\n  /**\n\t * @param {number[]} values\n\t * @protected\n\t */\n  normalize(values) {\n    // It seems to be somewhat faster to do sorting first\n    return _arrayUnique(values.sort(sorter));\n  }\n}\n","import TimeScale from './scale.time';\nimport {_lookupByKey} from '../helpers/helpers.collection';\n\n/**\n * Linearly interpolates the given source `val` using the table. If value is out of bounds, values\n * at edges are used for the interpolation.\n * @param {object} table\n * @param {number} val\n * @param {boolean} [reverse] lookup time based on position instead of vice versa\n * @return {object}\n */\nfunction interpolate(table, val, reverse) {\n  let lo = 0;\n  let hi = table.length - 1;\n  let prevSource, nextSource, prevTarget, nextTarget;\n  if (reverse) {\n    if (val >= table[lo].pos && val <= table[hi].pos) {\n      ({lo, hi} = _lookupByKey(table, 'pos', val));\n    }\n    ({pos: prevSource, time: prevTarget} = table[lo]);\n    ({pos: nextSource, time: nextTarget} = table[hi]);\n  } else {\n    if (val >= table[lo].time && val <= table[hi].time) {\n      ({lo, hi} = _lookupByKey(table, 'time', val));\n    }\n    ({time: prevSource, pos: prevTarget} = table[lo]);\n    ({time: nextSource, pos: nextTarget} = table[hi]);\n  }\n\n  const span = nextSource - prevSource;\n  return span ? prevTarget + (nextTarget - prevTarget) * (val - prevSource) / span : prevTarget;\n}\n\nclass TimeSeriesScale extends TimeScale {\n\n  static id = 'timeseries';\n\n  /**\n   * @type {any}\n   */\n  static defaults = TimeScale.defaults;\n\n  /**\n\t * @param {object} props\n\t */\n  constructor(props) {\n    super(props);\n\n    /** @type {object[]} */\n    this._table = [];\n    /** @type {number} */\n    this._minPos = undefined;\n    /** @type {number} */\n    this._tableRange = undefined;\n  }\n\n  /**\n\t * @protected\n\t */\n  initOffsets() {\n    const timestamps = this._getTimestampsForTable();\n    const table = this._table = this.buildLookupTable(timestamps);\n    this._minPos = interpolate(table, this.min);\n    this._tableRange = interpolate(table, this.max) - this._minPos;\n    super.initOffsets(timestamps);\n  }\n\n  /**\n\t * Returns an array of {time, pos} objects used to interpolate a specific `time` or position\n\t * (`pos`) on the scale, by searching entries before and after the requested value. `pos` is\n\t * a decimal between 0 and 1: 0 being the start of the scale (left or top) and 1 the other\n\t * extremity (left + width or top + height). Note that it would be more optimized to directly\n\t * store pre-computed pixels, but the scale dimensions are not guaranteed at the time we need\n\t * to create the lookup table. The table ALWAYS contains at least two items: min and max.\n\t * @param {number[]} timestamps\n\t * @return {object[]}\n\t * @protected\n\t */\n  buildLookupTable(timestamps) {\n    const {min, max} = this;\n    const items = [];\n    const table = [];\n    let i, ilen, prev, curr, next;\n\n    for (i = 0, ilen = timestamps.length; i < ilen; ++i) {\n      curr = timestamps[i];\n      if (curr >= min && curr <= max) {\n        items.push(curr);\n      }\n    }\n\n    if (items.length < 2) {\n      // In case there is less that 2 timestamps between min and max, the scale is defined by min and max\n      return [\n        {time: min, pos: 0},\n        {time: max, pos: 1}\n      ];\n    }\n\n    for (i = 0, ilen = items.length; i < ilen; ++i) {\n      next = items[i + 1];\n      prev = items[i - 1];\n      curr = items[i];\n\n      // only add points that breaks the scale linearity\n      if (Math.round((next + prev) / 2) !== curr) {\n        table.push({time: curr, pos: i / (ilen - 1)});\n      }\n    }\n    return table;\n  }\n\n  /**\n\t * Returns all timestamps\n\t * @return {number[]}\n\t * @private\n\t */\n  _getTimestampsForTable() {\n    let timestamps = this._cache.all || [];\n\n    if (timestamps.length) {\n      return timestamps;\n    }\n\n    const data = this.getDataTimestamps();\n    const label = this.getLabelTimestamps();\n    if (data.length && label.length) {\n      // If combining labels and data (data might not contain all labels),\n      // we need to recheck uniqueness and sort\n      timestamps = this.normalize(data.concat(label));\n    } else {\n      timestamps = data.length ? data : label;\n    }\n    timestamps = this._cache.all = timestamps;\n\n    return timestamps;\n  }\n\n  /**\n\t * @param {number} value - Milliseconds since epoch (1 January 1970 00:00:00 UTC)\n\t * @return {number}\n\t */\n  getDecimalForValue(value) {\n    return (interpolate(this._table, value) - this._minPos) / this._tableRange;\n  }\n\n  /**\n\t * @param {number} pixel\n\t * @return {number}\n\t */\n  getValueForPixel(pixel) {\n    const offsets = this._offsets;\n    const decimal = this.getDecimalForPixel(pixel) / offsets.factor - offsets.end;\n    return interpolate(this._table, decimal * this._tableRange + this._minPos, true);\n  }\n}\n\nexport default TimeSeriesScale;\n","export * from './controllers';\nexport * from './core';\nexport * from './elements';\nexport * from './platform';\nexport * from './plugins';\nexport * from './scales';\n\nimport * as controllers from './controllers';\nimport * as elements from './elements';\nimport * as plugins from './plugins';\nimport * as scales from './scales';\n\nexport {\n  controllers,\n  elements,\n  plugins,\n  scales,\n};\n\nexport const registerables = [\n  controllers,\n  elements,\n  plugins,\n  scales,\n];\n","import {Chart, registerables} from '../dist/chart.js';\n\nChart.register(...registerables);\n\nexport * from '../dist/chart.js';\nexport default Chart;\n","export const DONUT_CHART_PALETTE = [\n  '#67b7dc',\n  '#6794dc',\n  '#6771dc',\n  '#8067dc',\n  '#a367dc',\n  '#c767dc',\n  '#dc67ce',\n  '#dc67ab',\n  '#dc6788',\n]\n\n/**\n *\n * @param {number[]} chartData\n * @param {string[]} chartLabels\n * @returns {Record<string,any>}\n */\nexport const GET_CONFIG = (chartData, chartLabels) => {\n  const data = {\n    labels: chartLabels,\n    datasets: [\n      {\n        data: chartData,\n        backgroundColor: DONUT_CHART_PALETTE,\n        borderWidth: 0,\n      },\n    ],\n  }\n\n  const config = {\n    type: 'doughnut',\n    data: data,\n    options: {\n      plugins: {\n        legend: {\n          display: true,\n          position: 'bottom',\n          labels: {\n            color: 'white',\n          },\n        },\n      },\n    },\n  }\n\n  return config\n}\n","<template>\n  <div class=\"calc-card\">\n    <div class=\"calc-card__remove\" @click=\"remove\" title=\"Remove product\">\n      <img alt=\"trash icon\" src=\"@/assets/trash-solid.svg\" />\n    </div>\n    <h5 class=\"calc-card__info\">\n      <span class=\"calc-card__info-name\"> {{ calculationItem.name }}</span>\n      <span class=\"calc-card__info-size\"> {{ calculationItem.size }} size</span>\n    </h5>\n\n    <div class=\"calc-card__graph\" v-if=\"getChartSwitcher\">\n      <canvas class=\"calc-card__graph-wrapper\" ref=\"chart\"></canvas>\n    </div>\n    <ul class=\"calc-card__ingredients\" v-else>\n      <li class=\"calc-card__ingredient\" v-for=\"(ingredient, index) in getFormulaItemsName\" :key=\"`ingredient-${index}`\">\n        <span>{{ ingredient }} :</span>\n        <span>{{ getIngredients[ingredient] }}</span>\n      </li>\n    </ul>\n\n    <div class=\"calc-card__counter counter\">\n      <span class=\"counter__decrement\" :class=\"{ disable: disableDecrement }\" @click=\"changeCount(-1)\">&minus;</span>\n      <input class=\"counter__input\" type=\"number\" min=\"1\" step=\"1\" v-model.lazy=\"count\" @change=\"handleChange\" />\n      <span class=\"counter__increment\" @click=\"changeCount(1)\">+</span>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex'\n\nimport { Chart } from 'chart.js/auto'\nimport { createKeyForCommodities } from '@/helpers'\nimport { GET_CONFIG } from '@/constants/chart'\n\nexport default {\n  name: 'CalculationCard',\n\n  data() {\n    return {\n      count: 1,\n    }\n  },\n\n  props: {\n    calculationItem: {\n      type: Object,\n      required: true,\n    },\n  },\n\n  computed: {\n    ...mapGetters({\n      getSingleCommodity: 'getSingleCommodity',\n      getChartSwitcher: 'getChartSwitcher',\n    }),\n    getIngredients() {\n      return this.getSingleCommodity(this.calculationItem.size, this.calculationItem.name).ingredients\n    },\n    getFormulaItemsName() {\n      return Object.keys(this.getIngredients)\n    },\n\n    disableDecrement() {\n      return this.count === 1 ? true : false\n    },\n  },\n\n  methods: {\n    ...mapActions({\n      changeFinalListCommodities: 'changeFinalListCommodities',\n      removeCommodity: 'removeCommodityFromCalculations',\n    }),\n\n    handleChange(event) {\n      const { value } = event.target\n      if (!this.count && isNaN(value)) this.count = 1\n      this.count = Math.floor(value)\n    },\n\n    changeCount(val) {\n      this.count += val\n      if (this.count < 1) this.count = 1\n    },\n\n    remove() {\n      this.removeCommodity(this.calculationItem)\n    },\n\n    createChart() {\n      const labels = Object.keys(this.getIngredients)\n      const chartData = Object.values(this.getIngredients)\n\n      new Chart(this.$refs.chart, GET_CONFIG(chartData, labels))\n    },\n  },\n\n  watch: {\n    count: {\n      handler(newVal) {\n        /** @type {FinalListComponent} payload */\n        const payload = { name: createKeyForCommodities(this.calculationItem), data: {} }\n        this.getFormulaItemsName.forEach((el) => {\n          payload.data[el] = this.getIngredients[el] * newVal\n        })\n\n        this.changeFinalListCommodities(payload)\n      },\n\n      immediate: true,\n    },\n    getChartSwitcher: {\n      handler() {\n        this.$nextTick(() => {\n          if (this.getChartSwitcher) {\n            this.createChart()\n          }\n        })\n      },\n\n      immediate: true,\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/scss/colors.scss';\n\n.calc-card {\n  position: relative;\n  min-width: 250px;\n  padding: 20px;\n  margin: 10px 0;\n  color: white;\n  border-radius: 15px;\n  box-shadow: 7px 7px 3px 0px rgba(0, 0, 0, 0.15);\n  background-color: $dark_2;\n  background-image: url('@/assets/hexagon.svg');\n  background-repeat: no-repeat;\n  background-size: 40%;\n  background-position: bottom 10px left 10px;\n\n  &__info {\n    margin-bottom: 15px;\n    display: flex;\n    flex-direction: column;\n    text-align: start;\n    max-width: 80%;\n\n    &-name {\n      text-transform: capitalize;\n      border-bottom: 1px solid $dark_1;\n      padding-bottom: 5px;\n      margin-bottom: 5px;\n    }\n  }\n\n  &__ingredient {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 5px;\n\n    span {\n      &:nth-child(1) {\n        margin-right: 40px;\n        text-transform: capitalize;\n      }\n    }\n  }\n\n  &__graph-wrapper {\n    width: 300px;\n    height: 300px;\n  }\n\n  &__remove {\n    position: absolute;\n    top: 10px;\n    right: 10px;\n    width: 15px;\n    height: 17px;\n    cursor: pointer;\n  }\n}\n\n.counter {\n  margin-top: 40px;\n  display: flex;\n  justify-content: center;\n\n  &__input {\n    height: 30px;\n    width: 50px;\n    background-color: $bg;\n    padding: 0 5px;\n  }\n\n  &__increment,\n  &__decrement {\n    color: black;\n    display: flex;\n    align-items: center;\n    padding: 5px 10px;\n    background-color: $dark_1;\n    cursor: pointer;\n  }\n\n  &__increment {\n    border-top-right-radius: 5px;\n    border-bottom-right-radius: 5px;\n  }\n\n  &__decrement {\n    border-top-left-radius: 5px;\n    border-bottom-left-radius: 5px;\n\n    &.disable {\n      cursor: default;\n      pointer-events: none;\n      opacity: 0.5;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CalculationCard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CalculationCard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CalculationCard.vue?vue&type=template&id=56cfeb5e&\"\nimport script from \"./CalculationCard.vue?vue&type=script&lang=js&\"\nexport * from \"./CalculationCard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CalculationCard.vue?vue&type=style&index=0&id=56cfeb5e&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"calc-block\">\n    <h2 v-if=\"!quantityCalculationElements\">For calculating need add commodities</h2>\n    <h2 v-else>Calculate ingredients</h2>\n    <div class=\"calc-block__cards\" v-if=\"quantityCalculationElements\">\n      <CalculationCard\n        v-for=\"(item, index) in getCalculationElements\"\n        :key=\"`calc-block__card-${index}`\"\n        :calculationItem=\"item\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\n\nimport CalculationCard from '@/components/Calculation/CalculationCard.vue'\n\nexport default {\n  name: 'CalculationBlock',\n  components: {\n    CalculationCard,\n  },\n\n  computed: {\n    ...mapGetters({\n      getCalculationElements: 'getCalculationElements',\n    }),\n\n    quantityCalculationElements() {\n      return this.getCalculationElements.length\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\">\n.calc-block {\n  margin-bottom: 10px;\n\n  h2 {\n    margin-bottom: 10px;\n  }\n\n  &__cards {\n    display: flex;\n    justify-content: space-around;\n    flex-wrap: wrap;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CalculationBlock.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CalculationBlock.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CalculationBlock.vue?vue&type=template&id=dfd815ae&\"\nimport script from \"./CalculationBlock.vue?vue&type=script&lang=js&\"\nexport * from \"./CalculationBlock.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CalculationBlock.vue?vue&type=style&index=0&id=dfd815ae&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"size-block\"},_vm._l((_vm.getSizeTypes),function(sizeType,index){return _c('div',{key:`size-block__elem-${index}`,staticClass:\"size-block__elem\"},[_c('div',{staticClass:\"size-block__elem-name\"},[_vm._v(_vm._s(sizeType))]),_c('div',{staticClass:\"size-block__elem-commodities\"},_vm._l((_vm.getAllCommoditiesByType(sizeType)),function(singleCommodity,index){return _c('CommodityElement',{key:`formula-elem-${index}`,staticClass:\"size-block__elem-component\",attrs:{\"positionSizeGroup\":sizeType,\"commodity\":singleCommodity}})}),1)])}),0)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"commodity-elem\"},[_c('button',{on:{\"click\":function($event){return _vm.changeCalculationData({ size: _vm.positionSizeGroup, name: _vm.commodity.name })}}},[_vm._m(0),_c('span',[_vm._v(_vm._s(_vm.commodity.name))])])])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('span',[_c('img',{staticClass:\"commodity-elem__icon\",attrs:{\"src\":require(\"@/assets/honey.svg\"),\"alt\":\"\"}})])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"commodity-elem\">\n    <button @click=\"changeCalculationData({ size: positionSizeGroup, name: commodity.name })\">\n      <span>\n        <img class=\"commodity-elem__icon\" src=\"@/assets/honey.svg\" alt=\"\" />\n      </span>\n      <span>{{ commodity.name }}</span>\n    </button>\n  </div>\n</template>\n\n<script>\nimport { mapActions } from 'vuex'\n\nexport default {\n  name: 'CommodityElement',\n  props: {\n    commodity: {\n      type: Object,\n      required: true,\n    },\n    positionSizeGroup: {\n      type: String,\n      required: true,\n    },\n  },\n\n  methods: {\n    ...mapActions({\n      changeCalculationData: 'changeCalculationData',\n    }),\n  },\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/scss/colors.scss';\n\n.commodity-elem {\n  display: flex;\n  padding: 5px 10px;\n  border-bottom: 1px solid $dark_4;\n  border-right: 1px solid $dark_4;\n  border-bottom-right-radius: 15px;\n\n  button {\n    text-transform: capitalize;\n  }\n\n  &__icon {\n    width: 25px;\n    height: 25px;\n    margin-right: 10px;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommodityElement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommodityElement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CommodityElement.vue?vue&type=template&id=134ae3ef&\"\nimport script from \"./CommodityElement.vue?vue&type=script&lang=js&\"\nexport * from \"./CommodityElement.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CommodityElement.vue?vue&type=style&index=0&id=134ae3ef&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"size-block\">\n    <div class=\"size-block__elem\" v-for=\"(sizeType, index) in getSizeTypes\" :key=\"`size-block__elem-${index}`\">\n      <div class=\"size-block__elem-name\">{{ sizeType }}</div>\n      <div class=\"size-block__elem-commodities\">\n        <CommodityElement\n          class=\"size-block__elem-component\"\n          v-for=\"(singleCommodity, index) in getAllCommoditiesByType(sizeType)\"\n          :key=\"`formula-elem-${index}`\"\n          :positionSizeGroup=\"sizeType\"\n          :commodity=\"singleCommodity\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\n\nimport CommodityElement from '@/components/Commodities/CommodityElement.vue'\n\nexport default {\n  name: 'CommoditySizeBlock',\n  components: { CommodityElement },\n\n  computed: {\n    ...mapGetters({\n      getSizeTypes: 'getSizeTypes',\n      getSingleSizeData: 'getSingleSizeData',\n    }),\n  },\n\n  methods: {\n    getAllCommoditiesByType(type) {\n      return this.getSingleSizeData(type)\n    },\n  },\n}\n</script>\n\n<style lang=\"scss\">\n@import '@/scss/colors.scss';\n\n.size-block {\n  width: 100%;\n  max-width: 2000px;\n  margin: auto;\n\n  &__elem {\n    width: 100%;\n    margin: 15px 0;\n    display: flex;\n    justify-content: space-between;\n\n    &-name {\n      width: 10%;\n      max-width: 100px;\n      margin-right: 20px;\n      padding: 10px;\n      text-align: start;\n      text-transform: capitalize;\n      position: relative;\n      display: flex;\n      align-items: center;\n\n      &::before {\n        content: '';\n        position: absolute;\n        bottom: -10px;\n        left: 0;\n        width: 120px;\n        height: 2px;\n        background: linear-gradient(\n          90deg,\n          rgba(67, 101, 90, 1) 0%,\n          rgba(93, 125, 125, 1) 35%,\n          rgba(229, 229, 229, 1) 100%\n        );\n        clip-path: polygon(100% 0, 0 0, 0 100%);\n      }\n    }\n\n    &-commodities {\n      flex: 1 1 auto;\n      display: flex;\n      gap: 10px;\n      flex-wrap: wrap;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommoditySizeBlock.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CommoditySizeBlock.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CommoditySizeBlock.vue?vue&type=template&id=34806958&\"\nimport script from \"./CommoditySizeBlock.vue?vue&type=script&lang=js&\"\nexport * from \"./CommoditySizeBlock.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CommoditySizeBlock.vue?vue&type=style&index=0&id=34806958&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"manual\">\n    <Switchers />\n    <div class=\"manual-data\" v-if=\"getSheetData\">\n      <CommoditySizeBlock />\n      <CalculationBlock />\n      <FinalBlock />\n    </div>\n\n    <div class=\"manual-load\" v-else>\n      <h3 class=\"manual-load__title\">Please load data with correct field</h3>\n      <AppFileReader />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\n\nimport AppFileReader from '@/components/AppFileReader.vue'\nimport FinalBlock from '@/components/FinalBlock/FinalBlock.vue'\nimport Switchers from '@/components/Switchers/Switchers.vue'\nimport CalculationBlock from '@/components/Calculation/CalculationBlock.vue'\nimport CommoditySizeBlock from '@/components/Commodities/CommoditySizeBlock.vue'\n\nexport default {\n  name: 'ManualView',\n  data() {\n    return {}\n  },\n\n  components: {\n    FinalBlock,\n    Switchers,\n    AppFileReader,\n    CalculationBlock,\n    CommoditySizeBlock,\n  },\n\n  created() {\n    this.resetStore()\n  },\n\n  computed: {\n    ...mapGetters({\n      getSheetData: 'getSheetData',\n    }),\n  },\n\n  methods: {\n    ...mapActions({\n      resetStore: 'resetStore',\n    }),\n  },\n}\n</script>\n\n<style lang=\"scss\">\n.manual-load {\n  margin: 20px 0;\n  &__title {\n    margin-bottom: 10px;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManualView.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ManualView.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ManualView.vue?vue&type=template&id=3131e1ab&\"\nimport script from \"./ManualView.vue?vue&type=script&lang=js&\"\nexport * from \"./ManualView.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ManualView.vue?vue&type=style&index=0&id=3131e1ab&prod&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","// eslint-disable-next-line es/no-typed-arrays -- safe\nmodule.exports = typeof ArrayBuffer != 'undefined' && typeof DataView != 'undefined';\n","'use strict';\nvar NATIVE_ARRAY_BUFFER = require('../internals/array-buffer-basic-detection');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isCallable = require('../internals/is-callable');\nvar isObject = require('../internals/is-object');\nvar hasOwn = require('../internals/has-own-property');\nvar classof = require('../internals/classof');\nvar tryToString = require('../internals/try-to-string');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar defineBuiltIn = require('../internals/define-built-in');\nvar defineProperty = require('../internals/object-define-property').f;\nvar isPrototypeOf = require('../internals/object-is-prototype-of');\nvar getPrototypeOf = require('../internals/object-get-prototype-of');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar uid = require('../internals/uid');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar enforceInternalState = InternalStateModule.enforce;\nvar getInternalState = InternalStateModule.get;\nvar Int8Array = global.Int8Array;\nvar Int8ArrayPrototype = Int8Array && Int8Array.prototype;\nvar Uint8ClampedArray = global.Uint8ClampedArray;\nvar Uint8ClampedArrayPrototype = Uint8ClampedArray && Uint8ClampedArray.prototype;\nvar TypedArray = Int8Array && getPrototypeOf(Int8Array);\nvar TypedArrayPrototype = Int8ArrayPrototype && getPrototypeOf(Int8ArrayPrototype);\nvar ObjectPrototype = Object.prototype;\nvar TypeError = global.TypeError;\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar TYPED_ARRAY_TAG = uid('TYPED_ARRAY_TAG');\nvar TYPED_ARRAY_CONSTRUCTOR = 'TypedArrayConstructor';\n// Fixing native typed arrays in Opera Presto crashes the browser, see #595\nvar NATIVE_ARRAY_BUFFER_VIEWS = NATIVE_ARRAY_BUFFER && !!setPrototypeOf && classof(global.opera) !== 'Opera';\nvar TYPED_ARRAY_TAG_REQUIRED = false;\nvar NAME, Constructor, Prototype;\n\nvar TypedArrayConstructorsList = {\n  Int8Array: 1,\n  Uint8Array: 1,\n  Uint8ClampedArray: 1,\n  Int16Array: 2,\n  Uint16Array: 2,\n  Int32Array: 4,\n  Uint32Array: 4,\n  Float32Array: 4,\n  Float64Array: 8\n};\n\nvar BigIntArrayConstructorsList = {\n  BigInt64Array: 8,\n  BigUint64Array: 8\n};\n\nvar isView = function isView(it) {\n  if (!isObject(it)) return false;\n  var klass = classof(it);\n  return klass === 'DataView'\n    || hasOwn(TypedArrayConstructorsList, klass)\n    || hasOwn(BigIntArrayConstructorsList, klass);\n};\n\nvar getTypedArrayConstructor = function (it) {\n  var proto = getPrototypeOf(it);\n  if (!isObject(proto)) return;\n  var state = getInternalState(proto);\n  return (state && hasOwn(state, TYPED_ARRAY_CONSTRUCTOR)) ? state[TYPED_ARRAY_CONSTRUCTOR] : getTypedArrayConstructor(proto);\n};\n\nvar isTypedArray = function (it) {\n  if (!isObject(it)) return false;\n  var klass = classof(it);\n  return hasOwn(TypedArrayConstructorsList, klass)\n    || hasOwn(BigIntArrayConstructorsList, klass);\n};\n\nvar aTypedArray = function (it) {\n  if (isTypedArray(it)) return it;\n  throw TypeError('Target is not a typed array');\n};\n\nvar aTypedArrayConstructor = function (C) {\n  if (isCallable(C) && (!setPrototypeOf || isPrototypeOf(TypedArray, C))) return C;\n  throw TypeError(tryToString(C) + ' is not a typed array constructor');\n};\n\nvar exportTypedArrayMethod = function (KEY, property, forced, options) {\n  if (!DESCRIPTORS) return;\n  if (forced) for (var ARRAY in TypedArrayConstructorsList) {\n    var TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && hasOwn(TypedArrayConstructor.prototype, KEY)) try {\n      delete TypedArrayConstructor.prototype[KEY];\n    } catch (error) {\n      // old WebKit bug - some methods are non-configurable\n      try {\n        TypedArrayConstructor.prototype[KEY] = property;\n      } catch (error2) { /* empty */ }\n    }\n  }\n  if (!TypedArrayPrototype[KEY] || forced) {\n    defineBuiltIn(TypedArrayPrototype, KEY, forced ? property\n      : NATIVE_ARRAY_BUFFER_VIEWS && Int8ArrayPrototype[KEY] || property, options);\n  }\n};\n\nvar exportTypedArrayStaticMethod = function (KEY, property, forced) {\n  var ARRAY, TypedArrayConstructor;\n  if (!DESCRIPTORS) return;\n  if (setPrototypeOf) {\n    if (forced) for (ARRAY in TypedArrayConstructorsList) {\n      TypedArrayConstructor = global[ARRAY];\n      if (TypedArrayConstructor && hasOwn(TypedArrayConstructor, KEY)) try {\n        delete TypedArrayConstructor[KEY];\n      } catch (error) { /* empty */ }\n    }\n    if (!TypedArray[KEY] || forced) {\n      // V8 ~ Chrome 49-50 `%TypedArray%` methods are non-writable non-configurable\n      try {\n        return defineBuiltIn(TypedArray, KEY, forced ? property : NATIVE_ARRAY_BUFFER_VIEWS && TypedArray[KEY] || property);\n      } catch (error) { /* empty */ }\n    } else return;\n  }\n  for (ARRAY in TypedArrayConstructorsList) {\n    TypedArrayConstructor = global[ARRAY];\n    if (TypedArrayConstructor && (!TypedArrayConstructor[KEY] || forced)) {\n      defineBuiltIn(TypedArrayConstructor, KEY, property);\n    }\n  }\n};\n\nfor (NAME in TypedArrayConstructorsList) {\n  Constructor = global[NAME];\n  Prototype = Constructor && Constructor.prototype;\n  if (Prototype) enforceInternalState(Prototype)[TYPED_ARRAY_CONSTRUCTOR] = Constructor;\n  else NATIVE_ARRAY_BUFFER_VIEWS = false;\n}\n\nfor (NAME in BigIntArrayConstructorsList) {\n  Constructor = global[NAME];\n  Prototype = Constructor && Constructor.prototype;\n  if (Prototype) enforceInternalState(Prototype)[TYPED_ARRAY_CONSTRUCTOR] = Constructor;\n}\n\n// WebKit bug - typed arrays constructors prototype is Object.prototype\nif (!NATIVE_ARRAY_BUFFER_VIEWS || !isCallable(TypedArray) || TypedArray === Function.prototype) {\n  // eslint-disable-next-line no-shadow -- safe\n  TypedArray = function TypedArray() {\n    throw TypeError('Incorrect invocation');\n  };\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME], TypedArray);\n  }\n}\n\nif (!NATIVE_ARRAY_BUFFER_VIEWS || !TypedArrayPrototype || TypedArrayPrototype === ObjectPrototype) {\n  TypedArrayPrototype = TypedArray.prototype;\n  if (NATIVE_ARRAY_BUFFER_VIEWS) for (NAME in TypedArrayConstructorsList) {\n    if (global[NAME]) setPrototypeOf(global[NAME].prototype, TypedArrayPrototype);\n  }\n}\n\n// WebKit bug - one more object in Uint8ClampedArray prototype chain\nif (NATIVE_ARRAY_BUFFER_VIEWS && getPrototypeOf(Uint8ClampedArrayPrototype) !== TypedArrayPrototype) {\n  setPrototypeOf(Uint8ClampedArrayPrototype, TypedArrayPrototype);\n}\n\nif (DESCRIPTORS && !hasOwn(TypedArrayPrototype, TO_STRING_TAG)) {\n  TYPED_ARRAY_TAG_REQUIRED = true;\n  defineProperty(TypedArrayPrototype, TO_STRING_TAG, { get: function () {\n    return isObject(this) ? this[TYPED_ARRAY_TAG] : undefined;\n  } });\n  for (NAME in TypedArrayConstructorsList) if (global[NAME]) {\n    createNonEnumerableProperty(global[NAME], TYPED_ARRAY_TAG, NAME);\n  }\n}\n\nmodule.exports = {\n  NATIVE_ARRAY_BUFFER_VIEWS: NATIVE_ARRAY_BUFFER_VIEWS,\n  TYPED_ARRAY_TAG: TYPED_ARRAY_TAG_REQUIRED && TYPED_ARRAY_TAG,\n  aTypedArray: aTypedArray,\n  aTypedArrayConstructor: aTypedArrayConstructor,\n  exportTypedArrayMethod: exportTypedArrayMethod,\n  exportTypedArrayStaticMethod: exportTypedArrayStaticMethod,\n  getTypedArrayConstructor: getTypedArrayConstructor,\n  isView: isView,\n  isTypedArray: isTypedArray,\n  TypedArray: TypedArray,\n  TypedArrayPrototype: TypedArrayPrototype\n};\n","var bind = require('../internals/function-bind-context');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\n\n// `Array.prototype.{ findLast, findLastIndex }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_FIND_LAST_INDEX = TYPE == 1;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that);\n    var index = lengthOfArrayLike(self);\n    var value, result;\n    while (index-- > 0) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (result) switch (TYPE) {\n        case 0: return value; // findLast\n        case 1: return index; // findLastIndex\n      }\n    }\n    return IS_FIND_LAST_INDEX ? -1 : undefined;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.findLast` method\n  // https://github.com/tc39/proposal-array-find-from-last\n  findLast: createMethod(0),\n  // `Array.prototype.findLastIndex` method\n  // https://github.com/tc39/proposal-array-find-from-last\n  findLastIndex: createMethod(1)\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  function F() { /* empty */ }\n  F.prototype.constructor = null;\n  // eslint-disable-next-line es/no-object-getprototypeof -- required for testing\n  return Object.getPrototypeOf(new F()) !== F.prototype;\n});\n","var makeBuiltIn = require('../internals/make-built-in');\nvar defineProperty = require('../internals/object-define-property');\n\nmodule.exports = function (target, name, descriptor) {\n  if (descriptor.get) makeBuiltIn(descriptor.get, name, { getter: true });\n  if (descriptor.set) makeBuiltIn(descriptor.set, name, { setter: true });\n  return defineProperty.f(target, name, descriptor);\n};\n","var hasOwn = require('../internals/has-own-property');\nvar isCallable = require('../internals/is-callable');\nvar toObject = require('../internals/to-object');\nvar sharedKey = require('../internals/shared-key');\nvar CORRECT_PROTOTYPE_GETTER = require('../internals/correct-prototype-getter');\n\nvar IE_PROTO = sharedKey('IE_PROTO');\nvar $Object = Object;\nvar ObjectPrototype = $Object.prototype;\n\n// `Object.getPrototypeOf` method\n// https://tc39.es/ecma262/#sec-object.getprototypeof\n// eslint-disable-next-line es/no-object-getprototypeof -- safe\nmodule.exports = CORRECT_PROTOTYPE_GETTER ? $Object.getPrototypeOf : function (O) {\n  var object = toObject(O);\n  if (hasOwn(object, IE_PROTO)) return object[IE_PROTO];\n  var constructor = object.constructor;\n  if (isCallable(constructor) && object instanceof constructor) {\n    return constructor.prototype;\n  } return object instanceof $Object ? ObjectPrototype : null;\n};\n","var global = require('../internals/global');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar defineBuiltInAccessor = require('../internals/define-built-in-accessor');\nvar regExpFlags = require('../internals/regexp-flags');\nvar fails = require('../internals/fails');\n\n// babel-minify and Closure Compiler transpiles RegExp('.', 'd') -> /./d and it causes SyntaxError\nvar RegExp = global.RegExp;\nvar RegExpPrototype = RegExp.prototype;\n\nvar FORCED = DESCRIPTORS && fails(function () {\n  var INDICES_SUPPORT = true;\n  try {\n    RegExp('.', 'd');\n  } catch (error) {\n    INDICES_SUPPORT = false;\n  }\n\n  var O = {};\n  // modern V8 bug\n  var calls = '';\n  var expected = INDICES_SUPPORT ? 'dgimsy' : 'gimsy';\n\n  var addGetter = function (key, chr) {\n    // eslint-disable-next-line es/no-object-defineproperty -- safe\n    Object.defineProperty(O, key, { get: function () {\n      calls += chr;\n      return true;\n    } });\n  };\n\n  var pairs = {\n    dotAll: 's',\n    global: 'g',\n    ignoreCase: 'i',\n    multiline: 'm',\n    sticky: 'y'\n  };\n\n  if (INDICES_SUPPORT) pairs.hasIndices = 'd';\n\n  for (var key in pairs) addGetter(key, pairs[key]);\n\n  // eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\n  var result = Object.getOwnPropertyDescriptor(RegExpPrototype, 'flags').get.call(O);\n\n  return result !== expected || calls !== expected;\n});\n\n// `RegExp.prototype.flags` getter\n// https://tc39.es/ecma262/#sec-get-regexp.prototype.flags\nif (FORCED) defineBuiltInAccessor(RegExpPrototype, 'flags', {\n  configurable: true,\n  get: regExpFlags\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $findLastIndex = require('../internals/array-iteration-from-last').findLastIndex;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.findLastIndex` method\n// https://github.com/tc39/proposal-array-find-from-last\nexportTypedArrayMethod('findLastIndex', function findLastIndex(predicate /* , thisArg */) {\n  return $findLastIndex(aTypedArray(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n});\n","'use strict';\nvar ArrayBufferViewCore = require('../internals/array-buffer-view-core');\nvar $findLast = require('../internals/array-iteration-from-last').findLast;\n\nvar aTypedArray = ArrayBufferViewCore.aTypedArray;\nvar exportTypedArrayMethod = ArrayBufferViewCore.exportTypedArrayMethod;\n\n// `%TypedArray%.prototype.findLast` method\n// https://github.com/tc39/proposal-array-find-from-last\nexportTypedArrayMethod('findLast', function findLast(predicate /* , thisArg */) {\n  return $findLast(aTypedArray(this), predicate, arguments.length > 1 ? arguments[1] : undefined);\n});\n"],"names":["render","_vm","this","_c","_self","staticClass","getSheetData","_v","staticRenderFns","_e","ref","attrs","on","fileOnChange","XLSX","current_codepage","current_ansi","VALID_ANSI","CS2CP","set_ansi","cp","indexOf","reset_ansi","set_cp","reset_cp","char_codes","data","o","i","len","length","charCodeAt","utf16leread","String","fromCharCode","join","utf16beread","$cptable","debom","c1","c2","slice","_getchar","x","_getansi","DENSE","DIF_XL","Base64_map","Base64_encode","input","c3","e1","e2","e3","e4","isNaN","charAt","Base64_decode","replace","has_buf","Buffer","process","versions","node","Buffer_from","nbfs","from","e","buf","enc","bind","new_raw_buf","alloc","Uint8Array","Array","new_unsafe_buf","allocUnsafe","s2a","s","split","map","s2ab","ArrayBuffer","view","a2s","isArray","c","a2u","Error","ab2a","bconcat","bufs","concat","isBuffer","maxlen","set","apply","call","utf8decode","content","out","widx","L","ridx","d","push","chr0","chr1","_strrev","pad0","v","t","fill","pad_","rpad_","pad0r1","Math","round","pad0r2","p2_32","pow","pad0r","SSF_isgeneral","days","months","SSF_init_table","table_fmt","SSF_default_map","SSF_default_str","SSF_frac","D","mixed","sgn","B","P_2","P_1","P","Q_2","Q_1","Q","A","floor","q","SSF_parse_date_code","opts","b2","date","time","dow","dout","T","u","y","m","H","M","S","abs","date1904","Date","setDate","getDate","getFullYear","getMonth","getDay","SSF_fix_hijri","SSFbasedate","SSFdnthresh","getTime","SSFbase1904","datenum_local","epoch","getTimezoneOffset","SSF_strip_decimal","SSF_normalize_exp","SSF_small_exp","w","toFixed","toPrecision","toExponential","SSF_large_exp","SSF_general_num","V","log","LOG10E","substr","toUpperCase","SSF_general","toString","SSF_format","SSF_write_date","type","fmt","val","ss0","ss","tt","outl","outstr","commaify","j","pct1","write_num_pct","sfmt","mul","write_num","write_num_cm","idx","write_num_exp","match","period","ee","fakee","$$","$1","$2","$3","frac1","write_num_f1","r","aval","sign","den","parseInt","rr","base","myn","myd","write_num_f2","dec1","closeparen","phone","hashq","str","cc","rnd","dd","dec","_frac","carry","flr","write_num_flt","ffmt","ri","ff","oa","min","max","lres","rres","write_num_cm2","write_num_pct2","write_num_exp2","write_num_int","lastIndexOf","SSF_split_fmt","in_str","SSF_abstime","fmt_is_date","eval_fmt","flen","dt","lst","hr","toLowerCase","ssm","bt","jj","nstr","myv","ostr","vv","decpt","lasti","retval","cfregex2","chkcond","thresh","parseFloat","choose_fmt","f","l","lat","m1","m2","dateNF","table","SSF_load","undefined","SSF_load_table","tbl","make_ssf","SSFImplicit","dateNFregex","dateNF_regex","RegExp","dateNF_fix","Y","forEach","n","datestr","timestr","CRC32","signed_crc_table","Int32Array","version","T0","slice_by_16_tables","subarray","TT","T1","T2","T3","T4","T5","T6","T7","T8","T9","Ta","Tb","Tc","Td","Te","Tf","crc32_bstr","bstr","seed","C","crc32_buf","crc32_str","CFB","fs","exports","namecmp","R","Z","dirname","p","filename","write_dos_date","hms","getHours","getMinutes","getSeconds","write_shift","ymd","parse_dos_date","read_shift","setMilliseconds","setFullYear","setMonth","setHours","setMinutes","setSeconds","parse_extra_field","blob","prep_blob","flags","sz","tgt","mtime","atime","ctime","mt","get_fs","parse","file","options","parse_zip","parse_mad","mver","ssz","nmfs","difat_sec_cnt","dir_start","minifat_start","difat_start","fat_addrs","mv","check_get_mver","header","check_shifts","dir_cnt","chk","sectors","sectorify","sleuth_fat","sector_list","make_sector_list","name","ENDOFCHAIN","files","Paths","FileIndex","FullPaths","read_directory","build_full_paths","shift","raw","HEADER_SIGNATURE","nsectors","ceil","FI","FP","pl","dad","get_mfat_entry","entry","payload","mini","start","size","MSSZ","__readInt32LE","new_buf","cnt","sector","get_sector_list","chkd","buf_chain","modulus","addr","nodes","__toBuffer","sl","k","seen","minifat_store","namelen","__utf16le","color","clsid","state","ct","read_date","storage","offset","__readUInt32LE","read_file","readFileSync","read","init_cfb","cfb","root","CLSID","seed_cfb","nm","find","rebuild_cfb","gc","_file","pop","now","fullPaths","Object","create","HEADER_CLSID","sort","elt","_write","_opts","fileType","write_mad","write_zip","mini_size","fat_size","mini_cnt","mfat_cnt","fat_base","fat_cnt","difat_cnt","HEADER_SIG","chainit","consts","DIFSECT","FATSECT","_nm","copy","path","UCFullPaths","UCPaths","UCPath","_zlib","MAXREGSECT","FREESECT","HEADER_MINOR_VERSION","MAXREGSID","NOSTREAM","EntryTypes","write_file","writeFileSync","write","use_zlib","zlib","InflateRaw","InflRaw","_processChunk","_finishFlushFlag","bytesRead","console","error","message","_inflateRawSync","usz","_inflate","_deflateRawSync","deflateRawSync","_deflate","CLEN_ORDER","LEN_LN","DST_LN","bit_swap_8","use_typed_arrays","bitswap8","bit_swap_n","b","rev","read_bits_2","bl","h","read_bits_3","read_bits_4","read_bits_5","read_bits_7","read_bits_n","write_bits_3","write_bits_1","write_bits_8","write_bits_16","realloc","a","zero_fill_array","build_tree","clens","cmap","MAX","ccode","bl_count","Uint16Array","ctree","cleni","fix_lmap","fix_dmap","dlens","_deflateRaw","DST_LN_RE","LEN_LN_RE","write_stored","boff","write_huff_fixed","addrs","hash","mlen","len_eb","dst_eb","off","dyn_lmap","dyn_dmap","dyn_cmap","dyn_len_1","dyn_len_2","dyn","_HLIT","_HDIST","_HCLEN","next_code","hcodes","h1","h2","inflate","outbuf","woff","OL","max_len_1","max_len_2","bits","code","dst","warn_or_throw","wrn","msg","fcnt","start_cd","csz","efsz","fcsz","EF","parse_local_file","meth","crc32","_csz","_usz","ef","cfb_add","unsafe","cdirs","method","compression","desc","fp","fi","crcs","sz_cd","namebuf","ContentTypeMap","get_content_type","ctype","ext","write_base64_76","write_quoted_printable","text","encoded","si","end","tmp","parse_quoted_printable","di","line","oi","parse_mime","fdata","fname","cte","trim","row","test","mboundary","boundary","start_di","ca","cstr","dispcnt","csl","qp","cfb_new","fpath","utils","cfb_gc","cfb_del","splice","cfb_mov","old_name","new_name","writeFile","ReadShift","CheckField","_inflateRaw","_fs","blobify","write_dl","Deno","TextEncoder","encode","utf8write","IE_SaveFile","Blob","navigator","msSaveBlob","saveAs","URL","document","createElement","createObjectURL","url","chrome","downloads","download","revokeObjectURL","setTimeout","href","body","appendChild","click","removeChild","$","File","Folder","open","encoding","close","read_binary","infile","keys","ks","o2","prototype","hasOwnProperty","evert_key","obj","key","K","evert","evert_num","evert_arr","basedate","datenum","dnthresh","refdate","refoffset","numdate","setTime","parse_isodur","sec","good_pd_date_1","good_pd_date","good_pd","parseDate","fixdate","cc2str","arr","debomit","TextDecoder","decode","dup","JSON","stringify","fuzzynum","Number","isFinite","NaN","wt","lower_months","fuzzydate","getYear","lower","split_regex","safe_split_regex","re","def","getdatastr","asNodeBuffer","asBinary","_data","getContent","getdatabin","getdata","safegetzipfile","zip","g","getzipfile","getzipdata","safe","getzipstr","getzipbin","zipentries","zip_add_file","res","zip_new","zip_read","resolve_path","result","target","step","XML_HEADER","attregexg","tagregex1","tagregex2","tagregex","nsregex","nsregex2","parsexmltag","tag","skip_root","skip_LC","z","eq","quot","strip_ns","encodings","rencoding","unescapexml","encregex","coderegex","decregex","charegex","escapexml","escapexmltag","htmlcharegex","escapehtml","escapexlml","xlml_fixstr","entregex","entrepl","xlml_unfixstr","parsexmlbool","value","utf8reada","orig","utf8readb","ww","utf8readc","utf8corpus","utf8read","matchtag","mtcache","htmldecode","entities","vtregex","vt_cache","vtvregex","vtmregex","parseVector","matches","baseType","WTF","wtregex","writetag","wxt_helper","writextag","write_w3cdtf","toISOString","write_vt","xlsx","xlml_normalize","xlmlregex","XMLNS","CORE_PROPS","CUST_PROPS","EXT_PROPS","CT","RELS","TCMNT","XMLNS_main","XLMLNS","read_double_le","Infinity","write_double_le","bs","av","LN2","___toBuffer","___utf16le","__readUInt16LE","___hexlify","__hexlify","___utf8","__readUInt8","__utf8","___lpstr","__lpstr","___cpstr","__cpstr","___lpwstr","__lpwstr","___lpp4","__lpp4","___8lpp4","__8lpp4","___double","__double","is_buf","cpdoit","readUInt32LE","readDoubleLE","__readInt16LE","__readInt32BE","oI","oR","loc","oo","lens","__writeUInt32LE","__writeInt32LE","__writeUInt16LE","WriteShift","cppayload","hexstr","fld","pos","parsenoop","recordhopper","cb","tmpbyte","cntbyte","RT","XLSBRecordEnum","buf_array","blksz","newblk","curbuf","endbuf","next","_bufs","write_record","ba","shift_cell_xls","cell","cRel","rRel","biff","shift_range_xls","range","encode_cell_xls","encode_cell","fix_col","fix_row","encode_range_xls","encode_row","encode_col","decode_row","rowstr","unfix_row","decode_col","colstr","unfix_col","col","split_cell","decode_cell","decode_range","encode_range","cs","ce","safe_decode_range","safe_format_cell","XF","numFmtId","format_cell","BErr","sheet_to_workbook","sheet","sheets","SheetNames","Sheets","sheet_add_aoa","_ws","dense","ws","_R","_C","origin","_origin","_range","__R","__C","nullError","sheetStubs","cellDates","cell_ref","aoa_to_sheet","parse_Int32LE","write_UInt32LE","parse_XLWideString","cchCharacters","write_XLWideString","_null","parse_StrRun","ich","ifnt","write_StrRun","run","parse_RichStr","rgsStrRun","dwSizeStrRun","write_RichStr","parse_BrtCommentText","write_BrtCommentText","parse_XLSBCell","iStyleRef","write_XLSBCell","parse_XLSBShortCell","write_XLSBShortCell","parse_XLSBCodeName","write_XLSBCodeName","parse_XLNullableWideString","write_XLNullableWideString","parse_XLNameWideString","parse_RelID","write_RelID","parse_RkNumber","fX100","fInt","RK","write_RkNumber","d100","parse_RfX","write_RfX","parse_UncheckedRfX","write_UncheckedRfX","parse_Xnum","write_Xnum","parse_BrtColor","xColorType","index","nTS","bR","bG","bB","auto","icv","XLSIcv","rgb","rgb2Hex","theme","tint","write_BrtColor","parse_FontFlags","fBold","fItalic","fUnderline","fStrikeout","fOutline","fShadow","fCondense","fExtend","write_FontFlags","font","grbit","italic","strike","outline","shadow","condense","extend","parse_ClipboardFormatOrString","ClipFmt","parse_ClipboardFormatOrAnsiString","parse_ClipboardFormatOrUnicodeString","VT_I2","VT_I4","VT_BOOL","VT_VARIANT","VT_UI4","VT_FILETIME","VT_BLOB","VT_CF","VT_VECTOR_VARIANT","VT_VECTOR_LPSTR","VT_STRING","VT_USTR","VT_CUSTOM","DocSummaryPIDDSI","SummaryPIDSI","CountryEnum","XLSFillPattern","rgbify","_XLSIcv","RBErr","ct2type","CT_LIST","workbooks","xlsm","xlsb","xlam","xltx","strs","comments","charts","dialogs","macros","metadata","styles","new_ct","rels","threadedcomments","links","coreprops","extprops","custprops","themes","calcchains","vba","drawings","people","TODO","xmlns","parse_ct","ctext","Extension","ContentType","PartName","calcchain","sst","style","defaults","write_ct","type2ct","xsd","xsi","f1","bookType","f2","f3","WB","SHEET","HLINK","VML","XPATH","XMISS","XLINK","CXML","CXMLP","CMNT","SST","STY","THEME","CHART","CHARTEX","CS","WS","DS","MS","IMG","DRAW","XLMETA","PEOPLE","VBA","get_rels_path","parse_rels","currentFilePath","rel","Type","Target","Id","TargetMode","canonictarget","write_rels","rid","add_rels","rId","relobj","targetmode","CT_ODS","parse_manifest","Rn","FEtag","exec","write_manifest","manifest","write_rdf_type","write_rdf_has","write_rdf","rdf","write_meta_ods","CORE_PROPS_REGEX","parse_core_props","cur","cp_doit","write_core_props","dc","dcterms","dcmitype","Props","CreatedDate","ModifiedDate","PseudoPropsPairs","load_props_pairs","HP","TOP","props","hp","parts","Worksheets","NamedRanges","DefinedNames","Chartsheets","ChartNames","parse_ext_props","xml","HeadingPairs","TitlesOfParts","write_ext_props","W","Application","vt","custregex","parse_cust_props","toks","warn","write_cust_props","pid","evert_XLMLDPM","XLMLDocPropsMap","Title","Subject","Author","Keywords","Comments","LastAuthor","RevNumber","LastPrinted","Category","Manager","Company","AppVersion","ContentStatus","Identifier","Language","xlml_set_prop","xlml_write_docprops","xlml_write_custprops","Custprops","BLACKLIST","parse_FILETIME","dwLowDateTime","dwHighDateTime","write_FILETIME","parse_lpstr","pad","parse_lpwstr","parse_VtStringBase","stringType","parse_VtString","parse_VtUnalignedString","parse_VtVecLpwstrValue","ret","parse_VtVecUnalignedLpstrValue","parse_VtHeadingPair","headingString","parse_TypedPropertyValue","headerParts","parse_VtVecHeadingPairValue","cElements","parse_dictionary","CodePage","dict","parse_BLOB","bytes","parse_ClipboardData","Size","write_TypedPropertyValue","parse_PropertySet","PIDSI","start_addr","NumProps","Dictionary","DictObj","PropID","Offset","PropH","fail","piddsi","oldpos","parsebool","XLSPSSkip","guess_property_type","write_PropertySet","entries","RE","hdr","piao","prop","pr","pio","unshift","pinfo","parse_PropertySetStream","NumSets","FMTID0","FMTID1","Offset0","Offset1","SystemIdentifier","PSet1","PSet0","rval","FMTID","write_PropertySetStream","entries2","clsid2","ps0","ps1","parsenoop2","writezeroes","parslurp","writebool","parseuint16","writeuint16","parseuint16a","parse_Bes","write_Bes","parse_ShortXLUnicodeString","cch","fHighByte","parse_XLUnicodeRichExtendedString","cbExtRst","fExtSt","fRichSt","width","cRun","write_XLUnicodeRichExtendedString","xlstr","nfmts","otext","parse_XLUnicodeStringNoCch","parse_XLUnicodeString","parse_XLUnicodeString2","write_XLUnicodeString","parse_ControlInfo","accel","parse_URLMoniker","extra","parse_FileMoniker","cAnti","preamble","ansiPath","unicodePath","parse_HyperlinkMoniker","parse_HyperlinkString","write_HyperlinkString","parse_Hyperlink","sVer","displayName","targetFrameName","moniker","oleMoniker","guid","fileTime","Loc","Tooltip","write_Hyperlink","hl","hashidx","F","Pretarget","parse_LongRGBA","parse_LongRGB","parse_XLSCell","rw","ixfe","write_XLSCell","parse_frtHeader","rt","parse_OptXLUnicodeString","parse_XTI","iSupBook","itabFirst","itabLast","parse_RkRec","parse_AddinUdf","udfName","parse_Ref8U","rwFirst","rwLast","colFirst","colLast","write_Ref8U","parse_RefU","parse_Ref","parse_FtCmo","ot","id","parse_FtNts","fSharedNote","parse_FtCf","cf","parse_FtSkip","FtTab","parse_FtArray","fts","ft","parse_BOF","BIFFVer","write_BOF","wb","parse_InterfaceHdr","parse_WriteAccess","UserName","write_WriteAccess","b8","parse_WsBool","fDialog","fBelow","fRight","parse_BoundSheet8","hidden","hs","write_BoundSheet8","parse_SST","ucnt","Count","Unique","write_SST","parse_ExtSST","extsst","dsst","parse_Row","miyRw","level","hpt","parse_ForceFullCalculation","fullcalc","parse_RecalcId","parse_DefaultRowHeight","fl","Unsynced","DyZero","ExAsc","ExDsc","parse_Window1","xWn","yWn","dxWn","dyWn","iTabCur","iTabFirst","ctabSel","wTabRatio","Pos","Dim","Flags","CurTab","FirstTab","Selected","TabRatio","write_Window1","parse_Window2","RTL","write_Window2","parse_Pane","parse_Font","dyHeight","write_Font","b5","parse_LabelSst","isst","write_LabelSst","os","parse_Label","biffguess","write_Label","parse_Format","fmtstr","write_Format","parse_BIFF2Format","parse_Dimensions","write_Dimensions","parse_RK","rkrec","rknum","parse_MulRk","rkrecs","lastcol","parse_MulBlank","ixfes","parse_CellStyleXF","patternType","cellStyles","alc","fWrap","alcV","fJustLast","trot","cIndent","fShrinkToFit","iReadOrder","fAtrNum","fAtrFnt","fAtrAlc","fAtrBdr","fAtrPat","fAtrProt","dgLeft","dgRight","dgTop","dgBottom","icvLeft","icvRight","grbitDiag","icvTop","icvBottom","icvDiag","dgDiag","icvFore","icvBack","fsxButton","parse_XF","fStyle","write_XF","ixfeP","parse_Guts","write_Guts","guts","parse_BoolErr","write_BoolErr","parse_Number","xnum","write_Number","parse_XLHeaderFooter","parse_SupBook","ctab","sbcch","virtPath","rgst","parse_ExternName","fBuiltIn","fWantAdvise","fWantPict","fOle","fOleLink","fIcon","Name","XLSLblBuiltIn","parse_Lbl","chKey","cce","itab","npflen","rgce","parse_NameParsedFormula","parse_ExternSheet","parse_BIFF5ExternSheet","parse_NameCmt","cchName","cchComment","comment","parse_ShrFmla","cUse","parse_SharedParsedFormula","parse_Array","parse_ArrayParsedFormula","parse_MTRSettings","fMTREnabled","fUserSetThreadCount","cUserThreadCount","parse_NoteSh","idObj","stAuthor","parse_Note","parse_MergeCells","merges","cmcs","write_MergeCells","parse_Obj","parse_BIFF5Obj","cmo","parse_BIFF5OT","parse_TxO","texts","lastobj","cchText","parse_HLink","hlink","write_HLink","O","parse_HLinkTooltip","wzTooltip","write_HLinkTooltip","parse_Country","write_Country","parse_ClrtClient","ccv","parse_Palette","parse_XFCRC","cxfs","crc","parse_ColInfo","coldx","write_ColInfo","parse_Setup","footer","parse_ShtProps","area","write_RRTabId","parse_Blank","parse_Scl","parse_String","parse_ImData","env","lcb","parse_BIFF2STR","parse_BIFF2NUM","num","write_BIFF2NUM","write_BIFF2Cell","parse_BIFF2INT","write_BIFF2INT","parse_BIFF2STRING","parse_BIFF2FONTXTRA","parse_RString","DBF_SUPPORTED_VERSIONS","DBF","dbf_codepage_map","dbf_reverse_map","dbf_to_aoa","memo","vfp","l7","nrow","fpos","rlen","current_cp","codepage","fields","field","hend","sheetRows","dbf_to_sheet","wch","dbf_to_workbook","_RLEN","sheet_to_dbf","aoa","sheet_to_json","headers","cols","hcnt","coltypes","colwidths","coldecimals","guess","_guess","hf","_f","hb","rout","_n","_s","to_workbook","to_sheet","from_sheet","SYLK","sylk_escapes","AA","BA","CA","DA","HA","JA","AE","BE","CE","HE","AI","BI","CI","HI","AO","BO","CO","DO","HO","AU","BU","CU","HU","Aa","Ba","Ca","Da","Ha","Ja","Ae","Be","Ce","He","Ai","Bi","Ci","Hi","Ao","Bo","Co","Do","Ho","Au","Bu","Cu","Hu","KC","Kc","DN","Dn","Hy","sylk_char_regex","sylk_char_fn","_","decode_sylk_char","newcc","sylk_to_aoa","sylk_to_aoa_str","records","rj","formats","next_cell_format","sht","rowinfo","colinfo","cw","Mval","rstr","record","C_seen_K","C_seen_X","C_seen_S","C_seen_E","formula","rc_to_a1","shrbase","shift_formula_str","F_seen","process_col","hpx","pt2px","sylk_to_sheet","aoasht","sylk_to_workbook","write_ws_cell_sylk","a1_to_rc","write_ws_cols_sylk","rec","wpx","width2px","px2char","write_ws_rows_sylk","rows","px2pt","sheet_to_sylk","RS","coord","DIF","dif_to_aoa","dif_to_aoa_str","dif_to_sheet","dif_to_workbook","sheet_to_dif","push_field","topic","push_value","ETH","eth_to_aoa","eth_to_sheet","eth_to_workbook","sep","meta","sheet_to_eth_data","sheet_to_eth","PRN","set_text_arr","prn_to_aoa_str","lines","guess_seps","guess_sep_weights","guess_sep","instr","dsv_to_sheet_str","FS","sepcc","startcc","_re","finish_cell","fuzzyfmla","cellText","cellNF","outer","prn_to_sheet_str","prn_to_sheet","firstbyte","prn_to_workbook","sheet_to_prn","read_wb_ID","OLD_WTF","WK_","lotushopper","Enum","WK1Enum","lotus_to_workbook","lotus_to_workbook_buf","next_n","sidx","snames","realnames","refguess","vers","qpro","tmpcell","WK3Enum","osheets","rnames","sheet_to_wk1","write_biff_rec","write_BOF_WK1","write_RANGE","max_R","write_INTEGER","write_NUMBER","write_LABEL","book_to_wk3","write_BOF_WK3","write_XFORMAT_SHEETNAME","wsidx","write_NUMBER_17","write_LABEL_16","wscnt","parse_RANGE","parse_cell","parse_LABEL","parse_INTEGER","parse_NUMBER","parse_FORMULA","wk1_fmla_to_csf","wk1_parse_rc","FuncTab","BinOpTab","argc","argL","argR","args","parse_cell_3","parse_LABEL_16","parse_NUMBER_18","parse_NUMBER_17","v1","v2","log2","parse_FORMULA_19","parse_NUMBER_25","parse_NUMBER_27","parse_FORMULA_28","parse_SHEETNAMECS","parse_SHEETNAMELP","parse_SHEETINFOQP","parse_XFORMAT","parse_rpr","rpr","pass","uval","family","valign","parse_rs","tregex","rpregex","parse_r","rregex","rend","rs","filter","rs_to_html","nlregex","parse_rpr2","intro","outro","align","r_to_html","terms","sitregex","sirregex","sirphregex","parse_si","html","cellHTML","sstr0","sstr1","sstr2","parse_sst_xml","count","uniqueCount","straywsregex","write_sst_xml","bookSST","sitag","parse_BrtBeginSst","parse_sst_bin","write_BrtBeginSst","write_BrtSSTItem","write_sst_bin","_JS2ANSI","parse_CRYPTOVersion","Major","Minor","parse_DataSpaceVersionInfo","U","parse_DataSpaceMapEntry","comps","parse_DataSpaceMap","parse_DataSpaceDefinition","parse_TransformInfoHeader","parse_Primary","ename","cmode","parse_EncryptionHeader","AlgID","valid","AlgIDHash","KeySize","ProviderType","CSPName","parse_EncryptionVerifier","Salt","Verifier","VerifierHash","parse_EncryptionInfo","parse_EncInfoStd","parse_EncInfoExt","parse_EncInfoAgl","verifier","KeyData","encryptedHmacKey","encryptedHmacValue","encs","uri","parse_RC4CryptoHeader","EncryptionVersionInfo","EncryptionHeader","EncryptionVerifier","parse_RC4Header","EncryptedVerifier","EncryptedVerifierHash","crypto_CreatePasswordVerifier_Method1","Password","PasswordArray","PasswordByte","Intermediate1","Intermediate2","Intermediate3","PasswordDecoded","crypto_CreateXorArray_Method1","PadArray","InitialCode","XorMatrix","Ror","Byte","XorRor","byte1","byte2","CreateXorKey_Method1","XorKey","CurrentElement","Char","password","Temp","PasswordLastChar","PadIndex","Index","ObfuscationArray","crypto_DecryptData_Method1","Data","XorArrayIndex","XorArray","Value","crypto_MakeXorDecryptor","parse_XORObfuscation","verificationBytes","insitu","parse_FilePassHeader","Info","parse_FilePass","RTF","rtf_to_sheet","rtf_to_sheet_str","rowtf","rtfre","last_index","lastIndex","rtf_to_workbook","sheet_to_rtf","hex2RGB","rgb2HSL","G","H6","L2","hsl2RGB","hsl","X","h6","rgb_tint","hex","DEF_MDW","MAX_MDW","MIN_MDW","MDW","px","char2width","chr","cycle_width","collw","find_mdw_colw","delta","_MDW","coll","customWidth","DEF_PPI","PPI","pt","XLMLPatternTypeMap","parse_borders","Borders","border","diagonalUp","diagonalDown","parse_fills","Fills","bgColor","indexed","fgColor","parse_fonts","Fonts","bold","underline","vertAlign","scheme","themeElements","clrScheme","parse_numFmts","NumberFmt","formatCode","write_numFmts","NF","cellXF_uint","cellXF_bool","parse_cellXfs","xf","CellXf","alignment","vertical","horizontal","textRotation","indent","wrapText","write_cellXfs","cellXfs","parse_sty_xml","numFmtRegex","cellXfRegex","fillsRegex","fontsRegex","bordersRegex","write_sty_xml","SSF","parse_BrtFmt","stFmtCode","write_BrtFmt","parse_BrtFont","bls","bCharSet","charset","write_BrtFont","sss","rev_XLSBFillPTNames","XLSBFillPTNames","parse_BrtFill","write_BrtFill","fls","parse_BrtXF","ixfeParent","ifmt","write_BrtXF","flow","write_Blxf","parse_BrtBorder","write_BrtBorder","write_BrtStyle","xfId","builtinId","write_BrtBeginTableStyles","defTableStyle","defPivotStyle","parse_sty_bin","write_FMTS_bin","write_FONTS_bin","write_FILLS_bin","write_BORDERS_bin","write_CELLSTYLEXFS_bin","fontId","fillId","borderId","write_CELLXFS_bin","write_STYLES_bin","write_DXFS_bin","write_TABLESTYLES_bin","write_COLORPALETTE_bin","write_sty_bin","XLSXThemeClrScheme","parse_clrScheme","lastClr","parse_fontScheme","parse_fmtScheme","clrsregex","fntsregex","fmtsregex","parse_themeElements","themeltregex","parse_theme_xml","write_theme","Themes","themeXLSX","parse_Theme","dwThemeVersion","themeXML","parse_ColorTheme","parse_FullColorExt","xclrType","nTintShade","xclrValue","parse_IcvXF","parse_XFExtGradient","parse_ExtProp","extType","parse_XFExt","cexts","update_xfext","xfext","xfe","parse_BrtMdtinfo","write_BrtMdtinfo","parse_BrtMdb","write_BrtMdb","mdb","write_BrtBeginEsfmd","parse_BrtBeginEsmdb","write_BrtBeginEsmdb","cm","parse_xlmeta_bin","Types","Cell","metatype","write_xlmeta_bin","parse_xlmeta_xml","lastmeta","offsets","write_xlmeta_xml","parse_cc_xml","parse_BrtCalcChainItem$","parse_cc_bin","parse_xlink_xml","parse_xlink_bin","parse_drawing","_shapeid","write_comments_vml","csize","bbox","joinstyle","gradientshapeok","coordsize","fillopts","angle","fillparm","fillxml","shadata","fillcolor","strokecolor","sheet_insert_comments","threaded","author","parse_comments_xml","authors","commentList","authtag","cmnttag","authorId","textMatch","write_comments_xml","iauthor","ID","lastauthor","ts","parse_tcmnt_xml","tidx","personId","write_tcmnt_xml","carr","rootid","tcopts","tcid","parentId","parse_people_xml","displayname","write_people_xml","person","userId","providerId","parse_BrtBeginComment","rfx","write_BrtBeginComment","parse_BrtCommentAuthor","write_BrtCommentAuthor","parse_comments_bin","write_comments_bin","CT_VBA","make_vba_xls","newcfb","newpath","fill_vba_xls","VBAFMTS","parse_ds_bin","parse_ds_xml","parse_ms_bin","parse_ms_xml","rcregex","rcbase","rcfunc","fstr","crefregex","$0","$4","$5","shift_formula_xlsx","_xlfn","parseread1","parse_ColRelU","parse_RgceArea","parse_RgceArea_BIFF2","parse_RgceAreaRel","parse_RgceLoc","parse_RgceLoc_BIFF2","parse_RgceElfLoc","fQuoted","parse_RgceLocRel","parse_RgceLocRel_BIFF2","cl","rl","parse_PtgArea","parse_PtgArea3d","ixti","parse_PtgAreaErr","parse_PtgAreaErr3d","parse_PtgAreaN","parse_PtgArray","parse_PtgAttrBaxcel","bitSemi","bitBaxcel","parse_PtgAttrChoose","parse_PtgAttrGoto","bitGoto","parse_PtgAttrIf","bitIf","parse_PtgAttrIfError","parse_PtgAttrSemi","parse_PtgAttrSpaceType","parse_PtgAttrSpace","parse_PtgAttrSpaceSemi","parse_PtgRef","parse_PtgRefN","parse_PtgRef3d","parse_PtgFunc","iftab","FtabArgc","Ftab","parse_PtgFuncVar","cparams","tab","parsetab","Cetab","parse_PtgAttrSum","parse_PtgExp","parse_PtgErr","parse_PtgInt","parse_PtgBool","parse_PtgNum","parse_PtgStr","parse_SerAr","parse_PtgExtraMem","parse_PtgExtraArray","parse_PtgName","nameindex","parse_PtgNameX","parse_PtgNameX_BIFF5","parse_PtgMemArea","parse_PtgMemFunc","parse_PtgRefErr","parse_PtgRefErr3d","parse_PtgMemErr","parse_PtgMemNoMem","parse_PtgTbl","parse_PtgElfLoc","parse_PtgElfNoop","parse_PtgElfCol","parse_PtgElfColS","parse_PtgElfColSV","parse_PtgElfColV","parse_PtgElfLel","parse_PtgElfRadical","parse_PtgElfRadicalLel","parse_PtgElfRadicalS","parse_PtgElfRw","parse_PtgElfRwV","PtgListRT","parse_PtgList","coltype","parse_PtgSxName","parse_PtgSheet","parse_PtgEndSheet","parse_PtgMemAreaN","parse_PtgMemNoMemN","parse_PtgAttrNoop","PtgTypes","PtgDupes","Ptg18","Ptg19","parse_RgbExtra","parse_Rgce","ptgs","stringify_array","PtgBinOp","PtgAdd","PtgConcat","PtgDiv","PtgEq","PtgGe","PtgGt","PtgLe","PtgLt","PtgMul","PtgNe","PtgPower","PtgSub","formula_quote_sheet_name","sname","get_ixti_raw","supbooks","XTI","SID","get_ixti","ixtiraw","stringify_formula","stack","nameidx","last_sp","sp","fflen","func","lbl","names","xlfn","externbook","bookidx","ixtidata","lp","rp","sharedf","parsedf","fnd","arrayf","PtgNonDisp","_left","rgcb","parse_XLSCellParsedFormula","parse_FormulaValue","write_FormulaValue","parse_Formula","cbf","shared","write_Formula","o1","o3","bf","parse_XLSBParsedFormula","parse_XLSBArrayParsedFormula","parse_XLSBCellParsedFormula","parse_XLSBNameParsedFormula","parse_XLSBSharedParsedFormula","ods_to_csf_formula","csf_to_ods_formula","ods_to_csf_3D","csf_to_ods_3D","_ssfopts","browser_has_Map","Map","get_sst_id","has","revarr","get","col_obj_w","outlineLevel","default_margins","margins","mode","defs","left","right","top","bottom","get_cell_style","revssf","ssf","applyNumberFormat","safe_format","fmtid","fillid","raw_rgb","check_ws","parse_ws_xml_dim","mergecregex","sheetdataregex","hlinkregex","dimregex","colregex","afregex","marginregex","sheetprregex","sheetprregex2","svsregex","parse_ws_xml","data1","data2","mtch","sheetPr","parse_ws_xml_sheetpr","parse_ws_xml_sheetpr2","svs","parse_ws_xml_sheetviews","columns","parse_ws_xml_cols","parse_ws_xml_data","afilter","parse_ws_xml_autofilter","_merge","parse_ws_xml_hlinks","parse_ws_xml_margins","tmpref","write_ws_xml_merges","codeName","CodeName","write_ws_xml_sheetpr","needed","vbaraw","cname","Workbook","outlineprops","summaryBelow","summaryRight","above","sheetprot_deffalse","sheetprot_deftrue","write_ws_xml_protection","location","Rel","tooltip","rng","margin","write_ws_xml_margins","seencol","coli","colm","colM","write_ws_xml_cols","write_ws_xml_autofilter","Names","Sheet","Ref","sviewregex","Views","zoomScale","zoom","rightToLeft","write_ws_xml_sheetviews","sview","workbookViewId","write_ws_xml_cell","oldt","oldv","Strings","revStrings","cellregex","rowregex","isregex","refregex","match_v","match_f","sdata","sstr","ftag","cells","cref","tagr","tagc","do_format","rowobj","rowrite","marr","marrlen","xlen","rstarti","outa","ht","rslice","cellFormula","___f","_tag","xlmeta","_r","write_ws_xml_data","params","height","_cell","customHeight","write_ws_xml","rdata","_drawing","sheetFormat","defaultRowHeight","baseColWidth","outlineLevelRow","relc","ignoreEC","numberStoredAsText","sqref","parse_BrtRowHdr","write_BrtRowHdr","ncolspan","lcs","caddr","first","last","write_row_header","parse_BrtWsDim","write_BrtWsDim","parse_BrtWsFmtInfo","parse_BrtWsProp","write_BrtWsProp","parse_BrtCellBlank","write_BrtCellBlank","ncell","parse_BrtShortBlank","write_BrtShortBlank","parse_BrtCellBool","fBool","write_BrtCellBool","parse_BrtShortBool","write_BrtShortBool","parse_BrtCellError","bError","write_BrtCellError","parse_BrtShortError","write_BrtShortError","parse_BrtCellIsst","write_BrtCellIsst","parse_BrtShortIsst","write_BrtShortIsst","parse_BrtCellReal","write_BrtCellReal","parse_BrtShortReal","write_BrtShortReal","parse_BrtCellRk","write_BrtCellRk","parse_BrtShortRk","write_BrtShortRk","parse_BrtCellRString","parse_BrtCellSt","write_BrtCellSt","parse_BrtShortSt","write_BrtShortSt","parse_BrtFmlaBool","parse_BrtFmlaError","parse_BrtFmlaNum","parse_BrtFmlaString","parse_BrtMergeCell","write_BrtMergeCell","write_BrtBeginMergeCells","parse_BrtHLink","relId","display","write_BrtHLink","locidx","parse_BrtPane","parse_BrtArrFmla","fAlwaysCalc","parse_BrtShrFmla","write_BrtColInfo","BrtMarginKeys","parse_BrtMargins","write_BrtMargins","parse_BrtBeginWsView","write_BrtBeginWsView","write_BrtCellIgnoreEC","write_BrtSheetProtection","parse_BrtDVal","parse_BrtDVal14","parse_ws_bin","ai","af","vm","RR","aii","_d","write_ws_bin_cell","last_seen","write_CELLTABLE","cap","write_MERGECELLS","write_COLINFOS","write_IGNOREECS","write_HLINKS","write_LEGACYDRAWING","write_AUTOFILTER","write_WSVIEWS2","write_WSFMTINFO","write_SHEETPROTECT","write_ws_bin","parse_Cache","nf","parse_chart","csheet","nc","cache","parse_cs_xml","parse_BrtCsProp","parse_cs_bin","WBPropsDef","WBViewDef","SheetDef","CalcPrDef","push_defaults_array","push_defaults","parse_wb_defaults","WBProps","CalcPr","WBView","safe1904","badchars","check_ws_name","_good","check_wb_names","N","codes","cn","check_wb","wbnsregex","parse_wb_xml","dname","dnstart","Hidden","Comment","localSheetId","write_wb_xml","write_names","workbookPr","sheetId","parse_BrtBundleSh","iTabID","strRelID","write_BrtBundleSh","parse_BrtWbProp","defaultThemeVersion","strName","autoCompressPictures","backupFile","checkCompatibility","filterPrivacy","hidePivotFieldList","promptedSolutions","publishItems","refreshAllConnections","saveExternalLinkValues","showBorderUnselectedTables","showInkAnnotation","showObjects","showPivotChartFilter","updateLinks","write_BrtWbProp","parse_BrtFRTArchID$","ArchID","parse_BrtName","Ptg","parse_wb_bin","write_BUNDLESHS","viz","write_BrtFileVersion","write_BrtBookView","write_BOOKVIEWS","vistab","write_wb_bin","parse_wb","parse_ws","parse_cs","parse_ms","parse_ds","parse_sty","parse_theme","parse_sst","parse_cmnt","parse_cc","parse_xlink","parse_xlmeta","write_wb","write_ws","write_sty","write_sst","write_cmnt","write_xlmeta","XLMLFormatMap","attregexg2","attregex2","xlml_parsexmltag","words","xlml_parsexmltagobj","xlml_format","format","xlml_set_custprop","oval","safe_format_xlml","process_style_xlml","stag","Interior","I","Pattern","parse_xlml_data","csty","sid","StyleID","interiors","Parent","UTC","Formula","ArrayRange","xlml_clean_comment","parse_xlml_xml","opening","ishtml","_o","html_to_workbook","sheetnames","cursheet","sheetname","dtag","didx","fidx","pidx","cstys","wsprops","raw_Rn3","HRef","HRefScreenTip","MergeAcross","MergeDown","cma","cmd","AutoFitHeight","Height","Format","ssfidx","Width","_col","Span","_NamedRange","_DefinedName","RefersTo","AutoFilter","Range","parse_fods","Margin","pagemargins","Top","Left","Right","Bottom","bookSheets","bookProps","parse_xlml","fix_read_opts","write_props_xlml","write_wb_xlml","write_sty_xlml","write_name_xlml","write_names_xlml","write_ws_xlml_names","write_ws_xlml_wsopts","objects","scenarios","selectLockedCells","selectUnlockedCells","write_ws_xlml_comment","write_ws_xlml_cell","attr","mi","write_ws_xlml_row","write_ws_xlml_table","skip","write_ws_xlml","write_xlml","parse_compobj","AnsiUserType","AnsiClipboardFormat","Reserved1","UnicodeClipboardFormat","Reserved2","CONTINUE_RT","slurp","RecordType","nextrt","XLSRecordEnum","ll","safe_format_xf","make_cell","parse_workbook","lastcell","cmnt","rngC","rngR","temp_val","country","Directory","last_formula","cur_sheet","Preamble","last_cell","XFs","palette","get_rgb","process_cell_style","xfd","addcell","file_depth","afi","rrtabid","lastuser","winlocked","wtf","last_lbl","last_RT","BIFF2Fmt","BIFF2FmtTable","FilterDatabases","seen_codepage","Date1904","WriteProtect","cpval","CalcRefMode","FullCalc","ExternCount","tmpri","fakebs8","_fr","_fc","_fe","_arraystart","_j","_ixfe","b4idx","b2idx","TxO","ImData","noteobj","Encryption","Metadata","Country","PSCLSID","SI","DSI","UDI","parse_xls_props","DocSummary","Summary","write_xls_props","Keys","DSEntries","SEntries","CEntries","DocSummaryRE","SummaryRE","CEntries2","parse_xlscfb","CompObj","WorkbookP","bookVBA","bookFiles","write_xlscfb","wbpath","write_biff_buf","write_biff_continue","write_BIFF2BERR","write_BIFF2LABEL","write_ws_biff2_cell","write_ws_biff2","write_biff2_buf","write_FONTS_biff8","write_FMTS_biff8","write_FEAT","write_CELLXFS_biff8","write_ws_biff8_hlinks","HL","write_ws_cols_biff8","write_ws_biff8_cell","write_ws_biff8","_WB","_sheet","MAX_ROWS","write_biff8_global","_sheets","_wb","blen","write_biff8_buf","fix_write_opts","html_to_sheet","mtch2","hd","midx","colspan","rowspan","_t","make_html_row","editable","HTML_BEGIN","HTML_END","book_new","book_append_sheet","make_html_preamble","sheet_to_html","sheet_add_dom","or_R","or_C","getElementsByTagName","is_dom_element_hidden","elts","children","hasAttribute","getAttribute","innerHTML","Aelts","Aelti","parse_dom_table","table_to_book","element","get_computed_style","get_get_computed_style_function","getPropertyValue","ownerDocument","defaultView","getComputedStyle","parse_text_p","fixed","number_formats_ods","day","month","year","hours","minutes","seconds","era","quarter","parse_content_xml","sheetag","rowtag","textptag","NFtag","ctag","textp","textpidx","textR","row_ol","number_format_map","mrange","mR","mC","rowpeat","colpeat","atag","_Ref","creator","creatoridx","isstub","intable","rptR","rpt","nrange","ptp","parse_ods","write_styles_ods","master_styles","write_content_ods","write_text_p","null_cell_xml","covered_cell_xml","ods","ROWS","_Fref","text_p","_tgt","write_automatic_styles_ods","cidx","colobj","fods","write_ods","u8_to_dataview","array","DataView","buffer","byteOffset","byteLength","u8str","u8","stru8","u8contains","search","u8concat","u8a","reduce","acc","popcnt","readDecimal128LE","exp","mantissa","writeDecimal128LE","parse_varint49","ptr","varint","write_varint49","varint_to_i32","i32","parse_shallow","write_shallow","proto","item","mappa","parse_iwa_file","_a","messages","merge","write_iwa_file","ias","ia","midata","aipayload","mid","parse_snappy_chunk","chunks","decompress_iwa_file","compress_iwa_file","frame","parse_old_storage","rsst","dv","getUint32","data_offset","ieee","getFloat64","parse_new_storage","d128","write_new_storage","setFloat64","setUint32","write_old_storage","parse_cell_storage","parse_TSP_Reference","pb","parse_TST_TableDataList","le","rtp","rtpref","mtype","tswpsa","parse_TST_TileRowInfo","_b","_g","_h","_i","_k","_l","_m","used_storage_u8","used_storage","wide_offsets","used_storage_offsets","getUint16","parse_TST_Tile","nrows","parse_TST_TableModelArchive","store","tile","tl","_tile","parse_TST_TableInfoArchive","tableref","parse_TN_SheetArchive","shapeoffs","parse_TN_DocumentArchive","sheetoffs","root2","parse_numbers_iwa","indices","packets","packet","docroot","iwam","write_tile_row","tri","last_offset","cell_storage","_dv","_last_offset","_cell_storage","celload","_celload","setUint16","write_numbers_iwa","numbers","trunc","dependents","old_content","raw1","x2","packet2","deps","y2","indices_varint","ivi","some","mess","xi","sheetrootref","cruidsref","oldbucket","_x","cruids","uuid","row_headers","row_header_ref","base_bucket","_bucket","col_header_ref","sstref","sstroot","sentry","sx","sxi","sstdata","newsst","sy","raw32","tileref","tileroot","tentry","tx","tiledata","rowload","R2","tilerow","ty","raw3","fix_opts_func","get_sheet_type","safe_parse_wbrels","wbrels","safe_parse_sheet","relsPath","sheetRels","stype","dfile","drelsp","draw","chartp","crelsp","tcomments","strip_front_slash","_zip","binname","dir","link","propdata","bookDeps","wbsheets","wbext","wbrelsi","wbrelsfile","nmode","wsloop","snjseen","snj","Deps","Styles","bin","parse_xlsxcfb","dsm","seds","einfo","decrypt_agile","decrypt_std76","write_zip_xlsxb","write_zip_xlsx","foo","vbafmt","_sn","wsrels","_type","need_vml","rId1","needtc","read_cfb","read_zip","read_plaintext","main","read_plaintext_raw","read_utf16","bstrify","read_prn","readSync","ab","vu","write_cfb_ctr","write_zip_type","write_zip_denouement","oopts","ftype","generate","encrypt_agile","write_cfb_type","write_string_type","bom","write_stxt_type","write_binary_type","writeSync","sheet_to_txt","sheet_to_csv","resolve_book_type","_BT","make_json_row","defval","isempty","defineProperty","enumerable","__rowNum__","rawNumbers","outi","counter","header_cnt","skipHidden","blankrows","qreg","make_csv_row","txt","forceQuotes","endregex","strip","sheet_to_formulae","cmds","sheet_add_json","js","skipHeader","JS","ws_get_cell_stub","json_to_sheet","RC","wb_sheet_idx","sh","roll","book_set_sheet_visibility","vis","cell_set_number_format","cell_set_hyperlink","cell_set_internal_link","cell_add_comment","sheet_set_array_formula","dynamic","rngstr","table_to_sheet","sheet_to_row_object_array","sheet_get_cell","SHEET_VISIBLE","SHEET_HIDDEN","SHEET_VERY_HIDDEN","fileReader","created","computed","methods","setSheetData","changeErrorMsg","handleFileLoad","title","description","component","checkCommodities","calculateResult","require","resultData","getSingleCalculatedIngredient","itemName","itemValue","required","components","ResultDataElem","fileName","fileExtension","getCalculationElements","getCalculatedIngredients","resetStore","domProps","getChartSwitcher","toggleChartSwitcher","quantityCalculationElements","remove","calculationItem","getFormulaItemsName","ingredient","getIngredients","class","disable","disableDecrement","$event","changeCount","directives","rawName","expression","modifiers","handleChange","_defineProperty","configurable","writable","noop","uid","isNullOrUndef","isObject","isNumberFinite","finiteOrDefault","defaultValue","valueOrDefault","toPercentage","dimension","endsWith","toDimension","callback","fn","thisArg","each","loopable","reverse","_elementsEqual","a0","a1","ilen","v0","datasetIndex","clone","source","klen","isValidKey","_merger","tval","sval","sources","merger","current","mergeIf","_mergerIf","keyResolvers","_splitKey","part","_getKeyResolver","resolveObjectKey","resolver","_capitalize","defined","isFunction","setsEqual","_isClickEvent","PI","TAU","PITAU","INFINITY","POSITIVE_INFINITY","RAD_PER_DEG","HALF_PI","QUARTER_PI","TWO_THIRDS_PI","log10","almostEquals","epsilon","niceNum","roundedRange","niceRange","fraction","niceFraction","_factorize","sqrt","isNumber","almostWhole","rounded","_setMinAndMaxByKey","property","toRadians","degrees","toDegrees","radians","_decimalPlaces","isFiniteNumber","getAngleFromPoint","centrePoint","anglePoint","distanceFromXCenter","distanceFromYCenter","radialDistanceFromCenter","atan2","distance","distanceBetweenPoints","pt1","pt2","_angleDiff","_normalizeAngle","_angleBetween","sameAngleIsFullCircle","angleToStart","angleToEnd","startToAngle","endToAngle","_limitValue","_int16Range","_isBetween","_lookup","cmp","hi","lo","_lookupByKey","ti","_rlookupByKey","_filterBetween","values","arrayEvents","listenArrayEvents","listener","_chartjs","listeners","object","unlistenArrayEvents","stub","_arrayUnique","items","Set","add","requestAnimFrame","window","requestAnimationFrame","throttled","ticking","debounce","delay","timeout","clearTimeout","_toLeftRightCenter","_alignStartEnd","_textX","rtl","check","_getStartAndCountOfVisiblePoints","points","animationsDisabled","pointCount","_sorted","iScale","_parsed","axis","minDefined","maxDefined","getUserBounds","getPixelForValue","_scaleRangesChanged","xScale","yScale","_scaleRanges","newRanges","xmin","xmax","ymin","ymax","changed","assign","atEdge","elasticIn","sin","elasticOut","effects","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","cos","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeInElastic","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInBounce","easeOutBounce","easeInOutBounce","lim","p2b","n2b","b2n","n2p","map$1","E","isShort","hexParse","alpha","hexString","HUE_RE","hsl2rgbn","hsv2rgbn","hwb2rgbn","hueValue","rgb2hsl","calln","hsl2rgb","hwb2rgb","hsv2rgb","hue","hueParse","p1","p2","rotate","deg","hslString","J","names$1","OiceXe","antiquewEte","aqua","aquamarRe","azuY","beige","bisque","black","blanKedOmond","Xe","XeviTet","bPwn","burlywood","caMtXe","KartYuse","KocTate","cSO","cSnflowerXe","cSnsilk","crimson","cyan","xXe","xcyan","xgTMnPd","xWay","xgYF","xgYy","xkhaki","xmagFta","xTivegYF","xSange","xScEd","xYd","xsOmon","xsHgYF","xUXe","xUWay","xUgYy","xQe","xviTet","dAppRk","dApskyXe","dimWay","dimgYy","dodgerXe","fiYbrick","flSOwEte","foYstWAn","fuKsia","gaRsbSo","ghostwEte","gTd","gTMnPd","Way","gYF","gYFLw","gYy","honeyMw","hotpRk","RdianYd","Rdigo","ivSy","khaki","lavFMr","lavFMrXsh","lawngYF","NmoncEffon","ZXe","ZcSO","Zcyan","ZgTMnPdLw","ZWay","ZgYF","ZgYy","ZpRk","ZsOmon","ZsHgYF","ZskyXe","ZUWay","ZUgYy","ZstAlXe","ZLw","lime","limegYF","lRF","magFta","maPon","VaquamarRe","VXe","VScEd","VpurpN","VsHgYF","VUXe","VsprRggYF","VQe","VviTetYd","midnightXe","mRtcYam","mistyPse","moccasR","navajowEte","navy","Tdlace","Tive","TivedBb","Sange","SangeYd","ScEd","pOegTMnPd","pOegYF","pOeQe","pOeviTetYd","papayawEp","pHKpuff","peru","pRk","plum","powMrXe","purpN","YbeccapurpN","Yd","Psybrown","PyOXe","saddNbPwn","sOmon","sandybPwn","sHgYF","sHshell","siFna","silver","skyXe","UXe","UWay","UgYy","snow","sprRggYF","stAlXe","tan","teO","tEstN","tomato","Qe","viTet","JHt","wEte","wEtesmoke","Lw","LwgYF","unpack","unpacked","tkeys","ok","nk","nameParse","transparent","RGB_RE","rgbParse","rgbString","to","interpolate","rgb1","rgb2","modHSL","ratio","fromObject","functionParse","Color","constructor","_rgb","_valid","mix","weight","w2","w1","clearer","greyscale","opaquer","negate","lighten","darken","saturate","desaturate","index_esm","isPatternOrGradient","colorLib","getHoverColor","colors","applyAnimationsDefaults","duration","easing","loop","describe","_fallback","_indexable","_scriptable","properties","active","animation","resize","show","animations","visible","hide","applyLayoutsDefaults","autoPadding","padding","intlCache","getNumberFormat","locale","cacheKey","formatter","Intl","NumberFormat","formatNumber","formatters","numeric","tickValue","ticks","chart","notation","maxTick","calculateDelta","logDelta","numDecimal","minimumFractionDigits","maximumFractionDigits","logarithmic","remain","significand","includes","applyScaleDefaults","beginAtZero","bounds","grace","grid","lineWidth","drawOnChartArea","drawTicks","tickLength","tickWidth","_ctx","tickColor","dash","dashOffset","minRotation","maxRotation","mirror","textStrokeWidth","textStrokeColor","autoSkip","autoSkipPadding","labelOffset","Ticks","minor","major","crossAlign","showLabelBackdrop","backdropColor","backdropPadding","route","startsWith","overrides","descriptors","getScope","scope","Defaults","_descriptors","_appliers","backgroundColor","borderColor","datasets","devicePixelRatio","context","platform","getDevicePixelRatio","elements","events","lineHeight","hover","hoverBackgroundColor","ctx","hoverBorderColor","hoverColor","indexAxis","interaction","intersect","includeInvisible","maintainAspectRatio","onHover","onClick","parsing","plugins","responsive","scale","scales","showLine","drawActiveElementsOnTop","override","targetScope","targetName","scopeObject","targetScopeObject","privateName","defineProperties","local","appliers","toFontString","_measureText","longest","string","textWidth","measureText","_longestText","arrayOfThings","garbageCollect","save","jlen","thing","nestedThing","restore","gcLen","_alignPixel","pixel","currentDevicePixelRatio","halfWidth","clearCanvas","canvas","getContext","resetTransform","clearRect","drawPoint","drawPointLegend","xOffset","yOffset","cornerRadius","xOffsetW","yOffsetW","pointStyle","rotation","radius","rad","translate","drawImage","beginPath","ellipse","arc","closePath","moveTo","lineTo","SQRT1_2","rect","borderWidth","stroke","_isPointInArea","point","clipArea","clip","unclipArea","_steppedLineTo","previous","flip","midpoint","_bezierCurveTo","bezierCurveTo","cp1x","cp2x","cp1y","cp2y","renderText","strokeWidth","strokeColor","setRenderOpts","backdrop","drawBackdrop","strokeStyle","strokeText","maxWidth","fillText","decorateText","translation","fillStyle","textAlign","textBaseline","strikethrough","metrics","actualBoundingBoxLeft","actualBoundingBoxRight","actualBoundingBoxAscent","actualBoundingBoxDescent","yDecoration","decorationWidth","oldColor","fillRect","addRoundedRectPath","topLeft","bottomLeft","bottomRight","topRight","LINE_HEIGHT","FONT_STYLE","toLineHeight","numberOrZero","_readValueToProps","objProps","toTRBL","toTRBLCorners","toPadding","toFont","fallback","resolve","inputs","info","cacheable","_addGrace","minmax","change","keepZero","createContext","parentContext","_createResolver","scopes","prefixes","rootScopes","getTarget","_resolve","Symbol","toStringTag","_cacheable","_scopes","_rootScopes","_getTarget","Proxy","deleteProperty","_keys","_cached","_resolveWithPrefixes","getOwnPropertyDescriptor","Reflect","getPrototypeOf","getKeysFromAllScopes","ownKeys","_storage","_attachContext","proxy","subProxy","descriptorDefaults","_proxy","_context","_subProxy","_stack","setContext","receiver","_resolveWithContext","allKeys","scriptable","indexable","_allKeys","isScriptable","isIndexable","readKey","prefix","needsSubResolver","_resolveScriptable","_resolveArray","delete","createSubResolver","resolveFallback","parent","addScopes","parentScopes","parentFallback","allScopes","addScopesFromKey","subGetTarget","resolveKeysFromAllScopes","_parseObjectDataRadialScale","_parsing","parsed","EPSILON","getPoint","getValueAxis","splineCurve","firstPoint","middlePoint","afterPoint","d01","d12","s01","s12","fa","fb","monotoneAdjust","deltaK","mK","pointsLen","alphaK","betaK","tauK","squaredMagnitude","pointCurrent","pointAfter","monotoneCompute","valueAxis","pointBefore","iPixel","vPixel","splineCurveMonotone","slopeDelta","capControlPoint","capBezierPoints","inArea","inAreaPrev","inAreaNext","_updateBezierControlPoints","controlPoints","spanGaps","cubicInterpolationMode","prev","tension","_isDomSupported","_getParentNode","domNode","parentNode","host","parseMaxStyle","styleValue","parentProperty","valueInPixels","getStyle","el","positions","getPositionedStyle","suffix","useOffsetPos","shadowRoot","getCanvasPosition","touches","offsetX","offsetY","box","getBoundingClientRect","clientX","clientY","getRelativePosition","event","borderBox","boxSizing","paddings","borders","getContainerSize","maxHeight","container","containerStyle","containerBorder","containerPadding","clientWidth","clientHeight","round1","getMaximumSize","bbWidth","bbHeight","aspectRatio","containerSize","maintainHeight","retinaScale","forceRatio","forceStyle","pixelRatio","deviceHeight","deviceWidth","setTransform","supportsEventListenerOptions","passiveSupported","passive","addEventListener","removeEventListener","readUsedSize","_pointInLine","_steppedInterpolation","_bezierInterpolation","cp1","cp2","getRightToLeftAdapter","rectX","setWidth","xPlus","leftForLtr","itemWidth","getLeftToRightAdapter","_itemWidth","getRtlAdapter","overrideTextDirection","direction","original","getPropertyPriority","setProperty","prevTextDirection","restoreTextDirection","propertyFn","between","compare","normalize","normalizeSegment","getSegment","segment","startBound","endBound","_boundSegment","prevValue","inside","subStart","startIsBefore","endIsBefore","shouldStart","shouldStop","_boundSegments","segments","sub","findStartAndEnd","solidSegments","stop","_computeSegments","segmentOptions","_loop","splitByStyles","completeLoop","_fullLoop","doSplitByStyles","chartContext","_chart","baseStyle","readStyle","_datasetIndex","prevStyle","addStyle","st","p0","p0DataIndex","p1DataIndex","styleChanged","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","Animator","_request","_charts","_running","_lastDate","_notify","anims","callbacks","numSteps","initial","currentStep","_refresh","_update","remaining","running","_active","_total","tick","_getAnims","complete","progress","listen","_duration","cancel","interpolators","boolean","factor","c0","helpersColor","number","Animation","cfg","currentValue","_fn","_easing","_start","_target","_prop","_from","_to","_promises","update","elapsed","wait","promises","Promise","rej","resolved","Animations","config","_properties","configure","animationOptions","animatedProps","getOwnPropertyNames","option","_animateOptions","newOptions","resolveTargetOptions","_createAnimations","$shared","awaitAll","$animations","then","animator","anim","all","scaleClip","allowedOverflow","defaultClip","toClip","disabled","getSortedDatasetIndices","filterVisible","metasets","_getSortedDatasetMetas","applyStack","dsIndex","singleMode","otherValue","convertObjectDataToArray","adata","isStacked","stacked","getStackKey","indexScale","valueScale","NEGATIVE_INFINITY","getOrCreateStack","stacks","stackKey","indexValue","subStack","getLastIndexInStack","vScale","positive","getMatchingVisibleMetas","updateStacks","controller","_cachedMeta","_stacks","iAxis","vAxis","itemStacks","_top","_bottom","getFirstScaleId","createDatasetContext","dataset","createDataContext","dataIndex","clearStacks","isDirectUpdateMode","cloneIfNotShared","cached","createStack","canStack","_stacked","DatasetController","_cachedDataOpts","getMeta","_objectData","_sharedOptions","_drawStart","_drawCount","enableOptionSharing","supportsDecimation","$context","_syncList","datasetElementType","dataElementType","initialize","linkScales","addElements","isPluginEnabled","updateIndex","getDataset","chooseId","xid","xAxisID","yid","yAxisID","rAxisID","iid","iAxisID","vid","vAxisID","getScaleForId","rScale","getDatasetMeta","scaleID","_getOtherScale","reset","_destroy","_dataCheck","isExtensible","buildOrUpdateElements","resetNewElements","stackChanged","oldStacked","_resyncElements","scopeKeys","datasetScopeKeys","getOptionScopes","createResolver","sorted","parseArrayData","parseObjectData","parsePrimitiveData","isNotInOrderComparedToPrev","labels","getLabels","singleScale","xAxisKey","yAxisKey","getParsed","getDataElement","updateRangeFromParsed","parsedValue","getMinMax","otherScale","otherMin","otherMax","_skip","getAllParsedValues","getMaxOverflow","getLabelAndValue","label","getLabelForValue","_clip","chartArea","resolveDatasetElementOptions","resolveDataElementOptions","_resolveElementOptions","elementType","sharing","datasetElementScopeKeys","resolveNamedOptions","freeze","_resolveAnimations","transition","datasetAnimationScopeKeys","getSharedOptions","includeOptions","sharedOptions","_animationsDisabled","_getSharedOptions","firstOpts","previouslySharedOptions","updateSharedOptions","updateElement","_setStyle","removeHoverStyle","setHoverStyle","_removeDatasetHoverStyle","_setDatasetHoverStyle","arg1","arg2","numMeta","numData","_insertElements","_removeElements","move","updateElements","removed","_sync","_dataChanges","_onDataPush","arguments","_onDataPop","_onDataShift","_onDataSplice","newCount","_onDataUnshift","getAllScaleValues","_cache","$bar","visibleMetas","computeMinSampleSize","curr","_length","updateMinAndPrev","getPixelForTick","computeFitCategoryTraits","ruler","stackCount","thickness","barThickness","categoryPercentage","barPercentage","chunk","pixels","computeFlexCategoryTraits","percent","parseFloatBar","startValue","endValue","barStart","barEnd","_custom","parseValue","parseArrayOrPrimitive","isFloatBar","custom","barSign","actualBase","isHorizontal","borderProps","setBorderSkipped","edge","borderSkipped","enableBorderRadius","parseEdge","swap","startEnd","setInflateAmount","inflateAmount","BarController","iAxisKey","vAxisKey","super","bars","getBasePixel","_getRuler","vpixels","head","_calculateBarValuePixels","ipixels","_calculateBarIndexPixels","center","_getStacks","grouped","skipNull","_getStackCount","_getStackIndex","_startPixel","_endPixel","baseValue","minBarLength","floating","getDataVisibility","startPixel","getPixelForDecimal","endPixel","halfGrid","getLineWidthForValue","maxBarThickness","stackIndex","rects","_index_","_value_","BubbleController","getRatioAndOffset","circumference","cutout","ratioX","ratioY","startAngle","endAngle","startX","startY","endX","endY","calcMax","calcMin","maxX","maxY","minX","minY","DoughnutController","innerRadius","outerRadius","getter","_getRotation","_getCircumference","_getRotationExtents","isDatasetVisible","arcs","spacing","getMaxBorderWidth","getMaxOffset","maxSize","chartWeight","_getRingWeight","maxRadius","radiusLength","_getVisibleDatasetWeightTotal","total","calculateTotal","_getRingWeightOffset","_circumference","animateRotate","calculateCircumference","animationOpts","centerX","centerY","animateScale","metaData","borderAlign","hoverBorderWidth","hoverOffset","ringWeightOffset","legend","generateLabels","fontColor","legendItem","toggleDataVisibility","LineController","_dataset","_decimated","animated","maxGapLength","directUpdate","pointsCount","prevParsed","nullData","lastPoint","updateControlPoints","PolarAreaController","_updateRadius","minSize","cutoutPercentage","getVisibleDatasetCount","xCenter","yCenter","datasetStartAngle","getIndexAngle","defaultAngle","countVisibleElements","_computeAngle","getDistanceFromCenterForValue","angleLines","circular","pointLabels","PieController","RadarController","pointPosition","getPointPositionForValue","ScatterController","registry","getElement","abstract","DateAdapterBase","static","members","init","diff","startOf","endOf","_date","binarySearch","metaset","lookupMethod","_reversePixels","getRange","evaluateInteractionItems","position","handler","getSortedVisibleDatasetMetas","getDistanceMetricForAxis","useX","useY","deltaX","deltaY","getIntersectItems","useFinalPosition","isPointInArea","evaluationFunc","inRange","getNearestRadialItems","getProps","getNearestCartesianItems","distanceMetric","minDistance","getCenterPoint","pointInArea","getNearestItems","getAxisItems","rangeMethod","intersectsItem","modes","nearest","STATIC_POSITIONS","filterByPosition","filterDynamicPositionByAxis","sortByWeight","wrapBoxes","boxes","layoutBoxes","stackWeight","buildStacks","layouts","wrap","placed","setLayoutDims","vBoxMaxWidth","hBoxMaxHeight","layout","fullSize","availableWidth","availableHeight","buildLayoutBoxes","centerHorizontal","centerVertical","leftAndTop","rightAndBottom","getCombinedMax","maxPadding","updateMaxPadding","boxPadding","updateDims","getPadding","newWidth","outerWidth","newHeight","outerHeight","widthChanged","heightChanged","same","other","handleMaxPadding","updatePos","getMargins","marginForPositions","fitBoxes","refitBoxes","refit","setBoxDims","placeBoxes","userPadding","addBox","_layers","removeBox","layoutItem","minPadding","verticalBoxes","horizontalBoxes","beforeLayout","visibleVerticalBoxCount","BasePlatform","acquireContext","releaseContext","isAttached","updateConfig","BasicPlatform","EXPANDO_KEY","EVENT_TYPES","touchstart","touchmove","touchend","pointerenter","pointerdown","pointermove","pointerup","pointerleave","pointerout","isNullOrEmpty","initCanvas","renderHeight","renderWidth","displayWidth","displayHeight","eventListenerOptions","addListener","removeListener","fromNativeEvent","native","nodeListContains","nodeList","contains","createAttachObserver","observer","MutationObserver","trigger","addedNodes","removedNodes","observe","childList","subtree","createDetachObserver","drpListeningCharts","oldDevicePixelRatio","onWindowResize","dpr","listenDevicePixelRatioChanges","unlistenDevicePixelRatioChanges","createResizeObserver","ResizeObserver","contentRect","releaseObserver","disconnect","createProxyAndListen","DomPlatform","removeAttribute","setAttribute","proxies","$proxies","handlers","attach","detach","isConnected","_detectPlatform","OffscreenCanvas","Element","tooltipPosition","hasValue","final","tickOpts","determinedMaxTicks","determineMaxTicks","ticksLimit","maxTicksLimit","majorIndices","enabled","getMajorIndices","numMajorIndices","newTicks","skipMajors","calculateSpacing","avgMajorSpacing","_tickSize","maxScale","maxChart","_maxLength","evenMajorSpacing","getEvenSpacing","factors","majorStart","majorEnd","reverseAlign","offsetFromEdge","sample","numItems","increment","getPixelForGridLine","offsetGridLines","validIndex","lineValue","caches","getTickMarkLength","getTitleHeight","createScaleContext","createTickContext","titleAlign","titleArgs","titleX","titleY","positionAxisID","Scale","_margins","paddingTop","paddingBottom","paddingLeft","paddingRight","labelRotation","_gridLineItems","_labelItems","_labelSizes","_longestTextCache","_userMax","_userMin","_suggestedMax","_suggestedMin","_ticksLength","_borderValue","_dataLimitsCached","suggestedMin","suggestedMax","metas","getTicks","xLabels","yLabels","beforeUpdate","sampleSize","beforeSetDimensions","setDimensions","afterSetDimensions","beforeDataLimits","determineDataLimits","afterDataLimits","beforeBuildTicks","buildTicks","afterBuildTicks","samplingEnabled","_convertTicksToLabels","beforeCalculateLabelRotation","calculateLabelRotation","afterCalculateLabelRotation","afterAutoSkip","beforeFit","fit","afterFit","afterUpdate","reversePixels","_alignToPixels","alignToPixels","_callHooks","notifyPlugins","beforeTickToLabelConversion","generateTickLabels","afterTickToLabelConversion","numTicks","maxLabelDiagonal","_isVisible","labelSizes","_getLabelSizes","maxLabelWidth","widest","maxLabelHeight","highest","asin","titleOpts","gridOpts","titleHeight","tickPadding","angleRadians","labelHeight","labelWidth","_calculatePadding","_handleMargins","isRotated","labelsBelowTicks","offsetLeft","offsetRight","isFullSize","_computeLabelSizes","widths","heights","tickFont","fontString","nestedLabel","widestLabelSize","highestLabelSize","_resolveTickFontOptions","valueAt","getValueForPixel","decimal","getDecimalForPixel","getBaseValue","optionTicks","rot","_computeGridLineItems","ticksLength","borderOpts","axisWidth","axisHalfWidth","alignBorderValue","borderValue","alignedLineValue","tx1","ty1","tx2","ty2","x1","y1","limit","optsAtIndex","optsAtIndexBorder","lineColor","tickBorderDash","tickBorderDashOffset","_computeLabelItems","tickAndPadding","hTickAndPadding","lineCount","textOffset","_getXAxisLabelAlignment","_getYAxisLabelAlignment","halfCount","tickTextAlign","labelPadding","_computeLabelArea","drawBackground","findIndex","drawGrid","drawLine","setLineDash","lineDashOffset","drawBorder","lastLineWidth","drawLabels","drawTitle","tz","gz","bz","axisID","_maxDigits","fontSize","TypedRegistry","isForType","isPrototypeOf","register","parentScope","isIChartComponent","registerDefaults","unregister","itemDefaults","defaultRoutes","routeDefaults","routes","propertyParts","sourceName","sourceScope","Registry","controllers","_typedRegistries","_each","addControllers","addPlugins","addScales","getController","_get","getPlugin","getScale","removeControllers","removeElements","removePlugins","removeScales","typedRegistry","arg","reg","_getRegistryForType","_exec","itemReg","camelMethod","PluginService","_init","notify","hook","_createDescriptors","descriptor","plugin","callCallback","cancelable","invalidate","_oldCache","_notifyStateChanges","allPlugins","createDescriptors","previousDescriptors","localIds","getOpts","pluginOpts","pluginScopeKeys","getIndexAxis","datasetDefaults","datasetOptions","getAxisFromDefaultScaleID","getDefaultScaleIDFromAxis","axisFromPosition","determineAxis","scaleOptions","mergeScaleConfig","chartDefaults","configScales","chartIndexAxis","scaleConf","defaultId","defaultScaleOptions","defaultID","initOptions","initData","initConfig","keyCache","keysCached","cachedKeys","addIfFound","Config","_config","_scopeCache","_resolverCache","clearCache","clear","datasetType","additionalOptionScopes","_cachedScopes","mainScope","resetCache","keyLists","chartOptionScopes","subPrefixes","getResolver","needContext","subResolver","resolverCache","hasFunction","KNOWN_POSITIONS","positionIsHorizontal","compare2Level","l1","l2","onAnimationsComplete","onComplete","onAnimationProgress","onProgress","getCanvas","getElementById","instances","getChart","moveNumericKeys","intKey","determineLastEvent","lastEvent","inChartArea","isClick","getDatasetArea","Chart","invalidatePlugins","userConfig","initialCanvas","existingChart","_options","_aspectRatio","_metasets","_lastEvent","_listeners","_responsiveListeners","_sortedMetasets","_plugins","_hiddenIndices","attached","_doResize","resizeDelay","_initialize","bindEvents","_resizeBeforeDraw","_resize","newSize","newRatio","onResize","ensureScalesHaveIDs","scalesOptions","axisOptions","buildOrUpdateScales","scaleOpts","updated","isRadial","dposition","dtype","scaleType","scaleClass","hasUpdated","_updateMetasets","_destroyDatasetMeta","_removeUnreferencedMetasets","buildOrUpdateControllers","newControllers","order","ControllerClass","_resetElements","animsDisabled","_updateScales","_checkEventBindings","_updateHiddenIndices","_minPadding","_updateLayout","_updateDatasets","_eventHandler","_updateHoverStyles","existingEvents","newEvents","unbindEvents","changes","_getUniformDataChanges","datasetCount","makeSet","changeSet","noArea","_idx","_updateDataset","layers","_drawDatasets","_drawDataset","useClip","getElementsAtEventForMode","Interaction","setDatasetVisibility","_updateVisibility","_stop","destroy","toBase64Image","toDataURL","bindUserEvents","bindResponsiveEvents","_add","_remove","detached","updateHoverStyle","getActiveElements","setActiveElements","activeElements","lastActive","pluginId","replay","hoverOptions","deactivated","activated","eventFilter","_handleEvent","_getActiveElements","clipArc","pixelMargin","angleMargin","toRadiusCorners","parseBorderRadius","angleDelta","borderRadius","halfThickness","innerLimit","computeOuterLimit","outerArcLimit","outerStart","outerEnd","innerStart","innerEnd","rThetaToXY","theta","pathArc","innerR","spacingOffset","noSpacingInnerRadius","noSpacingOuterRadius","avNogSpacingRadius","adjustedAngle","beta","angleOffset","outerStartAdjustedRadius","outerEndAdjustedRadius","outerStartAdjustedAngle","outerEndAdjustedAngle","innerStartAdjustedRadius","innerEndAdjustedRadius","innerStartAdjustedAngle","innerEndAdjustedAngle","outerMidAdjustedAngle","pCenter","p4","innerMidAdjustedAngle","p8","outerStartX","outerStartY","outerEndX","outerEndY","drawArc","fullCircles","inner","lineJoin","ArcElement","chartX","chartY","rAdjust","betweenAngles","withinRadius","halfAngle","halfRadius","fix","radiusOffset","setStyle","lineCap","getLineMethod","stepped","pathVars","paramsStart","paramsEnd","segmentStart","segmentEnd","outside","pathSegment","lineMethod","fastPathSegment","prevX","lastY","avgX","countX","pointIndex","drawX","truncX","_getSegmentMethod","useFastPath","_getInterpolationMethod","strokePathWithCache","_path","Path2D","strokePathDirect","segmentMethod","usePath2D","LineElement","_points","_segments","_pointsUpdated","_interpolate","interpolated","hitRadius","PointElement","mouseX","mouseY","inXRange","inYRange","hoverRadius","getBarBounds","bar","half","skipOrLimit","parseBorderWidth","maxW","maxH","maxR","enableBorder","boundingRects","skipX","skipY","skipBoth","hasRadius","addNormalRectPath","inflateRect","amount","refRect","BarElement","addRectPath","BORDER_COLORS","BACKGROUND_COLORS","getBorderColor","getBackgroundColor","createDefaultDatasetColorizer","createDoughnutDatasetColorizer","createPolarAreaDatasetColorizer","getColorizer","containsColorsDefinitions","_args","colorizer","lttbDecimation","samples","decimated","bucketWidth","sampledIndex","endIndex","maxAreaPoint","maxArea","nextA","avgY","avgRangeStart","avgRangeEnd","avgRangeLength","rangeOffs","rangeTo","pointAx","pointAy","minMaxDecimation","minIndex","maxIndex","startIndex","xMin","xMax","dx","intermediateIndex1","intermediateIndex2","cleanDecimatedDataset","cleanDecimatedData","getStartAndCountOfVisiblePointsSimplified","algorithm","beforeElementsUpdate","xAxis","threshold","tpoints","_findSegmentEnd","_getBounds","targetSegments","subBounds","fillSources","fillSource","_getEdge","_pointsFromSegments","linePoints","_createBoundaryLine","_shouldApplyFill","_resolveTarget","propagate","visited","_decodeFill","parseFillOption","decodeTargetIndex","firstCh","_getTargetPixel","_getTargetValue","fillOption","_buildStackLine","sourcePoints","linesBelow","getLinesBelow","addPointsBelow","below","sourcePoint","postponed","findPoint","pointValue","firstValue","lastValue","simpleArc","getLineByIndex","computeBoundary","computeCircularBoundary","computeLinearBoundary","_drawfill","lineOpts","doFill","clipVertical","clipY","lineLoop","src","notShape","clipBounds","interpolatedLineTo","targetLoop","interpolatedPoint","afterDatasetsUpdate","$filler","beforeDraw","drawTime","beforeDatasetsDraw","beforeDatasetDraw","getBoxSize","labelOpts","boxHeight","boxWidth","usePointStyle","pointStyleWidth","itemHeight","itemsEqual","Legend","_added","legendHitBoxes","_hoveredItem","doughnutMode","legendItems","columnSizes","lineWidths","buildLabels","labelFont","_computeTitleHeight","_fitRows","_fitCols","hitboxes","totalHeight","_itemHeight","heightLimit","totalWidth","currentColWidth","currentColHeight","calculateItemSize","adjustHitBoxes","rtlHelper","hitbox","_draw","defaultColor","halfFontSize","cursor","drawLegendBox","lineDash","drawOptions","SQRT2","yBoxTop","xBoxLeft","textDirection","realX","fontLineHeight","calculateLegendItemHeight","titleFont","titlePadding","topPaddingPlusHalfFontSize","_getLegendItemAt","hitBox","lh","handleEvent","isListened","hoveredItem","sameItem","onLeave","calculateItemWidth","calculateItemHeight","legendItemText","_element","afterEvent","ci","useBorderRadius","_padding","textSize","_drawArgs","fontOpts","createTitle","titleBlock","WeakMap","positioners","average","eventPosition","nearestElement","tp","pushOrConcat","toPush","splitNewlines","createTooltipItem","formattedValue","getTooltipSize","bodyFont","footerFont","titleLineCount","footerLineCount","bodyLineItemCount","combinedBodyLength","bodyItem","before","after","beforeBody","afterBody","titleSpacing","titleMarginBottom","bodyLineHeight","displayColors","bodySpacing","footerMarginTop","footerSpacing","widthPadding","maxLineWidth","determineYAlign","doesNotFitWithAlign","xAlign","caret","caretSize","caretPadding","determineXAlign","yAlign","chartWidth","determineAlignment","alignX","alignY","paddingAndSize","getBackgroundPoint","getAlignedX","getBeforeAfterBodyLines","createTooltipContext","tooltipItems","overrideCallbacks","defaultCallbacks","beforeTitle","labelCount","afterTitle","beforeLabel","tooltipItem","labelColor","labelTextColor","bodyColor","labelPointStyle","afterLabel","beforeFooter","afterFooter","invokeCallbackWithFallback","opacity","_eventPosition","_size","_cachedAnimations","_tooltipItems","dataPoints","caretX","caretY","labelColors","labelPointStyles","labelTextColors","getTitle","getBeforeBody","getBody","bodyItems","scoped","getAfterBody","getFooter","_createItems","itemSort","positionAndSize","backgroundPoint","external","drawCaret","tooltipPoint","caretPosition","getCaretPosition","x3","y3","ptX","ptY","titleColor","_drawColorBox","colorX","rtlColorX","yOffSet","colorY","multiKeyBackground","outerX","innerX","strokeRect","drawBody","bodyAlign","xLinePadding","fillLineOfText","bodyAlignForCalculation","textColor","drawFooter","footerAlign","footerColor","tooltipSize","quadraticCurveTo","_updateAnimationTarget","animX","animY","_willRender","hasTooltipContent","globalAlpha","positionChanged","_positionChanged","_ignoreReplayEvents","afterInit","afterDraw","addIfString","addedLabels","findOrAddLabel","_getLabelForValue","CategoryScale","_startValue","_valueRange","_addedLabels","added","generateTicks","generationOptions","dataRange","MIN_SPACING","precision","maxTicks","maxDigits","includeBounds","unit","maxSpaces","rmin","rmax","countDefined","minSpacing","niceMin","niceMax","numSpaces","decimalPlaces","relativeLabelSize","LinearScaleBase","_endValue","handleTickRangeOptions","setMin","setMax","minSign","maxSign","getTickLimit","stepSize","computeTickLimit","numericGeneratorOptions","LinearScale","log10Floor","changeExponent","isMajor","tickVal","steps","rangeExp","rangeStep","startExp","minExp","lastTick","LogarithmicScale","_zero","getTickBackdropHeight","measureLabelSize","determineLimits","fitWithPointLabels","limits","valueCount","_pointLabels","pointLabelOpts","additionalAngle","centerPointLabels","getPointLabelContext","getPointPosition","drawingArea","plFont","hLimits","vLimits","updateLimits","setCenterPoint","_pointLabelItems","buildPointLabelItems","outerDistance","pointLabelPosition","yForAngle","getTextAlignForAngle","leftForTextAlign","drawPointLabels","backdropLeft","backdropTop","backdropWidth","backdropHeight","pathRadiusLine","drawRadiusLine","gridLineOpts","createPointLabelContext","RadialLinearScale","leftMovement","rightMovement","topMovement","bottomMovement","angleMultiplier","scalingFactor","getValueForDistanceFromCenter","scaledDistance","pointLabel","distanceFromCenter","getBasePosition","getPointLabelPosition","animate","INTERVALS","millisecond","common","second","minute","hour","week","UNITS","sorter","adapter","_adapter","parser","isoWeekday","_parseOpts","determineUnitForAutoTicks","minUnit","capacity","interval","MAX_SAFE_INTEGER","determineUnitForFormatting","determineMajorUnit","addTick","timestamps","timestamp","setMajorTicks","majorUnit","ticksFromTimestamps","TimeScale","_unit","_majorUnit","_offsets","_normalized","adapters","displayFormats","normalized","_applyBounds","_getLabelBounds","getLabelTimestamps","timeOpts","_generate","_getLabelCapacity","initOffsets","offsetAfterAutoskip","getDecimalForValue","weekday","hasWeekday","getDataTimestamps","tooltipFormat","datetime","_tickFormatFunction","minorFormat","majorFormat","_getLabelSize","ticksOpts","tickLabelWidth","cosRotation","sinRotation","tickFontSize","exampleTime","exampleLabel","prevSource","nextSource","prevTarget","nextTarget","span","TimeSeriesScale","_table","_minPos","_tableRange","_getTimestampsForTable","buildLookupTable","registerables","DONUT_CHART_PALETTE","GET_CONFIG","chartData","chartLabels","getSingleCommodity","changeFinalListCommodities","removeCommodity","createChart","watch","immediate","CalculationCard","getSizeTypes","sizeType","getAllCommoditiesByType","singleCommodity","changeCalculationData","positionSizeGroup","commodity","CommodityElement","getSingleSizeData","FinalBlock","Switchers","AppFileReader","CalculationBlock","CommoditySizeBlock","module","NAME","Constructor","Prototype","NATIVE_ARRAY_BUFFER","DESCRIPTORS","global","isCallable","hasOwn","classof","tryToString","createNonEnumerableProperty","defineBuiltIn","setPrototypeOf","wellKnownSymbol","InternalStateModule","enforceInternalState","enforce","getInternalState","Int8Array","Int8ArrayPrototype","Uint8ClampedArray","Uint8ClampedArrayPrototype","TypedArray","TypedArrayPrototype","ObjectPrototype","TypeError","TO_STRING_TAG","TYPED_ARRAY_TAG","TYPED_ARRAY_CONSTRUCTOR","NATIVE_ARRAY_BUFFER_VIEWS","opera","TYPED_ARRAY_TAG_REQUIRED","TypedArrayConstructorsList","Int16Array","Uint32Array","Float32Array","Float64Array","BigIntArrayConstructorsList","BigInt64Array","BigUint64Array","isView","it","klass","getTypedArrayConstructor","isTypedArray","aTypedArray","aTypedArrayConstructor","exportTypedArrayMethod","KEY","forced","ARRAY","TypedArrayConstructor","error2","exportTypedArrayStaticMethod","Function","IndexedObject","toObject","lengthOfArrayLike","createMethod","TYPE","IS_FIND_LAST_INDEX","$this","callbackfn","that","self","boundFunction","findLast","findLastIndex","fails","makeBuiltIn","setter","sharedKey","CORRECT_PROTOTYPE_GETTER","IE_PROTO","$Object","defineBuiltInAccessor","regExpFlags","RegExpPrototype","FORCED","INDICES_SUPPORT","calls","expected","addGetter","pairs","dotAll","ignoreCase","multiline","sticky","hasIndices","ArrayBufferViewCore","$findLastIndex","predicate","$findLast"],"sourceRoot":""}